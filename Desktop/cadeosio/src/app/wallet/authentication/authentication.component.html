<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anchor Link - Login</title>
    <script src="https://unpkg.com/anchor-link"></script>
    <script src="https://unpkg.com/anchor-link-browser-transport"></script>
    <script>
        // app identifier, should be set to the eosio contract account if applicable
        const identifier = 'example'
        // initialize the browser transport
        const transport = new AnchorLinkBrowserTransport()
        // initialize the link
        const link = new AnchorLink({transport})
        // the session instance, either restored using link.restoreSession() or created with link.login()
        let session

        // tries to restore session, called when document is loaded
        function restoreSession() {
            link.restoreSession(identifier).then((result) => {
                session = result
                if (session) {
                    didLogin()
                }
            })
        }

        // login and store session if sucessful
        function login() {
            link.login(identifier).then((result) => {
                session = result.session
                didLogin()
            })
        }

        // logout and remove session from storage
        function logout() {
            document.body.classList.remove('logged-in')
            session.remove()
        }

        // called when session was restored or created
        function didLogin() {
            document.getElementById('account-name').textContent = session.auth.actor
            document.body.classList.add('logged-in')
        }

        // transfer tokens using a session
        function transfer() {
            const action = {
                account: 'eosio.token',
                name: 'transfer',
                authorization: [session.auth],
                data: {
                    from: session.auth.actor,
                    to: 'teamgreymass',
                    quantity: '0.0001 EOS',
                    memo: 'Anchor is the best! Thank you <3'
                }
            }
            session.transact({action}).then((result) => {
                document.getElementById('log').innerHTML += `Transaction broadcast! ${ result.processed.id }\n`
            })
        }

        // ¯\_(ツ)_/¯
        window.addEventListener('keypress', (event) => {
            if (event.key === 'F' || event.key === 'f') {
                transfer()
            }
        })
    </script>
    <style>
        .logged-in #login-ui {
            display: none;
        }
        #app-ui {
            display: none;
        }
        .logged-in #app-ui {
            display: block;
        }
    </style>
</head>

<div class="backstretch animated">
    <div class="wallet-page">
  
        <div id="wrapper"  [ngClass]="ref.click === true? 'toggled' :''" >
            <div class="overlay" [ngStyle]="{disply:ref.click === true? 'block' :'none'}" ></div>
  
            <nav id="sidebar-wrapper" role="navigation">
                <ul class="nav sidebar-nav">
          
                    <li>
                        <a href="vote">Vote on EOS</a>
                    </li>
                    <li>
                        <a href="stake-project">Stake Tokens Project</a>
                    </li>
                    <li>
                        <a href="stake-campus">Stake Tokens Campus</a>
                    </li>
                    <li>
                      <a href="stake-eos">Stake Tokens CPU/NET</a>
                  </li>
                  <li>
                      <a href="supplier-payment">Suplier Payment</a>
                  </li>
                    <li>
                        <a href="transfer-tokens">Transfer Tokens</a>
                    </li>
                    <li>
                        <a href="buy/sell-ram">Buy/Sell RAM</a>
                    </li>
                    <li>
                        <a href="create-account">Create EOS Account</a>
                    </li>
                    <li>
                        <a href="keys-manager">Authority Keys</a>
                    </li>
                    <li>
                      <a href="history-account">Account History</a>
                  </li>
                  <li>
                      <a href="authentication">Authentication</a>
                  </li>
                </ul>
            </nav>
  
    <!-- /#sidebar-wrapper -->
  
   
    <!-- Page Content -->
    <div class="wallet-card" style=" color: white;" id="page-content-wrapper">
        <button appSidebar  #ref="appSidebar" type="button" class="hamburger is-closed" data-toggle="offcanvas" style=" margin-left: 2%;">
            <span class="hamb-top"></span>
      <span class="hamb-middle"></span>
    <span class="hamb-bottom"></span>
        </button>
        <div class="container">
            <div class="row">
                <div class="col">
                  <h1 class="card-header" style=" color: white;">AUTHENTICATION</h1>
                  <div class="card-body">
  
                    <p>*AUTHENTICATION- Authenticate your EOS or ETH Account</p>
  
                </div>

                <div id="app-ui">
                    <p>Welcome <b id="account-name">foo</b>!</p>
                    <ul>
                        <li><button onclick="transfer()">Send an homage to team Greymass</button></li>
                        <li><button onclick="logout()">Log out</button></li>
                    </ul>
                    <p><small>Press F to pay respects</small></p>
                    <pre id="log"></pre>
                </div>
                <div id="login-ui">
                    <button class="btn btn-primary" onclick="login()">Login</button>
                </div>
            </div>

        </div>
      </div>
    <!-- /#page-content-wrapper -->
  
  </div>
  </div>
  </div>

  <!-- /#wrapper -->

</div>

</html>