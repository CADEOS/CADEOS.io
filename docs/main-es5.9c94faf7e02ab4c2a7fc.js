function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,a=!1,o=void 0;try{for(var _,i=e[Symbol.iterator]();!(n=(_=i.next()).done)&&(r.push(_.value),!t||r.length!==t);n=!0);}catch(s){a=!0,o=s}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,a,o=!0,_=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){_=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(_)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _construct(e,t,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return r&&_setPrototypeOf(a,r.prototype),a}).apply(null,arguments)}function _get(e,t,r){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=_superPropBase(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(r):a.value}})(e,t,r||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,r){e.exports=r("zUnb")},"6MUB":function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,a){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(a){var o=encodeURIComponent(n(a))+r;return Array.isArray(e[a])?e[a].map((function(e){return o+encodeURIComponent(n(e))})).join(t):o+encodeURIComponent(n(e[a]))})).join(t):a?encodeURIComponent(n(a))+r+encodeURIComponent(n(e)):""}},CxY0:function(e,t,r){"use strict";var n=r("rWzI"),a=r("Nehr");function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=A,t.resolve=function(e,t){return A(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?A(e,!1,!0).resolveObject(t):t},t.format=function(e){return a.isString(e)&&(e=A(e)),e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o;var _=/^([a-z0-9.+-]+:)/i,i=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),c=["'"].concat(l),E=["%","/","?",";","#"].concat(c),u=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,T=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},p={javascript:!0,"javascript:":!0},P={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},S=r("r8II");function A(e,t,r){if(e&&a.isObject(e)&&e instanceof o)return e;var n=new o;return n.parse(e,t,r),n}o.prototype.parse=function(e,t,r){if(!a.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),i=-1!==o&&o<e.indexOf("#")?"?":"#",l=e.split(i);l[0]=l[0].replace(/\\/g,"/");var A=e=l.join(i);if(A=A.trim(),!r&&1===e.split("#").length){var h=s.exec(A);if(h)return this.path=A,this.href=A,this.pathname=h[1],h[2]?(this.search=h[2],this.query=t?S.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var v=_.exec(A);if(v){var m=(v=v[0]).toLowerCase();this.protocol=m,A=A.substr(v.length)}if(r||v||A.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===A.substr(0,2);!g||v&&p[v]||(A=A.substr(2),this.slashes=!0)}if(!p[v]&&(g||v&&!P[v])){for(var O,N,R=-1,I=0;I<u.length;I++)-1!==(b=A.indexOf(u[I]))&&(-1===R||b<R)&&(R=b);for(-1!==(N=-1===R?A.lastIndexOf("@"):A.lastIndexOf("@",R))&&(O=A.slice(0,N),A=A.slice(N+1),this.auth=decodeURIComponent(O)),R=-1,I=0;I<E.length;I++){var b;-1!==(b=A.indexOf(E[I]))&&(-1===R||b<R)&&(R=b)}-1===R&&(R=A.length),this.host=A.slice(0,R),A=A.slice(R),this.parseHost(),this.hostname=this.hostname||"";var y="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!y)for(var L=this.hostname.split(/\./),Y=(I=0,L.length);I<Y;I++){var M=L[I];if(M&&!M.match(d)){for(var x="",C=0,w=M.length;C<w;C++)M.charCodeAt(C)>127?x+="x":x+=M[C];if(!x.match(d)){var U=L.slice(0,I),k=L.slice(I+1),D=M.match(T);D&&(U.push(D[1]),k.unshift(D[2])),k.length&&(A="/"+k.join(".")+A),this.hostname=U.join(".");break}}}this.hostname=this.hostname.length>255?"":this.hostname.toLowerCase(),y||(this.hostname=n.toASCII(this.hostname)),this.host=(this.hostname||"")+(this.port?":"+this.port:""),this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==A[0]&&(A="/"+A))}if(!f[m])for(I=0,Y=c.length;I<Y;I++){var F=c[I];if(-1!==A.indexOf(F)){var G=encodeURIComponent(F);G===F&&(G=escape(F)),A=A.split(F).join(G)}}var K=A.indexOf("#");-1!==K&&(this.hash=A.substr(K),A=A.slice(0,K));var B=A.indexOf("?");return-1!==B?(this.search=A.substr(B),this.query=A.substr(B+1),t&&(this.query=S.parse(this.query)),A=A.slice(0,B)):t&&(this.search="",this.query={}),A&&(this.pathname=A),P[m]&&this.hostname&&!this.pathname&&(this.pathname="/"),(this.pathname||this.search)&&(this.path=(this.pathname||"")+(this.search||"")),this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,_="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&a.isObject(this.query)&&Object.keys(this.query).length&&(_=S.stringify(this.query));var i=this.search||_&&"?"+_||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||P[t])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),i&&"?"!==i.charAt(0)&&(i="?"+i),t+o+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(i=i.replace("#","%23"))+n},o.prototype.resolve=function(e){return this.resolveObject(A(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(a.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var r=new o,n=Object.keys(this),_=0;_<n.length;_++){var i=n[_];r[i]=this[i]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),l=0;l<s.length;l++){var c=s[l];"protocol"!==c&&(r[c]=e[c])}return P[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!P[e.protocol]){for(var E=Object.keys(e),u=0;u<E.length;u++){var d=E[u];r[d]=e[d]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||p[e.protocol])r.pathname=e.pathname;else{for(var T=(e.pathname||"").split("/");T.length&&!(e.host=T.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==T[0]&&T.unshift(""),T.length<2&&T.unshift(""),r.pathname=T.join("/")}return r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,(r.pathname||r.search)&&(r.path=(r.pathname||"")+(r.search||"")),r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var f=r.pathname&&"/"===r.pathname.charAt(0),S=e.host||e.pathname&&"/"===e.pathname.charAt(0),A=S||f||r.host&&e.pathname,h=A,v=r.pathname&&r.pathname.split("/")||[],m=(T=e.pathname&&e.pathname.split("/")||[],r.protocol&&!P[r.protocol]);if(m&&(r.hostname="",r.port=null,r.host&&(""===v[0]?v[0]=r.host:v.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===T[0]?T[0]=e.host:T.unshift(e.host)),e.host=null),A=A&&(""===T[0]||""===v[0])),S)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,v=T;else if(T.length)v||(v=[]),v.pop(),v=v.concat(T),r.search=e.search,r.query=e.query;else if(!a.isNullOrUndefined(e.search))return m&&(r.hostname=r.host=v.shift(),(I=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=I.shift(),r.host=r.hostname=I.shift())),r.search=e.search,r.query=e.query,a.isNull(r.pathname)&&a.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r;if(!v.length)return r.pathname=null,r.path=r.search?"/"+r.search:null,r.href=r.format(),r;for(var g=v.slice(-1)[0],O=(r.host||e.host||v.length>1)&&("."===g||".."===g)||""===g,N=0,R=v.length;R>=0;R--)"."===(g=v[R])?v.splice(R,1):".."===g?(v.splice(R,1),N++):N&&(v.splice(R,1),N--);if(!A&&!h)for(;N--;N)v.unshift("..");!A||""===v[0]||v[0]&&"/"===v[0].charAt(0)||v.unshift(""),O&&"/"!==v.join("/").substr(-1)&&v.push("");var I,b=""===v[0]||v[0]&&"/"===v[0].charAt(0);return m&&(r.hostname=r.host=b?"":v.length?v.shift():"",(I=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=I.shift(),r.host=r.hostname=I.shift())),(A=A||r.host&&v.length)&&!b&&v.unshift(""),v.length?r.pathname=v.join("/"):(r.pathname=null,r.path=null),a.isNull(r.pathname)&&a.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},o.prototype.parseHost=function(){var e=this.host,t=i.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},Nehr:function(e,t,r){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},YcCt:function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,a){r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var _=/\+/g;e=e.split(t=t||"&");var i=1e3;a&&"number"==typeof a.maxKeys&&(i=a.maxKeys);var s=e.length;i>0&&s>i&&(s=i);for(var l=0;l<s;++l){var c,E,u,d,T=e[l].replace(_,"%20"),f=T.indexOf(r);f>=0?(c=T.substr(0,f),E=T.substr(f+1)):(c=T,E=""),u=decodeURIComponent(c),d=decodeURIComponent(E),n(o,u)?Array.isArray(o[u])?o[u].push(d):o[u]=[o[u],d]:o[u]=d}return o}},YuTi:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},r8II:function(e,t,r){"use strict";t.decode=t.parse=r("YcCt"),t.encode=t.stringify=r("6MUB")},rWzI:function(e,t,r){(function(e){var n;!function(a){"object"==typeof global&&global;var o,_=2147483647,i=/^xn--/,s=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,c={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=Math.floor,u=String.fromCharCode;function d(e){throw RangeError(c[e])}function T(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function f(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+T((e=e.replace(l,".")).split("."),t).join(".")}function p(e){for(var t,r,n=[],a=0,o=e.length;a<o;)(t=e.charCodeAt(a++))>=55296&&t<=56319&&a<o?56320==(64512&(r=e.charCodeAt(a++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),a--):n.push(t);return n}function P(e){return T(e,(function(e){var t="";return e>65535&&(t+=u((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+u(e)})).join("")}function S(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function A(e,t,r){var n=0;for(e=r?E(e/700):e>>1,e+=E(e/t);e>455;n+=36)e=E(e/35);return E(n+36*e/(e+38))}function h(e){var t,r,n,a,o,i,s,l,c,u,T,f=[],p=e.length,S=0,h=128,v=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&d("not-basic"),f.push(e.charCodeAt(n));for(a=r>0?r+1:0;a<p;){for(o=S,i=1,s=36;a>=p&&d("invalid-input"),((l=(T=e.charCodeAt(a++))-48<10?T-22:T-65<26?T-65:T-97<26?T-97:36)>=36||l>E((_-S)/i))&&d("overflow"),S+=l*i,!(l<(c=s<=v?1:s>=v+26?26:s-v));s+=36)i>E(_/(u=36-c))&&d("overflow"),i*=u;v=A(S-o,t=f.length+1,0==o),E(S/t)>_-h&&d("overflow"),h+=E(S/t),S%=t,f.splice(S++,0,h)}return P(f)}function v(e){var t,r,n,a,o,i,s,l,c,T,f,P,h,v,m,g=[];for(P=(e=p(e)).length,t=128,r=0,o=72,i=0;i<P;++i)(f=e[i])<128&&g.push(u(f));for(n=a=g.length,a&&g.push("-");n<P;){for(s=_,i=0;i<P;++i)(f=e[i])>=t&&f<s&&(s=f);for(s-t>E((_-r)/(h=n+1))&&d("overflow"),r+=(s-t)*h,t=s,i=0;i<P;++i)if((f=e[i])<t&&++r>_&&d("overflow"),f==t){for(l=r,c=36;!(l<(T=c<=o?1:c>=o+26?26:c-o));c+=36)g.push(u(S(T+(m=l-T)%(v=36-T),0))),l=E(m/v);g.push(u(S(l,0))),o=A(r,h,n==a),r=0,++n}++r,++t}return g.join("")}o={version:"1.3.2",ucs2:{decode:p,encode:P},decode:h,encode:v,toASCII:function(e){return f(e,(function(e){return s.test(e)?"xn--"+v(e):e}))},toUnicode:function(e){return f(e,(function(e){return i.test(e)?h(e.slice(4).toLowerCase()):e}))}},void 0===(n=(function(){return o}).call(t,r,t,e))||(e.exports=n)}()}).call(this,r("YuTi")(e))},zUnb:function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"create",(function(){return oA})),r.d(n,"fromMat4",(function(){return _A})),r.d(n,"clone",(function(){return iA})),r.d(n,"copy",(function(){return sA})),r.d(n,"identity",(function(){return lA})),r.d(n,"transpose",(function(){return cA})),r.d(n,"invert",(function(){return EA})),r.d(n,"adjoint",(function(){return uA})),r.d(n,"determinant",(function(){return dA})),r.d(n,"multiply",(function(){return TA})),r.d(n,"mul",(function(){return TA})),r.d(n,"translate",(function(){return fA})),r.d(n,"rotate",(function(){return pA})),r.d(n,"scale",(function(){return PA})),r.d(n,"fromTranslation",(function(){return SA})),r.d(n,"fromRotation",(function(){return AA})),r.d(n,"fromScaling",(function(){return hA})),r.d(n,"fromMat2d",(function(){return vA})),r.d(n,"fromQuat",(function(){return mA})),r.d(n,"normalFromMat4",(function(){return gA})),r.d(n,"str",(function(){return OA})),r.d(n,"frob",(function(){return NA}));var a={};r.r(a),r.d(a,"create",(function(){return IA})),r.d(a,"clone",(function(){return bA})),r.d(a,"copy",(function(){return yA})),r.d(a,"identity",(function(){return LA})),r.d(a,"transpose",(function(){return YA})),r.d(a,"invert",(function(){return MA})),r.d(a,"adjoint",(function(){return xA})),r.d(a,"determinant",(function(){return CA})),r.d(a,"multiply",(function(){return wA})),r.d(a,"mul",(function(){return wA})),r.d(a,"translate",(function(){return UA})),r.d(a,"scale",(function(){return kA})),r.d(a,"rotate",(function(){return DA})),r.d(a,"rotateX",(function(){return FA})),r.d(a,"rotateY",(function(){return GA})),r.d(a,"rotateZ",(function(){return KA})),r.d(a,"fromTranslation",(function(){return BA})),r.d(a,"fromScaling",(function(){return XA})),r.d(a,"fromRotation",(function(){return HA})),r.d(a,"fromXRotation",(function(){return jA})),r.d(a,"fromYRotation",(function(){return zA})),r.d(a,"fromZRotation",(function(){return QA})),r.d(a,"fromRotationTranslation",(function(){return VA})),r.d(a,"fromRotationTranslationScale",(function(){return qA})),r.d(a,"fromRotationTranslationScaleOrigin",(function(){return WA})),r.d(a,"fromQuat",(function(){return JA})),r.d(a,"frustum",(function(){return ZA})),r.d(a,"perspective",(function(){return $A})),r.d(a,"perspectiveFromFieldOfView",(function(){return eh})),r.d(a,"ortho",(function(){return th})),r.d(a,"lookAt",(function(){return rh})),r.d(a,"str",(function(){return nh})),r.d(a,"frob",(function(){return ah}));var o={};r.r(o),r.d(o,"create",(function(){return ih})),r.d(o,"clone",(function(){return sh})),r.d(o,"fromValues",(function(){return lh})),r.d(o,"copy",(function(){return ch})),r.d(o,"set",(function(){return Eh})),r.d(o,"add",(function(){return uh})),r.d(o,"subtract",(function(){return dh})),r.d(o,"sub",(function(){return dh})),r.d(o,"multiply",(function(){return Th})),r.d(o,"mul",(function(){return Th})),r.d(o,"divide",(function(){return fh})),r.d(o,"div",(function(){return fh})),r.d(o,"min",(function(){return ph})),r.d(o,"max",(function(){return Ph})),r.d(o,"scale",(function(){return Sh})),r.d(o,"scaleAndAdd",(function(){return Ah})),r.d(o,"distance",(function(){return hh})),r.d(o,"dist",(function(){return hh})),r.d(o,"squaredDistance",(function(){return vh})),r.d(o,"sqrDist",(function(){return vh})),r.d(o,"length",(function(){return mh})),r.d(o,"len",(function(){return mh})),r.d(o,"squaredLength",(function(){return gh})),r.d(o,"sqrLen",(function(){return gh})),r.d(o,"negate",(function(){return Oh})),r.d(o,"inverse",(function(){return Nh})),r.d(o,"normalize",(function(){return Rh})),r.d(o,"dot",(function(){return Ih})),r.d(o,"cross",(function(){return bh})),r.d(o,"lerp",(function(){return yh})),r.d(o,"hermite",(function(){return Lh})),r.d(o,"bezier",(function(){return Yh})),r.d(o,"random",(function(){return Mh})),r.d(o,"transformMat4",(function(){return xh})),r.d(o,"transformMat3",(function(){return Ch})),r.d(o,"transformQuat",(function(){return wh})),r.d(o,"rotateX",(function(){return Uh})),r.d(o,"rotateY",(function(){return kh})),r.d(o,"rotateZ",(function(){return Dh})),r.d(o,"forEach",(function(){return Gh})),r.d(o,"angle",(function(){return Kh})),r.d(o,"str",(function(){return Bh}));var _={};r.r(_),r.d(_,"create",(function(){return Fv})),r.d(_,"clone",(function(){return Gv})),r.d(_,"fromValues",(function(){return Kv})),r.d(_,"copy",(function(){return Bv})),r.d(_,"set",(function(){return Xv})),r.d(_,"add",(function(){return Hv})),r.d(_,"subtract",(function(){return jv})),r.d(_,"sub",(function(){return jv})),r.d(_,"multiply",(function(){return zv})),r.d(_,"mul",(function(){return zv})),r.d(_,"divide",(function(){return Qv})),r.d(_,"div",(function(){return Qv})),r.d(_,"min",(function(){return Vv})),r.d(_,"max",(function(){return qv})),r.d(_,"scale",(function(){return Wv})),r.d(_,"scaleAndAdd",(function(){return Jv})),r.d(_,"distance",(function(){return Zv})),r.d(_,"dist",(function(){return Zv})),r.d(_,"squaredDistance",(function(){return $v})),r.d(_,"sqrDist",(function(){return $v})),r.d(_,"length",(function(){return em})),r.d(_,"len",(function(){return em})),r.d(_,"squaredLength",(function(){return tm})),r.d(_,"sqrLen",(function(){return tm})),r.d(_,"negate",(function(){return rm})),r.d(_,"inverse",(function(){return nm})),r.d(_,"normalize",(function(){return am})),r.d(_,"dot",(function(){return om})),r.d(_,"lerp",(function(){return _m})),r.d(_,"random",(function(){return im})),r.d(_,"transformMat4",(function(){return sm})),r.d(_,"transformQuat",(function(){return lm})),r.d(_,"forEach",(function(){return cm})),r.d(_,"str",(function(){return Em}));var i={};r.r(i),r.d(i,"create",(function(){return dm})),r.d(i,"rotationTo",(function(){return Sm})),r.d(i,"setAxes",(function(){return Am})),r.d(i,"clone",(function(){return Gv})),r.d(i,"fromValues",(function(){return Kv})),r.d(i,"copy",(function(){return Bv})),r.d(i,"set",(function(){return Xv})),r.d(i,"identity",(function(){return hm})),r.d(i,"setAxisAngle",(function(){return vm})),r.d(i,"add",(function(){return Hv})),r.d(i,"multiply",(function(){return mm})),r.d(i,"mul",(function(){return mm})),r.d(i,"scale",(function(){return Wv})),r.d(i,"rotateX",(function(){return gm})),r.d(i,"rotateY",(function(){return Om})),r.d(i,"rotateZ",(function(){return Nm})),r.d(i,"calculateW",(function(){return Rm})),r.d(i,"dot",(function(){return om})),r.d(i,"lerp",(function(){return _m})),r.d(i,"slerp",(function(){return Im})),r.d(i,"sqlerp",(function(){return Lm})),r.d(i,"invert",(function(){return Ym})),r.d(i,"conjugate",(function(){return Mm})),r.d(i,"length",(function(){return em})),r.d(i,"len",(function(){return em})),r.d(i,"squaredLength",(function(){return tm})),r.d(i,"sqrLen",(function(){return tm})),r.d(i,"normalize",(function(){return am})),r.d(i,"fromMat3",(function(){return xm})),r.d(i,"str",(function(){return Cm}));var s={};function l(e){return"function"==typeof e}r.r(s),r.d(s,"parser",(function(){return VI}));var c=!1,E={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else c&&console.log("RxJS: Back to a better error behavior. Thank you. <3");c=e},get useDeprecatedSynchronousErrorHandling(){return c}};function u(e){setTimeout((function(){throw e}),0)}var d={closed:!0,next:function(e){},error:function(e){if(E.useDeprecatedSynchronousErrorHandling)throw e;u(e)},complete:function(){}},T=Array.isArray||function(e){return e&&"number"==typeof e.length};function f(e){return null!==e&&"object"==typeof e}var p,P=function(){function e(e){return Error.call(this),this.message=e?"".concat(e.length," errors occurred during unsubscription:\n").concat(e.map((function(e,t){return"".concat(t+1,") ").concat(e.toString())})).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),S=((p=function(){function e(t){_classCallCheck(this,e),this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return _createClass(e,[{key:"unsubscribe",value:function(){var t;if(!this.closed){var r=this._parentOrParents,n=this._unsubscribe,a=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var o=0;o<r.length;++o)r[o].remove(this);if(l(n))try{n.call(this)}catch(c){t=c instanceof P?A(c.errors):[c]}if(T(a))for(var _=-1,i=a.length;++_<i;){var s=a[_];if(f(s))try{s.unsubscribe()}catch(c){t=t||[],c instanceof P?t=t.concat(A(c.errors)):t.push(c)}}if(t)throw new P(t)}}},{key:"add",value:function(t){var r=t;if(!t)return e.EMPTY;switch(typeof t){case"function":r=new e(t);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var n=r;(r=new e)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var a=r._parentOrParents;if(null===a)r._parentOrParents=this;else if(a instanceof e){if(a===this)return r;r._parentOrParents=[a,this]}else{if(-1!==a.indexOf(this))return r;a.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[r]:o.push(r),r}},{key:"remove",value:function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}}}]),e}()).EMPTY=function(e){return e.closed=!0,e}(new p),p);function A(e){return e.reduce((function(e,t){return e.concat(t instanceof P?t.errors:t)}),[])}var h="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),v=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a){var o;switch(_classCallCheck(this,r),(o=t.call(this)).syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=d;break;case 1:if(!e){o.destination=d;break}if("object"==typeof e){e instanceof r?(o.syncErrorThrowable=e.syncErrorThrowable,o.destination=e,e.add(_assertThisInitialized(o))):(o.syncErrorThrowable=!0,o.destination=new m(_assertThisInitialized(o),e));break}default:o.syncErrorThrowable=!0,o.destination=new m(_assertThisInitialized(o),e,n,a)}return o}return _createClass(r,[{key:h,value:function(){return this}},{key:"next",value:function(e){this.isStopped||this._next(e)}},{key:"error",value:function(e){this.isStopped||(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped||(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,_get(_getPrototypeOf(r.prototype),"unsubscribe",this).call(this))}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribeAndRecycle",value:function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}],[{key:"create",value:function(e,t,n){var a=new r(e,t,n);return a.syncErrorThrowable=!1,a}}]),r}(S),m=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o){var _,i;_classCallCheck(this,r),(_=t.call(this))._parentSubscriber=e;var s=_assertThisInitialized(_);return l(n)?i=n:n&&(i=n.next,a=n.error,o=n.complete,n!==d&&(l((s=Object.create(n)).unsubscribe)&&_.add(s.unsubscribe.bind(s)),s.unsubscribe=_.unsubscribe.bind(_assertThisInitialized(_)))),_._context=s,_._next=i,_._error=a,_._complete=o,_}return _createClass(r,[{key:"next",value:function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;E.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}},{key:"error",value:function(e){if(!this.isStopped){var t=this._parentSubscriber,r=E.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):u(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;u(e)}}}},{key:"complete",value:function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};E.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}}},{key:"__tryOrUnsub",value:function(e,t){try{e.call(this._context,t)}catch(r){if(this.unsubscribe(),E.useDeprecatedSynchronousErrorHandling)throw r;u(r)}}},{key:"__tryOrSetError",value:function(e,t,r){if(!E.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(n){return E.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=n,e.syncErrorThrown=!0,!0):(u(n),!0)}return!1}},{key:"_unsubscribe",value:function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}]),r}(v),g="function"==typeof Symbol&&Symbol.observable||"@@observable";function O(e){return e}function N(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return R(t)}function R(e){return 0===e.length?O:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var I,b=((I=function(){function e(t){_classCallCheck(this,e),this._isScalar=!1,t&&(this._subscribe=t)}return _createClass(e,[{key:"lift",value:function(t){var r=new e;return r.source=this,r.operator=t,r}},{key:"subscribe",value:function(e,t,r){var n=this.operator,a=function(e,t,r){if(e){if(e instanceof v)return e;if(e[h])return e[h]()}return e||t||r?new v(e,t,r):new v(d)}(e,t,r);if(a.add(n?n.call(a,this.source):this.source||E.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),E.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){E.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,r=t.closed,n=t.destination,a=t.isStopped;if(r||a)return!1;e=n&&n instanceof v?n:null}return!0}(e)?e.error(t):console.warn(t)}}},{key:"forEach",value:function(e,t){var r=this;return new(t=y(t))((function(t,n){var a;a=r.subscribe((function(t){try{e(t)}catch(r){n(r),a&&a.unsubscribe()}}),n,t)}))}},{key:"_subscribe",value:function(e){var t=this.source;return t&&t.subscribe(e)}},{key:g,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?this:R(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=y(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))}}]),e}()).create=function(e){return new I(e)},I);function y(e){if(e||(e=E.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var L,Y=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),M=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this)).subject=e,a.subscriber=n,a.closed=!1,a}return _createClass(r,[{key:"unsubscribe",value:function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var r=t.indexOf(this.subscriber);-1!==r&&t.splice(r,1)}}}}]),r}(S),x=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this,e)).destination=e,n}return r}(v),C=((L=function(e){_inherits(r,e);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.call(this)).observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return _createClass(r,[{key:h,value:function(){return new x(this)}},{key:"lift",value:function(e){var t=new w(this,this);return t.operator=e,t}},{key:"next",value:function(e){if(this.closed)throw new Y;if(!this.isStopped)for(var t=this.observers,r=t.length,n=t.slice(),a=0;a<r;a++)n[a].next(e)}},{key:"error",value:function(e){if(this.closed)throw new Y;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,r=t.length,n=t.slice(),a=0;a<r;a++)n[a].error(e);this.observers.length=0}},{key:"complete",value:function(){if(this.closed)throw new Y;this.isStopped=!0;for(var e=this.observers,t=e.length,r=e.slice(),n=0;n<t;n++)r[n].complete();this.observers.length=0}},{key:"unsubscribe",value:function(){this.isStopped=!0,this.closed=!0,this.observers=null}},{key:"_trySubscribe",value:function(e){if(this.closed)throw new Y;return _get(_getPrototypeOf(r.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){if(this.closed)throw new Y;return this.hasError?(e.error(this.thrownError),S.EMPTY):this.isStopped?(e.complete(),S.EMPTY):(this.observers.push(e),new M(this,e))}},{key:"asObservable",value:function(){var e=new b;return e.source=this,e}}]),r}(b)).create=function(e,t){return new w(e,t)},L),w=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this)).destination=e,a.source=n,a}return _createClass(r,[{key:"next",value:function(e){var t=this.destination;t&&t.next&&t.next(e)}},{key:"error",value:function(e){var t=this.destination;t&&t.error&&this.destination.error(e)}},{key:"complete",value:function(){var e=this.destination;e&&e.complete&&this.destination.complete()}},{key:"_subscribe",value:function(e){return this.source?this.source.subscribe(e):S.EMPTY}}]),r}(C);function U(e){return e&&"function"==typeof e.schedule}var k=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a){var o;return _classCallCheck(this,r),(o=t.call(this)).parent=e,o.outerValue=n,o.outerIndex=a,o.index=0,o}return _createClass(r,[{key:"_next",value:function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}},{key:"_error",value:function(e){this.parent.notifyError(e,this),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(this),this.unsubscribe()}}]),r}(v),D=function(e){return function(t){for(var r=0,n=e.length;r<n&&!t.closed;r++)t.next(e[r]);t.complete()}};var F="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",G=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function K(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var B=function(e){if(e&&"function"==typeof e[g])return n=e,function(e){var t=n[g]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(G(e))return D(e);if(K(e))return r=e,function(e){return r.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,u),e};if(e&&"function"==typeof e[F])return t=e,function(e){for(var r=t[F]();;){var n=r.next();if(n.done){e.complete();break}if(e.next(n.value),e.closed)break}return"function"==typeof r.return&&e.add((function(){r.return&&r.return()})),e};var t,r,n,a=f(e)?"an invalid object":"'".concat(e,"'");throw new TypeError("You provided ".concat(a," where a stream was expected.")+" You can provide an Observable, Promise, Array, or Iterable.")};function X(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new k(e,r,n);if(!a.closed)return t instanceof b?t.subscribe(a):B(t)(a)}var H=function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"notifyNext",value:function(e,t,r,n,a){this.destination.next(t)}},{key:"notifyError",value:function(e,t){this.destination.error(e)}},{key:"notifyComplete",value:function(e){this.destination.complete()}}]),r}(v);function j(e,t){return function(r){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new z(e,t))}}var z=function(){function e(t,r){_classCallCheck(this,e),this.project=t,this.thisArg=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Q(e,this.project,this.thisArg))}}]),e}(),Q=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a){var o;return _classCallCheck(this,r),(o=t.call(this,e)).project=n,o.count=0,o.thisArg=a||_assertThisInitialized(o),o}return _createClass(r,[{key:"_next",value:function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(r){return void this.destination.error(r)}this.destination.next(t)}}]),r}(v);function V(e,t){return new b((function(r){var n=new S,a=0;return n.add(t.schedule((function(){a!==e.length?(r.next(e[a++]),r.closed||n.add(this.schedule())):r.complete()}))),n}))}function q(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[g]}(e))return function(e,t){return new b((function(r){var n=new S;return n.add(t.schedule((function(){var a=e[g]();n.add(a.subscribe({next:function(e){n.add(t.schedule((function(){return r.next(e)})))},error:function(e){n.add(t.schedule((function(){return r.error(e)})))},complete:function(){n.add(t.schedule((function(){return r.complete()})))}}))}))),n}))}(e,t);if(K(e))return function(e,t){return new b((function(r){var n=new S;return n.add(t.schedule((function(){return e.then((function(e){n.add(t.schedule((function(){r.next(e),n.add(t.schedule((function(){return r.complete()})))})))}),(function(e){n.add(t.schedule((function(){return r.error(e)})))}))}))),n}))}(e,t);if(G(e))return V(e,t);if(function(e){return e&&"function"==typeof e[F]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new b((function(r){var n,a=new S;return a.add((function(){n&&"function"==typeof n.return&&n.return()})),a.add(t.schedule((function(){n=e[F](),a.add(t.schedule((function(){if(!r.closed){var e,t;try{var a=n.next();e=a.value,t=a.done}catch(o){return void r.error(o)}t?r.complete():(r.next(e),this.schedule())}})))}))),a}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof b?e:new b(B(e))}function W(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return"function"==typeof t?function(n){return n.pipe(W((function(r,n){return q(e(r,n)).pipe(j((function(e,a){return t(r,e,n,a)})))}),r))}:("number"==typeof t&&(r=t),function(t){return t.lift(new J(e,r))})}var J=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;_classCallCheck(this,e),this.project=t,this.concurrent=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Z(e,this.project,this.concurrent))}}]),e}(),Z=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return _classCallCheck(this,r),(a=t.call(this,e)).project=n,a.concurrent=o,a.hasCompleted=!1,a.buffer=[],a.active=0,a.index=0,a}return _createClass(r,[{key:"_next",value:function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}},{key:"_tryNext",value:function(e){var t,r=this.index++;try{t=this.project(e,r)}catch(n){return void this.destination.error(n)}this.active++,this._innerSub(t,e,r)}},{key:"_innerSub",value:function(e,t,r){var n=new k(this,t,r),a=this.destination;a.add(n);var o=X(this,e,void 0,void 0,n);o!==n&&a.add(o)}},{key:"_complete",value:function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}},{key:"notifyNext",value:function(e,t,r,n,a){this.destination.next(t)}},{key:"notifyComplete",value:function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}]),r}(H);function $(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;return W(O,e)}function ee(e,t){return t?V(e,t):new b(D(e))}function te(){return function(e){return e.lift(new ne(e))}}var re,ne=function(){function e(t){_classCallCheck(this,e),this.connectable=t}return _createClass(e,[{key:"call",value:function(e,t){var r=this.connectable;r._refCount++;var n=new ae(e,r),a=t.subscribe(n);return n.closed||(n.connection=r.connect()),a}}]),e}(),ae=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this,e)).connectable=n,a}return _createClass(r,[{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var r=this.connection,n=e._connection;this.connection=null,!n||r&&n!==r||n.unsubscribe()}}else this.connection=null}}]),r}(v),oe={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:(re=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this)).source=e,a.subjectFactory=n,a._refCount=0,a._isComplete=!1,a}return _createClass(r,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}},{key:"connect",value:function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new S).add(this.source.subscribe(new _e(this.getSubject(),this))),e.closed&&(this._connection=null,e=S.EMPTY)),e}},{key:"refCount",value:function(){return te()(this)}}]),r}(b).prototype)._subscribe},_isComplete:{value:re._isComplete,writable:!0},getSubject:{value:re.getSubject},connect:{value:re.connect},refCount:{value:re.refCount}},_e=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this,e)).connectable=n,a}return _createClass(r,[{key:"_error",value:function(e){this._unsubscribe(),_get(_getPrototypeOf(r.prototype),"_error",this).call(this,e)}},{key:"_complete",value:function(){this.connectable._isComplete=!0,this._unsubscribe(),_get(_getPrototypeOf(r.prototype),"_complete",this).call(this)}},{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}]),r}(x);function ie(){return new C}function se(e){return{toString:e}.toString()}function le(e,t,r){return se((function(){var n=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var r in t)this[r]=t[r]}}}(t);function a(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(this instanceof a)return n.apply(this,t),this;var o=_construct(a,t);return _.annotation=o,_;function _(e,t,r){for(var n=e.hasOwnProperty("__parameters__")?e.__parameters__:Object.defineProperty(e,"__parameters__",{value:[]}).__parameters__;n.length<=r;)n.push(null);return(n[r]=n[r]||[]).push(o),e}}return r&&(a.prototype=Object.create(r.prototype)),a.prototype.ngMetadataName=e,a.annotationCls=a,a}))}var ce=le("Inject",(function(e){return{token:e}})),Ee=le("Optional"),ue=le("Self"),de=le("SkipSelf"),Te=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});function fe(e){for(var t in e)if(e[t]===fe)return t;throw Error("Could not find renamed property on target object.")}function pe(e,t){for(var r in t)t.hasOwnProperty(r)&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Pe(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}var Se=Pe;function Ae(e){return{factory:e.factory,providers:e.providers||[],imports:e.imports||[]}}function he(e){return ve(e,e[ge])||ve(e,e[Re])}function ve(e,t){return t&&t.token===e?t:null}function me(e){return e&&(e.hasOwnProperty(Oe)||e.hasOwnProperty(Ie))?e[Oe]:null}var ge=fe({"\u0275prov":fe}),Oe=fe({"\u0275inj":fe}),Ne=fe({"\u0275provFallback":fe}),Re=fe({ngInjectableDef:fe}),Ie=fe({ngInjectorDef:fe});function be(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(be).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var r=t.indexOf("\n");return-1===r?t:t.substring(0,r)}function ye(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var Le=fe({__forward_ref__:fe});function Ye(e){return e.__forward_ref__=Ye,e.toString=function(){return be(this())},e}function Me(e){return xe(e)?e():e}function xe(e){return"function"==typeof e&&e.hasOwnProperty(Le)&&e.__forward_ref__===Ye}var Ce,we="undefined"!=typeof globalThis&&globalThis,Ue="undefined"!=typeof window&&window,ke="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,De="undefined"!=typeof global&&global,Fe=we||De||Ue||ke,Ge=fe({"\u0275cmp":fe}),Ke=fe({"\u0275dir":fe}),Be=fe({"\u0275pipe":fe}),Xe=fe({"\u0275mod":fe}),He=fe({"\u0275loc":fe}),je=fe({"\u0275fac":fe}),ze=fe({__NG_ELEMENT_ID__:fe}),Qe=function(){function e(t,r){_classCallCheck(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof r?this.__NG_ELEMENT_ID__=r:void 0!==r&&(this.\u0275prov=Pe({token:this,providedIn:r.providedIn||"root",factory:r.factory}))}return _createClass(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),Ve=new Qe("INJECTOR",-1),qe={},We=/\n/gm,Je=fe({provide:String,useValue:fe}),Ze=void 0;function $e(e){var t=Ze;return Ze=e,t}function et(e){var t=Ce;return Ce=e,t}function tt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Te.Default;if(void 0===Ze)throw new Error("inject() must be called from an injection context");return null===Ze?at(e,void 0,t):Ze.get(e,t&Te.Optional?null:void 0,t)}function rt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Te.Default;return(Ce||tt)(Me(e),t)}var nt=rt;function at(e,t,r){var n=he(e);if(n&&"root"==n.providedIn)return void 0===n.value?n.value=n.factory():n.value;if(r&Te.Optional)return null;if(void 0!==t)return t;throw new Error("Injector: NOT_FOUND [".concat(be(e),"]"))}function ot(e){for(var t=[],r=0;r<e.length;r++){var n=Me(e[r]);if(Array.isArray(n)){if(0===n.length)throw new Error("Arguments array must have arguments.");for(var a=void 0,o=Te.Default,_=0;_<n.length;_++){var i=n[_];i instanceof Ee||"Optional"===i.ngMetadataName||i===Ee?o|=Te.Optional:i instanceof de||"SkipSelf"===i.ngMetadataName||i===de?o|=Te.SkipSelf:i instanceof ue||"Self"===i.ngMetadataName||i===ue?o|=Te.Self:a=i instanceof ce||i===ce?i.token:i}t.push(rt(a,o))}else t.push(rt(n))}return t}var _t=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qe;if(t===qe){var r=new Error("NullInjectorError: No provider for ".concat(be(e),"!"));throw r.name="NullInjectorError",r}return t}}]),e}(),it=function e(){_classCallCheck(this,e)},st=function e(){_classCallCheck(this,e)};function lt(e,t){e.forEach((function(e){return Array.isArray(e)?lt(e,t):t(e)}))}function ct(e,t,r){t>=e.length?e.push(r):e.splice(t,0,r)}function Et(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function ut(e,t){for(var r=[],n=0;n<e;n++)r.push(t);return r}function dt(e,t){var r=Tt(e,t);if(r>=0)return e[1|r]}function Tt(e,t){return function(e,t,r){for(var n=0,a=e.length>>1;a!==n;){var o=n+(a-n>>1),_=e[o<<1];if(t===_)return o<<1;_>t?a=o:n=o+1}return~(a<<1)}(e,t)}var ft=function(){var e={OnPush:0,Default:1};return e[e.OnPush]="OnPush",e[e.Default]="Default",e}(),pt=function(){var e={Emulated:0,Native:1,None:2,ShadowDom:3};return e[e.Emulated]="Emulated",e[e.Native]="Native",e[e.None]="None",e[e.ShadowDom]="ShadowDom",e}(),Pt={},St=[],At=0;function ht(e){return se((function(){var t=e.type,r=t.prototype,n={},a={type:t,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputs:null,outputs:null,exportAs:e.exportAs||null,onChanges:null,onInit:r.ngOnInit||null,doCheck:r.ngDoCheck||null,afterContentInit:r.ngAfterContentInit||null,afterContentChecked:r.ngAfterContentChecked||null,afterViewInit:r.ngAfterViewInit||null,afterViewChecked:r.ngAfterViewChecked||null,onDestroy:r.ngOnDestroy||null,onPush:e.changeDetection===ft.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||St,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||pt.Emulated,id:"c",styles:e.styles||St,_:null,setInput:null,schemas:e.schemas||null,tView:null},o=e.directives,_=e.features,i=e.pipes;return a.id+=At++,a.inputs=Nt(e.inputs,n),a.outputs=Nt(e.outputs),_&&_.forEach((function(e){return e(a)})),a.directiveDefs=o?function(){return("function"==typeof o?o():o).map(vt)}:null,a.pipeDefs=i?function(){return("function"==typeof i?i():i).map(mt)}:null,a}))}function vt(e){return It(e)||function(e){return e[Ke]||null}(e)}function mt(e){return function(e){return e[Be]||null}(e)}var gt={};function Ot(e){var t={type:e.type,bootstrap:e.bootstrap||St,declarations:e.declarations||St,imports:e.imports||St,exports:e.exports||St,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&se((function(){gt[e.id]=e.type})),t}function Nt(e,t){if(null==e)return Pt;var r={};for(var n in e)if(e.hasOwnProperty(n)){var a=e[n],o=a;Array.isArray(a)&&(o=a[1],a=a[0]),r[a]=n,t&&(t[a]=o)}return r}var Rt=ht;function It(e){return e[Ge]||null}function bt(e,t){return e.hasOwnProperty(je)?e[je]:null}function yt(e,t){var r=e[Xe]||null;if(!r&&!0===t)throw new Error("Type ".concat(be(e)," does not have '\u0275mod' property."));return r}function Lt(e){return Array.isArray(e)&&"object"==typeof e[1]}function Yt(e){return Array.isArray(e)&&!0===e[1]}function Mt(e){return 0!=(8&e.flags)}function xt(e){return 2==(2&e.flags)}function Ct(e){return 1==(1&e.flags)}function wt(e){return null!==e.template}function Ut(e){return 0!=(512&e[2])}var kt=void 0;function Dt(){return void 0!==kt?kt:"undefined"!=typeof document?document:void 0}function Ft(e){return!!e.listen}var Gt={createRenderer:function(e,t){return Dt()}};function Kt(e){for(;Array.isArray(e);)e=e[0];return e}function Bt(e,t){return Kt(t[e+20])}function Xt(e,t){return Kt(t[e.index])}function Ht(e,t){return e.data[t+20]}function jt(e,t){var r=t[e];return Lt(r)?r:r[0]}function zt(e){var t=function(e){return e.__ngContext__||null}(e);return t?Array.isArray(t)?t:t.lView:null}function Qt(e){return 4==(4&e[2])}function Vt(e){return 128==(128&e[2])}function qt(e,t){return null===e||null==t?null:e[t]}function Wt(e){e[18]=0}function Jt(e,t){e[5]+=t;for(var r=e,n=e[3];null!==n&&(1===t&&1===r[5]||-1===t&&0===r[5]);)n[5]+=t,r=n,n=n[3]}var Zt={lFrame:Pr(null),bindingsEnabled:!0,checkNoChangesMode:!1};function $t(){return Zt.bindingsEnabled}function er(){return Zt.lFrame.lView}function tr(){return Zt.lFrame.tView}function rr(e){Zt.lFrame.contextLView=e}function nr(){return Zt.lFrame.previousOrParentTNode}function ar(e,t){Zt.lFrame.previousOrParentTNode=e,Zt.lFrame.isParent=t}function or(){return Zt.lFrame.isParent}function _r(){Zt.lFrame.isParent=!1}function ir(){return Zt.checkNoChangesMode}function sr(e){Zt.checkNoChangesMode=e}function lr(){return Zt.lFrame.bindingIndex++}function cr(e,t){var r=Zt.lFrame;r.bindingIndex=r.bindingRootIndex=e,Er(t)}function Er(e){Zt.lFrame.currentDirectiveIndex=e}function ur(){return Zt.lFrame.currentQueryIndex}function dr(e){Zt.lFrame.currentQueryIndex=e}function Tr(e,t){var r=pr();Zt.lFrame=r,r.previousOrParentTNode=t,r.lView=e}function fr(e,t){var r=pr(),n=e[1];Zt.lFrame=r,r.previousOrParentTNode=t,r.lView=e,r.tView=n,r.contextLView=e,r.bindingIndex=n.bindingStartIndex}function pr(){var e=Zt.lFrame,t=null===e?null:e.child;return null===t?Pr(e):t}function Pr(e){var t={previousOrParentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:0,contextLView:null,elementDepthCount:0,currentNamespace:null,currentSanitizer:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null};return null!==e&&(e.child=t),t}function Sr(){var e=Zt.lFrame;return Zt.lFrame=e.parent,e.previousOrParentTNode=null,e.lView=null,e}var Ar=Sr;function hr(){var e=Sr();e.isParent=!0,e.tView=null,e.selectedIndex=0,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.currentSanitizer=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function vr(){return Zt.lFrame.selectedIndex}function mr(e){Zt.lFrame.selectedIndex=e}function gr(){var e=Zt.lFrame;return Ht(e.tView,e.selectedIndex)}function Or(e,t){for(var r=t.directiveStart,n=t.directiveEnd;r<n;r++){var a=e.data[r];a.afterContentInit&&(e.contentHooks||(e.contentHooks=[])).push(-r,a.afterContentInit),a.afterContentChecked&&((e.contentHooks||(e.contentHooks=[])).push(r,a.afterContentChecked),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(r,a.afterContentChecked)),a.afterViewInit&&(e.viewHooks||(e.viewHooks=[])).push(-r,a.afterViewInit),a.afterViewChecked&&((e.viewHooks||(e.viewHooks=[])).push(r,a.afterViewChecked),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(r,a.afterViewChecked)),null!=a.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(r,a.onDestroy)}}function Nr(e,t,r){br(e,t,3,r)}function Rr(e,t,r,n){(3&e[2])===r&&br(e,t,r,n)}function Ir(e,t){var r=e[2];(3&r)===t&&(r&=2047,r+=1,e[2]=r)}function br(e,t,r,n){for(var a=null!=n?n:-1,o=0,_=void 0!==n?65535&e[18]:0;_<t.length;_++)if("number"==typeof t[_+1]){if(o=t[_],null!=n&&o>=n)break}else t[_]<0&&(e[18]+=65536),(o<a||-1==a)&&(yr(e,r,t,_),e[18]=(4294901760&e[18])+_+2),_++}function yr(e,t,r,n){var a=r[n]<0,o=r[n+1],_=e[a?-r[n]:r[n]];a?e[2]>>11<e[18]>>16&&(3&e[2])===t&&(e[2]+=2048,o.call(_)):o.call(_)}var Lr=function e(t,r,n){_classCallCheck(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=r,this.injectImpl=n};function Yr(e,t,r){for(var n=Ft(e),a=0;a<r.length;){var o=r[a];if("number"==typeof o){if(0!==o)break;a++;var _=r[a++],i=r[a++],s=r[a++];n?e.setAttribute(t,i,s,_):t.setAttributeNS(_,i,s)}else{var l=o,c=r[++a];xr(l)?n&&e.setProperty(t,l,c):n?e.setAttribute(t,l,c):t.setAttribute(l,c),a++}}return a}function Mr(e){return 3===e||4===e||6===e}function xr(e){return 64===e.charCodeAt(0)}function Cr(e,t){if(null===t||0===t.length);else if(null===e||0===e.length)e=t.slice();else for(var r=-1,n=0;n<t.length;n++){var a=t[n];"number"==typeof a?r=a:0===r||wr(e,r,a,null,-1===r||2===r?t[++n]:null)}return e}function wr(e,t,r,n,a){var o=0,_=e.length;if(-1===t)_=-1;else for(;o<e.length;){var i=e[o++];if("number"==typeof i){if(i===t){_=-1;break}if(i>t){_=o-1;break}}}for(;o<e.length;){var s=e[o];if("number"==typeof s)break;if(s===r){if(null===n)return void(null!==a&&(e[o+1]=a));if(n===e[o+1])return void(e[o+2]=a)}o++,null!==n&&o++,null!==a&&o++}-1!==_&&(e.splice(_,0,t),o=_+1),e.splice(o++,0,r),null!==n&&e.splice(o++,0,n),null!==a&&e.splice(o++,0,a)}function Ur(e){return-1!==e}function kr(e){return 32767&e}function Dr(e){return e>>16}function Fr(e,t){for(var r=Dr(e),n=t;r>0;)n=n[15],r--;return n}function Gr(e){return"string"==typeof e?e:null==e?"":""+e}function Kr(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Gr(e)}var Br=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Fe);function Xr(e){return e instanceof Function?e():e}var Hr=!0;function jr(e){var t=Hr;return Hr=e,t}var zr=0;function Qr(e,t){var r=qr(e,t);if(-1!==r)return r;var n=t[1];n.firstCreatePass&&(e.injectorIndex=t.length,Vr(n.data,e),Vr(t,null),Vr(n.blueprint,null));var a=Wr(e,t),o=e.injectorIndex;if(Ur(a))for(var _=kr(a),i=Fr(a,t),s=i[1].data,l=0;l<8;l++)t[o+l]=i[_+l]|s[_+l];return t[o+8]=a,o}function Vr(e,t){e.push(0,0,0,0,0,0,0,0,t)}function qr(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null==t[e.injectorIndex+8]?-1:e.injectorIndex}function Wr(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var r=t[6],n=1;r&&-1===r.injectorIndex;)r=(t=t[15])?t[6]:null,n++;return r?r.injectorIndex|n<<16:-1}function Jr(e,t,r){!function(e,t,r){var n="string"!=typeof r?r[ze]:r.charCodeAt(0)||0;null==n&&(n=r[ze]=zr++);var a=255&n,o=1<<a,_=64&a,i=32&a,s=t.data;128&a?_?i?s[e+7]|=o:s[e+6]|=o:i?s[e+5]|=o:s[e+4]|=o:_?i?s[e+3]|=o:s[e+2]|=o:i?s[e+1]|=o:s[e]|=o}(e,t,r)}function Zr(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Te.Default,a=arguments.length>4?arguments[4]:void 0;if(null!==e){var o=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e[ze];return"number"==typeof t&&t>0?255&t:t}(r);if("function"==typeof o){Tr(t,e);try{var _=o();if(null!=_||n&Te.Optional)return _;throw new Error("No provider for ".concat(Kr(r),"!"))}finally{Ar()}}else if("number"==typeof o){if(-1===o)return new on(e,t);var i=null,s=qr(e,t),l=-1,c=n&Te.Host?t[16][6]:null;for((-1===s||n&Te.SkipSelf)&&(l=-1===s?Wr(e,t):t[s+8],an(n,!1)?(i=t[1],s=kr(l),t=Fr(l,t)):s=-1);-1!==s;){l=t[s+8];var E=t[1];if(nn(o,s,E.data)){var u=en(s,t,r,i,n,c);if(u!==$r)return u}an(n,t[1].data[s+8]===c)&&nn(o,s,t)?(i=E,s=kr(l),t=Fr(l,t)):s=-1}}}if(n&Te.Optional&&void 0===a&&(a=null),0==(n&(Te.Self|Te.Host))){var d=t[9],T=et(void 0);try{return d?d.get(r,a,n&Te.Optional):at(r,a,n&Te.Optional)}finally{et(T)}}if(n&Te.Optional)return a;throw new Error("NodeInjector: NOT_FOUND [".concat(Kr(r),"]"))}var $r={};function en(e,t,r,n,a,o){var _=t[1],i=_.data[e+8],s=tn(i,_,r,null==n?xt(i)&&Hr:n!=_&&3===i.type,a&Te.Host&&o===i);return null!==s?rn(t,_,s,i):$r}function tn(e,t,r,n,a){for(var o=e.providerIndexes,_=t.data,i=65535&o,s=e.directiveStart,l=o>>16,c=a?i+l:e.directiveEnd,E=n?i:i+l;E<c;E++){var u=_[E];if(E<s&&r===u||E>=s&&u.type===r)return E}if(a){var d=_[s];if(d&&wt(d)&&d.type===r)return s}return null}function rn(e,t,r,n){var a=e[r],o=t.data;if(a instanceof Lr){var _=a;if(_.resolving)throw new Error("Circular dep for ".concat(Kr(o[r])));var i,s=jr(_.canSeeViewProviders);_.resolving=!0,_.injectImpl&&(i=et(_.injectImpl)),Tr(e,n);try{a=e[r]=_.factory(void 0,o,e,n),t.firstCreatePass&&r>=n.directiveStart&&function(e,t,r){var n=t.onChanges,a=t.onInit,o=t.doCheck;n&&((r.preOrderHooks||(r.preOrderHooks=[])).push(e,n),(r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(e,n)),a&&(r.preOrderHooks||(r.preOrderHooks=[])).push(-e,a),o&&((r.preOrderHooks||(r.preOrderHooks=[])).push(e,o),(r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(e,o))}(r,o[r],t)}finally{_.injectImpl&&et(i),jr(s),_.resolving=!1,Ar()}}return a}function nn(e,t,r){var n=64&e,a=32&e;return!!((128&e?n?a?r[t+7]:r[t+6]:a?r[t+5]:r[t+4]:n?a?r[t+3]:r[t+2]:a?r[t+1]:r[t])&1<<e)}function an(e,t){return!(e&Te.Self||e&Te.Host&&t)}var on=function(){function e(t,r){_classCallCheck(this,e),this._tNode=t,this._lView=r}return _createClass(e,[{key:"get",value:function(e,t){return Zr(this._tNode,this._lView,e,void 0,t)}}]),e}();function _n(e){return se((function(){var t=Object.getPrototypeOf(e.prototype).constructor,r=t[je]||function e(t){var r=t;if(xe(t))return function(){var t=e(Me(r));return t?t():null};var n=bt(r);if(null===n){var a=me(r);n=a&&a.factory}return n||null}(t);return null!==r?r:function(e){return new e}}))}function sn(e){return e.ngDebugContext}function ln(e){return e.ngOriginalError}function cn(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];e.error.apply(e,r)}var En=function(){function e(){_classCallCheck(this,e),this._console=console}return _createClass(e,[{key:"handleError",value:function(e){var t=this._findOriginalError(e),r=this._findContext(e),n=function(e){return e.ngErrorLogger||cn}(e);n(this._console,"ERROR",e),t&&n(this._console,"ORIGINAL ERROR",t),r&&n(this._console,"ERROR CONTEXT",r)}},{key:"_findContext",value:function(e){return e?sn(e)?sn(e):this._findContext(ln(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=ln(e);t&&ln(t);)t=ln(t);return t}}]),e}(),un=function(){function e(t){_classCallCheck(this,e),this.changingThisBreaksApplicationSecurity=t}return _createClass(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity)+" (see http://g.co/ng/security#xss)"}}]),e}(),dn=function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"getTypeName",value:function(){return"HTML"}}]),r}(un),Tn=function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"getTypeName",value:function(){return"Style"}}]),r}(un),fn=function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"getTypeName",value:function(){return"Script"}}]),r}(un),pn=function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"getTypeName",value:function(){return"URL"}}]),r}(un),Pn=function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),r}(un);function Sn(e){return e instanceof un?e.changingThisBreaksApplicationSecurity:e}function An(e,t){var r=hn(e);if(null!=r&&r!==t){if("ResourceURL"===r&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(r," (see http://g.co/ng/security#xss)"))}return r===t}function hn(e){return e instanceof un&&e.getTypeName()||null}var vn=!0,mn=!1;function gn(){return mn=!0,vn}var On=function(){function e(t){_classCallCheck(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert");var r=this.inertDocument.body;if(null==r){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n),r=this.inertDocument.createElement("body"),n.appendChild(r)}r.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',!r.querySelector||r.querySelector("svg")?(r.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',this.getInertBodyElement=r.querySelector&&r.querySelector("svg img")&&function(){try{return!!window.DOMParser}catch(e){return!1}}()?this.getInertBodyElement_DOMParser:this.getInertBodyElement_InertDocument):this.getInertBodyElement=this.getInertBodyElement_XHR}return _createClass(e,[{key:"getInertBodyElement_XHR",value:function(e){e="<body><remove></remove>"+e+"</body>";try{e=encodeURI(e)}catch(n){return null}var t=new XMLHttpRequest;t.responseType="document",t.open("GET","data:text/html;charset=utf-8,"+e,!1),t.send(void 0);var r=t.response.body;return r.removeChild(r.firstChild),r}},{key:"getInertBodyElement_DOMParser",value:function(e){e="<body><remove></remove>"+e+"</body>";try{var t=(new window.DOMParser).parseFromString(e,"text/html").body;return t.removeChild(t.firstChild),t}catch(r){return null}}},{key:"getInertBodyElement_InertDocument",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=e,t;var r=this.inertDocument.createElement("body");return r.innerHTML=e,this.defaultDoc.documentMode&&this.stripCustomNsAttrs(r),r}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,r=t.length-1;0<r;r--){var n=t.item(r).name;"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||e.removeAttribute(n)}for(var a=e.firstChild;a;)a.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(a),a=a.nextSibling}}]),e}(),Nn=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,Rn=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function In(e){return(e=String(e)).match(Nn)||e.match(Rn)?e:(gn()&&console.warn("WARNING: sanitizing unsafe URL value ".concat(e," (see http://g.co/ng/security#xss)")),"unsafe:"+e)}function bn(e){var t,r={},n=_createForOfIteratorHelper(e.split(","));try{for(n.s();!(t=n.n()).done;){r[t.value]=!0}}catch(a){n.e(a)}finally{n.f()}return r}function yn(){for(var e={},t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];for(var a=0,o=r;a<o.length;a++){var _=o[a];for(var i in _)_.hasOwnProperty(i)&&(e[i]=!0)}return e}var Ln,Yn=bn("area,br,col,hr,img,wbr"),Mn=bn("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),xn=bn("rp,rt"),Cn=yn(xn,Mn),wn=yn(Yn,yn(Mn,bn("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),yn(xn,bn("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Cn),Un=bn("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),kn=bn("srcset"),Dn=yn(Un,kn,bn("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),bn("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),Fn=bn("script,style,template"),Gn=function(){function e(){_classCallCheck(this,e),this.sanitizedSomething=!1,this.buf=[]}return _createClass(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,r=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?r=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,r&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var n=this.checkClobberedElement(t,t.nextSibling);if(n){t=n;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!wn.hasOwnProperty(t))return this.sanitizedSomething=!0,!Fn.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var r,n=e.attributes,a=0;a<n.length;a++){var o=n.item(a),_=o.name,i=_.toLowerCase();if(Dn.hasOwnProperty(i)){var s=o.value;Un[i]&&(s=In(s)),kn[i]&&(r=s,s=(r=String(r)).split(",").map((function(e){return In(e.trim())})).join(", ")),this.buf.push(" ",_,'="',Xn(s),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();wn.hasOwnProperty(t)&&!Yn.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(Xn(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),Kn=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Bn=/([^\#-~ |!])/g;function Xn(e){return e.replace(/&/g,"&amp;").replace(Kn,(function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"})).replace(Bn,(function(e){return"&#"+e.charCodeAt(0)+";"})).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Hn(e,t){var r=null;try{Ln=Ln||new On(e);var n=t?String(t):"";r=Ln.getInertBodyElement(n);var a=5,o=n;do{if(0===a)throw new Error("Failed to sanitize html because the input is unstable");a--,n=o,o=r.innerHTML,r=Ln.getInertBodyElement(n)}while(n!==o);var _=new Gn,i=_.sanitizeChildren(jn(r)||r);return gn()&&_.sanitizedSomething&&console.warn("WARNING: sanitizing HTML stripped some content, see http://g.co/ng/security#xss"),i}finally{if(r)for(var s=jn(r)||r;s.firstChild;)s.removeChild(s.firstChild)}}function jn(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var zn=function(){var e={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return e[e.NONE]="NONE",e[e.HTML]="HTML",e[e.STYLE]="STYLE",e[e.SCRIPT]="SCRIPT",e[e.URL]="URL",e[e.RESOURCE_URL]="RESOURCE_URL",e}(),Qn=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|Z|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:attr|calc|var))\\([-0-9.%, #a-zA-Z]+\\))$","g"),Vn=/^url\(([^)]+)\)$/;function qn(e){var t=Jn();return t?t.sanitize(zn.HTML,e)||"":An(e,"HTML")?Sn(e):Hn(Dt(),Gr(e))}function Wn(e){var t=Jn();return t?t.sanitize(zn.URL,e)||"":An(e,"URL")?Sn(e):In(Gr(e))}function Jn(){var e=er();return e&&e[12]}function Zn(e,t){e.__ngContext__=t}function $n(e){throw new Error("Multiple components match node with tagname ".concat(e.tagName))}function ea(){throw new Error("Cannot mix multi providers and regular providers")}function ta(e,t,r){for(var n=e.length;;){var a=e.indexOf(t,r);if(-1===a)return a;if(0===a||e.charCodeAt(a-1)<=32){var o=t.length;if(a+o===n||e.charCodeAt(a+o)<=32)return a}r=a+1}}function ra(e,t,r){for(var n=0;n<e.length;){var a=e[n++];if(r&&"class"===a){if(-1!==ta((a=e[n]).toLowerCase(),t,0))return!0}else if(1===a){for(;n<e.length&&"string"==typeof(a=e[n++]);)if(a.toLowerCase()===t)return!0;return!1}}return!1}function na(e){return 0===e.type&&"ng-template"!==e.tagName}function aa(e,t,r){return t===(0!==e.type||r?e.tagName:"ng-template")}function oa(e,t,r){for(var n=4,a=e.attrs||[],o=function(e){for(var t=0;t<e.length;t++)if(Mr(e[t]))return t;return e.length}(a),_=!1,i=0;i<t.length;i++){var s=t[i];if("number"!=typeof s){if(!_)if(4&n){if(n=2|1&n,""!==s&&!aa(e,s,r)||""===s&&1===t.length){if(_a(n))return!1;_=!0}}else{var l=8&n?s:t[++i];if(8&n&&null!==e.attrs){if(!ra(e.attrs,l,r)){if(_a(n))return!1;_=!0}continue}var c=ia(8&n?"class":s,a,na(e),r);if(-1===c){if(_a(n))return!1;_=!0;continue}if(""!==l){var E;E=c>o?"":a[c+1].toLowerCase();var u=8&n?E:null;if(u&&-1!==ta(u,l,0)||2&n&&l!==E){if(_a(n))return!1;_=!0}}}}else{if(!_&&!_a(n)&&!_a(s))return!1;if(_&&_a(s))continue;_=!1,n=s|1&n}}return _a(n)||_}function _a(e){return 0==(1&e)}function ia(e,t,r,n){if(null===t)return-1;var a=0;if(n||!r){for(var o=!1;a<t.length;){var _=t[a];if(_===e)return a;if(3===_||6===_)o=!0;else{if(1===_||2===_){for(var i=t[++a];"string"==typeof i;)i=t[++a];continue}if(4===_)break;if(0===_){a+=4;continue}}a+=o?1:2}return-1}return function(e,t){var r=e.indexOf(4);if(r>-1)for(r++;r<e.length;){var n=e[r];if("number"==typeof n)return-1;if(n===t)return r;r++}return-1}(t,e)}function sa(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=0;n<t.length;n++)if(oa(e,t[n],r))return!0;return!1}function la(e,t){e:for(var r=0;r<t.length;r++){var n=t[r];if(e.length===n.length){for(var a=0;a<e.length;a++)if(e[a]!==n[a])continue e;return!0}}return!1}function ca(e,t){return e?":not("+t.trim()+")":t}function Ea(e){for(var t=e[0],r=1,n=2,a="",o=!1;r<e.length;){var _=e[r];if("string"==typeof _)if(2&n){var i=e[++r];a+="["+_+(i.length>0?'="'+i+'"':"")+"]"}else 8&n?a+="."+_:4&n&&(a+=" "+_);else""===a||_a(_)||(t+=ca(o,a),a=""),n=_,o=o||!_a(n);r++}return""!==a&&(t+=ca(o,a)),t}var ua={};function da(e){var t=e[3];return Yt(t)?t[3]:t}function Ta(e){fa(tr(),er(),vr()+e,ir())}function fa(e,t,r,n){if(!n)if(3==(3&t[2])){var a=e.preOrderCheckHooks;null!==a&&Nr(t,a,r)}else{var o=e.preOrderHooks;null!==o&&Rr(t,o,0,r)}mr(r)}function pa(e,t){return e<<17|t<<2}function Pa(e){return e>>17&32767}function Sa(e){return 2|e}function Aa(e){return(131068&e)>>2}function ha(e,t){return-131069&e|t<<2}function va(e){return 1|e}function ma(e,t){var r=e.contentQueries;if(null!==r)for(var n=0;n<r.length;n+=2){var a=r[n],o=r[n+1];if(-1!==o){var _=e.data[o];dr(a),_.contentQueries(2,t[o],o)}}}function ga(e,t,r){return Ft(t)?t.createElement(e,r):null===r?t.createElement(e):t.createElementNS(r,e)}function Oa(e,t,r,n,a,o,_,i,s,l){var c=t.blueprint.slice();return c[0]=a,c[2]=140|n,Wt(c),c[3]=c[15]=e,c[8]=r,c[10]=_||e&&e[10],c[11]=i||e&&e[11],c[12]=s||e&&e[12]||null,c[9]=l||e&&e[9]||null,c[6]=o,c[16]=2==t.type?e[16]:c,c}function Na(e,t,r,n,a,o){var _=r+20,i=e.data[_]||function(e,t,r,n,a,o){var _=nr(),i=or(),s=i?_:_&&_.parent,l=e.data[r]=Ca(0,s&&s!==t?s:null,n,r,a,o);return null===e.firstChild&&(e.firstChild=l),_&&(!i||null!=_.child||null===l.parent&&2!==_.type?i||(_.next=l):_.child=l),l}(e,t,_,n,a,o);return ar(i,!0),i}function Ra(e,t,r){fr(t,t[6]);try{var n=e.viewQuery;null!==n&&ao(1,n,r);var a=e.template;null!==a&&ya(e,t,a,1,r),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&ma(e,t),e.staticViewQueries&&ao(2,e.viewQuery,r);var o=e.components;null!==o&&function(e,t){for(var r=0;r<t.length;r++)$a(e,t[r])}(t,o)}catch(_){throw e.firstCreatePass&&(e.incompleteFirstPass=!0),_}finally{t[2]&=-5,hr()}}function Ia(e,t,r,n){var a=t[2];if(256!=(256&a)){fr(t,t[6]);var o=ir();try{Wt(t),Zt.lFrame.bindingIndex=e.bindingStartIndex,null!==r&&ya(e,t,r,2,n);var _=3==(3&a);if(!o)if(_){var i=e.preOrderCheckHooks;null!==i&&Nr(t,i,null)}else{var s=e.preOrderHooks;null!==s&&Rr(t,s,0,null),Ir(t,0)}if(function(e){for(var t=Wa(e);null!==t;t=Ja(t))if(0!=(1&t[2]))for(var r=t[9],n=0;n<r.length;n++){var a=r[n],o=a[3];0==(1024&a[2])&&Jt(o,1),a[2]|=1024}}(t),function(e){for(var t=Wa(e);null!==t;t=Ja(t))for(var r=10;r<t.length;r++){var n=t[r],a=n[1];Vt(n)&&Ia(a,n,a.template,n[8])}}(t),null!==e.contentQueries&&ma(e,t),!o)if(_){var l=e.contentCheckHooks;null!==l&&Nr(t,l)}else{var c=e.contentHooks;null!==c&&Rr(t,c,1),Ir(t,1)}!function(e,t){try{var r=e.expandoInstructions;if(null!==r)for(var n=e.expandoStartIndex,a=-1,o=0;o<r.length;o++){var _=r[o];"number"==typeof _?_<=0?(mr(0-_),a=n+=9+r[++o]):n+=_:(null!==_&&(cr(n,a),_(2,t[a])),a++)}}finally{mr(-1)}}(e,t);var E=e.components;null!==E&&function(e,t){for(var r=0;r<t.length;r++)Za(e,t[r])}(t,E);var u=e.viewQuery;if(null!==u&&ao(2,u,n),!o)if(_){var d=e.viewCheckHooks;null!==d&&Nr(t,d)}else{var T=e.viewHooks;null!==T&&Rr(t,T,2),Ir(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),o||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Jt(t[3],-1))}finally{hr()}}}function ba(e,t,r,n){var a=t[10],o=!ir(),_=Qt(t);try{o&&!_&&a.begin&&a.begin(),_&&Ra(e,t,n),Ia(e,t,r,n)}finally{o&&!_&&a.end&&a.end()}}function ya(e,t,r,n,a){var o=vr();try{mr(-1),2&n&&t.length>20&&fa(e,t,0,ir()),r(n,a)}finally{mr(o)}}function La(e,t,r){$t()&&(function(e,t,r,n){var a=r.directiveStart,o=r.directiveEnd;e.firstCreatePass||Qr(r,t),Zn(n,t);for(var _=r.initialInputs,i=a;i<o;i++){var s=e.data[i],l=wt(s);l&&za(t,r,s);var c=rn(t,e,i,r);Zn(c,t),null!==_&&Qa(0,i-a,c,s,0,_),l&&(jt(r.index,t)[8]=c)}}(e,t,r,Xt(r,t)),128==(128&r.flags)&&function(e,t,r){var n=r.directiveStart,a=r.directiveEnd,o=e.expandoInstructions,_=e.firstCreatePass,i=r.index-20,s=Zt.lFrame.currentDirectiveIndex;try{mr(i);for(var l=n;l<a;l++){var c=e.data[l],E=t[l];Er(l),null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs?Ga(c,E):_&&o.push(null)}}finally{mr(-1),Er(s)}}(e,t,r))}function Ya(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xt,n=t.localNames;if(null!==n)for(var a=t.index+1,o=0;o<n.length;o+=2){var _=n[o+1],i=-1===_?r(t,e):e[_];e[a++]=i}}function Ma(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=xa(1,-1,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function xa(e,t,r,n,a,o,_,i,s,l){var c=20+n,E=c+a,u=function(e,t){for(var r=[],n=0;n<t;n++)r.push(n<e?null:ua);return r}(c,E);return u[1]={type:e,id:t,blueprint:u,template:r,queries:null,viewQuery:i,node:null,data:u.slice().fill(null,c),bindingStartIndex:c,expandoStartIndex:E,expandoInstructions:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof _?_():_,firstChild:null,schemas:s,consts:l,incompleteFirstPass:!1}}function Ca(e,t,r,n,a,o){return{type:r,index:n,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,tagName:a,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,residualStyles:void 0,classes:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function wa(e,t,r){for(var n in e)if(e.hasOwnProperty(n)){var a=e[n];(r=null===r?{}:r).hasOwnProperty(n)?r[n].push(t,a):r[n]=[t,a]}return r}function Ua(e,t,r,n,a,o,_,i){var s,l,c=Xt(t,r),E=t.inputs;!i&&null!=E&&(s=E[n])?(lo(e,r,s,n,a),xt(t)&&function(e,t){var r=jt(t,e);16&r[2]||(r[2]|=64)}(r,t.index)):3===t.type&&(n="class"===(l=n)?"className":"for"===l?"htmlFor":"formaction"===l?"formAction":"innerHtml"===l?"innerHTML":"readonly"===l?"readOnly":"tabindex"===l?"tabIndex":l,a=null!=_?_(a,t.tagName||"",n):a,Ft(o)?o.setProperty(c,n,a):xr(n)||(c.setProperty?c.setProperty(n,a):c[n]=a))}function ka(e,t,r,n){var a=!1;if($t()){var o=function(e,t,r){var n=e.directiveRegistry,a=null;if(n)for(var o=0;o<n.length;o++){var _=n[o];sa(r,_.selectors,!1)&&(a||(a=[]),Jr(Qr(r,t),e,_.type),wt(_)?(2&r.flags&&$n(r),Ba(e,r),a.unshift(_)):a.push(_))}return a}(e,t,r),_=null===n?null:{"":-1};if(null!==o){var i=0;a=!0,Ha(r,e.data.length,o.length);for(var s=0;s<o.length;s++){var l=o[s];l.providersResolver&&l.providersResolver(l)}Ka(e,r,o.length);for(var c=!1,E=!1,u=0;u<o.length;u++){var d=o[u];r.mergedAttrs=Cr(r.mergedAttrs,d.hostAttrs),ja(e,t,d),Xa(e.data.length-1,d,_),null!==d.contentQueries&&(r.flags|=8),null===d.hostBindings&&null===d.hostAttrs&&0===d.hostVars||(r.flags|=128),!c&&(d.onChanges||d.onInit||d.doCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(r.index-20),c=!0),E||!d.onChanges&&!d.doCheck||((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(r.index-20),E=!0),Da(e,d),i+=d.hostVars}!function(e,t){for(var r=t.directiveEnd,n=e.data,a=t.attrs,o=[],_=null,i=null,s=t.directiveStart;s<r;s++){var l=n[s],c=l.inputs,E=null===a||na(t)?null:Va(c,a);o.push(E),_=wa(c,s,_),i=wa(l.outputs,s,i)}null!==_&&(_.hasOwnProperty("class")&&(t.flags|=16),_.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=_,t.outputs=i}(e,r),Fa(e,t,i)}_&&function(e,t,r){if(t)for(var n=e.localNames=[],a=0;a<t.length;a+=2){var o=r[t[a+1]];if(null==o)throw new Error("Export of name '".concat(t[a+1],"' not found!"));n.push(t[a],o)}}(r,n,_)}return r.mergedAttrs=Cr(r.mergedAttrs,r.attrs),a}function Da(e,t){var r=e.expandoInstructions;r.push(t.hostBindings),0!==t.hostVars&&r.push(t.hostVars)}function Fa(e,t,r){for(var n=0;n<r;n++)t.push(ua),e.blueprint.push(ua),e.data.push(null)}function Ga(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Ka(e,t,r){var n=20-t.index,a=e.data.length-(65535&t.providerIndexes);(e.expandoInstructions||(e.expandoInstructions=[])).push(n,a,r)}function Ba(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function Xa(e,t,r){if(r){if(t.exportAs)for(var n=0;n<t.exportAs.length;n++)r[t.exportAs[n]]=e;wt(t)&&(r[""]=e)}}function Ha(e,t,r){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+r,e.providerIndexes=t}function ja(e,t,r){e.data.push(r);var n=r.factory||(r.factory=bt(r.type)),a=new Lr(n,wt(r),null);e.blueprint.push(a),t.push(a)}function za(e,t,r){var n=Xt(t,e),a=Ma(r),o=e[10],_=eo(e,Oa(e,a,null,r.onPush?64:16,n,t,o,o.createRenderer(n,r)));e[t.index]=_}function Qa(e,t,r,n,a,o){var _=o[t];if(null!==_)for(var i=n.setInput,s=0;s<_.length;){var l=_[s++],c=_[s++],E=_[s++];null!==i?n.setInput(r,E,l,c):r[c]=E}}function Va(e,t){for(var r=null,n=0;n<t.length;){var a=t[n];if(0!==a)if(5!==a){if("number"==typeof a)break;e.hasOwnProperty(a)&&(null===r&&(r=[]),r.push(a,e[a],t[n+1])),n+=2}else n+=2;else n+=4}return r}function qa(e,t,r,n){return new Array(e,!0,-2,t,null,0,n,r,null,null)}function Wa(e){for(var t=e[13];null!==t&&(!Yt(t)||t[2]>>1!=-1);)t=t[4];return t}function Ja(e){for(var t=e[4];null!==t&&(!Yt(t)||t[2]>>1!=-1);)t=t[4];return t}function Za(e,t){var r=jt(t,e);if(Vt(r)){var n=r[1];80&r[2]?Ia(n,r,n.template,r[8]):r[5]>0&&function e(t){for(var r=Wa(t);null!==r;r=Ja(r))for(var n=10;n<r.length;n++){var a=r[n];if(1024&a[2]){var o=a[1];Ia(o,a,o.template,a[8])}else a[5]>0&&e(a)}var _=t[1].components;if(null!==_)for(var i=0;i<_.length;i++){var s=jt(_[i],t);Vt(s)&&s[5]>0&&e(s)}}(r)}}function $a(e,t){var r=jt(t,e),n=r[1];!function(e,t){for(var r=t.length;r<e.blueprint.length;r++)t.push(e.blueprint[r])}(n,r),Ra(n,r,r[8])}function eo(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function to(e){for(;e;){e[2]|=64;var t=da(e);if(Ut(e)&&!t)return e;e=t}return null}function ro(e,t,r){var n=t[10];n.begin&&n.begin();try{Ia(e,t,e.template,r)}catch(a){throw so(t,a),a}finally{n.end&&n.end()}}function no(e){!function(e){for(var t=0;t<e.components.length;t++){var r=e.components[t],n=zt(r),a=n[1];ba(a,n,a.template,r)}}(e[8])}function ao(e,t,r){dr(0),t(e,r)}var oo=Promise.resolve(null);function _o(e){return e[7]||(e[7]=[])}function io(e){return e.cleanup||(e.cleanup=[])}function so(e,t){var r=e[9],n=r?r.get(En,null):null;n&&n.handleError(t)}function lo(e,t,r,n,a){for(var o=0;o<r.length;){var _=r[o++],i=r[o++],s=t[_],l=e.data[_];null!==l.setInput?l.setInput(s,a,n,i):s[i]=a}}function co(e,t){var r=t[3];return-1===e.index?Yt(r)?r:null:r}function Eo(e,t){var r=co(e,t);return r?Oo(t[11],r[7]):null}function uo(e,t,r,n,a){if(null!=n){var o,_=!1;Yt(n)?o=n:Lt(n)&&(_=!0,n=n[0]);var i=Kt(n);0===e&&null!==r?null==a?mo(t,r,i):vo(t,r,i,a||null):1===e&&null!==r?vo(t,r,i,a||null):2===e?function(e,t,r){var n=Oo(e,t);n&&function(e,t,r,n){Ft(e)?e.removeChild(t,r,n):t.removeChild(r)}(e,n,t,r)}(t,i,_):3===e&&t.destroyNode(i),null!=o&&function(e,t,r,n,a){var o=r[7];o!==Kt(r)&&uo(t,e,n,o,a);for(var _=10;_<r.length;_++){var i=r[_];yo(i[1],i,e,t,n,o)}}(t,e,o,r,a)}}function To(e,t,r,n){var a=Eo(e.node,t);a&&yo(e,t,t[11],r?1:2,a,n)}function fo(e,t){var r=e[9],n=r.indexOf(t);1024&t[2]&&Jt(t[3],-1),r.splice(n,1)}function po(e,t){if(!(e.length<=10)){var r=10+t,n=e[r];if(n){var a=n[17];null!==a&&a!==e&&fo(a,n),t>0&&(e[r-1][4]=n[4]);var o=Et(e,10+t);To(n[1],n,!1,null);var _=o[19];null!==_&&_.detachView(o[1]),n[3]=null,n[4]=null,n[2]&=-129}return n}}function Po(e,t){if(!(256&t[2])){var r=t[11];Ft(r)&&r.destroyNode&&yo(e,t,r,3,null,null),function(e){var t=e[13];if(!t)return Ao(e[1],e);for(;t;){var r=null;if(Lt(t))r=t[13];else{var n=t[10];n&&(r=n)}if(!r){for(;t&&!t[4]&&t!==e;)Lt(t)&&Ao(t[1],t),t=So(t,e);null===t&&(t=e),Lt(t)&&Ao(t[1],t),r=t&&t[4]}t=r}}(t)}}function So(e,t){var r;return Lt(e)&&(r=e[6])&&2===r.type?co(r,e):e[3]===t?null:e[3]}function Ao(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var r;if(null!=e&&null!=(r=e.destroyHooks))for(var n=0;n<r.length;n+=2){var a=t[r[n]];if(!(a instanceof Lr)){var o=r[n+1];if(Array.isArray(o))for(var _=0;_<o.length;_+=2)o[_+1].call(a[o[_]]);else o.call(a)}}}(e,t),function(e,t){var r=e.cleanup;if(null!==r){for(var n=t[7],a=0;a<r.length-1;a+=2)if("string"==typeof r[a]){var o=r[a+1],_="function"==typeof o?o(t):Kt(t[o]),i=n[r[a+2]],s=r[a+3];"boolean"==typeof s?_.removeEventListener(r[a],i,s):s>=0?n[s]():n[-s].unsubscribe(),a+=2}else r[a].call(n[r[a+1]]);t[7]=null}}(e,t);var r=t[6];r&&3===r.type&&Ft(t[11])&&t[11].destroy();var n=t[17];if(null!==n&&Yt(t[3])){n!==t[3]&&fo(n,t);var a=t[19];null!==a&&a.detachView(e)}}}function ho(e,t,r){for(var n=t.parent;null!=n&&(4===n.type||5===n.type);)n=(t=n).parent;if(null==n){var a=r[6];return 2===a.type?Eo(a,r):r[0]}if(t&&5===t.type&&4&t.flags)return Xt(t,r).parentNode;if(2&n.flags){var o=e.data,_=o[o[n.index].directiveStart].encapsulation;if(_!==pt.ShadowDom&&_!==pt.Native)return null}return Xt(n,r)}function vo(e,t,r,n){Ft(e)?e.insertBefore(t,r,n):t.insertBefore(r,n,!0)}function mo(e,t,r){Ft(e)?e.appendChild(t,r):t.appendChild(r)}function go(e,t,r,n){null!==n?vo(e,t,r,n):mo(e,t,r)}function Oo(e,t){return Ft(e)?e.parentNode(t):t.parentNode}function No(e,t){if(2===e.type){var r=co(e,t);return null===r?null:Io(r.indexOf(t,10)-10,r)}return 4===e.type||5===e.type?Xt(e,t):null}function Ro(e,t,r,n){var a=ho(e,n,t);if(null!=a){var o=t[11],_=No(n.parent||t[6],t);if(Array.isArray(r))for(var i=0;i<r.length;i++)go(o,a,r[i],_);else go(o,a,r,_)}}function Io(e,t){var r=10+e+1;if(r<t.length){var n=t[r],a=n[1].firstChild;if(null!==a)return function e(t,r){if(null!==r){var n=r.type;if(3===n)return Xt(r,t);if(0===n)return Io(-1,t[r.index]);if(4===n||5===n){var a=r.child;if(null!==a)return e(t,a);var o=t[r.index];return Yt(o)?Io(-1,o):Kt(o)}var _=t[16],i=_[6],s=da(_),l=i.projection[r.projection];return null!=l?e(s,l):e(t,r.next)}return null}(n,a)}return t[7]}function bo(e,t,r,n,a,o,_){for(;null!=r;){var i=n[r.index],s=r.type;_&&0===t&&(i&&Zn(Kt(i),n),r.flags|=4),64!=(64&r.flags)&&(4===s||5===s?(bo(e,t,r.child,n,a,o,!1),uo(t,e,a,i,o)):1===s?Lo(e,t,n,r,a,o):uo(t,e,a,i,o)),r=_?r.projectionNext:r.next}}function yo(e,t,r,n,a,o){bo(r,n,e.node.child,t,a,o,!1)}function Lo(e,t,r,n,a,o){var _=r[16],i=_[6].projection[n.projection];if(Array.isArray(i))for(var s=0;s<i.length;s++)uo(t,e,a,i[s],o);else bo(e,t,i,_[3],a,o,!0)}function Yo(e,t,r){Ft(e)?e.setAttribute(t,"style",r):t.style.cssText=r}function Mo(e,t,r){Ft(e)?""===r?e.removeAttribute(t,"class"):e.setAttribute(t,"class",r):t.className=r}var xo,Co,wo,Uo=function(){function e(t,r){_classCallCheck(this,e),this._lView=t,this._cdRefInjectingView=r,this._appRef=null,this._viewContainerRef=null,this._tViewNode=null}return _createClass(e,[{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){var e=this._viewContainerRef.indexOf(this);e>-1&&this._viewContainerRef.detach(e),this._viewContainerRef=null}Po(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){var t,r,n;t=this._lView[1],n=e,_o(r=this._lView).push(n),t.firstCreatePass&&io(t).push(r[7].length-1,null)}},{key:"markForCheck",value:function(){to(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){ro(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,r){sr(!0);try{ro(e,t,r)}finally{sr(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(e){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=e}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,yo(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}},{key:"rootNodes",get:function(){var e=this._lView;return null==e[0]?function e(t,r,n,a){for(var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==n;){var _=r[n.index];if(null!==_&&a.push(Kt(_)),Yt(_))for(var i=10;i<_.length;i++){var s=_[i],l=s[1].firstChild;null!==l&&e(s[1],s,l,a)}var c=n.type;if(4===c||5===c)e(t,r,n.child,a);else if(1===c){var E=r[16],u=E[6].projection[n.projection];if(Array.isArray(u))a.push.apply(a,_toConsumableArray(u));else{var d=da(E);e(d[1],d,u,a,!0)}}n=o?n.projectionNext:n.next}return a}(e[1],e,e[6].child,[]):[]}},{key:"context",get:function(){return this._lView[8]}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}}]),e}(),ko=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this,e))._view=e,n}return _createClass(r,[{key:"detectChanges",value:function(){no(this._view)}},{key:"checkNoChanges",value:function(){!function(e){sr(!0);try{no(e)}finally{sr(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),r}(Uo);function Do(e,t,r){return xo||(xo=function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return r}(e)),new xo(Xt(t,r))}function Fo(e,t,r,n){return Co||(Co=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a){var o;return _classCallCheck(this,r),(o=t.call(this))._declarationView=e,o._declarationTContainer=n,o.elementRef=a,o}return _createClass(r,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,r=Oa(this._declarationView,t,e,16,null,t.node);r[17]=this._declarationView[this._declarationTContainer.index];var n=this._declarationView[19];null!==n&&(r[19]=n.createEmbeddedView(t)),Ra(t,r,e);var a=new Uo(r);return a._tViewNode=r[6],a}}]),r}(e)),0===r.type?new Co(n,r,Do(t,r,n)):null}function Go(e,t,r,n){var a;wo||(wo=function(e){_inherits(n,e);var r=_createSuper(n);function n(e,t,a){var o;return _classCallCheck(this,n),(o=r.call(this))._lContainer=e,o._hostTNode=t,o._hostView=a,o}return _createClass(n,[{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){return null!==this._lContainer[8]&&this._lContainer[8][e]||null}},{key:"createEmbeddedView",value:function(e,t,r){var n=e.createEmbeddedView(t||{});return this.insert(n,r),n}},{key:"createComponent",value:function(e,t,r,n,a){var o=r||this.parentInjector;if(!a&&null==e.ngModule&&o){var _=o.get(it,null);_&&(a=_)}var i=e.create(o,n,void 0,a);return this.insert(i.hostView,t),i}},{key:"insert",value:function(e,t){var r=e._lView,n=r[1];if(e.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");if(this.allocateContainerIfNeeded(),Yt(r[3])){var a=this.indexOf(e);if(-1!==a)this.detach(a);else{var o=r[3],_=new wo(o,o[6],o[3]);_.detach(_.indexOf(e))}}var i=this._adjustIndex(t);return function(e,t,r,n){var a=10+n,o=r.length;n>0&&(r[a-1][4]=t),n<o-10?(t[4]=r[a],ct(r,10+n,t)):(r.push(t),t[4]=null),t[3]=r;var _=t[17];null!==_&&r!==_&&function(e,t){var r=e[9];t[16]!==t[3][3][16]&&(e[2]|=1),null===r?e[9]=[t]:r.push(t)}(_,t);var i=t[19];null!==i&&i.insertView(e),t[2]|=128}(n,r,this._lContainer,i),To(n,r,!0,Io(i,this._lContainer)),e.attachToViewContainerRef(this),ct(this._lContainer[8],i,e),e}},{key:"move",value:function(e,t){if(e.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=this._lContainer[8];return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){this.allocateContainerIfNeeded();var t=this._adjustIndex(e,-1);(function(e,t){var r=po(e,t);r&&Po(r[1],r)})(this._lContainer,t),Et(this._lContainer[8],t)}},{key:"detach",value:function(e){this.allocateContainerIfNeeded();var t=this._adjustIndex(e,-1),r=po(this._lContainer,t);return r&&null!=Et(this._lContainer[8],t)?new Uo(r):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==e?this.length+t:e}},{key:"allocateContainerIfNeeded",value:function(){null===this._lContainer[8]&&(this._lContainer[8]=[])}},{key:"element",get:function(){return Do(t,this._hostTNode,this._hostView)}},{key:"injector",get:function(){return new on(this._hostTNode,this._hostView)}},{key:"parentInjector",get:function(){var e=Wr(this._hostTNode,this._hostView),t=Fr(e,this._hostView),r=function(e,t,r){if(r.parent&&-1!==r.parent.injectorIndex){for(var n=r.parent.injectorIndex,a=r.parent;null!=a.parent&&n==a.parent.injectorIndex;)a=a.parent;return a}for(var o=Dr(e),_=t,i=t[6];o>1;)i=(_=_[15])[6],o--;return i}(e,this._hostView,this._hostTNode);return Ur(e)&&null!=r?new on(r,t):new on(null,this._hostView)}},{key:"length",get:function(){return this._lContainer.length-10}}]),n}(e));var o=n[r.index];if(Yt(o))(function(e,t){e[2]=-2})(a=o);else{var _;if(4===r.type)_=Kt(o);else if(_=n[11].createComment(""),Ut(n)){var i=n[11],s=Xt(r,n);vo(i,Oo(i,s),_,function(e,t){return Ft(e)?e.nextSibling(t):t.nextSibling}(i,s))}else Ro(n[1],n,_,r);n[r.index]=a=qa(o,n,_,r),eo(n,a)}return new wo(a,r,n)}var Ko=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return Bo()},e}(),Bo=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t,r){if(!r&&xt(e)){var n=jt(e.index,t);return new Uo(n,n)}return 3===e.type||0===e.type||4===e.type||5===e.type?new Uo(t[16],t):null}(nr(),er(),e)},Xo=new Qe("Set Injector scope."),Ho={},jo={},zo=[],Qo=void 0;function Vo(){return void 0===Qo&&(Qo=new _t),Qo}function qo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;return new Wo(e,r,t||Vo(),n)}var Wo=function(){function e(t,r,n){var a=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;_classCallCheck(this,e),this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var _=[];r&&lt(r,(function(e){return a.processProvider(e,t,r)})),lt([t],(function(e){return a.processInjectorType(e,[],_)})),this.records.set(Ve,$o(void 0,this));var i=this.records.get(Xo);this.scope=null!=i?i.value:null,this.source=o||("object"==typeof t?null:be(t))}return _createClass(e,[{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach((function(e){return e.ngOnDestroy()}))}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qe,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Te.Default;this.assertNotDestroyed();var n,a=$e(this);try{if(!(r&Te.SkipSelf)){var o=this.records.get(e);if(void 0===o){var _=("function"==typeof(n=e)||"object"==typeof n&&n instanceof Qe)&&he(e);o=_&&this.injectableDefInScope(_)?$o(Jo(e),Ho):null,this.records.set(e,o)}if(null!=o)return this.hydrate(e,o)}return(r&Te.Self?Vo():this.parent).get(e,t=r&Te.Optional&&t===qe?null:t)}catch(i){if("NullInjectorError"===i.name){if((i.ngTempTokenPath=i.ngTempTokenPath||[]).unshift(be(e)),a)throw i;return function(e,t,r,n){var a=e.ngTempTokenPath;throw t.__source&&a.unshift(t.__source),e.message=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var a=be(t);if(Array.isArray(t))a=t.map(be).join(" -> ");else if("object"==typeof t){var o=[];for(var _ in t)if(t.hasOwnProperty(_)){var i=t[_];o.push(_+":"+("string"==typeof i?JSON.stringify(i):be(i)))}a="{".concat(o.join(", "),"}")}return"".concat(r).concat(n?"("+n+")":"","[").concat(a,"]: ").concat(e.replace(We,"\n  "))}("\n"+e.message,a,"R3InjectorError",n),e.ngTokenPath=a,e.ngTempTokenPath=null,e}(i,e,0,this.source)}throw i}finally{$e(a)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach((function(t){return e.get(t)}))}},{key:"toString",value:function(){var e=[];return this.records.forEach((function(t,r){return e.push(be(r))})),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,r){var n=this;if(!(e=Me(e)))return!1;var a=me(e),o=null==a&&e.ngModule||void 0,_=void 0===o?e:o,i=-1!==r.indexOf(_);if(void 0!==o&&(a=me(o)),null==a)return!1;if(null!=a.imports&&!i){var s;r.push(_);try{lt(a.imports,(function(e){n.processInjectorType(e,t,r)&&(void 0===s&&(s=[]),s.push(e))}))}finally{}if(void 0!==s)for(var l=function(e){var t=s[e],r=t.ngModule,a=t.providers;lt(a,(function(e){return n.processProvider(e,r,a||zo)}))},c=0;c<s.length;c++)l(c)}this.injectorDefTypes.add(_),this.records.set(_,$o(a.factory,Ho));var E=a.providers;if(null!=E&&!i){var u=e;lt(E,(function(e){return n.processProvider(e,u,E)}))}return void 0!==o&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,r){var n=t_(e=Me(e))?e:Me(e&&e.provide),a=function(e,t,r){return e_(e)?$o(void 0,e.useValue):$o(Zo(e,t,r),Ho)}(e,t,r);if(t_(e)||!0!==e.multi){var o=this.records.get(n);o&&void 0!==o.multi&&ea()}else{var _=this.records.get(n);_?void 0===_.multi&&ea():((_=$o(void 0,Ho,!0)).factory=function(){return ot(_.multi)},this.records.set(n,_)),n=e,_.multi.push(e)}this.records.set(n,a)}},{key:"hydrate",value:function(e,t){var r;return t.value===jo?function(e){throw new Error("Cannot instantiate cyclic dependency! ".concat(e))}(be(e)):t.value===Ho&&(t.value=jo,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(r=t.value)&&"object"==typeof r&&"function"==typeof r.ngOnDestroy&&this.onDestroy.add(t.value),t.value}},{key:"injectableDefInScope",value:function(e){return!!e.providedIn&&("string"==typeof e.providedIn?"any"===e.providedIn||e.providedIn===this.scope:this.injectorDefTypes.has(e.providedIn))}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();function Jo(e){var t=he(e),r=null!==t?t.factory:bt(e);if(null!==r)return r;var n=me(e);if(null!==n)return n.factory;if(e instanceof Qe)throw new Error("Token ".concat(be(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var r=ut(t,"?");throw new Error("Can't resolve all parameters for ".concat(be(e),": (").concat(r.join(", "),")."))}var n=function(e){var t=e&&(e[ge]||e[Re]||e[Ne]&&e[Ne]());if(t){var r=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(r,'" that inherits its @Injectable decorator but does not provide one itself.\n')+'This will become an error in v10. Please add @Injectable() to the "'.concat(r,'" class.')),t}return null}(e);return null!==n?function(){return n.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function Zo(e,t,r){var n,a=void 0;if(t_(e)){var o=Me(e);return bt(o)||Jo(o)}if(e_(e))a=function(){return Me(e.useValue)};else if((n=e)&&n.useFactory)a=function(){return e.useFactory.apply(e,_toConsumableArray(ot(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))a=function(){return rt(Me(e.useExisting))};else{var _=Me(e&&(e.useClass||e.provide));if(_||function(e,t,r){var n="";throw e&&t&&(n=" - only instances of Provider and Type are allowed, got: [".concat(t.map((function(e){return e==r?"?"+r+"?":"..."})).join(", "),"]")),new Error("Invalid provider for the NgModule '".concat(be(e),"'")+n)}(t,r,e),!function(e){return!!e.deps}(e))return bt(_)||Jo(_);a=function(){return _construct(_,_toConsumableArray(ot(e.deps)))}}return a}function $o(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:r?[]:void 0}}function e_(e){return null!==e&&"object"==typeof e&&Je in e}function t_(e){return"function"==typeof e}var r_=function(e,t,r){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0,a=qo(e,t,r,n);return a._resolveInjectorDefTypes(),a}({name:r},t,e,r)},n_=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?r_(e,t,""):r_(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=qe,e.NULL=new _t,e.\u0275prov=Pe({token:e,providedIn:"any",factory:function(){return rt(Ve)}}),e.__NG_ELEMENT_ID__=-1,e}(),a_=new Qe("AnalyzeForEntryComponents"),o_=new Map,__=new Set;function i_(e){return"string"==typeof e?e:e.text()}function s_(e,t){for(var r=e.styles,n=e.classes,a=0,o=0;o<t.length;o++){var _=t[o];"number"==typeof _?a=_:1==a?n=ye(n,_):2==a&&(r=ye(r,_+": "+t[++o]+";"))}null!==r&&(e.styles=r),null!==n&&(e.classes=n)}var l_=null;function c_(){if(!l_){var e=Fe.Symbol;if(e&&e.iterator)l_=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),r=0;r<t.length;++r){var n=t[r];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(l_=n)}}return l_}function E_(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}function u_(e){return!!d_(e)&&(Array.isArray(e)||!(e instanceof Map)&&c_()in e)}function d_(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function T_(e,t,r){return!Object.is(e[t],r)&&(e[t]=r,!0)}function f_(e,t,r,n){var a=er();return T_(a,lr(),t)&&(tr(),function(e,t,r,n,a,o){var _=Xt(e,t),i=t[11];if(null==n)Ft(i)?i.removeAttribute(_,r,o):_.removeAttribute(r);else{var s=null==a?Gr(n):a(n,e.tagName||"",r);Ft(i)?i.setAttribute(_,r,s,o):o?_.setAttributeNS(o,r,s):_.setAttribute(r,s)}}(gr(),a,e,t,r,n)),f_}function p_(e,t,r,n,a,o,_,i){var s=er(),l=tr(),c=e+20,E=l.firstCreatePass?function(e,t,r,n,a,o,_,i,s){var l=t.consts,c=Na(t,r[6],e,0,_||null,qt(l,i));ka(t,r,c,qt(l,s)),Or(t,c);var E=c.tViews=xa(2,-1,n,a,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,l),u=Ca(0,null,2,-1,null,null);return u.injectorIndex=c.injectorIndex,E.node=u,null!==t.queries&&(t.queries.template(t,c),E.queries=t.queries.embeddedTView(c)),c}(e,l,s,t,r,n,a,o,_):l.data[c];ar(E,!1);var u=s[11].createComment("");Ro(l,s,u,E),Zn(u,s),eo(s,s[c]=qa(u,s,u,E)),Ct(E)&&La(l,s,E),null!=_&&Ya(s,E,i)}function P_(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Te.Default,r=er();return null==r?rt(e,t):Zr(nr(),r,Me(e),t)}function S_(){throw new Error("invalid")}function A_(e,t,r){var n=er();return T_(n,lr(),t)&&Ua(tr(),gr(),n,e,t,n[11],r,!1),A_}function h_(e,t,r,n,a){var o=a?"class":"style";lo(e,r,t.inputs[o],o,n)}function v_(e,t,r,n){var a=er(),o=tr(),_=20+e,i=a[11],s=a[_]=ga(t,i,Zt.lFrame.currentNamespace),l=o.firstCreatePass?function(e,t,r,n,a,o,_){var i=t.consts,s=qt(i,o),l=Na(t,r[6],e,3,a,s);return ka(t,r,l,qt(i,_)),null!==l.mergedAttrs&&s_(l,l.mergedAttrs),null!==t.queries&&t.queries.elementStart(t,l),l}(e,o,a,0,t,r,n):o.data[_];ar(l,!0);var c=l.mergedAttrs;null!==c&&Yr(i,s,c);var E=l.classes;null!==E&&Mo(i,s,E);var u=l.styles;null!==u&&Yo(i,s,u),Ro(o,a,s,l),0===Zt.lFrame.elementDepthCount&&Zn(s,a),Zt.lFrame.elementDepthCount++,Ct(l)&&(La(o,a,l),function(e,t,r){if(Mt(t))for(var n=t.directiveEnd,a=t.directiveStart;a<n;a++){var o=e.data[a];o.contentQueries&&o.contentQueries(1,r[a],a)}}(o,l,a)),null!==n&&Ya(a,l)}function m_(){var e=nr();or()?_r():ar(e=e.parent,!1);var t=e;Zt.lFrame.elementDepthCount--;var r=tr();r.firstCreatePass&&(Or(r,e),Mt(e)&&r.queries.elementEnd(e)),null!==t.classes&&function(e){return 0!=(16&e.flags)}(t)&&h_(r,t,er(),t.classes,!0),null!==t.styles&&function(e){return 0!=(32&e.flags)}(t)&&h_(r,t,er(),t.styles,!1)}function g_(e,t,r,n){v_(e,t,r,n),m_()}function O_(){return er()}function N_(e){return!!e&&"function"==typeof e.then}function R_(e){return!!e&&"function"==typeof e.subscribe}function I_(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,a=er(),o=tr(),_=nr();return function(e,t,r,n,a,o){var _=arguments.length>6&&void 0!==arguments[6]&&arguments[6],i=arguments.length>7?arguments[7]:void 0,s=Ct(n),l=e.firstCreatePass&&(e.cleanup||(e.cleanup=[])),c=_o(t),E=!0;if(3===n.type){var u=Xt(n,t),d=i?i(u):Pt,T=d.target||u,f=c.length,p=i?function(e){return i(Kt(e[n.index])).target}:n.index;if(Ft(r)){var P=null;if(!i&&s&&(P=function(e,t,r,n){var a=e.cleanup;if(null!=a)for(var o=0;o<a.length-1;o+=2){var _=a[o];if(_===r&&a[o+1]===n){var i=t[7],s=a[o+2];return i.length>s?i[s]:null}"string"==typeof _&&(o+=2)}return null}(e,t,a,n.index)),null!==P)(P.__ngLastListenerFn__||P).__ngNextListenerFn__=o,P.__ngLastListenerFn__=o,E=!1;else{o=y_(n,t,o,!1);var S=r.listen(d.name||T,a,o);c.push(o,S),l&&l.push(a,p,f,f+1)}}else o=y_(n,t,o,!0),T.addEventListener(a,o,_),c.push(o),l&&l.push(a,p,f,_)}var A,h=n.outputs;if(E&&null!==h&&(A=h[a])){var v=A.length;if(v)for(var m=0;m<v;m+=2){var g=t[A[m]][A[m+1]].subscribe(o),O=c.length;c.push(o,g),l&&l.push(a,n.index,O,-(O+1))}}}(o,a,a[11],_,e,t,r,n),I_}function b_(e,t,r){try{return!1!==t(r)}catch(n){return so(e,n),!1}}function y_(e,t,r,n){return function a(o){if(o===Function)return r;var _=2&e.flags?jt(e.index,t):t;0==(32&t[2])&&to(_);for(var i=b_(t,r,o),s=a.__ngNextListenerFn__;s;)i=b_(t,s,o)&&i,s=s.__ngNextListenerFn__;return n&&!1===i&&(o.preventDefault(),o.returnValue=!1),i}}function L_(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(Zt.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Zt.lFrame.contextLView))[8]}(e)}function Y_(e,t){for(var r=null,n=function(e){var t=e.attrs;if(null!=t){var r=t.indexOf(5);if(0==(1&r))return t[r+1]}return null}(e),a=0;a<t.length;a++){var o=t[a];if("*"!==o){if(null===n?sa(e,o,!0):la(n,o))return a}else r=a}return r}function M_(e){var t=er()[16][6];if(!t.projection)for(var r=t.projection=ut(e?e.length:1,null),n=r.slice(),a=t.child;null!==a;){var o=e?Y_(a,e):0;null!==o&&(n[o]?n[o].projectionNext=a:r[o]=a,n[o]=a),a=a.next}}function x_(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=er(),a=tr(),o=Na(a,n[6],e,1,null,r||null);null===o.projection&&(o.projection=t),_r(),function(e,t,r){Lo(t[11],0,t,r,ho(e,r,t),No(r.parent||t[6],t))}(a,n,o)}var C_=[];function w_(e,t,r,n,a){for(var o=e[r+1],_=null===t,i=n?Pa(o):Aa(o),s=!1;0!==i&&(!1===s||_);){var l=e[i+1];U_(e[i],t)&&(s=!0,e[i+1]=n?va(l):Sa(l)),i=n?Pa(l):Aa(l)}s&&(e[r+1]=n?Sa(o):va(o))}function U_(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Tt(e,t)>=0}function k_(e,t){return function(e,t,r,n){var a,o,_,i=er(),s=tr(),l=(a=Zt.lFrame,o=a.bindingIndex,a.bindingIndex=a.bindingIndex+2,o);(s.firstUpdatePass&&function(e,t,r,n){var a=e.data;if(null===a[r+1]){var o=a[vr()+20],_=function(e,t){return t>=e.expandoStartIndex}(e,r);(function(e,t){return 0!=(16&e.flags)})(o)&&null===t&&!_&&(t=!1),t=function(e,t,r,n){var a=function(e){var t=Zt.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),o=t.residualClasses;if(null===a)0===t.classBindings&&(r=F_(r=D_(null,e,t,r,!0),t.attrs,!0),o=null);else{var _=t.directiveStylingLast;if(-1===_||e[_]!==a)if(r=D_(a,e,t,r,!0),null===o){var i=function(e,t,r){var n=t.classBindings;if(0!==Aa(n))return e[Pa(n)]}(e,t);void 0!==i&&Array.isArray(i)&&function(e,t,r,n){e[Pa(t.classBindings)]=n}(e,t,0,i=F_(i=D_(null,e,t,i[1],!0),t.attrs,!0))}else o=function(e,t,r){for(var n=void 0,a=t.directiveEnd,o=1+t.directiveStylingLast;o<a;o++)n=F_(n,e[o].hostAttrs,!0);return F_(n,t.attrs,!0)}(e,t)}return void 0!==o&&(t.residualClasses=o),r}(a,o,t),function(e,t,r,n,a,o){var _=t.classBindings,i=Pa(_),s=Aa(_);e[n]=r;var l,c=!1;if(Array.isArray(r)){var E=r;(null===(l=E[1])||Tt(E,l)>0)&&(c=!0)}else l=r;if(a)if(0!==s){var u=Pa(e[i+1]);e[n+1]=pa(u,i),0!==u&&(e[u+1]=ha(e[u+1],n)),e[i+1]=131071&e[i+1]|n<<17}else e[n+1]=pa(i,0),0!==i&&(e[i+1]=ha(e[i+1],n)),i=n;else e[n+1]=pa(s,0),0===i?i=n:e[s+1]=ha(e[s+1],n),s=n;c&&(e[n+1]=Sa(e[n+1])),w_(e,l,n,!0),w_(e,l,n,!1),function(e,t,r,n,a){var o=e.residualClasses;null!=o&&"string"==typeof t&&Tt(o,t)>=0&&(r[n+1]=va(r[n+1]))}(t,l,e,n),_=pa(i,s),t.classBindings=_}(a,o,t,r,_)}}(s,e,l),t!==ua&&T_(i,l,t))&&(null==r&&(_=function(){var e=Zt.lFrame;return null===e?null:e.currentSanitizer}())&&(r=_),function(e,t,r,n,a,o,_,i){if(3===t.type){var s=e.data,l=s[i+1];K_(1==(1&l)?G_(s,t,r,a,Aa(l),!0):void 0)||(K_(o)||2==(2&l)&&(o=G_(s,null,r,a,i,!0)),function(e,t,r,n,a){var o=Ft(e);a?o?e.addClass(r,n):r.classList.add(n):o?e.removeClass(r,n):r.classList.remove(n)}(n,0,Bt(vr(),r),a,o))}}(s,s.data[vr()+20],i,i[11],e,i[l+1]=function(e,t){return null==e||("function"==typeof t?e=t(e):"string"==typeof t?e+=t:"object"==typeof e&&(e=be(Sn(e)))),e}(t,r),0,l))}(e,t,null),k_}function D_(e,t,r,n,a){var o=null,_=r.directiveEnd,i=r.directiveStylingLast;for(-1===i?i=r.directiveStart:i++;i<_&&(n=F_(n,(o=t[i]).hostAttrs,a),o!==e);)i++;return null!==e&&(r.directiveStylingLast=i),n}function F_(e,t,r){var n,a,o,_,i=r?1:2,s=-1;if(null!==t)for(var l=0;l<t.length;l++){var c=t[l];"number"==typeof c?s=c:s===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),n=e,a=c,o=!!r||t[++l],_=void 0,(_=Tt(n,a))>=0?n[1|_]=o:function(e,t,r,n){var a=e.length;if(a==t)e.push(r,n);else if(1===a)e.push(n,e[0]),e[0]=r;else{for(a--,e.push(e[a-1],e[a]);a>t;)e[a]=e[a-2],a--;e[t]=r,e[t+1]=n}}(n,_=~_,a,o))}return void 0===e?null:e}function G_(e,t,r,n,a,o){for(var _=null===t,i=void 0;a>0;){var s=e[a],l=Array.isArray(s),c=l?s[1]:s,E=null===c,u=r[a+1];u===ua&&(u=E?C_:void 0);var d=E?dt(u,n):c===n?u:void 0;if(l&&!K_(d)&&(d=dt(s,n)),K_(d)&&(i=d,_))return i;var T=e[a+1];a=_?Pa(T):Aa(T)}if(null!==t){var f=o?t.residualClasses:t.residualStyles;null!=f&&(i=dt(f,n))}return i}function K_(e){return void 0!==e}function B_(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=er(),n=tr(),a=e+20,o=n.firstCreatePass?Na(n,r[6],e,3,null,null):n.data[a],_=r[a]=function(e,t){return Ft(t)?t.createText(e):t.createTextNode(e)}(t,r[11]);Ro(n,r,_,o),ar(o,!1)}function X_(e){return H_("",e,""),X_}function H_(e,t,r){var n=er(),a=function(e,t,r,n){return T_(e,lr(),r)?t+Gr(r)+n:ua}(n,e,t,r);return a!==ua&&function(e,t,r){var n=Bt(t,e),a=e[11];Ft(a)?a.setValue(n,r):n.textContent=r}(n,vr(),a),H_}function j_(e,t,r){var n=er();return T_(n,lr(),t)&&Ua(tr(),gr(),n,e,t,n[11],r,!0),j_}function z_(e,t){var r=zt(e)[1],n=r.data.length-1;Or(r,{directiveStart:n,directiveEnd:n+1})}function Q_(e){for(var t=Object.getPrototypeOf(e.type.prototype).constructor,r=!0,n=[e];t;){var a=void 0;if(wt(e))a=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");a=t.\u0275dir}if(a){if(r){n.push(a);var o=e;o.inputs=V_(e.inputs),o.declaredInputs=V_(e.declaredInputs),o.outputs=V_(e.outputs);var _=a.hostBindings;_&&J_(e,_);var i=a.viewQuery,s=a.contentQueries;if(i&&q_(e,i),s&&W_(e,s),pe(e.inputs,a.inputs),pe(e.declaredInputs,a.declaredInputs),pe(e.outputs,a.outputs),wt(a)&&a.data.animation){var l=e.data;l.animation=(l.animation||[]).concat(a.data.animation)}o.afterContentChecked=o.afterContentChecked||a.afterContentChecked,o.afterContentInit=e.afterContentInit||a.afterContentInit,o.afterViewChecked=e.afterViewChecked||a.afterViewChecked,o.afterViewInit=e.afterViewInit||a.afterViewInit,o.doCheck=e.doCheck||a.doCheck,o.onDestroy=e.onDestroy||a.onDestroy,o.onInit=e.onInit||a.onInit}var c=a.features;if(c)for(var E=0;E<c.length;E++){var u=c[E];u&&u.ngInherit&&u(e),u===Q_&&(r=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,r=null,n=e.length-1;n>=0;n--){var a=e[n];a.hostVars=t+=a.hostVars,a.hostAttrs=Cr(a.hostAttrs,r=Cr(r,a.hostAttrs))}}(n)}function V_(e){return e===Pt?{}:e===St?[]:e}function q_(e,t){var r=e.viewQuery;e.viewQuery=r?function(e,n){t(e,n),r(e,n)}:t}function W_(e,t){var r=e.contentQueries;e.contentQueries=r?function(e,n,a){t(e,n,a),r(e,n,a)}:t}function J_(e,t){var r=e.hostBindings;e.hostBindings=r?function(e,n){t(e,n),r(e,n)}:t}var Z_=function(){function e(t,r,n){_classCallCheck(this,e),this.previousValue=t,this.currentValue=r,this.firstChange=n}return _createClass(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function $_(e){e.type.prototype.ngOnChanges&&(e.setInput=ei,e.onChanges=function(){var e=ti(this),t=e&&e.current;if(t){var r=e.previous;if(r===Pt)e.previous=t;else for(var n in t)r[n]=t[n];e.current=null,this.ngOnChanges(t)}})}function ei(e,t,r,n){var a=ti(e)||function(e,t){return e.__ngSimpleChanges__=t}(e,{previous:Pt,current:null}),o=a.current||(a.current={}),_=a.previous,i=this.declaredInputs[r],s=_[i];o[i]=new Z_(s&&s.currentValue,t,_===Pt),e[n]=t}function ti(e){return e.__ngSimpleChanges__||null}function ri(e,t,r,n,a){if(e=Me(e),Array.isArray(e))for(var o=0;o<e.length;o++)ri(e[o],t,r,n,a);else{var _=tr(),i=er(),s=t_(e)?e:Me(e.provide),l=Zo(e),c=nr(),E=65535&c.providerIndexes,u=c.directiveStart,d=c.providerIndexes>>16;if(t_(e)||!e.multi){var T=new Lr(l,a,P_),f=oi(s,t,a?E:E+d,u);-1===f?(Jr(Qr(c,i),_,s),ni(_,e,t.length),t.push(s),c.directiveStart++,c.directiveEnd++,a&&(c.providerIndexes+=65536),r.push(T),i.push(T)):(r[f]=T,i[f]=T)}else{var p=oi(s,t,E+d,u),P=oi(s,t,E,E+d),S=p>=0&&r[p],A=P>=0&&r[P];if(a&&!A||!a&&!S){Jr(Qr(c,i),_,s);var h=function(e,t,r,n,a){var o=new Lr(e,r,P_);return o.multi=[],o.index=t,o.componentProviders=0,ai(o,a,n&&!r),o}(a?ii:_i,r.length,a,n,l);!a&&A&&(r[P].providerFactory=h),ni(_,e,t.length,0),t.push(s),c.directiveStart++,c.directiveEnd++,a&&(c.providerIndexes+=65536),r.push(h),i.push(h)}else ni(_,e,p>-1?p:P,ai(r[a?P:p],l,!a&&n));!a&&n&&A&&r[P].componentProviders++}}}function ni(e,t,r,n){var a=t_(t);if(a||t.useClass){var o=(t.useClass||t).prototype.ngOnDestroy;if(o){var _=e.destroyHooks||(e.destroyHooks=[]);if(!a&&t.multi){var i=_.indexOf(r);-1===i?_.push(r,[n,o]):_[i+1].push(n,o)}else _.push(r,o)}}}function ai(e,t,r){return r&&e.componentProviders++,e.multi.push(t)-1}function oi(e,t,r,n){for(var a=r;a<n;a++)if(t[a]===e)return a;return-1}function _i(e,t,r,n){return si(this.multi,[])}function ii(e,t,r,n){var a,o=this.multi;if(this.providerFactory){var _=this.providerFactory.componentProviders,i=rn(r,r[1],this.providerFactory.index,n);si(o,a=i.slice(0,_));for(var s=_;s<i.length;s++)a.push(i[s])}else si(o,a=[]);return a}function si(e,t){for(var r=0;r<e.length;r++)t.push((0,e[r])());return t}function li(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(r){r.providersResolver=function(r,n){return function(e,t,r){var n=tr();if(n.firstCreatePass){var a=wt(e);ri(r,n.data,n.blueprint,a,!0),ri(t,n.data,n.blueprint,a,!1)}}(r,n?n(e):e,t)}}}$_.ngInherit=!0;var ci=function e(){_classCallCheck(this,e)},Ei=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(be(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),ui=function(){var e=function e(){_classCallCheck(this,e)};return e.NULL=new Ei,e}(),di=function(){var e=function e(t){_classCallCheck(this,e),this.nativeElement=t};return e.__NG_ELEMENT_ID__=function(){return Ti(e)},e}(),Ti=function(e){return Do(e,nr(),er())},fi=function e(){_classCallCheck(this,e)},pi=function(){var e={Important:1,DashCase:2};return e[e.Important]="Important",e[e.DashCase]="DashCase",e}(),Pi=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return Si()},e}(),Si=function(){var e=er(),t=jt(nr().index,e);return function(e){var t=e[11];if(Ft(t))return t;throw new Error("Cannot inject Renderer2 when the application uses Renderer3!")}(Lt(t)?t:e)},Ai=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275prov=Pe({token:e,providedIn:"root",factory:function(){return null}}),e}(),hi=new function e(t){_classCallCheck(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}("9.1.6"),vi=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return u_(e)}},{key:"create",value:function(e){return new gi(e)}}]),e}(),mi=function(e,t){return t},gi=function(){function e(t){_classCallCheck(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||mi}return _createClass(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,r=this._removalsHead,n=0,a=null;t||r;){var o=!r||t&&t.currentIndex<Ii(r,n,a)?t:r,_=Ii(o,n,a),i=o.currentIndex;if(o===r)n--,r=r._nextRemoved;else if(t=t._next,null==o.previousIndex)n++;else{a||(a=[]);var s=_-n,l=i-n;if(s!=l){for(var c=0;c<s;c++){var E=c<a.length?a[c]:a[c]=0,u=E+c;l<=u&&u<s&&(a[c]=E+1)}a[o.previousIndex]=l-s}}_!==i&&e(o,_,i)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!u_(e))throw new Error("Error trying to diff '".concat(be(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var r,n,a,o=this._itHead,_=!1;if(Array.isArray(e)){this.length=e.length;for(var i=0;i<this.length;i++)n=e[i],a=this._trackByFn(i,n),null!==o&&E_(o.trackById,a)?(_&&(o=this._verifyReinsertion(o,n,a,i)),E_(o.item,n)||this._addIdentityChange(o,n)):(o=this._mismatch(o,n,a,i),_=!0),o=o._next}else r=0,function(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)t(e[r]);else for(var n,a=e[c_()]();!(n=a.next()).done;)t(n.value)}(e,(function(e){a=t._trackByFn(r,e),null!==o&&E_(o.trackById,a)?(_&&(o=t._verifyReinsertion(o,e,a,r)),E_(o.item,e)||t._addIdentityChange(o,e)):(o=t._mismatch(o,e,a,r),_=!0),o=o._next,r++})),this.length=r;return this._truncate(o),this.collection=e,this.isDirty}},{key:"_reset",value:function(){if(this.isDirty){var e,t;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=t)e.previousIndex=e.currentIndex,t=e._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,r,n){var a;return null===e?a=this._itTail:(a=e._prev,this._remove(e)),null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(r,n))?(E_(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,a,n)):null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(E_(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,a,n)):e=this._addAfter(new Oi(t,r),a,n),e}},{key:"_verifyReinsertion",value:function(e,t,r,n){var a=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==a?e=this._reinsertAfter(a,e._prev,n):e.currentIndex!=n&&(e.currentIndex=n,this._addToMoves(e,n)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var n=e._prevRemoved,a=e._nextRemoved;return null===n?this._removalsHead=a:n._nextRemoved=a,null===a?this._removalsTail=n:a._prevRemoved=n,this._insertAfter(e,t,r),this._addToMoves(e,r),e}},{key:"_moveAfter",value:function(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}},{key:"_addAfter",value:function(e,t,r){return this._insertAfter(e,t,r),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,r){var n=null===t?this._itHead:t._next;return e._next=n,e._prev=t,null===n?this._itTail=e:n._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new Ri),this._linkedRecords.put(e),e.currentIndex=r,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,r=e._next;return null===t?this._itHead=r:t._next=r,null===r?this._itTail=t:r._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Ri),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}}]),e}(),Oi=function e(t,r){_classCallCheck(this,e),this.item=t,this.trackById=r,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null},Ni=function(){function e(){_classCallCheck(this,e),this._head=null,this._tail=null}return _createClass(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var r;for(r=this._head;null!==r;r=r._nextDup)if((null===t||t<=r.currentIndex)&&E_(r.trackById,e))return r;return null}},{key:"remove",value:function(e){var t=e._prevDup,r=e._nextDup;return null===t?this._head=r:t._nextDup=r,null===r?this._tail=t:r._prevDup=t,null===this._head}}]),e}(),Ri=function(){function e(){_classCallCheck(this,e),this.map=new Map}return _createClass(e,[{key:"put",value:function(e){var t=e.trackById,r=this.map.get(t);r||(r=new Ni,this.map.set(t,r)),r.add(e)}},{key:"get",value:function(e,t){var r=this.map.get(e);return r?r.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"clear",value:function(){this.map.clear()}},{key:"isEmpty",get:function(){return 0===this.map.size}}]),e}();function Ii(e,t,r){var n=e.previousIndex;if(null===n)return n;var a=0;return r&&n<r.length&&(a=r[n]),n+t+a}var bi=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return e instanceof Map||d_(e)}},{key:"create",value:function(){return new yi}}]),e}(),yi=function(){function e(){_classCallCheck(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return _createClass(e,[{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||d_(e)))throw new Error("Error trying to diff '".concat(be(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var r=this._mapHead;if(this._appendAfter=null,this._forEach(e,(function(e,n){if(r&&r.key===n)t._maybeAddToChanges(r,e),t._appendAfter=r,r=r._next;else{var a=t._getOrCreateRecordForKey(n,e);r=t._insertBeforeOrAppend(r,a)}})),r){r._prev&&(r._prev._next=null),this._removalsHead=r;for(var n=r;null!==n;n=n._nextRemoved)n===this._mapHead&&(this._mapHead=null),this._records.delete(n.key),n._nextRemoved=n._next,n.previousValue=n.currentValue,n.currentValue=null,n._prev=null,n._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var r=e._prev;return t._next=e,t._prev=r,e._prev=t,r&&(r._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var r=this._records.get(e);this._maybeAddToChanges(r,t);var n=r._prev,a=r._next;return n&&(n._next=a),a&&(a._prev=n),r._next=null,r._prev=null,r}var o=new Li(e);return this._records.set(e,o),o.currentValue=t,this._addToAdditions(o),o}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){E_(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach((function(r){return t(e[r],r)}))}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}}]),e}(),Li=function e(t){_classCallCheck(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null},Yi=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t,r=this.factories.find((function(t){return t.supports(e)}));if(null!=r)return r;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'"))}}],[{key:"create",value:function(t,r){if(null!=r){var n=r.factories.slice();t=t.concat(n)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(r){if(!r)throw new Error("Cannot extend IterableDiffers without a parent injector");return e.create(t,r)},deps:[[e,new de,new Ee]]}}}]),e}();return e.\u0275prov=Pe({token:e,providedIn:"root",factory:function(){return new e([new vi])}}),e}(),Mi=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t=this.factories.find((function(t){return t.supports(e)}));if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,r){if(r){var n=r.factories.slice();t=t.concat(n)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(r){if(!r)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return e.create(t,r)},deps:[[e,new de,new Ee]]}}}]),e}();return e.\u0275prov=Pe({token:e,providedIn:"root",factory:function(){return new e([new bi])}}),e}(),xi=[new bi],Ci=new Yi([new vi]),wi=new Mi(xi),Ui=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return ki(e,di)},e}(),ki=function(e,t){return Fo(e,t,nr(),er())},Di=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return Fi(e,di)},e}(),Fi=function(e,t){return Go(e,t,nr(),er())},Gi={},Ki=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this)).ngModule=e,n}return _createClass(r,[{key:"resolveComponentFactory",value:function(e){var t=It(e);return new Hi(t,this.ngModule)}}]),r}(ui);function Bi(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push({propName:e[r],templateName:r});return t}var Xi=new Qe("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return Br}}),Hi=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this)).componentDef=e,a.ngModule=n,a.componentType=e.type,a.selector=e.selectors.map(Ea).join(","),a.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],a.isBoundToModule=!!n,a}return _createClass(r,[{key:"create",value:function(e,t,r,n){var a,o,_=(n=n||this.ngModule)?function(e,t){return{get:function(r,n,a){var o=e.get(r,Gi,a);return o!==Gi||n===Gi?o:t.get(r,n,a)}}}(e,n.injector):e,i=_.get(fi,Gt),s=_.get(Ai,null),l=i.createRenderer(null,this.componentDef),c=this.componentDef.selectors[0][0]||"div",E=r?function(e,t,r){if(Ft(e))return e.selectRootElement(t,r===pt.ShadowDom);var n="string"==typeof t?e.querySelector(t):t;return n.textContent="",n}(l,r,this.componentDef.encapsulation):ga(c,i.createRenderer(null,this.componentDef),function(e){var t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(c)),u=this.componentDef.onPush?576:528,d="string"==typeof r&&/^#root-ng-internal-isolated-\d+/.test(r),T={components:[],scheduler:Br,clean:oo,playerHandler:null,flags:0},f=xa(0,-1,null,1,0,null,null,null,null,null),p=Oa(null,f,T,u,null,null,i,l,s,_);fr(p,null);try{var P=function(e,t,r,n,a,o){var _=r[1];r[20]=e;var i=Na(_,null,0,3,null,null),s=i.mergedAttrs=t.hostAttrs;null!==s&&(s_(i,s),null!==e&&(Yr(a,e,s),null!==i.classes&&Mo(a,e,i.classes),null!==i.styles&&Yo(a,e,i.styles)));var l=n.createRenderer(e,t),c=Oa(r,Ma(t),null,t.onPush?64:16,r[20],i,n,l,void 0);return _.firstCreatePass&&(Jr(Qr(i,r),_,t.type),Ba(_,i),Ha(i,r.length,1)),eo(r,c),r[20]=c}(E,this.componentDef,p,i,l);if(E)if(r)Yr(l,E,["ng-version",hi.full]);else{var S=function(e){for(var t=[],r=[],n=1,a=2;n<e.length;){var o=e[n];if("string"==typeof o)2===a?""!==o&&t.push(o,e[++n]):8===a&&r.push(o);else{if(!_a(a))break;a=o}n++}return{attrs:t,classes:r}}(this.componentDef.selectors[0]),A=S.attrs,h=S.classes;A&&Yr(l,E,A),h&&h.length>0&&Mo(l,E,h.join(" "))}if(o=Ht(f,0),void 0!==t)for(var v=o.projection=[],m=0;m<this.ngContentSelectors.length;m++){var g=t[m];v.push(null!=g?Array.from(g):null)}a=function(e,t,r,n,a){var o=r[1],_=function(e,t,r){var n=nr();e.firstCreatePass&&(r.providersResolver&&r.providersResolver(r),Ka(e,n,1),ja(e,t,r));var a=rn(t,e,t.length-1,n);Zn(a,t);var o=Xt(n,t);return o&&Zn(o,t),a}(o,r,t);n.components.push(_),e[8]=_,a&&a.forEach((function(e){return e(_,t)})),t.contentQueries&&t.contentQueries(1,_,r.length-1);var i=nr();if(o.firstCreatePass&&(null!==t.hostBindings||null!==t.hostAttrs)){mr(i.index-20);var s=r[1];Da(s,t),Fa(s,r,t.hostVars),Ga(t,_)}return _}(P,this.componentDef,p,T,[z_]),Ra(f,p,null)}finally{hr()}var O=new ji(this.componentType,a,Do(di,o,p),p,o);return r&&!d||(O.hostView._tViewNode.child=o),O}},{key:"inputs",get:function(){return Bi(this.componentDef.inputs)}},{key:"outputs",get:function(){return Bi(this.componentDef.outputs)}}]),r}(ci),ji=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o,_){var i,s,l,c;return _classCallCheck(this,r),(i=t.call(this)).location=a,i._rootLView=o,i._tNode=_,i.destroyCbs=[],i.instance=n,i.hostView=i.changeDetectorRef=new ko(o),i.hostView._tViewNode=(s=o[1],l=o,null==(c=s.node)&&(s.node=c=Ca(0,null,2,-1,null,null)),l[6]=c),i.componentType=e,i}return _createClass(r,[{key:"destroy",value:function(){this.destroyCbs&&(this.destroyCbs.forEach((function(e){return e()})),this.destroyCbs=null,!this.hostView.destroyed&&this.hostView.destroy())}},{key:"onDestroy",value:function(e){this.destroyCbs&&this.destroyCbs.push(e)}},{key:"injector",get:function(){return new on(this._tNode,this._rootLView)}}]),r}(function(){return function e(){_classCallCheck(this,e)}}()),zi=["en",[["a","p"],["AM","PM"],void 0],[["AM","PM"],void 0,void 0],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],void 0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],void 0,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",void 0,"{1} 'at' {0}",void 0],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),r=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===r?1:5}],Qi={};function Vi(e){return e in Qi||(Qi[e]=Fe.ng&&Fe.ng.common&&Fe.ng.common.locales&&Fe.ng.common.locales[e]),Qi[e]}var qi=function(){var e={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencyCode:15,CurrencySymbol:16,CurrencyName:17,Currencies:18,Directionality:19,PluralCase:20,ExtraData:21};return e[e.LocaleId]="LocaleId",e[e.DayPeriodsFormat]="DayPeriodsFormat",e[e.DayPeriodsStandalone]="DayPeriodsStandalone",e[e.DaysFormat]="DaysFormat",e[e.DaysStandalone]="DaysStandalone",e[e.MonthsFormat]="MonthsFormat",e[e.MonthsStandalone]="MonthsStandalone",e[e.Eras]="Eras",e[e.FirstDayOfWeek]="FirstDayOfWeek",e[e.WeekendRange]="WeekendRange",e[e.DateFormat]="DateFormat",e[e.TimeFormat]="TimeFormat",e[e.DateTimeFormat]="DateTimeFormat",e[e.NumberSymbols]="NumberSymbols",e[e.NumberFormats]="NumberFormats",e[e.CurrencyCode]="CurrencyCode",e[e.CurrencySymbol]="CurrencySymbol",e[e.CurrencyName]="CurrencyName",e[e.Currencies]="Currencies",e[e.Directionality]="Directionality",e[e.PluralCase]="PluralCase",e[e.ExtraData]="ExtraData",e}();function Wi(e){var t;null==(t=e)&&function(e,t,r,n){throw new Error("ASSERTION ERROR: ".concat("Expected localeId to be defined")+" [Expected=> null != ".concat(t," <=Actual]"))}(0,t),"string"==typeof e&&e.toLowerCase().replace(/_/g,"-")}var Ji=new Map,Zi=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;_classCallCheck(this,r),(a=t.call(this))._parent=n,a._bootstrapComponents=[],a.injector=_assertThisInitialized(a),a.destroyCbs=[],a.componentFactoryResolver=new Ki(_assertThisInitialized(a));var o=yt(e),_=e[He]||null;return _&&Wi(_),a._bootstrapComponents=Xr(o.bootstrap),a._r3Injector=qo(e,n,[{provide:it,useValue:_assertThisInitialized(a)},{provide:ui,useValue:a.componentFactoryResolver}],be(e)),a._r3Injector._resolveInjectorDefTypes(),a.instance=a.get(e),a}return _createClass(r,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n_.THROW_IF_NOT_FOUND,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Te.Default;return e===n_||e===it||e===Ve?this:this._r3Injector.get(e,t,r)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach((function(e){return e()})),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),r}(it),$i=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this)).moduleType=e,null!==yt(e)&&function e(t){if(null!==t.\u0275mod.id){var r=t.\u0275mod.id;(function(e,t,r){if(t&&t!==r)throw new Error("Duplicate module registered for ".concat(e," - ").concat(be(t)," vs ").concat(be(t.name)))})(r,Ji.get(r),t),Ji.set(r,t)}var n=t.\u0275mod.imports;n instanceof Function&&(n=n()),n&&n.forEach((function(t){return e(t)}))}(e),n}return _createClass(r,[{key:"create",value:function(e){return new Zi(this.moduleType,e)}}]),r}(st);function es(e,t,r,n){return function(e,t,r,n,a,o){var _=t+r;return T_(e,_,a)?function(e,t,r){return e[t]=r}(e,_+1,o?n.call(o,a):n(a)):function(e,t){var r=e[t];return r===ua?void 0:r}(e,_+1)}(er(),(a=Zt.lFrame,-1===(o=a.bindingRootIndex)&&(o=a.bindingRootIndex=a.tView.bindingStartIndex),o),e,t,r,n);var a,o}var ts=function(e){_inherits(r,e);var t=_createSuper(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _classCallCheck(this,r),(e=t.call(this)).__isAsync=n,e}return _createClass(r,[{key:"emit",value:function(e){_get(_getPrototypeOf(r.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,n){var a,o=function(e){return null},_=function(){return null};e&&"object"==typeof e?(a=this.__isAsync?function(t){setTimeout((function(){return e.next(t)}))}:function(t){e.next(t)},e.error&&(o=this.__isAsync?function(t){setTimeout((function(){return e.error(t)}))}:function(t){e.error(t)}),e.complete&&(_=this.__isAsync?function(){setTimeout((function(){return e.complete()}))}:function(){e.complete()})):(a=this.__isAsync?function(t){setTimeout((function(){return e(t)}))}:function(t){e(t)},t&&(o=this.__isAsync?function(e){setTimeout((function(){return t(e)}))}:function(e){t(e)}),n&&(_=this.__isAsync?function(){setTimeout((function(){return n()}))}:function(){n()}));var i=_get(_getPrototypeOf(r.prototype),"subscribe",this).call(this,a,o,_);return e instanceof S&&e.add(i),i}}]),r}(C);function rs(){return this._results[c_()]()}var ns=function(){function e(){_classCallCheck(this,e),this.dirty=!0,this._results=[],this.changes=new ts,this.length=0;var t=c_(),r=e.prototype;r[t]||(r[t]=rs)}return _createClass(e,[{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e){this._results=function e(t,r){void 0===r&&(r=t);for(var n=0;n<t.length;n++){var a=t[n];Array.isArray(a)?(r===t&&(r=t.slice(0,n)),e(a,r)):r!==t&&r.push(a)}return r}(e),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}},{key:"notifyOnChanges",value:function(){this.changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}(),as=function(){function e(t){_classCallCheck(this,e),this.queryList=t,this.matches=null}return _createClass(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),os=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,e),this.queries=t}return _createClass(e,[{key:"createEmbeddedView",value:function(t){var r=t.queries;if(null!==r){for(var n=null!==t.contentQueries?t.contentQueries[0]:r.length,a=[],o=0;o<n;o++){var _=r.getByIndex(o);a.push(this.queries[_.indexInDeclarationView].clone())}return new e(a)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==us(e,t).matches&&this.queries[t].setDirty()}}]),e}(),_s=function e(t,r,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;_classCallCheck(this,e),this.predicate=t,this.descendants=r,this.isStatic=n,this.read=a},is=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,e),this.queries=t}return _createClass(e,[{key:"elementStart",value:function(e,t){for(var r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var r=null,n=0;n<this.length;n++){var a=null!==r?r.length:0,o=this.getByIndex(n).embeddedTView(t,a);o&&(o.indexInDeclarationView=n,null!==r?r.push(o):r=[o])}return null!==r?new e(r):null}},{key:"template",value:function(e,t){for(var r=0;r<this.queries.length;r++)this.queries[r].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"track",value:function(e){this.queries.push(e)}},{key:"length",get:function(){return this.queries.length}}]),e}(),ss=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;_classCallCheck(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=r}return _createClass(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,r){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,r),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&!1===this.metadata.descendants){for(var t=this._declarationNodeIndex,r=e.parent;null!==r&&4===r.type&&r.index!==t;)r=r.parent;return t===(null!==r?r.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){if(Array.isArray(this.metadata.predicate))for(var r=this.metadata.predicate,n=0;n<r.length;n++)this.matchTNodeWithReadOption(e,t,ls(t,r[n]));else{var a=this.metadata.predicate;a===Ui?0===t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,tn(t,e,a,!1,!1))}}},{key:"matchTNodeWithReadOption",value:function(e,t,r){if(null!==r){var n=this.metadata.read;if(null!==n)if(n===di||n===Di||n===Ui&&0===t.type)this.addMatch(t.index,-2);else{var a=tn(t,e,n,!1,!1);null!==a&&this.addMatch(t.index,a)}else this.addMatch(t.index,r)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function ls(e,t){var r=e.localNames;if(null!==r)for(var n=0;n<r.length;n+=2)if(r[n]===t)return r[n+1];return null}function cs(e,t,r,n){return-1===r?function(e,t){return 3===e.type||4===e.type?Do(di,e,t):0===e.type?Fo(Ui,di,e,t):null}(t,e):-2===r?function(e,t,r){return r===di?Do(di,t,e):r===Ui?Fo(Ui,di,t,e):r===Di?Go(Di,di,t,e):void 0}(e,t,n):rn(e,e[1],r,t)}function Es(e,t,r,n){var a=t[19].queries[n];if(null===a.matches){for(var o=e.data,_=r.matches,i=[],s=0;s<_.length;s+=2){var l=_[s];i.push(l<0?null:cs(t,o[l],_[s+1],r.metadata.read))}a.matches=i}return a.matches}function us(e,t){return e.queries.getByIndex(t)}var ds=new Qe("Application Initializer"),Ts=function(){var e=function(){function e(t){var r=this;_classCallCheck(this,e),this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((function(e,t){r.resolve=e,r.reject=t}))}return _createClass(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],r=function(){e.done=!0,e.resolve()};if(this.appInits)for(var n=0;n<this.appInits.length;n++){var a=this.appInits[n]();N_(a)&&t.push(a)}Promise.all(t).then((function(){r()})).catch((function(t){e.reject(t)})),0===t.length&&r(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(rt(ds,8))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e}(),fs=new Qe("AppId"),ps={provide:fs,useFactory:function(){return"".concat(Ps()).concat(Ps()).concat(Ps())},deps:[]};function Ps(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var Ss=new Qe("Platform Initializer"),As=new Qe("Platform ID"),hs=new Qe("appBootstrapListener"),vs=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e}(),ms=new Qe("LocaleId"),gs=new Qe("DefaultCurrencyCode"),Os=function e(t,r){_classCallCheck(this,e),this.ngModuleFactory=t,this.componentFactories=r},Ns=function(e){return new $i(e)},Rs=Ns,Is=function(e){return Promise.resolve(Ns(e))},bs=function(e){var t=Ns(e),r=Xr(yt(e).declarations).reduce((function(e,t){var r=It(t);return r&&e.push(new Hi(r)),e}),[]);return new Os(t,r)},ys=bs,Ls=function(e){return Promise.resolve(bs(e))},Ys=function(){var e=function(){function e(){_classCallCheck(this,e),this.compileModuleSync=Rs,this.compileModuleAsync=Is,this.compileModuleAndAllComponentsSync=ys,this.compileModuleAndAllComponentsAsync=Ls}return _createClass(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e}(),Ms=new Qe("compilerOptions"),xs=Promise.resolve(0);function Cs(e){"undefined"==typeof Zone?xs.then((function(){e&&e.apply(null,null)})):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var ws=function(){function e(t){var r,n,a=t.enableLongStackTrace,o=void 0!==a&&a,_=t.shouldCoalesceEventChangeDetection,i=void 0!==_&&_;if(_classCallCheck(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ts(!1),this.onMicrotaskEmpty=new ts(!1),this.onStable=new ts(!1),this.onError=new ts(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=i,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){var e=Fe.requestAnimationFrame,t=Fe.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);var n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,n=!!(r=this).shouldCoalesceEventChangeDetection&&r.nativeRequestAnimationFrame&&function(){!function(e){-1===e.lastRequestAnimationFrameId&&(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Fe,(function(){e.lastRequestAnimationFrameId=-1,Fs(e),Ds(e)})),Fs(e))}(r)},r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:n},onInvokeTask:function(e,t,a,o,_,i){try{return Gs(r),e.invokeTask(a,o,_,i)}finally{n&&"eventTask"===o.type&&n(),Ks(r)}},onInvoke:function(e,t,n,a,o,_,i){try{return Gs(r),e.invoke(n,a,o,_,i)}finally{Ks(r)}},onHasTask:function(e,t,n,a){e.hasTask(n,a),t===n&&("microTask"==a.change?(r._hasPendingMicrotasks=a.microTask,Fs(r),Ds(r)):"macroTask"==a.change&&(r.hasPendingMacrotasks=a.macroTask))},onHandleError:function(e,t,n,a){return e.handleError(n,a),r.runOutsideAngular((function(){return r.onError.emit(a)})),!1}})}return _createClass(e,[{key:"run",value:function(e,t,r){return this._inner.run(e,t,r)}},{key:"runTask",value:function(e,t,r,n){var a=this._inner,o=a.scheduleEventTask("NgZoneEvent: "+n,e,ks,Us,Us);try{return a.runTask(o,t,r)}finally{a.cancelTask(o)}}},{key:"runGuarded",value:function(e,t,r){return this._inner.runGuarded(e,t,r)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}();function Us(){}var ks={};function Ds(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular((function(){return e.onStable.emit(null)}))}finally{e.isStable=!0}}}function Fs(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||e.shouldCoalesceEventChangeDetection&&-1!==e.lastRequestAnimationFrameId)}function Gs(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Ks(e){e._nesting--,Ds(e)}var Bs,Xs=function(){function e(){_classCallCheck(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ts,this.onMicrotaskEmpty=new ts,this.onStable=new ts,this.onError=new ts}return _createClass(e,[{key:"run",value:function(e,t,r){return e.apply(t,r)}},{key:"runGuarded",value:function(e,t,r){return e.apply(t,r)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,r,n){return e.apply(t,r)}}]),e}(),Hs=function(){var e=function(){function e(t){var r=this;_classCallCheck(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run((function(){r.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")}))}return _createClass(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular((function(){e._ngZone.onStable.subscribe({next:function(){ws.assertNotInAngularZone(),Cs((function(){e._isZoneStable=!0,e._runCallbacksIfReady()}))}})}))}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())Cs((function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1}));else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter((function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)})),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map((function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}})):[]}},{key:"addCallback",value:function(e,t,r){var n=this,a=-1;t&&t>0&&(a=setTimeout((function(){n._callbacks=n._callbacks.filter((function(e){return e.timeoutId!==a})),e(n._didWork,n.getPendingTasks())}),t)),this._callbacks.push({doneCb:e,timeoutId:a,updateCb:r})}},{key:"whenStable",value:function(e,t,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,r),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,r){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(rt(ws))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e}(),js=function(){var e=function(){function e(){_classCallCheck(this,e),this._applications=new Map,zs.addToWindow(this)}return _createClass(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return zs.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e}(),zs=new(function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,r){return null}}]),e}()),Qs=function(e,t,r){var n=e.get(Ms,[]).concat(t),a=new $i(r);if(0===o_.size)return Promise.resolve(a);var o,_,i=(o=n.map((function(e){return e.providers})),_=[],o.forEach((function(e){return e&&_.push.apply(_,_toConsumableArray(e))})),_);if(0===i.length)return Promise.resolve(a);var s=function(){var e=Fe.ng;if(!e||!e.\u0275compilerFacade)throw new Error("Angular JIT compilation failed: '@angular/compiler' not loaded!\n  - JIT compilation is discouraged for production use-cases! Consider AOT mode instead.\n  - Did you bootstrap using '@angular/platform-browser-dynamic' or '@angular/platform-server'?\n  - Alternatively provide the compiler with 'import \"@angular/compiler\";' before bootstrapping.");return e.\u0275compilerFacade}(),l=n_.create({providers:i}).get(s.ResourceLoader);return function(e){var t=[],r=new Map;function n(e){var t=r.get(e);if(!t){var n=function(e){return Promise.resolve(l.get(e))}(e);r.set(e,t=n.then(i_))}return t}return o_.forEach((function(e,r){var a=[];e.templateUrl&&a.push(n(e.templateUrl).then((function(t){e.template=t})));var o=e.styleUrls,_=e.styles||(e.styles=[]),i=e.styles.length;o&&o.forEach((function(t,r){_.push(""),a.push(n(t).then((function(n){_[i+r]=n,o.splice(o.indexOf(t),1),0==o.length&&(e.styleUrls=void 0)})))}));var s=Promise.all(a).then((function(){return function(e){__.delete(e)}(r)}));t.push(s)})),o_=new Map,Promise.all(t).then((function(){}))}().then((function(){return a}))},Vs=new Qe("AllowMultipleToken"),qs=function e(t,r){_classCallCheck(this,e),this.name=t,this.token=r};function Ws(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n="Platform: ".concat(t),a=new Qe(n);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=Js();if(!o||o.injector.get(Vs,!1))if(e)e(r.concat(t).concat({provide:a,useValue:!0}));else{var _=r.concat(t).concat({provide:a,useValue:!0},{provide:Xo,useValue:"platform"});!function(e){if(Bs&&!Bs.destroyed&&!Bs.injector.get(Vs,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Bs=e.get(Zs);var t=e.get(Ss,null);t&&t.forEach((function(e){return e()}))}(n_.create({providers:_,name:n}))}return function(e){var t=Js();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(a)}}function Js(){return Bs&&!Bs.destroyed?Bs:null}var Zs=function(){var e=function(){function e(t){_classCallCheck(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return _createClass(e,[{key:"bootstrapModuleFactory",value:function(e,t){var r,n,a=this,o=(r=t?t.ngZone:void 0,n=t&&t.ngZoneEventCoalescing||!1,"noop"===r?new Xs:("zone.js"===r?void 0:r)||new ws({enableLongStackTrace:gn(),shouldCoalesceEventChangeDetection:n})),_=[{provide:ws,useValue:o}];return o.run((function(){var t=n_.create({providers:_,parent:a.injector,name:e.moduleType.name}),r=e.create(t),n=r.injector.get(En,null);if(!n)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return r.onDestroy((function(){return rl(a._modules,r)})),o.runOutsideAngular((function(){return o.onError.subscribe({next:function(e){n.handleError(e)}})})),function(e,t,n){try{var o=((_=r.injector.get(Ts)).runInitializers(),_.donePromise.then((function(){return Wi(r.injector.get(ms,"en-US")||"en-US"),a._moduleDoBootstrap(r),r})));return N_(o)?o.catch((function(r){throw t.runOutsideAngular((function(){return e.handleError(r)})),r})):o}catch(i){throw t.runOutsideAngular((function(){return e.handleError(i)})),i}var _}(n,o)}))}},{key:"bootstrapModule",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=$s({},r);return Qs(this.injector,n,e).then((function(e){return t.bootstrapModuleFactory(e,n)}))}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(tl);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach((function(e){return t.bootstrap(e)}));else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(be(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. ')+"Please define one of these.");e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach((function(e){return e.destroy()})),this._destroyListeners.forEach((function(e){return e()})),this._destroyed=!0}},{key:"injector",get:function(){return this._injector}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(rt(n_))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e}();function $s(e,t){return Array.isArray(t)?t.reduce($s,e):Object.assign(Object.assign({},e),t)}var el,tl=((el=function(){function e(t,r,n,a,o,_){var i=this;_classCallCheck(this,e),this._zone=t,this._console=r,this._injector=n,this._exceptionHandler=a,this._componentFactoryResolver=o,this._initStatus=_,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=gn(),this._zone.onMicrotaskEmpty.subscribe({next:function(){i._zone.run((function(){i.tick()}))}});var s=new b((function(e){i._stable=i._zone.isStable&&!i._zone.hasPendingMacrotasks&&!i._zone.hasPendingMicrotasks,i._zone.runOutsideAngular((function(){e.next(i._stable),e.complete()}))})),l=new b((function(e){var t;i._zone.runOutsideAngular((function(){t=i._zone.onStable.subscribe((function(){ws.assertNotInAngularZone(),Cs((function(){i._stable||i._zone.hasPendingMacrotasks||i._zone.hasPendingMicrotasks||(i._stable=!0,e.next(!0))}))}))}));var r=i._zone.onUnstable.subscribe((function(){ws.assertInAngularZone(),i._stable&&(i._stable=!1,i._zone.runOutsideAngular((function(){e.next(!1)})))}));return function(){t.unsubscribe(),r.unsubscribe()}}));this.isStable=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=Number.POSITIVE_INFINITY,a=null,o=t[t.length-1];return U(o)?(a=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())):"number"==typeof o&&(n=t.pop()),null===a&&1===t.length&&t[0]instanceof b?t[0]:$(n)(ee(t,a))}(s,l.pipe((function(e){return te()((t=ie,function(e){var r;r="function"==typeof t?t:function(){return t};var n=Object.create(e,oe);return n.source=e,n.subjectFactory=r,n})(e));var t})))}return _createClass(e,[{key:"bootstrap",value:function(e,t){var r,n=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");r=e instanceof ci?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(r.componentType);var a=r.isBoundToModule?void 0:this._injector.get(it),o=r.create(n_.NULL,[],t||r.selector,a);o.onDestroy((function(){n._unloadComponent(o)}));var _=o.injector.get(Hs,null);return _&&o.injector.get(js).registerApplication(o.location.nativeElement,_),this._loadComponent(o),gn()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),o}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,r=_createForOfIteratorHelper(this._views);try{for(r.s();!(t=r.n()).done;)t.value.detectChanges()}catch(o){r.e(o)}finally{r.f()}if(this._enforceNoNewChanges){var n,a=_createForOfIteratorHelper(this._views);try{for(a.s();!(n=a.n()).done;)n.value.checkNoChanges()}catch(o){a.e(o)}finally{a.f()}}}catch(_){this._zone.runOutsideAngular((function(){return e._exceptionHandler.handleError(_)}))}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;rl(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(hs,[]).concat(this._bootstrapListeners).forEach((function(t){return t(e)}))}},{key:"_unloadComponent",value:function(e){this.detachView(e.hostView),rl(this.components,e)}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach((function(e){return e.destroy()}))}},{key:"viewCount",get:function(){return this._views.length}}]),e}()).\u0275fac=function(e){return new(e||el)(rt(ws),rt(vs),rt(n_),rt(En),rt(ui),rt(Ts))},el.\u0275prov=Pe({token:el,factory:el.\u0275fac}),el);function rl(e,t){var r=e.indexOf(t);r>-1&&e.splice(r,1)}var nl=function e(){_classCallCheck(this,e)},al=function e(){_classCallCheck(this,e)},ol={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},_l=function(){var e=function(){function e(t,r){_classCallCheck(this,e),this._compiler=t,this._config=r||ol}return _createClass(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,n=_slicedToArray(e.split("#"),2),a=n[0],o=n[1];return void 0===o&&(o="default"),r("zn8P")(a).then((function(e){return e[o]})).then((function(e){return il(e,a,o)})).then((function(e){return t._compiler.compileModuleAsync(e)}))}},{key:"loadFactory",value:function(e){var t=_slicedToArray(e.split("#"),2),n=t[0],a=t[1],o="NgFactory";return void 0===a&&(a="default",o=""),r("zn8P")(this._config.factoryPathPrefix+n+this._config.factoryPathSuffix).then((function(e){return e[a+o]})).then((function(e){return il(e,n,a)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(rt(Ys),rt(al,8))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e}();function il(e,t,r){if(!e)throw new Error("Cannot find '".concat(r,"' in '").concat(t,"'"));return e}var sl=Ws(null,"core",[{provide:As,useValue:"unknown"},{provide:Zs,deps:[n_]},{provide:js,deps:[]},{provide:vs,deps:[]}]),ll=[{provide:tl,useClass:tl,deps:[ws,vs,n_,En,ui,Ts]},{provide:Xi,deps:[ws],useFactory:function(e){var t=[];return e.onStable.subscribe((function(){for(;t.length;)t.pop()()})),function(e){t.push(e)}}},{provide:Ts,useClass:Ts,deps:[[new Ee,ds]]},{provide:Ys,useClass:Ys,deps:[]},ps,{provide:Yi,useFactory:function(){return Ci},deps:[]},{provide:Mi,useFactory:function(){return wi},deps:[]},{provide:ms,useFactory:function(e){return Wi(e=e||"undefined"!=typeof $localize&&$localize.locale||"en-US"),e},deps:[[new ce(ms),new Ee,new de]]},{provide:gs,useValue:"USD"}],cl=function(){var e=function e(t){_classCallCheck(this,e)};return e.\u0275mod=Ot({type:e}),e.\u0275inj=Ae({factory:function(t){return new(t||e)(rt(tl))},providers:ll}),e}(),El=null;function ul(){return El}var dl,Tl=new Qe("DocumentToken"),fl=((dl=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||dl)},dl.\u0275prov=Pe({factory:pl,token:dl,providedIn:"platform"}),dl);function pl(){return rt(Al)}var Pl,Sl=new Qe("Location Initialized"),Al=((Pl=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this))._doc=e,n._init(),n}return _createClass(r,[{key:"_init",value:function(){this.location=ul().getLocation(),this._history=ul().getHistory()}},{key:"getBaseHrefFromDOM",value:function(){return ul().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){ul().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",e,!1)}},{key:"onHashChange",value:function(e){ul().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",e,!1)}},{key:"pushState",value:function(e,t,r){hl()?this._history.pushState(e,t,r):this.location.hash=r}},{key:"replaceState",value:function(e,t,r){hl()?this._history.replaceState(e,t,r):this.location.hash=r}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"getState",value:function(){return this._history.state}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}}]),r}(fl)).\u0275fac=function(e){return new(e||Pl)(rt(Tl))},Pl.\u0275prov=Pe({factory:vl,token:Pl,providedIn:"platform"}),Pl);function hl(){return!!window.history.pushState}function vl(){return new Al(rt(Tl))}function ml(e,t){if(0==e.length)return t;if(0==t.length)return e;var r=0;return e.endsWith("/")&&r++,t.startsWith("/")&&r++,2==r?e+t.substring(1):1==r?e+t:e+"/"+t}function gl(e){var t=e.match(/#|\?|$/),r=t&&t.index||e.length;return e.slice(0,r-("/"===e[r-1]?1:0))+e.slice(r)}function Ol(e){return e&&"?"!==e[0]?"?"+e:e}var Nl,Rl=((Nl=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||Nl)},Nl.\u0275prov=Pe({factory:Il,token:Nl,providedIn:"root"}),Nl);function Il(e){var t=rt(Tl).location;return new Ml(rt(fl),t&&t.origin||"")}var bl,yl,Ll,Yl=new Qe("appBaseHref"),Ml=((Ll=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;if(_classCallCheck(this,r),(a=t.call(this))._platformLocation=e,null==n&&(n=a._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return a._baseHref=n,_possibleConstructorReturn(a)}return _createClass(r,[{key:"onPopState",value:function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return ml(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+Ol(this._platformLocation.search),r=this._platformLocation.hash;return r&&e?"".concat(t).concat(r):t}},{key:"pushState",value:function(e,t,r,n){var a=this.prepareExternalUrl(r+Ol(n));this._platformLocation.pushState(e,t,a)}},{key:"replaceState",value:function(e,t,r,n){var a=this.prepareExternalUrl(r+Ol(n));this._platformLocation.replaceState(e,t,a)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),r}(Rl)).\u0275fac=function(e){return new(e||Ll)(rt(fl),rt(Yl,8))},Ll.\u0275prov=Pe({token:Ll,factory:Ll.\u0275fac}),Ll),xl=((yl=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this))._platformLocation=e,a._baseHref="",null!=n&&(a._baseHref=n),a}return _createClass(r,[{key:"onPopState",value:function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=ml(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,r,n){var a=this.prepareExternalUrl(r+Ol(n));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(e,t,a)}},{key:"replaceState",value:function(e,t,r,n){var a=this.prepareExternalUrl(r+Ol(n));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,a)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),r}(Rl)).\u0275fac=function(e){return new(e||yl)(rt(fl),rt(Yl,8))},yl.\u0275prov=Pe({token:yl,factory:yl.\u0275fac}),yl),Cl=((bl=function(){function e(t,r){var n=this;_classCallCheck(this,e),this._subject=new ts,this._urlChangeListeners=[],this._platformStrategy=t;var a=this._platformStrategy.getBaseHref();this._platformLocation=r,this._baseHref=gl(Ul(a)),this._platformStrategy.onPopState((function(e){n._subject.emit({url:n.path(!0),pop:!0,state:e.state,type:e.type})}))}return _createClass(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+Ol(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,Ul(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(r,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Ol(t)),r)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(r,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Ol(t)),r)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this.subscribe((function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach((function(r){return r(e,t)}))}},{key:"subscribe",value:function(e,t,r){return this._subject.subscribe({next:e,error:t,complete:r})}}]),e}()).\u0275fac=function(e){return new(e||bl)(rt(Rl),rt(fl))},bl.normalizeQueryParams=Ol,bl.joinWithSlash=ml,bl.stripTrailingSlash=gl,bl.\u0275prov=Pe({factory:wl,token:bl,providedIn:"root"}),bl);function wl(){return new Cl(rt(Rl),rt(fl))}function Ul(e){return e.replace(/\/index.html$/,"")}var kl,Dl=function(){var e={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return e[e.Zero]="Zero",e[e.One]="One",e[e.Two]="Two",e[e.Few]="Few",e[e.Many]="Many",e[e.Other]="Other",e}(),Fl=function e(){_classCallCheck(this,e)},Gl=((kl=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this)).locale=e,n}return _createClass(r,[{key:"getPluralCategory",value:function(e,t){switch(function(e){return function(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),r=Vi(t);if(r)return r;var n=t.split("-")[0];if(r=Vi(n))return r;if("en"===n)return zi;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}(e)[qi.PluralCase]}(t||this.locale)(e)){case Dl.Zero:return"zero";case Dl.One:return"one";case Dl.Two:return"two";case Dl.Few:return"few";case Dl.Many:return"many";default:return"other"}}}]),r}(Fl)).\u0275fac=function(e){return new(e||kl)(rt(ms))},kl.\u0275prov=Pe({token:kl,factory:kl.\u0275fac}),kl);function Kl(e,t){t=encodeURIComponent(t);var r,n=_createForOfIteratorHelper(e.split(";"));try{for(n.s();!(r=n.n()).done;){var a=r.value,o=a.indexOf("="),_=_slicedToArray(-1==o?[a,""]:[a.slice(0,o),a.slice(o+1)],2),i=_[0],s=_[1];if(i.trim()===t)return decodeURIComponent(s)}}catch(l){n.e(l)}finally{n.f()}return null}var Bl,Xl,Hl=((Xl=function(){function e(t,r,n,a){_classCallCheck(this,e),this._iterableDiffers=t,this._keyValueDiffers=r,this._ngEl=n,this._renderer=a,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return _createClass(e,[{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem((function(e){return t._toggleClass(e.key,e.currentValue)})),e.forEachChangedItem((function(e){return t._toggleClass(e.key,e.currentValue)})),e.forEachRemovedItem((function(e){e.previousValue&&t._toggleClass(e.key,!1)}))}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem((function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(be(e.item)));t._toggleClass(e.item,!0)})),e.forEachRemovedItem((function(e){return t._toggleClass(e.item,!1)}))}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach((function(e){return t._toggleClass(e,!0)})):Object.keys(e).forEach((function(r){return t._toggleClass(r,!!e[r])})))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach((function(e){return t._toggleClass(e,!1)})):Object.keys(e).forEach((function(e){return t._toggleClass(e,!1)})))}},{key:"_toggleClass",value:function(e,t){var r=this;(e=e.trim())&&e.split(/\s+/g).forEach((function(e){t?r._renderer.addClass(r._ngEl.nativeElement,e):r._renderer.removeClass(r._ngEl.nativeElement,e)}))}},{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(u_(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}}]),e}()).\u0275fac=function(e){return new(e||Xl)(P_(Yi),P_(Mi),P_(di),P_(Pi))},Xl.\u0275dir=Rt({type:Xl,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),Xl),jl=((Bl=function(){function e(t,r){_classCallCheck(this,e),this._viewContainer=t,this._context=new zl,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}return _createClass(e,[{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}},{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){Ql("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){Ql("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}()).\u0275fac=function(e){return new(e||Bl)(P_(Di),P_(Ui))},Bl.\u0275dir=Rt({type:Bl,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),Bl),zl=function e(){_classCallCheck(this,e),this.$implicit=null,this.ngIf=null};function Ql(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(be(t),"'."))}var Vl,ql,Wl=((ql=function(){function e(t,r,n){_classCallCheck(this,e),this._ngEl=t,this._differs=r,this._renderer=n,this._ngStyle=null,this._differ=null}return _createClass(e,[{key:"ngDoCheck",value:function(){if(this._differ){var e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}},{key:"_setStyle",value:function(e,t){var r=_slicedToArray(e.split("."),2),n=r[0],a=r[1];null!=(t=null!=t&&a?"".concat(t).concat(a):t)?this._renderer.setStyle(this._ngEl.nativeElement,n,t):this._renderer.removeStyle(this._ngEl.nativeElement,n)}},{key:"_applyChanges",value:function(e){var t=this;e.forEachRemovedItem((function(e){return t._setStyle(e.key,null)})),e.forEachAddedItem((function(e){return t._setStyle(e.key,e.currentValue)})),e.forEachChangedItem((function(e){return t._setStyle(e.key,e.currentValue)}))}},{key:"ngStyle",set:function(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}}]),e}()).\u0275fac=function(e){return new(e||ql)(P_(di),P_(Mi),P_(Pi))},ql.\u0275dir=Rt({type:ql,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),ql),Jl=((Vl=function e(){_classCallCheck(this,e)}).\u0275mod=Ot({type:Vl}),Vl.\u0275inj=Ae({factory:function(e){return new(e||Vl)},providers:[{provide:Fl,useClass:Gl}]}),Vl);function Zl(e){return"browser"===e}var $l,ec,tc,rc,nc,ac=(($l=function e(){_classCallCheck(this,e)}).\u0275prov=Pe({token:$l,providedIn:"root",factory:function(){return new oc(rt(Tl),window,rt(En))}}),$l),oc=function(){function e(t,r,n){_classCallCheck(this,e),this.document=t,this.window=r,this.errorHandler=n,this.offset=function(){return[0,0]}}return _createClass(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportScrollRestoration()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportScrollRestoration()){e=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(e):e.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{var t=this.document.querySelector("#".concat(e));if(t)return void this.scrollToElement(t);var r=this.document.querySelector("[name='".concat(e,"']"));if(r)return void this.scrollToElement(r)}catch(n){this.errorHandler.handleError(n)}}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,n=t.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(r-a[0],n-a[1])}},{key:"supportScrollRestoration",value:function(){try{return!!this.window&&!!this.window.scrollTo}catch(e){return!1}}}]),e}(),_c=function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"getProperty",value:function(e,t){return e[t]}},{key:"log",value:function(e){window.console&&window.console.log&&window.console.log(e)}},{key:"logGroup",value:function(e){window.console&&window.console.group&&window.console.group(e)}},{key:"logGroupEnd",value:function(){window.console&&window.console.groupEnd&&window.console.groupEnd()}},{key:"onAndCancel",value:function(e,t,r){return e.addEventListener(t,r,!1),function(){e.removeEventListener(t,r,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){return e.parentNode&&e.parentNode.removeChild(e),e}},{key:"getValue",value:function(e){return e.value}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getHistory",value:function(){return window.history}},{key:"getLocation",value:function(){return window.location}},{key:"getBaseHref",value:function(e){var t,r=ic||(ic=document.querySelector("base"))?ic.getAttribute("href"):null;return null==r?null:(t=r,ec||(ec=document.createElement("a")),ec.setAttribute("href",t),"/"===ec.pathname.charAt(0)?ec.pathname:"/"+ec.pathname)}},{key:"resetBaseElement",value:function(){ic=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"performanceNow",value:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}},{key:"supportsCookies",value:function(){return!0}},{key:"getCookie",value:function(e){return Kl(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new r,El||(El=e)}}]),r}(function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.call(this)}return _createClass(r,[{key:"supportsDOMEvents",value:function(){return!0}}]),r}(function(){return function e(){_classCallCheck(this,e)}}())),ic=null,sc=new Qe("TRANSITION_ID"),lc=[{provide:ds,useFactory:function(e,t,r){return function(){r.get(Ts).donePromise.then((function(){var r=ul();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter((function(t){return t.getAttribute("ng-transition")===e})).forEach((function(e){return r.remove(e)}))}))}},deps:[sc,Tl,n_],multi:!0}],cc=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){Fe.getAngularTestability=function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.findTestabilityInTree(t,r);if(null==n)throw new Error("Could not find testability for element.");return n},Fe.getAllAngularTestabilities=function(){return e.getAllTestabilities()},Fe.getAllAngularRootElements=function(){return e.getAllRootElements()},Fe.frameworkStabilizers||(Fe.frameworkStabilizers=[]),Fe.frameworkStabilizers.push((function(e){var t=Fe.getAllAngularTestabilities(),r=t.length,n=!1,a=function(t){n=n||t,0==--r&&e(n)};t.forEach((function(e){e.whenStable(a)}))}))}},{key:"findTestabilityInTree",value:function(e,t,r){if(null==t)return null;var n=e.getTestability(t);return null!=n?n:r?ul().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,zs=t}}]),e}(),Ec=new Qe("EventManagerPlugins"),uc=((tc=function(){function e(t,r){var n=this;_classCallCheck(this,e),this._zone=r,this._eventNameToPlugin=new Map,t.forEach((function(e){return e.manager=n})),this._plugins=t.slice().reverse()}return _createClass(e,[{key:"addEventListener",value:function(e,t,r){return this._findPluginFor(t).addEventListener(e,t,r)}},{key:"addGlobalEventListener",value:function(e,t,r){return this._findPluginFor(t).addGlobalEventListener(e,t,r)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var r=this._plugins,n=0;n<r.length;n++){var a=r[n];if(a.supports(e))return this._eventNameToPlugin.set(e,a),a}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}()).\u0275fac=function(e){return new(e||tc)(rt(Ec),rt(ws))},tc.\u0275prov=Pe({token:tc,factory:tc.\u0275fac}),tc),dc=function(){function e(t){_classCallCheck(this,e),this._doc=t}return _createClass(e,[{key:"addGlobalEventListener",value:function(e,t,r){var n=ul().getGlobalEventTarget(this._doc,e);if(!n)throw new Error("Unsupported event target ".concat(n," for event ").concat(t));return this.addEventListener(n,t,r)}}]),e}(),Tc=((nc=function(){function e(){_classCallCheck(this,e),this._stylesSet=new Set}return _createClass(e,[{key:"addStyles",value:function(e){var t=this,r=new Set;e.forEach((function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),r.add(e))})),this.onStylesAdded(r)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}()).\u0275fac=function(e){return new(e||nc)},nc.\u0275prov=Pe({token:nc,factory:nc.\u0275fac}),nc),fc=((rc=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this))._doc=e,n._hostNodes=new Set,n._styleNodes=new Set,n._hostNodes.add(e.head),n}return _createClass(r,[{key:"_addStylesToHost",value:function(e,t){var r=this;e.forEach((function(e){var n=r._doc.createElement("style");n.textContent=e,r._styleNodes.add(t.appendChild(n))}))}},{key:"addHost",value:function(e){this._addStylesToHost(this._stylesSet,e),this._hostNodes.add(e)}},{key:"removeHost",value:function(e){this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach((function(r){return t._addStylesToHost(e,r)}))}},{key:"ngOnDestroy",value:function(){this._styleNodes.forEach((function(e){return ul().remove(e)}))}}]),r}(Tc)).\u0275fac=function(e){return new(e||rc)(rt(Tl))},rc.\u0275prov=Pe({token:rc,factory:rc.\u0275fac}),rc),pc={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Pc=/%COMP%/g;function Sc(e,t,r){for(var n=0;n<t.length;n++){var a=t[n];Array.isArray(a)?Sc(e,a,r):(a=a.replace(Pc,e),r.push(a))}return r}function Ac(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var hc,vc,mc,gc,Oc,Nc,Rc=((hc=function(){function e(t,r,n){_classCallCheck(this,e),this.eventManager=t,this.sharedStylesHost=r,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new Ic(t)}return _createClass(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case pt.Emulated:var r=this.rendererByCompId.get(t.id);return r||(r=new bc(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,r)),r.applyToHost(e),r;case pt.Native:case pt.ShadowDom:return new yc(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var n=Sc(t.id,t.styles,[]);this.sharedStylesHost.addStyles(n),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||hc)(rt(uc),rt(fc),rt(fs))},hc.\u0275prov=Pe({token:hc,factory:hc.\u0275fac}),hc),Ic=function(){function e(t){_classCallCheck(this,e),this.eventManager=t,this.data=Object.create(null)}return _createClass(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(pc[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,r){e&&e.insertBefore(t,r)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(r.textContent=""),r}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,r,n){if(n){t=n+":"+t;var a=pc[n];a?e.setAttributeNS(a,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}},{key:"removeAttribute",value:function(e,t,r){if(r){var n=pc[r];n?e.removeAttributeNS(n,t):e.removeAttribute("".concat(r,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,r,n){n&pi.DashCase?e.style.setProperty(t,r,n&pi.Important?"important":""):e.style[t]=r}},{key:"removeStyle",value:function(e,t,r){r&pi.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,r){e[t]=r}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,Ac(r)):this.eventManager.addEventListener(e,t,Ac(r))}}]),e}(),bc=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o){var _;_classCallCheck(this,r),(_=t.call(this,e)).component=a;var i,s=Sc(o+"-"+a.id,a.styles,[]);return n.addStyles(s),_.contentAttr="_ngcontent-%COMP%".replace(Pc,o+"-"+a.id),_.hostAttr=(i=o+"-"+a.id,"_nghost-%COMP%".replace(Pc,i)),_}return _createClass(r,[{key:"applyToHost",value:function(e){_get(_getPrototypeOf(r.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var n=_get(_getPrototypeOf(r.prototype),"createElement",this).call(this,e,t);return _get(_getPrototypeOf(r.prototype),"setAttribute",this).call(this,n,this.contentAttr,""),n}}]),r}(Ic),yc=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o){var _;_classCallCheck(this,r),(_=t.call(this,e)).sharedStylesHost=n,_.hostEl=a,_.component=o,_.shadowRoot=o.encapsulation===pt.ShadowDom?a.attachShadow({mode:"open"}):a.createShadowRoot(),_.sharedStylesHost.addHost(_.shadowRoot);for(var i=Sc(o.id,o.styles,[]),s=0;s<i.length;s++){var l=document.createElement("style");l.textContent=i[s],_.shadowRoot.appendChild(l)}return _}return _createClass(r,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return _get(_getPrototypeOf(r.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,n){return _get(_getPrototypeOf(r.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,n)}},{key:"removeChild",value:function(e,t){return _get(_getPrototypeOf(r.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(_get(_getPrototypeOf(r.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),r}(Ic),Lc=((vc=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){return _classCallCheck(this,r),t.call(this,e)}return _createClass(r,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,r){var n=this;return e.addEventListener(t,r,!1),function(){return n.removeEventListener(e,t,r)}}},{key:"removeEventListener",value:function(e,t,r){return e.removeEventListener(t,r)}}]),r}(dc)).\u0275fac=function(e){return new(e||vc)(rt(Tl))},vc.\u0275prov=Pe({token:vc,factory:vc.\u0275fac}),vc),Yc=["alt","control","meta","shift"],Mc={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},xc={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Cc={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},wc=((Oc=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){return _classCallCheck(this,r),t.call(this,e)}return _createClass(r,[{key:"supports",value:function(e){return null!=r.parseEventName(e)}},{key:"addEventListener",value:function(e,t,n){var a=r.parseEventName(t),o=r.eventCallback(a.fullKey,n,this.manager.getZone());return this.manager.getZone().runOutsideAngular((function(){return ul().onAndCancel(e,a.domEventName,o)}))}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),n=t.shift();if(0===t.length||"keydown"!==n&&"keyup"!==n)return null;var a=r._normalizeKey(t.pop()),o="";if(Yc.forEach((function(e){var r=t.indexOf(e);r>-1&&(t.splice(r,1),o+=e+".")})),o+=a,0!=t.length||0===a.length)return null;var _={};return _.domEventName=n,_.fullKey=o,_}},{key:"getEventFullKey",value:function(e){var t="",r=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&xc.hasOwnProperty(t)&&(t=xc[t]))}return Mc[t]||t}(e);return" "===(r=r.toLowerCase())?r="space":"."===r&&(r="dot"),Yc.forEach((function(n){n!=r&&(0,Cc[n])(e)&&(t+=n+".")})),t+=r}},{key:"eventCallback",value:function(e,t,n){return function(a){r.getEventFullKey(a)===e&&n.runGuarded((function(){return t(a)}))}}},{key:"_normalizeKey",value:function(e){switch(e){case"esc":return"escape";default:return e}}}]),r}(dc)).\u0275fac=function(e){return new(e||Oc)(rt(Tl))},Oc.\u0275prov=Pe({token:Oc,factory:Oc.\u0275fac}),Oc),Uc=((gc=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||gc)},gc.\u0275prov=Pe({factory:function(){return rt(kc)},token:gc,providedIn:"root"}),gc),kc=((mc=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this))._doc=e,n}return _createClass(r,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case zn.NONE:return t;case zn.HTML:return An(t,"HTML")?Sn(t):Hn(this._doc,String(t));case zn.STYLE:return An(t,"Style")?Sn(t):function(e){if(!(e=String(e).trim()))return"";var t=e.match(Vn);return t&&In(t[1])===t[1]||e.match(Qn)&&function(e){for(var t=!0,r=!0,n=0;n<e.length;n++){var a=e.charAt(n);"'"===a&&r?t=!t:'"'===a&&t&&(r=!r)}return t&&r}(e)?e:(gn()&&console.warn("WARNING: sanitizing unsafe style value ".concat(e," (see http://g.co/ng/security#xss).")),"unsafe")}(t);case zn.SCRIPT:if(An(t,"Script"))return Sn(t);throw new Error("unsafe value used in a script context");case zn.URL:return hn(t),An(t,"URL")?Sn(t):In(String(t));case zn.RESOURCE_URL:if(An(t,"ResourceURL"))return Sn(t);throw new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see http://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(e){return new dn(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return new Tn(e)}},{key:"bypassSecurityTrustScript",value:function(e){return new fn(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return new pn(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return new Pn(e)}}]),r}(Uc)).\u0275fac=function(e){return new(e||mc)(rt(Tl))},mc.\u0275prov=Pe({factory:function(){return e=rt(Ve),new kc(e.get(Tl));var e},token:mc,providedIn:"root"}),mc),Dc=Ws(sl,"browser",[{provide:As,useValue:"browser"},{provide:Ss,useValue:function(){_c.makeCurrent(),cc.init()},multi:!0},{provide:Tl,useFactory:function(){return function(e){kt=e}(document),document},deps:[]}]),Fc=[[],{provide:Xo,useValue:"root"},{provide:En,useFactory:function(){return new En},deps:[]},{provide:Ec,useClass:Lc,multi:!0,deps:[Tl,ws,As]},{provide:Ec,useClass:wc,multi:!0,deps:[Tl]},[],{provide:Rc,useClass:Rc,deps:[uc,fc,fs]},{provide:fi,useExisting:Rc},{provide:Tc,useExisting:fc},{provide:fc,useClass:fc,deps:[Tl]},{provide:Hs,useClass:Hs,deps:[ws]},{provide:uc,useClass:uc,deps:[Ec,ws]},[]],Gc=((Nc=function(){function e(t){if(_classCallCheck(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return _createClass(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:fs,useValue:t.appId},{provide:sc,useExisting:fs},lc]}}}]),e}()).\u0275mod=Ot({type:Nc}),Nc.\u0275inj=Ae({factory:function(e){return new(e||Nc)(rt(Nc,12))},providers:Fc,imports:[Jl,cl]}),Nc);function Kc(e,t){return new b((function(r){var n=e.length;if(0!==n)for(var a=new Array(n),o=0,_=0,i=function(i){var s=q(e[i]),l=!1;r.add(s.subscribe({next:function(e){l||(l=!0,_++),a[i]=e},error:function(e){return r.error(e)},complete:function(){++o!==n&&l||(_===n&&r.next(t?t.reduce((function(e,t,r){return e[t]=a[r],e}),{}):a),r.complete())}}))},s=0;s<n;s++)i(s);else r.complete()}))}"undefined"!=typeof window&&window;var Bc,Xc,Hc,jc,zc=new Qe("NgValueAccessor"),Qc={provide:zc,useExisting:Ye((function(){return Vc})),multi:!0},Vc=((Bc=function(){function e(t,r){_classCallCheck(this,e),this._renderer=t,this._elementRef=r,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"checked",e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}()).\u0275fac=function(e){return new(e||Bc)(P_(Pi),P_(di))},Bc.\u0275dir=Rt({type:Bc,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,t){1&e&&I_("change",(function(e){return t.onChange(e.target.checked)}))("blur",(function(){return t.onTouched()}))},features:[li([Qc])]}),Bc),qc={provide:zc,useExisting:Ye((function(){return Jc})),multi:!0},Wc=new Qe("CompositionEventMode"),Jc=((jc=function(){function e(t,r,n){var a;_classCallCheck(this,e),this._renderer=t,this._elementRef=r,this._compositionMode=n,this.onChange=function(e){},this.onTouched=function(){},this._composing=!1,null==this._compositionMode&&(this._compositionMode=(a=ul()?ul().getUserAgent():"",!/android (\d+)/.test(a.toLowerCase())))}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),e}()).\u0275fac=function(e){return new(e||jc)(P_(Pi),P_(di),P_(Wc,8))},jc.\u0275dir=Rt({type:jc,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&I_("input",(function(e){return t._handleInput(e.target.value)}))("blur",(function(){return t.onTouched()}))("compositionstart",(function(){return t._compositionStart()}))("compositionend",(function(e){return t._compositionEnd(e.target.value)}))},features:[li([qc])]}),jc),Zc=((Hc=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}},{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}}]),e}()).\u0275fac=function(e){return new(e||Hc)},Hc.\u0275dir=Rt({type:Hc}),Hc),$c=((Xc=function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),r}(Zc)).\u0275fac=function(e){return eE(e||Xc)},Xc.\u0275dir=Rt({type:Xc,features:[Q_]}),Xc),eE=_n($c);function tE(){throw new Error("unimplemented")}var rE,nE,aE=function(e){_inherits(r,e);var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),(e=t.apply(this,arguments))._parent=null,e.name=null,e.valueAccessor=null,e._rawValidators=[],e._rawAsyncValidators=[],e}return _createClass(r,[{key:"validator",get:function(){return tE()}},{key:"asyncValidator",get:function(){return tE()}}]),r}(Zc),oE=function(){function e(t){_classCallCheck(this,e),this._cd=t}return _createClass(e,[{key:"ngClassUntouched",get:function(){return!!this._cd.control&&this._cd.control.untouched}},{key:"ngClassTouched",get:function(){return!!this._cd.control&&this._cd.control.touched}},{key:"ngClassPristine",get:function(){return!!this._cd.control&&this._cd.control.pristine}},{key:"ngClassDirty",get:function(){return!!this._cd.control&&this._cd.control.dirty}},{key:"ngClassValid",get:function(){return!!this._cd.control&&this._cd.control.valid}},{key:"ngClassInvalid",get:function(){return!!this._cd.control&&this._cd.control.invalid}},{key:"ngClassPending",get:function(){return!!this._cd.control&&this._cd.control.pending}}]),e}(),_E=((nE=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){return _classCallCheck(this,r),t.call(this,e)}return r}(oE)).\u0275fac=function(e){return new(e||nE)(P_(aE,2))},nE.\u0275dir=Rt({type:nE,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&k_("ng-untouched",t.ngClassUntouched)("ng-touched",t.ngClassTouched)("ng-pristine",t.ngClassPristine)("ng-dirty",t.ngClassDirty)("ng-valid",t.ngClassValid)("ng-invalid",t.ngClassInvalid)("ng-pending",t.ngClassPending)},features:[Q_]}),nE),iE=((rE=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){return _classCallCheck(this,r),t.call(this,e)}return r}(oE)).\u0275fac=function(e){return new(e||rE)(P_($c,2))},rE.\u0275dir=Rt({type:rE,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(e,t){2&e&&k_("ng-untouched",t.ngClassUntouched)("ng-touched",t.ngClassTouched)("ng-pristine",t.ngClassPristine)("ng-dirty",t.ngClassDirty)("ng-valid",t.ngClassValid)("ng-invalid",t.ngClassInvalid)("ng-pending",t.ngClassPending)},features:[Q_]}),rE);function sE(e){return null==e||0===e.length}var lE=new Qe("NgValidators"),cE=new Qe("NgAsyncValidators"),EE=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,uE=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"min",value:function(e){return function(t){if(sE(t.value)||sE(e))return null;var r=parseFloat(t.value);return!isNaN(r)&&r<e?{min:{min:e,actual:t.value}}:null}}},{key:"max",value:function(e){return function(t){if(sE(t.value)||sE(e))return null;var r=parseFloat(t.value);return!isNaN(r)&&r>e?{max:{max:e,actual:t.value}}:null}}},{key:"required",value:function(e){return sE(e.value)?{required:!0}:null}},{key:"requiredTrue",value:function(e){return!0===e.value?null:{required:!0}}},{key:"email",value:function(e){return sE(e.value)||EE.test(e.value)?null:{email:!0}}},{key:"minLength",value:function(e){return function(t){if(sE(t.value))return null;var r=t.value?t.value.length:0;return r<e?{minlength:{requiredLength:e,actualLength:r}}:null}}},{key:"maxLength",value:function(e){return function(t){var r=t.value?t.value.length:0;return r>e?{maxlength:{requiredLength:e,actualLength:r}}:null}}},{key:"pattern",value:function(t){return t?("string"==typeof t?(n="","^"!==t.charAt(0)&&(n+="^"),n+=t,"$"!==t.charAt(t.length-1)&&(n+="$"),r=new RegExp(n)):(n=t.toString(),r=t),function(e){if(sE(e.value))return null;var t=e.value;return r.test(t)?null:{pattern:{requiredPattern:n,actualValue:t}}}):e.nullValidator;var r,n}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){if(!e)return null;var t=e.filter(dE);return 0==t.length?null:function(e){return fE(function(e,t){return t.map((function(t){return t(e)}))}(e,t))}}},{key:"composeAsync",value:function(e){if(!e)return null;var t=e.filter(dE);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(1===t.length){var n=t[0];if(T(n))return Kc(n,null);if(f(n)&&Object.getPrototypeOf(n)===Object.prototype){var a=Object.keys(n);return Kc(a.map((function(e){return n[e]})),a)}}if("function"==typeof t[t.length-1]){var o=t.pop();return Kc(t=1===t.length&&T(t[0])?t[0]:t,null).pipe(j((function(e){return o.apply(void 0,_toConsumableArray(e))})))}return Kc(t,null)}(function(e,t){return t.map((function(t){return t(e)}))}(e,t).map(TE)).pipe(j(fE))}}}]),e}();function dE(e){return null!=e}function TE(e){var t=N_(e)?q(e):e;if(!R_(t))throw new Error("Expected validator to return Promise or Observable.");return t}function fE(e){var t={};return e.forEach((function(e){t=null!=e?Object.assign(Object.assign({},t),e):t})),0===Object.keys(t).length?null:t}function pE(e){return e.validate?function(t){return e.validate(t)}:e}function PE(e){return e.validate?function(t){return e.validate(t)}:e}var SE,AE,hE,vE,mE,gE,OE={provide:zc,useExisting:Ye((function(){return NE})),multi:!0},NE=((SE=function(){function e(t,r){_classCallCheck(this,e),this._renderer=t,this._elementRef=r,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}()).\u0275fac=function(e){return new(e||SE)(P_(Pi),P_(di))},SE.\u0275dir=Rt({type:SE,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,t){1&e&&I_("change",(function(e){return t.onChange(e.target.value)}))("input",(function(e){return t.onChange(e.target.value)}))("blur",(function(){return t.onTouched()}))},features:[li([OE])]}),SE),RE={provide:zc,useExisting:Ye((function(){return bE})),multi:!0},IE=((hE=function(){function e(){_classCallCheck(this,e),this._accessors=[]}return _createClass(e,[{key:"add",value:function(e,t){this._accessors.push([e,t])}},{key:"remove",value:function(e){for(var t=this._accessors.length-1;t>=0;--t)if(this._accessors[t][1]===e)return void this._accessors.splice(t,1)}},{key:"select",value:function(e){var t=this;this._accessors.forEach((function(r){t._isSameGroup(r,e)&&r[1]!==e&&r[1].fireUncheck(e.value)}))}},{key:"_isSameGroup",value:function(e,t){return!!e[0].control&&e[0]._parent===t._control._parent&&e[1].name===t.name}}]),e}()).\u0275fac=function(e){return new(e||hE)},hE.\u0275prov=Pe({token:hE,factory:hE.\u0275fac}),hE),bE=((AE=function(){function e(t,r,n,a){_classCallCheck(this,e),this._renderer=t,this._elementRef=r,this._registry=n,this._injector=a,this.onChange=function(){},this.onTouched=function(){}}return _createClass(e,[{key:"ngOnInit",value:function(){this._control=this._injector.get(aE),this._checkName(),this._registry.add(this._control,this)}},{key:"ngOnDestroy",value:function(){this._registry.remove(this)}},{key:"writeValue",value:function(e){this._state=e===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}},{key:"registerOnChange",value:function(e){var t=this;this._fn=e,this.onChange=function(){e(t.value),t._registry.select(t)}}},{key:"fireUncheck",value:function(e){this.writeValue(e)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_checkName",value:function(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)}},{key:"_throwNameError",value:function(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')}}]),e}()).\u0275fac=function(e){return new(e||AE)(P_(Pi),P_(di),P_(IE),P_(n_))},AE.\u0275dir=Rt({type:AE,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,t){1&e&&I_("change",(function(){return t.onChange()}))("blur",(function(){return t.onTouched()}))},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[li([RE])]}),AE),yE={provide:zc,useExisting:Ye((function(){return LE})),multi:!0},LE=((vE=function(){function e(t,r){_classCallCheck(this,e),this._renderer=t,this._elementRef=r,this.onChange=function(e){},this.onTouched=function(){}}return _createClass(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),e}()).\u0275fac=function(e){return new(e||vE)(P_(Pi),P_(di))},vE.\u0275dir=Rt({type:vE,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&I_("change",(function(e){return t.onChange(e.target.value)}))("input",(function(e){return t.onChange(e.target.value)}))("blur",(function(){return t.onTouched()}))},features:[li([yE])]}),vE),YE='\n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });',ME='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',xE=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"controlParentException",value:function(){throw new Error("formControlName must be used with a parent formGroup directive.  You'll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ".concat(YE))}},{key:"ngModelGroupException",value:function(){throw new Error('formControlName cannot be used with an ngModelGroup parent. It is only compatible with parents\n       that also have a "form" prefix: formGroupName, formArrayName, or formGroup.\n\n       Option 1:  Update the parent to be formGroupName (reactive form strategy)\n\n        '.concat(ME,'\n\n        Option 2: Use ngModel instead of formControlName (template-driven strategy)\n\n        \n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>'))}},{key:"missingFormException",value:function(){throw new Error("formGroup expects a FormGroup instance. Please pass one in.\n\n       Example:\n\n       ".concat(YE))}},{key:"groupParentException",value:function(){throw new Error("formGroupName must be used with a parent formGroup directive.  You'll want to add a formGroup\n      directive and pass it an existing FormGroup instance (you can create one in your class).\n\n      Example:\n\n      ".concat(ME))}},{key:"arrayParentException",value:function(){throw new Error('formArrayName must be used with a parent formGroup directive.  You\'ll want to add a formGroup\n       directive and pass it an existing FormGroup instance (you can create one in your class).\n\n        Example:\n\n        \n    <div [formGroup]="myGroup">\n      <div formArrayName="cities">\n        <div *ngFor="let city of cityArray.controls; index as i">\n          <input [formControlName]="i">\n        </div>\n      </div>\n    </div>\n\n    In your class:\n\n    this.cityArray = new FormArray([new FormControl(\'SF\')]);\n    this.myGroup = new FormGroup({\n      cities: this.cityArray\n    });')}},{key:"disabledAttrWarning",value:function(){console.warn("\n      It looks like you're using the disabled attribute with a reactive form directive. If you set disabled to true\n      when you set up this control in your component class, the disabled attribute will actually be set in the DOM for\n      you. We recommend using this approach to avoid 'changed after checked' errors.\n       \n      Example: \n      form = new FormGroup({\n        first: new FormControl({value: 'Nancy', disabled: true}, Validators.required),\n        last: new FormControl('Drew', Validators.required)\n      });\n    ")}},{key:"ngModelWarning",value:function(e){console.warn("\n    It looks like you're using ngModel on the same form field as ".concat(e,". \n    Support for using the ngModel input property and ngModelChange event with \n    reactive form directives has been deprecated in Angular v6 and will be removed \n    in Angular v7.\n    \n    For more information on this, see our API docs here:\n    https://angular.io/api/forms/").concat("formControl"===e?"FormControlDirective":"FormControlName","#use-with-ngmodel\n    "))}}]),e}(),CE={provide:zc,useExisting:Ye((function(){return wE})),multi:!0},wE=((mE=function(){function e(t,r){_classCallCheck(this,e),this._renderer=t,this._elementRef=r,this._optionMap=new Map,this._idCounter=0,this.onChange=function(e){},this.onTouched=function(){},this._compareWith=E_}return _createClass(e,[{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);var r=function(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}(t,e);this._renderer.setProperty(this._elementRef.nativeElement,"value",r)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(r){t.value=t._getOptionValue(r),e(t.value)}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,r=Array.from(this._optionMap.keys());t<r.length;t++){var n=r[t];if(this._compareWith(this._optionMap.get(n),e))return n}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}},{key:"compareWith",set:function(e){if("function"!=typeof e)throw new Error("compareWith must be a function, but received ".concat(JSON.stringify(e)));this._compareWith=e}}]),e}()).\u0275fac=function(e){return new(e||mE)(P_(Pi),P_(di))},mE.\u0275dir=Rt({type:mE,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&I_("change",(function(e){return t.onChange(e.target.value)}))("blur",(function(){return t.onTouched()}))},inputs:{compareWith:"compareWith"},features:[li([CE])]}),mE),UE={provide:zc,useExisting:Ye((function(){return kE})),multi:!0},kE=((gE=function(){function e(t,r){_classCallCheck(this,e),this._renderer=t,this._elementRef=r,this._optionMap=new Map,this._idCounter=0,this.onChange=function(e){},this.onTouched=function(){},this._compareWith=E_}return _createClass(e,[{key:"writeValue",value:function(e){var t,r=this;if(this.value=e,Array.isArray(e)){var n=e.map((function(e){return r._getOptionId(e)}));t=function(e,t){e._setSelected(n.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(r){var n=[];if(r.hasOwnProperty("selectedOptions"))for(var a=r.selectedOptions,o=0;o<a.length;o++){var _=a.item(o),i=t._getOptionValue(_.value);n.push(i)}else for(var s=r.options,l=0;l<s.length;l++){var c=s.item(l);if(c.selected){var E=t._getOptionValue(c.value);n.push(E)}}t.value=n,e(n)}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,r=Array.from(this._optionMap.keys());t<r.length;t++){var n=r[t];if(this._compareWith(this._optionMap.get(n)._value,e))return n}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}},{key:"compareWith",set:function(e){if("function"!=typeof e)throw new Error("compareWith must be a function, but received ".concat(JSON.stringify(e)));this._compareWith=e}}]),e}()).\u0275fac=function(e){return new(e||gE)(P_(Pi),P_(di))},gE.\u0275dir=Rt({type:gE,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&I_("change",(function(e){return t.onChange(e.target)}))("blur",(function(){return t.onTouched()}))},inputs:{compareWith:"compareWith"},features:[li([UE])]}),gE);function DE(e,t){return[].concat(_toConsumableArray(t.path),[e])}function FE(e,t){e||XE(t,"Cannot find control with"),t.valueAccessor||XE(t,"No value accessor for form control with"),e.validator=uE.compose([e.validator,t.validator]),e.asyncValidator=uE.composeAsync([e.asyncValidator,t.asyncValidator]),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange((function(r){e._pendingValue=r,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&GE(e,t)}))}(e,t),function(e,t){e.registerOnChange((function(e,r){t.valueAccessor.writeValue(e),r&&t.viewToModelUpdate(e)}))}(e,t),function(e,t){t.valueAccessor.registerOnTouched((function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&GE(e,t),"submit"!==e.updateOn&&e.markAsTouched()}))}(e,t),t.valueAccessor.setDisabledState&&e.registerOnDisabledChange((function(e){t.valueAccessor.setDisabledState(e)})),t._rawValidators.forEach((function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange((function(){return e.updateValueAndValidity()}))})),t._rawAsyncValidators.forEach((function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange((function(){return e.updateValueAndValidity()}))}))}function GE(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function KE(e,t){null==e&&XE(t,"Cannot find control with"),e.validator=uE.compose([e.validator,t.validator]),e.asyncValidator=uE.composeAsync([e.asyncValidator,t.asyncValidator])}function BE(e){return XE(e,"There is no FormControl instance attached to form control element with")}function XE(e,t){var r;throw r=e.path.length>1?"path: '".concat(e.path.join(" -> "),"'"):e.path[0]?"name: '".concat(e.path,"'"):"unspecified name attribute",new Error("".concat(t," ").concat(r))}function HE(e){return null!=e?uE.compose(e.map(pE)):null}function jE(e){return null!=e?uE.composeAsync(e.map(PE)):null}var zE=[Vc,LE,NE,wE,kE,bE];function QE(e){var t=qE(e)?e.validators:e;return Array.isArray(t)?HE(t):t||null}function VE(e,t){var r=qE(t)?t.asyncValidators:e;return Array.isArray(r)?jE(r):r||null}function qE(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var WE,JE,ZE,$E,eu,tu=function(){function e(t,r){_classCallCheck(this,e),this.validator=t,this.asyncValidator=r,this._onCollectionChange=function(){},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}return _createClass(e,[{key:"setValidators",value:function(e){this.validator=QE(e)}},{key:"setAsyncValidators",value:function(e){this.asyncValidator=VE(e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild((function(e){return e.markAllAsTouched()}))}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild((function(e){e.markAsUntouched({onlySelf:!0})})),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild((function(e){e.markAsPristine({onlySelf:!0})})),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status="PENDING",!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild((function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))})),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach((function(e){return e(!0)}))}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="VALID",this._forEachChild((function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))})),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach((function(e){return e(!1)}))}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild((function(t){return t._updateTreeValidity(e)})),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status="PENDING";var r=TE(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe((function(r){return t.setErrors(r,{emitEvent:e})}))}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,r){if(null==t)return null;if(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length)return null;var n=e;return t.forEach((function(e){n=n instanceof nu?n.controls.hasOwnProperty(e)?n.controls[e]:null:n instanceof au&&n.at(e)||null})),n}(this,e)}},{key:"getError",value:function(e,t){var r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new ts,this.statusChanges=new ts}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls((function(t){return t.status===e}))}},{key:"_anyControlsDirty",value:function(){return this._anyControls((function(e){return e.dirty}))}},{key:"_anyControlsTouched",value:function(){return this._anyControls((function(e){return e.touched}))}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){qE(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return"VALID"===this.status}},{key:"invalid",get:function(){return"INVALID"===this.status}},{key:"pending",get:function(){return"PENDING"==this.status}},{key:"disabled",get:function(){return"DISABLED"===this.status}},{key:"enabled",get:function(){return"DISABLED"!==this.status}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}}]),e}(),ru=function(e){_inherits(r,e);var t=_createSuper(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0;return _classCallCheck(this,r),(e=t.call(this,QE(a),VE(o,a)))._onChange=[],e._applyFormState(n),e._setUpdateStrategy(a),e.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),e._initObservables(),e}return _createClass(r,[{key:"setValue",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==r.emitModelToViewChange&&this._onChange.forEach((function(e){return e(t.value,!1!==r.emitViewToModelChange)})),this.updateValueAndValidity(r)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_clearChangeFns",value:function(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=function(){}}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),r}(tu),nu=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a){var o;return _classCallCheck(this,r),(o=t.call(this,QE(n),VE(a,n))).controls=e,o._initObservables(),o._setUpdateStrategy(n),o._setUpControls(),o.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),o}return _createClass(r,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"removeControl",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),delete this.controls[e],this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach((function(n){t._throwIfControlMissing(n),t.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:r.emitEvent})})),this.updateValueAndValidity(r)}},{key:"patchValue",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(e).forEach((function(n){t.controls[n]&&t.controls[n].patchValue(e[n],{onlySelf:!0,emitEvent:r.emitEvent})})),this.updateValueAndValidity(r)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild((function(r,n){r.reset(e[n],{onlySelf:!0,emitEvent:t.emitEvent})})),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},(function(e,t,r){return e[r]=t instanceof ru?t.value:t.getRawValue(),e}))}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,(function(e,t){return!!t._syncPendingControls()||e}));return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach((function(r){return e(t.controls[r],r)}))}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild((function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)}))}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){var t=this,r=!1;return this._forEachChild((function(n,a){r=r||t.contains(a)&&e(n)})),r}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},(function(t,r,n){return(r.enabled||e.disabled)&&(t[n]=r.value),t}))}},{key:"_reduceChildren",value:function(e,t){var r=e;return this._forEachChild((function(e,n){r=t(r,e,n)})),r}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var r=t[e];if(this.controls[r].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild((function(t,r){if(void 0===e[r])throw new Error("Must supply a value for form control with name: '".concat(r,"'."))}))}}]),r}(tu),au=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a){var o;return _classCallCheck(this,r),(o=t.call(this,QE(n),VE(a,n))).controls=e,o._initObservables(),o._setUpdateStrategy(n),o._setUpControls(),o.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),o}return _createClass(r,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"insert",value:function(e,t){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity()}},{key:"removeAt",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),this.controls.splice(e,1),this.updateValueAndValidity()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setValue",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach((function(e,n){t._throwIfControlMissing(n),t.at(n).setValue(e,{onlySelf:!0,emitEvent:r.emitEvent})})),this.updateValueAndValidity(r)}},{key:"patchValue",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((function(e,n){t.at(n)&&t.at(n).patchValue(e,{onlySelf:!0,emitEvent:r.emitEvent})})),this.updateValueAndValidity(r)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild((function(r,n){r.reset(e[n],{onlySelf:!0,emitEvent:t.emitEvent})})),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map((function(e){return e instanceof ru?e.value:e.getRawValue()}))}},{key:"clear",value:function(){this.controls.length<1||(this._forEachChild((function(e){return e._registerOnCollectionChange((function(){}))})),this.controls.splice(0),this.updateValueAndValidity())}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce((function(e,t){return!!t._syncPendingControls()||e}),!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach((function(t,r){e(t,r)}))}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter((function(t){return t.enabled||e.disabled})).map((function(e){return e.value}))}},{key:"_anyControls",value:function(e){return this.controls.some((function(t){return t.enabled&&e(t)}))}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild((function(t){return e._registerControl(t)}))}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild((function(t,r){if(void 0===e[r])throw new Error("Must supply a value for form control at index: ".concat(r,"."))}))}},{key:"_allControlsDisabled",value:function(){var e,t=_createForOfIteratorHelper(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(r){t.e(r)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}},{key:"length",get:function(){return this.controls.length}}]),r}(tu),ou=((WE=function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"ngOnInit",value:function(){this._checkParentType(),this.formDirective.addFormGroup(this)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeFormGroup(this)}},{key:"_checkParentType",value:function(){}},{key:"control",get:function(){return this.formDirective.getFormGroup(this)}},{key:"path",get:function(){return DE(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return HE(this._validators)}},{key:"asyncValidator",get:function(){return jE(this._asyncValidators)}}]),r}($c)).\u0275fac=function(e){return _u(e||WE)},WE.\u0275dir=Rt({type:WE,features:[Q_]}),WE),_u=_n(ou),iu=((JE=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||JE)},JE.\u0275dir=Rt({type:JE,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),JE),su=new Qe("NgModelWithFormControlWarning"),lu={provide:$c,useExisting:Ye((function(){return cu}))},cu=((ZE=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this))._validators=e,a._asyncValidators=n,a.submitted=!1,a.directives=[],a.form=null,a.ngSubmit=new ts,a}return _createClass(r,[{key:"ngOnChanges",value:function(e){this._checkFormPresent(),e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations())}},{key:"addControl",value:function(e){var t=this.form.get(e.path);return FE(t,e),t.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),t}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t,r,n;t=this.directives,r=e,(n=t.indexOf(r))>-1&&t.splice(n,1)}},{key:"addFormGroup",value:function(e){var t=this.form.get(e.path);KE(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"removeFormGroup",value:function(e){}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"addFormArray",value:function(e){var t=this.form.get(e.path);KE(t,e),t.updateValueAndValidity({emitEvent:!1})}},{key:"removeFormArray",value:function(e){}},{key:"getFormArray",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){this.form.get(e.path).setValue(t)}},{key:"onSubmit",value:function(e){return this.submitted=!0,t=this.directives,this.form._syncPendingControls(),t.forEach((function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})),this.ngSubmit.emit(e),!1;var t}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_updateDomValue",value:function(){var e=this;this.directives.forEach((function(t){var r=e.form.get(t.path);t.control!==r&&(function(e,t){t.valueAccessor.registerOnChange((function(){return BE(t)})),t.valueAccessor.registerOnTouched((function(){return BE(t)})),t._rawValidators.forEach((function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(null)})),t._rawAsyncValidators.forEach((function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(null)})),e&&e._clearChangeFns()}(t.control,t),r&&FE(r,t),t.control=r)})),this.form._updateTreeValidity({emitEvent:!1})}},{key:"_updateRegistrations",value:function(){var e=this;this.form._registerOnCollectionChange((function(){return e._updateDomValue()})),this._oldForm&&this._oldForm._registerOnCollectionChange((function(){})),this._oldForm=this.form}},{key:"_updateValidators",value:function(){var e=HE(this._validators);this.form.validator=uE.compose([this.form.validator,e]);var t=jE(this._asyncValidators);this.form.asyncValidator=uE.composeAsync([this.form.asyncValidator,t])}},{key:"_checkFormPresent",value:function(){this.form||xE.missingFormException()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}}]),r}($c)).\u0275fac=function(e){return new(e||ZE)(P_(lE,10),P_(cE,10))},ZE.\u0275dir=Rt({type:ZE,selectors:[["","formGroup",""]],hostBindings:function(e,t){1&e&&I_("submit",(function(e){return t.onSubmit(e)}))("reset",(function(){return t.onReset()}))},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[li([lu]),Q_,$_]}),ZE),Eu={provide:$c,useExisting:Ye((function(){return uu}))},uu=(($E=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a){var o;return _classCallCheck(this,r),(o=t.call(this))._parent=e,o._validators=n,o._asyncValidators=a,o}return _createClass(r,[{key:"_checkParentType",value:function(){fu(this._parent)&&xE.groupParentException()}}]),r}(ou)).\u0275fac=function(e){return new(e||$E)(P_($c,13),P_(lE,10),P_(cE,10))},$E.\u0275dir=Rt({type:$E,selectors:[["","formGroupName",""]],inputs:{name:["formGroupName","name"]},features:[li([Eu]),Q_]}),$E),du={provide:$c,useExisting:Ye((function(){return Tu}))},Tu=((eu=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a){var o;return _classCallCheck(this,r),(o=t.call(this))._parent=e,o._validators=n,o._asyncValidators=a,o}return _createClass(r,[{key:"ngOnInit",value:function(){this._checkParentType(),this.formDirective.addFormArray(this)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeFormArray(this)}},{key:"_checkParentType",value:function(){fu(this._parent)&&xE.arrayParentException()}},{key:"control",get:function(){return this.formDirective.getFormArray(this)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"path",get:function(){return DE(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"validator",get:function(){return HE(this._validators)}},{key:"asyncValidator",get:function(){return jE(this._asyncValidators)}}]),r}($c)).\u0275fac=function(e){return new(e||eu)(P_($c,13),P_(lE,10),P_(cE,10))},eu.\u0275dir=Rt({type:eu,selectors:[["","formArrayName",""]],inputs:{name:["formArrayName","name"]},features:[li([du]),Q_]}),eu);function fu(e){return!(e instanceof uu||e instanceof cu||e instanceof Tu)}var pu,Pu,Su,Au,hu={provide:aE,useExisting:Ye((function(){return vu}))},vu=((Au=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o,_){var i;return _classCallCheck(this,r),(i=t.call(this))._ngModelWarningConfig=_,i._added=!1,i.update=new ts,i._ngModelWarningSent=!1,i._parent=e,i._rawValidators=n||[],i._rawAsyncValidators=a||[],i.valueAccessor=function(e,t){if(!t)return null;Array.isArray(t)||XE(e,"Value accessor was not provided as an array for form control with");var r=void 0,n=void 0,a=void 0;return t.forEach((function(t){var o;t.constructor===Jc?r=t:(o=t,zE.some((function(e){return o.constructor===e}))?(n&&XE(e,"More than one built-in value accessor matches form control with"),n=t):(a&&XE(e,"More than one custom value accessor matches form control with"),a=t))})),a||n||r||(XE(e,"No valid value accessor for form control with"),null)}(_assertThisInitialized(i),o),i}return _createClass(r,[{key:"ngOnChanges",value:function(e){var t,n;this._added||this._setUpControl(),function(e,t){if(!e.hasOwnProperty("model"))return!1;var r=e.model;return!!r.isFirstChange()||!E_(t,r.currentValue)}(e,this.viewModel)&&(t=r,n=this._ngModelWarningConfig,gn()&&"never"!==n&&((null!==n&&"once"!==n||t._ngModelWarningSentOnce)&&("always"!==n||this._ngModelWarningSent)||(xE.ngModelWarning("formControlName"),t._ngModelWarningSentOnce=!0,this._ngModelWarningSent=!0)),this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_checkParentType",value:function(){!(this._parent instanceof uu)&&this._parent instanceof ou?xE.ngModelGroupException():this._parent instanceof uu||this._parent instanceof cu||this._parent instanceof Tu||xE.controlParentException()}},{key:"_setUpControl",value:function(){this._checkParentType(),this.control=this.formDirective.addControl(this),this.control.disabled&&this.valueAccessor.setDisabledState&&this.valueAccessor.setDisabledState(!0),this._added=!0}},{key:"isDisabled",set:function(e){xE.disabledAttrWarning()}},{key:"path",get:function(){return DE(null==this.name?this.name:this.name.toString(),this._parent)}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"validator",get:function(){return HE(this._rawValidators)}},{key:"asyncValidator",get:function(){return jE(this._rawAsyncValidators)}}]),r}(aE)).\u0275fac=function(e){return new(e||Au)(P_($c,13),P_(lE,10),P_(cE,10),P_(zc,10),P_(su,8))},Au.\u0275dir=Rt({type:Au,selectors:[["","formControlName",""]],inputs:{isDisabled:["disabled","isDisabled"],name:["formControlName","name"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[li([hu]),Q_,$_]}),Au._ngModelWarningSentOnce=!1,Au),mu=((Su=function e(){_classCallCheck(this,e)}).\u0275mod=Ot({type:Su}),Su.\u0275inj=Ae({factory:function(e){return new(e||Su)}}),Su),gu=((Pu=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"group",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this._reduceControls(e),n=null,a=null,o=void 0;return null!=t&&(function(e){return void 0!==e.asyncValidators||void 0!==e.validators||void 0!==e.updateOn}(t)?(n=null!=t.validators?t.validators:null,a=null!=t.asyncValidators?t.asyncValidators:null,o=null!=t.updateOn?t.updateOn:void 0):(n=null!=t.validator?t.validator:null,a=null!=t.asyncValidator?t.asyncValidator:null)),new nu(r,{asyncValidators:a,updateOn:o,validators:n})}},{key:"control",value:function(e,t,r){return new ru(e,t,r)}},{key:"array",value:function(e,t,r){var n=this,a=e.map((function(e){return n._createControl(e)}));return new au(a,t,r)}},{key:"_reduceControls",value:function(e){var t=this,r={};return Object.keys(e).forEach((function(n){r[n]=t._createControl(e[n])})),r}},{key:"_createControl",value:function(e){return e instanceof ru||e instanceof nu||e instanceof au?e:Array.isArray(e)?this.control(e[0],e.length>1?e[1]:null,e.length>2?e[2]:null):this.control(e)}}]),e}()).\u0275fac=function(e){return new(e||Pu)},Pu.\u0275prov=Pe({token:Pu,factory:Pu.\u0275fac}),Pu),Ou=((pu=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"withConfig",value:function(t){return{ngModule:e,providers:[{provide:su,useValue:t.warnOnNgModelWithFormControl}]}}}]),e}()).\u0275mod=Ot({type:pu}),pu.\u0275inj=Ae({factory:function(e){return new(e||pu)},providers:[gu,IE],imports:[mu]}),pu);function Nu(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[t.length-1];return U(n)?(t.pop(),V(t,n)):ee(t)}function Ru(e,t){return W(e,t,1)}function Iu(e,t){return function(r){return r.lift(new bu(e,t))}}var bu=function(){function e(t,r){_classCallCheck(this,e),this.predicate=t,this.thisArg=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new yu(e,this.predicate,this.thisArg))}}]),e}(),yu=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a){var o;return _classCallCheck(this,r),(o=t.call(this,e)).predicate=n,o.thisArg=a,o.count=0,o}return _createClass(r,[{key:"_next",value:function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(r){return void this.destination.error(r)}t&&this.destination.next(e)}}]),r}(v),Lu=function e(){_classCallCheck(this,e)},Yu=function e(){_classCallCheck(this,e)},Mu=function(){function e(t){var r=this;_classCallCheck(this,e),this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?function(){r.headers=new Map,t.split("\n").forEach((function(e){var t=e.indexOf(":");if(t>0){var n=e.slice(0,t),a=n.toLowerCase(),o=e.slice(t+1).trim();r.maybeSetNormalizedName(n,a),r.headers.has(a)?r.headers.get(a).push(o):r.headers.set(a,[o])}}))}:function(){r.headers=new Map,Object.keys(t).forEach((function(e){var n=t[e],a=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(r.headers.set(a,n),r.maybeSetNormalizedName(e,a))}))}:this.headers=new Map}return _createClass(e,[{key:"has",value:function(e){return this.init(),this.headers.has(e.toLowerCase())}},{key:"get",value:function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(e){return this.init(),this.headers.get(e.toLowerCase())||null}},{key:"append",value:function(e,t){return this.clone({name:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({name:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({name:e,value:t,op:"d"})}},{key:"maybeSetNormalizedName",value:function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}},{key:"init",value:function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach((function(e){return t.applyUpdate(e)})),this.lazyUpdate=null))}},{key:"copyFrom",value:function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach((function(r){t.headers.set(r,e.headers.get(r)),t.normalizedNames.set(r,e.normalizedNames.get(r))}))}},{key:"clone",value:function(t){var r=new e;return r.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,r.lazyUpdate=(this.lazyUpdate||[]).concat([t]),r}},{key:"applyUpdate",value:function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var r=e.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(e.name,t);var n=("a"===e.op?this.headers.get(t):void 0)||[];n.push.apply(n,_toConsumableArray(r)),this.headers.set(t,n);break;case"d":var a=e.value;if(a){var o=this.headers.get(t);if(!o)return;0===(o=o.filter((function(e){return-1===a.indexOf(e)}))).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}},{key:"forEach",value:function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach((function(r){return e(t.normalizedNames.get(r),t.headers.get(r))}))}}]),e}(),xu=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"encodeKey",value:function(e){return Cu(e)}},{key:"encodeValue",value:function(e){return Cu(e)}},{key:"decodeKey",value:function(e){return decodeURIComponent(e)}},{key:"decodeValue",value:function(e){return decodeURIComponent(e)}}]),e}();function Cu(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}var wu=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck(this,e),this.updates=null,this.cloneFrom=null,this.encoder=r.encoder||new xu,r.fromString){if(r.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(e,t){var r=new Map;return e.length>0&&e.split("&").forEach((function(e){var n=e.indexOf("="),a=_slicedToArray(-1==n?[t.decodeKey(e),""]:[t.decodeKey(e.slice(0,n)),t.decodeValue(e.slice(n+1))],2),o=a[0],_=a[1],i=r.get(o)||[];i.push(_),r.set(o,i)})),r}(r.fromString,this.encoder)}else r.fromObject?(this.map=new Map,Object.keys(r.fromObject).forEach((function(e){var n=r.fromObject[e];t.map.set(e,Array.isArray(n)?n:[n])}))):this.map=null}return _createClass(e,[{key:"has",value:function(e){return this.init(),this.map.has(e)}},{key:"get",value:function(e){this.init();var t=this.map.get(e);return t?t[0]:null}},{key:"getAll",value:function(e){return this.init(),this.map.get(e)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(e,t){return this.clone({param:e,value:t,op:"a"})}},{key:"set",value:function(e,t){return this.clone({param:e,value:t,op:"s"})}},{key:"delete",value:function(e,t){return this.clone({param:e,value:t,op:"d"})}},{key:"toString",value:function(){var e=this;return this.init(),this.keys().map((function(t){var r=e.encoder.encodeKey(t);return e.map.get(t).map((function(t){return r+"="+e.encoder.encodeValue(t)})).join("&")})).filter((function(e){return""!==e})).join("&")}},{key:"clone",value:function(t){var r=new e({encoder:this.encoder});return r.cloneFrom=this.cloneFrom||this,r.updates=(this.updates||[]).concat([t]),r}},{key:"init",value:function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach((function(t){return e.map.set(t,e.cloneFrom.map.get(t))})),this.updates.forEach((function(t){switch(t.op){case"a":case"s":var r=("a"===t.op?e.map.get(t.param):void 0)||[];r.push(t.value),e.map.set(t.param,r);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var n=e.map.get(t.param)||[],a=n.indexOf(t.value);-1!==a&&n.splice(a,1),n.length>0?e.map.set(t.param,n):e.map.delete(t.param)}})),this.cloneFrom=this.updates=null)}}]),e}();function Uu(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function ku(e){return"undefined"!=typeof Blob&&e instanceof Blob}function Du(e){return"undefined"!=typeof FormData&&e instanceof FormData}var Fu=function(){function e(t,r,n,a){var o;if(_classCallCheck(this,e),this.url=r,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||a?(this.body=void 0!==n?n:null,o=a):o=n,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.params&&(this.params=o.params)),this.headers||(this.headers=new Mu),this.params){var _=this.params.toString();if(0===_.length)this.urlWithParams=r;else{var i=r.indexOf("?");this.urlWithParams=r+(-1===i?"?":i<r.length-1?"&":"")+_}}else this.params=new wu,this.urlWithParams=r}return _createClass(e,[{key:"serializeBody",value:function(){return null===this.body?null:Uu(this.body)||ku(this.body)||Du(this.body)||"string"==typeof this.body?this.body:this.body instanceof wu?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||Du(this.body)?null:ku(this.body)?this.body.type||null:Uu(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof wu?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null}},{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.method||this.method,n=t.url||this.url,a=t.responseType||this.responseType,o=void 0!==t.body?t.body:this.body,_=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,i=void 0!==t.reportProgress?t.reportProgress:this.reportProgress,s=t.headers||this.headers,l=t.params||this.params;return void 0!==t.setHeaders&&(s=Object.keys(t.setHeaders).reduce((function(e,r){return e.set(r,t.setHeaders[r])}),s)),t.setParams&&(l=Object.keys(t.setParams).reduce((function(e,r){return e.set(r,t.setParams[r])}),l)),new e(r,n,o,{params:l,headers:s,reportProgress:i,responseType:a,withCredentials:_})}}]),e}(),Gu=function(){var e={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return e[e.Sent]="Sent",e[e.UploadProgress]="UploadProgress",e[e.ResponseHeader]="ResponseHeader",e[e.DownloadProgress]="DownloadProgress",e[e.Response]="Response",e[e.User]="User",e}(),Ku=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";_classCallCheck(this,e),this.headers=t.headers||new Mu,this.status=void 0!==t.status?t.status:r,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300},Bu=function(e){_inherits(r,e);var t=_createSuper(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,r),(e=t.call(this,n)).type=Gu.ResponseHeader,e}return _createClass(r,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new r({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),r}(Ku),Xu=function(e){_inherits(r,e);var t=_createSuper(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,r),(e=t.call(this,n)).type=Gu.Response,e.body=void 0!==n.body?n.body:null,e}return _createClass(r,[{key:"clone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new r({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}]),r}(Ku),Hu=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this,e,0,"Unknown Error")).name="HttpErrorResponse",n.ok=!1,n.message=n.status>=200&&n.status<300?"Http failure during parsing for ".concat(e.url||"(unknown url)"):"Http failure response for ".concat(e.url||"(unknown url)",": ").concat(e.status," ").concat(e.statusText),n.error=e.error||null,n}return r}(Ku);function ju(e,t){return{body:t,headers:e.headers,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var zu,Qu,Vu,qu,Wu,Ju,Zu,$u,ed,td=((zu=function(){function e(t){_classCallCheck(this,e),this.handler=t}return _createClass(e,[{key:"request",value:function(e,t){var r,n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e instanceof Fu)r=e;else{var o=void 0;o=a.headers instanceof Mu?a.headers:new Mu(a.headers);var _=void 0;a.params&&(_=a.params instanceof wu?a.params:new wu({fromObject:a.params})),r=new Fu(e,t,void 0!==a.body?a.body:null,{headers:o,params:_,reportProgress:a.reportProgress,responseType:a.responseType||"json",withCredentials:a.withCredentials})}var i=Nu(r).pipe(Ru((function(e){return n.handler.handle(e)})));if(e instanceof Fu||"events"===a.observe)return i;var s=i.pipe(Iu((function(e){return e instanceof Xu})));switch(a.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return s.pipe(j((function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body})));case"blob":return s.pipe(j((function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body})));case"text":return s.pipe(j((function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body})));case"json":default:return s.pipe(j((function(e){return e.body})))}case"response":return s;default:throw new Error("Unreachable: unhandled observe type ".concat(a.observe,"}"))}}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,t)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",e,t)}},{key:"head",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",e,t)}},{key:"jsonp",value:function(e,t){return this.request("JSONP",e,{params:(new wu).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",e,t)}},{key:"patch",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",e,ju(r,t))}},{key:"post",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,ju(r,t))}},{key:"put",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,ju(r,t))}}]),e}()).\u0275fac=function(e){return new(e||zu)(rt(Lu))},zu.\u0275prov=Pe({token:zu,factory:zu.\u0275fac}),zu),rd=function(){function e(t,r){_classCallCheck(this,e),this.next=t,this.interceptor=r}return _createClass(e,[{key:"handle",value:function(e){return this.interceptor.intercept(e,this.next)}}]),e}(),nd=new Qe("HTTP_INTERCEPTORS"),ad=((Qu=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"intercept",value:function(e,t){return t.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||Qu)},Qu.\u0275prov=Pe({token:Qu,factory:Qu.\u0275fac}),Qu),od=/^\)\]\}',?\n/,_d=function e(){_classCallCheck(this,e)},id=((qu=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"build",value:function(){return new XMLHttpRequest}}]),e}()).\u0275fac=function(e){return new(e||qu)},qu.\u0275prov=Pe({token:qu,factory:qu.\u0275fac}),qu),sd=((Vu=function(){function e(t){_classCallCheck(this,e),this.xhrFactory=t}return _createClass(e,[{key:"handle",value:function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new b((function(r){var n=t.xhrFactory.build();if(n.open(e.method,e.urlWithParams),e.withCredentials&&(n.withCredentials=!0),e.headers.forEach((function(e,t){return n.setRequestHeader(e,t.join(","))})),e.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var a=e.detectContentTypeHeader();null!==a&&n.setRequestHeader("Content-Type",a)}if(e.responseType){var o=e.responseType.toLowerCase();n.responseType="json"!==o?o:"text"}var _=e.serializeBody(),i=null,s=function(){if(null!==i)return i;var t=1223===n.status?204:n.status,r=n.statusText||"OK",a=new Mu(n.getAllResponseHeaders()),o=function(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(n)||e.url;return i=new Bu({headers:a,status:t,statusText:r,url:o})},l=function(){var t=s(),a=t.headers,o=t.status,_=t.statusText,i=t.url,l=null;204!==o&&(l=void 0===n.response?n.responseText:n.response),0===o&&(o=l?200:0);var c=o>=200&&o<300;if("json"===e.responseType&&"string"==typeof l){var E=l;l=l.replace(od,"");try{l=""!==l?JSON.parse(l):null}catch(u){l=E,c&&(c=!1,l={error:u,text:l})}}c?(r.next(new Xu({body:l,headers:a,status:o,statusText:_,url:i||void 0})),r.complete()):r.error(new Hu({error:l,headers:a,status:o,statusText:_,url:i||void 0}))},c=function(e){var t=s().url,a=new Hu({error:e,status:n.status||0,statusText:n.statusText||"Unknown Error",url:t||void 0});r.error(a)},E=!1,u=function(t){E||(r.next(s()),E=!0);var a={type:Gu.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(a.total=t.total),"text"===e.responseType&&n.responseText&&(a.partialText=n.responseText),r.next(a)},d=function(e){var t={type:Gu.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),r.next(t)};return n.addEventListener("load",l),n.addEventListener("error",c),e.reportProgress&&(n.addEventListener("progress",u),null!==_&&n.upload&&n.upload.addEventListener("progress",d)),n.send(_),r.next({type:Gu.Sent}),function(){n.removeEventListener("error",c),n.removeEventListener("load",l),e.reportProgress&&(n.removeEventListener("progress",u),null!==_&&n.upload&&n.upload.removeEventListener("progress",d)),n.abort()}}))}}]),e}()).\u0275fac=function(e){return new(e||Vu)(rt(_d))},Vu.\u0275prov=Pe({token:Vu,factory:Vu.\u0275fac}),Vu),ld=new Qe("XSRF_COOKIE_NAME"),cd=new Qe("XSRF_HEADER_NAME"),Ed=function e(){_classCallCheck(this,e)},ud=((ed=function(){function e(t,r,n){_classCallCheck(this,e),this.doc=t,this.platform=r,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return _createClass(e,[{key:"getToken",value:function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=Kl(e,this.cookieName),this.lastCookieString=e),this.lastToken}}]),e}()).\u0275fac=function(e){return new(e||ed)(rt(Tl),rt(As),rt(ld))},ed.\u0275prov=Pe({token:ed,factory:ed.\u0275fac}),ed),dd=(($u=function(){function e(t,r){_classCallCheck(this,e),this.tokenService=t,this.headerName=r}return _createClass(e,[{key:"intercept",value:function(e,t){var r=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||r.startsWith("http://")||r.startsWith("https://"))return t.handle(e);var n=this.tokenService.getToken();return null===n||e.headers.has(this.headerName)||(e=e.clone({headers:e.headers.set(this.headerName,n)})),t.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||$u)(rt(Ed),rt(cd))},$u.\u0275prov=Pe({token:$u,factory:$u.\u0275fac}),$u),Td=((Zu=function(){function e(t,r){_classCallCheck(this,e),this.backend=t,this.injector=r,this.chain=null}return _createClass(e,[{key:"handle",value:function(e){if(null===this.chain){var t=this.injector.get(nd,[]);this.chain=t.reduceRight((function(e,t){return new rd(e,t)}),this.backend)}return this.chain.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||Zu)(rt(Yu),rt(n_))},Zu.\u0275prov=Pe({token:Zu,factory:Zu.\u0275fac}),Zu),fd=((Ju=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"disable",value:function(){return{ngModule:e,providers:[{provide:dd,useClass:ad}]}}},{key:"withOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:e,providers:[t.cookieName?{provide:ld,useValue:t.cookieName}:[],t.headerName?{provide:cd,useValue:t.headerName}:[]]}}}]),e}()).\u0275mod=Ot({type:Ju}),Ju.\u0275inj=Ae({factory:function(e){return new(e||Ju)},providers:[dd,{provide:nd,useExisting:dd,multi:!0},{provide:Ed,useClass:ud},{provide:ld,useValue:"XSRF-TOKEN"},{provide:cd,useValue:"X-XSRF-TOKEN"}]}),Ju),pd=((Wu=function e(){_classCallCheck(this,e)}).\u0275mod=Ot({type:Wu}),Wu.\u0275inj=Ae({factory:function(e){return new(e||Wu)},providers:[td,{provide:Lu,useClass:Td},sd,{provide:Yu,useExisting:sd},id,{provide:_d,useExisting:id}],imports:[[fd.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),Wu),Pd=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this))._value=e,n}return _createClass(r,[{key:"_subscribe",value:function(e){var t=_get(_getPrototypeOf(r.prototype),"_subscribe",this).call(this,e);return t&&!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Y;return this._value}},{key:"next",value:function(e){_get(_getPrototypeOf(r.prototype),"next",this).call(this,this._value=e)}},{key:"value",get:function(){return this.getValue()}}]),r}(C),Sd=function(){function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e}(),Ad={},hd=function(){function e(t){_classCallCheck(this,e),this.resultSelector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new vd(e,this.resultSelector))}}]),e}(),vd=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this,e)).resultSelector=n,a.active=0,a.values=[],a.observables=[],a}return _createClass(r,[{key:"_next",value:function(e){this.values.push(Ad),this.observables.push(e)}},{key:"_complete",value:function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var r=0;r<t;r++){var n=e[r];this.add(X(this,n,n,r))}}}},{key:"notifyComplete",value:function(e){0==(this.active-=1)&&this.destination.complete()}},{key:"notifyNext",value:function(e,t,r,n,a){var o=this.values,_=this.toRespond?o[r]===Ad?--this.toRespond:this.toRespond:0;o[r]=t,0===_&&(this.resultSelector?this._tryResultSelector(o):this.destination.next(o.slice()))}},{key:"_tryResultSelector",value:function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(r){return void this.destination.error(r)}this.destination.next(t)}}]),r}(H),md=new b((function(e){return e.complete()}));function gd(e){return e?function(e){return new b((function(t){return e.schedule((function(){return t.complete()}))}))}(e):md}function Od(e){return new b((function(t){var r;try{r=e()}catch(n){return void t.error(n)}return(r?q(r):gd()).subscribe(t)}))}function Nd(){return $(1)}var Rd=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}();function Id(e){return function(t){return 0===e?gd():t.lift(new bd(e))}}var bd=function(){function e(t){if(_classCallCheck(this,e),this.total=t,this.total<0)throw new Rd}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new yd(e,this.total))}}]),e}(),yd=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this,e)).total=n,a.ring=new Array,a.count=0,a}return _createClass(r,[{key:"_next",value:function(e){var t=this.ring,r=this.total,n=this.count++;t.length<r?t.push(e):t[n%r]=e}},{key:"_complete",value:function(){var e=this.destination,t=this.count;if(t>0)for(var r=this.count>=this.total?this.total:this.count,n=this.ring,a=0;a<r;a++){var o=t++%r;e.next(n[o])}e.complete()}}]),r}(v);function Ld(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xd;return function(t){return t.lift(new Yd(e))}}var Yd=function(){function e(t){_classCallCheck(this,e),this.errorFactory=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Md(e,this.errorFactory))}}]),e}(),Md=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this,e)).errorFactory=n,a.hasValue=!1,a}return _createClass(r,[{key:"_next",value:function(e){this.hasValue=!0,this.destination.next(e)}},{key:"_complete",value:function(){if(this.hasValue)return this.destination.complete();var e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}]),r}(v);function xd(){return new Sd}function Cd(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(t){return t.lift(new wd(e))}}var wd=function(){function e(t){_classCallCheck(this,e),this.defaultValue=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Ud(e,this.defaultValue))}}]),e}(),Ud=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this,e)).defaultValue=n,a.isEmpty=!0,a}return _createClass(r,[{key:"_next",value:function(e){this.isEmpty=!1,this.destination.next(e)}},{key:"_complete",value:function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}]),r}(v);function kd(e,t){var r=arguments.length>=2;return function(n){return n.pipe(e?Iu((function(t,r){return e(t,r,n)})):O,Id(1),r?Cd(t):Ld((function(){return new Sd})))}}function Dd(e){return function(t){var r=new Fd(e),n=t.lift(r);return r.caught=n}}var Fd=function(){function e(t){_classCallCheck(this,e),this.selector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Gd(e,this.selector,this.caught))}}]),e}(),Gd=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a){var o;return _classCallCheck(this,r),(o=t.call(this,e)).selector=n,o.caught=a,o}return _createClass(r,[{key:"error",value:function(e){if(!this.isStopped){var t;try{t=this.selector(e,this.caught)}catch(o){return void _get(_getPrototypeOf(r.prototype),"error",this).call(this,o)}this._unsubscribeAndRecycle();var n=new k(this,void 0,void 0);this.add(n);var a=X(this,t,void 0,void 0,n);a!==n&&this.add(a)}}}]),r}(H);function Kd(e){return function(t){return 0===e?gd():t.lift(new Bd(e))}}var Bd=function(){function e(t){if(_classCallCheck(this,e),this.total=t,this.total<0)throw new Rd}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Xd(e,this.total))}}]),e}(),Xd=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this,e)).total=n,a.count=0,a}return _createClass(r,[{key:"_next",value:function(e){var t=this.total,r=++this.count;r<=t&&(this.destination.next(e),r===t&&(this.destination.complete(),this.unsubscribe()))}}]),r}(v);function Hd(e,t){var r=arguments.length>=2;return function(n){return n.pipe(e?Iu((function(t,r){return e(t,r,n)})):O,Kd(1),r?Cd(t):Ld((function(){return new Sd})))}}var jd=function(){function e(t,r,n){_classCallCheck(this,e),this.predicate=t,this.thisArg=r,this.source=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new zd(e,this.predicate,this.thisArg,this.source))}}]),e}(),zd=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o){var _;return _classCallCheck(this,r),(_=t.call(this,e)).predicate=n,_.thisArg=a,_.source=o,_.index=0,_.thisArg=a||_assertThisInitialized(_),_}return _createClass(r,[{key:"notifyComplete",value:function(e){this.destination.next(e),this.destination.complete()}},{key:"_next",value:function(e){var t=!1;try{t=this.predicate.call(this.thisArg,e,this.index++,this.source)}catch(r){return void this.destination.error(r)}t||this.notifyComplete(!1)}},{key:"_complete",value:function(){this.notifyComplete(!0)}}]),r}(v);function Qd(e,t){return"function"==typeof t?function(r){return r.pipe(Qd((function(r,n){return q(e(r,n)).pipe(j((function(e,a){return t(r,e,n,a)})))})))}:function(t){return t.lift(new Vd(e))}}var Vd=function(){function e(t){_classCallCheck(this,e),this.project=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new qd(e,this.project))}}]),e}(),qd=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this,e)).project=n,a.index=0,a}return _createClass(r,[{key:"_next",value:function(e){var t,r=this.index++;try{t=this.project(e,r)}catch(n){return void this.destination.error(n)}this._innerSub(t,e,r)}},{key:"_innerSub",value:function(e,t,r){var n=this.innerSubscription;n&&n.unsubscribe();var a=new k(this,t,r),o=this.destination;o.add(a),this.innerSubscription=X(this,e,void 0,void 0,a),this.innerSubscription!==a&&o.add(this.innerSubscription)}},{key:"_complete",value:function(){var e=this.innerSubscription;e&&!e.closed||_get(_getPrototypeOf(r.prototype),"_complete",this).call(this),this.unsubscribe()}},{key:"_unsubscribe",value:function(){this.innerSubscription=null}},{key:"notifyComplete",value:function(e){this.destination.remove(e),this.innerSubscription=null,this.isStopped&&_get(_getPrototypeOf(r.prototype),"_complete",this).call(this)}},{key:"notifyNext",value:function(e,t,r,n,a){this.destination.next(t)}}]),r}(H);function Wd(){return Nd()(Nu.apply(void 0,arguments))}function Jd(e,t){var r=!1;return arguments.length>=2&&(r=!0),function(n){return n.lift(new Zd(e,t,r))}}var Zd=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,e),this.accumulator=t,this.seed=r,this.hasSeed=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new $d(e,this.accumulator,this.seed,this.hasSeed))}}]),e}(),$d=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o){var _;return _classCallCheck(this,r),(_=t.call(this,e)).accumulator=n,_._seed=a,_.hasSeed=o,_.index=0,_}return _createClass(r,[{key:"_next",value:function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}},{key:"_tryNext",value:function(e){var t,r=this.index++;try{t=this.accumulator(this.seed,e,r)}catch(n){this.destination.error(n)}this.seed=t,this.destination.next(t)}},{key:"seed",get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e}}]),r}(v);function eT(){}function tT(e,t,r){return function(n){return n.lift(new nT(e,t,r))}}var rT,nT=function(){function e(t,r,n){_classCallCheck(this,e),this.nextOrObserver=t,this.error=r,this.complete=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new aT(e,this.nextOrObserver,this.error,this.complete))}}]),e}(),aT=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o){var _;return _classCallCheck(this,r),(_=t.call(this,e))._tapNext=eT,_._tapError=eT,_._tapComplete=eT,_._tapError=a||eT,_._tapComplete=o||eT,l(n)?(_._context=_assertThisInitialized(_),_._tapNext=n):n&&(_._context=n,_._tapNext=n.next||eT,_._tapError=n.error||eT,_._tapComplete=n.complete||eT),_}return _createClass(r,[{key:"_next",value:function(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}},{key:"_error",value:function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)}},{key:"_complete",value:function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}]),r}(v),oT=function(){function e(t){_classCallCheck(this,e),this.callback=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new _T(e,this.callback))}}]),e}(),_T=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this,e)).add(new S(n)),a}return r}(v),iT=function e(t,r){_classCallCheck(this,e),this.id=t,this.url=r},sT=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",_=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return _classCallCheck(this,r),(a=t.call(this,e,n)).navigationTrigger=o,a.restoredState=_,a}return _createClass(r,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),r}(iT),lT=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a){var o;return _classCallCheck(this,r),(o=t.call(this,e,n)).urlAfterRedirects=a,o}return _createClass(r,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),r}(iT),cT=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a){var o;return _classCallCheck(this,r),(o=t.call(this,e,n)).reason=a,o}return _createClass(r,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),r}(iT),ET=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a){var o;return _classCallCheck(this,r),(o=t.call(this,e,n)).error=a,o}return _createClass(r,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),r}(iT),uT=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o){var _;return _classCallCheck(this,r),(_=t.call(this,e,n)).urlAfterRedirects=a,_.state=o,_}return _createClass(r,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),r}(iT),dT=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o){var _;return _classCallCheck(this,r),(_=t.call(this,e,n)).urlAfterRedirects=a,_.state=o,_}return _createClass(r,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),r}(iT),TT=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o,_){var i;return _classCallCheck(this,r),(i=t.call(this,e,n)).urlAfterRedirects=a,i.state=o,i.shouldActivate=_,i}return _createClass(r,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),r}(iT),fT=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o){var _;return _classCallCheck(this,r),(_=t.call(this,e,n)).urlAfterRedirects=a,_.state=o,_}return _createClass(r,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),r}(iT),pT=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o){var _;return _classCallCheck(this,r),(_=t.call(this,e,n)).urlAfterRedirects=a,_.state=o,_}return _createClass(r,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),r}(iT),PT=function(){function e(t){_classCallCheck(this,e),this.route=t}return _createClass(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),ST=function(){function e(t){_classCallCheck(this,e),this.route=t}return _createClass(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),AT=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),hT=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),vT=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),mT=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),gT=function(){function e(t,r,n){_classCallCheck(this,e),this.routerEvent=t,this.position=r,this.anchor=n}return _createClass(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),OT=((rT=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||rT)},rT.\u0275cmp=ht({type:rT,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&g_(0,"router-outlet")},directives:function(){return[Mp]},encapsulation:2}),rT),NT=function(){function e(t){_classCallCheck(this,e),this.params=t||{}}return _createClass(e,[{key:"has",value:function(e){return this.params.hasOwnProperty(e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function RT(e){return new NT(e)}function IT(e){var t=Error("NavigationCancelingError: "+e);return t.ngNavigationCancelingError=!0,t}function bT(e,t,r){var n=r.path.split("/");if(n.length>e.length)return null;if("full"===r.pathMatch&&(t.hasChildren()||n.length<e.length))return null;for(var a={},o=0;o<n.length;o++){var _=n[o],i=e[o];if(_.startsWith(":"))a[_.substring(1)]=i;else if(_!==i.path)return null}return{consumed:e.slice(0,n.length),posParams:a}}var yT=function e(t,r){_classCallCheck(this,e),this.routes=t,this.module=r};function LT(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=0;r<e.length;r++){var n=e[r];YT(n,MT(t,n))}}function YT(e,t){if(!e)throw new Error("\n      Invalid configuration of route '".concat(t,"': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    "));if(Array.isArray(e))throw new Error("Invalid configuration of route '".concat(t,"': Array cannot be specified"));if(!e.component&&!e.children&&!e.loadChildren&&e.outlet&&"primary"!==e.outlet)throw new Error("Invalid configuration of route '".concat(t,"': a componentless route without children or loadChildren cannot have a named outlet set"));if(e.redirectTo&&e.children)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and children cannot be used together"));if(e.redirectTo&&e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and loadChildren cannot be used together"));if(e.children&&e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"': children and loadChildren cannot be used together"));if(e.redirectTo&&e.component)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and component cannot be used together"));if(e.path&&e.matcher)throw new Error("Invalid configuration of route '".concat(t,"': path and matcher cannot be used together"));if(void 0===e.redirectTo&&!e.component&&!e.children&&!e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"'. One of the following must be provided: component, redirectTo, children or loadChildren"));if(void 0===e.path&&void 0===e.matcher)throw new Error("Invalid configuration of route '".concat(t,"': routes must have either a path or a matcher specified"));if("string"==typeof e.path&&"/"===e.path.charAt(0))throw new Error("Invalid configuration of route '".concat(t,"': path cannot start with a slash"));if(""===e.path&&void 0!==e.redirectTo&&void 0===e.pathMatch)throw new Error("Invalid configuration of route '{path: \"".concat(t,'", redirectTo: "').concat(e.redirectTo,"\"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'."));if(void 0!==e.pathMatch&&"full"!==e.pathMatch&&"prefix"!==e.pathMatch)throw new Error("Invalid configuration of route '".concat(t,"': pathMatch can only be set to 'prefix' or 'full'"));e.children&&LT(e.children,t)}function MT(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function xT(e){var t=e.children&&e.children.map(xT),r=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!r.component&&(t||r.loadChildren)&&r.outlet&&"primary"!==r.outlet&&(r.component=OT),r}function CT(e,t){var r,n=Object.keys(e),a=Object.keys(t);if(!n||!a||n.length!=a.length)return!1;for(var o=0;o<n.length;o++)if(!wT(e[r=n[o]],t[r]))return!1;return!0}function wT(e,t){return Array.isArray(e)&&Array.isArray(t)?e.length==t.length&&e.every((function(e){return t.indexOf(e)>-1})):e===t}function UT(e){return Array.prototype.concat.apply([],e)}function kT(e){return e.length>0?e[e.length-1]:null}function DT(e,t){for(var r in e)e.hasOwnProperty(r)&&t(e[r],r)}function FT(e){return R_(e)?e:N_(e)?q(Promise.resolve(e)):Nu(e)}function GT(e,t,r){return r?function(e,t){return CT(e,t)}(e.queryParams,t.queryParams)&&function e(t,r){if(!HT(t.segments,r.segments))return!1;if(t.numberOfChildren!==r.numberOfChildren)return!1;for(var n in r.children){if(!t.children[n])return!1;if(!e(t.children[n],r.children[n]))return!1}return!0}(e.root,t.root):function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every((function(r){return wT(e[r],t[r])}))}(e.queryParams,t.queryParams)&&function e(t,r){return function t(r,n,a){if(r.segments.length>a.length)return!!HT(r.segments.slice(0,a.length),a)&&!n.hasChildren();if(r.segments.length===a.length){if(!HT(r.segments,a))return!1;for(var o in n.children){if(!r.children[o])return!1;if(!e(r.children[o],n.children[o]))return!1}return!0}var _=a.slice(0,r.segments.length),i=a.slice(r.segments.length);return!!HT(r.segments,_)&&!!r.children.primary&&t(r.children.primary,n,i)}(t,r,r.segments)}(e.root,t.root)}var KT=function(){function e(t,r,n){_classCallCheck(this,e),this.root=t,this.queryParams=r,this.fragment=n}return _createClass(e,[{key:"toString",value:function(){return VT.serialize(this)}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=RT(this.queryParams)),this._queryParamMap}}]),e}(),BT=function(){function e(t,r){var n=this;_classCallCheck(this,e),this.segments=t,this.children=r,this.parent=null,DT(r,(function(e,t){return e.parent=n}))}return _createClass(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"toString",value:function(){return qT(this)}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}}]),e}(),XT=function(){function e(t,r){_classCallCheck(this,e),this.path=t,this.parameters=r}return _createClass(e,[{key:"toString",value:function(){return tf(this)}},{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=RT(this.parameters)),this._parameterMap}}]),e}();function HT(e,t){return e.length===t.length&&e.every((function(e,r){return e.path===t[r].path}))}function jT(e,t){var r=[];return DT(e.children,(function(e,n){"primary"===n&&(r=r.concat(t(e,n)))})),DT(e.children,(function(e,n){"primary"!==n&&(r=r.concat(t(e,n)))})),r}var zT=function e(){_classCallCheck(this,e)},QT=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"parse",value:function(e){var t=new _f(e);return new KT(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t,r,n;return"".concat("/".concat(function e(t,r){if(!t.hasChildren())return qT(t);if(r){var n=t.children.primary?e(t.children.primary,!1):"",a=[];return DT(t.children,(function(t,r){"primary"!==r&&a.push("".concat(r,":").concat(e(t,!1)))})),a.length>0?"".concat(n,"(").concat(a.join("//"),")"):n}var o=jT(t,(function(r,n){return"primary"===n?[e(t.children.primary,!1)]:["".concat(n,":").concat(e(r,!1))]}));return"".concat(qT(t),"/(").concat(o.join("//"),")")}(e.root,!0)),(r=e.queryParams,n=Object.keys(r).map((function(e){var t=r[e];return Array.isArray(t)?t.map((function(t){return"".concat(JT(e),"=").concat(JT(t))})).join("&"):"".concat(JT(e),"=").concat(JT(t))})),n.length?"?".concat(n.join("&")):"")).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),VT=new QT;function qT(e){return e.segments.map((function(e){return tf(e)})).join("/")}function WT(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function JT(e){return WT(e).replace(/%3B/gi,";")}function ZT(e){return WT(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function $T(e){return decodeURIComponent(e)}function ef(e){return $T(e.replace(/\+/g,"%20"))}function tf(e){return"".concat(ZT(e.path)).concat((t=e.parameters,Object.keys(t).map((function(e){return";".concat(ZT(e),"=").concat(ZT(t[e]))})).join("")));var t}var rf=/^[^\/()?;=#]+/;function nf(e){var t=e.match(rf);return t?t[0]:""}var af=/^[^=?&#]+/,of=/^[^?&#]+/,_f=function(){function e(t){_classCallCheck(this,e),this.url=t,this.remaining=t}return _createClass(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new BT([],{}):new BT([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r.primary=new BT(e,t)),r}},{key:"parseSegment",value:function(){var e=nf(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new XT($T(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=nf(this.remaining);if(t){this.capture(t);var r="";if(this.consumeOptional("=")){var n=nf(this.remaining);n&&(r=n,this.capture(r))}e[$T(t)]=$T(r)}}},{key:"parseQueryParam",value:function(e){var t=function(e){var t=e.match(af);return t?t[0]:""}(this.remaining);if(t){this.capture(t);var r="";if(this.consumeOptional("=")){var n=function(e){var t=e.match(of);return t?t[0]:""}(this.remaining);n&&(r=n,this.capture(r))}var a=ef(t),o=ef(r);if(e.hasOwnProperty(a)){var _=e[a];Array.isArray(_)||(_=[_],e[a]=_),_.push(o)}else e[a]=o}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var r=nf(this.remaining),n=this.remaining[r.length];if("/"!==n&&")"!==n&&";"!==n)throw new Error("Cannot parse url '".concat(this.url,"'"));var a=void 0;r.indexOf(":")>-1?(a=r.substr(0,r.indexOf(":")),this.capture(a),this.capture(":")):e&&(a="primary");var o=this.parseChildren();t[a]=1===Object.keys(o).length?o.primary:new BT([],o),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),sf=function(){function e(t){_classCallCheck(this,e),this._root=t}return _createClass(e,[{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=lf(e,this._root);return t?t.children.map((function(e){return e.value})):[]}},{key:"firstChild",value:function(e){var t=lf(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=cf(e,this._root);return t.length<2?[]:t[t.length-2].children.map((function(e){return e.value})).filter((function(t){return t!==e}))}},{key:"pathFromRoot",value:function(e){return cf(e,this._root).map((function(e){return e.value}))}},{key:"root",get:function(){return this._root.value}}]),e}();function lf(e,t){if(e===t.value)return t;var r,n=_createForOfIteratorHelper(t.children);try{for(n.s();!(r=n.n()).done;){var a=lf(e,r.value);if(a)return a}}catch(o){n.e(o)}finally{n.f()}return null}function cf(e,t){if(e===t.value)return[t];var r,n=_createForOfIteratorHelper(t.children);try{for(n.s();!(r=n.n()).done;){var a=cf(e,r.value);if(a.length)return a.unshift(t),a}}catch(o){n.e(o)}finally{n.f()}return[]}var Ef=function(){function e(t,r){_classCallCheck(this,e),this.value=t,this.children=r}return _createClass(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function uf(e){var t={};return e&&e.children.forEach((function(e){return t[e.value.outlet]=e})),t}var df=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this,e)).snapshot=n,Af(_assertThisInitialized(a),e),a}return _createClass(r,[{key:"toString",value:function(){return this.snapshot.toString()}}]),r}(sf);function Tf(e,t){var r=function(e,t){var r=new Pf([],{},{},"",{},"primary",t,null,e.root,-1,{});return new Sf("",new Ef(r,[]))}(e,t),n=new Pd([new XT("",{})]),a=new Pd({}),o=new Pd({}),_=new Pd({}),i=new Pd(""),s=new ff(n,a,_,i,o,"primary",t,r.root);return s.snapshot=r.root,new df(new Ef(s,[]),r)}var ff=function(){function e(t,r,n,a,o,_,i,s){_classCallCheck(this,e),this.url=t,this.params=r,this.queryParams=n,this.fragment=a,this.data=o,this.outlet=_,this.component=i,this._futureSnapshot=s}return _createClass(e,[{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}},{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(j((function(e){return RT(e)})))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(j((function(e){return RT(e)})))),this._queryParamMap}}]),e}();function pf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",r=e.pathFromRoot,n=0;if("always"!==t)for(n=r.length-1;n>=1;){var a=r[n],o=r[n-1];if(a.routeConfig&&""===a.routeConfig.path)n--;else{if(o.component)break;n--}}return function(e){return e.reduce((function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}}),{params:{},data:{},resolve:{}})}(r.slice(n))}var Pf=function(){function e(t,r,n,a,o,_,i,s,l,c,E){_classCallCheck(this,e),this.url=t,this.params=r,this.queryParams=n,this.fragment=a,this.data=o,this.outlet=_,this.component=i,this.routeConfig=s,this._urlSegment=l,this._lastPathIndex=c,this._resolve=E}return _createClass(e,[{key:"toString",value:function(){return"Route(url:'".concat(this.url.map((function(e){return e.toString()})).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=RT(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=RT(this.queryParams)),this._queryParamMap}}]),e}(),Sf=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this,n)).url=e,Af(_assertThisInitialized(a),n),a}return _createClass(r,[{key:"toString",value:function(){return hf(this._root)}}]),r}(sf);function Af(e,t){t.value._routerState=e,t.children.forEach((function(t){return Af(e,t)}))}function hf(e){var t=e.children.length>0?" { ".concat(e.children.map(hf).join(", ")," } "):"";return"".concat(e.value).concat(t)}function vf(e){if(e.snapshot){var t=e.snapshot,r=e._futureSnapshot;e.snapshot=r,CT(t.queryParams,r.queryParams)||e.queryParams.next(r.queryParams),t.fragment!==r.fragment&&e.fragment.next(r.fragment),CT(t.params,r.params)||e.params.next(r.params),function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!CT(e[r],t[r]))return!1;return!0}(t.url,r.url)||e.url.next(r.url),CT(t.data,r.data)||e.data.next(r.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function mf(e,t){var r,n;return CT(e.params,t.params)&&HT(r=e.url,n=t.url)&&r.every((function(e,t){return CT(e.parameters,n[t].parameters)}))&&!(!e.parent!=!t.parent)&&(!e.parent||mf(e.parent,t.parent))}function gf(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function Of(e,t,r,n,a){var o={};return n&&DT(n,(function(e,t){o[t]=Array.isArray(e)?e.map((function(e){return"".concat(e)})):"".concat(e)})),new KT(r.root===e?t:function e(t,r,n){var a={};return DT(t.children,(function(t,o){a[o]=t===r?n:e(t,r,n)})),new BT(t.segments,a)}(r.root,e,t),o,a)}var Nf=function(){function e(t,r,n){if(_classCallCheck(this,e),this.isAbsolute=t,this.numberOfDoubleDots=r,this.commands=n,t&&n.length>0&&gf(n[0]))throw new Error("Root segment cannot have matrix parameters");var a=n.find((function(e){return"object"==typeof e&&null!=e&&e.outlets}));if(a&&a!==kT(n))throw new Error("{outlets:{}} has to be the last command")}return _createClass(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),Rf=function e(t,r,n){_classCallCheck(this,e),this.segmentGroup=t,this.processChildren=r,this.index=n};function If(e){return"object"==typeof e&&null!=e&&e.outlets?e.outlets.primary:"".concat(e)}function bf(e,t,r){if(e||(e=new BT([],{})),0===e.segments.length&&e.hasChildren())return yf(e,t,r);var n=function(e,t,r){for(var n=0,a=t,o={match:!1,pathIndex:0,commandIndex:0};a<e.segments.length;){if(n>=r.length)return o;var _=e.segments[a],i=If(r[n]),s=n<r.length-1?r[n+1]:null;if(a>0&&void 0===i)break;if(i&&s&&"object"==typeof s&&void 0===s.outlets){if(!xf(i,s,_))return o;n+=2}else{if(!xf(i,{},_))return o;n++}a++}return{match:!0,pathIndex:a,commandIndex:n}}(e,t,r),a=r.slice(n.commandIndex);if(n.match&&n.pathIndex<e.segments.length){var o=new BT(e.segments.slice(0,n.pathIndex),{});return o.children.primary=new BT(e.segments.slice(n.pathIndex),e.children),yf(o,0,a)}return n.match&&0===a.length?new BT(e.segments,{}):n.match&&!e.hasChildren()?Lf(e,t,r):n.match?yf(e,0,a):Lf(e,t,r)}function yf(e,t,r){if(0===r.length)return new BT(e.segments,{});var n=function(e){return"object"!=typeof e[0]||void 0===e[0].outlets?{primary:e}:e[0].outlets}(r),a={};return DT(n,(function(r,n){null!==r&&(a[n]=bf(e.children[n],t,r))})),DT(e.children,(function(e,t){void 0===n[t]&&(a[t]=e)})),new BT(e.segments,a)}function Lf(e,t,r){for(var n=e.segments.slice(0,t),a=0;a<r.length;){if("object"==typeof r[a]&&void 0!==r[a].outlets){var o=Yf(r[a].outlets);return new BT(n,o)}if(0===a&&gf(r[0]))n.push(new XT(e.segments[t].path,r[0])),a++;else{var _=If(r[a]),i=a<r.length-1?r[a+1]:null;_&&i&&gf(i)?(n.push(new XT(_,Mf(i))),a+=2):(n.push(new XT(_,{})),a++)}}return new BT(n,{})}function Yf(e){var t={};return DT(e,(function(e,r){null!==e&&(t[r]=Lf(new BT([],{}),0,e))})),t}function Mf(e){var t={};return DT(e,(function(e,r){return t[r]="".concat(e)})),t}function xf(e,t,r){return e==r.path&&CT(t,r.parameters)}var Cf=function(){function e(t,r,n,a){_classCallCheck(this,e),this.routeReuseStrategy=t,this.futureState=r,this.currState=n,this.forwardEvent=a}return _createClass(e,[{key:"activate",value:function(e){var t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),vf(this.futureState.root),this.activateChildRoutes(t,r,e)}},{key:"deactivateChildRoutes",value:function(e,t,r){var n=this,a=uf(t);e.children.forEach((function(e){var t=e.value.outlet;n.deactivateRoutes(e,a[t],r),delete a[t]})),DT(a,(function(e,t){n.deactivateRouteAndItsChildren(e,r)}))}},{key:"deactivateRoutes",value:function(e,t,r){var n=e.value,a=t?t.value:null;if(n===a)if(n.component){var o=r.getContext(n.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else a&&this.deactivateRouteAndItsChildren(t,r)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var r=t.getContext(e.value.outlet);if(r&&r.outlet){var n=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:n,route:e,contexts:a})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){var r=this,n=t.getContext(e.value.outlet);if(n){var a=uf(e),o=e.value.component?n.children:t;DT(a,(function(e,t){return r.deactivateRouteAndItsChildren(e,o)})),n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated())}}},{key:"activateChildRoutes",value:function(e,t,r){var n=this,a=uf(t);e.children.forEach((function(e){n.activateRoutes(e,a[e.value.outlet],r),n.forwardEvent(new mT(e.value.snapshot))})),e.children.length&&this.forwardEvent(new hT(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,r){var n=e.value,a=t?t.value:null;if(vf(n),n===a)if(n.component){var o=r.getOrCreateContext(n.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(n.component){var _=r.getOrCreateContext(n.outlet);if(this.routeReuseStrategy.shouldAttach(n.snapshot)){var i=this.routeReuseStrategy.retrieve(n.snapshot);this.routeReuseStrategy.store(n.snapshot,null),_.children.onOutletReAttached(i.contexts),_.attachRef=i.componentRef,_.route=i.route.value,_.outlet&&_.outlet.attach(i.componentRef,i.route.value),wf(i.route)}else{var s=function(e){for(var t=e.parent;t;t=t.parent){var r=t.routeConfig;if(r&&r._loadedConfig)return r._loadedConfig;if(r&&r.component)return null}return null}(n.snapshot),l=s?s.module.componentFactoryResolver:null;_.attachRef=null,_.route=n,_.resolver=l,_.outlet&&_.outlet.activateWith(n,l),this.activateChildRoutes(e,null,_.children)}}else this.activateChildRoutes(e,null,r)}}]),e}();function wf(e){vf(e.value),e.children.forEach(wf)}function Uf(e){return"function"==typeof e}function kf(e){return e instanceof KT}var Df=function e(t){_classCallCheck(this,e),this.segmentGroup=t||null},Ff=function e(t){_classCallCheck(this,e),this.urlTree=t};function Gf(e){return new b((function(t){return t.error(new Df(e))}))}function Kf(e){return new b((function(t){return t.error(new Ff(e))}))}function Bf(e){return new b((function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))}))}var Xf=function(){function e(t,r,n,a,o){_classCallCheck(this,e),this.configLoader=r,this.urlSerializer=n,this.urlTree=a,this.config=o,this.allowRedirects=!0,this.ngModule=t.get(it)}return _createClass(e,[{key:"apply",value:function(){var e=this;return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(j((function(t){return e.createUrlTree(t,e.urlTree.queryParams,e.urlTree.fragment)}))).pipe(Dd((function(t){if(t instanceof Ff)return e.allowRedirects=!1,e.match(t.urlTree);if(t instanceof Df)throw e.noMatchError(t);throw t})))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,"primary").pipe(j((function(r){return t.createUrlTree(r,e.queryParams,e.fragment)}))).pipe(Dd((function(e){if(e instanceof Df)throw t.noMatchError(e);throw e})))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,r){var n=e.segments.length>0?new BT([],{primary:e}):e;return new KT(n,t,r)}},{key:"expandSegmentGroup",value:function(e,t,r,n){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,t,r).pipe(j((function(e){return new BT([],e)}))):this.expandSegment(e,r,t,r.segments,n,!0)}},{key:"expandChildren",value:function(e,t,r){var n=this;return function(r,a){if(0===Object.keys(r).length)return Nu({});var o=[],_=[],i={};return DT(r,(function(r,a){var s,l,c=(s=a,l=r,n.expandSegmentGroup(e,t,l,s)).pipe(j((function(e){return i[a]=e})));"primary"===a?o.push(c):_.push(c)})),Nu.apply(null,o.concat(_)).pipe(Nd(),kd(),j((function(){return i})))}(r.children)}},{key:"expandSegment",value:function(e,t,r,n,a,o){var _=this;return Nu.apply(void 0,_toConsumableArray(r)).pipe(j((function(i){return _.expandSegmentAgainstRoute(e,t,r,i,n,a,o).pipe(Dd((function(e){if(e instanceof Df)return Nu(null);throw e})))})),Nd(),Hd((function(e){return!!e})),Dd((function(e,r){if(e instanceof Sd||"EmptyError"===e.name){if(_.noLeftoversInUrl(t,n,a))return Nu(new BT([],{}));throw new Df(t)}throw e})))}},{key:"noLeftoversInUrl",value:function(e,t,r){return 0===t.length&&!e.children[r]}},{key:"expandSegmentAgainstRoute",value:function(e,t,r,n,a,o,_){return Qf(n)!==o?Gf(t):void 0===n.redirectTo?this.matchSegmentAgainstRoute(e,t,n,a):_&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,r,n,a,o):Gf(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,r,n,a,o){return"**"===n.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,n,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,n,a,o)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,r,n){var a=this,o=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?Kf(o):this.lineralizeSegments(r,o).pipe(W((function(r){var o=new BT(r,{});return a.expandSegment(e,o,t,r,n,!1)})))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,r,n,a,o){var _=this,i=Hf(t,n,a),s=i.matched,l=i.consumedSegments,c=i.lastChild,E=i.positionalParamSegments;if(!s)return Gf(t);var u=this.applyRedirectCommands(l,n.redirectTo,E);return n.redirectTo.startsWith("/")?Kf(u):this.lineralizeSegments(n,u).pipe(W((function(n){return _.expandSegment(e,t,r,n.concat(a.slice(c)),o,!1)})))}},{key:"matchSegmentAgainstRoute",value:function(e,t,r,n){var a=this;if("**"===r.path)return r.loadChildren?this.configLoader.load(e.injector,r).pipe(j((function(e){return r._loadedConfig=e,new BT(n,{})}))):Nu(new BT(n,{}));var o=Hf(t,r,n),_=o.matched,i=o.consumedSegments,s=o.lastChild;if(!_)return Gf(t);var l=n.slice(s);return this.getChildConfig(e,r,n).pipe(W((function(e){var r=e.module,n=e.routes,o=function(e,t,r,n){return r.length>0&&function(e,t,r){return r.some((function(r){return zf(e,t,r)&&"primary"!==Qf(r)}))}(e,r,n)?{segmentGroup:jf(new BT(t,function(e,t){var r={};r.primary=t;var n,a=_createForOfIteratorHelper(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;""===o.path&&"primary"!==Qf(o)&&(r[Qf(o)]=new BT([],{}))}}catch(_){a.e(_)}finally{a.f()}return r}(n,new BT(r,e.children)))),slicedSegments:[]}:0===r.length&&function(e,t,r){return r.some((function(r){return zf(e,t,r)}))}(e,r,n)?{segmentGroup:jf(new BT(e.segments,function(e,t,r,n){var a,o={},_=_createForOfIteratorHelper(r);try{for(_.s();!(a=_.n()).done;){var i=a.value;zf(e,t,i)&&!n[Qf(i)]&&(o[Qf(i)]=new BT([],{}))}}catch(s){_.e(s)}finally{_.f()}return Object.assign(Object.assign({},n),o)}(e,r,n,e.children))),slicedSegments:r}:{segmentGroup:e,slicedSegments:r}}(t,i,l,n),_=o.segmentGroup,s=o.slicedSegments;return 0===s.length&&_.hasChildren()?a.expandChildren(r,n,_).pipe(j((function(e){return new BT(i,e)}))):0===n.length&&0===s.length?Nu(new BT(i,{})):a.expandSegment(r,_,n,s,"primary",!0).pipe(j((function(e){return new BT(i.concat(e.segments),e.children)})))})))}},{key:"getChildConfig",value:function(e,t,r){var n=this;return t.children?Nu(new yT(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Nu(t._loadedConfig):function(e,t,r){var n,a=t.canLoad;return a&&0!==a.length?q(a).pipe(j((function(n){var a,o=e.get(n);if(function(e){return e&&Uf(e.canLoad)}(o))a=o.canLoad(t,r);else{if(!Uf(o))throw new Error("Invalid CanLoad guard");a=o(t,r)}return FT(a)}))).pipe(Nd(),(n=function(e){return!0===e},function(e){return e.lift(new jd(n,void 0,e))})):Nu(!0)}(e.injector,t,r).pipe(W((function(r){return r?n.configLoader.load(e.injector,t).pipe(j((function(e){return t._loadedConfig=e,e}))):function(e){return new b((function(t){return t.error(IT("Cannot load children because the guard of the route \"path: '".concat(e.path,"'\" returned false")))}))}(t)}))):Nu(new yT([],e))}},{key:"lineralizeSegments",value:function(e,t){for(var r=[],n=t.root;;){if(r=r.concat(n.segments),0===n.numberOfChildren)return Nu(r);if(n.numberOfChildren>1||!n.children.primary)return Bf(e.redirectTo);n=n.children.primary}}},{key:"applyRedirectCommands",value:function(e,t,r){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,r)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,r,n){var a=this.createSegmentGroup(e,t.root,r,n);return new KT(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var r={};return DT(e,(function(e,n){if("string"==typeof e&&e.startsWith(":")){var a=e.substring(1);r[n]=t[a]}else r[n]=e})),r}},{key:"createSegmentGroup",value:function(e,t,r,n){var a=this,o=this.createSegments(e,t.segments,r,n),_={};return DT(t.children,(function(t,o){_[o]=a.createSegmentGroup(e,t,r,n)})),new BT(o,_)}},{key:"createSegments",value:function(e,t,r,n){var a=this;return t.map((function(t){return t.path.startsWith(":")?a.findPosParam(e,t,n):a.findOrReturn(t,r)}))}},{key:"findPosParam",value:function(e,t,r){var n=r[t.path.substring(1)];if(!n)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return n}},{key:"findOrReturn",value:function(e,t){var r,n=0,a=_createForOfIteratorHelper(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.path===e.path)return t.splice(n),o;n++}}catch(_){a.e(_)}finally{a.f()}return e}}]),e}();function Hf(e,t,r){if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||r.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};var n=(t.matcher||bT)(r,e,t);return n?{matched:!0,consumedSegments:n.consumed,lastChild:n.consumed.length,positionalParamSegments:n.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function jf(e){if(1===e.numberOfChildren&&e.children.primary){var t=e.children.primary;return new BT(e.segments.concat(t.segments),t.children)}return e}function zf(e,t,r){return(!(e.hasChildren()||t.length>0)||"full"!==r.pathMatch)&&""===r.path&&void 0!==r.redirectTo}function Qf(e){return e.outlet||"primary"}var Vf=function e(t){_classCallCheck(this,e),this.path=t,this.route=this.path[this.path.length-1]},qf=function e(t,r){_classCallCheck(this,e),this.component=t,this.route=r};function Wf(e,t,r){var n=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var r=t.routeConfig;if(r&&r._loadedConfig)return r._loadedConfig}return null}(t);return(n?n.module.injector:r).get(e)}function Jf(e,t,r){var n=uf(e),a=e.value;DT(n,(function(e,n){Jf(e,a.component?t?t.children.getContext(n):null:t,r)})),r.canDeactivateChecks.push(new qf(a.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,a))}var Zf=Symbol("INITIAL_VALUE");function $f(){return Qd((function(e){return(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=null,a=null;return U(t[t.length-1])&&(a=t.pop()),"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&T(t[0])&&(t=t[0]),ee(t,a).lift(new hd(n))}).apply(void 0,_toConsumableArray(e.map((function(e){return e.pipe(Kd(1),function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[t.length-1];return U(n)?(t.pop(),function(e){return Wd(t,e,n)}):function(e){return Wd(t,e)}}(Zf))})))).pipe(Jd((function(e,t){var r=!1;return t.reduce((function(e,n,a){if(e!==Zf)return e;if(n===Zf&&(r=!0),!r){if(!1===n)return n;if(a===t.length-1||kf(n))return n}return e}),e)}),Zf),Iu((function(e){return e!==Zf})),j((function(e){return kf(e)?e:!0===e})),Kd(1))}))}function ep(e,t){return null!==e&&t&&t(new vT(e)),Nu(!0)}function tp(e,t){return null!==e&&t&&t(new AT(e)),Nu(!0)}function rp(e,t,r){var n=t.routeConfig?t.routeConfig.canActivate:null;return n&&0!==n.length?Nu(n.map((function(n){return Od((function(){var a,o=Wf(n,t,r);if(function(e){return e&&Uf(e.canActivate)}(o))a=FT(o.canActivate(t,e));else{if(!Uf(o))throw new Error("Invalid CanActivate guard");a=FT(o(t,e))}return a.pipe(Hd())}))}))).pipe($f()):Nu(!0)}function np(e,t,r){var n=t[t.length-1],a=t.slice(0,t.length-1).reverse().map((function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)})).filter((function(e){return null!==e})).map((function(t){return Od((function(){return Nu(t.guards.map((function(a){var o,_=Wf(a,t.node,r);if(function(e){return e&&Uf(e.canActivateChild)}(_))o=FT(_.canActivateChild(n,e));else{if(!Uf(_))throw new Error("Invalid CanActivateChild guard");o=FT(_(n,e))}return o.pipe(Hd())}))).pipe($f())}))}));return Nu(a).pipe($f())}var ap=function e(){_classCallCheck(this,e)},op=function(){function e(t,r,n,a,o,_){_classCallCheck(this,e),this.rootComponentType=t,this.config=r,this.urlTree=n,this.url=a,this.paramsInheritanceStrategy=o,this.relativeLinkResolution=_}return _createClass(e,[{key:"recognize",value:function(){try{var e=sp(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,"primary"),r=new Pf([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),n=new Ef(r,t),a=new Sf(this.url,n);return this.inheritParamsAndData(a._root),Nu(a)}catch(o){return new b((function(e){return e.error(o)}))}}},{key:"inheritParamsAndData",value:function(e){var t=this,r=e.value,n=pf(r,this.paramsInheritanceStrategy);r.params=Object.freeze(n.params),r.data=Object.freeze(n.data),e.children.forEach((function(e){return t.inheritParamsAndData(e)}))}},{key:"processSegmentGroup",value:function(e,t,r){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,r)}},{key:"processChildren",value:function(e,t){var r,n=this,a=jT(t,(function(t,r){return n.processSegmentGroup(e,t,r)}));return r={},a.forEach((function(e){var t=r[e.value.outlet];if(t){var n=t.url.map((function(e){return e.toString()})).join("/"),a=e.value.url.map((function(e){return e.toString()})).join("/");throw new Error("Two segments cannot have the same outlet name: '".concat(n,"' and '").concat(a,"'."))}r[e.value.outlet]=e.value})),a.sort((function(e,t){return"primary"===e.value.outlet?-1:"primary"===t.value.outlet?1:e.value.outlet.localeCompare(t.value.outlet)})),a}},{key:"processSegment",value:function(e,t,r,n){var a,o=_createForOfIteratorHelper(e);try{for(o.s();!(a=o.n()).done;){var _=a.value;try{return this.processSegmentAgainstRoute(_,t,r,n)}catch(i){if(!(i instanceof ap))throw i}}}catch(s){o.e(s)}finally{o.f()}if(this.noLeftoversInUrl(t,r,n))return[];throw new ap}},{key:"noLeftoversInUrl",value:function(e,t,r){return 0===t.length&&!e.children[r]}},{key:"processSegmentAgainstRoute",value:function(e,t,r,n){if(e.redirectTo)throw new ap;if((e.outlet||"primary")!==n)throw new ap;var a,o=[],_=[];if("**"===e.path){var i=r.length>0?kT(r).parameters:{};a=new Pf(r,i,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Ep(e),n,e.component,e,_p(t),ip(t)+r.length,up(e))}else{var s=function(e,t,r){if(""===t.path){if("full"===t.pathMatch&&(e.hasChildren()||r.length>0))throw new ap;return{consumedSegments:[],lastChild:0,parameters:{}}}var n=(t.matcher||bT)(r,e,t);if(!n)throw new ap;var a={};DT(n.posParams,(function(e,t){a[t]=e.path}));var o=n.consumed.length>0?Object.assign(Object.assign({},a),n.consumed[n.consumed.length-1].parameters):a;return{consumedSegments:n.consumed,lastChild:n.consumed.length,parameters:o}}(t,e,r);o=s.consumedSegments,_=r.slice(s.lastChild),a=new Pf(o,s.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,Ep(e),n,e.component,e,_p(t),ip(t)+o.length,up(e))}var l=function(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(e),c=sp(t,o,_,l,this.relativeLinkResolution),E=c.segmentGroup,u=c.slicedSegments;if(0===u.length&&E.hasChildren()){var d=this.processChildren(l,E);return[new Ef(a,d)]}if(0===l.length&&0===u.length)return[new Ef(a,[])];var T=this.processSegment(l,E,u,"primary");return[new Ef(a,T)]}}]),e}();function _p(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function ip(e){for(var t=e,r=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)r+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return r-1}function sp(e,t,r,n,a){if(r.length>0&&function(e,t,r){return r.some((function(r){return lp(e,t,r)&&"primary"!==cp(r)}))}(e,r,n)){var o=new BT(t,function(e,t,r,n){var a={};a.primary=n,n._sourceSegment=e,n._segmentIndexShift=t.length;var o,_=_createForOfIteratorHelper(r);try{for(_.s();!(o=_.n()).done;){var i=o.value;if(""===i.path&&"primary"!==cp(i)){var s=new BT([],{});s._sourceSegment=e,s._segmentIndexShift=t.length,a[cp(i)]=s}}}catch(l){_.e(l)}finally{_.f()}return a}(e,t,n,new BT(r,e.children)));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:[]}}if(0===r.length&&function(e,t,r){return r.some((function(r){return lp(e,t,r)}))}(e,r,n)){var _=new BT(e.segments,function(e,t,r,n,a,o){var _,i={},s=_createForOfIteratorHelper(n);try{for(s.s();!(_=s.n()).done;){var l=_.value;if(lp(e,r,l)&&!a[cp(l)]){var c=new BT([],{});c._sourceSegment=e,c._segmentIndexShift="legacy"===o?e.segments.length:t.length,i[cp(l)]=c}}}catch(E){s.e(E)}finally{s.f()}return Object.assign(Object.assign({},a),i)}(e,t,r,n,e.children,a));return _._sourceSegment=e,_._segmentIndexShift=t.length,{segmentGroup:_,slicedSegments:r}}var i=new BT(e.segments,e.children);return i._sourceSegment=e,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:r}}function lp(e,t,r){return(!(e.hasChildren()||t.length>0)||"full"!==r.pathMatch)&&""===r.path&&void 0===r.redirectTo}function cp(e){return e.outlet||"primary"}function Ep(e){return e.data||{}}function up(e){return e.resolve||{}}function dp(e,t,r,n){var a=Wf(e,t,n);return FT(a.resolve?a.resolve(t,r):a(t,r))}function Tp(e){return function(t){return t.pipe(Qd((function(t){var r=e(t);return r?q(r).pipe(j((function(){return t}))):q([t])})))}}var fp=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}(),pp=new Qe("ROUTES"),Pp=function(){function e(t,r,n,a){_classCallCheck(this,e),this.loader=t,this.compiler=r,this.onLoadStartListener=n,this.onLoadEndListener=a}return _createClass(e,[{key:"load",value:function(e,t){var r=this;return this.onLoadStartListener&&this.onLoadStartListener(t),this.loadModuleFactory(t.loadChildren).pipe(j((function(n){r.onLoadEndListener&&r.onLoadEndListener(t);var a=n.create(e);return new yT(UT(a.injector.get(pp)).map(xT),a)})))}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?q(this.loader.load(e)):FT(e()).pipe(W((function(e){return e instanceof st?Nu(e):q(t.compiler.compileModuleAsync(e))})))}}]),e}(),Sp=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function Ap(e){throw e}function hp(e,t,r){return t.parse("/")}function vp(e,t){return Nu(null)}var mp,gp,Op=((gp=function(){function e(t,r,n,a,o,_,i,s){var l=this;_classCallCheck(this,e),this.rootComponentType=t,this.urlSerializer=r,this.rootContexts=n,this.location=a,this.config=s,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new C,this.errorHandler=Ap,this.malformedUriErrorHandler=hp,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:vp,afterPreactivation:vp},this.urlHandlingStrategy=new Sp,this.routeReuseStrategy=new fp,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=o.get(it),this.console=o.get(vs);var c=o.get(ws);this.isNgZoneEnabled=c instanceof ws,this.resetConfig(s),this.currentUrlTree=new KT(new BT([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Pp(_,i,(function(e){return l.triggerEvent(new PT(e))}),(function(e){return l.triggerEvent(new ST(e))})),this.routerState=Tf(this.currentUrlTree,this.rootComponentType),this.transitions=new Pd({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return _createClass(e,[{key:"setupNavigations",value:function(e){var t=this,r=this.events;return e.pipe(Iu((function(e){return 0!==e.id})),j((function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})})),Qd((function(e){var n,a,o,_,i=!1,s=!1;return Nu(e).pipe(tT((function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}})),Qd((function(e){var n,a,o,_,i=!t.navigated||e.extractedUrl.toString()!==t.browserUrlTree.toString();if(("reload"===t.onSameUrlNavigation||i)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return Nu(e).pipe(Qd((function(e){var n=t.transitions.getValue();return r.next(new sT(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),n!==t.transitions.getValue()?md:[e]})),Qd((function(e){return Promise.resolve(e)})),(n=t.ngModule.injector,a=t.configLoader,o=t.urlSerializer,_=t.config,function(e){return e.pipe(Qd((function(e){return function(e,t,r,n,a){return new Xf(e,t,r,n,a).apply()}(n,a,o,e.extractedUrl,_).pipe(j((function(t){return Object.assign(Object.assign({},e),{urlAfterRedirects:t})})))})))}),tT((function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})})),function(e,r,n,a,o){return function(n){return n.pipe(W((function(n){return function(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";return new op(e,t,r,n,a,o).recognize()}(e,r,n.urlAfterRedirects,(_=n.urlAfterRedirects,t.serializeUrl(_)),a,o).pipe(j((function(e){return Object.assign(Object.assign({},n),{targetSnapshot:e})})));var _})))}}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),tT((function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,!!e.extras.replaceUrl,e.id,e.extras.state),t.browserUrlTree=e.urlAfterRedirects)})),tT((function(e){var n=new uT(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);r.next(n)})));if(i&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var s=e.id,l=e.extractedUrl,c=e.source,E=e.restoredState,u=e.extras,d=new sT(s,t.serializeUrl(l),c,E);r.next(d);var T=Tf(l,t.rootComponentType).snapshot;return Nu(Object.assign(Object.assign({},e),{targetSnapshot:T,urlAfterRedirects:l,extras:Object.assign(Object.assign({},u),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),md})),Tp((function(e){var r=e.targetSnapshot,n=e.id,a=e.extractedUrl,o=e.rawUrl,_=e.extras,i=_.skipLocationChange,s=_.replaceUrl;return t.hooks.beforePreactivation(r,{navigationId:n,appliedUrlTree:a,rawUrlTree:o,skipLocationChange:!!i,replaceUrl:!!s})})),tT((function(e){var r=new dT(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(r)})),j((function(e){return Object.assign(Object.assign({},e),{guards:(r=e.targetSnapshot,n=e.currentSnapshot,a=t.rootContexts,o=r._root,function e(t,r,n,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},_=uf(r);return t.children.forEach((function(t){!function(t,r,n,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},_=t.value,i=r?r.value:null,s=n?n.getContext(t.value.outlet):null;if(i&&_.routeConfig===i.routeConfig){var l=function(e,t,r){if("function"==typeof r)return r(e,t);switch(r){case"pathParamsChange":return!HT(e.url,t.url);case"pathParamsOrQueryParamsChange":return!HT(e.url,t.url)||!CT(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!mf(e,t)||!CT(e.queryParams,t.queryParams);case"paramsChange":default:return!mf(e,t)}}(i,_,_.routeConfig.runGuardsAndResolvers);l?o.canActivateChecks.push(new Vf(a)):(_.data=i.data,_._resolvedData=i._resolvedData),e(t,r,_.component?s?s.children:null:n,a,o),l&&o.canDeactivateChecks.push(new qf(s&&s.outlet&&s.outlet.component||null,i))}else i&&Jf(r,s,o),o.canActivateChecks.push(new Vf(a)),e(t,null,_.component?s?s.children:null:n,a,o)}(t,_[t.value.outlet],n,a.concat([t.value]),o),delete _[t.value.outlet]})),DT(_,(function(e,t){return Jf(e,n.getContext(t),o)})),o}(o,n?n._root:null,a,[o.value]))});var r,n,a,o})),function(e,t){return function(r){return r.pipe(W((function(r){var n=r.targetSnapshot,a=r.currentSnapshot,o=r.guards,_=o.canActivateChecks,i=o.canDeactivateChecks;return 0===i.length&&0===_.length?Nu(Object.assign(Object.assign({},r),{guardsResult:!0})):function(e,t,r,n){return q(e).pipe(W((function(e){return function(e,t,r,n,a){var o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return o&&0!==o.length?Nu(o.map((function(o){var _,i=Wf(o,t,a);if(function(e){return e&&Uf(e.canDeactivate)}(i))_=FT(i.canDeactivate(e,t,r,n));else{if(!Uf(i))throw new Error("Invalid CanDeactivate guard");_=FT(i(e,t,r,n))}return _.pipe(Hd())}))).pipe($f()):Nu(!0)}(e.component,e.route,r,t,n)})),Hd((function(e){return!0!==e}),!0))}(i,n,a,e).pipe(W((function(r){return r&&"boolean"==typeof r?function(e,t,r,n){return q(t).pipe(Ru((function(t){return q([tp(t.route.parent,n),ep(t.route,n),np(e,t.path,r),rp(e,t.route,r)]).pipe(Nd(),Hd((function(e){return!0!==e}),!0))})),Hd((function(e){return!0!==e}),!0))}(n,_,e,t):Nu(r)})),j((function(e){return Object.assign(Object.assign({},r),{guardsResult:e})})))})))}}(t.ngModule.injector,(function(e){return t.triggerEvent(e)})),tT((function(e){if(kf(e.guardsResult)){var r=IT('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw r.url=e.guardsResult,r}})),tT((function(e){var r=new TT(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(r)})),Iu((function(e){if(!e.guardsResult){t.resetUrlToCurrentUrlTree();var n=new cT(e.id,t.serializeUrl(e.extractedUrl),"");return r.next(n),e.resolve(!1),!1}return!0})),Tp((function(e){if(e.guards.canActivateChecks.length)return Nu(e).pipe(tT((function(e){var r=new fT(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(r)})),(r=t.paramsInheritanceStrategy,n=t.ngModule.injector,function(e){return e.pipe(W((function(e){var t=e.targetSnapshot,a=e.guards.canActivateChecks;return a.length?q(a).pipe(Ru((function(e){return function(e,t,r,n){return function(e,t,r,n){var a=Object.keys(e);if(0===a.length)return Nu({});if(1===a.length){var o=a[0];return dp(e[o],t,r,n).pipe(j((function(e){return _defineProperty({},o,e)})))}var _={};return q(a).pipe(W((function(a){return dp(e[a],t,r,n).pipe(j((function(e){return _[a]=e,e})))}))).pipe(kd(),j((function(){return _})))}(e._resolve,e,t,n).pipe(j((function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),pf(e,r).resolve),null})))}(e.route,t,r,n)})),function(e,t){return arguments.length>=2?function(r){return N(Jd(e,t),Id(1),Cd(t))(r)}:function(t){return N(Jd((function(t,r,n){return e(t,r,n+1)})),Id(1))(t)}}((function(e,t){return e})),j((function(t){return e}))):Nu(e)})))}),tT((function(e){var r=new pT(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(r)})));var r,n})),Tp((function(e){var r=e.targetSnapshot,n=e.id,a=e.extractedUrl,o=e.rawUrl,_=e.extras,i=_.skipLocationChange,s=_.replaceUrl;return t.hooks.afterPreactivation(r,{navigationId:n,appliedUrlTree:a,rawUrlTree:o,skipLocationChange:!!i,replaceUrl:!!s})})),j((function(e){var r=function(e,t,r){var n=function e(t,r,n){if(n&&t.shouldReuseRoute(r.value,n.value.snapshot)){var a=n.value;a._futureSnapshot=r.value;var o=function(t,r,n){return r.children.map((function(r){var a,o=_createForOfIteratorHelper(n.children);try{for(o.s();!(a=o.n()).done;){var _=a.value;if(t.shouldReuseRoute(_.value.snapshot,r.value))return e(t,r,_)}}catch(i){o.e(i)}finally{o.f()}return e(t,r)}))}(t,r,n);return new Ef(a,o)}var _=t.retrieve(r.value);if(_){var i=_.route;return function e(t,r){if(t.value.routeConfig!==r.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==r.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");r.value._futureSnapshot=t.value;for(var n=0;n<t.children.length;++n)e(t.children[n],r.children[n])}(r,i),i}var s,l=new ff(new Pd((s=r.value).url),new Pd(s.params),new Pd(s.queryParams),new Pd(s.fragment),new Pd(s.data),s.outlet,s.component,s),c=r.children.map((function(r){return e(t,r)}));return new Ef(l,c)}(e,t._root,r?r._root:void 0);return new df(n,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:r})})),tT((function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(t.currentUrlTree,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,!!e.extras.replaceUrl,e.id,e.extras.state),t.browserUrlTree=e.urlAfterRedirects)})),(a=t.rootContexts,o=t.routeReuseStrategy,_=function(e){return t.triggerEvent(e)},j((function(e){return new Cf(o,e.targetRouterState,e.currentRouterState,_).activate(a),e}))),tT({next:function(){i=!0},complete:function(){i=!0}}),(n=function(){if(!i&&!s){t.resetUrlToCurrentUrlTree();var n=new cT(e.id,t.serializeUrl(e.extractedUrl),"Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId));r.next(n),e.resolve(!1)}t.currentNavigation=null},function(e){return e.lift(new oT(n))}),Dd((function(n){if(s=!0,(i=n)&&i.ngNavigationCancelingError){var a=kf(n.url);a||(t.navigated=!0,t.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl));var o=new cT(e.id,t.serializeUrl(e.extractedUrl),n.message);r.next(o),a?setTimeout((function(){var r=t.urlHandlingStrategy.merge(n.url,t.rawUrlTree);return t.scheduleNavigation(r,"imperative",null,{skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy},{resolve:e.resolve,reject:e.reject,promise:e.promise})}),0):e.resolve(!1)}else{t.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl);var _=new ET(e.id,t.serializeUrl(e.extractedUrl),n);r.next(_);try{e.resolve(t.errorHandler(n))}catch(l){e.reject(l)}}var i;return md})))})))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe((function(t){var r=e.parseUrl(t.url),n="popstate"===t.type?"popstate":"hashchange",a=t.state&&t.state.navigationId?t.state:null;setTimeout((function(){e.scheduleNavigation(r,n,a,{replaceUrl:!0})}),0)})))}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){LT(e),this.config=e.map(xT),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.relativeTo,n=t.queryParams,a=t.fragment,o=t.preserveQueryParams,_=t.queryParamsHandling,i=t.preserveFragment;gn()&&o&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");var s=r||this.routerState.root,l=i?this.currentUrlTree.fragment:a,c=null;if(_)switch(_){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),n);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=n||null}else c=o?this.currentUrlTree.queryParams:n||null;return null!==c&&(c=this.removeEmptyProps(c)),function(e,t,r,n,a){if(0===r.length)return Of(t.root,t.root,t,n,a);var o=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new Nf(!0,0,e);var t=0,r=!1,n=e.reduce((function(e,n,a){if("object"==typeof n&&null!=n){if(n.outlets){var o={};return DT(n.outlets,(function(e,t){o[t]="string"==typeof e?e.split("/"):e})),[].concat(_toConsumableArray(e),[{outlets:o}])}if(n.segmentPath)return[].concat(_toConsumableArray(e),[n.segmentPath])}return"string"!=typeof n?[].concat(_toConsumableArray(e),[n]):0===a?(n.split("/").forEach((function(n,a){0==a&&"."===n||(0==a&&""===n?r=!0:".."===n?t++:""!=n&&e.push(n))})),e):[].concat(_toConsumableArray(e),[n])}),[]);return new Nf(r,t,n)}(r);if(o.toRoot())return Of(t.root,new BT([],{}),t,n,a);var _=function(e,t,r){if(e.isAbsolute)return new Rf(t.root,!0,0);if(-1===r.snapshot._lastPathIndex)return new Rf(r.snapshot._urlSegment,!0,0);var n=gf(e.commands[0])?0:1;return function(e,t,r){for(var n=e,a=t,o=r;o>a;){if(o-=a,!(n=n.parent))throw new Error("Invalid number of '../'");a=n.segments.length}return new Rf(n,!1,a-o)}(r.snapshot._urlSegment,r.snapshot._lastPathIndex+n,e.numberOfDoubleDots)}(o,t,e),i=_.processChildren?yf(_.segmentGroup,_.index,o.commands):bf(_.segmentGroup,_.index,o.commands);return Of(_.segmentGroup,i,t,n,a)}(s,this.currentUrlTree,e,c,l)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};gn()&&this.isNgZoneEnabled&&!ws.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");var r=kf(e)?e:this.parseUrl(e),n=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(n,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var r=e[t];if(null==r)throw new Error("The requested path contains ".concat(r," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(r){t=this.malformedUriErrorHandler(r,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){if(kf(e))return GT(this.currentUrlTree,e,t);var r=this.parseUrl(e);return GT(this.currentUrlTree,r,t)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce((function(t,r){var n=e[r];return null!=n&&(t[r]=n),t}),{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe((function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.events.next(new lT(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,e.currentNavigation=null,t.resolve(!0)}),(function(t){e.console.warn("Unhandled Navigation Error: ")}))}},{key:"scheduleNavigation",value:function(e,t,r,n,a){var o,_,i,s=this.getTransition();if(s&&"imperative"!==t&&"imperative"===s.source&&s.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(s&&"hashchange"==t&&"popstate"===s.source&&s.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(s&&"popstate"==t&&"hashchange"===s.source&&s.rawUrl.toString()===e.toString())return Promise.resolve(!0);a?(o=a.resolve,_=a.reject,i=a.promise):i=new Promise((function(e,t){o=e,_=t}));var l=++this.navigationId;return this.setTransition({id:l,source:t,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:n,resolve:o,reject:_,promise:i,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),i.catch((function(e){return Promise.reject(e)}))}},{key:"setBrowserUrl",value:function(e,t,r,n){var a=this.urlSerializer.serialize(e);n=n||{},this.location.isCurrentPathEqualTo(a)||t?this.location.replaceState(a,"",Object.assign(Object.assign({},n),{navigationId:r})):this.location.go(a,"",Object.assign(Object.assign({},n),{navigationId:r}))}},{key:"resetStateAndUrl",value:function(e,t,r){this.routerState=e,this.currentUrlTree=t,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r),this.resetUrlToCurrentUrlTree()}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}}]),e}()).\u0275fac=function(e){S_()},gp.\u0275dir=Rt({type:gp}),gp),Np=((mp=function(){function e(t,r,n){var a=this;_classCallCheck(this,e),this.router=t,this.route=r,this.locationStrategy=n,this.commands=[],this.subscription=t.events.subscribe((function(e){e instanceof lT&&a.updateTargetUrlAndHref()}))}return _createClass(e,[{key:"ngOnChanges",value:function(e){this.updateTargetUrlAndHref()}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(e,t,r,n){if(0!==e||t||r||n)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;var a={skipLocationChange:Rp(this.skipLocationChange),replaceUrl:Rp(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,a),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))}},{key:"routerLink",set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]}},{key:"preserveQueryParams",set:function(e){gn()&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead."),this.preserve=e}},{key:"urlTree",get:function(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:Rp(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:Rp(this.preserveFragment)})}}]),e}()).\u0275fac=function(e){return new(e||mp)(P_(Op),P_(ff),P_(Rl))},mp.\u0275dir=Rt({type:mp,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(e,t){1&e&&I_("click",(function(e){return t.onClick(e.button,e.ctrlKey,e.metaKey,e.shiftKey)})),2&e&&(j_("href",t.href,Wn),f_("target",t.target))},inputs:{routerLink:"routerLink",preserveQueryParams:"preserveQueryParams",target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state"},features:[$_]}),mp);function Rp(e){return""===e||!!e}var Ip,bp,yp,Lp=function e(){_classCallCheck(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new Yp,this.attachRef=null},Yp=function(){function e(){_classCallCheck(this,e),this.contexts=new Map}return _createClass(e,[{key:"onChildOutletCreated",value:function(e,t){var r=this.getOrCreateContext(e);r.outlet=t,this.contexts.set(e,r)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new Lp,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),Mp=((Ip=function(){function e(t,r,n,a,o){_classCallCheck(this,e),this.parentContexts=t,this.location=r,this.resolver=n,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new ts,this.deactivateEvents=new ts,this.name=a||"primary",t.onChildOutletCreated(this.name,this)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var r=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),n=this.parentContexts.getOrCreateContext(this.name).children,a=new xp(e,n,this.location.injector);this.activated=this.location.createComponent(r,this.location.length,a),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}}]),e}()).\u0275fac=function(e){return new(e||Ip)(P_(Yp),P_(Di),P_(ui),function(e,t){var r=e.attrs;if(r)for(var n=r.length,a=0;a<n;){var o=r[a];if(Mr(o))break;if(0===o)a+=2;else if("number"==typeof o)for(a++;a<n&&"string"==typeof r[a];)a++;else{if("name"===o)return r[a+1];a+=2}}return null}(nr()),P_(Ko))},Ip.\u0275dir=Rt({type:Ip,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),Ip),xp=function(){function e(t,r,n){_classCallCheck(this,e),this.route=t,this.childContexts=r,this.parent=n}return _createClass(e,[{key:"get",value:function(e,t){return e===ff?this.route:e===Yp?this.childContexts:this.parent.get(e,t)}}]),e}(),Cp=function e(){_classCallCheck(this,e)},wp=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"preload",value:function(e,t){return Nu(null)}}]),e}(),Up=((yp=function(){function e(t,r,n,a,o){_classCallCheck(this,e),this.router=t,this.injector=a,this.preloadingStrategy=o,this.loader=new Pp(r,n,(function(e){return t.triggerEvent(new PT(e))}),(function(e){return t.triggerEvent(new ST(e))}))}return _createClass(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(Iu((function(e){return e instanceof lT})),Ru((function(){return e.preload()}))).subscribe((function(){}))}},{key:"preload",value:function(){var e=this.injector.get(it);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var r,n=[],a=_createForOfIteratorHelper(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(o.loadChildren&&!o.canLoad&&o._loadedConfig){var _=o._loadedConfig;n.push(this.processRoutes(_.module,_.routes))}else o.loadChildren&&!o.canLoad?n.push(this.preloadConfig(e,o)):o.children&&n.push(this.processRoutes(e,o.children))}}catch(i){a.e(i)}finally{a.f()}return q(n).pipe($(),j((function(e){})))}},{key:"preloadConfig",value:function(e,t){var r=this;return this.preloadingStrategy.preload(t,(function(){return r.loader.load(e.injector,t).pipe(W((function(e){return t._loadedConfig=e,r.processRoutes(e.module,e.routes)})))}))}}]),e}()).\u0275fac=function(e){return new(e||yp)(rt(Op),rt(nl),rt(Ys),rt(n_),rt(Cp))},yp.\u0275prov=Pe({token:yp,factory:yp.\u0275fac}),yp),kp=((bp=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,e),this.router=t,this.viewportScroller=r,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}return _createClass(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe((function(t){t instanceof sT?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof lT&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))}))}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe((function(t){t instanceof gT&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))}))}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new gT(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}()).\u0275fac=function(e){S_()},bp.\u0275dir=Rt({type:bp}),bp),Dp=new Qe("ROUTER_CONFIGURATION"),Fp=new Qe("ROUTER_FORROOT_GUARD"),Gp=[Cl,{provide:zT,useClass:QT},{provide:Op,useFactory:function(e,t,r,n,a,o,_){var i=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},s=arguments.length>8?arguments[8]:void 0,l=arguments.length>9?arguments[9]:void 0,c=new Op(null,e,t,r,n,a,o,UT(_));if(s&&(c.urlHandlingStrategy=s),l&&(c.routeReuseStrategy=l),i.errorHandler&&(c.errorHandler=i.errorHandler),i.malformedUriErrorHandler&&(c.malformedUriErrorHandler=i.malformedUriErrorHandler),i.enableTracing){var E=ul();c.events.subscribe((function(e){E.logGroup("Router Event: ".concat(e.constructor.name)),E.log(e.toString()),E.log(e),E.logGroupEnd()}))}return i.onSameUrlNavigation&&(c.onSameUrlNavigation=i.onSameUrlNavigation),i.paramsInheritanceStrategy&&(c.paramsInheritanceStrategy=i.paramsInheritanceStrategy),i.urlUpdateStrategy&&(c.urlUpdateStrategy=i.urlUpdateStrategy),i.relativeLinkResolution&&(c.relativeLinkResolution=i.relativeLinkResolution),c},deps:[zT,Yp,Cl,n_,nl,Ys,pp,Dp,[function(){return function e(){_classCallCheck(this,e)}}(),new Ee],[function(){return function e(){_classCallCheck(this,e)}}(),new Ee]]},Yp,{provide:ff,useFactory:function(e){return e.routerState.root},deps:[Op]},{provide:nl,useClass:_l},Up,wp,function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"preload",value:function(e,t){return t().pipe(Dd((function(){return Nu(null)})))}}]),e}(),{provide:Dp,useValue:{enableTracing:!1}}];function Kp(){return new qs("Router",Op)}var Bp,Xp=((Bp=function(){function e(t,r){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(t,r){return{ngModule:e,providers:[Gp,Qp(t),{provide:Fp,useFactory:zp,deps:[[Op,new Ee,new de]]},{provide:Dp,useValue:r||{}},{provide:Rl,useFactory:jp,deps:[fl,[new ce(Yl),new Ee],Dp]},{provide:kp,useFactory:Hp,deps:[Op,ac,Dp]},{provide:Cp,useExisting:r&&r.preloadingStrategy?r.preloadingStrategy:wp},{provide:qs,multi:!0,useFactory:Kp},[qp,{provide:ds,multi:!0,useFactory:Wp,deps:[qp]},{provide:eP,useFactory:Jp,deps:[qp]},{provide:hs,multi:!0,useExisting:eP}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[Qp(t)]}}}]),e}()).\u0275mod=Ot({type:Bp}),Bp.\u0275inj=Ae({factory:function(e){return new(e||Bp)(rt(Fp,8),rt(Op,8))}}),Bp);function Hp(e,t,r){return r.scrollOffset&&t.setOffset(r.scrollOffset),new kp(e,t,r)}function jp(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.useHash?new xl(e,t):new Ml(e,t)}function zp(e){if(e)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Qp(e){return[{provide:a_,multi:!0,useValue:e},{provide:pp,multi:!0,useValue:e}]}var Vp,qp=((Vp=function(){function e(t){_classCallCheck(this,e),this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new C}return _createClass(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(Sl,Promise.resolve(null)).then((function(){var t=null,r=new Promise((function(e){return t=e})),n=e.injector.get(Op),a=e.injector.get(Dp);if(e.isLegacyDisabled(a)||e.isLegacyEnabled(a))t(!0);else if("disabled"===a.initialNavigation)n.setUpLocationChangeListener(),t(!0);else{if("enabled"!==a.initialNavigation)throw new Error("Invalid initialNavigation options: '".concat(a.initialNavigation,"'"));n.hooks.afterPreactivation=function(){return e.initNavigation?Nu(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},n.initialNavigation()}return r}))}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(Dp),r=this.injector.get(Up),n=this.injector.get(kp),a=this.injector.get(Op),o=this.injector.get(tl);e===o.components[0]&&(this.isLegacyEnabled(t)?a.initialNavigation():this.isLegacyDisabled(t)&&a.setUpLocationChangeListener(),r.setUpPreloading(),n.init(),a.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"isLegacyEnabled",value:function(e){return"legacy_enabled"===e.initialNavigation||!0===e.initialNavigation||void 0===e.initialNavigation}},{key:"isLegacyDisabled",value:function(e){return"legacy_disabled"===e.initialNavigation||!1===e.initialNavigation}}]),e}()).\u0275fac=function(e){return new(e||Vp)(rt(n_))},Vp.\u0275prov=Pe({token:Vp,factory:Vp.\u0275fac}),Vp);function Wp(e){return e.appInitializer.bind(e)}function Jp(e){return e.bootstrapListener.bind(e)}var Zp,$p,eP=new Qe("Router Initializer"),tP=((Zp=function(){function e(t,r){_classCallCheck(this,e),this.router=t,this.http=r,this.userSubject=new Pd(JSON.parse(localStorage.getItem("/users"))),this.user=this.userSubject.asObservable()}return _createClass(e,[{key:"login",value:function(e,t){var r=this;return this.http.post("http://localhost:4001/users/authenticate",{username:e,password:t}).pipe(tT((function(e){return localStorage.setItem("user",JSON.stringify(e)),r.userSubject.next(e),e})))}},{key:"register",value:function(e,t,r,n,a,o,_,i,s,l,c,E,u,d,T,f,p){var P=this;return this.http.post("http://localhost:4001/users/register",{firstName:e,lastName:t,username:r,password:n,email:a,web:o,city:_,country:i,profesion:s,skills:l,stacks:c,birthdate:E,jobseeker:u,eosaccount:d,photo:T,gridCheck1:f,gridCheck2:p}).pipe(tT((function(e){return localStorage.setItem("",JSON.stringify(e)),P.userSubject.next(e),e})))}},{key:"logout",value:function(){localStorage.removeItem("user"),this.userSubject.next(null),this.router.navigate(["/login"])}},{key:"getAll",value:function(){return this.http.get("http://localhost:4001/users")}},{key:"getById",value:function(e){return this.http.get("http://localhost:4001/users/".concat(e))}},{key:"update",value:function(e,t){var r=this;return this.http.put("http://localhost:4001/users/".concat(e),t).pipe(j((function(n){if(e==r.userValue.id){var a=Object.assign(Object.assign({},r.userValue),t);localStorage.setItem("user",JSON.stringify(a)),r.userSubject.next(a)}return n})))}},{key:"delete",value:function(e){var t=this;return this.http.delete("http://localhost:4001/users/".concat(e)).pipe(j((function(r){return e==t.userValue.id&&t.logout(),r})))}},{key:"userValue",get:function(){return this.userSubject.value}}]),e}()).\u0275fac=function(e){return new(e||Zp)(rt(Op),rt(td))},Zp.\u0275prov=Pe({token:Zp,factory:Zp.\u0275fac,providedIn:"root"}),Zp),rP=function e(t){_classCallCheck(this,e),Object.assign(this,t)},nP=function(e){return e[e.Success=0]="Success",e[e.Error=1]="Error",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e}({}),aP=(($p=function(){function e(){_classCallCheck(this,e),this.subject=new C,this.defaultId="default-alert"}return _createClass(e,[{key:"onAlert",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultId;return this.subject.asObservable().pipe(Iu((function(t){return t&&t.id===e})))}},{key:"success",value:function(e,t){this.alert(new rP(Object.assign(Object.assign({},t),{type:nP.Success,message:e})))}},{key:"error",value:function(e,t){this.alert(new rP(Object.assign(Object.assign({},t),{type:nP.Error,message:e})))}},{key:"info",value:function(e,t){this.alert(new rP(Object.assign(Object.assign({},t),{type:nP.Info,message:e})))}},{key:"warn",value:function(e,t){this.alert(new rP(Object.assign(Object.assign({},t),{type:nP.Warning,message:e})))}},{key:"alert",value:function(e){e.id=e.id||this.defaultId,this.subject.next(e)}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.defaultId;this.subject.next(new rP({id:e}))}}]),e}()).\u0275fac=function(e){return new(e||$p)},$p.\u0275prov=Pe({token:$p,factory:$p.\u0275fac,providedIn:"root"}),$p),oP=function e(){_classCallCheck(this,e)};function _P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:4,styles:t,timings:e}}function iP(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function sP(e){return{type:6,styles:e,offset:null}}function lP(e,t,r){return{type:0,name:e,styles:t,options:r}}function cP(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:1,expr:e,animation:t,options:r}}function EP(e){Promise.resolve(null).then(e)}var uP=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;_classCallCheck(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this.parentPlayer=null,this.totalTime=t+r}return _createClass(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach((function(e){return e()})),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;EP((function(){return e._onFinish()}))}},{key:"_onStart",value:function(){this._onStartFns.forEach((function(e){return e()})),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach((function(e){return e()})),this._onDestroyFns=[])}},{key:"reset",value:function(){}},{key:"setPosition",value:function(e){}},{key:"getPosition",value:function(){return 0}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach((function(e){return e()})),t.length=0}}]),e}(),dP=function(){function e(t){var r=this;_classCallCheck(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var n=0,a=0,o=0,_=this.players.length;0==_?EP((function(){return r._onFinish()})):this.players.forEach((function(e){e.onDone((function(){++n==_&&r._onFinish()})),e.onDestroy((function(){++a==_&&r._onDestroy()})),e.onStart((function(){++o==_&&r._onStart()}))})),this.totalTime=this.players.reduce((function(e,t){return Math.max(e,t.totalTime)}),0)}return _createClass(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach((function(e){return e()})),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach((function(e){return e.init()}))}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach((function(e){return e()})),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach((function(e){return e.play()}))}},{key:"pause",value:function(){this.players.forEach((function(e){return e.pause()}))}},{key:"restart",value:function(){this.players.forEach((function(e){return e.restart()}))}},{key:"finish",value:function(){this._onFinish(),this.players.forEach((function(e){return e.finish()}))}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach((function(e){return e.destroy()})),this._onDestroyFns.forEach((function(e){return e()})),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach((function(e){return e.reset()})),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach((function(e){var r=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(r)}))}},{key:"getPosition",value:function(){var e=0;return this.players.forEach((function(t){var r=t.getPosition();e=Math.min(r,e)})),e}},{key:"beforeDestroy",value:function(){this.players.forEach((function(e){e.beforeDestroy&&e.beforeDestroy()}))}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach((function(e){return e()})),t.length=0}}]),e}();function TP(e,t){if(1&e&&(v_(0,"span"),B_(1," Learn more in our "),v_(2,"a",5),B_(3,"privacy policy"),m_(),B_(4,". "),m_()),2&e){var r=L_(2);Ta(2),A_("href",r.learnMore,Wn)("target",r.target)("rel",r.noopener?"noopener noreferrer":null)}}function fP(e,t){if(1&e&&(v_(0,"span"),B_(1," By continuing to browse the site, you're agreeing to our use of cookies. "),p_(2,TP,5,3,"span",3),m_()),2&e){var r=L_();Ta(2),A_("ngIf",r.learnMore)}}var pP=["*"];function PP(e,t){if(1&e){var r=O_();v_(0,"cookie-law-component",1),I_("isSeen",(function(){return rr(r),L_().hasBeenDismissed()})),x_(1),m_()}if(2&e){var n=L_();A_("awsomeCloseIcon",n.awsomeCloseIcon)("learnMore",n.learnMore)("target",n.target)("position",n.position)}}var SP,AP,hP,vP,mP,gP,OP,NP,RP,IP,bP,yP,LP,YP,MP,xP=((SP=function(){function e(t,r){_classCallCheck(this,e),this.doc=t,this.platform=r}return _createClass(e,[{key:"seen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cookieLawSeen",t=[];return Zl(this.platform)&&(t=this.doc.cookie.split(";")),this.cookieExisits(e,t)}},{key:"storeCookie",value:function(e,t){return this.setCookie(e,t)}},{key:"cookieExisits",value:function(e,t){var r="".concat(e,"=");return t.reduce((function(e,t){return e||t.trim().search(r)>-1}),!1)}},{key:"setCookie",value:function(e,t){var r=new Date,n=new Date(r.getTime()+864e5*t),a=encodeURIComponent(e)+"=true;path=/;expires=".concat(n.toUTCString(),";");Zl(this.platform)&&(this.doc.cookie=a)}}]),e}()).\u0275fac=function(e){return new(e||SP)(rt(Tl),rt(As))},SP.\u0275prov=Pe({token:SP,factory:SP.\u0275fac,providedIn:"root"}),SP.ngInjectableDef=Se({factory:function(){return new SP(nt(Tl),nt(As))},token:SP,providedIn:"root"}),SP),CP=(AP="transition",hP=[lP("*",sP({transform:"translateY(0)"})),lP("void",sP({transform:"translateY(0)"})),lP("bottomOut",sP({transform:"translateY(100%)"})),lP("topOut",sP({transform:"translateY(-100%)"})),cP("void => topIn",[sP({transform:"translateY(-100%)"}),_P("1000ms ease-in-out")]),cP("void => bottomIn",[sP({transform:"translateY(100%)"}),_P("1000ms ease-in-out")]),cP("* => *",_P("1000ms ease-out"))],{type:7,name:AP,definitions:hP,options:{}}),wP=((MP=function(){function e(t){_classCallCheck(this,e),this.domSanitizer=t,this.isSeen=new ts,this.transition="bottomIn",this._position="bottom",this.cookieLawClass=!0}return _createClass(e,[{key:"ngOnInit",value:function(){this.noopener="_blank"===this._target,this.transition="bottom"===this.position?"bottomIn":"topIn",this.closeSvg=this.domSanitizer.bypassSecurityTrustHtml(this._awsomeCloseIcon?'<i class="fab '.concat(this._awsomeCloseIcon,'"></i>'):'\n  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">\n    <path d="M377.047 184.198q0 8.26-6.037 14.297L313.505 256l57.505 57.505q6.037 6.037 6.037 14.297 0 8.578-6.037\n      14.615l-28.593 28.593q-6.037 6.037-14.615 6.037-8.26 0-14.297-6.037L256 313.505l-57.505 57.505q-6.037\n      6.037-14.297 6.037-8.578 0-14.615-6.037l-28.593-28.593q-6.037-6.037-6.037-14.615 0-8.26 6.037-14.297L198.495\n      256l-57.505-57.505q-6.037-6.037-6.037-14.297 0-8.578 6.037-14.615l28.593-28.593q6.037-6.037 14.615-6.037 8.26 0\n      14.297 6.037L256 198.495l57.505-57.505q6.037-6.037 14.297-6.037 8.578 0 14.615 6.037l28.593 28.593q6.037 6.037\n      6.037 14.615zM500 256q0-66.401-32.724-122.477-32.724-56.075-88.799-88.799Q322.401 12 256 12q-66.401 0-122.477\n      32.724-56.075 32.724-88.799 88.799Q12 189.599 12 256q0 66.401 32.724 122.477 32.724 56.075 88.799 88.799Q189.599\n      500 256 500q66.401 0 122.477-32.724 56.075-32.724 88.799-88.799Q500 322.401 500 256z"></path>\n  </svg>'),this.currentStyles={top:"top"===this.position?"0":null,bottom:"top"===this.position?"initial":null}}},{key:"afterDismissAnimation",value:function(e){"topOut"!==e.toState&&"bottomOut"!==e.toState||this.isSeen.emit(!0)}},{key:"dismiss",value:function(e){e&&e.preventDefault(),this.transition="top"===this.position?"topOut":"bottomOut"}},{key:"learnMore",get:function(){return this._learnMore},set:function(e){this._learnMore=null!==e&&"false"!=="".concat(e)?e:null}},{key:"awsomeCloseIcon",get:function(){return this._awsomeCloseIcon},set:function(e){this._awsomeCloseIcon=null!==e&&"false"!=="".concat(e)?e:null}},{key:"target",get:function(){return this._target},set:function(e){this._target=null===e||"false"==="".concat(e)||"_blank"!=="".concat(e)&&"_self"!=="".concat(e)?"_blank":e}},{key:"position",get:function(){return this._position},set:function(e){this._position=null===e||"false"==="".concat(e)||"top"!=="".concat(e)&&"bottom"!=="".concat(e)?"bottom":e}}]),e}()).\u0275fac=function(e){return new(e||MP)(P_(Uc))},MP.\u0275cmp=ht({type:MP,selectors:[["cookie-law-component"]],hostVars:2,hostBindings:function(e,t){2&e&&k_("cookie-law",t.cookieLawClass)},inputs:{learnMore:"learnMore",awsomeCloseIcon:"awsomeCloseIcon",target:"target",position:"position"},outputs:{isSeen:"isSeen"},ngContentSelectors:pP,decls:7,vars:5,consts:[[1,"cookie-law-wrapper",3,"ngStyle"],[1,"copy"],["ref",""],[4,"ngIf"],["href","#","role","button",1,"dismiss",3,"innerHTML","click"],[3,"href","target","rel"]],template:function(e,t){if(1&e&&(M_(),v_(0,"div",0),I_("@transition.done",(function(e){return t.afterDismissAnimation(e)})),v_(1,"div",1),v_(2,"span",null,2),x_(4),m_(),p_(5,fP,3,1,"span",3),v_(6,"a",4),I_("click",(function(e){return t.dismiss(e)})),m_(),m_(),m_()),2&e){var r=Zt.lFrame.contextLView[23];A_("ngStyle",t.currentStyles)("@transition",t.transition),Ta(5),A_("ngIf",0==r.childNodes.length),Ta(1),A_("innerHTML",t.closeSvg,qn),f_("aria-label",t.closeSvg)}},directives:[Wl,jl],styles:[".cookie-law-wrapper{background:#333;color:#bbb;display:block;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:15px;font-weight:200;line-height:20px;position:fixed;bottom:0;left:0;width:100%;z-index:999999999;font-smooth:always;-webkit-font-smoothing:antialiased}.cookie-law-wrapper a{color:#bbb;transition:color .2s}.cookie-law-wrapper a:hover{color:#fff}.cookie-law-wrapper a:hover svg{fill:#fff}.cookie-law-wrapper .dismiss{display:block;box-sizing:border-box;padding:10px;position:absolute;top:0;right:10px;text-decoration:none;line-height:20px}.cookie-law-wrapper .dismiss svg{display:block;fill:#bbb;width:20px;height:20px;transition:fill .2s}.cookie-law-wrapper .copy{box-sizing:border-box;padding:10px 60px 10px 10px}.cookie-law-wrapper .copy span{color:#fff;font-weight:400}.cookie-law-wrapper .copy a{text-decoration:underline}.cookie-law-wrapper .copy a:active,.copy a:hover{outline:0}@media (min-width:600px){.cookie-law-wrapper .copy{padding:20px 60px 20px 20px;font-size:18px;line-height:24px}.cookie-law-wrapper .dismiss{top:10px;right:15px}.cookie-law-wrapper .dismiss svg{width:24px;height:24px}}"],encapsulation:2,data:{animation:[CP]}}),MP),UP=((YP=function(){function e(t){_classCallCheck(this,e),this.cookieLawService=t,this.isSeen=new ts,this.name="cookieLawSeen",this.seen=!0}return _createClass(e,[{key:"ngOnInit",value:function(){this.seen=this.cookieLawService.seen(this.name)}},{key:"hasBeenDismissed",value:function(){this.cookieLawService.storeCookie(this.name,this.expiration),this.seen=!0,this.isSeen.emit(!0)}},{key:"dismiss",value:function(){this.cookieLawComponent.dismiss()}},{key:"cookieLawSeen",get:function(){return this.cookieLawService.seen(this.name)}}]),e}()).\u0275fac=function(e){return new(e||YP)(P_(xP))},YP.\u0275cmp=ht({type:YP,selectors:[["cookie-law"]],viewQuery:function(e,t){var r,n,a,o;1&e&&(o=wP,function(e,t,r,n,a,o){e.firstCreatePass&&function(e,t,r){null===e.queries&&(e.queries=new is),e.queries.track(new ss(t,-1))}(e,new _s(r,!0,!1,void 0)),function(e,t){var r=new ns;!function(e,t,r,n){var a=_o(t);a.push(r),e.firstCreatePass&&io(e).push(n,a.length-1)}(e,t,r,r.destroy),null===t[19]&&(t[19]=new os),t[19].queries.push(new as(r))}(e,t)}(tr(),er(),o)),2&e&&function(e){var t=er(),r=tr(),n=ur();dr(n+1);var a=us(r,n);if(e.dirty&&Qt(t)===a.metadata.isStatic){if(null===a.matches)e.reset([]);else{var o=a.crossesNgTemplate?function e(t,r,n,a){var o=t.queries.getByIndex(n),_=o.matches;if(null!==_)for(var i=Es(t,r,o,n),s=0;s<_.length;s+=2){var l=_[s];if(l>0)a.push(i[s/2]);else{for(var c=_[s+1],E=r[-l],u=10;u<E.length;u++){var d=E[u];d[17]===d[3]&&e(d[1],d,c,a)}if(null!==E[9])for(var T=E[9],f=0;f<T.length;f++){var p=T[f];e(p[1],p,c,a)}}}return a}(r,t,n,[]):Es(r,t,a,n);e.reset(o),e.notifyOnChanges()}return!0}return!1}((n=er(),a=ur(),r=n[19].queries[a].queryList))&&(t.cookieLawComponent=r.first)},hostVars:1,hostBindings:function(e,t){2&e&&f_("seen",t.seen)},inputs:{name:"name",learnMore:"learnMore",target:"target",position:"position",expiration:"expiration",awsomeCloseIcon:"awsomeCloseIcon"},outputs:{isSeen:"isSeen"},ngContentSelectors:pP,decls:1,vars:1,consts:[[3,"awsomeCloseIcon","learnMore","target","position","isSeen",4,"ngIf"],[3,"awsomeCloseIcon","learnMore","target","position","isSeen"]],template:function(e,t){1&e&&(M_(),p_(0,PP,2,4,"cookie-law-component",0)),2&e&&A_("ngIf",!t.seen)},directives:[jl,wP],encapsulation:2}),YP),kP=((LP=function e(t){if(_classCallCheck(this,e),t)throw new Error("CookieLawModule is already loaded. Import it in the AppModule only")}).\u0275mod=Ot({type:LP}),LP.\u0275inj=Ae({factory:function(e){return new(e||LP)(rt(LP,12))},imports:[[Jl]]}),LP),DP=((yP=function(){function e(t){_classCallCheck(this,e),this.accountService=t,this.user=this.accountService.userValue}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||yP)(P_(tP))},yP.\u0275cmp=ht({type:yP,selectors:[["app-home"]],decls:333,vars:0,consts:[[1,"home"],[1,"layout"],[1,"backstretch","animated"],[1,"row","iconbar"],[1,"homeicons"],["href","https://bitsonic.co.kr/front/en/exchange/ade-eos","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/bitsonic.png",1,"homeicons"],["href","https://findex.pro/trade/cadeositoken_ADE-eosio.token_EOS","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/findex.jpeg",1,"homeicons"],["href","https://token.store/","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/TokenStore.jpeg",1,"homeicons"],["href","https://mydex.win/","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/Mydex.jpeg",1,"homeicons"],["href","https://akdex.io/trade/ADE_EOS","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/Akkadex.jpeg",1,"homeicons"],["href","https://lynxwallet.io/","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/Lynx.jpeg",1,"homeicons"],["href","https://meet.one/","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/meet.one.jpg",1,"homeicons"],["href","https://tokenbank.co.kr/","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/tokenbank.jpeg",1,"homeicons"],["href","http://more.one/","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/moreone.jpeg",1,"homeicons"],["href","https://www.tokenpocket.pro/","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/tokenpoket.jpeg",1,"homeicons"],["href","https://www.eoswriter.io/","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/eoswrite.PNG",1,"homeicons"],["href","https://tokenrocket.kr/","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/tokenrocket.PNG",1,"homeicons"],[1,"row-full"],["id","slider","data-ride","carousel","data-interval","3000","data-wrap","true",1,"carousel","slide","infinite",2,"padding-top","1%"],[1,"carousel-indicators","align-items-center","justify-content-center"],["data-target","#slider","data-slide-to","0",1,"active"],["data-target","#slider","data-slide-to","1"],["data-target","#slider","data-slide-to","2"],["data-target","#slider","data-slide-to","3"],["data-target","#slider","data-slide-to","4"],["data-target","#slider","data-slide-to","5"],["data-target","#slider","data-slide-to","6"],["data-target","#slider","data-slide-to","7"],["data-target","#slider","data-slide-to","8"],["data-target","#slider","data-slide-to","9"],["data-target","#slider","data-slide-to","10"],["data-target","#slider","data-slide-to","11"],["data-target","#slider","data-slide-to","12"],["data-target","#slider","data-slide-to","13"],["data-target","#slider","data-slide-to","14"],["data-target","#slider","data-slide-to","15"],["data-target","#slider","data-slide-to","16"],["data-target","#slider","data-slide-to","17"],["data-target","#slider","data-slide-to","18"],["data-target","#slider","data-slide-to","19"],["data-target","#slider","data-slide-to","20"],["data-target","#slider","data-slide-to","21"],["data-target","#slider","data-slide-to","22"],["data-target","#slider","data-slide-to","23"],["data-target","#slider","data-slide-to","24"],["data-target","#slider","data-slide-to","25"],["data-target","#slider","data-slide-to","26"],["data-target","#slider","data-slide-to","27"],["data-target","#slider","data-slide-to","28"],["data-ride","carousel","data-interval","50000","data-pause","hover","data-wrap","false",1,"carousel-inner"],[1,"carousel-item"],["src","./assets/CADEOS - Whitepaper1.jpeg","title","1","alt","1","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS - Whitepaper2.jpeg","title","2","alt","2","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS - Whitepaper3.jpeg","title","3","alt","3","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS - Whitepaper4.jpeg","title","4","alt","4","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS - Whitepaper5.jpeg","title","5","alt","5","href","#carousel",1,"d-block","w-100"],["src","./assets/ADE EXCHANGES ANNOUNCE.jpeg","title","6","alt","6","href","#carousel",1,"d-block","w-100"],["src","./assets/ADE Token Store.jpeg","title","6","alt","6","href","#carousel",1,"d-block","w-100"],[1,"carousel-item","active"],["src","./assets/CADEOS3.jpeg","title","7","alt","7","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS3 - Dexeos.jpeg","title","8","alt","8","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS3 - FINDEX.jpeg","title","9","alt","9","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS3 - Mydex 3.jpeg","title","10","alt","10","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS3-newdex2.jpeg","title","11","alt","11","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS - EOSdaq.jpeg","title","12","alt","12","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS - Whitepaper1.jpeg","title","13","alt","13","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS - Whitepaper2.jpeg","title","14","alt","14","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS - Whitepaper3.jpeg","title","15","alt","15","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS - Whitepaper4.jpeg","title","16","alt","16","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS - Whitepaper5.jpeg","title","17","alt","17","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS - Whitepaper6.jpeg","title","18","alt","18","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS.jpeg","title","19","alt","19","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS2.jpeg","title","20","alt","20","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS3.jpeg","title","21","alt","21","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS4.jpeg","title","22","alt","22","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS5.jpeg","title","23","alt","23","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS6.jpeg","title","24","alt","24","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS7.jpeg","title","25","alt","25","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS8.jpeg","title","26","alt","26","href","#carousel",1,"d-block","w-100"],["src","./assets/CADEOS9.jpeg","title","27","alt","27","href","#carousel",1,"d-block","w-100"],["src","./assets/tokendistribution.jpeg","title","28","alt","28","href","#carousel",1,"d-block","w-100"],["role","button","data-slide","prev",1,"left","carousel-control"],["aria-hidden","true",1,"glyphicon","glyphicon-chevron-left"],[1,"sr-only"],["role","button","data-slide","next",1,"right","carousel-control"],["aria-hidden","true",1,"glyphicon","glyphicon-chevron-right"],[1,"row","iconbar",2,"padding-top","1%"],["href","https://github.com/CADEOS","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/GitHub.png",1,"homeicons"],["href","https://web.facebook.com/cadeos.io","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/facebook.png",1,"homeicons"],["href","https://twitter.com/cadeosi","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/Twitter.png",1,"homeicons"],["href","https://t.me/cadeos","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/telegram.png",1,"homeicons"],["href","https://medium.com/cadeos-io","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/medium.png",1,"homeicons"],["href","","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/blockchain.png",1,"homeicons"],[1,"container"],[1,"d-flex","justify-content-center","h-100"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"teamicons"],["href","https://www.linkedin.com/in/guillermo-galindo-saeta-749a2557/","target","_blank",1,"padding-top-subtitle"],["src","/assets/guille.jpeg",1,"teamicons"],["href","https://www.linkedin.com/in/h%C3%A9ctor-garz%C3%B3n-6914ba69/","target","_blank",1,"padding-top-subtitle"],["src","/assets/hector.jpeg",1,"teamicons"],["href","https://www.linkedin.com/in/javier-saeta-hidalgo/","target","_blank",1,"padding-top-subtitle"],["src","/assets/javi.jpeg",1,"teamicons"],["href","https://www.linkedin.com/in/dgalindosaeta/","target","_blank",1,"padding-top-subtitle"],["src","/assets/diego.jpeg",1,"teamicons"],["href","https://www.linkedin.com/in/jes%C3%BAs-moya-galindo-bb24861a/","target","_blank",1,"padding-top-subtitle"],["src","/assets/jesus.jpeg",1,"teamicons"],["href","https://www.linkedin.com/in/antonio-galindo/","target","_blank",1,"padding-top-subtitle"],["src","/assets/antonio.jpeg",1,"teamicons"],[1,"padding-top-subtitle"],["src","/assets/eosnewyork.jpeg",1,"homeicons"],["src","/assets/scatter.png",1,"homeicons"],["src","/assets/bigone.png",1,"homeicons"],["src","/assets/nebula.jpeg",1,"homeicons"],["src","/assets/blocks.png",1,"homeicons"],["src","/assets/eosstudio.png",1,"homeicons"],["src","/assets/greymass.jpeg",1,"homeicons"],["src","/assets/eosphere.jpeg",1,"homeicons"],["src","/assets/tokenrocket.jpeg",1,"homeicons"],["src","/assets/eosindex.jpeg",1,"homeicons"],["src","/assets/meet.one.jpg",1,"homeicons"],["src","/assets/moreone.jpeg",1,"homeicons"],["learnMore","/assets/CADEOS.io Privacy Policy.pdf","target","_self"]],template:function(e,t){1&e&&(v_(0,"html"),v_(1,"body"),v_(2,"div",0),v_(3,"div",1),v_(4,"div",2),v_(5,"div",3),v_(6,"div",4),v_(7,"a",5),g_(8,"img",6),m_(),v_(9,"h3"),B_(10,"Bitsonic"),m_(),m_(),v_(11,"div",4),v_(12,"a",7),g_(13,"img",8),m_(),v_(14,"h3"),B_(15,"Findex"),m_(),m_(),v_(16,"div",4),v_(17,"a",9),g_(18,"img",10),m_(),v_(19,"h3"),B_(20,"TokenStore"),m_(),m_(),v_(21,"div",4),v_(22,"a",11),g_(23,"img",12),m_(),v_(24,"h3"),B_(25,"Mydex"),m_(),m_(),v_(26,"div",4),v_(27,"a",13),g_(28,"img",14),m_(),v_(29,"h3"),B_(30,"Akdex"),m_(),m_(),v_(31,"div",4),v_(32,"a",15),g_(33,"img",16),m_(),v_(34,"h3"),B_(35,"Lynx"),m_(),m_(),v_(36,"div",4),v_(37,"a",17),g_(38,"img",18),m_(),v_(39,"h3"),B_(40,"MEET.one"),m_(),m_(),v_(41,"div",4),v_(42,"a",19),g_(43,"img",20),m_(),v_(44,"h3"),B_(45,"TokenBank"),m_(),m_(),v_(46,"div",4),v_(47,"a",21),g_(48,"img",22),m_(),v_(49,"h3"),B_(50,"MoreOne"),m_(),m_(),v_(51,"div",4),v_(52,"a",23),g_(53,"img",24),m_(),v_(54,"h3"),B_(55,"TokenPoket"),m_(),m_(),v_(56,"div",4),v_(57,"a",25),g_(58,"img",26),m_(),v_(59,"h3"),B_(60,"EOSWriter"),m_(),m_(),v_(61,"div",4),v_(62,"a",27),g_(63,"img",28),m_(),v_(64,"h3"),B_(65,"TokenRocket"),m_(),m_(),m_(),v_(66,"div",29),v_(67,"div",30),v_(68,"ol",31),g_(69,"li",32),g_(70,"li",33),g_(71,"li",34),g_(72,"li",35),g_(73,"li",36),g_(74,"li",37),g_(75,"li",38),g_(76,"li",39),g_(77,"li",40),g_(78,"li",41),g_(79,"li",42),g_(80,"li",43),g_(81,"li",44),g_(82,"li",45),g_(83,"li",46),g_(84,"li",47),g_(85,"li",48),g_(86,"li",49),g_(87,"li",50),g_(88,"li",51),g_(89,"li",52),g_(90,"li",53),g_(91,"li",54),g_(92,"li",55),g_(93,"li",56),g_(94,"li",57),g_(95,"li",58),g_(96,"li",59),g_(97,"li",60),m_(),v_(98,"div",61),v_(99,"div",62),g_(100,"img",63),m_(),v_(101,"div",62),g_(102,"img",64),m_(),v_(103,"div",62),g_(104,"img",65),m_(),v_(105,"div",62),g_(106,"img",66),m_(),v_(107,"div",62),g_(108,"img",67),m_(),v_(109,"div",62),g_(110,"img",68),m_(),v_(111,"div",62),g_(112,"img",69),m_(),v_(113,"div",70),g_(114,"img",71),m_(),v_(115,"div",62),g_(116,"img",72),m_(),v_(117,"div",62),g_(118,"img",73),m_(),v_(119,"div",62),g_(120,"img",74),m_(),v_(121,"div",62),g_(122,"img",75),m_(),v_(123,"div",62),g_(124,"img",76),m_(),v_(125,"div",62),g_(126,"img",77),m_(),v_(127,"div",62),g_(128,"img",78),m_(),v_(129,"div",62),g_(130,"img",79),m_(),v_(131,"div",62),g_(132,"img",80),m_(),v_(133,"div",62),g_(134,"img",81),m_(),v_(135,"div",62),g_(136,"img",82),m_(),v_(137,"div",62),g_(138,"img",83),m_(),v_(139,"div",62),g_(140,"img",84),m_(),v_(141,"div",62),g_(142,"img",85),m_(),v_(143,"div",62),g_(144,"img",86),m_(),v_(145,"div",62),g_(146,"img",87),m_(),v_(147,"div",62),g_(148,"img",88),m_(),B_(149,"e "),v_(150,"div",62),g_(151,"img",89),m_(),v_(152,"div",62),g_(153,"img",90),m_(),v_(154,"div",62),g_(155,"img",91),m_(),v_(156,"div",62),g_(157,"img",92),m_(),v_(158,"a",93),g_(159,"span",94),v_(160,"span",95),B_(161,"Previous"),m_(),m_(),v_(162,"a",96),g_(163,"span",97),v_(164,"span",95),B_(165,"Next"),m_(),m_(),m_(),m_(),m_(),v_(166,"div",98),v_(167,"div",4),v_(168,"a",99),g_(169,"img",100),m_(),v_(170,"h3"),B_(171,"Github"),m_(),m_(),v_(172,"div",4),v_(173,"a",101),g_(174,"img",102),m_(),v_(175,"h3"),B_(176,"Facebook"),m_(),m_(),v_(177,"div",4),v_(178,"a",103),g_(179,"img",104),m_(),v_(180,"h3"),B_(181,"Twitter"),m_(),m_(),v_(182,"div",4),v_(183,"a",105),g_(184,"img",106),m_(),v_(185,"h3"),B_(186,"Telegram"),m_(),m_(),v_(187,"div",4),v_(188,"a",107),g_(189,"img",108),m_(),v_(190,"h3"),B_(191,"Medium"),m_(),m_(),v_(192,"div",4),v_(193,"a",109),g_(194,"img",110),m_(),v_(195,"h3"),B_(196,"Exchanges"),m_(),m_(),m_(),v_(197,"div",111),v_(198,"div",112),v_(199,"div",113),v_(200,"div",114),v_(201,"h1"),B_(202,"ELIMINATING OBSTACLES FOR CREATORS"),m_(),m_(),v_(203,"div",115),v_(204,"h2"),B_(205,"Today one of the biggest consttrains for entrepreneurs and creators are the expensive software licenses and, with CADEOS, we want to facilitate this process to everyone by getting rid of the problem with our decentralised software. We will make the creation process and product launch affordable and very easy within an intuitive and user friendly environment. By tokenising all kind of projects our users can see their ideas and effort successfully implemented. Our platform would will bring an opportunity to those brilliant minds that are stopped by the market barriers. From the first sketch to the manufacture process, the users can monitor the state of your design in our Product Lifecycle Manager (PLM) platform. Factories, suppliers and all the 3rd parties interested will be able to review your Request for Quotation (RfQ) in our platform and send the manufacture price for each component. With CADEOS you can design any mechanical and electronic component with our decentralised CAD software and promote it in our Community, under the watchful eye of thousands of investors looking for the best idea. CADEOS platform will host a large gallery of components from thousands of different brands and will be responsible of providing the most extensive resources as possible for an easy product composition. By creating your portfolio of suppliers you will have the best advice and direct communication with the best professionals in any industry around the world. Each area will have their own communication channels and chatrooms. With every creation within your dynamic user profile, you will add value to all your products, 3D models, 3D printer parts, electronic schemes, etc... favouring the bids and sales which will be a success in CADEOS Platform. Your work will never be lost or forgotten and will be revaluated from time to time with our token ADE."),m_(),m_(),m_(),m_(),m_(),v_(206,"h1"),B_(207,"OUR TEAM"),m_(),v_(208,"div",98),v_(209,"div",116),v_(210,"a",117),g_(211,"img",118),m_(),v_(212,"h2"),B_(213,"Guillermo Galindo"),m_(),v_(214,"h3"),B_(215,"Full Stack Developer"),m_(),m_(),v_(216,"div",116),v_(217,"a",119),g_(218,"img",120),m_(),v_(219,"h2"),B_(220,"Hector Garzon"),m_(),v_(221,"h3"),B_(222,"Mobile-App Developer"),m_(),m_(),v_(223,"div",116),v_(224,"a",121),g_(225,"img",122),m_(),v_(226,"h2"),B_(227,"Javier Saeta"),m_(),v_(228,"h3"),B_(229,"Junior Developer"),m_(),m_(),v_(230,"div",116),v_(231,"a",123),g_(232,"img",124),m_(),v_(233,"h2"),B_(234,"Diego Galindo"),m_(),v_(235,"h3"),B_(236,"Chief Programmer"),m_(),m_(),v_(237,"div",116),v_(238,"a",125),g_(239,"img",126),m_(),v_(240,"h2"),B_(241,"Jesus Moya"),m_(),v_(242,"h3"),B_(243,"PLM Expert"),m_(),m_(),v_(244,"div",116),v_(245,"a",127),g_(246,"img",128),m_(),v_(247,"h2"),B_(248,"Antonio Galindo"),m_(),v_(249,"h3"),B_(250,"Business Expert"),m_(),m_(),m_(),v_(251,"div",111),v_(252,"div",112),v_(253,"div",113),v_(254,"div",114),v_(255,"h1"),B_(256,"TOKENIZING THE WORK"),m_(),m_(),v_(257,"div",115),v_(258,"h2"),B_(259,"CADEOS.io developing a real time processing Computer Aided Design (CAD) and a Product Lifecycle Management (PLM) platform based on EOS blockchain architecture. It provides the best real time design tools to the community, including data sharing, video calls, instant messenger and screen sharing for the best collaborative experience, showing progress of the project management work and helping to grow your network. All this within an intuitive, user friendly and fast environment where the user can feel that they are part of the Cadeos Community, with interactive galleries and video tutorials that will help you to improve your technical knowledge as you move on in the process. With this great software and product design experience CADEOS platform will be a revolution on how the companies spend their capital, saving time and resources, unifying every daily task in this unique and secure platform. Our roadmap will start with the launch of CADEOS.io platform; then we will build a CAD. file sharing platform for each industrial sector. The Community will be able to upload their models in their own galleries, and the users will be able to download them to be used in their own designs accordingly to their needs. CADEOS.io will support the following extensions in the first release: .stp, .igs, stl. The next releases in our roadmap will be mainly focused on adding new design modules and galleries to the existing platform. As added value to the community we want to create a job network where companies will be able to post their job offers to professionals seeking job in all the areas involved such as CAD, 3D printers parts, software development, etc. Being part of this network will be free for the jobseekers creating a huge benefit to the EOS ecosystem. Companies will just have to pay a fee for the service they will use or the duration. All invoices will be linked to a smart contract associated to their corresponding wallet. Data protection and security are guaranteed by Block.one/EOS reliability."),m_(),m_(),m_(),m_(),m_(),v_(260,"h1"),B_(261,"THANKS TO"),m_(),v_(262,"div",3),v_(263,"div",4),v_(264,"p",129),g_(265,"img",130),m_(),v_(266,"h3"),B_(267,"EOSNewYork"),m_(),m_(),v_(268,"div",4),v_(269,"p",129),g_(270,"img",131),m_(),v_(271,"h3"),B_(272,"Scatter"),m_(),m_(),v_(273,"div",4),v_(274,"p",129),g_(275,"img",132),m_(),v_(276,"h3"),B_(277,"BigOne"),m_(),m_(),v_(278,"div",4),v_(279,"p",129),g_(280,"img",133),m_(),v_(281,"h3"),B_(282,"Nebula"),m_(),m_(),v_(283,"div",4),v_(284,"p",129),g_(285,"img",134),m_(),v_(286,"h3"),B_(287,"Bloks.io"),m_(),m_(),v_(288,"div",4),v_(289,"p",129),g_(290,"img",135),m_(),v_(291,"h3"),B_(292,"EOStudio"),m_(),m_(),v_(293,"div",4),v_(294,"p",129),g_(295,"img",136),m_(),v_(296,"h3"),B_(297,"Greymass"),m_(),m_(),v_(298,"div",4),v_(299,"p",129),g_(300,"img",137),m_(),v_(301,"h3"),B_(302,"EOSphere"),m_(),m_(),v_(303,"div",4),v_(304,"p",129),g_(305,"img",138),m_(),v_(306,"h3"),B_(307,"TokenRocket"),m_(),m_(),v_(308,"div",4),v_(309,"p",129),g_(310,"img",139),m_(),v_(311,"h3"),B_(312,"EOSindex"),m_(),m_(),v_(313,"div",4),v_(314,"p",129),g_(315,"img",140),m_(),v_(316,"h3"),B_(317,"MEET.one"),m_(),m_(),v_(318,"div",4),v_(319,"p",129),g_(320,"img",141),m_(),v_(321,"h3"),B_(322,"MORE.one"),m_(),m_(),m_(),v_(323,"div",111),v_(324,"div",112),v_(325,"div",113),v_(326,"div",114),v_(327,"h1"),B_(328,"WHY WE CHOSE EOS BLOCKCHAIN?"),m_(),m_(),v_(329,"div",115),v_(330,"h2"),B_(331,"EOS poses an entirely different ideological perspective on blockchain consensus, decentralization, and how smart contracts should be executed and operated. Being a completely new platform, EOS is attempting to not make what it considers to be fundamental mistakes made by its predecessors. EOS.IO Software One unique feature of EOS is that it will rely on the users of the platform to make their own blockchains, rather than creating and managing a centralized chain themselves. Each blockchain running the EOS.IO Software is expected to begin its chain with an EOS \u2018genesis block\u2019. The genesis block will be a snapshot of the Ethereum blockchain taken on June 1, 2018 at 22:59:59 UTC that will record ownership of the temporary ERC-20 EOS tokens that have been distributed throughout the platform\u2019s ICO. From this point, it is theorized that new blockchains running the EOS.IO software will compete against one another until the most popular chain becomes the main chain used on the platform. Token Cap EOS is its approach to token distribution. block.one has put a one billion token cap on the release of its ERC-20 token on the platform, a significantly higher number than most other cryptocurrency platforms (e.g. Bitcoin\u2019s cap is 21 million). Despite being larger than most, token caps of any size have been argued to serve as an important means of protecting token holders against inflation in ways that unlimited token cap platform\u2019s like Ethereum do not. Programming Language and Dapp Development EOS.IO aims to be a more efficient and easy-to-use platform for dapp developers than those that have come before it. To that end, EOS.IO includes support for C++ programming, which is historically one of the most popular coding languages. C++ is compatible with hundreds of thousands of pre-existing libraries currently on the web for EOS developers to reference while building their dapps. This is a potential advantage over a platform like Ethereum which uses a proprietary language called Solidity. EOS.IO will also come pre-equipped with numerous useful features, including account creation and recovery, multi-signature accounts, account messaging, role-based permissions, and many other commonly used tools in application development. Transaction Speed EOS will have a block time of 0.5 seconds and claims to support a transaction speed of thousands, if not millions, of transactions per second. This is perhaps the most exciting feature of EOS and is a feat yet to be achieved by any other platform on the market. DPoS Algorithm One of the key elements to EOS\u2019s security and speed is Daniel Larimer\u2019s unique consensus algorithm called Delegated Proof of Stake (DPoS). Larimer has been refining DPoS since 2013 and has successfully implemented it in his previous blockchain projects, Bitshares and Steem. Through the use of DPoS, EOS aims to address concerns surrounding decentralization, safety, and scalability by allowing network token holders to cast votes in proportion to the size of their stake in the network to elect 21 block producers. DPoS in effect democratizes the process of whose work is chosen to be added to the network\u2019s blockchain. Because EOS token holders are voting for who is elected into the group of block producers, the block producers are held accountable to the quality of their performance. In theory, the competition between block producers to earn the votes of the stakeholders will spur on increased speed and scalability while creating a barrier for entry that will prevent hackers from acquiring sufficient votes to have their fraudulent work added to the chain. DPoS is built on the idea that the barrier of entry block producers need to get through in order to be elected as adds an additional layer of security that a PoS model doesn\u2019t have, and leads to faster transaction speeds than Ethereum\u2019s overly complex sharding system can deliver."),m_(),m_(),m_(),m_(),m_(),m_(),m_(),m_(),m_(),m_(),g_(332,"cookie-law",142))},directives:[UP],styles:[""]}),yP),FP=((bP=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||bP)},bP.\u0275cmp=ht({type:bP,selectors:[["app-p3d"]],decls:21,vars:0,consts:[[1,"backstretch","animated"],[1,"container"],[1,"d-flex","justify-content-center","h-100"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"card-footer"],[1,"d-flex","justify-content-center","links"],["href","../new-user"],[1,"d-flex","justify-content-center"],["href","#"]],template:function(e,t){1&e&&(v_(0,"head"),v_(1,"title"),B_(2,"3D"),m_(),m_(),v_(3,"body"),v_(4,"div",0),v_(5,"div",1),v_(6,"div",2),v_(7,"div",3),v_(8,"div",4),v_(9,"h3"),B_(10,"3D Platform"),m_(),m_(),v_(11,"div",5),g_(12,"form"),m_(),v_(13,"div",6),v_(14,"div",7),B_(15," Don't have an account?"),v_(16,"a",8),B_(17,"Sign Up"),m_(),m_(),v_(18,"div",9),v_(19,"a",10),B_(20,"Forgot your password?"),m_(),m_(),m_(),m_(),m_(),m_(),m_(),m_())},directives:[iu,iE],styles:['body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{background-image:"../assets/ADE burning background.png";background-size:cover;background-repeat:no-repeat;font-family:Numans,sans-serif;font-family:Impact,Haettenschweiler,Arial Narrow,sans-serif}.container[_ngcontent-%COMP%]{height:85%;align-content:center}.card[_ngcontent-%COMP%]{height:40%;margin-top:auto;margin-bottom:auto;width:60%;background-color:rgba(30,0,49,.377)!important}.social_icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:60px;margin-left:10px;color:#c812ff}.social_icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{color:#fff;cursor:pointer}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff}.social_icon[_ngcontent-%COMP%]{position:absolute;right:20px;top:-45px}.input-group-prepend[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:50px;background-color:#9902b8;color:#000;border:0!important}input[_ngcontent-%COMP%]:focus{outline:0 0 0 0!important;box-shadow:0 0 0 0!important}.remember[_ngcontent-%COMP%]{color:#fff}.remember[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:20px;height:20px;margin-left:15px;margin-right:5px}.login_btn[_ngcontent-%COMP%]{color:#fff;background-color:#9902b8;width:100px}.login_btn[_ngcontent-%COMP%]:hover{color:#000;background-color:#fff}.links[_ngcontent-%COMP%]{color:#fff}.links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:4px}a[_ngcontent-%COMP%]{color:#3b0036;text-decoration:none;background-color:transparent}']}),bP),GP=((IP=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||IP)},IP.\u0275cmp=ht({type:IP,selectors:[["app-plm"]],decls:21,vars:0,consts:[[1,"backstretch","animated"],[1,"container"],[1,"d-flex","justify-content-center","h-100"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"card-footer"],[1,"d-flex","justify-content-center","links"],["href","../new-user"],[1,"d-flex","justify-content-center"],["href","#"]],template:function(e,t){1&e&&(v_(0,"head"),v_(1,"title"),B_(2,"PLM"),m_(),m_(),v_(3,"body"),v_(4,"div",0),v_(5,"div",1),v_(6,"div",2),v_(7,"div",3),v_(8,"div",4),v_(9,"h3"),B_(10,"PLM Platform"),m_(),m_(),v_(11,"div",5),g_(12,"form"),m_(),v_(13,"div",6),v_(14,"div",7),B_(15," Don't have an account?"),v_(16,"a",8),B_(17,"Sign Up"),m_(),m_(),v_(18,"div",9),v_(19,"a",10),B_(20,"Forgot your password?"),m_(),m_(),m_(),m_(),m_(),m_(),m_(),m_())},directives:[iu,iE],styles:['body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{background-image:"../assets/ADE burning background.png";background-size:cover;background-repeat:no-repeat;font-family:Numans,sans-serif;font-family:Impact,Haettenschweiler,Arial Narrow,sans-serif}.container[_ngcontent-%COMP%]{height:85%;align-content:center}.card[_ngcontent-%COMP%]{height:40%;margin-top:auto;margin-bottom:auto;width:60%;background-color:rgba(30,0,49,.377)!important}.social_icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:60px;margin-left:10px;color:#c812ff}.social_icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{color:#fff;cursor:pointer}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff}.social_icon[_ngcontent-%COMP%]{position:absolute;right:20px;top:-45px}.input-group-prepend[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:50px;background-color:#9902b8;color:#000;border:0!important}input[_ngcontent-%COMP%]:focus{outline:0 0 0 0!important;box-shadow:0 0 0 0!important}.remember[_ngcontent-%COMP%]{color:#fff}.remember[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:20px;height:20px;margin-left:15px;margin-right:5px}.login_btn[_ngcontent-%COMP%]{color:#fff;background-color:#9902b8;width:100px}.login_btn[_ngcontent-%COMP%]:hover{color:#000;background-color:#fff}.links[_ngcontent-%COMP%]{color:#fff}.links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:4px}a[_ngcontent-%COMP%]{color:#3b0036;text-decoration:none;background-color:transparent}']}),IP),KP=((RP=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||RP)},RP.\u0275cmp=ht({type:RP,selectors:[["app-jobs"]],decls:22,vars:0,consts:[[1,"backstretch","animated"],[1,"container"],[1,"d-flex","justify-content-center","h-100"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"card-footer"],[1,"d-flex","justify-content-center","links"],["href","../new-user"],[1,"d-flex","justify-content-center"],["href","#"]],template:function(e,t){1&e&&(v_(0,"html"),v_(1,"head"),v_(2,"title"),B_(3,"JOBS"),m_(),m_(),v_(4,"body"),v_(5,"div",0),v_(6,"div",1),v_(7,"div",2),v_(8,"div",3),v_(9,"div",4),v_(10,"h3"),B_(11,"Jobs Platform"),m_(),m_(),v_(12,"div",5),g_(13,"form"),m_(),v_(14,"div",6),v_(15,"div",7),B_(16," Don't have an account?"),v_(17,"a",8),B_(18,"Sign Up"),m_(),m_(),v_(19,"div",9),v_(20,"a",10),B_(21,"Forgot your password?"),m_(),m_(),m_(),m_(),m_(),m_(),m_(),m_(),m_())},directives:[iu,iE],styles:['body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{background-image:"../assets/ADE burning background.png";background-size:cover;background-repeat:no-repeat;font-family:Numans,sans-serif;font-family:Impact,Haettenschweiler,Arial Narrow,sans-serif}.container[_ngcontent-%COMP%]{height:85%;align-content:center}.card[_ngcontent-%COMP%]{height:40%;margin-top:auto;margin-bottom:auto;width:60%;background-color:rgba(30,0,49,.377)!important}.social_icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:60px;margin-left:10px;color:#c812ff}.social_icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{color:#fff;cursor:pointer}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff}.social_icon[_ngcontent-%COMP%]{position:absolute;right:20px;top:-45px}.input-group-prepend[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:50px;background-color:#9902b8;color:#000;border:0!important}input[_ngcontent-%COMP%]:focus{outline:0 0 0 0!important;box-shadow:0 0 0 0!important}.remember[_ngcontent-%COMP%]{color:#fff}.remember[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:20px;height:20px;margin-left:15px;margin-right:5px}.login_btn[_ngcontent-%COMP%]{color:#fff;background-color:#9902b8;width:100px}.login_btn[_ngcontent-%COMP%]:hover{color:#000;background-color:#fff}.links[_ngcontent-%COMP%]{color:#fff}.links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:4px}a[_ngcontent-%COMP%]{color:#3b0036;text-decoration:none;background-color:transparent}']}),RP),BP=((NP=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||NP)},NP.\u0275cmp=ht({type:NP,selectors:[["app-tools"]],decls:22,vars:0,consts:[[1,"backstretch","animated"],[1,"container"],[1,"d-flex","justify-content-center","h-100"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"card-footer"],[1,"d-flex","justify-content-center","links"],["href","../new-user"],[1,"d-flex","justify-content-center"],["href","#"]],template:function(e,t){1&e&&(v_(0,"html"),v_(1,"head"),v_(2,"title"),B_(3,"TOOLS"),m_(),m_(),v_(4,"body"),v_(5,"div",0),v_(6,"div",1),v_(7,"div",2),v_(8,"div",3),v_(9,"div",4),v_(10,"h3"),B_(11,"Tools"),m_(),m_(),v_(12,"div",5),g_(13,"form"),m_(),v_(14,"div",6),v_(15,"div",7),B_(16," Don't have an account?"),v_(17,"a",8),B_(18,"Sign Up"),m_(),m_(),v_(19,"div",9),v_(20,"a",10),B_(21,"Forgot your password?"),m_(),m_(),m_(),m_(),m_(),m_(),m_(),m_(),m_())},directives:[iu,iE],styles:['body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{background-image:"../assets/ADE burning background.png";background-size:cover;background-repeat:no-repeat;font-family:Numans,sans-serif;font-family:Impact,Haettenschweiler,Arial Narrow,sans-serif}.container[_ngcontent-%COMP%]{height:85%;align-content:center}.card[_ngcontent-%COMP%]{height:40%;margin-top:auto;margin-bottom:auto;width:60%;background-color:rgba(30,0,49,.377)!important}.social_icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:60px;margin-left:10px;color:#c812ff}.social_icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{color:#fff;cursor:pointer}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff}.social_icon[_ngcontent-%COMP%]{position:absolute;right:20px;top:-45px}.input-group-prepend[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:50px;background-color:#9902b8;color:#000;border:0!important}input[_ngcontent-%COMP%]:focus{outline:0 0 0 0!important;box-shadow:0 0 0 0!important}.remember[_ngcontent-%COMP%]{color:#fff}.remember[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:20px;height:20px;margin-left:15px;margin-right:5px}.login_btn[_ngcontent-%COMP%]{color:#fff;background-color:#9902b8;width:100px}.login_btn[_ngcontent-%COMP%]:hover{color:#000;background-color:#fff}.links[_ngcontent-%COMP%]{color:#fff}.links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:4px}a[_ngcontent-%COMP%]{color:#3b0036;text-decoration:none;background-color:transparent}']}),NP),XP=((OP=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||OP)},OP.\u0275cmp=ht({type:OP,selectors:[["app-wallet"]],decls:21,vars:0,consts:[[1,"backstretch","animated"],[1,"container"],[1,"d-flex","justify-content-center","h-100"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"card-footer"],[1,"d-flex","justify-content-center","links"],["href","../new-user"],[1,"d-flex","justify-content-center"],["href","#"]],template:function(e,t){1&e&&(v_(0,"head"),v_(1,"title"),B_(2,"WALLET"),m_(),m_(),v_(3,"body"),v_(4,"div",0),v_(5,"div",1),v_(6,"div",2),v_(7,"div",3),v_(8,"div",4),v_(9,"h3"),B_(10,"Wallet"),m_(),m_(),v_(11,"div",5),g_(12,"form"),m_(),v_(13,"div",6),v_(14,"div",7),B_(15," Don't have an account?"),v_(16,"a",8),B_(17,"Sign Up"),m_(),m_(),v_(18,"div",9),v_(19,"a",10),B_(20,"Forgot your password?"),m_(),m_(),m_(),m_(),m_(),m_(),m_(),m_())},directives:[iu,iE],styles:['body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{background-image:"../assets/ADE burning background.png";background-size:cover;background-repeat:no-repeat;font-family:Numans,sans-serif;font-family:Impact,Haettenschweiler,Arial Narrow,sans-serif}.container[_ngcontent-%COMP%]{height:85%;align-content:center}.card[_ngcontent-%COMP%]{height:40%;margin-top:auto;margin-bottom:auto;width:60%;background-color:rgba(30,0,49,.377)!important}.social_icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:60px;margin-left:10px;color:#c812ff}.social_icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{color:#fff;cursor:pointer}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff}.social_icon[_ngcontent-%COMP%]{position:absolute;right:20px;top:-45px}.input-group-prepend[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:50px;background-color:#9902b8;color:#000;border:0!important}input[_ngcontent-%COMP%]:focus{outline:0 0 0 0!important;box-shadow:0 0 0 0!important}.remember[_ngcontent-%COMP%]{color:#fff}.remember[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:20px;height:20px;margin-left:15px;margin-right:5px}.login_btn[_ngcontent-%COMP%]{color:#fff;background-color:#9902b8;width:100px}.login_btn[_ngcontent-%COMP%]:hover{color:#000;background-color:#fff}.links[_ngcontent-%COMP%]{color:#fff}.links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:4px}a[_ngcontent-%COMP%]{color:#3b0036;text-decoration:none;background-color:transparent}']}),OP),HP=((gP=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||gP)},gP.\u0275cmp=ht({type:gP,selectors:[["app-dashboard"]],decls:0,vars:0,template:function(e,t){},styles:['body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{background-image:"../assets/ADE burning background.png";background-size:cover;background-repeat:no-repeat;font-family:Numans,sans-serif;font-family:Impact,Haettenschweiler,Arial Narrow,sans-serif}.container[_ngcontent-%COMP%]{height:85%;align-content:center}.card[_ngcontent-%COMP%]{height:40%;margin-top:auto;margin-bottom:auto;width:60%;background-color:rgba(30,0,49,.377)!important}.social_icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:60px;margin-left:10px;color:#c812ff}.social_icon[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{color:#fff;cursor:pointer}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#fff}.social_icon[_ngcontent-%COMP%]{position:absolute;right:20px;top:-45px}.input-group-prepend[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:50px;background-color:#9902b8;color:#000;border:0!important}input[_ngcontent-%COMP%]:focus{outline:0 0 0 0!important;box-shadow:0 0 0 0!important}.remember[_ngcontent-%COMP%]{color:#fff}.remember[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:20px;height:20px;margin-left:15px;margin-right:5px}.login_btn[_ngcontent-%COMP%]{color:#fff;background-color:#9902b8;width:100px}.login_btn[_ngcontent-%COMP%]:hover{color:#000;background-color:#fff}.links[_ngcontent-%COMP%]{color:#fff}.links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:4px}a[_ngcontent-%COMP%]{color:#3b0036;text-decoration:none;background-color:transparent}']}),gP),jP=((mP=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||mP)},mP.\u0275cmp=ht({type:mP,selectors:[["app-campus"]],decls:2,vars:0,template:function(e,t){1&e&&(v_(0,"p"),B_(1,"campus works!"),m_())},styles:[""]}),mP),zP=((vP=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||vP)},vP.\u0275cmp=ht({type:vP,selectors:[["app-footer"]],decls:101,vars:0,consts:[["id","footer",1,"footer-1"],[1,"main-footer","widgets-dark","typo-light"],[1,"container"],[1,"row"],[1,"col-xs-12","col-sm-6","col-md-3"],[1,"widget","subscribe","no-box"],[1,"widget-title"],["href","/assets/CADEOSio Whitepaper 3.pdf"],["href","/assets/CADEOS.io Registration Agreement.pdf"],["href","https://cadeos.io/bp.json"],[1,"widget","no-box"],[1,"thumbnail-widget"],[1,"thumb-content"],["href","#."],["href","/register","target","_blank",1,"btn"],["href","mailto:info@domain.com"],[1,"row","iconbar",2,"padding-top","1%"],[1,"footericons"],["href","https://github.com/CADEOS","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/GitHub.png",1,"footericons"],["href","https://web.facebook.com/cadeos.io","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/facebook.png",1,"footericons"],["href","https://twitter.com/cadeosi","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/Twitter.png",1,"footericons"],["href","https://t.me/cadeos","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/telegram.png",1,"footericons"],["href","https://medium.com/cadeos-io","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/medium.png",1,"footericons"],["href","","target","_blank",1,"padding-top-subtitle"],["srcset","","alt","","src","/assets/blockchain.png",1,"footericons"],[1,"footer-copyright"],[1,"col-md-12","text-center"]],template:function(e,t){1&e&&(v_(0,"html"),v_(1,"body"),v_(2,"footer",0),v_(3,"div",1),v_(4,"div",2),v_(5,"div",3),v_(6,"div",4),v_(7,"div",5),v_(8,"h3",6),B_(9,"CADEOS.io"),g_(10,"span"),m_(),v_(11,"p"),B_(12,"Decentralized PLM & CAD Platform "),m_(),v_(13,"p"),v_(14,"a",7),B_(15,"WhitePaper"),m_(),m_(),v_(16,"p"),v_(17,"a",8),B_(18,"Registration Agreement"),m_(),m_(),v_(19,"p"),v_(20,"a",8),B_(21,"Privaticy Policy"),m_(),m_(),v_(22,"p"),v_(23,"a",9),B_(24,"Block Produccer .JSON"),m_(),m_(),m_(),m_(),v_(25,"div",4),v_(26,"div",10),v_(27,"h3",6),B_(28,"QUICK LINKS"),g_(29,"span"),m_(),v_(30,"ul",11),v_(31,"li"),v_(32,"div",12),v_(33,"a",13),B_(34,"3D"),m_(),m_(),m_(),v_(35,"li"),v_(36,"div",12),v_(37,"a",13),B_(38,"PLM"),m_(),m_(),m_(),v_(39,"li"),v_(40,"div",12),v_(41,"a",13),B_(42,"JOBS"),m_(),m_(),m_(),v_(43,"li"),v_(44,"div",12),v_(45,"a",13),B_(46,"TOLLS"),m_(),m_(),m_(),v_(47,"li"),v_(48,"div",12),v_(49,"a",13),B_(50,"WALLET"),m_(),m_(),m_(),v_(51,"li"),v_(52,"div",12),v_(53,"a",13),B_(54,"CAMPUS"),m_(),m_(),m_(),v_(55,"li"),v_(56,"div",12),v_(57,"a",13),B_(58,"ABOUT"),m_(),m_(),m_(),m_(),m_(),m_(),v_(59,"div",4),v_(60,"div",10),v_(61,"h3",6),B_(62,"GET STARTED"),g_(63,"span"),m_(),v_(64,"p"),B_(65,"Get access to your full project features and work enviroment"),m_(),v_(66,"a",14),B_(67,"Register Now"),m_(),m_(),m_(),v_(68,"div",4),v_(69,"div",10),v_(70,"h3",6),B_(71,"CONTACT US"),g_(72,"span"),m_(),v_(73,"p"),v_(74,"a",15),B_(75,"ggalindo@cadeos.io"),m_(),m_(),v_(76,"div",16),v_(77,"div",17),v_(78,"a",18),g_(79,"img",19),m_(),m_(),v_(80,"div",17),v_(81,"a",20),g_(82,"img",21),m_(),m_(),v_(83,"div",17),v_(84,"a",22),g_(85,"img",23),m_(),m_(),v_(86,"div",17),v_(87,"a",24),g_(88,"img",25),m_(),m_(),v_(89,"div",17),v_(90,"a",26),g_(91,"img",27),m_(),m_(),v_(92,"div",17),v_(93,"a",28),g_(94,"img",29),m_(),m_(),m_(),m_(),m_(),m_(),m_(),m_(),v_(95,"div",30),v_(96,"div",2),v_(97,"div",3),v_(98,"div",31),v_(99,"p"),B_(100,"Copyright CADEOS.io \xa9 2018. All rights reserved."),m_(),m_(),m_(),m_(),m_(),m_(),m_(),m_())},styles:['footer[_ngcontent-%COMP%]   .main-footer[_ngcontent-%COMP%]{padding:20px 0;background:#fff}footer[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:0;list-style:none}.footer-copyright[_ngcontent-%COMP%]{background:#360038;padding:5px 0}.footer-copyright[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{display:inherit}.footer-copyright[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]{float:right;margin-top:5px}.footer-copyright[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0}.footer-copyright[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{border-left:1px solid #505050;display:inline-block;line-height:12px;margin:0;padding:0 8px}.footer-copyright[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#969696}.footer-copyright[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child{border:none;padding-left:0}.footer-copyright[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#969696;margin:2px 0 0}.footer-top[_ngcontent-%COMP%]{background:#fff;padding-bottom:30px;margin-bottom:30px;border-bottom:3px solid #222}footer.transparent[_ngcontent-%COMP%]   .footer-top[_ngcontent-%COMP%], footer.transparent[_ngcontent-%COMP%]   .main-footer[_ngcontent-%COMP%]{background:transparent}footer.transparent[_ngcontent-%COMP%]   .footer-copyright[_ngcontent-%COMP%]{background:none repeat scroll 0 0 rgba(0,0,0,.3)}footer.light[_ngcontent-%COMP%]   .footer-top[_ngcontent-%COMP%], footer.light[_ngcontent-%COMP%]   .main-footer[_ngcontent-%COMP%]{background:#f9f9f9}footer.light[_ngcontent-%COMP%]   .footer-copyright[_ngcontent-%COMP%]{background:none repeat scroll 0 0 hsla(0,0%,100%,.3)}.footer-[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{display:inline-block}.widget[_ngcontent-%COMP%]{padding:20px;margin-bottom:40px}.widget.widget-last[_ngcontent-%COMP%]{margin-bottom:0}.widget.no-box[_ngcontent-%COMP%]{padding:0;background-color:transparent;margin-bottom:40px;box-shadow:none;-webkit-box-shadow:none;-moz-box-shadow:none;-ms-box-shadow:none;-o-box-shadow:none}.widget.subscribe[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:18px;color:#3e004b}.widget[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#3e004b}.widget[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#8c00a8}.widget-title[_ngcontent-%COMP%]{margin-bottom:20px}.widget-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:#839fad none repeat scroll 0 0;display:block;height:1px;margin-top:25px;position:relative;width:20%}.widget-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:after{background:inherit;content:"";height:inherit;position:absolute;top:-4px;width:50%}.widget-title.text-center[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .widget-title.text-center[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:after{margin-left:auto;margin-right:auto;left:0;right:0}.widget[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{float:right;background:#7f7f7f}.typo-light[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .typo-light[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .typo-light[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .typo-light[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .typo-light[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%], .typo-light[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .typo-light[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%], .typo-light[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .typo-light[_ngcontent-%COMP%]   small[_ngcontent-%COMP%], .typo-light[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#000}ul.social-footer2[_ngcontent-%COMP%]{margin:0;padding:0;width:auto}ul.social-footer2[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-block;padding:0}ul.social-footer2[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#3e004b}ul.social-footer2[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;height:30px;width:30px;text-align:center}.btn[_ngcontent-%COMP%]{background-color:#3e004b;color:#fff}.btn.active[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]:focus, .btn[_ngcontent-%COMP%]:hover{background:#fc34f2;color:#fff;-ms-box-shadow:0 15px 30px rgba(0,0,0,.1);-o-box-shadow:0 15px 30px rgba(0,0,0,.1);box-shadow:0 15px 30px rgba(0,0,0,.1);transition:all .25s ease-in-out 0s}.footericons[_ngcontent-%COMP%]{width:35%;border-radius:50%;margin:1%;padding:0}.footericons[_ngcontent-%COMP%], .iconbar[_ngcontent-%COMP%]{justify-content:center;align-items:center}.iconbar[_ngcontent-%COMP%]{align-content:center;text-align:center;margin:0}']}),vP);function QP(e,t){1&e&&(v_(0,"div"),B_(1,"Username is required"),m_())}function VP(e,t){if(1&e&&(v_(0,"div",16),p_(1,QP,2,0,"div",17),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.username.errors.required)}}function qP(e,t){1&e&&(v_(0,"div"),B_(1,"Password is required"),m_())}function WP(e,t){if(1&e&&(v_(0,"div",16),p_(1,qP,2,0,"div",17),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.password.errors.required)}}function JP(e,t){1&e&&g_(0,"span",18)}var ZP,$P=function(e){return{"is-invalid":e}},eS=((ZP=function(){function e(t,r,n,a,o){_classCallCheck(this,e),this.formBuilder=t,this.route=r,this.router=n,this.accountService=a,this.alertService=o,this.loading=!1,this.submitted=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.form=this.formBuilder.group({username:["",uE.required],password:["",uE.required]}),this.returnUrl=this.route.snapshot.queryParams.returnUrl||"/"}},{key:"onSubmit",value:function(){var e=this;this.submitted=!0,this.alertService.clear(),this.form.invalid||(this.loading=!0,this.accountService.login(this.f.username.value,this.f.password.value).pipe(Hd()).subscribe((function(t){e.router.navigate([e.returnUrl])}),(function(t){e.alertService.error(t),e.loading=!1})))}},{key:"f",get:function(){return this.form.controls}}]),e}()).\u0275fac=function(e){return new(e||ZP)(P_(gu),P_(ff),P_(Op),P_(tP),P_(aP))},ZP.\u0275cmp=ht({type:ZP,selectors:[["ng-component"]],decls:25,vars:11,consts:[[1,"backstretch","animated"],[1,"login-page"],[1,"login-card"],[1,"card-header",2,"color","white"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","username"],["type","text","formControlName","username",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","password"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],["routerLink","../register",1,"btn","btn-link"],["learnMore","/assets/CADEOS.io Privacy Policy.pdf","target","_self"],[1,"invalid-feedback"],[4,"ngIf"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(e,t){1&e&&(v_(0,"html"),v_(1,"div",0),v_(2,"div",1),v_(3,"div",2),v_(4,"h1",3),B_(5,"Login"),m_(),v_(6,"div",4),v_(7,"form",5),I_("ngSubmit",(function(){return t.onSubmit()})),v_(8,"div",6),v_(9,"label",7),B_(10,"Username"),m_(),g_(11,"input",8),p_(12,VP,2,1,"div",9),m_(),v_(13,"div",6),v_(14,"label",10),B_(15,"Password"),m_(),g_(16,"input",11),p_(17,WP,2,1,"div",9),m_(),v_(18,"div",6),v_(19,"button",12),p_(20,JP,1,0,"span",13),B_(21," Login "),m_(),v_(22,"a",14),B_(23,"Register"),m_(),m_(),m_(),m_(),m_(),m_(),m_(),m_(),g_(24,"cookie-law",15)),2&e&&(Ta(7),A_("formGroup",t.form),Ta(4),A_("ngClass",es(7,$P,t.submitted&&t.f.username.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.username.errors),Ta(4),A_("ngClass",es(9,$P,t.submitted&&t.f.password.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.password.errors),Ta(2),A_("disabled",t.loading),Ta(1),A_("ngIf",t.loading))},directives:[iu,iE,cu,Jc,_E,vu,Hl,jl,Np,UP],encapsulation:2}),ZP);function tS(e,t){1&e&&(v_(0,"div"),B_(1,"First Name is required"),m_())}function rS(e,t){if(1&e&&(v_(0,"div",53),p_(1,tS,2,0,"div",54),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.firstName.errors.required)}}function nS(e,t){1&e&&(v_(0,"div"),B_(1,"Last Name is required"),m_())}function aS(e,t){if(1&e&&(v_(0,"div",53),p_(1,nS,2,0,"div",54),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.lastName.errors.required)}}function oS(e,t){1&e&&(v_(0,"div"),B_(1,"Username is required"),m_())}function _S(e,t){if(1&e&&(v_(0,"div",53),p_(1,oS,2,0,"div",54),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.username.errors.required)}}function iS(e,t){1&e&&(v_(0,"div"),B_(1,"Password is required"),m_())}function sS(e,t){1&e&&(v_(0,"div"),B_(1,"Password must be at least 6 characters"),m_())}function lS(e,t){if(1&e&&(v_(0,"div",53),p_(1,iS,2,0,"div",54),p_(2,sS,2,0,"div",54),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.password.errors.required),Ta(1),A_("ngIf",r.f.password.errors.minlength)}}function cS(e,t){1&e&&(v_(0,"div"),B_(1,"Email is required"),m_())}function ES(e,t){if(1&e&&(v_(0,"div",53),p_(1,cS,2,0,"div",54),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.email.errors.required)}}function uS(e,t){1&e&&(v_(0,"div"),B_(1,"Web is required"),m_())}function dS(e,t){if(1&e&&(v_(0,"div",53),p_(1,uS,2,0,"div",54),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.web.errors.required)}}function TS(e,t){1&e&&(v_(0,"div"),B_(1,"City is required"),m_())}function fS(e,t){if(1&e&&(v_(0,"div",53),p_(1,TS,2,0,"div",54),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.city.errors.required)}}function pS(e,t){1&e&&(v_(0,"div"),B_(1,"Country is required"),m_())}function PS(e,t){if(1&e&&(v_(0,"div",53),p_(1,pS,2,0,"div",54),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.country.errors.required)}}function SS(e,t){1&e&&(v_(0,"div"),B_(1,"Profesion is required"),m_())}function AS(e,t){if(1&e&&(v_(0,"div",53),p_(1,SS,2,0,"div",54),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.profesion.errors.required)}}function hS(e,t){1&e&&(v_(0,"div"),B_(1,"Skills is required"),m_())}function vS(e,t){if(1&e&&(v_(0,"div",53),p_(1,hS,2,0,"div",54),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.skills.errors.required)}}function mS(e,t){1&e&&(v_(0,"div"),B_(1,"Stacks is required"),m_())}function gS(e,t){if(1&e&&(v_(0,"div",53),p_(1,mS,2,0,"div",54),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.stacks.errors.required)}}function OS(e,t){1&e&&(v_(0,"div"),B_(1,"Birthdate is required"),m_())}function NS(e,t){if(1&e&&(v_(0,"div",53),p_(1,OS,2,0,"div",54),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.birthdate.errors.required)}}function RS(e,t){1&e&&(v_(0,"div"),B_(1,"Birthdate is required"),m_())}function IS(e,t){if(1&e&&(v_(0,"div",53),p_(1,RS,2,0,"div",54),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.birthdate.errors.required)}}function bS(e,t){1&e&&g_(0,"div",53)}function yS(e,t){1&e&&(v_(0,"div"),B_(1,"Photo is required"),m_())}function LS(e,t){if(1&e&&(v_(0,"div",53),p_(1,yS,2,0,"div",54),m_()),2&e){var r=L_();Ta(1),A_("ngIf",r.f.photo.errors.required)}}function YS(e,t){1&e&&g_(0,"span",55)}var MS,xS=function(e){return{"is-invalid":e}},CS=((MS=function(){function e(t,r,n,a,o){_classCallCheck(this,e),this.formBuilder=t,this.route=r,this.router=n,this.accountService=a,this.alertService=o,this.loading=!1,this.submitted=!1,this.filePath="C:\\server\\"}return _createClass(e,[{key:"ngOnInit",value:function(){this.registerForm=this.formBuilder.group({firstName:["",uE.required,uE.maxLength(10)],lastName:["",uE.required,uE.maxLength(10)],username:["",uE.required,uE.maxLength(10)],password:["",uE.required,uE.minLength(6),uE.maxLength(20)],email:["",uE.required,uE.maxLength(15)],web:["",uE.required,uE.maxLength(20)],city:["",uE.required,uE.maxLength(15)],country:["",uE.required,uE.maxLength(10)],profesion:["",uE.required,uE.maxLength(20)],skills:["",uE.required,uE.maxLength(100)],stacks:["",uE.required,uE.maxLength(100)],birthdate:["",uE.required,uE.maxLength(100)],jobseeker:["",uE.required,uE.maxLength(10)],eosaccount:["",uE.minLength(12)],photo:["",uE.required],gridCheck1:["",uE.required],gridCheck2:["",uE.required],jwtToken:[""],token:[""]})}},{key:"onSubmit",value:function(){var e=this;this.submitted=!0,this.alertService.clear(),this.registerForm.invalid||(this.loading=!0,this.accountService.register(this.f.firstName.value,this.f.lastName.value,this.f.username.value,this.f.password.value,this.f.email.value,this.f.web.value,this.f.city.value,this.f.country.value,this.f.profesion.value,this.f.skills.value,this.f.stacks.value,this.f.birthdate.value,this.f.jobseeker.value,this.f.eosaccount.value,this.f.photo.value,this.f.gridCheck1.value,this.f.gridCheck2.value).pipe(Hd()).subscribe((function(t){e.alertService.success("Registration successful",{keepAfterRouteChange:!0}),e.router.navigate(["./home"],{relativeTo:e.route})}),(function(t){e.alertService.error(t),e.loading=!1})))}},{key:"onSelectFile",value:function(e){var t=this;if(e.target.files&&e.target.files[0]){var r=new FileReader;r.readAsDataURL(e.target.files[0]),r.onload=function(e){t.url=e.target.result,t.f.photo.value.get("photo").setValue({filename:r.result.split(",")[0]})}}}},{key:"f",get:function(){return this.registerForm.controls}}]),e}()).\u0275fac=function(e){return new(e||MS)(P_(gu),P_(ff),P_(Op),P_(tP),P_(aP))},MS.\u0275cmp=ht({type:MS,selectors:[["ng-component"]],decls:105,vars:64,consts:[[1,"backstretch","animated"],[1,"register-page"],[1,"register-card"],[1,"card-header",2,"color","white"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"form-row"],[1,"col-md-4","mb-3"],["for","firstName"],["type","text","formControlName","firstName",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","lastName"],["type","text","formControlName","lastName",1,"form-control",3,"ngClass"],["for","username"],["type","text","formControlName","username",1,"form-control",3,"ngClass"],["for","password"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],["for","email"],["type","text","formControlName","email",1,"form-control",3,"ngClass"],["for","web"],["type","web","formControlName","web",1,"form-control",3,"ngClass"],["for","city"],["type","text","formControlName","city",1,"form-control",3,"ngClass"],["for","country"],["type","text","formControlName","country",1,"form-control",3,"ngClass"],["for","profesion"],["type","text","formControlName","profesion",1,"form-control",3,"ngClass"],["for","skills"],["type","text","formControlName","skills",1,"form-control",3,"ngClass"],["for","stacks"],["type","text","formControlName","stacks",1,"form-control",3,"ngClass"],["for","birthdate"],["type","date","formControlName","birthdate",1,"form-control",3,"ngClass"],["for","jobseeker"],["type","text","formControlName","jobseeker",1,"form-control",3,"ngClass"],["for","eosaccount"],["type","text","formControlName","eosaccount",1,"form-control",3,"ngClass"],["id","fileInput","accept","image/*","type","file","name","MAX_FILE_SIZE","value","300","formControlName","photo",2,"visibility","hidden",3,"ngClass","change"],["for","fileInput",1,"hoverable"],[1,"avatar",3,"src"],[1,"hover-text"],[1,"background"],[1,"col-md-8","mb-3"],["ng-controller","ExampleController",1,"form-check1"],["type","checkbox","id","gridCheck2","ng-true-value","'YES'","ng-false-value","'NO'","ng-model","checkboxModel.value1",1,"form-check-input"],["for","gridCheck2",1,"form-check-label"],["ng-controller","ExampleController",1,"form-check2"],["type","checkbox","id","gridCheck1","ng-true-value","'YES'","ng-false-value","'NO'","ng-model","checkboxModel.value1",1,"form-check-input"],["for","gridCheck1",1,"form-check-label"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],["routerLink","/login",1,"btn","btn-link"],["learnMore","/assets/CADEOS.io Privacy Policy.pdf","target","_self"],[1,"invalid-feedback"],[4,"ngIf"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(e,t){1&e&&(v_(0,"html"),v_(1,"div",0),v_(2,"div",1),v_(3,"div",2),v_(4,"h1",3),B_(5,"Create User"),m_(),v_(6,"div",4),v_(7,"form",5),I_("ngSubmit",(function(){return t.onSubmit()})),v_(8,"div",6),v_(9,"div",7),v_(10,"label",8),B_(11,"First Name"),m_(),g_(12,"input",9),p_(13,rS,2,1,"div",10),m_(),v_(14,"div",7),v_(15,"label",11),B_(16,"Last Name"),m_(),g_(17,"input",12),p_(18,aS,2,1,"div",10),m_(),v_(19,"div",7),v_(20,"label",13),B_(21,"Username"),m_(),g_(22,"input",14),p_(23,_S,2,1,"div",10),m_(),v_(24,"div",7),v_(25,"label",15),B_(26,"Password"),m_(),g_(27,"input",16),p_(28,lS,3,2,"div",10),m_(),v_(29,"div",7),v_(30,"label",17),B_(31,"Email"),m_(),g_(32,"input",18),p_(33,ES,2,1,"div",10),m_(),v_(34,"div",7),v_(35,"label",19),B_(36,"Personal Web"),m_(),g_(37,"input",20),p_(38,dS,2,1,"div",10),m_(),v_(39,"div",7),v_(40,"label",21),B_(41,"City"),m_(),g_(42,"input",22),p_(43,fS,2,1,"div",10),m_(),v_(44,"div",7),v_(45,"label",23),B_(46,"Country"),m_(),g_(47,"input",24),p_(48,PS,2,1,"div",10),m_(),v_(49,"div",7),v_(50,"label",25),B_(51,"Profesion"),m_(),g_(52,"input",26),p_(53,AS,2,1,"div",10),m_(),v_(54,"div",7),v_(55,"label",27),B_(56,"Skills"),m_(),g_(57,"input",28),p_(58,vS,2,1,"div",10),m_(),v_(59,"div",7),v_(60,"label",29),B_(61,"Used Softwares"),m_(),g_(62,"input",30),p_(63,gS,2,1,"div",10),m_(),v_(64,"div",7),v_(65,"label",31),B_(66,"Birth Date"),m_(),g_(67,"input",32),p_(68,NS,2,1,"div",10),m_(),v_(69,"div",7),v_(70,"label",33),B_(71,"Describe yourself."),m_(),g_(72,"input",34),p_(73,IS,2,1,"div",10),m_(),v_(74,"div",7),v_(75,"label",35),B_(76,"EOS Account"),m_(),g_(77,"input",36),p_(78,bS,1,0,"div",10),m_(),v_(79,"div",7),v_(80,"input",37),I_("change",(function(e){return t.onSelectFile(e)})),m_(),v_(81,"label",38),g_(82,"img",39),v_(83,"div",40),B_(84,"Choose file"),m_(),g_(85,"div",41),m_(),p_(86,LS,2,1,"div",10),g_(87,"br"),m_(),m_(),v_(88,"div",42),v_(89,"div",43),g_(90,"input",44),v_(91,"label",45),B_(92," CADEOS.io could send me emails with personalized offers, support updates, and event news. "),m_(),m_(),m_(),v_(93,"div",42),v_(94,"div",46),g_(95,"input",47),v_(96,"label",48),B_(97," By clicking SUBSCRIBE, you agree to the CADEOS.io Privacy Statement. "),m_(),m_(),m_(),v_(98,"div",42),v_(99,"button",49),p_(100,YS,1,0,"span",50),B_(101," Register "),m_(),v_(102,"a",51),B_(103,"Cancel"),m_(),m_(),m_(),m_(),m_(),m_(),m_(),m_(),g_(104,"cookie-law",52)),2&e&&(Ta(7),A_("formGroup",t.registerForm),Ta(5),A_("ngClass",es(34,xS,t.submitted&&t.f.firstName.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.firstName.errors),Ta(4),A_("ngClass",es(36,xS,t.submitted&&t.f.lastName.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.lastName.errors),Ta(4),A_("ngClass",es(38,xS,t.submitted&&t.f.username.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.username.errors),Ta(4),A_("ngClass",es(40,xS,t.submitted&&t.f.password.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.password.errors),Ta(4),A_("ngClass",es(42,xS,t.submitted&&t.f.email.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.email.errors),Ta(4),A_("ngClass",es(44,xS,t.submitted&&t.f.web.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.web.errors),Ta(4),A_("ngClass",es(46,xS,t.submitted&&t.f.city.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.city.errors),Ta(4),A_("ngClass",es(48,xS,t.submitted&&t.f.country.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.country.errors),Ta(4),A_("ngClass",es(50,xS,t.submitted&&t.f.profesion.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.profesion.errors),Ta(4),A_("ngClass",es(52,xS,t.submitted&&t.f.skills.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.skills.errors),Ta(4),A_("ngClass",es(54,xS,t.submitted&&t.f.stacks.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.stacks.errors),Ta(4),A_("ngClass",es(56,xS,t.submitted&&t.f.birthdate.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.birthdate.errors),Ta(4),A_("ngClass",es(58,xS,t.submitted&&t.f.jobseeker.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.jobseeker.errors),Ta(4),A_("ngClass",es(60,xS,t.submitted&&t.f.eosaccount.errors)),Ta(1),A_("ngIf",t.submitted&&t.f.eosaccount.errors),Ta(2),A_("ngClass",es(62,xS,t.submitted&&t.f.photo.errors)),Ta(2),A_("src",t.url?t.url:"assets/LogoGris.png",Wn),Ta(4),A_("ngIf",t.submitted&&t.f.photo.errors),Ta(13),A_("disabled",t.loading),Ta(1),A_("ngIf",t.loading))},directives:[iu,iE,cu,Jc,_E,vu,Hl,jl,Np,UP],encapsulation:2}),MS);function wS(e,t){1&e&&g_(0,"span",10)}function US(e,t){1&e&&(v_(0,"span"),B_(1,"Delete"),m_())}function kS(e,t){if(1&e){var r=O_();v_(0,"tr"),v_(1,"td"),B_(2),m_(),v_(3,"td"),B_(4),m_(),v_(5,"td"),B_(6),m_(),v_(7,"td",6),v_(8,"a",7),B_(9,"Edit"),m_(),v_(10,"button",8),I_("click",(function(){rr(r);var e=t.$implicit;return L_().deleteUser(e.id)})),p_(11,wS,1,0,"span",9),p_(12,US,2,0,"span",5),m_(),m_(),m_()}if(2&e){var n=t.$implicit;Ta(2),X_(n.firstName),Ta(2),X_(n.lastName),Ta(2),X_(n.username),Ta(4),A_("disabled",n.isDeleting),Ta(1),A_("ngIf",n.isDeleting),Ta(1),A_("ngIf",!n.isDeleting)}}function DS(e,t){1&e&&(v_(0,"tr"),v_(1,"td",11),g_(2,"span",12),m_(),m_())}var FS,GS,KS,BS,XS,HS=[{path:"home",component:DP},{path:"p3d",component:FP},{path:"plm",component:GP},{path:"jobs",component:KP},{path:"tools",component:BP},{path:"wallet",component:XP},{path:"dashboard",component:HP},{path:"footer",component:zP},{path:"campus",component:jP},{path:"login",component:eS},{path:"register",component:CS},{path:"list",component:(GS=function(){function e(t){_classCallCheck(this,e),this.accountService=t,this.users=null}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.accountService.getAll().pipe(Hd()).subscribe((function(t){return e.users=t}))}},{key:"deleteUser",value:function(e){var t=this;this.users.find((function(t){return t.id===e})).isDeleting=!0,this.accountService.delete(e).pipe(Hd()).subscribe((function(){t.users=t.users.filter((function(t){return t.id!==e}))}))}}]),e}(),GS.\u0275fac=function(e){return new(e||GS)(P_(tP))},GS.\u0275cmp=ht({type:GS,selectors:[["ng-component"]],decls:17,vars:2,consts:[["routerLink","add",1,"btn","btn-sm","btn-success","mb-2"],[1,"table","table-striped"],[2,"width","30%"],[2,"width","10%"],[4,"ngFor","ngForOf"],[4,"ngIf"],[2,"white-space","nowrap"],["routerLink","./edit",1,"btn","btn-sm","btn-primary","mr-1"],[1,"btn","btn-sm","btn-danger","btn-delete-user",3,"disabled","click"],["class","spinner-border spinner-border-sm",4,"ngIf"],[1,"spinner-border","spinner-border-sm"],["colspan","4",1,"text-center"],[1,"spinner-border","spinner-border-lg","align-center"]],template:function(e,t){1&e&&(v_(0,"h1"),B_(1,"Users"),m_(),v_(2,"a",0),B_(3,"Add User"),m_(),v_(4,"table",1),v_(5,"thead"),v_(6,"tr"),v_(7,"th",2),B_(8,"First Name"),m_(),v_(9,"th",2),B_(10,"Last Name"),m_(),v_(11,"th",2),B_(12,"Username"),m_(),g_(13,"th",3),m_(),m_(),v_(14,"tbody"),p_(15,kS,13,6,"tr",4),p_(16,DS,3,0,"tr",5),m_(),m_()),2&e&&(Ta(15),A_("ngForOf",t.users),Ta(1),A_("ngIf",!t.users))},encapsulation:2}),GS)},{path:"edit",component:(FS=function(){function e(t,r,n,a,o){_classCallCheck(this,e),this.formBuilder=t,this.route=r,this.router=n,this.accountService=a,this.alertService=o,this.loading=!1,this.submitted=!1}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.id=this.route.snapshot.params.id,this.isAddMode=!this.id;var t=[uE.minLength(6)];this.isAddMode&&t.push(uE.required),this.form=this.formBuilder.group({firstName:["",uE.required],lastName:["",uE.required],username:["",uE.required],password:["",t]}),this.isAddMode||this.accountService.getById(this.id).pipe(Hd()).subscribe((function(t){e.f.firstName.setValue(t.firstName),e.f.lastName.setValue(t.lastName),e.f.username.setValue(t.username)}))}},{key:"onSubmit",value:function(){this.submitted=!0,this.alertService.clear(),this.form.invalid||(this.loading=!0,this.isAddMode?this.createUser():this.updateUser())}},{key:"createUser",value:function(){var e=this;this.accountService.register(this.f.firstName.value,this.f.lastName.value,this.f.username.value,this.f.password.value,this.f.email.value,this.f.web.value,this.f.city.value,this.f.country.value,this.f.profesion.value,this.f.skills.value,this.f.stacks.value,this.f.birthdate.value,this.f.jobseeker.value,this.f.eosaccount.value,this.f.photo.value,this.f.gridCheck1.value,this.f.gridCheck2.value).pipe(Hd()).subscribe((function(t){e.alertService.success("User added successfully",{keepAfterRouteChange:!0}),e.router.navigate([".",{relativeTo:e.route}])}),(function(t){e.alertService.error(t),e.loading=!1}))}},{key:"updateUser",value:function(){var e=this;this.accountService.update(this.id,this.form.value).pipe(Hd()).subscribe((function(t){e.alertService.success("Update successful",{keepAfterRouteChange:!0}),e.router.navigate(["..",{relativeTo:e.route}])}),(function(t){e.alertService.error(t),e.loading=!1}))}},{key:"f",get:function(){return this.form.controls}}]),e}(),FS.\u0275fac=function(e){return new(e||FS)(P_(gu),P_(ff),P_(Op),P_(tP),P_(aP))},FS.\u0275cmp=ht({type:FS,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),FS)},{path:"register",component:CS},{path:"**",redirectTo:"home"}],jS=((KS=function e(){_classCallCheck(this,e)}).\u0275mod=Ot({type:KS}),KS.\u0275inj=Ae({factory:function(e){return new(e||KS)},imports:[[Xp.forRoot(HS)],Xp]}),KS),zS=((XS=function(){function e(t){_classCallCheck(this,e),this.accountService=t}return _createClass(e,[{key:"intercept",value:function(e,t){var r=this;return t.handle(e).pipe(Dd((function(e){return 401===e.status&&r.accountService.logout(),t=e.error.message||e.statusText,new b((function(e){return e.error(t)}));var t})))}}]),e}()).\u0275fac=function(e){return new(e||XS)(rt(tP))},XS.\u0275prov=Pe({token:XS,factory:XS.\u0275fac}),XS),QS=((BS=function(){function e(t){_classCallCheck(this,e),this.accountService=t}return _createClass(e,[{key:"intercept",value:function(e,t){var r=this.accountService.userValue,n=r&&r.token,a=e.url.startsWith("http://localhost:4001");return n&&a&&(e=e.clone({setHeaders:{Authorization:"Bearer ".concat(r.token)}})),t.handle(e)}}]),e}()).\u0275fac=function(e){return new(e||BS)(rt(tP))},BS.\u0275prov=Pe({token:BS,factory:BS.\u0275fac}),BS);JSON.parse(localStorage.getItem("users"));var VS,qS=((VS=function(){function e(t){_classCallCheck(this,e),this.accountService=t,this.user=this.accountService.userValue}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||VS)(P_(tP))},VS.\u0275cmp=ht({type:VS,selectors:[["app-header"]],decls:61,vars:1,consts:[[1,"mb-1","navbar","navbar-expand-lg","navbar-light","bg-light","lighten-1"],["id","logosup","src","../assets/logo512x512.png"],["href","#",1,"navbar-brand"],["type","button","data-toggle","collapse","data-target","#navbarSupportedContent-555","aria-controls","navbarSupportedContent-555","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarSupportedContent-555",1,"collapse","navbar-collapse"],[1,"navbar-nav","mr-auto"],[1,"nav-item"],["href","./p3d",1,"nav-link"],["href","./plm",1,"nav-link"],["href","./jobs",1,"nav-link"],["href","./tools",1,"nav-link"],["href","./wallet",1,"nav-link"],["href","./campus",1,"nav-link"],[1,"container","d-flex","flex-row-reverse"],[1,"row"],[1,"col"],[1,"btn-group"],["href","login()",1,"avatar-btn"],["href","logout()",1,"avatar-btn"],["type","button","data-toggle","dropdown",1,"dropdown-toggle","avatar-btn"],[1,"caret"],[1,"sr-only"],["role","menu",1,"dropdown-menu"],["href","./edit",1,"dropdown-item"],["href","./login",1,"dropdown-item"],["href","./register",1,"dropdown-item"],["src","assets/LogoGris.png","alt","avatar image","height","80",1,"rounded-circle","z-depth-0"]],template:function(e,t){1&e&&(v_(0,"html"),v_(1,"body"),v_(2,"nav",0),g_(3,"img",1),v_(4,"a",2),B_(5,"CADEOS.io"),m_(),v_(6,"button",3),g_(7,"span",4),m_(),v_(8,"div",5),v_(9,"ul",6),v_(10,"li",7),v_(11,"a",8),B_(12,"3D"),m_(),m_(),v_(13,"li",7),v_(14,"a",9),B_(15,"PLM"),m_(),m_(),v_(16,"li",7),v_(17,"a",10),B_(18,"JOBS"),m_(),m_(),v_(19,"li",7),v_(20,"a",11),B_(21,"TOOLS"),m_(),m_(),v_(22,"li",7),v_(23,"a",12),B_(24,"WALLET"),m_(),m_(),v_(25,"li",7),v_(26,"a",13),B_(27,"CAMPUS"),m_(),m_(),m_(),v_(28,"div",14),v_(29,"div",15),v_(30,"div",16),v_(31,"div",17),v_(32,"div",15),v_(33,"a",18),B_(34,"Login"),m_(),v_(35,"a",19),B_(36,"Logout"),m_(),v_(37,"button",20),g_(38,"span",21),g_(39,"span",22),m_(),v_(40,"ul",23),v_(41,"a",24),B_(42,"Edit Profile"),m_(),v_(43,"a",25),B_(44,"Create Project"),m_(),v_(45,"a",25),B_(46,"Upload File"),m_(),v_(47,"a",25),B_(48,"Plublish Project"),m_(),v_(49,"a",25),B_(50,"User Jobs"),m_(),v_(51,"a",25),B_(52,"User Galleries"),m_(),v_(53,"a",25),B_(54,"Configuration"),m_(),v_(55,"a",26),B_(56,"New User"),m_(),m_(),m_(),m_(),m_(),v_(57,"div",16),v_(58,"h5"),B_(59),m_(),g_(60,"img",27),m_(),m_(),m_(),m_(),m_(),m_(),m_()),2&e&&(Ta(59),H_("Hi ",t.user.username,"!"))},styles:[""]}),VS),WS=!1;try{JS=window.b4w}catch(YM){JS=self.b4w,WS=!0}if(!JS){var JS={};WS?self.b4w=JS:window.b4w=JS;var ZS={},$S={};JS.module=ZS,JS._n_module=$S;var eA={};JS.cleanup=function(e,t){t=t||"__b4w_default";var r=ZS[e];r&&(r._compiled=null),eA[t]=null},JS.register=function(e,t){ZS[e]||(ZS[e]=t)},JS.require=function(e,t){if(!ZS[e]&&!$S[e])throw new Error('Module "'+e+'" not found');return t=t||"__b4w_default",void 0!==$S[e]?$S[e](t):(eA[t]||(eA[t]=function(e){return function(t){if(!ZS[t]&&!$S[t])throw new Error('Module "'+t+'" not found');if(void 0!==$S[t])return $S[t](e);var r=ZS[t];return r._compiled||(r._compiled={}),r._compiled[e]||(r._compiled[e]={},r(r._compiled[e],eA[e])),r._compiled[e]}}(t)),eA[t](e))},JS.module_check=function(e){return void 0!==ZS[e]||void 0!==$S[e]},JS.get_namespace=function(e){for(var t in eA)if(eA[t]==e)return t;return""},JS.worker_listeners=[],JS.worker_namespaces=[]}var tA=JS,rA={},nA=function(e,t,r){var n={},a="__"==e.split("").slice(0,2).join("");function o(){return function(e){return void 0!==n[e=e||"__b4w_default"]||(n[e]=a?{}:o(),t(e,n[e])),n[e]}}if(void 0!==rA[e])return rA[e];var _=a?o():o()();return tA._n_module[e]=rA[e]=_,_},aA="undefined"!=typeof Float32Array?Float32Array:Array;function oA(){var e=new aA(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function _A(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function iA(e){var t=new aA(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function sA(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function lA(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function cA(e,t){if(t===e){var r=e[1],n=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function EA(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],_=e[4],i=e[5],s=e[6],l=e[7],c=e[8],E=c*_-i*l,u=-c*o+i*s,d=l*o-_*s,T=r*E+n*u+a*d;return T?(t[0]=E*(T=1/T),t[1]=(-c*n+a*l)*T,t[2]=(i*n-a*_)*T,t[3]=u*T,t[4]=(c*r-a*s)*T,t[5]=(-i*r+a*o)*T,t[6]=d*T,t[7]=(-l*r+n*s)*T,t[8]=(_*r-n*o)*T,t):null}function uA(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],_=e[4],i=e[5],s=e[6],l=e[7],c=e[8];return t[0]=_*c-i*l,t[1]=a*l-n*c,t[2]=n*i-a*_,t[3]=i*s-o*c,t[4]=r*c-a*s,t[5]=a*o-r*i,t[6]=o*l-_*s,t[7]=n*s-r*l,t[8]=r*_-n*o,t}function dA(e){var t=e[3],r=e[4],n=e[5],a=e[6],o=e[7],_=e[8];return e[0]*(_*r-n*o)+e[1]*(-_*t+n*a)+e[2]*(o*t-r*a)}function TA(e,t,r){var n=e[0],a=e[1],o=e[2],_=e[3],i=e[4],s=e[5],l=e[6],c=e[7],E=e[8],u=t[0],d=t[1],T=t[2],f=t[3],p=t[4],P=t[5],S=t[6],A=t[7],h=t[8];return r[0]=u*n+d*_+T*l,r[1]=u*a+d*i+T*c,r[2]=u*o+d*s+T*E,r[3]=f*n+p*_+P*l,r[4]=f*a+p*i+P*c,r[5]=f*o+p*s+P*E,r[6]=S*n+A*_+h*l,r[7]=S*a+A*i+h*c,r[8]=S*o+A*s+h*E,r}function fA(e,t,r){var n=e[0],a=e[1],o=e[2],_=e[3],i=e[4],s=e[5],l=e[6],c=e[7],E=e[8],u=t[0],d=t[1];return r[0]=n,r[1]=a,r[2]=o,r[3]=_,r[4]=i,r[5]=s,r[6]=u*n+d*_+l,r[7]=u*a+d*i+c,r[8]=u*o+d*s+E,r}function pA(e,t,r){var n=e[0],a=e[1],o=e[2],_=e[3],i=e[4],s=e[5],l=e[6],c=e[7],E=e[8],u=Math.sin(t),d=Math.cos(t);return r[0]=d*n+u*_,r[1]=d*a+u*i,r[2]=d*o+u*s,r[3]=d*_-u*n,r[4]=d*i-u*a,r[5]=d*s-u*o,r[6]=l,r[7]=c,r[8]=E,r}function PA(e,t,r){var n=t[0],a=t[1];return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=a*e[3],r[4]=a*e[4],r[5]=a*e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r}function SA(e,t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function AA(e,t){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function hA(e,t){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function vA(e,t){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function mA(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],_=r+r,i=n+n,s=a+a,l=r*_,c=n*_,E=n*i,u=a*_,d=a*i,T=a*s,f=o*_,p=o*i,P=o*s;return t[0]=1-E-T,t[3]=c-P,t[6]=u+p,t[1]=c+P,t[4]=1-l-T,t[7]=d-f,t[2]=u-p,t[5]=d+f,t[8]=1-l-E,t}function gA(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],_=e[4],i=e[5],s=e[6],l=e[7],c=e[8],E=e[9],u=e[10],d=e[11],T=e[12],f=e[13],p=e[14],P=e[15],S=r*i-n*_,A=r*s-a*_,h=r*l-o*_,v=n*s-a*i,m=n*l-o*i,g=a*l-o*s,O=c*f-E*T,N=c*p-u*T,R=c*P-d*T,I=E*p-u*f,b=E*P-d*f,y=u*P-d*p,L=S*y-A*b+h*I+v*R-m*N+g*O;return L?(t[0]=(i*y-s*b+l*I)*(L=1/L),t[1]=(s*R-_*y-l*N)*L,t[2]=(_*b-i*R+l*O)*L,t[3]=(a*b-n*y-o*I)*L,t[4]=(r*y-a*R+o*N)*L,t[5]=(n*R-r*b-o*O)*L,t[6]=(f*g-p*m+P*v)*L,t[7]=(p*h-T*g-P*A)*L,t[8]=(T*m-f*h+P*S)*L,t):null}function OA(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function NA(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))}Math;var RA="undefined"!=typeof Float32Array?Float32Array:Array;function IA(){var e=new RA(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function bA(e){var t=new RA(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function yA(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function LA(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function YA(e,t){if(t===e){var r=e[1],n=e[2],a=e[3],o=e[6],_=e[7],i=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=a,t[13]=_,t[14]=i}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function MA(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],_=e[4],i=e[5],s=e[6],l=e[7],c=e[8],E=e[9],u=e[10],d=e[11],T=e[12],f=e[13],p=e[14],P=e[15],S=r*i-n*_,A=r*s-a*_,h=r*l-o*_,v=n*s-a*i,m=n*l-o*i,g=a*l-o*s,O=c*f-E*T,N=c*p-u*T,R=c*P-d*T,I=E*p-u*f,b=E*P-d*f,y=u*P-d*p,L=S*y-A*b+h*I+v*R-m*N+g*O;return L?(t[0]=(i*y-s*b+l*I)*(L=1/L),t[1]=(a*b-n*y-o*I)*L,t[2]=(f*g-p*m+P*v)*L,t[3]=(u*m-E*g-d*v)*L,t[4]=(s*R-_*y-l*N)*L,t[5]=(r*y-a*R+o*N)*L,t[6]=(p*h-T*g-P*A)*L,t[7]=(c*g-u*h+d*A)*L,t[8]=(_*b-i*R+l*O)*L,t[9]=(n*R-r*b-o*O)*L,t[10]=(T*m-f*h+P*S)*L,t[11]=(E*h-c*m-d*S)*L,t[12]=(i*N-_*I-s*O)*L,t[13]=(r*I-n*N+a*O)*L,t[14]=(f*A-T*v-p*S)*L,t[15]=(c*v-E*A+u*S)*L,t):null}function xA(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],_=e[4],i=e[5],s=e[6],l=e[7],c=e[8],E=e[9],u=e[10],d=e[11],T=e[12],f=e[13],p=e[14],P=e[15];return t[0]=i*(u*P-d*p)-E*(s*P-l*p)+f*(s*d-l*u),t[1]=-(n*(u*P-d*p)-E*(a*P-o*p)+f*(a*d-o*u)),t[2]=n*(s*P-l*p)-i*(a*P-o*p)+f*(a*l-o*s),t[3]=-(n*(s*d-l*u)-i*(a*d-o*u)+E*(a*l-o*s)),t[4]=-(_*(u*P-d*p)-c*(s*P-l*p)+T*(s*d-l*u)),t[5]=r*(u*P-d*p)-c*(a*P-o*p)+T*(a*d-o*u),t[6]=-(r*(s*P-l*p)-_*(a*P-o*p)+T*(a*l-o*s)),t[7]=r*(s*d-l*u)-_*(a*d-o*u)+c*(a*l-o*s),t[8]=_*(E*P-d*f)-c*(i*P-l*f)+T*(i*d-l*E),t[9]=-(r*(E*P-d*f)-c*(n*P-o*f)+T*(n*d-o*E)),t[10]=r*(i*P-l*f)-_*(n*P-o*f)+T*(n*l-o*i),t[11]=-(r*(i*d-l*E)-_*(n*d-o*E)+c*(n*l-o*i)),t[12]=-(_*(E*p-u*f)-c*(i*p-s*f)+T*(i*u-s*E)),t[13]=r*(E*p-u*f)-c*(n*p-a*f)+T*(n*u-a*E),t[14]=-(r*(i*p-s*f)-_*(n*p-a*f)+T*(n*s-a*i)),t[15]=r*(i*u-s*E)-_*(n*u-a*E)+c*(n*s-a*i),t}function CA(e){var t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],_=e[5],i=e[6],s=e[7],l=e[8],c=e[9],E=e[10],u=e[11],d=e[12],T=e[13],f=e[14],p=e[15];return(t*_-r*o)*(E*p-u*f)-(t*i-n*o)*(c*p-u*T)+(t*s-a*o)*(c*f-E*T)+(r*i-n*_)*(l*p-u*d)-(r*s-a*_)*(l*f-E*d)+(n*s-a*i)*(l*T-c*d)}function wA(e,t,r){var n=e[0],a=e[1],o=e[2],_=e[3],i=e[4],s=e[5],l=e[6],c=e[7],E=e[8],u=e[9],d=e[10],T=e[11],f=e[12],p=e[13],P=e[14],S=e[15],A=t[0],h=t[1],v=t[2],m=t[3];return r[0]=A*n+h*i+v*E+m*f,r[1]=A*a+h*s+v*u+m*p,r[2]=A*o+h*l+v*d+m*P,r[3]=A*_+h*c+v*T+m*S,r[4]=(A=t[4])*n+(h=t[5])*i+(v=t[6])*E+(m=t[7])*f,r[5]=A*a+h*s+v*u+m*p,r[6]=A*o+h*l+v*d+m*P,r[7]=A*_+h*c+v*T+m*S,r[8]=(A=t[8])*n+(h=t[9])*i+(v=t[10])*E+(m=t[11])*f,r[9]=A*a+h*s+v*u+m*p,r[10]=A*o+h*l+v*d+m*P,r[11]=A*_+h*c+v*T+m*S,r[12]=(A=t[12])*n+(h=t[13])*i+(v=t[14])*E+(m=t[15])*f,r[13]=A*a+h*s+v*u+m*p,r[14]=A*o+h*l+v*d+m*P,r[15]=A*_+h*c+v*T+m*S,r}function UA(e,t,r){var n,a,o,_,i,s,l,c,E,u,d,T,f=t[0],p=t[1],P=t[2];return e===r?(r[12]=e[0]*f+e[4]*p+e[8]*P+e[12],r[13]=e[1]*f+e[5]*p+e[9]*P+e[13],r[14]=e[2]*f+e[6]*p+e[10]*P+e[14],r[15]=e[3]*f+e[7]*p+e[11]*P+e[15]):(a=e[1],o=e[2],_=e[3],i=e[4],s=e[5],l=e[6],c=e[7],E=e[8],u=e[9],d=e[10],T=e[11],r[0]=n=e[0],r[1]=a,r[2]=o,r[3]=_,r[4]=i,r[5]=s,r[6]=l,r[7]=c,r[8]=E,r[9]=u,r[10]=d,r[11]=T,r[12]=n*f+i*p+E*P+e[12],r[13]=a*f+s*p+u*P+e[13],r[14]=o*f+l*p+d*P+e[14],r[15]=_*f+c*p+T*P+e[15]),r}function kA(e,t,r){var n=t[0],a=t[1],o=t[2];return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*a,r[5]=e[5]*a,r[6]=e[6]*a,r[7]=e[7]*a,r[8]=e[8]*o,r[9]=e[9]*o,r[10]=e[10]*o,r[11]=e[11]*o,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function DA(e,t,r,n){var a,o,_,i,s,l,c,E,u,d,T,f,p,P,S,A,h,v,m,g,O,N,R,I,b=r[0],y=r[1],L=r[2],Y=Math.sqrt(b*b+y*y+L*L);return Math.abs(Y)<1e-7?null:(b*=Y=1/Y,y*=Y,L*=Y,a=Math.sin(t),o=Math.cos(t),s=e[1],l=e[2],c=e[3],u=e[5],d=e[6],T=e[7],p=e[9],P=e[10],S=e[11],m=b*y*(_=1-o)-L*a,g=y*y*_+o,O=L*y*_+b*a,N=b*L*_+y*a,R=y*L*_-b*a,I=L*L*_+o,n[0]=(i=e[0])*(A=b*b*_+o)+(E=e[4])*(h=y*b*_+L*a)+(f=e[8])*(v=L*b*_-y*a),n[1]=s*A+u*h+p*v,n[2]=l*A+d*h+P*v,n[3]=c*A+T*h+S*v,n[4]=i*m+E*g+f*O,n[5]=s*m+u*g+p*O,n[6]=l*m+d*g+P*O,n[7]=c*m+T*g+S*O,n[8]=i*N+E*R+f*I,n[9]=s*N+u*R+p*I,n[10]=l*N+d*R+P*I,n[11]=c*N+T*R+S*I,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n)}function FA(e,t,r){var n=Math.sin(t),a=Math.cos(t),o=e[4],_=e[5],i=e[6],s=e[7],l=e[8],c=e[9],E=e[10],u=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=o*a+l*n,r[5]=_*a+c*n,r[6]=i*a+E*n,r[7]=s*a+u*n,r[8]=l*a-o*n,r[9]=c*a-_*n,r[10]=E*a-i*n,r[11]=u*a-s*n,r}function GA(e,t,r){var n=Math.sin(t),a=Math.cos(t),o=e[0],_=e[1],i=e[2],s=e[3],l=e[8],c=e[9],E=e[10],u=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=o*a-l*n,r[1]=_*a-c*n,r[2]=i*a-E*n,r[3]=s*a-u*n,r[8]=o*n+l*a,r[9]=_*n+c*a,r[10]=i*n+E*a,r[11]=s*n+u*a,r}function KA(e,t,r){var n=Math.sin(t),a=Math.cos(t),o=e[0],_=e[1],i=e[2],s=e[3],l=e[4],c=e[5],E=e[6],u=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=o*a+l*n,r[1]=_*a+c*n,r[2]=i*a+E*n,r[3]=s*a+u*n,r[4]=l*a-o*n,r[5]=c*a-_*n,r[6]=E*a-i*n,r[7]=u*a-s*n,r}function BA(e,t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function XA(e,t){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function HA(e,t,r){var n,a,o,_=t[0],i=t[1],s=t[2],l=Math.sqrt(_*_+i*i+s*s);return Math.abs(l)<1e-7?null:(_*=l=1/l,i*=l,s*=l,n=Math.sin(e),a=Math.cos(e),r[0]=_*_*(o=1-a)+a,r[1]=i*_*o+s*n,r[2]=s*_*o-i*n,r[3]=0,r[4]=_*i*o-s*n,r[5]=i*i*o+a,r[6]=s*i*o+_*n,r[7]=0,r[8]=_*s*o+i*n,r[9]=i*s*o-_*n,r[10]=s*s*o+a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function jA(e,t){var r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function zA(e,t){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function QA(e,t){var r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function VA(e,t,r){var n=e[0],a=e[1],o=e[2],_=e[3],i=n+n,s=a+a,l=o+o,c=n*i,E=n*s,u=n*l,d=a*s,T=a*l,f=o*l,p=_*i,P=_*s,S=_*l;return r[0]=1-(d+f),r[1]=E+S,r[2]=u-P,r[3]=0,r[4]=E-S,r[5]=1-(c+f),r[6]=T+p,r[7]=0,r[8]=u+P,r[9]=T-p,r[10]=1-(c+d),r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r}function qA(e,t,r,n){var a=e[0],o=e[1],_=e[2],i=e[3],s=a+a,l=o+o,c=_+_,E=a*s,u=a*l,d=a*c,T=o*l,f=o*c,p=_*c,P=i*s,S=i*l,A=i*c,h=r[0],v=r[1],m=r[2];return n[0]=(1-(T+p))*h,n[1]=(u+A)*h,n[2]=(d-S)*h,n[3]=0,n[4]=(u-A)*v,n[5]=(1-(E+p))*v,n[6]=(f+P)*v,n[7]=0,n[8]=(d+S)*m,n[9]=(f-P)*m,n[10]=(1-(E+T))*m,n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n}function WA(e,t,r,n,a){var o=e[0],_=e[1],i=e[2],s=e[3],l=o+o,c=_+_,E=i+i,u=o*l,d=o*c,T=o*E,f=_*c,p=_*E,P=i*E,S=s*l,A=s*c,h=s*E,v=r[0],m=r[1],g=r[2],O=n[0],N=n[1],R=n[2];return a[0]=(1-(f+P))*v,a[1]=(d+h)*v,a[2]=(T-A)*v,a[3]=0,a[4]=(d-h)*m,a[5]=(1-(u+P))*m,a[6]=(p+S)*m,a[7]=0,a[8]=(T+A)*g,a[9]=(p-S)*g,a[10]=(1-(u+f))*g,a[11]=0,a[12]=t[0]+O-(a[0]*O+a[4]*N+a[8]*R),a[13]=t[1]+N-(a[1]*O+a[5]*N+a[9]*R),a[14]=t[2]+R-(a[2]*O+a[6]*N+a[10]*R),a[15]=1,a}function JA(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],_=r+r,i=n+n,s=a+a,l=r*_,c=n*_,E=n*i,u=a*_,d=a*i,T=a*s,f=o*_,p=o*i,P=o*s;return t[0]=1-E-T,t[1]=c+P,t[2]=u-p,t[3]=0,t[4]=c-P,t[5]=1-l-T,t[6]=d+f,t[7]=0,t[8]=u+p,t[9]=d-f,t[10]=1-l-E,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ZA(e,t,r,n,a,o,_){var i=1/(t-e),s=1/(n-r),l=1/(a-o);return _[0]=2*a*i,_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[5]=2*a*s,_[6]=0,_[7]=0,_[8]=(t+e)*i,_[9]=(n+r)*s,_[10]=(o+a)*l,_[11]=-1,_[12]=0,_[13]=0,_[14]=o*a*2*l,_[15]=0,_}function $A(e,t,r,n,a){var o=1/Math.tan(e/2),_=1/(r-n);return a[0]=o/t,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=o,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(n+r)*_,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*n*r*_,a[15]=0,a}function eh(e,t,r,n){var a=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),_=Math.tan(e.leftDegrees*Math.PI/180),i=Math.tan(e.rightDegrees*Math.PI/180),s=2/(_+i),l=2/(a+o);return n[0]=s,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=l,n[6]=0,n[7]=0,n[8]=-(_-i)*s*.5,n[9]=(a-o)*l*.5,n[10]=r/(t-r),n[11]=-1,n[12]=0,n[13]=0,n[14]=r*t/(t-r),n[15]=0,n}function th(e,t,r,n,a,o,_){var i=1/(e-t),s=1/(r-n),l=1/(a-o);return _[0]=-2*i,_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[5]=-2*s,_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[10]=2*l,_[11]=0,_[12]=(e+t)*i,_[13]=(n+r)*s,_[14]=(o+a)*l,_[15]=1,_}function rh(e,t,r,n){var a,o,_,i,s,l,c,E,u,d,T=e[0],f=e[1],p=e[2],P=r[0],S=r[1],A=r[2],h=t[0],v=t[1],m=t[2];return Math.abs(T-h)<1e-7&&Math.abs(f-v)<1e-7&&Math.abs(p-m)<1e-7?LA(n):(c=T-h,E=f-v,u=p-m,a=S*(u*=d=1/Math.sqrt(c*c+E*E+u*u))-A*(E*=d),o=A*(c*=d)-P*u,_=P*E-S*c,(d=Math.sqrt(a*a+o*o+_*_))?(a*=d=1/d,o*=d,_*=d):(a=0,o=0,_=0),i=E*_-u*o,s=u*a-c*_,l=c*o-E*a,(d=Math.sqrt(i*i+s*s+l*l))?(i*=d=1/d,s*=d,l*=d):(i=0,s=0,l=0),n[0]=a,n[1]=i,n[2]=c,n[3]=0,n[4]=o,n[5]=s,n[6]=E,n[7]=0,n[8]=_,n[9]=l,n[10]=u,n[11]=0,n[12]=-(a*T+o*f+_*p),n[13]=-(i*T+s*f+l*p),n[14]=-(c*T+E*f+u*p),n[15]=1,n)}function nh(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function ah(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}Math;var oh="undefined"!=typeof Float32Array?Float32Array:Array,_h=Math.random;function ih(){var e=new oh(3);return e[0]=0,e[1]=0,e[2]=0,e}function sh(e){var t=new oh(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function lh(e,t,r){var n=new oh(3);return n[0]=e,n[1]=t,n[2]=r,n}function ch(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Eh(e,t,r,n){return n[0]=e,n[1]=t,n[2]=r,n}function uh(e,t,r){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function dh(e,t,r){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r}function Th(e,t,r){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r}function fh(e,t,r){return r[0]=e[0]/t[0],r[1]=e[1]/t[1],r[2]=e[2]/t[2],r}function ph(e,t,r){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r}function Ph(e,t,r){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r}function Sh(e,t,r){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r}function Ah(e,t,r,n){return n[0]=e[0]+t[0]*r,n[1]=e[1]+t[1]*r,n[2]=e[2]+t[2]*r,n}function hh(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2];return Math.sqrt(r*r+n*n+a*a)}function vh(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2];return r*r+n*n+a*a}function mh(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function gh(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function Oh(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Nh(e,t){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Rh(e,t){var r=e[0],n=e[1],a=e[2],o=r*r+n*n+a*a;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function Ih(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function bh(e,t,r){var n=e[0],a=e[1],o=e[2],_=t[0],i=t[1],s=t[2];return r[0]=a*s-o*i,r[1]=o*_-n*s,r[2]=n*i-a*_,r}function yh(e,t,r,n){var a=e[0],o=e[1],_=e[2];return n[0]=a+r*(t[0]-a),n[1]=o+r*(t[1]-o),n[2]=_+r*(t[2]-_),n}function Lh(e,t,r,n,a,o){var _=a*a,i=_*(2*a-3)+1,s=_*(a-2)+a,l=_*(a-1),c=_*(3-2*a);return o[0]=e[0]*i+t[0]*s+r[0]*l+n[0]*c,o[1]=e[1]*i+t[1]*s+r[1]*l+n[1]*c,o[2]=e[2]*i+t[2]*s+r[2]*l+n[2]*c,o}function Yh(e,t,r,n,a,o){var _=1-a,i=_*_,s=a*a,l=i*_,c=3*a*i,E=3*s*_,u=s*a;return o[0]=e[0]*l+t[0]*c+r[0]*E+n[0]*u,o[1]=e[1]*l+t[1]*c+r[1]*E+n[1]*u,o[2]=e[2]*l+t[2]*c+r[2]*E+n[2]*u,o}function Mh(e,t){var r=2*_h()*Math.PI,n=2*_h()-1,a=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t[2]=n*e,t}function xh(e,t,r){var n=e[0],a=e[1],o=e[2],_=t[3]*n+t[7]*a+t[11]*o+t[15];return r[0]=(t[0]*n+t[4]*a+t[8]*o+t[12])/(_=_||1),r[1]=(t[1]*n+t[5]*a+t[9]*o+t[13])/_,r[2]=(t[2]*n+t[6]*a+t[10]*o+t[14])/_,r}function Ch(e,t,r){var n=e[0],a=e[1],o=e[2];return r[0]=n*t[0]+a*t[3]+o*t[6],r[1]=n*t[1]+a*t[4]+o*t[7],r[2]=n*t[2]+a*t[5]+o*t[8],r}function wh(e,t,r){var n=e[0],a=e[1],o=e[2],_=t[0],i=t[1],s=t[2],l=t[3],c=l*n+i*o-s*a,E=l*a+s*n-_*o,u=l*o+_*a-i*n,d=-_*n-i*a-s*o;return r[0]=c*l+d*-_+E*-s-u*-i,r[1]=E*l+d*-i+u*-_-c*-s,r[2]=u*l+d*-s+c*-i-E*-_,r}function Uh(e,t,r,n){var a=[],o=[];return a[0]=e[0]-t[0],a[1]=e[1]-t[1],a[2]=e[2]-t[2],o[0]=a[0],o[1]=a[1]*Math.cos(r)-a[2]*Math.sin(r),o[2]=a[1]*Math.sin(r)+a[2]*Math.cos(r),n[0]=o[0]+t[0],n[1]=o[1]+t[1],n[2]=o[2]+t[2],n}function kh(e,t,r,n){var a=[],o=[];return a[0]=e[0]-t[0],a[1]=e[1]-t[1],a[2]=e[2]-t[2],o[0]=a[2]*Math.sin(r)+a[0]*Math.cos(r),o[1]=a[1],o[2]=a[2]*Math.cos(r)-a[0]*Math.sin(r),n[0]=o[0]+t[0],n[1]=o[1]+t[1],n[2]=o[2]+t[2],n}function Dh(e,t,r,n){var a=[],o=[];return a[0]=e[0]-t[0],a[1]=e[1]-t[1],a[2]=e[2]-t[2],o[0]=a[0]*Math.cos(r)-a[1]*Math.sin(r),o[1]=a[0]*Math.sin(r)+a[1]*Math.cos(r),o[2]=a[2],n[0]=o[0]+t[0],n[1]=o[1]+t[1],n[2]=o[2]+t[2],n}var Fh,Gh=(Fh=ih(),function(e,t,r,n,a,o){var _,i;for(t||(t=3),r||(r=0),i=n?Math.min(n*t+r,e.length):e.length,_=r;_<i;_+=t)Fh[0]=e[_],Fh[1]=e[_+1],Fh[2]=e[_+2],a(Fh,o,Fh),e[_]=Fh[0],e[_+1]=Fh[1],e[_+2]=Fh[2];return e});function Kh(e,t){var r=lh(e[0],e[1],e[2]),n=lh(t[0],t[1],t[2]);Rh(r,r),Rh(n,n);var a=Ih(r,n);return a>1?0:Math.acos(a)}function Bh(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}var Xh=new Float32Array(3),Hh=new Float32Array(9),jh=new Float32Array(9),zh=new Float32Array(9),Qh=new Float32Array(9);function Vh(e,t){return(t=t||new Float32Array(3))[0]=e[3],t[1]=e[4],t[2]=e[5],t}function qh(e,t){return ch(e,t=t||new Float32Array(3))}function Wh(e,t){ch(t,e)}function Jh(e,t){Rh(t,Xh),e[3]=Xh[0],e[4]=Xh[1],e[5]=Xh[2]}function Zh(e,t,r){return(r=r||new Float32Array(3))[0]=e[0]+e[3]*t,r[1]=e[1]+e[4]*t,r[2]=e[2]+e[5]*t,r}function $h(e,t){for(var r=e[1],n=1,a=2;a<e.length;a++)4!=a&&8!=a&&Math.abs(e[a])>Math.abs(r)&&(r=e[a],n=a);var o=Math.floor(n/3),_=n%3,i=.5*Math.atan(2*r/(e[3*o+o]-e[3*_+_]));for(a=0;a<t.length;a++)t[a]=0==a||4==a||8==a?1:0;return t[_+3*o]=-Math.sin(i),t[o+3*_]=Math.sin(i),t[o+3*o]=Math.cos(i),t[_+3*_]=Math.cos(i),t}function ev(e){return Math.sqrt(e[1]*e[1]+e[2]*e[2]+e[5]*e[5])}function tv(e,t){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]}function rv(e,t){e.content.push(t),nv(e,e.content.length-1)}function nv(e,t){for(var r=e.content[t];t>0;){var n=(t+1>>1)-1,a=e.content[n];if(!(e.score_function(r)<e.score_function(a)))break;e.content[n]=r,e.content[t]=a,t=n}}function av(e,t){nv(e,e.content.indexOf(t))}function ov(e,t){for(var r=e.content.length,n=e.content[t],a=e.score_function(n);;){var o=t+1<<1,_=o-1,i=null;if(_<r){var s=e.score_function(e.content[_]);s<a&&(i=_)}if(o<r&&e.score_function(e.content[o])<(null===i?a:s)&&(i=o),null===i)break;e.content[t]=e.content[i],e.content[i]=n,t=i}}function _v(e,t,r,n){return r*e/n+t}function iv(e,t,r,n){return r*(e/=n)*e+t}function sv(e,t,r,n){return-r*(e/=n)*(e-2)+t}function lv(e,t,r,n){return(e/=n/2)<1?r/2*e*e+t:-r/2*(--e*(e-2)-1)+t}function cv(e,t,r,n){return r*(e/=n)*e*e+t}function Ev(e,t,r,n){return r*((e=e/n-1)*e*e+1)+t}function uv(e,t,r,n){return(e/=n/2)<1?r/2*e*e*e+t:r/2*((e-=2)*e*e+2)+t}function dv(e,t,r,n){return r*(e/=n)*e*e*e+t}function Tv(e,t,r,n){return-r*((e=e/n-1)*e*e*e-1)+t}function fv(e,t,r,n){return(e/=n/2)<1?r/2*e*e*e*e+t:-r/2*((e-=2)*e*e*e-2)+t}function pv(e,t,r,n){return r*(e/=n)*e*e*e*e+t}function Pv(e,t,r,n){return r*((e=e/n-1)*e*e*e*e+1)+t}function Sv(e,t,r,n){return(e/=n/2)<1?r/2*e*e*e*e*e+t:r/2*((e-=2)*e*e*e*e+2)+t}function Av(e,t,r,n){return-r*Math.cos(e/n*(Math.PI/2))+r+t}function hv(e,t,r,n){return r*Math.sin(e/n*(Math.PI/2))+t}function vv(e,t,r,n){return-r/2*(Math.cos(Math.PI*e/n)-1)+t}function mv(e,t,r,n){return 0==e?t:r*Math.pow(2,10*(e/n-1))+t}function gv(e,t,r,n){return e==n?t+r:r*(1-Math.pow(2,-10*e/n))+t}function Ov(e,t,r,n){return 0==e?t:e==n?t+r:(e/=n/2)<1?r/2*Math.pow(2,10*(e-1))+t:r/2*(2-Math.pow(2,-10*--e))+t}function Nv(e,t,r,n){return-r*(Math.sqrt(1-(e/=n)*e)-1)+t}function Rv(e,t,r,n){return r*Math.sqrt(1-(e=e/n-1)*e)+t}function Iv(e,t,r,n){return(e/=n/2)<1?-r/2*(Math.sqrt(1-e*e)-1)+t:r/2*(Math.sqrt(1-(e-=2)*e)+1)+t}function bv(e,t,r,n){var a=1.70158,o=0,_=r;return 0==e?t:1==(e/=n)?t+r:(o||(o=.3*n),_<Math.abs(r)?(_=r,a=o/4):a=o/(2*Math.PI)*Math.asin(r/_),-_*Math.pow(2,10*(e-=1))*Math.sin((e*n-a)*(2*Math.PI)/o)+t)}function yv(e,t,r,n){var a=1.70158,o=0,_=r;return 0==e?t:1==(e/=n)?t+r:(o||(o=.3*n),_<Math.abs(r)?(_=r,a=o/4):a=o/(2*Math.PI)*Math.asin(r/_),_*Math.pow(2,-10*e)*Math.sin((e*n-a)*(2*Math.PI)/o)+r+t)}function Lv(e,t,r,n){var a=1.70158,o=0,_=r;return 0==e?t:2==(e/=n/2)?t+r:(o||(o=n*(.3*1.5)),_<Math.abs(r)?(_=r,a=o/4):a=o/(2*Math.PI)*Math.asin(r/_),e<1?_*Math.pow(2,10*(e-=1))*Math.sin((e*n-a)*(2*Math.PI)/o)*-.5+t:_*Math.pow(2,-10*(e-=1))*Math.sin((e*n-a)*(2*Math.PI)/o)*.5+r+t)}function Yv(e,t,r,n,a){return null==a&&(a=1.70158),r*(e/=n)*e*((a+1)*e-a)+t}function Mv(e,t,r,n,a){return null==a&&(a=1.70158),r*((e=e/n-1)*e*((a+1)*e+a)+1)+t}function xv(e,t,r,n,a){return null==a&&(a=1.70158),(e/=n/2)<1?r/2*(e*e*((1+(a*=1.525))*e-a))+t:r/2*((e-=2)*e*((1+(a*=1.525))*e+a)+2)+t}function Cv(e,t,r,n){return r-wv(n-e,0,r,n)+t}function wv(e,t,r,n){return(e/=n)<1/2.75?r*(7.5625*e*e)+t:e<2/2.75?r*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?r*(7.5625*(e-=2.25/2.75)*e+.9375)+t:r*(7.5625*(e-=2.625/2.75)*e+.984375)+t}function Uv(e,t,r,n){return e<n/2?.5*Cv(2*e,0,r,n)+t:.5*wv(2*e-n,0,r,n)+.5*r+t}var kv="undefined"!=typeof Float32Array?Float32Array:Array,Dv=Math.random;function Fv(){var e=new kv(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Gv(e){var t=new kv(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Kv(e,t,r,n){var a=new kv(4);return a[0]=e,a[1]=t,a[2]=r,a[3]=n,a}function Bv(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Xv(e,t,r,n,a){return a[0]=e,a[1]=t,a[2]=r,a[3]=n,a}function Hv(e,t,r){return r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r[3]=e[3]+t[3],r}function jv(e,t,r){return r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=e[2]-t[2],r[3]=e[3]-t[3],r}function zv(e,t,r){return r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r[3]=e[3]*t[3],r}function Qv(e,t,r){return r[0]=e[0]/t[0],r[1]=e[1]/t[1],r[2]=e[2]/t[2],r[3]=e[3]/t[3],r}function Vv(e,t,r){return r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.min(e[2],t[2]),r[3]=Math.min(e[3],t[3]),r}function qv(e,t,r){return r[0]=Math.max(e[0],t[0]),r[1]=Math.max(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r[3]=Math.max(e[3],t[3]),r}function Wv(e,t,r){return r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t,r[3]=e[3]*t,r}function Jv(e,t,r,n){return n[0]=e[0]+t[0]*r,n[1]=e[1]+t[1]*r,n[2]=e[2]+t[2]*r,n[3]=e[3]+t[3]*r,n}function Zv(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(r*r+n*n+a*a+o*o)}function $v(e,t){var r=t[0]-e[0],n=t[1]-e[1],a=t[2]-e[2],o=t[3]-e[3];return r*r+n*n+a*a+o*o}function em(e){var t=e[0],r=e[1],n=e[2],a=e[3];return Math.sqrt(t*t+r*r+n*n+a*a)}function tm(e){var t=e[0],r=e[1],n=e[2],a=e[3];return t*t+r*r+n*n+a*a}function rm(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function nm(e,t){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function am(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],_=r*r+n*n+a*a+o*o;return _>0&&(_=1/Math.sqrt(_),t[0]=r*_,t[1]=n*_,t[2]=a*_,t[3]=o*_),t}function om(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function _m(e,t,r,n){var a=e[0],o=e[1],_=e[2],i=e[3];return n[0]=a+r*(t[0]-a),n[1]=o+r*(t[1]-o),n[2]=_+r*(t[2]-_),n[3]=i+r*(t[3]-i),n}function im(e,t){return t[0]=Dv(),t[1]=Dv(),t[2]=Dv(),t[3]=Dv(),am(t,t),e(t,e,t),t}function sm(e,t,r){var n=e[0],a=e[1],o=e[2],_=e[3];return r[0]=t[0]*n+t[4]*a+t[8]*o+t[12]*_,r[1]=t[1]*n+t[5]*a+t[9]*o+t[13]*_,r[2]=t[2]*n+t[6]*a+t[10]*o+t[14]*_,r[3]=t[3]*n+t[7]*a+t[11]*o+t[15]*_,r}function lm(e,t,r){var n=e[0],a=e[1],o=e[2],_=t[0],i=t[1],s=t[2],l=t[3],c=l*n+i*o-s*a,E=l*a+s*n-_*o,u=l*o+_*a-i*n,d=-_*n-i*a-s*o;return r[0]=c*l+d*-_+E*-s-u*-i,r[1]=E*l+d*-i+u*-_-c*-s,r[2]=u*l+d*-s+c*-i-E*-_,r[3]=e[3],r}var cm=function(){var e=Fv();return function(t,r,n,a,o,_){var i,s;for(r||(r=4),n||(n=0),s=a?Math.min(a*r+n,t.length):t.length,i=n;i<s;i+=r)e[0]=t[i],e[1]=t[i+1],e[2]=t[i+2],e[3]=t[i+3],o(e,_,e),t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=e[3];return t}}();function Em(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var um="undefined"!=typeof Float32Array?Float32Array:Array;function dm(){var e=new um(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}Math;var Tm,fm,pm,Pm,Sm=(Tm=ih(),fm=lh(1,0,0),pm=lh(0,1,0),function(e,t,r){var n=Ih(e,t);return n<-.9999999?(bh(fm,e,Tm),mh(Tm)<1e-6&&bh(pm,e,Tm),Rh(Tm,Tm),vm(Tm,Math.PI,r),r):n>.9999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(bh(e,t,Tm),r[0]=Tm[0],r[1]=Tm[1],r[2]=Tm[2],r[3]=1+n,am(r,r))}),Am=(Pm=oA(),function(e,t,r,n){return Pm[0]=t[0],Pm[3]=t[1],Pm[6]=t[2],Pm[1]=r[0],Pm[4]=r[1],Pm[7]=r[2],Pm[2]=-e[0],Pm[5]=-e[1],Pm[8]=-e[2],am(xm(Pm,n),n)});function hm(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function vm(e,t,r){t*=.5;var n=Math.sin(t);return r[0]=n*e[0],r[1]=n*e[1],r[2]=n*e[2],r[3]=Math.cos(t),r}function mm(e,t,r){var n=e[0],a=e[1],o=e[2],_=e[3],i=t[0],s=t[1],l=t[2],c=t[3];return r[0]=n*c+_*i+a*l-o*s,r[1]=a*c+_*s+o*i-n*l,r[2]=o*c+_*l+n*s-a*i,r[3]=_*c-n*i-a*s-o*l,r}function gm(e,t,r){t*=.5;var n=e[0],a=e[1],o=e[2],_=e[3],i=Math.sin(t),s=Math.cos(t);return r[0]=n*s+_*i,r[1]=a*s+o*i,r[2]=o*s-a*i,r[3]=_*s-n*i,r}function Om(e,t,r){t*=.5;var n=e[0],a=e[1],o=e[2],_=e[3],i=Math.sin(t),s=Math.cos(t);return r[0]=n*s-o*i,r[1]=a*s+_*i,r[2]=o*s+n*i,r[3]=_*s-a*i,r}function Nm(e,t,r){t*=.5;var n=e[0],a=e[1],o=e[2],_=e[3],i=Math.sin(t),s=Math.cos(t);return r[0]=n*s+a*i,r[1]=a*s-n*i,r[2]=o*s+_*i,r[3]=_*s-o*i,r}function Rm(e,t){var r=e[0],n=e[1],a=e[2];return t[0]=r,t[1]=n,t[2]=a,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-a*a)),t}function Im(e,t,r,n){var a,o,_,i,s,l=e[0],c=e[1],E=e[2],u=e[3],d=t[0],T=t[1],f=t[2],p=t[3];return(o=l*d+c*T+E*f+u*p)<0&&(o=-o,d=-d,T=-T,f=-f,p=-p),1-o>1e-6?(a=Math.acos(o),_=Math.sin(a),i=Math.sin((1-r)*a)/_,s=Math.sin(r*a)/_):(i=1-r,s=r),n[0]=i*l+s*d,n[1]=i*c+s*T,n[2]=i*E+s*f,n[3]=i*u+s*p,n}var bm,ym,Lm=(bm=dm(),ym=dm(),function(e,t,r,n,a,o){return Im(e,n,a,bm),Im(t,r,a,ym),Im(bm,ym,2*a*(1-a),o),o});function Ym(e,t){var r=e[0],n=e[1],a=e[2],o=e[3],_=r*r+n*n+a*a+o*o,i=_?1/_:0;return t[0]=-r*i,t[1]=-n*i,t[2]=-a*i,t[3]=o*i,t}function Mm(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function xm(e,t){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,t[0]=(e[5]-e[7])*(r=.5/r),t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var o=(a+1)%3,_=(a+2)%3;r=Math.sqrt(e[3*a+a]-e[3*o+o]-e[3*_+_]+1),t[a]=.5*r,t[3]=(e[3*o+_]-e[3*_+o])*(r=.5/r),t[o]=(e[3*o+a]+e[3*a+o])*r,t[_]=(e[3*_+a]+e[3*a+_])*r}return t}function Cm(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function wm(){var e=new Float32Array(9);return e[3]=1,e[4]=1,e[5]=1,e}function Um(e,t,r,n,a,o,_,i){var s=wm();s[0]=e,s[1]=t,s[2]=r,s[3]=n,s[4]=n,s[5]=n;var l=i<0?-1:1;return s[6]=l*a,s[7]=l*o,s[8]=l*_,s}function km(){var e=new Float32Array(9);return e[3]=1,e[4]=1,e[5]=1,e}function Dm(e,t){if(e[8]!=e[8])throw new Error(e);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Fm(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=1,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e}function Gm(e,t,r,n){n[0]=e[0],n[1]=e[1],n[2]=e[2],Kg(t)?(n[3]=t[0],n[4]=t[1],n[5]=t[2]):(n[3]=t,n[4]=t,n[5]=t);var a=r[3]<0?-1:1;return n[6]=a*r[0],n[7]=a*r[1],n[8]=a*r[2],n}function Km(e,t){if(e[0]!=e[0])throw new Error(e);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Bm(e,t){return Kg(e)?(t[3]=e[0],t[4]=e[1],t[5]=e[2]):(t[3]=e,t[4]=e,t[5]=e),t}function Xm(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Hm(e,t){if(e[0]!=e[0])throw new Error(e);var r=e[3]<0?-1:1;return t[6]=r*e[0],t[7]=r*e[1],t[8]=r*e[2],t}function jm(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function zm(e,t){return t?(t[0]=e[3],t[1]=e[4],t[2]=e[5],t):e[3]}function Qm(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Vm(e,t){return t[0]=e[6],t[1]=e[7],t[2]=e[8],t[3]=Math.sqrt(Math.abs(1-e[6]*e[6]-e[7]*e[7]-e[8]*e[8])),t}Math.sin(-Math.PI/4),new Float32Array(3),new Float32Array(4),new Float32Array(16);var qm,Wm,Jm,Zm=(qm=ih(),Wm=ih(),Jm=dm(),function(e,t){var r=zm(e,qm);if(Nh(r,r),!r[0])return null;var n=jm(e,Wm),a=Vm(e,Jm);return Ym(a,a),Th(n,r,n),wh(n,a,n),Oh(n,n),Km(n,t),Bm(r,t),Hm(a,t),t}),$m=function(){var e=ih(),t=ih(),r=dm();return function(n,a){var o=jm(n,e),_=zm(n,t);return VA(Vm(n,r),o,a),kA(a,_,a),a}}(),eg=function(){var e=ih(),t=ih(),r=dm();return function(n,a){var o=uO(n,e),_=function(e,t){gg[0]=.577350269189626,gg[1]=.577350269189626,gg[2]=.577350269189626,gg[3]=0,sm(gg,e,gg);var r=em(gg);return t?Eh(r,r,r,t):r}(n,t),i=EO(n,r);return Km(o,a),Bm(_,a),Hm(i,a),a}}(),tg=function(){var e=ih(),t=ih(),r=dm(),n=dm();return function(a,o,_){var i=jm(o,e);return rg(i,a,i),Km(i,_),Bm(Th(zm(a,e),zm(o,t),e),_),Hm(mm(Vm(a,r),Vm(o,n),r),_),_}}(),rg=(IA(),function(){var e=ih(),t=ih(),r=dm();return function(n,a,o){var _=jm(a,e),i=zm(a,t),s=Vm(a,r);return Th(n,i,o),wh(o,s,o),uh(o,_,o),o}}()),ng=function(){var e=ih(),t=ih(),r=dm();return function(n,a,o){var _=jm(a,e),i=zm(a,t),s=Vm(a,r);return dh(n,_,o),Ym(s,s),wh(o,s,o),Nh(i,i),Th(o,i,o),o}}(),ag=function(){var e=ih(),t=ih(),r=ih(),n=dm();return function(a,o,_,i){i|=0;for(var s=a.length,l=jm(o,e),c=zm(o,t),E=Vm(o,n),u=r,d=0;d<s;d+=3)u[0]=a[d],u[1]=a[d+1],u[2]=a[d+2],Th(u,c,u),wh(u,E,u),uh(u,l,u),_[i+d]=u[0],_[i+d+1]=u[1],_[i+d+2]=u[2];return _}}(),og=function(){var e=ih(),t=ih(),r=dm();return function(n,a,o,_){_|=0;for(var i=n.length,s=zm(a,e),l=Vm(a,r),c=t,E=0;E<i;E+=3)c[0]=n[E],c[1]=n[E+1],c[2]=n[E+2],Th(c,s,c),wh(c,l,c),o[_+E]=c[0],o[_+E+1]=c[1],o[_+E+2]=c[2];return o}}(),_g=function(){var e=ih(),t=dm();return function(r,n,a){var o=zm(n,e),_=Vm(n,t);return Th(r,o,a),wh(a,_,a),a}}(),ig=function(){var e=ih(),t=ih(),r=dm();return function(n,a,o,_){_|=0;for(var i=n.length,s=zm(a,e),l=Vm(a,r),c=t,E=0;E<i;E+=4)c=n[E],c=n[E+1],Sh(c=n[E+2],s,c),wh(c,l,c),o[_+E]=c[0],o[_+E+1]=c[1],o[_+E+2]=c[2],o[_+E+3]=n[E+3];return o}}();function sg(e,t,r){return Vm(t,r),mm(r,e,r)}var lg=function(){var e=dm();return function(t,r,n,a){return a|=0,function(e,t,r,n){n=n||0;for(var a=e.length,o=yg,_=0;_<a;_+=4){o[0]=e[_],o[1]=e[_+1],o[2]=e[_+2],o[3]=e[_+3];var i=o[3]>0;mm(t,o,o),(i&&o[3]<0||!i&&o[3]>0)&&Wv(o,-1,o),r[n+_]=o[0],r[n+_+1]=o[1],r[n+_+2]=o[2],r[n+_+3]=o[3]}}(t,Vm(r,e),n,a),n}}(),cg=function(){var e=ih(),t=ih(),r=dm();return function(n,a,o){var _=jm(n,e),i=zm(n,t),s=Vm(n,r),l=Th(a,i,t);return wh(l,s,l),uh(_,l,_),Dm(n,o),Km(_,o),o}}(),Eg=function(){var e=ih(),t=ih(),r=dm(),n=dm();return function(a,o,_,i){var s=jm(a,e),l=jm(o,t);return Km(yh(s,l,_,e),i),zm(a,e),zm(o,t),Bm(yh(s,l,_,e),i),Hm(Im(Vm(a,r),Vm(o,n),_,r),i),i}}(),ug=(ih(),ih(),dm(),dm(),function(){var e=ih(),t=(ih(),dm()),r=dm();return function(n,a,o,_,i){var s=jm(n,e);s[0]=s[0]+a*o[0],s[1]=s[1]+a*o[1],s[2]=s[2]+a*o[2],Km(s,i),Bm(zm(n,e),i);var l=Vm(n,t),c=_[0],E=_[1],u=_[2],d=r;return d[0]=.5*(c*l[3]+E*l[2]-u*l[1]),d[1]=.5*(E*l[3]+u*l[0]-c*l[2]),d[2]=.5*(u*l[3]+c*l[1]-E*l[0]),d[3]=.5*(-c*l[0]-E*l[1]-u*l[2]),l[0]=l[0]+d[0]*a,l[1]=l[1]+d[1]*a,l[2]=l[2]+d[2]*a,l[3]=l[3]+d[3]*a,am(l,l),Hm(l,i),i}}());function dg(e,t,r){return r[0]=e[9*t],r[1]=e[9*t+1],r[2]=e[9*t+2],r[3]=e[9*t+3],r[4]=e[9*t+4],r[5]=e[9*t+5],r[6]=e[9*t+6],r[7]=e[9*t+7],r[8]=e[9*t+8],r}function Tg(e,t,r){return t[9*r]=e[0],t[9*r+1]=e[1],t[9*r+2]=e[2],t[9*r+3]=e[3],t[9*r+4]=e[4],t[9*r+5]=e[5],t[9*r+6]=e[6],t[9*r+7]=e[7],t[9*r+8]=e[8],t}ih(),ih(),dm(),dm(),ih(),dm();var fg=new Float32Array(3),pg=new Float32Array(3),Pg=new Float32Array(3),Sg=new Float32Array(3),Ag=new Float32Array(3),hg=new Float32Array(3),vg=new Float32Array(3),mg=new Float32Array(3),gg=new Float32Array(4),Og=new Float32Array(4),Ng=new Float32Array(9),Rg=new Float32Array(9),Ig=new Float32Array(9),bg=new Float32Array(16),yg=(new Float32Array(16),dm()),Lg=dm(),Yg=new Float32Array([0,0,0]),Mg=new Float32Array([0,0,0,1]),xg=(wm(),wm(),new Float32Array([1,1,1])),Cg=new Float32Array([1,0,0]),wg=new Float32Array([0,1,0]),Ug=new Float32Array([0,0,1]),kg=new Float32Array([-1,0,0]),Dg=new Float32Array([0,-1,0]),Fg=new Float32Array([0,0,-1]),Gg=new RegExp("object .*Array");function Kg(e){return Gg.test(Object.prototype.toString.call(e))}var Bg=[0,1,2,4,5],Xg=Math.floor(2147483647/48271),Hg=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];function jg(e){return void 0!==e}function zg(e,t,r){for(var n=[],a=r.length,o=0;o<a;o++){var _=r[o];_[e]==t&&n.push(_)}return n}function Qg(e){return new Float32Array(e)}function Vg(e,t){var r=e.length,n=new Float32Array(r+t.length);return n.set(e),n.set(t,r),n}function qg(e){return e>0?1:e<0?-1:0}function Wg(e,t,r){for(var n=0;n<r.length;n++){var a=r[n];if(a[e]===t)return a}return null}function Jg(e,t,r){for(var n=0;n<e.length;n++)if(e[n][t]==r)return n;return-1}function Zg(e,t){for(var r=0;r<e.length;r++)if(e[r]==t)return;e.push(t)}function $g(e){var t=Math.floor(e[0]/Xg),r=e[0]%Xg*48271-3399*t;return e[0]=r>0?r:r+2147483647,(e[0]-1)/2147483646}function eO(e,t){return t||(t=[]),t[0]=5e4+Math.floor(e),t}function tO(e,t){var r=fg;return r[0]=e[2],r[1]=e[1],r[2]=e[0],rO(r,11,t),t}function rO(e,t,r){var n=e[0],a=e[1],o=e[2],_=Math.cos(n/2),i=Math.cos(a/2),s=Math.cos(o/2),l=Math.sin(n/2),c=Math.sin(a/2),E=Math.sin(o/2);if(Bg.indexOf(t)>-1)var u=Math.cos((n+o)/2),d=Math.sin((n+o)/2),T=Math.cos((n-o)/2),f=Math.sin((n-o)/2),p=Math.cos((o-n)/2),P=Math.sin((o-n)/2);switch(t){case 0:r[0]=i*d,r[1]=c*T,r[2]=c*f,r[3]=i*u;break;case 1:r[0]=c*f,r[1]=i*d,r[2]=c*T,r[3]=i*u;break;case 2:r[0]=c*T,r[1]=c*f,r[2]=i*d,r[3]=i*u;break;case 3:r[0]=i*d,r[1]=c*P,r[2]=c*p,r[3]=i*u;break;case 4:r[0]=c*p,r[1]=i*d,r[2]=c*P,r[3]=i*u;break;case 5:r[0]=c*P,r[1]=c*p,r[2]=i*d,r[3]=i*u;break;case 6:r[0]=l*i*s+_*c*E,r[1]=_*c*s-l*i*E,r[2]=_*i*E+l*c*s,r[3]=_*i*s-l*c*E;break;case 7:r[0]=_*i*E+l*c*s,r[1]=l*i*s+_*c*E,r[2]=_*c*s-l*i*E,r[3]=_*i*s-l*c*E;break;case 8:r[0]=_*c*s-l*i*E,r[1]=_*i*E+l*c*s,r[2]=l*i*s+_*c*E,r[3]=_*i*s-l*c*E;break;case 9:r[0]=l*i*s-_*c*E,r[1]=_*i*E-l*c*s,r[2]=_*c*s+l*i*E,r[3]=_*i*s+l*c*E;break;case 10:r[0]=_*c*s+l*i*E,r[1]=l*i*s-_*c*E,r[2]=_*i*E-l*c*s,r[3]=_*i*s+l*c*E;break;case 11:r[0]=_*i*E-l*c*s,r[1]=_*c*s+l*i*E,r[2]=l*i*s-_*c*E,r[3]=_*i*s+l*c*E}return r}function nO(e,t,r){var n=e[0],a=e[1],o=e[2],_=e[3];switch(t){case 0:r[0]=Math.atan2(n*a+o*_,a*_-n*o),r[1]=Math.acos(1-2*(a*a+o*o)),r[2]=Math.atan2(n*a-o*_,n*o+a*_);break;case 1:r[0]=Math.atan2(n*_+a*o,o*_-n*a),r[1]=Math.acos(1-2*(n*n+o*o)),r[2]=Math.atan2(a*o-n*_,n*a+o*_);break;case 2:r[0]=Math.atan2(n*o+a*_,n*_-a*o),r[1]=Math.acos(1-2*(n*n+a*a)),r[2]=Math.atan2(n*o-a*_,n*_+a*o);break;case 3:r[0]=Math.atan2(n*o-a*_,n*a+o*_),r[1]=Math.acos(1-2*(a*a+o*o)),r[2]=Math.atan2(n*o+a*_,o*_-n*a);break;case 4:r[0]=Math.atan2(n*a-o*_,n*_+a*o),r[1]=Math.acos(1-2*(n*n+o*o)),r[2]=Math.atan2(n*a+o*_,n*_-a*o);break;case 5:r[0]=Math.atan2(a*o-n*_,n*o+a*_),r[1]=Math.acos(1-2*(n*n+a*a)),r[2]=Math.atan2(n*_+a*o,a*_-n*o);break;case 6:r[0]=Math.atan2(2*(n*_-a*o),1-2*(n*n+a*a)),r[1]=Math.asin(2*(n*o+a*_)),r[2]=Math.atan2(2*(o*_-n*a),1-2*(a*a+o*o));break;case 7:(i=n*a+o*_)>.499999?(r[0]=0,r[1]=Math.PI/2,r[2]=2*Math.atan2(n,_)):i<-.499999?(r[0]=0,r[1]=-Math.PI/2,r[2]=-2*Math.atan2(n,_)):(r[0]=Math.atan2(2*(a*_-n*o),1-2*(a*a+o*o)),r[1]=Math.asin(2*(n*a+o*_)),r[2]=Math.atan2(2*(n*_-a*o),1-2*(n*n+o*o)));break;case 8:r[0]=Math.atan2(2*(o*_-n*a),1-2*(n*n+o*o)),r[1]=Math.asin(2*(n*_+a*o)),r[2]=Math.atan2(2*(a*_-n*o),1-2*(n*n+a*a));break;case 9:r[0]=Math.atan2(2*(n*_+a*o),1-2*(n*n+o*o)),r[1]=Math.asin(2*(o*_-n*a)),r[2]=Math.atan2(2*(n*o+a*_),1-2*(a*a+o*o));break;case 10:r[0]=Math.atan2(2*(n*o+a*_),1-2*(n*n+a*a)),r[1]=Math.asin(2*(n*_-a*o)),r[2]=Math.atan2(2*(n*a+o*_),1-2*(n*n+o*o));break;case 11:var i;(i=a*_-n*o)>.499999?(r[0]=0,r[1]=Math.PI/2,r[2]=-2*Math.atan2(o,_)):i<-.499999?(r[0]=0,r[1]=-Math.PI/2,r[2]=2*Math.atan2(o,_)):(r[0]=Math.atan2(2*(n*a+o*_),1-2*(a*a+o*o)),r[1]=Math.asin(2*(a*_-n*o)),r[2]=Math.atan2(2*(n*_+a*o),1-2*(n*n+a*a)))}return r}function aO(e,t){var r=Math.cos(e[0]),n=Math.cos(e[1]),a=Math.cos(e[2]),o=Math.sin(e[0]),_=Math.sin(e[1]),i=Math.sin(e[2]),s=r*a,l=r*i,c=o*a,E=o*i;return t[0]=n*a,t[1]=n*i,t[2]=-_,t[3]=_*c-l,t[4]=_*E+s,t[5]=n*o,t[6]=_*s+E,t[7]=_*l-c,t[8]=n*r,t}function oO(e,t){var r=nO(e,11,fg);return t[0]=r[2],t[1]=r[1],t[2]=r[0],t}function _O(e,t,r){return r||(r=new Float32Array(3)),wh(t,e,r),r}function iO(e,t,r){r||(r=new Float32Array(4));var n=Ih(t,e=Rh(e,fg)),a=bh(t,e,pg),o=Math.acos(n);return r[0]=a[0]*Math.sin(o/2),r[1]=a[1]*Math.sin(o/2),r[2]=a[2]*Math.sin(o/2),r[3]=Math.cos(o/2),r}function sO(e,t,r,n){if(0==r)return e;n=n||[];for(var a=0;a<e.length;a++)n[a]=(1-r)*e[a]+r*t[a];return n}function lO(e){if(!(e instanceof Object))return e;var t,r=e.constructor;switch(r){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:t=new r(e);break;case Array:t=new r(e.length);for(var n=0;n<e.length;n++)t[n]=lO(e[n]);break;default:for(var a in t=new r,e)e.hasOwnProperty(a)&&(t[a]=lO(e[a]))}return t}function cO(e){var t=e instanceof Array?[]:{};for(var r in e)if(e.hasOwnProperty(r))if(e[r]instanceof Object){var n=e[r].constructor;switch(n){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:t[r]=new n(e[r]);break;case Array:t[r]=e[r].slice(0);break;default:t[r]=e[r]}}else t[r]=e[r];return t}function EO(e,t){t||(t=new Float32Array(4)),_A(e,Ng);var r=Ng[0],n=Ng[3],a=Ng[6],o=Ng[1],_=Ng[4],i=Ng[7],s=Ng[2],l=Ng[5],c=Ng[8],E=Math.sqrt(r*r+n*n+a*a)||1,u=Math.sqrt(o*o+_*_+i*i)||1,d=Math.sqrt(s*s+l*l+c*c)||1;return Ng[0]/=E,Ng[3]/=E,Ng[6]/=E,Ng[1]/=u,Ng[4]/=u,Ng[7]/=u,Ng[2]/=d,Ng[5]/=d,Ng[8]/=d,xm(Ng,t),am(t,t),t}function uO(e,t){return t||(t=new Float32Array(3)),t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function dO(e,t){var r=t.left,n=t.right,a=t.top,o=t.bottom,_=t.near,i=t.far;return r[0]=e[3]+e[0],r[1]=e[7]+e[4],r[2]=e[11]+e[8],r[3]=e[15]+e[12],n[0]=e[3]-e[0],n[1]=e[7]-e[4],n[2]=e[11]-e[8],n[3]=e[15]-e[12],a[0]=e[3]-e[1],a[1]=e[7]-e[5],a[2]=e[11]-e[9],a[3]=e[15]-e[13],o[0]=e[3]+e[1],o[1]=e[7]+e[5],o[2]=e[11]+e[9],o[3]=e[15]+e[13],_[0]=e[3]+e[2],_[1]=e[7]+e[6],_[2]=e[11]+e[10],_[3]=e[15]+e[14],i[0]=e[3]-e[2],i[1]=e[7]-e[6],i[2]=e[11]-e[10],i[3]=e[15]-e[14],TO(r),TO(n),TO(a),TO(o),TO(_),TO(i),t}function TO(e){var t=e[0],r=e[1],n=e[2],a=e[3],o=Math.sqrt(t*t+r*r+n*n);e[0]=t*(o=1/o),e[1]=r*o,e[2]=n*o,e[3]=a*o}function fO(e,t,r,n){n||(n=0);for(var a=e.length,o=0;o<a;o+=3){var _=e[o],i=e[o+1],s=e[o+2];r[n+o]=t[0]*_+t[4]*i+t[8]*s+t[12],r[n+o+1]=t[1]*_+t[5]*i+t[9]*s+t[13],r[n+o+2]=t[2]*_+t[6]*i+t[10]*s+t[14]}return r}function pO(e,t,r){r||(r=new Float32Array(3));var n=gg;n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=0,sm(n,t,n),r[0]=n[0],r[1]=n[1],r[2]=n[2]}function PO(e,t,r,n){if(n<r)return r;var a=r+Math.floor((n-r)/2);return e[a]>t?PO(e,t,r,a-1):e[a]<t?PO(e,t,a+1,n):a}function SO(e,t){for(var r=0;r<e.length;r++)if(e[r]!=t[r])return!1;return!0}function AO(){var e=fg;e[0]=0,e[1]=0,e[2]=0;var t=new Float32Array(16),r=new Float32Array(16),n=new Float32Array(16),a=new Float32Array(16),o=new Float32Array(16),_=new Float32Array(16);return rh(e,[-1,0,0],[0,-1,0],t),kA(t,[-1,1,1],t),kA(t,[-1,1,-1],r),rh(e,[0,-1,0],[0,0,-1],n),kA(n,[1,1,-1],n),kA(n,[1,-1,-1],a),rh(e,[0,0,-1],[0,-1,0],o),kA(o,[-1,1,1],o),kA(o,[-1,1,-1],_),[t,r,n,a,o,_]}function hO(){var e=fg;e[0]=0,e[1]=0,e[2]=0;var t=new Float32Array(16),r=new Float32Array(16),n=new Float32Array(16),a=new Float32Array(16),o=new Float32Array(16),_=new Float32Array(16);return rh(e,[1,0,0],[0,-1,0],t),kA(t,[-1,1,-1],r),rh(e,[0,1,0],[0,0,1],n),kA(n,[1,-1,-1],a),rh(e,[0,0,1],[0,-1,0],o),kA(o,[-1,1,-1],_),[t,r,n,a,o,_]}function vO(e,t){t||(t=e);var r=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(r>0){t[3]=2*Math.acos(e[3]);var n=1/Math.sqrt(r);t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n}else t[3]=0,t[0]=1,t[1]=0,t[2]=0;return t}function mO(e){return(e*=34*e+1)%289}function gO(e){return e-Math.floor(e)}function OO(e){return isNaN(e)||void 0===e?NaN:0|e}function NO(e){return e*Math.PI/180}function RO(e){return 180*e/Math.PI}function IO(e){var t=.211324865405187,r=.366025403784439,n=-.577350269189626,a=.024390243902439,o=e[0]*r+e[1]*r,_=Math.floor(e[0]+o),i=Math.floor(e[1]+o),s=_*t+i*t,l=e[0]-_+s,c=e[1]-i+s,E=l>c?1:0,u=1-E,d=l+t-E,T=c+t-u,f=l+n,p=c+n;_%=289;var P=mO(mO(i%=289)+_),S=mO(mO(i+u)+_+E),A=mO(mO(i+1)+_+1),h=Math.max(.5-(l*l+c*c),0),v=Math.max(.5-(d*d+T*T),0),m=Math.max(.5-(f*f+p*p),0);h*=h*h*h,v*=v*v*v,m*=m*m*m;var g=2*gO(P*a)-1,O=2*gO(S*a)-1,N=2*gO(A*a)-1,R=Math.abs(g)-.5,I=Math.abs(O)-.5,b=Math.abs(N)-.5,y=g-Math.floor(g+.5),L=O-Math.floor(O+.5),Y=N-Math.floor(N+.5);return 130*((h*=1.79284291400159-.85373472095314*(y*y+R*R))*(y*l+R*c)+(v*=1.79284291400159-.85373472095314*(L*L+I*I))*(L*d+I*T)+(m*=1.79284291400159-.85373472095314*(Y*Y+b*b))*(Y*f+b*p))}function bO(e){return yO((34*e+5)*e)}function yO(e){return e-289*Math.floor(e/289)}function LO(e){return e-7*Math.floor(e/7)}function YO(e){var t=1/7,r=t/2,n=yO(Math.floor(e[0])),a=yO(Math.floor(e[1])),o=gO(e[0]),_=gO(e[1]),i=o-.5,s=o-1.5,l=i,c=s,E=_-.5,u=E,d=_-1.5,T=d,f=bO(n),p=bO(n+1),P=f,S=p;f=bO(f+a),p=bO(p+a),P=bO(P+a+1),S=bO(S+a+1);var A=i+.7*(LO(f)*t+r),h=s+.7*(LO(p)*t+r),v=l+.7*(LO(P)*t+r),m=c+.7*(LO(S)*t+r),g=E+.7*(LO(Math.floor(f*t))*t+r),O=u+.7*(LO(Math.floor(p*t))*t+r),N=d+.7*(LO(Math.floor(P*t))*t+r),R=T+.7*(LO(Math.floor(S*t))*t+r);return Math.min(A*A+g*g,h*h+O*O,v*v+N*N,m*m+R*R)}function MO(e,t,r,n,a){a||(a=new Float32Array(4));var o=wh(t,e,fg),_=r[0],i=r[1],s=r[2],l=Ng;return l[0]=i*i+s*s,l[1]=-i*_,l[2]=-s*_,l[3]=-_*i,l[4]=_*_+s*s,l[5]=-s*i,l[6]=-_*s,l[7]=-i*s,l[8]=_*_+i*i,Ch(o,l,o),Rh(o,o),Sm(n,o,a),a}function xO(e,t,r){return e<t&&(e=t),e>r&&(e=r),e}function CO(e,t,r,n){if(n){var a=Math.exp(-r/n);return(1-a)*e+a*t}return e}function wO(e,t,r,n,a){if(a||(a=new Float32Array(e.length)),n)for(var o=Math.exp(-r/n),_=0;_<a.length;_++)a[_]=(1-o)*e[_]+o*t[_];else ch(e,a);return a}function UO(e,t,r,n,a){return a||(a=new Float32Array(e.length)),n?Im(e,t,Math.exp(-r/n),a):Bv(e,a),a}function kO(e){return!!("object"==typeof e&&e.buffer&&e.buffer instanceof ArrayBuffer)}function DO(e,t){return!(!(e instanceof Array||e.buffer&&e.buffer instanceof ArrayBuffer)||(!t||t!=e.length)&&t)}function FO(e,t){var r=mA(e,Ng),n=fg;n[0]=r[6],n[1]=r[7],n[2]=r[8];var a=bh(Ug,n,n);Rh(a,a),!t&&r[4]>0&&(a[0]*=-1,a[1]*=-1,a[2]*=-1);var o=pg;o[0]=r[0],o[1]=r[1],o[2]=r[2],Rh(o,o);var _=Og;Sm(o,a,_),mm(_,e,e)}function GO(e,t,r,n){var a=r*t-.5,o=n*t-.5,_=a-Math.floor(a),i=o-Math.floor(o);a=Math.floor(a);var s=t-1;return(e[(o=Math.floor(o))*t+a]*(1-_)+e[o*t+Math.min(a+1,s)]*_)*(1-i)+(e[Math.min(o+1,s)*t+a]*(1-_)+e[Math.min(o+1,s)*t+Math.min(a+1,s)]*_)*i}function KO(e){for(var t=0,r=0;r<3;r++)(e&1<<r)>0&&t++;return t}function BO(e){for(var t=[0,0,0],r=0;r<3;r++)(e&1<<r)>0&&(t[2-r]=1);return t}function XO(e,t){var r=0;return 1!=t&&2!=t||(4&e)>0&&r++,2==t&&(2&e)>0&&r++,r}function HO(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}function jO(e){var t=0;for(var r in e)e.hasOwnProperty(r)&&t++;return t}function zO(e){return e.length?e[Math.floor(Math.random()*e.length)]:null}function QO(e,t,r){r||(r=new Float32Array(3)),r[0]=e[0]-t[0],r[1]=e[1]-t[1],r[2]=0,Rh(r,r)}function VO(e,t,r){var n=e-t,a=r-t;return t+(n-Math.floor(n/a)*a)}function qO(e){return VO(e,0,2*Math.PI)}function WO(e,t){for(var r in e){var n=!0,a=e[r],o=t[r];switch(typeof a){case"number":case"string":case"boolean":n=a==o;break;case"object":n=JO(a,o)}if(!n)return!1}return!0}function JO(e,t){if(e&&t){var r=e instanceof Array;if(r!=t instanceof Array)return!1;var n=e.buffer instanceof ArrayBuffer&&"undefined"!==e.byteLength;if(n!=(t.buffer instanceof ArrayBuffer&&"undefined"!==t.byteLength))return!1;if(r){if(e.length!=t.length)return!1;for(var a=0;a<e.length;a++)if(!ZO(e[a],t[a]))return!1}else if(n){if(e.length!=t.length)return!1;for(a=0;a<e.length;a++)if(e[a]!=t[a])return!1}else{switch(e.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:return e==t}for(var o in e)if(!ZO(e[o],t[o]))return!1;for(var o in t)if(!(o in e))return!1}return!0}return!(e||t)}function ZO(e,t){if(typeof e!=typeof t)return!1;switch(typeof e){case"number":case"string":case"boolean":return e==t;case"object":return JO(e,t);default:return!0}}function $O(e,t){var r=e[0],n=e[2],a=e[3];return t[0]=e[1],t[1]=n,t[2]=a,t[3]=r,t}function eN(e,t,r,n){var a=gg;a.set(e),a[3]=t;var o=Og;fg[0]=r[3],fg[1]=r[4],fg[2]=r[5],o.set(fg),o[3]=0;var _=om(a,o);if(0==_)return null;var i=Og;ch(r,fg),i.set(fg),i[3]=1;var s=-om(a,i)/_;return n[0]=r[0]+s*r[3],n[1]=r[1]+s*r[4],n[2]=r[2]+s*r[5],n}function tN(e,t,r){var n=fg,a=Ih(e,t);return a<-.9999999?(bh(Cg,e,n),mh(n)<1e-6&&bh(wg,e,n),Rh(n,n),vm(n,Math.PI,r)):(bh(e,t,n),r.set(n),r[3]=1+a,am(r,r)),r}function rN(e,t,r){if(t==r)return r-e;e=qO(e),t=qO(t),r=qO(r);var n=2*Math.PI-t;if(t=0,r=qO(r+=n),(e=qO(e+=n))>r){var a=r-e,o=2*Math.PI-e;return-a>o?o:a}return 0}function nN(e,t,r){return isFinite(t)&&isFinite(r)&&(e=xO(e,t,r)),e*e*(3-2*e)}function aN(e,t,r){return t+e*(r-t)}function oN(e,t){for(var r=0;r<e.length;r++)for(var n=0;n<t.length;n++)if(t[n]==e[r])return!0;return!1}function _N(e,t){for(var r=Math.max(e.length,t.length),n=0;n<r;n++){var a=qg((n>=e.length?0:e[n])-(n>=t.length?0:t[n]));if(a)return a}return 0}function iN(e){return e.join(".")}function sN(e){return e.split(".").map((function(e){return 0|e}))}function lN(e,t){return t[0]=Math.pow(e[0],1/2.2),t[1]=Math.pow(e[1],1/2.2),t[2]=Math.pow(e[2],1/2.2),t}function cN(e){return 0!=parseInt(e.toString(2).substr(1),2)}function EN(){var e=[{}];return e.length=0,e}function uN(e){return xO(Math.round(32767.5*(e+1)-32768)||0,-32768,32767)}function dN(e){return xO((e+32768)/32767.5-1,-1,1)}function TN(e){return xO(Math.round(255*e),0,255)}function fN(e){return xO(e/255,0,1)}function pN(e,t,r,n){var a=pg;_O(t,n,a),Rh(a,a);var o=Pg;dh(r,e,o),Rh(o,o),mm(tN(a,o,gg),t,t),am(t,t)}function PN(e,t){for(var r=2*Math.PI,n=[],a=0;a<3;a++)n[a]=e[a]-t[a],n[a]>5.1?(e[a]-=n[a]/r*r,n[a]=e[a]-t[a]):n[a]<-5.1&&(e[a]+=-n[a]/r*r,n[a]=e[a]-t[a]);Math.abs(n[0])>3.2&&Math.abs(n[1])<1.6&&Math.abs(n[2])<1.6&&(n[0]>0?e[0]-=r:e[0]+=r),Math.abs(n[1])>3.2&&Math.abs(n[2])<1.6&&Math.abs(n[0])<1.6&&(n[1]>0?e[1]-=r:e[1]+=r),Math.abs(n[2])>3.2&&Math.abs(n[0])<1.6&&Math.abs(n[1])<1.6&&(n[2]>0?e[2]-=r:e[2]+=r)}function SN(e,t,r){var n=aO(t,Ng);return function(e,t){var r=fg,n=pg;return AN(e,r,n),ch(Math.abs(r[0])+Math.abs(r[1])+Math.abs(r[2])>Math.abs(n[0])+Math.abs(n[1])+Math.abs(n[2])?n:r,t),t}(TA(aO(e,Rg),n,Ig),r)}function AN(e,t,r){var n=Math.sqrt(e[0]*e[0]+e[1]*e[1]);n>1e-6?(t[0]=Math.atan2(e[5],e[8]),t[1]=Math.atan2(-e[2],n),t[2]=Math.atan2(e[1],e[0]),r[0]=Math.atan2(-e[5],-e[8]),r[1]=Math.atan2(-e[2],-n),r[2]=Math.atan2(-e[1],-e[0])):(t[0]=Math.atan2(-e[7],e[4]),t[1]=Math.atan2(-e[2],n),t[2]=0,ch(t,r))}function hN(e,t){var r=!1,n=0,a=0,o={};function _(e,t){var r=[];e[0].indexOf("%c")>-1?r.push(e[0].replace("%c","%c"+t+": ")):r.push(t+": "+e[0]);for(var n=1;n<e.length;n++)r.push(e[n]);return r}function i(){n++;var e=_(arguments,"B4W ERROR");console.error.apply(console,e)}function s(e){e in o||(o[e]=e,i([e]))}function l(e,t){s(e+"() is deprecated, use "+t+"() instead.")}t.set_verbose=function(e){r=e},t.log_raw=function(){console.log.apply(console,arguments)},t.log=function(){if(r){var e=_(arguments,"B4W LOG");console.log.apply(console,e)}},t.compose_args_prefix=_,t.error=i,t.error_once=s,t.error_deprecated=l,t.error_deprecated_arr=function(e,t){switch(t.length>1){case!0:s(e+"() is deprecated, use "+t.slice(0,-1).join("(), ")+"() or "+t[t.length-1]+"() instead.");break;case!1:l(e,t[0])}},t.error_deprecated_cfg=function(e,t){s(void 0===t?'Config option "'+e+'" is deprecated.':'Config option "'+e+'" is deprecated, use "'+t+'" instead.')},t.warn=function(){a++;var e=_(arguments,"B4W WARN");console.warn.apply(console,e)},t.info=function(){var e=_(arguments,"B4W INFO");console.info.apply(console,e)},t.export_error=function(){n++;var e=_(arguments,"B4W EXPORT ERROR");console.error.apply(console,e)},t.export_warn=function(){a++;var e=_(arguments,"B4W EXPORT WARNING");console.warn.apply(console,e)},t.time=function(){r&&console.time.apply(console,arguments)},t.timeEnd=function(){r&&console.timeEnd.apply(console,arguments)},t.group=function(){console.group.apply(console,arguments)},t.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)},t.groupEnd=function(){console.groupEnd.apply(console,arguments)},t.clear=function(){"function"==typeof console.clear&&console.clear.apply(console,arguments)},t.get_warning_count=function(){return a},t.get_error_count=function(){return n},t.clear_errors_warnings=function(){a=0,n=0}}var vN=nA("print",hN);nA("__print",hN);var mN=vN,gN=nA("assert",(function(e,t){var r=mN(e),n=null,a=!1;function o(e){throw e&&r.error.apply(r,arguments),"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/"}function _(e,t){if(i(e)||o("Structure assertion failed: invalid first object value"),i(t)||o("Structure assertion failed: invalid second object value"),s(e,t)||o("Structure assertion failed: incompatible types"),!(null==e||null==t||"object"!=typeof e||kO(e)||e instanceof Array)){for(var r in e)i(e[r])||o("Structure assertion failed: invalid value for key in the first object: "+r),r in t||o("Structure assertion failed: missing key in the first object: "+r);for(var r in t)i(t[r])||o("Structure assertion failed: invalid value for key in the second object: "+r),r in e||o("Structure assertion failed: missing key in the second object: "+r),s(e[r],t[r])||o("Structure assertion failed: incompatible types for key "+r)}}function i(e){return void 0!==e&&("number"!=typeof e||!isNaN(e))}function s(e,t){if(typeof e!=typeof t)return!1;if(null!=e&&null!=t&&"object"==typeof e){var r=e instanceof Array,n=t instanceof Array;if(r&&!n||!r&&n)return!1;var a=kO(e),o=kO(t);if(a&&!o||!a&&o)return!1}return!0}t.panic=o,t.assert=function(e){e||o("Assertion failed")},t.is_constructor=function(e,t){e.constructor!=t&&o("Type assertion failed: value <"+e+"> has type <"+e.constructor+">, required <"+t+">")},t.equal=_,t.equal_seq=function(e){a?_(e,n):a=!0,n=null!=e&&"object"==typeof e?cO(e):e}})),ON=new Float32Array(24),NN=new Float32Array(3),RN=new Float32Array(3),IN=new Float32Array(3),bN=new Float32Array(3),yN=new Float32Array(9),LN=new Float32Array(9),YN=new Float32Array(9);function MN(){return{bb:{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0},be:VN(),bs:zN()}}function xN(e,t){return CN(e.bb,t.bb),qN(e.be,t.be),QN(e.bs,t.bs),t}function CN(e,t){return t.min_x=e.min_x,t.max_x=e.max_x,t.min_y=e.min_y,t.max_y=e.max_y,t.min_z=e.min_z,t.max_z=e.max_z,t}function wN(){return{center:new Float32Array(3),axis_x:new Float32Array(3),axis_y:new Float32Array(3),axis_z:new Float32Array(3)}}function UN(e){var t={max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0};return CN(e,t),t}function kN(e){var t=e.max_x-e.min_x,r=e.max_y-e.min_y;r<t&&(t=r);var n=e.max_z-e.min_z;return n<t&&(t=n),t}function DN(e,t){var r=e.max_y,n=e.max_z,a=e.min_x,o=e.min_y,_=e.min_z;return e.max_x=Math.max(t.max_x,e.max_x),e.max_y=Math.max(t.max_y,r),e.max_z=Math.max(t.max_z,n),e.min_x=Math.min(t.min_x,a),e.min_y=Math.min(t.min_y,o),e.min_z=Math.min(t.min_z,_),e}function FN(e,t,r,n){for(var a=e[t],o=e[t+1],_=e[t+2],i=e[t],s=e[t+1],l=e[t+2],c=t+3;c<r;c+=3){var E=e[c],u=e[c+1],d=e[c+2];a=Math.max(a,E),o=Math.max(o,u),_=Math.max(_,d),i=Math.min(i,E),s=Math.min(s,u),l=Math.min(l,d)}return n.max_x=a,n.max_y=o,n.max_z=_,n.min_x=i,n.min_y=s,n.min_z=l,n}function GN(e,t,r){r||(r={max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0});var n=KN(e,ON);return ag(n,t,n),FN(n,0,n.length,r)}function KN(e,t){t||(t=new Float32Array(24));var r=e.max_x,n=e.max_y,a=e.max_z,o=e.min_x,_=e.min_y,i=e.min_z;return t[0]=o,t[1]=_,t[2]=i,t[3]=r,t[4]=_,t[5]=i,t[6]=r,t[7]=n,t[8]=i,t[9]=o,t[10]=n,t[11]=i,t[12]=o,t[13]=_,t[14]=a,t[15]=r,t[16]=_,t[17]=a,t[18]=r,t[19]=n,t[20]=a,t[21]=o,t[22]=n,t[23]=a,t}function BN(e,t,r){r||(r=zN()),rg(e.center,t,r.center);var n=zm(t);return r.radius=e.radius*(n<0?-n:n),r}function XN(e,t,r){return r||(r=VN()),rg(e.center,t,r.center),ch(e.axis_x,r.axis_x),ch(e.axis_y,r.axis_y),ch(e.axis_z,r.axis_z),_g(r.axis_x,t,r.axis_x),_g(r.axis_y,t,r.axis_y),_g(r.axis_z,t,r.axis_z),r}function HN(e,t,r){return r||(r=wN()),rg(e.center,t,r.center),ch(e.axis_x,r.axis_x),ch(e.axis_y,r.axis_y),ch(e.axis_z,r.axis_z),_g(r.axis_x,t,r.axis_x),_g(r.axis_y,t,r.axis_y),_g(r.axis_z,t,r.axis_z),r}function jN(e,t){var r=zN();return ch(t,r.center),r.radius=e,r}function zN(){return{center:new Float32Array(3),radius:0}}function QN(e,t){return t.center[0]=e.center[0],t.center[1]=e.center[1],t.center[2]=e.center[2],t.radius=e.radius,t}function VN(){return{axis_x:new Float32Array(3),axis_y:new Float32Array(3),axis_z:new Float32Array(3),center:new Float32Array(3)}}function qN(e,t){return ch(e.axis_x,t.axis_x),ch(e.axis_y,t.axis_y),ch(e.axis_z,t.axis_z),ch(e.center,t.center),t}function WN(e,t,r,n){return{axis_x:new Float32Array(e),axis_y:new Float32Array(t),axis_z:new Float32Array(r),center:new Float32Array([n[0],n[1],n[2]])}}function JN(e,t){var r=dh(t.center,e.center,ih());0==mh(r)&&Eh(1,0,0,r);var n=Rh(r,ih()),a=Sh(n,e.radius,ih());uh(a,e.center,a);var o=Sh(n,-e.radius,ih());uh(o,e.center,o);var _=Sh(n,t.radius,ih());uh(_,t.center,_);var i=Sh(n,-t.radius,ih());uh(i,t.center,i);var s=function(e,t){for(var r=Rh(t,ih()),n=e[0],a=e[0],o=1;o<e.length;o++){var _=Ih(e[o],r);_<Ih(n,r)&&(n=e[o]),_>Ih(a,r)&&(a=e[o])}return[n,a]}([a,o,_,i],n),l=s[0],c=s[1];e.center=Sh(uh(l,c,ih()),.5,ih()),e.radius=mh(dh(c,l,ih()))/2}function ZN(e,t){uh(e.center,e.axis_y,NN),uh(NN,e.axis_x,NN),uh(NN,e.axis_z,NN),t.push(NN[0],NN[1],NN[2]),uh(e.center,e.axis_y,NN),uh(NN,e.axis_x,NN),dh(NN,e.axis_z,NN),t.push(NN[0],NN[1],NN[2]),uh(e.center,e.axis_y,NN),dh(NN,e.axis_x,NN),uh(NN,e.axis_z,NN),t.push(NN[0],NN[1],NN[2]),uh(e.center,e.axis_y,NN),dh(NN,e.axis_x,NN),dh(NN,e.axis_z,NN),t.push(NN[0],NN[1],NN[2]),dh(e.center,e.axis_y,NN),uh(NN,e.axis_x,NN),uh(NN,e.axis_z,NN),t.push(NN[0],NN[1],NN[2]),dh(e.center,e.axis_y,NN),uh(NN,e.axis_x,NN),dh(NN,e.axis_z,NN),t.push(NN[0],NN[1],NN[2]),dh(e.center,e.axis_y,NN),dh(NN,e.axis_x,NN),uh(NN,e.axis_z,NN),t.push(NN[0],NN[1],NN[2]),dh(e.center,e.axis_y,NN),dh(NN,e.axis_x,NN),dh(NN,e.axis_z,NN),t.push(NN[0],NN[1],NN[2])}function $N(e,t){var r=function(e,t){t[0]=0,t[1]=0,t[2]=0;for(var r=0;r<e.length;r+=3)t[0]+=e[r],t[1]+=e[r+1],t[2]+=e[r+2];return Sh(t,3/e.length,t)}(e,bN);if(t)var n=function(e,t,r){for(var n=0;n<r.length;n++)r[n]=0;for(n=0;n<e.length;n+=3){var a=e[n]-t[0],o=e[n+1]-t[1],_=e[n+2]-t[2];r[0]+=a*a,r[1]+=a*o,r[2]+=a*_,r[4]+=o*o,r[5]+=o*_,r[8]+=_*_}for(r[3]=r[1],r[6]=r[2],r[7]=r[5],n=0;n<r.length;n++)r[n]*=3/e.length;return r}(e,r,LN);else n=lA(LN);var a=function(e,t,r){var n=sA(e,Hh);if(ev(n)<5e-4)return lA(r);var a=$h(n,jh),o=cA(a,zh);TA(n,o,Qh),TA(a,Qh,n);for(var _=sA(a,r),i=1;5e-4<=ev(n)&&i<100;)TA(n,o=cA(a=$h(n,jh),zh),Qh),TA(a,Qh,n),TA(a,_,_),i++;return _}(n,0,yN);ch(e,NN),Ch(NN,a,NN);for(var o=NN[0],_=o,i=NN[1],s=i,l=NN[2],c=l,E=0,u=0,d=0,T=0,f=0,p=0,P=3;P<e.length;P+=3){NN[0]=e[P],NN[1]=e[P+1],NN[2]=e[P+2],Ch(NN,a,NN);var S=NN[0],A=NN[1],h=NN[2];S>o&&(o=S),S<_&&(_=S),A>i&&(i=A),A<s&&(s=A),h>l&&(l=h),h<c&&(c=h)}var v=o-_,m=i-s,g=l-c;v=Math.max(v,.001),m=Math.max(m,.001),g=Math.max(g,.001);var O=lA(LN);for(O[0]=0!=v?1/v:2e3,O[4]=0!=m?1/m:2e3,O[8]=0!=g?1/g:2e3,cA(a,YN),NN[0]=e[0],NN[1]=e[1],NN[2]=e[2],Ch(NN,a,NN),Ch(NN,O,NN),Ch(NN,YN,NN),E=NN[0],u=NN[0],d=NN[1],T=NN[1],f=NN[2],p=NN[2],P=3;P<e.length;P+=3)NN[0]=e[P],NN[1]=e[P+1],NN[2]=e[P+2],Ch(NN,a,NN),Ch(NN,O,NN),Ch(NN,YN,NN),E=Math.max(E,NN[0]),u=Math.min(u,NN[0]),d=Math.max(d,NN[1]),T=Math.min(T,NN[1]),f=Math.max(f,NN[2]),p=Math.min(p,NN[2]);var N=Math.sqrt((E-u)*(E-u)+(d-T)*(d-T)+(f-p)*(f-p))/2;N=Math.min(N,1),IN[0]=(E+u)/2,IN[1]=(d+T)/2,IN[2]=(f+p)/2;var R=IN;(O=lA(LN))[0]=v,O[4]=m,O[8]=g,Ch(R,a,R),Ch(R,O,R),Ch(R,YN,R);var I=[a[0],a[3],a[6]],b=[a[1],a[4],a[7]],y=[a[2],a[5],a[8]];return Sh(I,v*N,I),Sh(b,m*N,b),Sh(y,g*N,y),WN(I,b,y,R)}function eR(e){var t=zN(),r=0,n=mh(e.axis_x),a=mh(e.axis_y),o=mh(e.axis_z);return r=o>(r=n>a?n:a)?o:r,t.center=e.center,t.radius=r,t}function tR(e,t){var r=mh(e.axis_x),n=mh(e.axis_y),a=mh(e.axis_z);return t.radius*t.radius*t.radius*.75>r*n*a}function rR(){return{radius:0,height:0,center:new Float32Array(3)}}function nR(e,t){var r=t.max_z,n=t.min_z,a=Math.max(0,r-n-2*e),o=rR();return o.radius=e,o.height=a,o.center[0]=0,o.center[1]=0,o.center[2]=(r+n)/2,o}function aR(e,t){var r=t.max_z,n=t.min_z,a=Math.max(0,r-n),o=rR();return o.radius=e,o.height=a,o.center[0]=0,o.center[1]=0,o.center[2]=(r+n)/2,o}function oR(e,t){var r=t.max_z,n=t.min_z,a=Math.max(0,r-n),o=rR();return o.radius=e,o.height=a,o.center[0]=0,o.center[1]=0,o.center[2]=(r+n)/2,o}function _R(e,t){return t.radius=e.radius,t.height=e.height,t.center.set(e.center),t}function iR(e){for(var t=0,r=0,n={max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0},a=0;a<e.submeshes.length;a++){for(var o=e.submeshes[a],_=o.position,i=0;i<_.length/3;i++){var s=_[3*i],l=_[3*i+1],c=_[3*i+2];t=Math.max(Math.sqrt(s*s+l*l+c*c),t),r=Math.max(Math.sqrt(s*s+l*l),r)}var E=o.boundings.bb,u=FN(_,0,_.length,{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0});E.max_x=u.max_x,E.min_x=u.min_x,E.max_y=u.max_y,E.min_y=u.min_y,E.max_z=u.max_z,E.min_z=u.min_z;var d=$N(KN(u,ON),!1);o.boundings.be_cen=d.center,o.boundings.be_ax=[d.axis_x[0],d.axis_y[1],d.axis_z[2]],0==a?CN(u,n):DN(n,u)}var T=e.b4w_boundings.bb;T.max_x=n.max_x,T.min_x=n.min_x,T.max_y=n.max_y,T.min_y=n.min_y,T.max_z=n.max_z,T.min_z=n.min_z;var f=e.b4w_boundings.bb_src;f.max_x=n.max_x,f.min_x=n.min_x,f.max_y=n.max_y,f.min_y=n.min_y,f.max_z=n.max_z,f.min_z=n.min_z,e.b4w_boundings.bs_rad=t,e.b4w_boundings.bc_rad=r,d=$N(KN(n,ON),!1),e.b4w_boundings.be_cen=d.center,e.b4w_boundings.be_ax=[d.axis_x[0],d.axis_y[1],d.axis_z[2]]}function sR(e){var t=e.subarray(0,3),r=e.subarray(6,9),n=e.subarray(12,15),a=e.subarray(18,21),o=dh(r,t,NN);Rh(o,o);var _,i,s,l,c,E,u,d,T,f,p=(c=(i=r)[0]-(_=t)[0],E=(s=n)[0]-_[0],(l=RN)[0]=(u=i[1]-_[1])*(f=s[2]-_[2])-(T=i[2]-_[2])*(d=s[1]-_[1]),l[1]=E*T-c*f,l[2]=c*d-u*E,l),P=bh(p,o,p);Rh(P,P);var S=ih(),A=ih();dh(r,t,IN),A[0]=Ih(IN,o),A[1]=Ih(IN,P);var h=ih();dh(n,t,IN),h[0]=Ih(IN,o),h[1]=Ih(IN,P);var v=ih();dh(a,t,IN),v[0]=Ih(IN,o),v[1]=Ih(IN,P);var m=zN(),g=Sh(o,(m=function(e,t){t=ER(t,e[0],e[1]);for(var r=2;r<e.length;r++)hh(t.center,e[r])>t.radius&&(t=lR(t,e,e[r],r-1));return t}([S,A,h,v],m)).center[0],IN);return Ah(g,P,m.center[1],g),uh(g,t,m.center),m}function lR(e,t,r,n){e=ER(e,r,t[0]);for(var a=1;a<=n;a++)hh(e.center,t[a])>e.radius&&(e=cR(e,t,r,t[a],a-1));return e}function cR(e,t,r,n,a){e=ER(e,r,n);for(var o=0;o<=a;o++)hh(e.center,t[o])>e.radius&&(e=uR(e,r,n,t[o]));return e}function ER(e,t,r){return uh(t,r,e.center),Sh(e.center,.5,e.center),e.radius=hh(e.center,t),e}function uR(e,t,r,n){var a=gh(dh(r,n,IN)),o=gh(dh(t,n,IN)),_=gh(dh(t,r,IN)),i=a*(o+_-a),s=o*(_+a-o),l=_*(a+o-_),c=i+s+l;return ch(t,e.center),Sh(e.center,i/c,e.center),Ah(e.center,r,s/c,e.center),Ah(e.center,n,l/c,e.center),e.radius=hh(e.center,t),e}var dR=nA("__config",(function(e,t){var r=gN(e),n=mN(e);function a(){return tA.module_check(t.paths.built_in_data_module)}function o(){return t.physics.use_wasm&&window.WebAssembly}function _(){for(var e=t.paths,r=null,a=!1,o=document.getElementsByTagName("script"),_=0;_<o.length;_++){for(var i=o[_].src,s=0;s<e.js_src_search_paths.length;s++)if(i.indexOf(e.js_src_search_paths[s])>=0&&(r=i,o[_].attributes["b4w-offset"])){r=r.substring(0,r.lastIndexOf("/"))+"/"+o[_].attributes["b4w-offset"].value,a=!0;break}if(a)break}r||(n.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),r=document.location.href);var l=r.indexOf("?");return l>=0&&(r=r.substring(0,l)),r.substring(0,r.lastIndexOf("/"))}t.P_LOW=1,t.P_HIGH=2,t.P_ULTRA=3,t.P_CUSTOM=4,t.P_AUTO=5,t.context={alpha:!0,antialias:!1,premultipliedAlpha:!0},t.context_save=lO(t.context),t.defaults={alpha_sort:!0,alpha_sort_threshold:.1,min_format_version:[6,3],max_fps:1e4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,enable_texture_cache:!0,fps_measurement_interval:1,fps_callback_interval:5,background_color:[0,0,0,0],canvas_resolution_factor:1,texture_min_filter:3,allow_cors:!1,force_low_quality_nodes:!1,anisotropic_available:!0,anisotropic_filtering:!0,texture_lod_available:!1,tex_float_available:!1,tex_hfloat_available:!1,tex_float_lin_available:!1,tex_hfloat_lin_available:!1,cbuffer_float_available:!1,cbuffer_hfloat_available:!1,show_hud_debug_info:!1,depth_tex_available:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,motion_blur:!0,compositing:!0,antialiasing:!0,smaa:!1,debug_view:!1,water_wireframe_debug:!1,foam:!0,parallax:!0,dynamic_grass:!0,water_dynamic:!0,shore_smoothing:!0,shore_distance:!0,use_compression:!0,precision:"highp",quality:t.P_HIGH,allow_vertex_textures:!0,lod_leap_smooth_threshold:3,assets_gzip_available:!1,no_phy_interp_hack:!1,shader_constants_hack:!1,disable_blend_shadows_hack:!1,vert_anim_mix_normals_hack:!1,is_mobile_device:!1,init_wa_context_hack:!1,clear_procedural_sky_hack:!1,sky_update_hack:!1,seq_video_fallback:!1,allow_hidpi:!1,shadows_color_slink_hack:!1,mobile_firefox_media_hack:!1,ipad_video_hack:!1,enable_selectable:!0,enable_outlining:!0,lod_smooth_transitions:!0,glow_materials:!0,ie11_edge_touchscreen_hack:!1,firefox_tex_reuse_hack:!1,loaded_data_version:[0,0],quality_aa_method:!0,skinning_hack:!1,url_params:null,webgl2:!0,msaa_samples:4,compared_mode_depth:!1,safari_canvas_alpha_hack:!1,safari_glow_hack:!1,resize_cubemap_canvas_hack:!1,resize_texture_canvas_hack:!1,chrome_html_bkg_music_hack:!1,ie_edge_anchors_floor_hack:!1,ie11_edge_mouseoffset_hack:!1,media_auto_activation:!0,max_cast_lamps:4,mac_os_shadow_hack:!1,gl_debug:!1,check_framebuffer_hack:!1,allow_instanced_arrays_ext:!1,allow_vao_ext:!1,compress_format:"dds",shadow_blur_samples:"",reflection_quality:"",srgb_type:"SRGB_SIMPLE",ios_copy_tex_hack:!1,rgba_fallback_shadows:!1,debug_loading:!1,mali_alpha_antialias_hack:!1,mali4_lamps_hack:!1,chrome_csm_blend_hack:!1,reuse_depth_optimization:!0},t.defaults_save=lO(t.defaults),t.animation={framerate:-1,frames_blending_hack:!1,frame_steps:1},t.controls={mouse_wheel_notch_multiplier:1/120},t.assets={path:"",path_default:"B4W_ASSETS_PATH=__JS__/assets/",proj_path_default:"B4W_PROJ_ASSETS_PATH=__JS__/../projects/__NAME__/assets/",max_requests:15,prevent_caching:!0,min50_available:!1,dds_available:!1,pvr_available:!1},t.assets_save=lO(t.assets),t.paths={shaders_path:"",shaders_path_default:"../shaders/",shaders_include_dir:"include/",shaders_postp_dir:"postprocessing/",built_in_data_module:"built_in_data",js_src_search_paths:["b4w.js","b4w.min.js","b4w.simple.min.js","b4w.whitespace.min.js","b4w_app_bundle.js","B4W_MAIN_MODULE"],smaa_search_texture_path:"smaa_search_texture.png",smaa_area_texture_path:"smaa_area_texture.png"},t.hmd_params={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{distor_scale:.8,inter_lens_dist:.064,base_line_dist:.035,screen_to_lens_dist:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,0,0,0],width_dist:.11,height_dist:.062,bevel_size:.004}},t.physics={enabled:!0,max_fps:60,uranium_path:"",uranium_bin:"",uranium_path_default:"B4W_URANIUM_PATH=/dist/uranium/",asmjs_file:"uranium.js",wasmjs_file:"uranium_wasm.js",mem_file:"uranium.js.mem",wasm_file:"uranium_wasm.wasm",uranium_dir:"/dist/uranium",calc_fps:!1,ping:!1,use_workers:!0,use_wasm:!0},t.physics_save=lO(t.physics),t.scenes={grass_tex_size:1024,cubemap_tex_size:256,cube_reflect_low:32,cube_reflect_medium:128,cube_reflect_high:256,plane_reflect_low:.25,plane_reflect_medium:.5,plane_reflect_high:1},t.scenes_save=lO(t.scenes),t.sfx={webaudio:!0,mix_mode:!1,audio_loading_hack:!1,clamp_playback_rate_hack:!1,disable_playback_rate_hack:!1},t.sfx_save=lO(t.sfx),t.outlining={outlining_overview_mode:!1,outline_color:[1,.4,.05],outline_duration:.2,outline_period:3.8,outline_relapses:1},t.debug_subs={enabled:!1,subs_type:3,subs_number:1,slink_type:"COLOR"},t.debug_subs_save=lO(t.debug_subs),t.context_limits={max_combined_texture_image_units:8,max_fragment_uniform_vectors:64,max_texture_image_units:8,max_varying_vectors:8,max_vertex_attribs:15,max_vertex_texture_image_units:0,max_vertex_uniform_vectors:128,max_cube_map_texture_size:1024,max_renderbuffer_size:4096,max_texture_size:4096,max_viewport_dims:[4096,4096],depth_bits:24},t.context_limits_save=lO(t.context_limits),t.apply_quality=function(){var e=t.defaults,n=t.physics,a=t.scenes;switch(e.quality){case t.P_ULTRA:e.shadows=!0,e.shore_smoothing=!0,e.ssao=!0,e.dof=!0,e.god_rays=!0,e.bloom=!0,e.reflections=!0,e.refractions=!0,e.foam=!0,e.parallax=!0,e.dynamic_grass=!0,a.grass_tex_size=2048,a.cubemap_tex_size=512,e.texture_min_filter=3,e.anisotropic_filtering=!0,e.use_min50=!1,e.water_dynamic=!0,e.shore_distance=!0,e.antialiasing=!0,e.smaa=!1,e.compositing=!0,e.motion_blur=!0,e.allow_hidpi=!0,e.enable_outlining=!0,e.glow_materials=!0,e.msaa_samples=16,e.srgb_type="SRGB_PROPER",n.max_fps=120,e.lod_smooth_transitions=!0;break;case t.P_HIGH:e.shadows=!0,e.shore_smoothing=!0,e.ssao=!0,e.dof=!0,e.god_rays=!0,e.bloom=!0,e.reflections=!0,e.refractions=!0,e.foam=!0,e.parallax=!0,e.dynamic_grass=!0,a.grass_tex_size=1024,a.cubemap_tex_size=256,e.texture_min_filter=3,e.anisotropic_filtering=!0,e.use_min50=!1,e.water_dynamic=!0,e.shore_distance=!0,e.antialiasing=!0,e.smaa=!1,e.compositing=!0,e.motion_blur=!0,e.allow_hidpi=!1,e.enable_outlining=!0,e.glow_materials=!0,e.srgb_type="SRGB_SIMPLE",e.msaa_samples=4,n.max_fps=60,e.lod_smooth_transitions=!0;break;case t.P_LOW:e.shadows=!1,e.shore_smoothing=!1,e.ssao=!1,e.dof=!1,e.god_rays=!1,e.bloom=!1,e.reflections=!1,e.refractions=!1,e.foam=!1,e.parallax=!1,e.dynamic_grass=!1,a.grass_tex_size=512,a.cubemap_tex_size=256,e.texture_min_filter=2,e.anisotropic_filtering=!1,e.use_min50=!0,e.water_dynamic=!1,e.shore_distance=!1,e.antialiasing=!1,e.smaa=!1,e.compositing=!1,e.motion_blur=!1,e.allow_hidpi=!1,e.enable_outlining=!1,e.glow_materials=!1,e.srgb_type="SRGB_SIMPLE",e.msaa_samples=1,n.max_fps=60,e.lod_smooth_transitions=!1;break;case t.P_CUSTOM:break;case t.P_AUTO:r.panic("Direct AUTO quality profile setting is forbidden")}},t.set=function(e,r){switch(e){case"allow_cors":t.defaults.allow_cors=r;break;case"allow_hidpi":t.defaults.allow_hidpi=r;break;case"alpha":t.context.alpha=r;break;case"alpha_sort":t.defaults.alpha_sort=r;break;case"alpha_sort_threshold":t.defaults.alpha_sort_threshold=r;break;case"anaglyph_use":n.error_deprecated_cfg("anaglyph_use","stereo"),t.defaults.stereo=r?"ANAGLYPH":t.defaults.stereo;break;case"animation_framerate":t.animation.framerate=r;break;case"anisotropic_filtering":t.defaults.anisotropic_filtering=r;break;case"antialiasing":t.defaults.antialiasing=r;break;case"assets_dir":case"assets_path":t.assets.path=r;break;case"assets_dds_available":t.assets.dds_available=r;break;case"assets_pvr_available":t.assets.pvr_available=r;break;case"assets_min50_available":t.assets.min50_available=r;break;case"audio":t.sfx.webaudio=r;break;case"background_color":t.defaults.background_color=r;break;case"bloom":t.defaults.bloom=r;break;case"built_in_module_name":t.paths.built_in_data_module=r;break;case"canvas_resolution_factor":t.defaults.canvas_resolution_factor=r;break;case"console_verbose":t.defaults.console_verbose=r;break;case"compositing":t.defaults.compositing=r;break;case"dof":t.defaults.dof=r;break;case"do_not_load_resources":t.defaults.do_not_load_resources=r;break;case"god_rays":t.defaults.god_rays=r;break;case"stereo":t.defaults.stereo=r;break;case"lod_leap_smooth_threshold":t.defaults.lod_leap_smooth_threshold=r;break;case"lod_smooth_transitions":t.defaults.lod_smooth_transitions=r;break;case"max_fps":t.defaults.max_fps=r;break;case"max_fps_physics":t.physics.max_fps=r;break;case"media_auto_activation":t.defaults.media_auto_activation=r;break;case"motion_blur":t.defaults.motion_blur=r;break;case"physics_enabled":t.physics.enabled=r;break;case"physics_uranium_path":o()?(t.physics.uranium_path=r+t.physics.wasmjs_file,t.physics.uranium_bin=r+t.physics.wasm_file):(t.physics.uranium_path=r+t.physics.asmjs_file,t.physics.uranium_bin=r+t.physics.mem_file),t.physics.uranium_dir=r;break;case"physics_use_wasm":t.physics.use_wasm=r;break;case"physics_calc_fps":t.physics.calc_fps=r;break;case"physics_use_workers":t.physics.use_workers=r;break;case"precision":t.defaults.precision=r;break;case"prevent_caching":t.assets.prevent_caching=r;break;case"quality":t.defaults.quality=r;break;case"reflections":t.defaults.reflections=r;break;case"refractions":t.defaults.refractions=r;break;case"sfx_mix_mode":t.sfx.mix_mode=r;break;case"shaders_dir":case"shaders_path":t.paths.shaders_path=r;break;case"shadows":t.defaults.shadows=r;break;case"show_hud_debug_info":t.defaults.show_hud_debug_info=r;break;case"smaa":n.error_deprecated_cfg("smaa"),t.defaults.smaa=r;break;case"smaa_search_texture_path":n.error_deprecated_cfg("smaa_search_texture_path"),t.paths.smaa_search_texture_path=r;break;case"smaa_area_texture_path":n.error_deprecated_cfg("smaa_area_texture_path"),t.paths.smaa_area_texture_path=r;break;case"ssao":t.defaults.ssao=r;break;case"debug_view":t.defaults.debug_view=r;break;case"enable_selectable":t.defaults.enable_selectable=r;break;case"enable_outlining":t.defaults.enable_outlining=r;break;case"outlining_overview_mode":t.outlining.outlining_overview_mode=r;break;case"glow_materials":t.defaults.glow_materials=r;break;case"url_params":t.defaults.url_params=r;break;case"use_min50":t.defaults.use_min50=r;break;case"enable_texture_cache":t.defaults.enable_texture_cache=r;break;case"gl_debug":t.defaults.gl_debug=r;break;case"srgb_type":t.defaults.srgb_type=r;break;case"shadow_blur_samples":t.defaults.shadow_blur_samples=r;break;case"reflection_quality":t.defaults.reflection_quality=r;break;case"assets_gzip_available":t.defaults.assets_gzip_available=r;break;case"debug_loading":t.defaults.debug_loading=r;break;case"msaa_samples":t.defaults.msaa_samples=r;break;default:n.error("Unknown config property: "+e)}},t.get=function(e){switch(e){case"allow_cors":return t.defaults.allow_cors;case"allow_hidpi":return t.defaults.allow_hidpi;case"alpha":return t.context.alpha;case"alpha_sort":return t.defaults.alpha_sort;case"alpha_sort_threshold":return t.defaults.alpha_sort_threshold;case"anaglyph_use":return"ANAGLYPH"==t.defaults.stereo;case"animation_framerate":return t.animation.framerate;case"anisotropic_filtering":return t.defaults.anisotropic_filtering;case"antialiasing":return t.defaults.antialiasing;case"assets_dir":case"assets_path":return t.assets.path;case"assets_dds_available":return t.assets.dds_available;case"assets_pvr_available":return t.assets.pvr_available;case"assets_min50_available":return t.assets.min50_available;case"audio":return t.sfx.webaudio;case"background_color":return t.defaults.background_color;case"bloom":return t.defaults.bloom;case"built_in_module_name":return t.paths.built_in_data_module;case"canvas_resolution_factor":return t.defaults.canvas_resolution_factor;case"console_verbose":return t.defaults.console_verbose;case"compositing":return t.defaults.compositing;case"dof":return t.defaults.dof;case"do_not_load_resources":return t.defaults.do_not_load_resources;case"is_mobile_device":return t.defaults.is_mobile_device;case"god_rays":return t.defaults.god_rays;case"stereo":return t.defaults.stereo;case"lod_leap_smooth_threshold":return t.defaults.lod_leap_smooth_threshold;case"lod_smooth_transitions":return t.defaults.lod_smooth_transitions;case"max_fps":return t.defaults.max_fps;case"max_fps_physics":return t.physics.max_fps;case"media_auto_activation":return t.defaults.media_auto_activation;case"motion_blur":return t.defaults.motion_blur;case"physics_enabled":return t.physics.enabled;case"physics_uranium_path":return t.physics.uranium_dir;case"physics_uranium_bin":return t.physics.uranium_bin;case"physics_use_wasm":return t.physics.use_wasm;case"physics_calc_fps":return t.physics.calc_fps;case"physics_use_workers":return t.physics.use_workers;case"precision":return t.defaults.precision;case"prevent_caching":return t.assets.prevent_caching;case"quality":return t.defaults.quality;case"reflections":return t.defaults.reflections;case"refractions":return t.defaults.refractions;case"sfx_mix_mode":return t.sfx.mix_mode;case"shaders_dir":case"shaders_path":return t.paths.shaders_path;case"shadows":return t.defaults.shadows;case"show_hud_debug_info":return t.defaults.show_hud_debug_info;case"smaa":return t.defaults.smaa;case"smaa_search_texture_path":return t.paths.smaa_search_texture_path;case"smaa_area_texture_path":return t.paths.smaa_area_texture_path;case"ssao":return t.defaults.ssao;case"debug_view":return t.defaults.debug_view;case"enable_selectable":return t.defaults.enable_selectable;case"enable_outlining":return t.defaults.enable_outlining;case"outlining_overview_mode":return t.outlining.outlining_overview_mode;case"glow_materials":return t.defaults.glow_materials;case"url_params":return t.defaults.url_params;case"use_min50":return t.defaults.use_min50;case"enable_texture_cache":return t.defaults.enable_texture_cache;case"gl_debug":return t.defaults.gl_debug;case"srgb_type":return t.defaults.srgb_type;case"shadow_blur_samples":return t.defaults.shadow_blur_samples;case"reflection_quality":return t.defaults.reflection_quality;case"assets_gzip_available":return t.defaults.assets_gzip_available;case"debug_loading":return t.defaults.debug_loading;case"msaa_samples":return t.defaults.msaa_samples;default:n.error("Unknown config property: "+e)}},t.reset=function(){for(var e in t.context_save)t.context[e]=t.context_save[e];for(var e in t.defaults_save)t.defaults[e]=t.defaults_save[e];for(var e in t.assets_save)t.assets[e]=t.assets_save[e];for(var e in t.physics_save)t.physics[e]=t.physics_save[e];for(var e in t.scenes_save)t.scenes[e]=t.scenes_save[e];for(var e in t.sfx_save)t.sfx[e]=t.sfx_save[e];for(var e in t.debug_subs_save)t.debug_subs[e]=t.debug_subs_save[e]},t.reset_limits=function(){var e=t.context_limits.depth_bits;for(var r in t.context_limits_save)t.context_limits[r]=t.context_limits_save[r];t.context_limits.depth_bits=e},t.is_built_in_data=a,t.set_paths=function(){var e=t.paths,r=t.physics;if(a()||""!=e.shaders_path||(e.shaders_path=_()+"/"+e.shaders_path_default),o())var n=r.uranium_path_default+r.wasmjs_file,i=r.uranium_path_default+r.wasm_file;else n=r.uranium_path_default+r.asmjs_file,i=r.uranium_path_default+r.mem_file;r.enabled&&""==r.uranium_path&&(r.uranium_path=n.replace("B4W_URANIUM_PATH=",""),r.uranium_bin=i.replace("B4W_URANIUM_PATH=",""))},t.get_assets_path=function(e){var r=t.assets;if(r.path)return r.path;var n=r.path_default,a="B4W_ASSETS_PATH=";return e&&(a="B4W_PROJ_ASSETS_PATH=",n=(n=r.proj_path_default).replace("__NAME__",e)),(n=n.replace(a,"")).replace("__JS__",_())}})),TR=nA("generator",(function(e,t){var r=gN(e),n=mN(e),a=1,o=0,_={},i=new Float64Array(1),s=new Uint32Array(i.buffer);function l(e,t){var n=t;switch(typeof e){case"object":if(e)switch(e.constructor){case Object:for(var a in e)n=l(e[a],n);break;case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:for(var o=0;o<e.length;o++)n=c(e[o],n);break;case Array:for(o=0;o<e.length;o++)n=l(e[o],n);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:n=c(0,n);break;default:r.panic("Wrong object constructor:",e.constructor)}else n=c(0,n);return n;case"number":return c(e,n);case"boolean":return c(0|e,n);case"string":return function(e,t){for(var r=t,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r&=r;return r}(e,n);case"function":case"undefined":return c(0,n)}}function c(e,t){var r=t;return i[0]=e,r=(r<<5)-r+s[0],(r=((r&=r)<<5)-r+s[1])&r}t.unique_name=function(e){_[e]||(_[e]=0);var t=e+_[e];return _[e]++,t},t.cleanup=function(){o=0,_={}},t.unique_id=function(){return(++o).toString(10)},t.gen_color_id=function(e){++e>132651&&n.error("Color ID pool depleted");var t=Math.floor(e/2601);e%=2601;var r=Math.floor(e/51);return e%=51,new Float32Array([t/51,r/51,e/51])},t.rand=function(){return a=(69069*a+5)%Math.pow(2,32),Math.round(a/65536)%32768/32767},t.srand=function(e){a=e},t.calc_variable_id=function(e,t){return l(e,t)},t.hash_code=l})),fR=nA("__extensions",(function(e,t){var r=dR(e),n=mN(e),a=r.defaults,o=null,_={};function i(){return a.webgl2?c("OES_texture_float_linear"):l("OES_texture_float_linear")}function s(){return a.webgl2?c("EXT_color_buffer_float"):l("WEBGL_color_buffer_float")}function l(e){if(e in _)return _[e];var t=o.getExtension(e)||null;if(_[e]=t,t)var r="0a0";else r="a00";return n.log("%cGET EXTENSION","color: #"+r,e),t}function c(e){if(e in _)return _[e];switch(e){case"WEBGL_depth_texture":case"OES_element_index_uint":case"OES_standard_derivatives":case"EXT_shader_texture_lod":case"OES_texture_float":case"OES_texture_half_float":var t={};break;case"ANGLE_instanced_arrays":case"OES_vertex_array_object":t=o;break;default:t=o.getExtension(e)||null}if(_[e]=t,t)var r="0a0";else r="a00";return n.log("%cGET EXTENSION (WebGL 2)","color: #"+r,e),t}t.setup_context=function(e){o=e},t.get_s3tc=function(){return l("WEBGL_compressed_texture_s3tc")||l("WEBKIT_WEBGL_compressed_texture_s3tc")},t.get_pvr=function(){return l("WEBKIT_WEBGL_compressed_texture_pvrtc")||l("WEBGL_compressed_texture_pvrtc")},t.get_depth_texture=function(){return a.webgl2?c("WEBGL_depth_texture"):l("WEBGL_depth_texture")||l("WEBKIT_WEBGL_depth_texture")},t.get_texture_float=function(){return a.webgl2?c("OES_texture_float"):l("OES_texture_float")},t.get_texture_half_float=function(){return a.webgl2?c("OES_texture_half_float"):l("OES_texture_half_float")},t.get_texture_float_linear=i,t.get_texture_half_float_linear=function(){return a.webgl2?i():l("OES_texture_half_float_linear")},t.get_color_buffer_float=s,t.get_color_buffer_half_float=function(){return a.webgl2?s():l("EXT_color_buffer_half_float")},t.get_aniso=function(){return l("EXT_texture_filter_anisotropic")||l("WEBKIT_EXT_texture_filter_anisotropic")},t.get_texture_lod=function(){return a.webgl2?c("EXT_shader_texture_lod"):l("EXT_shader_texture_lod")},t.get_debug_shaders=function(){return l("WEBGL_debug_shaders")},t.get_renderer_info=function(){return l("WEBGL_debug_renderer_info")},t.get_elem_index_uint=function(){return a.webgl2?c("OES_element_index_uint"):l("OES_element_index_uint")},t.get_standard_derivatives=function(){return a.webgl2?c("OES_standard_derivatives"):l("OES_standard_derivatives")},t.get_disjoint_timer_query=function(){if(a.webgl2)var e=c("EXT_disjoint_timer_query_webgl2");else e=l("EXT_disjoint_timer_query");if(null==e)return e;if(e.createQueryEXT)var t={createQuery:function(){return e.createQueryEXT()},beginQuery:function(t){e.beginQueryEXT(e.TIME_ELAPSED_EXT,t)},endQuery:function(){e.endQueryEXT(e.TIME_ELAPSED_EXT)},getQueryAvailable:function(t){return e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT)},getQueryObject:function(t){return e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT)},getDisjoint:function(){return o.getParameter(e.GPU_DISJOINT_EXT)}};else t={createQuery:function(){return o.createQuery()},beginQuery:function(t){o.beginQuery(e.TIME_ELAPSED_EXT,t)},endQuery:function(){o.endQuery(e.TIME_ELAPSED_EXT)},getQueryAvailable:function(e){return o.getQueryParameter(e,o.QUERY_RESULT_AVAILABLE)},getQueryObject:function(e){return o.getQueryParameter(e,o.QUERY_RESULT)},getDisjoint:function(){return o.getParameter(e.GPU_DISJOINT_EXT)}};return t},t.get_instanced_arrays=function(){if(a.webgl2)return c("ANGLE_instanced_arrays");var e=l("ANGLE_instanced_arrays");return null==e?e:{drawElementsInstanced:function(t,r,n,a,o){e.drawElementsInstancedANGLE(t,r,n,a,o)},vertexAttribDivisor:function(t,r){e.vertexAttribDivisorANGLE(t,r)},drawArraysInstanced:function(t,r,n,a){e.drawArraysInstancedANGLE(t,r,n,a)}}},t.get_vertex_array_object=function(){if(a.webgl2)return c("OES_vertex_array_object");var e=l("OES_vertex_array_object");return null==e?e:{bindVertexArray:function(t){e.bindVertexArrayOES(t)},createVertexArray:function(){return e.createVertexArrayOES()},deleteVertexArray:function(t){e.deleteVertexArrayOES(t)},isVertexArray:function(t){return e.isVertexArrayOES(t)}}},t.cleanup=function(){_={}},t.reset=function(){o=null}})),pR=nA("__graph",(function(e,t){var r=gN(e),n=[-1,-1];function a(e,t,n){n||(n=null),o(e,t)?r.panic("Graph already has node with given ID"):e.nodes.push(t,n)}function o(e,t){for(var r=e.nodes,n=0;n<r.length;n+=2)if(r[n]==t)return!0;return!1}function _(e,t,n,a){a||(a=null),o(e,t)&&o(e,n)?e.edges.push(t,n,a):r.panic("Wrong node IDs")}function i(e,t){o(e,t)||r.panic("Node not found");for(var n=e.nodes,a=0;a<n.length;a+=2)n[a]==t&&(n.splice(a,2),a-=2)}function s(e,t,n,a){R(e,t,n)||r.panic("Edge not found");for(var o=e.edges,_=0,i=0;i<o.length;i+=3)if(o[i]==t&&o[i+1]==n){if(-1==a)o.splice(i,3);else{if(a==_){o.splice(i,3);break}_++}i-=3}}function l(e){for(var t=e.nodes,r=-1,n=0;n<t.length;n+=2)r=Math.max(r,t[n]);return++r}function c(e,t){for(var r=e.nodes,n=0;n<r.length;n+=2)if(r[n+1]==t)return r[n];return-1}function E(e){var t=[],r={};u(e,r);for(var n=e.nodes,a=0;a<n.length;a+=2)0==g(e,n[a])&&d(e,n[a],r,t);return{nodes:t,edges:e.edges.slice(0)}}function u(e,t){for(var r=e.nodes,n=0;n<r.length;n+=2)t[r[n]]=!1}function d(e,t,r,n){if(!r[t]){r[t]=!0;for(var a=0;a<m(e,t);a++)d(e,O(e,t,a),r,n);n.unshift(t,v(e,t))}}function T(e){for(var t=e.edges,r=0;r<t.length;r+=3){var n=t[r+1];o(e,t[r])&&o(e,n)||(t.splice(r,3),r-=3)}}function f(e){for(var t=[],r=e.nodes,n=0;n<r.length;n+=2){var a=r[n];m(e,a)||t.push(a)}return t}function p(e){return e.nodes.length/2}function P(e){for(var t=e.nodes,r=e.edges,n=[],a=[],o=[],_=0;_<t.length;_++)o[t[2*_]]=_,n.push(_,t[2*_+1]);for(_=0;_<r.length;_+=3)a.push(o[r[_]],o[r[_+1]],r[_+2]);return{nodes:n,edges:a}}function S(e,t,r,n){-1==r&&(r=0),-1==n?n=0:n++;var a=e.t1both_len,o=e.t2both_len,_=e.t1out_len,i=e.t2out_len,s=e.t1in_len,l=e.t2in_len,c=e.core_len,E=e.n1,u=e.n2,d=e.core_1,T=e.core_2,f=e.in_1,p=e.in_2,P=e.out_1,S=e.out_2;if(a>c&&o>c)for(;r<E&&(-1!=d[r]||0==P[r]||0==f[r]);)r++,n=0;else if(_>c&&i>c)for(;r<E&&(-1!=d[r]||0==P[r]);)r++,n=0;else if(s>c&&l>c)for(;r<E&&(-1!=d[r]||0==f[r]);)r++,n=0;else if(0==r&&0!=e.order){for(var A=0;A<E&&-1!=d[r=e.order[A]];)A++;A==E&&(r=E)}else for(;r<E&&-1!=d[r];)r++,n=0;if(a>c&&o>c)for(;n<u&&(-1!=T[n]||0==S[n]||0==p[n]);)n++;else if(_>c&&i>c)for(;n<u&&(-1!=T[n]||0==S[n]);)n++;else if(s>c&&l>c)for(;n<u&&(-1!=T[n]||0==p[n]);)n++;else for(;n<u&&-1!=T[n];)n++;return r<E&&n<u&&(t[0]=r,t[1]=n,!0)}function A(e,t,r){var n=e.g1,a=e.g2,o=e.n2,_=e.core_1,i=e.core_2,s=e.in_1,l=e.in_2,c=e.out_1,E=e.out_2;if(h(t<e.n1),h(r<o),h(-1==_[t]),h(-1==i[r]),!function(e,t,r,n,a){return!!e(v(t,r),v(n,a))}(e.node_comp,n,t,a,r))return!1;for(var u=0,d=0,T=0,f=0,p=0,P=0,S=0;S<m(n,t);S++)if(-1!=_[b=O(n,t,S)]){if(!R(a,r,A=_[b])||!I(e.edge_comp,n,t,b,a,r,A))return!1}else s[b]&&T++,c[b]&&u++,s[b]||c[b]||p++;for(S=0;S<g(n,t);S++)if(-1!=_[b=N(n,t,S)]){if(!R(a,A=_[b],r)||!I(e.edge_comp,n,b,t,a,A,r))return!1}else s[b]&&T++,c[b]&&u++,s[b]||c[b]||p++;for(S=0;S<m(a,r);S++)if(-1!=i[A=O(a,r,S)]){if(!R(n,t,b=i[A]))return!1}else l[A]&&f++,E[A]&&d++,l[A]||E[A]||P++;for(S=0;S<g(a,r);S++){var A,b;if(-1!=i[A=N(a,r,S)]){if(!R(n,b=i[A],t))return!1}else l[A]&&f++,E[A]&&d++,l[A]||E[A]||P++}return T<=f&&u<=d&&p<=P}function h(e){e||r.panic("Assertion failed")}function v(e,t){for(var r=e.nodes,n=0;n<r.length;n+=2)if(r[n]==t)return r[n+1];return null}function m(e,t){for(var r=e.edges,n=0,a=0;a<r.length;a+=3)r[a]==t&&n++;return n}function g(e,t){for(var r=e.edges,n=0,a=0;a<r.length;a+=3)r[a+1]==t&&n++;return n}function O(e,t,r){for(var n=e.edges,a=0,o=0;o<n.length;o+=3)if(n[o]==t){if(a==r)return n[o+1];a++}return-1}function N(e,t,r){for(var n=e.edges,a=0,o=0;o<n.length;o+=3)if(n[o+1]==t){if(a==r)return n[o];a++}return-1}function R(e,t,r){for(var n=e.edges,a=0;a<n.length;a+=3)if(n[a]==t&&n[a+1]==r)return!0;return!1}function I(e,t,r,n,a,o,_){for(var i=b(t,r,n),s=b(a,o,_),l=0;l<i;l++){for(var c=!1,E=0;E<s;E++)if(e(y(t,r,n,l),y(a,o,_,E))){c=!0;break}if(!c)return!1}return!0}function b(e,t,r){for(var n=0,a=e.edges,o=0;o<a.length;o+=3)a[o]==t&&a[o+1]==r&&n++;return n}function y(e,t,r,n){for(var a=e.edges,o=0,_=0;_<a.length;_+=3)if(a[_]==t&&a[_+1]==r){if(o==n)return a[_+2];o++}return null}function L(e,t,r){var n=e.g1,a=e.g2,o=e.n1,_=e.n2,i=e.core_1,s=e.core_2,l=e.in_1,c=e.in_2,E=e.out_1,u=e.out_2;h(t<o),h(r<_),h(e.core_len<o),h(e.core_len<_);var d=++e.core_len;e.added_node1=t,l[t]||(l[t]=d,e.t1in_len++,E[t]&&e.t1both_len++),E[t]||(E[t]=d,e.t1out_len++,l[t]&&e.t1both_len++),c[r]||(c[r]=d,e.t2in_len++,u[r]&&e.t2both_len++),u[r]||(u[r]=d,e.t2out_len++,c[r]&&e.t2both_len++),i[t]=r,s[r]=t;for(var T=0;T<g(n,t);T++)l[f=N(n,t,T)]||(l[f]=d,e.t1in_len++,E[f]&&e.t1both_len++);for(T=0;T<m(n,t);T++)E[f=O(n,t,T)]||(E[f]=d,e.t1out_len++,l[f]&&e.t1both_len++);for(T=0;T<g(a,r);T++)c[f=N(a,r,T)]||(c[f]=d,e.t2in_len++,u[f]&&e.t2both_len++);for(T=0;T<m(a,r);T++){var f;u[f=O(a,r,T)]||(u[f]=d,e.t2out_len++,c[f]&&e.t2both_len++)}}function Y(e){h(e.core_len-e.orig_core_len<=1),h(-1!=e.added_node1);var t=e.g1,r=e.g2,n=e.core_len,a=e.added_node1,o=e.core_1,_=e.core_2,i=e.in_1,s=e.in_2,l=e.out_1,c=e.out_2;if(e.orig_core_len<n){i[a]==n&&(i[a]=0);for(var E=0;E<g(t,a);E++)i[d=N(t,a,E)]==n&&(i[d]=0);for(l[a]==n&&(l[a]=0),E=0;E<m(t,a);E++)l[d=O(t,a,E)]==n&&(l[d]=0);var u=o[a];for(s[u]==n&&(s[u]=0),E=0;E<g(r,u);E++)s[d=N(r,u,E)]==n&&(s[d]=0);for(c[u]==n&&(c[u]=0),E=0;E<m(r,u);E++){var d;c[d=O(r,u,E)]==n&&(c[d]=0)}o[a]=-1,_[u]=-1,e.core_len=e.orig_core_len,e.added_node1=-1}}function M(e){var t={};return t.g1=e.g1,t.g2=e.g2,t.node_comp=e.node_comp,t.edge_comp=e.edge_comp,t.n1=e.n1,t.n2=e.n2,t.order=e.order,t.core_len=t.orig_core_len=e.core_len,t.t1in_len=e.t1in_len,t.t1out_len=e.t1out_len,t.t1both_len=e.t1both_len,t.t2in_len=e.t2in_len,t.t2out_len=e.t2out_len,t.t2both_len=e.t2both_len,t.added_node1=-1,t.core_1=e.core_1,t.core_2=e.core_2,t.in_1=e.in_1,t.in_2=e.in_2,t.out_1=e.out_1,t.out_2=e.out_2,t.share_count=e.share_count,e.share_count[0]+=1,t}t.NULL_NODE=-1,t.FORWARD_DIR=10,t.BACKWARD_DIR=20,t.TWO_WAY=30,t.create=function(){for(var e=arguments,t=[],n=[],a=0;a<e.length;a++){var o=e[a];switch(o.length){case 2:t.push(o[0],o[1]);break;case 3:n.push(o[0],o[1],o[2]);break;default:r.panic("Wrong graph constructor params")}}var _={nodes:t,edges:n};return _},t.clone=function(e,t,r){if(t)for(var n=new Array(e.nodes.length),a=0;a<e.nodes.length;a+=2)n[a]=e.nodes[a],n[a+1]=t(e.nodes[a+1]);else n=lO(e.nodes);if(r){var o=new Array(e.edges.length);for(a=0;a<e.edges.length;a+=3)o[a]=e.edges[a],o[a+1]=e.edges[a+1],o[a+2]=r(e.edges[a+2])}else o=lO(e.edges);return{nodes:n,edges:o}},t.create_node_edge_arr=function(e,t){for(var r=[],n=[],a=0;a<e.length;a++)r.push(e[a][0],e[a][1]);for(a=0;a<t.length;a++)n.push(t[a][0],t[a][1],t[a][2]);return{nodes:r,edges:n}},t.append_node=a,t.has_node=o,t.append_edge=_,t.remove_node=i,t.remove_edge=s,t.remove_edge_by_attr=function(e,t,n,a){R(e,t,n)||r.panic("Edge not found");for(var o=e.edges,_=0;_<o.length;_+=3)if(o[_]==t&&o[_+1]==n&&o[_+2][0]==a[0]&&o[_+2][1]==a[1]){o.splice(_,3);break}},t.append_node_attr=function(e,t){if(-1==c(e,t)){var n=l(e);return a(e,n,t),n}r.panic("Non-unique attribute")},t.replace_edge_attr=function(e,t,r,n,a){for(var o=e.edges,_=0;_<o.length;_+=3)o[_]==t&&o[_+1]==r&&o[_+2]==n&&(o[_+2]=a)},t.append_subgraph=function(e,t,r,n){r=r||[],n=n||[];for(var o={},i=0;i<e.nodes.length;i+=2){var s=e.nodes[i],c=e.nodes[i+1],E=l(t);a(t,E,c),o[s]=E}for(i=0;i<e.edges.length;i+=3)_(t,o[e.edges[i]],o[e.edges[i+1]],e.edges[i+2]);for(i=0;i<r.length;i+=3)_(t,o[r[i]],r[i+1],r[i+2]);for(i=0;i<n.length;i+=3)_(t,n[i],o[n[i+1]],n[i+2])},t.gen_node_id=l,t.node_by_attr=c,t.append_edge_attr=function(e,t,n,a){var o=c(e,t),i=c(e,n);-1!=o&&-1!=i?_(e,o,i,a):r.panic("Attributes not found")},t.traverse=function(e,t){for(var r=e.nodes,n=0;n<r.length&&!t(r[n],r[n+1]);n+=2);},t.traverse_edges=function(e,t){for(var r=e.edges,n=0;n<r.length&&!t(r[n],r[n+1],r[n+2]);n+=3);},t.traverse_inputs=function(e,t,r){for(var n=e.edges,a=0;a<n.length;a+=3)if(n[a+1]==t){var o=n[a];if(r(o,v(e,o),n[a+2]))return}},t.traverse_outputs=function(e,t,r){for(var n=e.edges,a=0;a<n.length;a+=3)if(n[a]==t){var o=n[a+1];if(r(o,v(e,o),n[a+2]))return}},t.topsort=E,t.topsort_attr=function(e){for(var t=E(e).nodes,r=[],n=0;n<t.length;n+=2)r.push(t[n+1]);return r},t.is_connected=function(e){},t.subgraph_node_conn=function(e,t,n){o(e,t)||r.panic("No such node");var a={};u(e,a),function e(t,r,n,a){if(!n[r]){if(n[r]=!0,10==a||30==a)for(var o=0;o<m(t,r);o++){var _=O(t,r,o);e(t,_,n,a)}if(20==a||30==a)for(o=0;o<g(t,r);o++)e(t,_=N(t,r,o),n,a)}}(e,t,a,n);var _=[];for(var i in a)a[i]&&(i=Number(i),_.push(i,v(e,i)));var s={nodes:_,edges:e.edges.slice(0)};return T(s),s},t.cleanup_loose_edges=T,t.get_source_nodes=function(e){for(var t=[],r=e.nodes,n=0;n<r.length;n+=2){var a=r[n];g(e,a)||t.push(a)}return t},t.get_sink_nodes=f,t.match=function(e,t,r,a){var o={};o.g1=P(e),o.g2=P(t),o.node_comp=r||function(e,t){return e==t},o.edge_comp=a||function(e,t){return e==t};var _=p(e),i=p(t);o.n1=_,o.n2=i,o.order=0,o.core_len=o.orig_core_len=0,o.t1both_len=o.t1in_len=o.t1out_len=0,o.t2both_len=o.t2in_len=o.t2out_len=0,o.added_node1=-1,o.core_1=Array(_),o.core_2=Array(i),o.in_1=new Array(_),o.in_2=new Array(i),o.out_1=new Array(_),o.out_2=new Array(i),o.share_count=[1];for(var s=0;s<_;s++)o.core_1[s]=-1,o.in_1[s]=0,o.out_1[s]=0;for(s=0;s<i;s++)o.core_2[s]=-1,o.in_2[s]=0,o.out_2[s]=0;var l=new Array(_),c=new Array(_);if(function e(t,r,a){if(function(e){return e.core_len==e.n1}(a))return function(e,t,r){for(var n=0,a=0;n<e.n1;n++)-1!=e.core_1[n]&&(t[a]=n,r[a]=e.core_1[n],a++)}(a,t,r),!0;if(function(e){return e.n1>e.n2||e.t1both_len>e.t2both_len||e.t1out_len>e.t2out_len||e.t1in_len>e.t2in_len}(a))return!1;for(var o=-1,_=-1,i=!1;!i&&S(a,n,o,_);)if(A(a,o=n[0],_=n[1])){var s=M(a);L(s,o,_),i=e(t,r,s),Y(s)}return i}(l,c,o)){for(s=0;s<l.length;s++)l[s]=e.nodes[2*l[s]],c[s]=t.nodes[2*c[s]];return[l,c]}return null},t.get_node_id=function(e,t){for(var r=e.nodes,n=1;n<r.length;n+=2)if(r[n]==t)return r[n-1];return null},t.get_node_attr=v,t.out_edge_count=m,t.in_edge_count=g,t.get_out_edge=O,t.get_in_edge=N,t.get_edge_count=b,t.get_edge_attr=y,t.replace=function(e,t,r){for(var n=e.edges,o=l(e),_=0;_<t.length;_++){var s=t[_];i(e,s);for(var c=0;c<n.length;c+=3)n[c]==s&&(n[c]=o),n[c+1]==s&&(n[c+1]=o),n[c]==n[c+1]&&(n.splice(c,3),c-=3)}a(e,o,r)},t.reconnect_edges=function(e,t,n,a,o){R(e,t,n)||r.panic("Edge not found");for(var _=e.edges,i=0;i<_.length;i+=3)_[i]==t&&_[i+1]==n&&(_[i]=a,_[i+1]=o)},t.enforce_acyclic=function(e,t){t||(t=f(e)[0]);var r=e.edges;if(!r.length||-1==r.indexOf(t))return e;for(var n={},a=0,o=0;o<r.length;o+=3)r[o+1]in n?n[r[o+1]].push(r[o]):n[r[o+1]]=[r[o]],a++;var _=[],i=[];for(function e(t,r){if(-1!=_.indexOf(t)){var a=_.slice(_.indexOf(t));if(-1!=n[a[a.length-1]].indexOf(a[0]))return void i.push([t,a[a.length-1]])}_.push(t);for(var o=0;o<r.length;o++)r[o]in n&&e(r[o],n[r[o]])}(t,n[t]),o=0;o<i.length;o++){a=0;for(var l=0;l<r.length;l+=3)i[o][1]==r[l+1]&&i[o][0]==r[l]&&s(e,r[l],r[l+1],a),a++}return e},t.debug_dot=function(e,t,r){var n=e.nodes,a=e.edges,o="digraph debug {\n";o+="    ",o+="node [shape=box];\n";for(var _=0;_<n.length;_+=2){var i=n[_],s=n[_+1],l=t?t(i,s):String(i);o+="    ",o+=String(i)+' [label="'+l.replace(/\"/g,'\\"')+'"];\n'}for(_=0;_<a.length;_+=3){var c=a[_],E=a[_+1];s=a[_+2],o+="    ",o+=String(c)+" -> "+String(E),r&&(o+=' [label="'+r(c,E,s)+'"]'),o+=";\n"}return o+"}"}})),PR=nA("__debug_nodegraph",(function(e,t){var r=pR(e);t.nodegraph_to_dot=function(e,t){if(t)var n=function(e,t){var r=t.type+"("+t.name+")",n=t.inputs;if(r+="\n\nINPUTS:",n.length)for(var a=0;a<n.length;a++)r+="\n"+n[a].identifier+": ",r+=n[a].is_linked?"linked":n[a].default_value;else r+="\n---";var o=t.outputs;if(r+="\n\nOUTPUTS:",o.length)for(a=0;a<o.length;a++)r+="\n"+o[a].identifier+": ",r+=o[a].is_linked?"linked(default "+o[a].default_value+")":"not used";else r+="\n---";return(r+="\n\nDATA:")+function(e){var t="";switch(e.type){case"GEOMETRY_UV":t="\nuv_layer: "+e.data.value;break;case"TEXTURE_COLOR":case"TEXTURE_NORMAL":t="\ntexture: "+e.data.value.name+"\n("+e.data.value.img_filepath+")"}return""==t&&(t="\n---"),t}(t)},a=function(t,n,a){var o=r.get_node_attr(e,t),_=r.get_node_attr(e,n);return o.outputs[a[0]].identifier+"\n==>\n"+_.inputs[a[1]].identifier};else n=function(e,t){return t.type},a=function(t,n,a){var o=r.get_node_attr(e,t),_=r.get_node_attr(e,n);return o.outputs[a[0]].identifier+"\n==>\n"+_.inputs[a[1]].identifier};return r.debug_dot(e,n,a)}})),SR=nA("__texcomp",(function(e,t){var r=gN(e),n=mN(e),a=s("DXT1"),o=s("DXT3"),_=s("DXT5");function i(e,t,r,i){var s,c,E,u,d,T,f,p,P,S,A,h=new Int32Array(r,0,31);if(542327876!=h[0])return n.error("Invalid magic number in DDS header"),0;if(4&!h[20])return n.error("Unsupported format, must contain a FourCC code"),0;switch(s=h[21]){case a:c=8,E=t?t.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case o:c=16,E=t?t.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case _:c=16,E=t?t.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return n.error("Unsupported FourCC code:",l(s)),null}if(S=1,131072&h[2]&&!1!==i&&(S=Math.max(1,h[7])),u=h[4],d=h[3],f=h[1]+4,t)for(A=0;A<S;++A)T=Math.max(4,u)/4*Math.max(4,d)/4*c,P=new Uint8Array(r,f,T),e.compressedTexImage2D(e.TEXTURE_2D,A,E,u,d,0,P),f+=T,u=Math.max(.5*u,1),d=Math.max(.5*d,1);else{if(s!=a)return n.error("No manual decoder for",l(s),"and no native support"),0;T=Math.max(4,u)/4*Math.max(4,d)/4*c,p=function(e,t,r,n){for(var a=new Uint16Array(4),o=new Uint16Array(r*n),_=0,i=0,s=0,l=0,c=0,E=0,u=0,d=0,T=0,f=r/4,p=n/4,P=0;P<p;P++)for(var S=0;S<f;S++)a[0]=e[s=t+4*(P*f+S)],a[1]=e[s+1],a[2]=5*(l=31&a[0])+3*(u=31&a[1])>>3|5*(c=2016&a[0])+3*(d=2016&a[1])>>3&2016|5*(E=63488&a[0])+3*(T=63488&a[1])>>3&63488,a[3]=5*u+3*l>>3|5*d+3*c>>3&2016|5*T+3*E>>3&63488,o[i=4*P*r+4*S]=a[3&(_=e[s+2])],o[i+1]=a[_>>2&3],o[i+2]=a[_>>4&3],o[i+3]=a[_>>6&3],o[i+=r]=a[_>>8&3],o[i+1]=a[_>>10&3],o[i+2]=a[_>>12&3],o[i+3]=a[_>>14],o[i+=r]=a[3&(_=e[s+3])],o[i+1]=a[_>>2&3],o[i+2]=a[_>>4&3],o[i+3]=a[_>>6&3],o[i+=r]=a[_>>8&3],o[i+1]=a[_>>10&3],o[i+2]=a[_>>12&3],o[i+3]=a[_>>14];return o}(P=new Uint16Array(r),f/2,u,d),e.texImage2D(e.TEXTURE_2D,0,e.RGB,u,d,0,e.RGB,e.UNSIGNED_SHORT_5_6_5,p),i&&e.generateMipmap(e.TEXTURE_2D)}return S}function s(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function l(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}t.upload_dds_levels=i,t.upload_pvr_levels=function(e,t,n){var a=new Uint32Array(n,0,13);if(55727696==a[0]){var o=a[7],_=a[6],i=a[11],s=52+a[12];switch(a[2]){case 0:var l=2,c=1;break;case 1:l=2,c=3;break;case 2:l=4,c=0;break;case 3:l=4,c=2;break;default:r.panic("Unsupported PVR V3 format.")}}else if(559044176==a[11]){o=a[2],_=a[1],i=a[3],s=a[0],i++;var E=255&a[4],u=a[10]>0;25==E?(l=4,c=u?2:0):24==E?(l=2,c=u?3:1):r.panic("Unsupported PVR V2 format.")}else r.panic("Unsupported PVR version.");if(2==l)var d=8,T=4;else d=4,T=4;switch(c){case 0:var f=t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;break;case 1:f=t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;break;case 2:f=t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;break;case 3:f=t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}for(var p=d*T*l/8,P=0;P<i;P++){var S=Math.max(o>>P,1),A=Math.max(_>>P,1),h=S/d,v=A/T;h<2&&(h=2),v<2&&(v=2);var m=h*v*p,g=new Uint8Array(n,s,m);e.compressedTexImage2D(e.TEXTURE_2D,P,f,S,A,0,g),s+=m}},t.get_width_height=function(e,t){switch(t){case"dds":return{width:(r=new Int32Array(e,0,31))[4],height:r[3]};case"pvr":var r;if(55727696==(r=new Uint32Array(e,0,13))[0])var n=r[7],a=r[6];else n=r[2],a=r[1];return{width:n,height:a}}},t.get_compress_ratio=function(e,t){var r=1;if("dds"==t){var i=(s=new Int32Array(e,0,31))[21];switch(i){case a:r=6;break;case o:case _:r=4;break;default:n.error("Unsupported FourCC code:",l(i))}}else if("pvr"==t){var s;if(55727696==(s=new Uint32Array(e,0,13))[0])switch(s[2]){case 0:r=12;break;case 1:r=16;break;case 2:r=6;break;case 3:r=8}else{var c=255&s[4],E=s[10]>0;25==c?r=E?8:6:24==c&&(r=E?16:12)}}return r},t.load_dds_texture=function(e,t,r,n){var a=e.createTexture();return function(e,t,r,n,a,o){var _=new XMLHttpRequest;_.open("GET",r,!0),_.responseType="arraybuffer",_.onload=function(){if(200==_.status){e.bindTexture(e.TEXTURE_2D,n);var r=i(e,t,_.response,!0);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,r>1?e.LINEAR_MIPMAP_LINEAR:e.LINEAR)}o&&o(n)},_.send(null)}(e,t,r,a,0,n),a}})),AR=nA("__time",(function(e,t){var r=dR(e),n=0,a=0,o=[],_=0,i=0,s=[],l=-1,c=0;function E(){return-1!==r.animation.framerate?r.animation.framerate:l}t.set_timeline=function(e){n=e,a=performance.now();for(var t=0;t<o.length;t++){var r=o[t];n>r.expire_time&&(o.splice(t,1),t--,r.callback())}for(t=0;t<s.length;t++){var _=s[t],i=1-(_.expire_time-n)/_.duration;i=Math.min(i,1),_.callback(_.from+i*(_.to-_.from)),1==i&&(s.splice(t,1),t--)}},t.get_timeline=function(){return n},t.set_delta=function(e){c=e},t.get_delta=function(){return c},t.set_timeout=function(e,t){var r=++_,i={id:r,callback:e,expire_time:n+(performance.now()-a+t)/1e3};return o.push(i),r},t.clear_timeout=function(e){for(var t=0;t<o.length;t++)if(o[t].id==e){o.splice(t,1);break}},t.clear_animation=function(e){for(var t=s.length;t--;)if(s[t].id==e){s.splice(t,1);break}},t.animate=function(e,t,r,a){var o=r/1e3,_=++i;return s.push({id:_,callback:a,from:e,to:t,expire_time:n+o,duration:o}),a(e),_},t.reset=function(e){n=0,a=0,o.length=0,s.length=0,_=0,i=0},t.get_framerate=E,t.set_framerate=function(e){l=e},t.get_frame=function(e){return e*E()}})),hR=nA("__debug",(function(e,t){var r=mN(e),n={};t.fill_vbo_garbage_info=function(e,t,r,a,o){n[e]||(n[e]={shaders:t,attrs:{}}),r in n[e].attrs||(n[e].attrs[r]=a),o&&(n[e].attrs[r]=0)},t.calc_vbo_garbage_byte_size=function(){var e=0;for(var t in n)for(var r in n[t].attrs)e+=n[t].attrs[r];return e},t.show_vbo_garbage_info=function(){var e={};for(var t in n)for(var a in n[t].attrs){var o=n[t].attrs[a];o&&((_=n[t].shaders)in e||(e[_]={total_size:0,attrs:{}}),a in e[_].attrs||(e[_].attrs[a]=0),e[_].attrs[a]+=o,e[_].total_size+=o)}for(var _ in e){for(var a in r.groupCollapsed(_,e[_].total_size),e[_].attrs)r.log_raw(a,e[_].attrs[a]);r.groupEnd()}},t.cleanup=function(){n={}}})),vR=nA("__debug_subscene",(function(e,t){t.DV_NONE=0,t.DV_OPAQUE_WIREFRAME=1,t.DV_TRANSPARENT_WIREFRAME=2,t.DV_FRONT_BACK_VIEW=3,t.DV_BOUNDINGS=4,t.DV_CLUSTERS_VIEW=5,t.DV_BATCHES_VIEW=6,t.DV_RENDER_TIME=7;var r=null;t.set_debug_view_subs=function(e){r=e},t.get_debug_view_subs=function(){return r},t.cleanup=function(){r=null}})),mR=nA("__subscene",(function(e,t){var r=gN(e),n=pb(e),a=dR(e).outlining;function o(e,t){e.num_lights=t,e.light_directions=new Float32Array(3*t),e.light_positions=new Float32Array(4*t),e.light_color_intensities=new Float32Array(4*t)}function _(e){var t={type:e,subtype:"",force_do_not_render:!1,do_render:!1,enqueue:!1,clear_color:!1,clear_depth:!1,depth_test:!1,blend:!1,pack:!1,assign_texture:!1,need_fog_update:!1,need_perm_uniforms_update:!1,debug_render_calls:0,debug_render_time:0,debug_render_time_queries:[],debug_view_mode:0,debug_colors_seed:0,debug_render_time_threshold:1,do_not_debug:!1,time:0,camera:null,cube_view_matrices:null,cube_cam_frustums:[],draw_data:[],slinks_internal:[],textures_internal:[],wind:new Float32Array(3),grass_map_dim:new Float32Array(3),fog_color_density:new Float32Array(4),fog_params:new Float32Array(4),cube_fog:new Float32Array(16),sky_tex_default_value:0,environment_energy:0,num_lights:0,light_directions:null,light_positions:null,light_color_intensities:null,light_factors:null,horizon_color:new Float32Array(3),zenith_color:new Float32Array(3),sky_tex_fac:new Float32Array(4),sun_intensity:new Float32Array(3),sun_direction:new Float32Array([0,0,1]),sun_quaternion:new Float32Array(4),sky_tex_color:new Float32Array(3),sky_ngraph_proxy_id:"",bsdf_cube_sky_dim:0,outline_factor:0,draw_outline_flag:0,is_for_outline:!1,outline_color:new Float32Array(3),water:!1,cam_water_depth:0,water_fog_color_density:new Float32Array(4),water_level:0,caustics:!1,caust_scale:0,caust_speed:new Float32Array(2),caust_brightness:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,mie_distribution:0,sky_color:new Float32Array(3),ssao_hemisphere:!1,ssao_blur_depth:!1,ssao_blur_discard_value:0,ssao_radius_increase:0,ssao_influence:0,ssao_dist_factor:0,ssao_samples:0,ssao_only:!1,ssao_white:!1,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,max_ray_length:0,radial_blur_step:0,steps_per_pass:0,csm_index:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,v_light_ts:null,v_light_r:null,v_light_tsr:null,p_light_matrix:null,is_pp:!1,fxaa_quality:"",bloom_key:0,bloom_blur:0,bloom_edge_lum:0,adaptive_bloom:!0,average_luminance:0,blur_texel_size_mult:0,ext_texel_size_mult:0,mb_decay_threshold:0,mb_factor:0,motion_blur_exp:0,pp_effect:"",dof_bokeh:!1,coc_type:"",jitter_projection_space:new Float32Array(2),last_mip_map_ind:0,bloom_blur_num:2,bloom_blur_scale:.5,small_glow_mask_width:0,large_glow_mask_width:0,small_glow_mask_coeff:0,large_glow_mask_coeff:0,texel_size_multiplier:0,texel_size:new Float32Array(2),texel_mask:new Float32Array(2),distortion_params:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,shadow_lamp_index:0,need_draw_data_sort:!0,sky_invert:!1,sky_use_rgb_to_intensity:!1,sky_use_map_blend:!1,sky_use_map_horizon:!1,sky_use_map_zenith_up:!1,sky_use_map_zenith_down:!1,sky_blend_type:"",use_sky_blend:!1,use_sky_paper:!1,use_sky_real:!1,refl_obj:null};return t.do_render=!0,t.enqueue=!0,t.clear_color=!0,t.clear_depth=!0,t.depth_test=!0,t.need_perm_uniforms_update=!0,t.texel_size_multiplier=1,t.texel_mask[0]=1,t.texel_mask[1]=1,t.distortion_params[2]=.5,t.distortion_params[3]=.5,t.ssao_samples=8,t}function i(e,t){return e==t?0:e>t?1:-1}function s(e,t){return i(e.alpha_antialiasing,t.alpha_antialiasing)||i(e.is_sky,t.is_sky)||i(e.offset_z,t.offset_z)||i(e.shader.has_discard,t.shader.has_discard)||i(e.z_index,t.z_index)}t.MAIN_OPAQUE=0,t.MAIN_BLEND=1,t.MAIN_XRAY=2,t.MAIN_PLANE_REFLECT=3,t.MAIN_CUBE_REFLECT=4,t.MAIN_PLANE_REFLECT_BLEND=5,t.MAIN_CUBE_REFLECT_BLEND=6,t.MAIN_GLOW=7,t.SHADOW_CAST=8,t.SHADOW_RECEIVE=9,t.GRASS_MAP=10,t.POSTPROCESSING=11,t.GLOW_COMBINE=13,t.RESOLVE=14,t.COLOR_PICKING=15,t.COLOR_PICKING_XRAY=16,t.DEBUG_VIEW=17,t.ANCHOR_VISIBILITY=18,t.DEPTH_PACK=19,t.SSAO=20,t.SSAO_BLUR=21,t.ANTIALIASING=22,t.SMAA_BLENDING_WEIGHT_CALCULATION=23,t.SMAA_EDGE_DETECTION=24,t.SMAA_RESOLVE=25,t.SMAA_NEIGHBORHOOD_BLENDING=26,t.COMPOSITING=27,t.MOTION_BLUR=28,t.COC=29,t.DOF=30,t.OUTLINE_MASK=31,t.OUTLINE=32,t.GOD_RAYS=33,t.GOD_RAYS_COMBINE=34,t.SKY=35,t.COPY=36,t.STEREO=37,t.LUMINANCE=38,t.AVERAGE_LUMINANCE=39,t.LUMINANCE_TRUNCED=40,t.BLOOM=41,t.VELOCITY=42,t.SINK=43,t.PERFORMANCE=44,t.RESIZE=45,t.IRRADIANCE=46,t.ROUGHNESS_CONVOLUTION=47,t.BRDF=48,t.create_subs_shadow_cast=function(e,t,r,a){var i=_(8);switch(i.csm_index=e,i.self_shadow_polygon_offset=r.self_shadow_polygon_offset,i.shadow_lamp_index=t,r.lamp_types[t]){case"SPOT":case"POINT":i.camera=n.create_camera(n.TYPE_PERSP),n.set_frustum(i.camera,r.spot_sizes[t],r.clip_start[t],r.clip_end[t]);break;default:i.camera=n.create_camera(n.TYPE_ORTHO_ASYMMETRIC)}return o(i,a),i},t.clone_subs=function(e){var t=_(e.type);return t.subtype=e.subtype,t.force_do_not_render=e.force_do_not_render,t.do_render=e.do_render,t.enqueue=e.enqueue,t.clear_color=e.clear_color,t.clear_depth=e.clear_depth,t.depth_test=e.depth_test,t.blend=e.blend,t.pack=e.pack,t.assign_texture=e.assign_texture,t.need_fog_update=e.need_fog_update,t.need_perm_uniforms_update=e.need_perm_uniforms_update,t.debug_render_calls=0,t.debug_render_time=0,t.debug_render_time_queries=[],t.debug_view_mode=e.debug_view_mode,t.debug_colors_seed=e.debug_colors_seed,t.debug_render_time_threshold=e.debug_render_time_threshold,t.do_not_debug=e.do_not_debug,t.time=e.time,t.camera=n.clone_camera(e.camera,!0),t.cube_view_matrices=lO(e.cube_view_matrices),t.cube_cam_frustums=lO(e.cube_cam_frustums),t.draw_data=lO(e.draw_data),t.slinks_internal=lO(e.slinks_internal),t.textures_internal=lO(e.textures_internal),t.wind.set(e.wind),t.grass_map_dim.set(e.grass_map_dim),t.fog_color_density.set(e.fog_color_density),t.fog_params.set(e.fog_params),t.cube_fog.set(e.cube_fog),t.sky_tex_default_value=e.sky_tex_default_value,t.environment_energy=e.environment_energy,t.num_lights=e.num_lights,t.light_directions=lO(e.light_directions),t.light_positions=lO(e.light_positions),t.light_color_intensities=lO(e.light_color_intensities),t.light_factors=lO(e.light_factors),t.horizon_color.set(e.horizon_color),t.zenith_color.set(e.zenith_color),t.sky_tex_fac.set(e.sky_tex_fac),t.sun_intensity.set(e.sun_intensity),t.sun_direction.set(e.sun_direction),t.sun_quaternion.set(e.sun_quaternion),t.sky_tex_color.set(e.sky_tex_color),t.sky_ngraph_proxy_id=e.sky_ngraph_proxy_id,t.bsdf_cube_sky_dim=e.bsdf_cube_sky_dim,t.outline_factor=e.outline_factor,t.draw_outline_flag=e.draw_outline_flag,t.is_for_outline=e.is_for_outline,t.outline_color.set(e.outline_color),t.water=e.water,t.cam_water_depth=e.cam_water_depth,t.water_fog_color_density.set(e.water_fog_color_density),t.water_level=e.water_level,t.caustics=e.caustics,t.caust_scale=e.caust_scale,t.caust_speed.set(e.caust_speed),t.caust_brightness=e.caust_brightness,t.procedural_skydome=e.procedural_skydome,t.use_as_environment_lighting=e.use_as_environment_lighting,t.mie_brightness=e.mie_brightness,t.rayleigh_brightness=e.rayleigh_brightness,t.spot_brightness=e.spot_brightness,t.mie_strength=e.mie_strength,t.rayleigh_strength=e.rayleigh_strength,t.scatter_strength=e.scatter_strength,t.mie_collection_power=e.mie_collection_power,t.rayleigh_collection_power=e.rayleigh_collection_power,t.mie_distribution=e.mie_distribution,t.sky_color.set(e.sky_color),t.ssao_hemisphere=e.ssao_hemisphere,t.ssao_blur_depth=e.ssao_blur_depth,t.ssao_blur_discard_value=e.ssao_blur_discard_value,t.ssao_radius_increase=e.ssao_radius_increase,t.ssao_influence=e.ssao_influence,t.ssao_dist_factor=e.ssao_dist_factor,t.ssao_samples=e.ssao_samples,t.ssao_only=e.ssao_only,t.ssao_white=e.ssao_white,t.brightness=e.brightness,t.contrast=e.contrast,t.exposure=e.exposure,t.saturation=e.saturation,t.god_rays_intensity=e.god_rays_intensity,t.max_ray_length=e.max_ray_length,t.radial_blur_step=e.radial_blur_step,t.steps_per_pass=e.steps_per_pass,t.csm_index=e.csm_index,t.self_shadow_polygon_offset=e.self_shadow_polygon_offset,t.self_shadow_normal_offset=e.self_shadow_normal_offset,t.v_light_ts=lO(e.v_light_ts),t.v_light_r=lO(e.v_light_r),t.v_light_tsr=lO(e.v_light_tsr),t.p_light_matrix=lO(e.p_light_matrix),t.is_pp=e.is_pp,t.fxaa_quality=e.fxaa_quality,t.bloom_key=e.bloom_key,t.bloom_blur=e.bloom_blur,t.bloom_edge_lum=e.bloom_edge_lum,t.adaptive_bloom=e.adaptive_bloom,t.average_luminance=e.average_luminance,t.blur_texel_size_mult=e.blur_texel_size_mult,t.ext_texel_size_mult=e.ext_texel_size_mult,t.mb_decay_threshold=e.mb_decay_threshold,t.mb_factor=e.mb_factor,t.motion_blur_exp=e.motion_blur_exp,t.pp_effect=e.pp_effect,t.coc_type=e.coc_type,t.dof_bokeh=e.dof_bokeh,t.jitter_projection_space.set(e.jitter_projection_space),t.last_mip_map_ind=e.last_mip_map_ind,t.bloom_blur_num=e.bloom_blur_num,t.bloom_blur_scale=e.bloom_blur_scale,t.small_glow_mask_width=e.small_glow_mask_width,t.large_glow_mask_width=e.large_glow_mask_width,t.small_glow_mask_coeff=e.small_glow_mask_coeff,t.large_glow_mask_coeff=e.large_glow_mask_coeff,t.texel_size_multiplier=e.texel_size_multiplier,t.texel_size.set(e.texel_size),t.texel_mask.set(e.texel_mask),t.distortion_params.set(e.distortion_params),t.chromatic_aberration_coefs.set(e.chromatic_aberration_coefs),t.enable_hmd_stereo=e.enable_hmd_stereo,t.shadow_lamp_index=e.shadow_lamp_index,t.need_draw_data_sort=e.need_draw_data_sort,t.sky_invert=e.sky_invert,t.sky_use_rgb_to_intensity=e.sky_use_rgb_to_intensity,t.sky_use_map_blend=e.sky_use_map_blend,t.sky_use_map_horizon=e.sky_use_map_horizon,t.sky_use_map_zenith_up=e.sky_use_map_zenith_up,t.sky_use_map_zenith_down=e.sky_use_map_zenith_down,t.sky_blend_type=e.sky_blend_type,t.use_sky_blend=e.use_sky_blend,t.use_sky_paper=e.use_sky_paper,t.use_sky_real=e.use_sky_real,t},t.create_subs_grass_map=function(){var e=_(10);return e.camera=n.create_camera(n.TYPE_ORTHO_ASPECT),e},t.create_subs_postprocessing=function(e){var t=_(11);switch(t.clear_color=!1,t.clear_depth=!1,t.depth_test=!1,t.is_pp=!0,t.camera=n.create_camera(n.TYPE_NONE),t.pp_effect=e,e){case"NONE":case"GRAYSCALE":t.texel_mask[0]=1,t.texel_mask[1]=1;break;case"X_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=0;break;case"Y_BLUR":t.texel_mask[0]=0,t.texel_mask[1]=1;break;case"X_GLOW_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=0;break;case"Y_GLOW_BLUR":t.texel_mask[0]=0,t.texel_mask[1]=1;break;case"X_BLOOM_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=0;break;case"Y_BLOOM_BLUR":t.texel_mask[0]=0,t.texel_mask[1]=1;break;case"X_DOF_BLUR":case"Y_DOF_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=1;break;case"X_ALPHA_BLUR":t.texel_mask[0]=1,t.texel_mask[1]=0,t.texel_size_multiplier=3;break;case"Y_ALPHA_BLUR":t.texel_mask[0]=0,t.texel_mask[1]=1,t.texel_size_multiplier=3;break;case"X_EXTEND":t.texel_mask[0]=1,t.texel_mask[1]=0;break;case"Y_EXTEND":t.texel_mask[0]=0,t.texel_mask[1]=1;break;default:r.panic("Wrong postprocessing effect: "+e)}return t},t.create_subs_glow_combine=function(e,t){var r=_(13);return r.clear_color=!1,r.clear_depth=!1,r.depth_test=!1,r.small_glow_mask_coeff=t.glow_params.small_glow_mask_coeff,r.large_glow_mask_coeff=t.glow_params.large_glow_mask_coeff,r.small_glow_mask_width=t.glow_params.small_glow_mask_width,r.large_glow_mask_width=t.glow_params.large_glow_mask_width,r.camera=e,r.is_pp=!0,r},t.create_subs_main=function(e,t,n,a,i,s,l,c,E){var u=_(e);0==e?(u.clear_color=!0,u.clear_depth=n,u.blend=!1):1==e?(u.clear_color=!1,u.clear_depth=!1,u.blend=!0):2==e?(u.clear_color=!1,u.clear_depth=!0,u.blend=!0):3==e||4==e?(u.clear_color=!0,u.clear_depth=!0,u.blend=!1):5==e||6==e?(u.clear_color=!1,u.clear_depth=!1,u.blend=!0):7==e?(u.clear_color=!0,u.clear_depth=!1,u.blend=!0):r.panic("wrong main subscene type"),u.blend&&c&&(u.self_shadow_normal_offset=c.self_shadow_normal_offset),u.camera=t;var d=l.sky_texture_param;return d&&(u.sky_tex_fac.set([d.blend_factor,d.horizon_factor,d.zenith_up_factor,d.zenith_down_factor]),u.sky_tex_color.set(d.color),u.sky_tex_default_value=d.default_value),u.horizon_color.set(l.horizon_color),u.zenith_color.set(l.zenith_color),u.environment_energy=l.environment_energy,u.fog_color_density=s.fog_color_density,u.fog_params=s.fog_params,a&&function(e,t,r){var n=t;n.fog_color_density&&e.water_fog_color_density.set(n.fog_color_density),e.water_level=n.water_level,n.caustics&&r&&(e.caustics=!0,e.caust_scale=n.caustic_scale,e.caust_brightness=n.caustic_brightness,e.caust_speed.set(n.caustic_speed))}(u,a,E),o(u,i),u},t.create_subs_resolve=function(){var e=_(14);return e.is_pp=!0,e.camera=n.create_camera(n.TYPE_NONE),e},t.create_subs_color_picking=function(e,t,r){var n=_(15);return t&&(n.type=16,n.clear_color=!1,n.clear_depth=!0),n.enqueue=!1,n.camera=e,o(n,r),n},t.create_subs_debug_view=function(e){var t=_(17);return t.do_render=!1,t.clear_color=!1,t.clear_depth=!1,t.camera=e,t},t.create_subs_anchor_visibility=function(e){var t=_(18);return t.clear_color=!0,t.clear_depth=!1,t.camera=e,t},t.create_subs_shadow_receive=function(e,t,r){var n=_(9);return n.camera=t,o(n,r),n},t.create_subs_depth_pack=function(e){var t=_(19);return t.clear_color=!1,t.clear_depth=!1,t.camera=e,t.is_pp=!0,t},t.create_subs_ssao=function(e,t,r){var n=_(20);return n.clear_color=!1,n.clear_depth=!1,n.depth_test=!1,n.camera=e,n.fog_color_density=t.fog_color_density,n.water_fog_color_density.set(t.fog_color_density),n.ssao_radius_increase=r.radius_increase,n.ssao_hemisphere=r.hemisphere,n.ssao_influence=r.influence,n.ssao_dist_factor=r.dist_factor,n.ssao_samples=r.samples,n.is_pp=!0,n},t.create_subs_ssao_blur=function(e,t){var r=_(21);return r.clear_color=!1,r.clear_depth=!1,r.depth_test=!1,r.camera=e,r.ssao_blur_depth=t.blur_depth,r.ssao_blur_discard_value=t.blur_discard_value,r.is_pp=!0,r},t.create_subs_aa=function(e){var t=_(22);return t.clear_color=!1,t.clear_depth=!1,t.depth_test=!1,t.texel_size_multiplier=1/e.resolution_factor,t.fxaa_quality=e.aa_quality,t.camera=n.create_camera(n.TYPE_NONE),t.is_pp=!0,t},t.create_subs_smaa=function(e,t){var r=_(e);return r.clear_color=23==e||24==e,r.clear_depth=!1,r.depth_test=!1,r.texel_size_multiplier=1/t.resolution_factor,r.camera=n.create_camera(n.TYPE_NONE),23==e&&(r.jitter_subsample_ind=new Float32Array(4)),r.is_pp=!0,r},t.create_subs_compositing=function(e,t,r,a){var o=_(27);return o.clear_color=!1,o.clear_depth=!1,o.depth_test=!1,o.camera=n.create_camera(n.TYPE_NONE),o.brightness=e,o.contrast=t,o.exposure=r,o.saturation=a,o.is_pp=!0,o},t.create_subs_motion_blur=function(e,t){var r=_(28);return r.clear_color=!1,r.clear_depth=!1,r.depth_test=!1,r.camera=n.create_camera(n.TYPE_NONE),r.assign_texture=!0,r.mb_decay_threshold=e,r.mb_factor=t,r.is_pp=!0,r},t.create_subs_coc=function(e,t){var r=_(29);return r.clear_color=!1,r.clear_depth=!1,r.depth_test=!1,r.camera=e,r.texel_size_multiplier=r.camera.dof_power,r.coc_type=t,r.is_pp=!0,r},t.create_subs_dof=function(e,t){var r=_(30);return r.clear_color=!1,r.clear_depth=!1,r.depth_test=!1,r.camera=e,r.texel_size_multiplier=e.dof_power,r.dof_bokeh=t,r.is_pp=!0,r},t.create_subs_outline_mask=function(e,t){var r=_(31);return r.depth_test=!1,r.camera=e,o(r,t),r},t.create_subs_outline=function(e){var t=_(32);return t.outline_color.set(a.outlining_overview_mode?a.outline_color:e.outline_color),t.outline_factor=e.outline_factor,t.ext_texel_size_mult=5,t.blur_texel_size_mult=3,t.depth_test=!1,t.camera=n.create_camera(n.TYPE_NONE),t.is_pp=!0,t},t.create_subs_god_rays=function(e,t,r,n,a,i,s){var l=_(33);return l.clear_color=!1,l.clear_depth=!1,l.depth_test=!1,l.horizon_color=new Float32Array([1,1,1]),l.zenith_color=new Float32Array([1,1,1]),l.environment_energy=1,l.pack=n,l.water=t,l.radial_blur_step=a,l.max_ray_length=r,l.steps_per_pass=s,l.camera=e,o(l,i),l},t.create_subs_god_rays_comb=function(e,t){var r=_(34);return r.clear_color=!1,r.clear_depth=!1,r.depth_test=!1,r.camera=n.create_camera(n.TYPE_NONE),r.god_rays_intensity=e,o(r,t),r.is_pp=!0,r},t.create_subs_sky=function(e,t,r,a){var i=_(35);i.enqueue=!1,i.clear_color=!1,i.clear_depth=!1,i.depth_test=!1;var s=n.create_camera(n.TYPE_NONE);if(s.width=a,s.height=a,i.camera=s,i.cube_view_matrices=AO(),o(i,t),i.horizon_color=new Float32Array([1,1,1]),i.zenith_color=new Float32Array([1,1,1]),i.environment_energy=1,i.sky_color.set(r.sky_color),i.procedural_skydome=r.procedural_skydome,i.use_as_environment_lighting=r.use_as_environment_lighting,i.rayleigh_brightness=r.rayleigh_brightness,i.mie_brightness=r.mie_brightness,i.spot_brightness=r.spot_brightness,i.scatter_strength=r.scatter_strength,i.rayleigh_strength=r.rayleigh_strength,i.mie_strength=r.mie_strength,i.rayleigh_collection_power=r.rayleigh_collection_power,i.mie_collection_power=r.mie_collection_power,i.mie_distribution=r.mie_distribution,e){i.horizon_color.set(e.horizon_color),i.zenith_color.set(e.zenith_color),i.environment_energy=e.environment_energy;var l=e.sky_texture_param;l&&(i.sky_tex_fac.set([l.blend_factor,l.horizon_factor,l.zenith_up_factor,l.zenith_down_factor]),i.sky_tex_color.set(l.color),i.sky_tex_default_value=l.default_value,i.sky_invert=l.invert,i.sky_use_rgb_to_intensity=l.use_rgb_to_intensity,i.sky_use_map_blend=l.use_map_blend,i.sky_use_map_horizon=l.use_map_horizon,i.sky_use_map_zenith_up=l.use_map_zenith_up,i.sky_use_map_zenith_down=l.use_map_zenith_down,i.sky_blend_type=l.blend_type),i.use_sky_blend=e.use_sky_blend,i.use_sky_paper=e.use_sky_paper,i.use_sky_real=e.use_sky_real,i.sky_ngraph_proxy_id=e.ngraph_proxy_id}return i},t.create_subs_irradiance=function(e,t){var r=_(46);r.enqueue=!1,r.clear_color=!1,r.clear_depth=!1,r.depth_test=!1;var a=n.create_camera(n.TYPE_NONE);return a.width=t,a.height=t,r.camera=a,r.cube_view_matrices=AO(),o(r,e),r},t.create_subs_rougness_convolution=function(e){var t=_(47);t.enqueue=!1,t.clear_color=!1,t.clear_depth=!1,t.depth_test=!1;var r=n.create_camera(n.TYPE_NONE);return r.width=128,r.height=128,t.camera=r,t.cube_view_matrices=AO(),o(t,e),t},t.create_subs_brdf=function(){var e=_(48);e.enqueue=!1,e.clear_color=!1,e.clear_depth=!1,e.depth_test=!1;var t=n.create_camera(n.TYPE_NONE);return t.width=512,t.height=512,e.camera=t,e},t.create_subs_copy=function(){var e=_(36);return e.clear_color=!1,e.clear_depth=!1,e.camera=n.create_camera(n.TYPE_NONE),e.is_pp=!0,e},t.create_subs_stereo=function(e,t){var r=_(37);return r.clear_color=!1,r.clear_depth=!1,r.subtype=e?"HMD":t?"ANAGLYPH":"SIDEBYSIDE",r.camera=n.create_camera(n.TYPE_NONE),r.is_pp=!0,r},t.create_subs_luminance=function(){var e=_(38);return e.clear_color=!1,e.clear_depth=!1,e.camera=n.create_camera(n.TYPE_NONE),e.is_pp=!0,e},t.create_subs_av_luminance=function(){var e=_(39);return e.clear_color=!1,e.clear_depth=!1,e.camera=n.create_camera(n.TYPE_NONE),e.is_pp=!0,e},t.create_resize_subs=function(){var e=_(45);return e.clear_color=!1,e.clear_depth=!1,e.camera=n.create_camera(n.TYPE_NONE),e.is_pp=!0,e},t.create_subs_luminance_truncated=function(e,t,r,n){var a=_(40);return a.clear_color=!1,a.clear_depth=!1,a.bloom_key=e,a.bloom_edge_lum=t,a.camera=n,o(a,r),a.is_pp=!0,a},t.create_subs_bloom_combine=function(e,t){var r=_(41);return r.clear_color=!1,r.clear_depth=!1,r.camera=n.create_camera(n.TYPE_NONE),r.bloom_blur=e,r.bloom_blur_num=t,r.is_pp=!0,r},t.create_subs_veloctity=function(e){var t=_(42);return t.clear_color=!1,t.clear_depth=!1,t.camera=e,t.is_pp=!0,t},t.create_subs_sink=function(){var e=_(43);return e.enqueue=!1,e},t.create_subs_perf=function(){var e=_(44);return e.is_pp=!0,e},t.subs_label=function(e){switch(e.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+e.pp_effect.replace(/_/g," ")+")";case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";case 35:return"SKY";case 46:return"IRRADIANCE";case 47:return"ROUGHNESS_CONVOLUTION";case 48:return"PRE-COMPUTE_BRDF";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";case 45:return"RESIZE";default:return"UNKNOWN"}},t.append_draw_data=function(e,t){for(var r=t.batch,n=r.shader,a=r.alpha_antialiasing,o=0;o<e.draw_data.length;o++){var _=e.draw_data[o].bundles,i=_.indexOf(t);if(-1!=i&&(_.splice(i,1),!_.length)){e.draw_data.splice(o,1);break}}if(e.blend)var s=r.offset_z;else s=0;var l=function(e,t,r,n,a){for(var o=0;o<e.length;o++){var _=e[o];if(_.shader==t&&_.alpha_antialiasing==r&&_.offset_z==n&&_.is_sky==a)return _}return null}(e.draw_data,n,a,s,r.is_sky);if(l)l.bundles.push(t);else{var c=function(e,t,r,n,a){return{shader:e,bundles:[t],alpha_antialiasing:r,offset_z:n,is_sky:a,do_render:!0,z_index:1/0}}(n,t,a,s,r.is_sky);e.draw_data.push(c),e.need_draw_data_sort=!0}},t.init_bundle=function(e,t,r){var n={do_render:!0,do_render_cube:[!0,!0,!0,!0,!0,!0],obj_render:t,batch:e,world_bounds:r||null,info_for_z_sort_updates:null,z_index:1/0};if(e.z_sort&&e.bufs_data.ibo_array){var a=e.bufs_data.ibo_array;n.info_for_z_sort_updates={median_cache:new Float32Array(a.length),median_world_cache:new Float32Array(a.length),dist_cache:new Float32Array(a.length/3),zsort_eye_last:new Float32Array(3),bb_min_side:kN(e.bounds_local.bb)}}return n},t.find_bundle=function(e,t,r){for(var n=0;n<e.draw_data.length;n++)for(var a=0;a<e.draw_data[n].bundles.length;a++)if(e.draw_data[n].bundles[a].batch==t&&e.draw_data[n].bundles[a].render==r)return!0;return!1},t.sort_draw_data=function(e){e.draw_data.sort(s),e.need_draw_data_sort=!1}})),gR=nA("__debug_rendertime",(function(e,t){var r=dR(e),n=vR(e),a=fR(e),o=mR(e),_=r.defaults;function i(){var e=a.get_disjoint_timer_query();if(e){var t=e.createQuery();e.beginQuery(t)}else t=performance.now();return t}function s(){var e=n.get_debug_view_subs();return e&&e.debug_view_mode==n.DV_RENDER_TIME}function l(e,t,r){var n=a.get_disjoint_timer_query(),o=0;if(n){r&&n.endQuery();for(var _=0;_<e.length;_++){var i=e[_],s=n.getQueryAvailable(i),l=n.getDisjoint();s&&!l&&(o=n.getQueryObject(i)/1e6,t&&(o=CO(o,t,1,10)),e.splice(_,1),_--)}}else o=performance.now()-e.pop(),t&&(o=CO(o,t,1,10));return o}t.start_subs=function(e){(_.show_hud_debug_info||e.type==o.PERFORMANCE)&&(e.do_not_debug||e.debug_render_time_queries.push(i()))},t.start_batch=function(e){"MAIN"==e.type&&s()&&e.debug_render_time_queries.push(i())},t.stop_subs=function(e){if((_.show_hud_debug_info||e.type==o.PERFORMANCE)&&!e.do_not_debug){var t=l(e.debug_render_time_queries,e.debug_render_time,!0);t&&(e.debug_render_time=t)}},t.stop_batch=function(e){if("MAIN"==e.type&&s()){var t=l(e.debug_render_time_queries,e.debug_render_time,!0);t&&(e.debug_render_time=t)}},t.is_debug_view_render_time_mode=s,t.process_timer_queries=function(e){var t=l(e.debug_render_time_queries,e.debug_render_time,!1);t&&(e.debug_render_time=t)}})),OR=dm(),NR=dm(),RR=ih(),IR=ih(),bR=ih(),yR=Fv(),LR=Fv();function YR(e,t,r){var n=!(!t||!t.length),a=e.length/3;r=r||DR(a);for(var o=0;o<a;++o){var _=RR;if(_[0]=e[3*o],_[1]=e[3*o+1],_[2]=e[3*o+2],Rh(_,_),n){var i=LR;i[0]=t[4*o],i[1]=t[4*o+1],i[2]=t[4*o+2],i[3]=t[4*o+3],Rh(i,i);var s=bh(i,_,IR);Rh(s,s);var l=Sm(Ug,s,OR),c=wh(wg,l,bR);am(d=mm(Sm(c,_,NR),l,OR),d);var E=.5,u=bh(_,s,bR);(Math.abs(u[0]-i[0])>31e-6||Math.abs(u[1]-i[1])>31e-6||Math.abs(u[2]-i[2])>31e-6)&&(E=Math.acos(Ih(_,i))/Math.PI),xR(r,d,o),wR(r,qg(i[3]),o),UR(r,E,o)}else{var d;xR(r,d=Sm(wg,_,OR),o)}}return r}function MR(e,t,r){return am(GR(e,t=t||0,r),r),r}function xR(e,t,r){var n=GR(e,r=r||0,yR),a=em(n);return Wv(t,(qg(n[3])*qg(t[3])||1)*a,n),Math.abs(n[3])<31e-6&&(n[3]=n[3]>0?31e-6:-31e-6),KR(e,n,r),e}function CR(e,t){return qg(e[4*(t=t||0)+3])}function wR(e,t,r){var n=GR(e,r=r||0,yR);return qg(n[3])*t<0&&Wv(n,-1,n),KR(e,n,r),e}function UR(e,t,r){var n=GR(e,r=r||0,yR);return am(n,n),Wv(n,t,n),Math.abs(n[3])<31e-6&&(n[3]>0?n[3]+=31e-6:n[3]-=31e-6),KR(e,n,r),e}function kR(e,t){return em(GR(e,t=t||0,yR))}function DR(e){e=0!==e?e||1:0;for(var t=new Float32Array(4*e),r=0;r<e;r++)t[4*r+3]=.5;return t}function FR(e){for(var t=0;t<e.length;t+=4)e[t]=0,e[t+1]=0,e[t+2]=0,e[t+3]=.5;return e}function GR(e,t,r){return r[0]=e[4*t],r[1]=e[4*t+1],r[2]=e[4*t+2],r[3]=e[4*t+3],r}function KR(e,t,r){return e[4*r]=t[0],e[4*r+1]=t[1],e[4*r+2]=t[2],e[4*r+3]=t[3],e}function BR(e){return e.length/4}function XR(e,t,r){for(var n=BR(e),a=0;a<n;a++){var o=CR(e,a),_=kR(e,a);xR(r,mm(t,MR(e,a,NR),NR),a),UR(r,_,a),wR(r,o,a)}}function HR(e,t,r){return XR(e,Vm(t,OR),r)}function jR(e,t,r,n){var a=CR(t,0),o=MR(e,0,OR),_=MR(t,0,NR),i=kR(e),s=kR(t),l=Im(o,_,r,NR);return am(l,l),xR(n,l,0),UR(n,r*(i-s)+s),wR(n,a,0),n}function zR(e,t,r){var n=CR(t,0),a=MR(e,0,OR),o=MR(t,0,NR),_=kR(e,0),i=kR(t,0);return xR(r,mm(a,o,OR),0),UR(r,_+i-.5),wR(r,n,0),r}function QR(e,t,r){var n=CR(t,0),a=MR(e,0,OR),o=MR(t,0,NR),_=kR(e),i=kR(t);return xR(r,mm(a,Ym(o,NR),OR),0),UR(r,_-i+.5),wR(r,n,0),r}var VR=nA("__geometry",(function(e,t){var r=gN(e),n=fR(e),a=TR(e),o=mN(e),_=DR(),i=DR(),s=DR(),l=new Float32Array(3),c=new Float32Array(3),E=new Float32Array(3),u=dm(),d=wm();t.DM_TRIANGLES=10,t.DM_DYNAMIC_TRIANGLES=20,t.SORT_NUMERIC=0,t.SORT_STRING=1,t.DM_DEFAULT=t.DM_TRIANGLES;var T=null,f="unsigned_byte";function p(e,t,r){var n=t.a_tbn,a=t.a_position,o=a.length,l=e.shape_keys.length;if(r)for(var c=e.shape_keys[0].geometry.a_position,E=0;E<o;E++)a[E]=c[E];for(var u=1;u<l;u++){var d=r?r[u].value:e.shape_keys[u].init_value;for(c=e.shape_keys[u].geometry.a_position,E=0;E<o;E++)a[E]+=d*c[E]}if(l=BR(n),r){var T=e.shape_keys[0].geometry.a_tbn;for(u=0;u<l;u++)KR(n,T,u)}for(u=0;u<l;u++){var f=FR(_);for(E=1;E<e.shape_keys.length;E++)if(T=e.shape_keys[E].geometry.a_tbn,d=r?r[E].value:e.shape_keys[E].init_value){var p=GR(T,u,i);zR(jR(FR(s),p,d,i),f,f)}KR(n,zR(f,GR(n,u,i),i),u)}}function P(e){return e.base_length>65536&&!n.get_elem_index_uint()}function S(e){return e.indices.length>0}function A(e,t,r){if(!S(e))return e;t=t||1,r||o.log('%cDEBUG max vertices exceeded for indexed submesh "'+e.name+'": '+e.base_length*t+", will use drawArrays","color: #aa0");var n=e.indices,a=e.base_length,_=e.va_common,i=e.va_frames;for(var s in _){var l=w(T=_[s],a);_[s]=h(n,T,l)}for(var c=0;c<i.length;c++){var E=i[c];for(var s in E)l=w(T=E[s],a),E[s]=h(n,T,l)}for(c=0;c<e.shape_keys.length;c++){var u=e.shape_keys[c].geometry;for(var d in u){var T;l=w(T=u[d],a),u[d]=h(n,T,l)}}return e.base_length=n.length,e.indices=new Uint16Array(0),e}function h(e,t,r){if(0==t.length)return new Float32Array(0);for(var n=new Float32Array(e.length*r),a=0;a<e.length;a++)for(var o=e[a],_=0;_<r;_++)n[r*a+_]=t[r*o+_];return n}function v(){return{ibo_array:null,vbo_source_data:W(),ibo_type:0,count:0,pointers:{},usage:0,debug_ibo_bytes:0,debug_vbo_bytes:0,vbo_data:[],ibo:null,shape_keys:null,instance_count:1,cleanup_gl_data_on_unload:!0}}function m(e,t){if("a_normal"==t){for(var n=m(e,"a_tbn"),a=BR(n),o=new Float32Array(3*a),_=0;_<a;_++){var i=(s=l,c=MR(n,_,OR),wh(wg,c,s));o.set(i,3*_)}return o}var s,c,E=e.pointers[t];if(E){var u=re(t);return ae(t,ee(e.vbo_source_data,u).subarray(E.offset,E.offset+E.length),new Float32Array(E.length))}r.panic("extract_array_float() failed; invalid name: "+t)}function g(e,n){var a;switch(n){case t.DM_DEFAULT:case t.DM_TRIANGLES:a=T.STATIC_DRAW;break;case t.DM_DYNAMIC_TRIANGLES:a=T.DYNAMIC_DRAW;break;default:r.panic("Wrong draw_mode")}e.usage=a}t.VBO_FLOAT="float",t.VBO_SHORT="short",t.VBO_UBYTE=f,t.setup_context=function(e){T=e},t.submesh_to_bufs_data=function(e,t,r){P(e)&&A(e);var n=e.indices,a=e.base_length,o=e.va_frames,_={};for(var i in e.va_common)i in r&&!r[i].generate_buffer||(_[i]=e.va_common[i]);var s=v();return e.shape_keys.length>0&&p(e,o[0]),function(e,t,r,n,a,o){if(t.length){var _=t.length;if(a<=65536)var i=new Uint16Array(t),s=T.UNSIGNED_SHORT;else i=new Uint32Array(t),s=T.UNSIGNED_INT}else _=a,i=null;for(var l=W(function(e,t,r){var n={},a=function(e,t){n[e]||(n[e]=0),n[e]+=t};for(var o in e[0]){var _=e[0][o],i=re(o);a(i,_.length*e.length)}for(var o in t)_=t[o],a(i=re(o),_.length);if(r){var s=r.tsr_array.length;a(i=re("a_part_ts"),4*s),a(i=re("a_part_r"),4*s);var l=r.part_inh_attrs;for(var o in l)a(i=re(o),l[o].num_comp*s);var c=r.submesh_params;for(var o in c)a(i=re(o),s)}return n}(r,n,o)),c={},E=0;E<l.length;E++)c[l[E].type]=0;var u={};for(var d in n)if(A=(v=n[d]).length){var f=re(d);(P=u[d]={length:0,frames:1,num_comp:0,offset:0,divisor:0}).length=A,P.num_comp=w(v,a),P.offset=c[f],ne(l,d,v,c[f]),c[f]+=A}var p=r.length;for(var d in r[0]){var P,S=r[0][d],A=(f=re(d),S.length),h=w(S,a);if(A)for((P=u[d]={length:0,frames:1,num_comp:0,offset:0,divisor:0}).length=A,P.frames=p,P.num_comp=h,P.offset=c[f],p>1&&((P=u[d+"_next"]={length:0,frames:1,num_comp:0,offset:0,divisor:0}).length=A,P.frames=p,P.num_comp=h,P.offset=c[f]+A),E=0;E<p;E++){var v=r[E][d];ne(l,d,v,c[f=re(d)]),c[f]+=A}}o&&(O(o,u,l,c),e.instance_count=o.tsr_array.length),e.count=_,e.ibo_array=i,e.vbo_source_data=l,e.ibo_type=s,e.pointers=u}(s,n,o,_,a,e.instanced_array_data),g(s,t),N(s),s.shape_keys=e.shape_keys,s},t.submesh_init_shape_keys=p,t.is_long_submesh=P,t.is_indexed=S,t.submesh_drop_indices=A,t.update_bufs_data_index_array=function(e,t,r){return g(e,t),e.count=r.length,e.ibo_array=r,e.ibo_type=r instanceof Uint16Array?T.UNSIGNED_SHORT:T.UNSIGNED_INT,e},t.update_bufs_data_array=function e(t,n,a,o){if("a_normal"==n)return e(t,"a_tbn",a,YR(o));var _=t.pointers,i=_[n],s=re(n);if(i)a&&i.num_comp!=a&&r.panic('invalid num_comp for "'+n+'"'),ne(t.vbo_source_data,n,o,i.offset);else{var l=Z(t.vbo_source_data,s);-1==l&&(t.vbo_source_data.push(J(s,0)),l=t.vbo_source_data.length-1);var c=t.vbo_source_data[l].vbo_source,E=new c.constructor(c.length+o.length);E.set(c),t.vbo_source_data[l].vbo_source=E,ne(t.vbo_source_data,n,o,c.length);var u=_[n]={length:0,frames:1,num_comp:0,offset:0,divisor:0};u.num_comp=a,u.offset=c.length,u.length=o.length}return N(t),t},t.extract_array_float=m,t.make_static=function(e){e.usage=T.STATIC_DRAW},t.make_dynamic=function(e){e.usage=T.DYNAMIC_DRAW};var O=function(){var e=Fv(),t=dm();return function(r,n,a,o){var _=r.tsr_array,i=r.stat_part_em_tsr,s=r.part_inh_attrs,l=r.submesh_params,c=r.static_hair,E={a_part_ts:{data:[],num_comp:4},a_part_r:{data:[],num_comp:4}};for(var u in s)E[u]={data:[],num_comp:s[u].num_comp};for(var u in l)E[u]={data:[],num_comp:1};for(var T=0;T<_.length;T++){var f=_[T];c&&i&&!r.dyn_grass&&(f=tg(i,_[T],d)),!c&&r.dyn_grass&&dh(_[T],i,_[T]);var p=Qm(f,e),P=Vm(f,t),S=E.a_part_ts.data,A=E.a_part_r.data;for(var u in S.push.apply(S,p),A.push.apply(A,P),s)for(var h=s[u].num_comp,v=0;v<h;v++)E[u].data.push(s[u].data[T*h+v]);for(var u in l)E[u].data.push(l[u][0])}for(var u in E){var m=re(u);ne(a,u,E[u].data,o[m]);var g={length:0,frames:1,num_comp:0,offset:0,divisor:0};g.num_comp=E[u].num_comp,g.offset=o[m],g.divisor=1,g.length=E[u].data.length,n[u]=g,o[m]+=g.length}}}();function N(e){e.ibo_array?(e.ibo||(e.ibo=T.createBuffer()),T.bindBuffer(T.ELEMENT_ARRAY_BUFFER,e.ibo),T.bufferData(T.ELEMENT_ARRAY_BUFFER,e.ibo_array,e.usage),e.debug_ibo_bytes=e.ibo_array.byteLength):e.debug_ibo_bytes=0,e.debug_vbo_bytes=0;for(var t=0;t<e.vbo_source_data.length;t++){var r=e.vbo_source_data[t].type,n=Z(e.vbo_data,r);-1==n&&(e.vbo_data.push({vbo:null,type:r,debug_id:a.unique_id()}),n=e.vbo_data.length-1);var o=e.vbo_data[n];o.vbo||(o.vbo=T.createBuffer()),T.bindBuffer(T.ARRAY_BUFFER,o.vbo),T.bufferData(T.ARRAY_BUFFER,e.vbo_source_data[t].vbo_source,e.usage),e.debug_vbo_bytes+=e.vbo_source_data[t].vbo_source.byteLength}}function R(e,t){e.bb_local=GN(e.bb_local,t),e.be_local=XN(e.be_local,t),e.bs_local=BN(e.bs_local,t),e.bbr_local=HN(e.bbr_local,t)}function I(e){var t=e[0],r=function(e){for(var t=e[0],r=q("JOIN_"+e.length+"_SUBMESHES"),n=0,a=0;a<e.length;a++)n+=e[a].indices.length;r.indices=new Uint32Array(n);var o=0,_=0;if(e[0].shape_keys.length>0)for(var i=0;i<e[0].shape_keys.length;i++){for(a=0;a<e.length;a++)o+=e[a].shape_keys[i].geometry.a_position.length,_+=BR(e[a].shape_keys[i].geometry.a_tbn);var s={a_position:new Float32Array(o),a_tbn:DR(_)};r.shape_keys.push({init_value:e[0].shape_keys[i].init_value,geometry:s})}for(n=0,a=0;a<e.length;a++)n+=e[a].base_length;for(var l in r.base_length=n,t.va_common){for(n=0,a=0;a<e.length;a++)n+=e[a].va_common[l].length;r.va_common[l]=new Float32Array(n)}for(var l in t.va_frames[0]){for(n=0,a=0;a<e.length;a++)n+=e[a].va_frames[0][l].length;for(a=0;a<t.va_frames.length;a++)r.va_frames[a]=r.va_frames[a]||{},r.va_frames[a][l]=new Float32Array(n)}return r}(e),n=r.submesh_bd;n.bb_local=UN(t.submesh_bd.bb_local);for(var a=0,o=0,_=[],i=0;i<e.length;i++){var s=e[i],l=s.indices,c=s.base_length,E=s.va_common,u=s.submesh_bd.bs_local;DN(n.bb_local,s.submesh_bd.bb_local),JN(n.bs_local,u),ZN(s.submesh_bd.bbr_local,_);for(var d=0;d<l.length;d++)r.indices[a+d]=l[d]+o;for(var T in a+=l.length,E){var f=o*w(S=E[T],c);r.va_common[T].set(S,f)}for(d=0;d<s.va_frames.length;d++){var p=s.va_frames[d],P=r.va_frames[d];for(var T in p){var S;f=o*w(S=p[T],c),P[T].set(S,f)}}o+=c}if(n.be_local=$N(Qg(_),!0),r.shape_keys.length>0)for(i=0;i<r.shape_keys.length;i++){var A=r.shape_keys[i].geometry,h=0,v=0;for(d=0;d<e.length;d++){var m=e[d].shape_keys[i].geometry;A.a_position.set(m.a_position,h),A.a_tbn.set(m.a_tbn,v),h+=m.a_position.length,v+=m.a_tbn.length}}return e[0].instanced_array_data&&(r.instanced_array_data={tsr_array:t.instanced_array_data.tsr_array,stat_part_em_tsr:t.instanced_array_data.stat_part_em_tsr,static_hair:!0,submesh_params:t.instanced_array_data.submesh_params,part_inh_attrs:t.instanced_array_data.part_inh_attrs,dyn_grass:t.instanced_array_data.dyn_grass}),r}function b(e,t,r){for(var n,a,o=t.submesh_bd,_={max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0},i=wN(),s=[],l=0;l<r.length;l++)GN(e.submesh_bd.bb_local,r[l],_),DN(o.bb_local,_),HN(e.submesh_bd.bbr_local,r[l],i),ZN(i,s);o.be_local=$N(Qg(s),!0),o.bbr_local=(n=o.be_local,a=wN(),ch(n.axis_x,a.axis_x),ch(n.axis_y,a.axis_y),ch(n.axis_z,a.axis_z),ch(n.center,a.center),a),o.bs_local=eR(o.be_local)}function y(e,t,r,n,a,_){var i=e.submeshes[t],s=i.base_length,l=q("SUBMESH_"+e.name+"_"+e.materials[t].name);l.base_length=s;var c=!1;if(x(r,"a_texcoord"))var E=function(e,t){var r=null,n=e.materials[t],a=e.submeshes[t];if(n.texture_slots.length){var o=n.texture_slots[0];switch(o.texture_coords){case"UV":r=Y(a,o.uv_layer||e.active_uv_name,e.name);break;case"ORCO":r=function(e,t){for(var r=new Float32Array(2*t.base_length),n=(e.max_x+e.min_x)/2,a=(e.max_y+e.min_y)/2,o=e.max_x-e.min_x,_=e.max_y-e.min_y,i=0,s=0;s<t.position.length;s+=3)r[i++]=(t.position[s]-n)/o+.5,r[i++]=(t.position[s+1]-a)/_+.5;return r}(e.b4w_boundings.bb_src,a)}}return null===r&&(r=new Float32Array(2*a.base_length)),r}(e,t);else E=new Float32Array(0);if(x(r,"a_orco_tex_coord"))var u=function(e,t){for(var r=e.b4w_boundings.bb_src,n=new Float32Array(3*t.base_length),a=t.position,o=r.max_x-r.min_x,_=r.max_y-r.min_y,i=r.max_z-r.min_z,s=0,l=0;l<a.length;l+=3)n[s++]=0==o?.5:xO(parseFloat(((a[l]-r.min_x)/o).toFixed(5)),0,1),n[s++]=0==_?.5:xO(parseFloat(((a[l+1]-r.min_y)/_).toFixed(5)),0,1),n[s++]=0==i?.5:xO(parseFloat(((a[l+2]-r.min_z)/i).toFixed(5)),0,1);return n}(e,i);else u=new Float32Array(0);var d=function(e,t,r,n){if(x(e,"a_influence")&&r)for(var a=new Float32Array(4*t),o=n.length/t,_=function(e,t){for(var r=new Float32Array(t),n=0;n<t;n++)for(var a in r[n]=-1,e){var o=e[a];if(o.vgroup_index===n){r[n]=o.deform_bone_index;break}}return r}(r,o),i=o>3?o:4,s=new Float32Array(i),l=new Uint32Array(i),c=new Float32Array(4),E=new Float32Array(i),u=new Uint32Array(i),d=new Float32Array(4),T=0;T<t;T++)s.set(E),l.set(u),c.set(d),a.set(C(n,o,T,t,_,s,l,c),4*T);else a=new Float32Array(0);return a}(r,s,n,i.group);if(a)var T=lO(a);else T={};T.a_color={generate_buffer:!0},T.a_color.src=x(r,"a_color")&&e.active_vcol_name?[{name:e.active_vcol_name,mask:7}]:[],l.va_common.a_texcoord=E,l.va_common.a_influence=d,l.va_common.a_orco_tex_coord=u,function(e,t,r,n,a,_){var i=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].name);return t}(r);for(var s in t){var l=t[s].src;if(l.length){for(var c=0,E=0;E<l.length;E++)c+=KO(l[E].mask);e[s]=new Float32Array(c*a);var u=0;for(E=0;E<l.length;E++){var d=l[E].name,T=l[E].mask,f=BO(T),p=i.indexOf(d);if(-1==p){o.warn('vertex color "'+d+'" for mesh "'+_+'" not found');var P=7}else{P=r[p].mask;var S=M(r,p,a)}var A=KO(P);(T&P)!==T&&o.error("Wrong color extraction from "+d+" to "+s+' for the mesh "'+_+'".');for(var h=0;h<a;h++)for(var v=0;v<3;v++)if(f[v]){var m=u+XO(T,v),g=XO(P,v);e[s][h*c+m]=-1==p?0:n[S+h*A+g]}u+=A}}else e[s]=new Float32Array(0)}}(l.va_common,T,i.vertex_colors,i.color,s,e.name),function(e,t,r,n){if(r)for(var a in r)n[r[a]]=Y(e,a,t)}(i,e.name,_,l.va_common),l.indices=new Uint32Array(i.indices);var f=i.position.length/s/3;if(x(r,"a_tbn")&&i.tbn.length)var p=!0;else p=!1;if(x(r,"a_shade_tangs")&&i.shade_tangs.length)var P=!0;else P=!1;e.b4w_shape_keys.length>0&&(c=!0);for(var S=0;S<f;S++){var h=L(i,s,p,P,S);if(c){var v={};if(v.name=e.b4w_shape_keys[S].name,l.shape_keys.push(v),0!=S){v.geometry=h,v.init_value=e.b4w_shape_keys[S].value;continue}v.geometry=L(i,s,p,P,S),v.init_value=1}l.va_frames.push(h)}if(f>1&&!c){var m=l.va_frames[0];for(var g in h={},m)h[g]=new Float32Array(m[g]);l.va_frames.push(h)}return x(r,"a_polyindex")&&(A(l,1,!0),l.va_common.a_polyindex=B(l)),function(e,t){t.bb_local={max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0},t.bb_local.max_x=e.bb.max_x,t.bb_local.max_y=e.bb.max_y,t.bb_local.max_z=e.bb.max_z,t.bb_local.min_x=e.bb.min_x,t.bb_local.min_y=e.bb.min_y,t.bb_local.min_z=e.bb.min_z;var r=e.rbb,n=e.caxis_x,a=e.caxis_y,o=e.caxis_z,_=e.be_ax;t.be_local=WN(n,a,o,e.be_cen),Sh(t.be_local.axis_x,_[0],t.be_local.axis_x),Sh(t.be_local.axis_y,_[1],t.be_local.axis_y),Sh(t.be_local.axis_z,_[2],t.be_local.axis_z),t.bs_local=eR(t.be_local),ch(r.rbb_c,t.bbr_local.center),ch(n,t.bbr_local.axis_x),ch(a,t.bbr_local.axis_y),ch(o,t.bbr_local.axis_z);var i=r.rbb_s;Sh(t.bbr_local.axis_x,i[0],t.bbr_local.axis_x),Sh(t.bbr_local.axis_y,i[1],t.bbr_local.axis_y),Sh(t.bbr_local.axis_z,i[2],t.bbr_local.axis_z)}(i.boundings,l.submesh_bd),l}function L(e,t,r,n,a){var o={},_=new Float32Array(3*t),i=DR(r?t:0),s=a*t*3,l=s+3*t;if(_.set(e.position.subarray(s,l),0),r&&function(e,t,r,n){if(0!==r){t=4*t||0,r=r||e.length;for(var a=0,o=0;a<4*r;a+=4,o+=4)n[o]=e[t+a],n[o+1]=e[t+a+1],n[o+2]=e[t+a+2],n[o+3]=e[t+a+3]}}(e.tbn,s=a*t,t,i),n){var c=new Float32Array(3*t);c.set(e.shade_tangs.subarray(0,l=3*t),0),o.a_shade_tangs=c}return o.a_position=_,o.a_tbn=i,o}function Y(e,t,r){var n=2*e.base_length,a=e.uv_layers.indexOf(t);if(-1==a)return o.warn('uv layer "'+t+'" for mesh "'+r+'" not found'),new Float32Array(n);var _=a*n;return e.texcoord.subarray(_,_+n)}function M(e,t,r){for(var n=0,a=0;a<t;a++)n+=KO(e[a].mask);return n*r}function x(e,t){return e.indexOf(t)>-1}function C(e,r,n,a,o,_,i,s){for(var l=!0,c=0;c<r;c++){var E=e[c*a+n];if(-1!==E){var u=o[c];-1!==u&&(_[c]=E,i[c]=u,l=!1)}}if(l)return s;U(_,i,t.SORT_NUMERIC,!1);var d=0;for(c=0;c<4;c++)d+=_[c];if(d<.01)return s;for(c=0;c<4;c++)_[c]/=d;if(Math.abs(_[0]-1)<.01)s[0]=i[0]+1;else for(c=0;c<4;c++)s[c]=i[c]+_[c];return s}function w(e,t){if(0==t)return 0;var n=e.length,a=n/t;return a!=Math.floor(a)&&r.panic("Array size mismatch during geometry calculation: array length="+n+", base length="+t),a}function U(e,r,n,a){for(var o,_=e.length,i=_,s=!1,l=a?-1:1;i>1||s;){i>1&&(i=Math.floor(i/1.247330950103979)),s=!1;for(var c=0;i+c<_;c++){if(n==t.SORT_NUMERIC)var E=l*(e[c]-e[c+i])<0;else E=e[c]<e[c+i]&&a;E&&(o=e[c],e[c]=e[c+i],e[c+i]=o,o=r[c],r[c]=r[c+i],r[c+i]=o,s=!0)}}}function k(e,t,r){var n=e[3*t],a=e[3*t+1],o=e[3*t+2];e[3*t]=e[3*r],e[3*t+1]=e[3*r+1],e[3*t+2]=e[3*r+2],e[3*r]=n,e[3*r+1]=a,e[3*r+2]=o}function D(e,t,r){var n=[],a=[];dh(t,e,n),dh(r,e,a),Rh(n,n),Rh(a,a);var o=xO(Ih(n,a),-1,1);return Math.acos(o)}function F(e,t,r,n,a,o,_,i,s,l){for(var c=function(e,t,r){var n=[],a=[],o=[];return dh(t,e,n),dh(r,e,a),bh(n,a,o),Rh(o,o),o}(n,a,o),E=0;E<3;E++){var u=3*t+E,d=3*r+E;l[3*e+E]=_*c[E],l[u]=i*c[E],l[d]=s*c[E]}}function G(e,t){for(var r=new Float32Array(3),n=0;n<3;n++)r[n]=t[3*e+n];for(Rh(r,r),n=0;n<3;n++)t[3*e+n]=r[n]}function K(e,t,r){if(S(t))for(var n=t.indices,a=n.length/3,o=0;o<a;o++){var _=new Float32Array(9),i=n[3*o];_[0]=e[3*i],_[1]=e[3*i+1],_[2]=e[3*i+2];var s=n[3*o+1];_[3]=e[3*s],_[4]=e[3*s+1],_[5]=e[3*s+2];var l=n[3*o+2];_[6]=e[3*l],_[7]=e[3*l+1],_[8]=e[3*l+2],r[o]=_}else for(a=e.length/9,o=0;o<e.length;o++)(_=new Float32Array(9))[0]=e[9*o],_[1]=e[9*o+1],_[2]=e[9*o+2],_[3]=e[9*o+3],_[4]=e[9*o+4],_[5]=e[9*o+5],_[6]=e[9*o+6],_[7]=e[9*o+7],_[8]=e[9*o+8],r[o]=_;return r}function B(e){for(var t=new Float32Array(e.base_length),r=0;r<e.base_length;r++)t[r]=r%3/2;return t}function X(e,t,r){return Math.sqrt(H(e,t,r))}function H(e,t,r){var n=hh(e,t),a=hh(e,r),o=hh(t,r),_=(n+a+o)/2;return _*(_-n)*(_-a)*(_-o)}function j(e,t,r){r||(r=new Float32Array(3));var n=e[0],a=e[1],o=e[2],_=e[3],i=e[4],s=e[5],l=e[6],c=e[7],E=e[8],u=$g(t),d=$g(t);u+d>1&&(u=1-u,d=1-d);var T=1-u-d,f=T*a+u*i+d*c,p=T*o+u*s+d*E;return r[0]=T*n+u*_+d*l,r[1]=f,r[2]=p,r}function z(e){for(var t=new Float32Array([0,0,0,1,1,1,1,0]),r=new Float32Array(8*e),n=0;n<e;n++)r.set(t,8*n);return r}function Q(e,t,r,n){if(e){for(var a=e.offset,o=e.length+a,_=t.bufs_data.shape_keys[0].geometry.a_position,i=a;i<o;i++)r[i]=_[i-a];for(i=1;i<t.bufs_data.shape_keys.length;i++){var s=t.bufs_data.shape_keys[i].geometry.a_position,l=n[i].value;if(l)for(var c=a;c<o;c++)r[c]+=l*s[c-a]}T.bufferSubData(T.ARRAY_BUFFER,4*a,r.subarray(a))}}function V(e,t,r,n){if(e){for(var a=e.offset,o=e.length+a,l=t.bufs_data.shape_keys,c=l[0].geometry.a_tbn,E=FR(_),u=a;u<o;u+=4){for(var d=FR(s),f=(u-a)/4,p=1;p<l.length;p++){var P=n[p].value;P&&zR(jR(E,GR(l[p].geometry.a_tbn,f,i),P,i),E,d)}var S=zR(d,GR(c,f,i),i);r[u]=uN(S[0]),r[u+1]=uN(S[1]),r[u+2]=uN(S[2]),r[u+3]=uN(S[3])}T.bufferSubData(T.ARRAY_BUFFER,4*a,r.subarray(a))}}function q(e){return{name:e,base_length:0,indices:null,va_frames:[],va_common:{a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)},shape_keys:[],submesh_bd:{bb_local:{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0},be_local:VN(),bs_local:zN(),bbr_local:wN()},instanced_array_data:null}}function W(e){var t=[];for(var r in e)t.push(J(r,e[r]));return t}function J(e,t){return{vbo_source:new(te(e))(t),type:e}}function Z(e,t){for(var r=0;r<e.length;r++)if(e[r].type==t)return r;return-1}function $(e,t){var r=Z(e,t);return-1==r?null:e[r].vbo}function ee(e,t){var r=Z(e,t);return-1==r?null:e[r].vbo_source}function te(e){switch(e){case"float":return Float32Array;case"short":return Int16Array;case f:return Uint8Array;default:return Float32Array}}function re(e){switch(e=(e=e.replace(/_next$/,"")).replace(/param_GEOMETRY_VC_a_\w+/,"param_GEOMETRY_VC_a")){case"a_tbn":case"a_shade_tangs":return"short";case"a_color":case"a_bending_col_main":case"a_bending_col_detail":case"a_grass_size":case"a_grass_color":case"param_GEOMETRY_VC_a":case"a_polyindex":case"a_p_bb_vertex":case"a_halo_bb_vertex":case"a_bb_vertex":return f;default:return"float"}}function ne(e,t,r,n){oe(t,r,e[Z(e,re(t))].vbo_source.subarray(n))}function ae(e,t,r){switch(re(e)){case"float":r.set(t);break;case"short":for(var n=0;n<t.length;n++)r[n]=dN(t[n]);break;case f:for(n=0;n<t.length;n++)r[n]=fN(t[n])}return r}function oe(e,t,r){switch(re(e)){case"float":r.set(t);break;case"short":for(var n=0;n<t.length;n++)r[n]=uN(t[n]);break;case f:for(n=0;n<t.length;n++)r[n]=TN(t[n])}return r}t.update_gl_buffers=N,t.update_gl_buffer_sub_data=function(e,t,r,n){var a=Z(e.vbo_data,t);T.bindBuffer(T.ARRAY_BUFFER,e.vbo_data[a].vbo),T.bufferSubData(T.ARRAY_BUFFER,4*n,r)},t.cleanup_bufs_data=function(e){e.ibo&&T.deleteBuffer(e.ibo);for(var t=0;t<e.vbo_data.length;t++)e.vbo_data[t].vbo&&T.deleteBuffer(e.vbo_data[t].vbo);e.vbo_data.length=0},t.has_empty_submesh=function(e,t){return!e.submeshes[t].base_length},t.submesh_apply_transform=function(e,t){for(var r=0;r<e.va_frames.length;r++){var n=e.va_frames[r].a_position;ag(n,t,n,0);var a=e.va_frames[r].a_tbn;HR(a,t,a);var o=e.va_frames[r].a_shade_tangs;o&&o.length>0&&og(o,t,o,0)}var _=e.va_common.au_center_pos;return _&&_.length&&ag(_,t,_,0),R(e.submesh_bd,t),e},t.submesh_apply_particle_transform=function(e,t){var n=e.va_common.au_center_pos;if(n&&n.length){var a=new Float32Array(n);ag(a,t,a,0);for(var o=0;o<e.va_frames.length;o++)for(var _=0;_<a.length;_++)e.va_frames[o].a_position[_]+=a[_]-n[_];n.set(a)}else r.panic('Attribute "au_center_pos" is missing in particle submesh');return R(e.submesh_bd,t),e},t.bounding_data_apply_transform=R,t.submesh_apply_params=function(e,t){var r=e.base_length;for(var n in t){var a=t[n].length;e.va_common[n]=new Float32Array(a*r);for(var o=0;o<r;o++)for(var _=0;_<a;_++)e.va_common[n][o*a+_]=t[n][_]}return e},t.submesh_list_join=I,t.make_propagated_submesh=function(e,t,a){if(!e.base_length)return q("EMPTY");var o=a.length;e.base_length*o>65536&&!n.get_elem_index_uint()&&A(e,o);var _=e.indices,i=e.base_length,s=e.va_common,l=e.va_frames;for(var c in t){var E=t[c].length,u=E*i;s[c]=new Float32Array(u);for(var d=0;d<i;d++)for(var T=0;T<E;T++)s[c][d*E+T]=t[c][T]}var f=q("CLONE_"+o+"_SUBMESHES");for(f.base_length=i*o,f.indices=new Uint32Array(_.length*o),d=0;d<o;d++){var p=_.length*d,P=i*d;for(T=0;T<_.length;T++)f.indices[p+T]=_[T]+P}for(var S in s){u=(v=s[S]).length*o;var h=w(v,i);for(f.va_common[S]=new Float32Array(u),d=0;d<o;d++)f.va_common[S].set(v,P=i*h*d)}for(var S in l[0])for(d=0;d<l.length;d++){var v;for(u=(v=l[d][S]).length*o,h=w(v,i),f.va_frames[d]=f.va_frames[d]||{},f.va_frames[d][S]=new Float32Array(u),T=0;T<o;T++){var m=a[T];switch(P=i*h*T,S){case"a_position":ag(v,m,f.va_frames[d][S],P);break;case"a_tbn":lg(v,m,f.va_frames[d][S],P);break;case"a_shade_tangs":ig(v,m,f.va_frames[d][S],P);break;default:r.panic("Wrong attribute name: "+S)}}}return b(e,f,a),f},t.calc_unit_boundings=b,t.extract_submesh=y,t.extract_halo_submesh=function(e){for(var t=e.base_length,r=e.va_frames[0].a_position,n=new Float32Array(12*t),a=new Uint32Array(4*e.indices.length),o=new Float32Array(4*t),_=0;_<t;_++){n[12*_]=r[3*_],n[12*_+1]=r[3*_+1],n[12*_+2]=r[3*_+2],n[12*_+3]=r[3*_],n[12*_+4]=r[3*_+1],n[12*_+5]=r[3*_+2],n[12*_+6]=r[3*_],n[12*_+7]=r[3*_+1],n[12*_+8]=r[3*_+2],n[12*_+9]=r[3*_],n[12*_+10]=r[3*_+1],n[12*_+11]=r[3*_+2],a[6*_]=4*_+2,a[6*_+1]=4*_+1,a[6*_+2]=4*_,a[6*_+3]=4*_+2,a[6*_+4]=4*_,a[6*_+5]=4*_+3;var i=Math.random();o[4*_]=i,o[4*_+1]=i,o[4*_+2]=i,o[4*_+3]=i}var s=q("HALO");return s.va_frames[0]={},s.base_length=4*t,s.va_frames[0].a_position=n,s.va_common.a_halo_bb_vertex=z(t),s.va_common.a_random_vals=o,s.indices=a,s},t.has_attr=x,t.extract_submesh_all_mats=function(e,t,r){for(var n=[],a=0;a<e.submeshes.length;a++){var o=y(e,a,t,null,r,null);o.base_length&&n.push(o)}if(0==n.length)var _=q("EMPTY");else _=1==n.length?n[0]:I(n);return _},t.update_buffers_movable=function(e,t,r,n){var a=e.ibo_array,o=m(e,"a_position"),_=t.median_cache,i=t.median_world_cache,s=t.dist_cache;!function(e,t,r){for(var n=e.length/3,a=0;a<n;a++){var o=e[3*a],_=e[3*a+1],i=e[3*a+2],s=t[3*o+1],l=t[3*o+2],c=t[3*_+1],E=t[3*_+2],u=t[3*i+1],d=t[3*i+2];r[3*a]=(t[3*o]+t[3*_]+t[3*i])/3,r[3*a+1]=(s+c+u)/3,r[3*a+2]=(l+E+d)/3}}(a,o,_),ag(_,r,i),function(e,t,r){for(var n=e.length/3,a=0;a<n;a++){var o=e[3*a]-t[0],_=e[3*a+1]-t[1],i=e[3*a+2]-t[2];r[a]=o*o+_*_+i*i}}(i,n,s),a=function(e,t){var r=e.length;if(r<2)return t;for(var n,a=r,o=!1;a>1||o;){a>1&&(a=Math.floor(a/1.247330950103979)),o=!1;for(var _=0;a+_<r;_++)e[_]-e[_+a]<0&&(n=e[_],e[_]=e[_+a],e[_+a]=n,k(t,_,_+a),o=!0)}return t}(s,a),T.bindBuffer(T.ELEMENT_ARRAY_BUFFER,e.ibo),T.bufferData(T.ELEMENT_ARRAY_BUFFER,a,T.DYNAMIC_DRAW)},t.sort_two_arrays=U,t.calc_normals=function(e,t,r){for(var n=t.length/3,a=e.length/3,o=[],_=new Array(3),i=new Array(3),s=new Array(3),l=0;l<a;l++){for(var c=e[3*l],E=e[3*l+1],u=e[3*l+2],d=0;d<3;d++)_[d]=t[3*c+d],i[d]=t[3*E+d],s[d]=t[3*u+d];if(r)var T=D(_,i,s),f=D(i,s,_),p=Math.PI-T-f;else T=1,f=1,p=1;F(c,E,u,_,i,s,T,f,p,o)}for(r&&function(e,t){for(var r in e)for(var n=e[r],a=0;a<3;a++){for(var o=3*n[0]+a,_=1;_<n.length;_++)t[o]+=t[3*n[_]+a];for(_=1;_<n.length;_++)t[3*n[_]+a]=t[o]}}(r,o),l=0;l<n;l++)G(l,o);return o},t.calc_shared_indices=function(e,t,r){for(var n={},a=t.length/3,o=0;o<a;o++){var _=String(t[3*o])+String(t[3*o+1])+String(t[3*o+2]);n[_]=[]}var i=e.length;for(o=0;o<i;o++){var s=e[o];(_=String(r[3*s])+String(r[3*s+1])+String(r[3*s+2]))in n&&n[_].push(s)}return n},t.geometry_random_points=function(e,t,r,n){var a=function(e,t){return t||(t=[]),K(e.va_frames[0].a_position,e,t)}(e,null);if(r)var o=function(e,t){t||(t=[]);for(var r=e.va_frames[0].a_tbn,n=BR(r),a=new Float32Array(3*n),o=0;o<n;o++){var _=MR(r,o,u),i=wh(wg,_,l);a[3*o]=i[0],a[3*o+1]=i[1],a[3*o+2]=i[2]}return K(a,e,t)}(e,null);for(var _=a.length,i=new Float32Array(_),s=l,d=c,T=E,f=0;f<_;f++)s.set((h=a[f]).subarray(0,3)),d.set(h.subarray(3,6)),T.set(h.subarray(6)),i[f]=X(s,d,T);var p=new Float32Array(_);for(p[0]=i[0],f=1;f<_;f++)p[f]=p[f-1]+i[f];var P=p[i.length-1],S=[];for(f=0;f<t;f++){var A=PO(p,P*$g(n),0,p.length-1);if(r)var h=o[A];else h=a[A];var v=j(h,n,l);if(r){S[f]=new Float32Array(4),Rh(v,v);var m=Sm(wg,v,u);S[f][0]=m[0],S[f][1]=m[1],S[f][2]=m[2],S[f][3]=m[3]}else S[f]=new Float32Array(3),S[f][0]=v[0],S[f][1]=v[1],S[f][2]=v[2]}return S},t.extract_polyindices=B,t.triangle_area_squared=H,t.gen_bb_vertices=z,t.scale_submesh_xyz=function(e,t,r){for(var n=e.va_frames[0].a_position,a=0;a<n.length;a+=3)n[a]=(n[a]-r[0])*t[0]+r[0],n[a+1]=(n[a+1]-r[1])*t[1]+r[1],n[a+2]=(n[a+2]-r[2])*t[2]+r[2]},t.apply_shape_key=function(e,t,r){for(var n=e.scenes_data[0].batches,a=e.render.shape_keys_values,o=1;o<a.length;o++)a[o].name==t&&(a[o].value=r);for(o=0;o<n.length;o++)if(!n[o].forked_batch&&n[o].use_shape_keys&&!n[o].debug_sphere){var _=n[o].bufs_data,i=re("a_position"),s=$(_.vbo_data,i),l=ee(_.vbo_source_data,i);T.bindBuffer(T.ARRAY_BUFFER,s),Q(_.pointers.a_position,n[o],l,a);var c=re("a_tbn"),E=$(_.vbo_data,c),u=ee(_.vbo_source_data,c);T.bindBuffer(T.ARRAY_BUFFER,E),V(_.pointers.a_tbn,n[o],u,a)}},t.check_shape_keys=function(e){return e.render.use_shape_keys},t.get_shape_keys_names=function(e){var t=[];if(e.render)for(var r=1;r<e.render.shape_keys_values.length;r++)t.push(e.render.shape_keys_values[r].name);return t},t.get_shape_key_value=function(e,t){if(e.render)for(var r=1;r<e.render.shape_keys_values.length;r++)if(t==e.render.shape_keys_values[r].name)return e.render.shape_keys_values[r].value;return 0},t.has_shape_key=function(e,t){var r=e.render.shape_keys_values;if(r)for(var n=1;n<r.length;n++)if(r[n].name==t)return!0;return!1},t.has_dyn_geom=function(e){return!!(e&&e.render&&e.render.dynamic_geometry)},t.draw_line=function(e,r,n){var a=e.bufs_data;if(a){if(n)var o=r.length/3/2;else o=r.length/3-1;for(var _=new Float32Array(4*o*3),i=new Float32Array(4*o*3),s=new Uint16Array(6*o),l=0;l<o;l++){if(n)var c=6*l,E=6*l+3;else c=3*l,E=3*(l+1);var u=r[c],d=r[c+1],T=r[c+2],f=r[E],p=r[E+1],P=r[E+2],S=f-u,A=p-d,h=P-T;_[4*l*3]=u,_[4*l*3+1]=d,_[4*l*3+2]=T,i[4*l*3]=S,i[4*l*3+1]=A,i[4*l*3+2]=h,_[4*l*3+3]=f,_[4*l*3+4]=p,_[4*l*3+5]=P,i[4*l*3+3]=-S,i[4*l*3+4]=-A,i[4*l*3+5]=-h,_[4*l*3+6]=u,_[4*l*3+7]=d,_[4*l*3+8]=T,i[4*l*3+6]=-S,i[4*l*3+7]=-A,i[4*l*3+8]=-h,_[4*l*3+9]=f,_[4*l*3+10]=p,_[4*l*3+11]=P,i[4*l*3+9]=S,i[4*l*3+10]=A,i[4*l*3+11]=h,s[6*l]=4*l,s[6*l+1]=4*l+1,s[6*l+2]=4*l+2,s[6*l+3]=4*l,s[6*l+4]=4*l+3,s[6*l+5]=4*l+1}var v=0;for(var m in a.pointers)v+=_.length/3*(I=a.pointers[m]).num_comp;var g={};g.float=v;var O=a.vbo_source_data=W(g);t.update_bufs_data_index_array(a,e.draw_mode,s);var R=0;for(var m in a.pointers){var I=a.pointers[m];switch(m){case"a_position":ne(O,m,_,R),I.offset=R,I.length=_.length,R+=I.length;break;case"a_direction":ne(O,m,i,R),I.offset=R,I.length=i.length,R+=I.length;break;default:I.offset=R,I.length=_.length/3*I.num_comp,ne(O,m,new Float32Array(I.length),R),R+=I.length}}N(a)}},t.clone_bufs_data=function(e){if(e){var t=v();if(e.ibo_array)switch(e.ibo_type){case T.UNSIGNED_SHORT:t.ibo_array=new Uint16Array(e.ibo_array);break;case T.UNSIGNED_INT:t.ibo_array=new Uint32Array(e.ibo_array)}else t.ibo_array=null;t.vbo_source_data=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r].vbo_source,a=e[r].type;t.push({vbo_source:new n.constructor(n),type:a})}return t}(e.vbo_source_data),t.ibo_type=e.ibo_type,t.count=e.count,t.pointers=lO(e.pointers),t.usage=e.usage,t.debug_ibo_bytes=e.debug_ibo_bytes,t.debug_vbo_bytes=e.debug_vbo_bytes,t.ibo=null,t.info_for_z_sort_updates=lO(e.info_for_z_sort_updates),t.shape_keys=lO(e.shape_keys),t.instance_count=e.instance_count,t.cleanup_gl_data_on_unload=e.cleanup_gl_data_on_unload}else t=null;return t},t.init_submesh=q,t.clone_submesh=function(e){var t,r,n=q(e.name);return n.base_length=e.base_length,n.indices=lO(e.indices),n.va_frames=lO(e.va_frames),n.va_common=lO(e.va_common),n.shape_keys=lO(e.shape_keys),CN(e.submesh_bd.bb_local,n.submesh_bd.bb_local),qN(e.submesh_bd.be_local,n.submesh_bd.be_local),QN(e.submesh_bd.bs_local,n.submesh_bd.bs_local),ch((t=e.submesh_bd.bbr_local).center,(r=n.submesh_bd.bbr_local).center),ch(t.axis_x,r.axis_x),ch(t.axis_y,r.axis_y),ch(t.axis_z,r.axis_z),n.instanced_array_data=lO(e.instanced_array_data),n},t.reset=function(){T=null},t.init_vbo_source_data=W,t.search_vbo_index_by_type=Z,t.get_vbo_by_type=$,t.get_vbo_source_by_type=ee,t.get_constructor_by_type=te,t.get_vbo_type_by_attr_name=re,t.get_type_size_by_attr_name=function(e){switch(re(e)){case"float":return 4;case"short":return 2;case f:return 1;default:return 4}},t.get_gl_type_by_attr_name=function(e){switch(re(e)){case"float":return T.FLOAT;case"short":return T.SHORT;case f:return T.UNSIGNED_BYTE;default:return T.FLOAT}},t.vbo_source_data_set_attr=ne,t.value_vbo_to_float=function(e,t){switch(re(e)){case"float":return t;case"short":return dN(t);case f:return fN(t)}return t},t.value_float_to_vbo=function(e,t){switch(re(e)){case"float":return t;case"short":return uN(t);case f:return TN(t)}return t},t.array_vbo_to_float=ae,t.array_float_to_vbo=oe,t.create_empty_va_frame=function(){return{a_position:new Float32Array(0),a_tbn:DR(0)}}}));function qR(){var e=ZR();return[parseInt(String(e.getFullYear()).slice(-2),10),e.getMonth()+1]}function WR(){for(var e="",t=qR(),r=0;r<t.length;r++)e+=1==r&&t[r]<10?"0"+t[r]:t[r],r!=t.length-1&&(e+=".");return e}function JR(){return"DEBUG"}function ZR(){return new Date}function $R(){var e=ZR(),t=e.getDate();t=t<10?"0"+String(t):String(t);var r=e.getMonth()+1;r=r<10?"0"+String(r):String(r);var n=String(e.getFullYear()),a=e.getHours();a=a<10?"0"+String(a):String(a);var o=e.getMinutes();o=o<10?"0"+String(o):String(o);var _=e.getSeconds();return t+"."+r+"."+n+" "+a+":"+o+":"+(_<10?"0"+String(_):String(_))}function eI(){return $R().split(" ").join("").split(":").join("").split(".").join("")}var tI=nA("__renderer",(function(e,t){var r=JI(e),n=pb(e),a=dR(e),o=hR(e),_=HI(e),i=gR(e),s=fR(e),l=VR(e),c=mR(e),E=XI(e),u=[1,0,0,1],d=[1,1,1,1],T=[0,0,0,1],f=[0,0,0,0],p=new Uint8Array([91.8,142.8,.96*255,255]),P=(new Float32Array([.25,-.25]),new Float32Array([-.25,.25]),new Float32Array([1,1,1,0]),new Float32Array([2,2,2,0]),null),S=0,A=null,h=null,v=null,m=null,g=null,O=new Float32Array(3),N=dm(),R=new Uint8Array(4),I=a.defaults;function b(e){for(var t=e.camera,n=e.draw_data,a=null,o=jm(t.world_tsr,O),_=0;_<n.length;_++){var s=n[_];if(s.do_render){var l=s.shader,c=s.bundles;l.program!=a&&(P.useProgram(l.program),y(e,t,l),a=l.program),s.alpha_antialiasing?(P.enable(P.SAMPLE_ALPHA_TO_COVERAGE),e.blend||P.enable(P.BLEND)):(P.disable(P.SAMPLE_ALPHA_TO_COVERAGE),e.blend||P.disable(P.BLEND));for(var E=0;E<c.length;E++){var u=c[E];if(u.do_render){var d=u.obj_render,T=u.batch;i.start_batch(T),i.is_debug_view_render_time_mode()&&"DEBUG_VIEW"==T.type&&(T.debug_main_batch_render_time=CO(r.batch_get_debug_storage(T.debug_main_batch_id),T.debug_main_batch_render_time,1,15)),I.alpha_sort&&T.z_sort&&M(T,d,u.info_for_z_sort_updates,o),Y(e,d,T,l),i.stop_batch(T),i.is_debug_view_render_time_mode()&&"MAIN"==T.type&&r.batch_set_debug_storage(T.id,T.debug_render_time)}}}}}function y(e,t,r){for(var n=r.transient_sc_uniform_setters,a=n.length;a--;)(i=n[a]).fun(P,i.loc,e,t);if(r.need_uniforms_update&&!r.no_permanent_uniforms){r.permanent_sc_uniform_setters.length||U(r);for(var o=r.permanent_sc_uniform_setters,_=o.length;_--;){var i;(i=o[_]).fun(P,i.loc,e,t)}}}function L(e){if(e){if(!(r=(e.clear_color?P.COLOR_BUFFER_BIT:0)|(e.clear_depth?P.DEPTH_BUFFER_BIT:0)))return;switch(e.type){case c.MAIN_GLOW:var t=f;break;case c.SHADOW_CAST:t=u;break;case c.SHADOW_RECEIVE:t=d;break;case c.COLOR_PICKING:case c.COLOR_PICKING_XRAY:case c.ANCHOR_VISIBILITY:t=T;break;case c.MAIN_OPAQUE:case c.OUTLINE_MASK:case c.SMAA_BLENDING_WEIGHT_CALCULATION:case c.SMAA_EDGE_DETECTION:t=f;break;default:t=I.background_color}}else{var r=P.COLOR_BUFFER_BIT|P.DEPTH_BUFFER_BIT;t=I.background_color}P.colorMask(!0,!0,!0,!0),P.depthMask(!0),P.clearColor(t[0],t[1],t[2],t[3]),P.clear(r)}function Y(e,t,r,n){for(var a=n.transient_uniform_setters,o=a.length;o--;)(s=a[o]).fun(P,s.loc,t,r);if(n.need_uniforms_update&&!n.no_permanent_uniforms){n.permanent_uniform_setters.length||U(n);for(var _=n.permanent_uniform_setters,i=_.length;i--;){var s;(s=_[i]).fun(P,s.loc,t,r)}n.need_uniforms_update=!1}P.depthMask(r.depth_mask),r.use_backface_culling?P.enable(P.CULL_FACE):P.disable(P.CULL_FACE),function(e){for(var t=P,r=0;r<e.length;r++){var n=e[r];t.activeTexture(t.TEXTURE0+r),t.bindTexture(n.w_target,n.w_texture),n.use_mipmap&&t.generateMipmap(n.w_target)}}(r.textures),e.type==c.SKY||e.type==c.IRRADIANCE?(function(e,t,r){for(var n=r.uniforms,a=e.camera.color_attachment,o=a.w_texture,_=a.w_target,i=e.cube_view_matrices,s=0;s<6;s++){var l=C(s);I.clear_procedural_sky_hack?(P.bindTexture(P.TEXTURE_CUBE_MAP,o),P.texImage2D(l,0,P.RGBA,1,1,0,P.RGBA,P.UNSIGNED_BYTE,p)):(P.uniformMatrix4fv(n.u_cube_view_matrix,!1,i[s]),P.uniform4fv(n.u_sky_tex_fac,e.sky_tex_fac),P.uniform3fv(n.u_sky_tex_color,e.sky_tex_color),P.uniform1f(n.u_sky_tex_dvar,e.sky_tex_default_value),P.uniform3fv(n.u_horizon_color,e.horizon_color),P.uniform3fv(n.u_zenith_color,e.zenith_color),P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,l,o,0),g(t,0)),e.need_fog_update&&5!=s&&x(e,s)}I.texture_lod_available&&(P.bindTexture(_,o),P.generateMipmap(_),P.texParameteri(_,P.TEXTURE_MIN_FILTER,E.TF_LINEAR_MIPMAP_LINEAR)),P.bindFramebuffer(P.FRAMEBUFFER,null)}(e,r,n),e.debug_render_calls+=6):e.type==c.ROUGHNESS_CONVOLUTION?(function(e,t,r){var n=r.uniforms,a=e.camera.color_attachment,o=a.w_texture,_=a.w_target,i=e.cube_view_matrices;I.texture_lod_available&&(P.activeTexture(P.TEXTURE7),P.bindTexture(_,o),P.generateMipmap(_),P.texParameteri(_,P.TEXTURE_MIN_FILTER,E.TF_LINEAR_MIPMAP_LINEAR));for(var s=0;s<5;++s){var l=128*Math.pow(.5,s),c=128*Math.pow(.5,s);P.viewport(0,0,l,c);for(var u=s/4,d=0;d<6;d++){var T=C(d);P.uniformMatrix4fv(n.u_cube_view_matrix,!1,i[d]),P.uniform1f(n.u_roughness,u),P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,T,o,s),g(t,0)}}}(e,r,n),e.debug_render_calls+=30):(g(r,t.va_frame),e.debug_render_calls++)}function M(e,t,r,n){var a=e.bufs_data;(hh(n,r.zsort_eye_last)>I.alpha_sort_threshold*Math.min(r.bb_min_side,1)||t.force_zsort)&&(l.update_buffers_movable(a,r,t.world_tsr,n),ch(n,r.zsort_eye_last),t.force_zsort=!1)}function x(e,t){var r=R;I.clear_procedural_sky_hack?r.set(p):(P.readPixels(191,191,1,1,P.RGBA,P.UNSIGNED_BYTE,r),255!=r[0]&&255!=r[1]&&255!=r[2]||P.readPixels(191,220,1,1,P.RGBA,P.UNSIGNED_BYTE,r));var n=r[0],a=r[1],o=r[2];n/=255,a/=255,o/=255,4===t?(e.cube_fog[3]=n,e.cube_fog[7]=a,e.cube_fog[11]=o):(e.cube_fog[4*t]=n,e.cube_fog[4*t+1]=a,e.cube_fog[4*t+2]=o)}function C(e){switch(e){case 0:return P.TEXTURE_CUBE_MAP_POSITIVE_X;case 1:return P.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return P.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return P.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return P.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return P.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function w(e){var t=s.get_vertex_array_object(),r=e.attribute_setters,n=e.bufs_data,a=n.pointers;e.vaos.length=0;var o=1;for(var _ in a)o=Math.max(o,a[_].frames);for(var i=0;i<o;i++){var l=t.createVertexArray();m(l),n.ibo&&P.bindBuffer(P.ELEMENT_ARRAY_BUFFER,n.ibo);for(var c=0;c<n.vbo_data.length;c++){P.bindBuffer(P.ARRAY_BUFFER,n.vbo_data[c].vbo);for(var E=0;E<r.length;E++){var u=r[E];u.vbo_type==n.vbo_data[c].type&&(P.enableVertexAttribArray(u.loc),P.vertexAttribPointer(u.loc,u.num_comp,u.gl_type,u.gl_type!=P.FLOAT,0,u.base_offset+u.frame_length*i),h(u.loc,u.divisor))}}m(null),e.vaos.push(l)}}function U(e){var t=e.uniforms,r=e.transient_uniform_setters,n=e.permanent_uniform_setters,a=e.transient_sc_uniform_setters,o=e.permanent_sc_uniform_setters;for(var _ in r.length=0,n.length=0,a.length=0,o.length=0,t){var i=!1,s=null,l=null;switch(_){case"u_proj_matrix":case"u_proj_matrix_frag":s=function(e,t,r,n){e.uniformMatrix4fv(t,!1,n.proj_matrix)},i=!0;break;case"u_view_refl_matrix":s=function(e,t,r,n){e.uniformMatrix4fv(t,!1,n.view_refl_matrix)},i=!0;break;case"u_view_tsr":case"u_view_tsr_frag":s=function(e,t,r,n){e.uniformMatrix3fv(t,!1,n.reflection_plane?n.real_view_tsr:n.view_tsr)},i=!0;break;case"u_view_tsr_inverse":s=function(e,t,r,n){e.uniformMatrix3fv(t,!1,n.reflection_plane?n.real_view_tsr_inv:n.view_tsr_inv)},i=!0;break;case"u_shadow_cast_billboard_view_tsr":s=function(e,t,r,n){e.uniformMatrix3fv(t,!1,n.shadow_cast_billboard_view_tsr)},i=!0;break;case"u_view_proj_prev":s=function(e,t,r,n){e.uniformMatrix4fv(t,!1,n.prev_view_proj_matrix)},i=!0;break;case"u_view_proj_matrix":s=function(e,t,r,n){e.uniformMatrix4fv(t,!1,n.view_proj_matrix)},i=!0;break;case"u_view_proj_inverse":s=function(e,t,r,n){e.uniformMatrix4fv(t,!1,n.view_proj_inv_matrix)},i=!0;break;case"u_sky_vp_inverse":s=function(e,t,r,n){e.uniformMatrix4fv(t,!1,n.sky_vp_inv_matrix)},i=!0;break;case"u_camera_eye":case"u_camera_eye_frag":s=function(e,t,r,n){e.uniform3fv(t,jm(n.world_tsr,O))},i=!0;break;case"u_camera_quat":s=function(e,t,r,n){e.uniform4fv(t,Vm(n.world_tsr,N))},i=!0;break;case"u_view_max_depth":s=function(e,t,r,n){e.uniform1f(t,n.far)},i=!0;break;case"u_camera_range":s=function(e,t,r,n){e.uniform2f(t,n.near,n.far)},i=!0;break;case"u_csm_center_dists":s=function(e,t,r,n){e.uniform4fv(t,n.csm_center_dists)};break;case"u_height":s=function(e,t,r,n){e.uniform1f(t,n.height)},i=!0;break;case"u_pcf_blur_radii":s=function(e,t,r,n){e.uniform4fv(t,n.pcf_blur_radii)};break;case"u_dof_dist":s=function(e,t,r,n){e.uniform1f(t,n.dof_on?n.dof_distance:0)},i=!0;break;case"u_dof_front_start":s=function(e,t,r,n){e.uniform1f(t,n.dof_front_start)},i=!0;break;case"u_dof_front_end":s=function(e,t,r,n){e.uniform1f(t,n.dof_front_end)},i=!0;break;case"u_dof_rear_start":s=function(e,t,r,n){e.uniform1f(t,n.dof_rear_start)},i=!0;break;case"u_dof_rear_end":s=function(e,t,r,n){e.uniform1f(t,n.dof_rear_end)},i=!0;break;case"u_dof_bokeh_intensity":s=function(e,t,r,n){e.uniform1f(t,n.dof_bokeh_intensity)},i=!0;break;case"u_camera_direction":s=function(e,t,r,n){e.uniform3fv(t,n.direction)},i=!0;break;case"u_cam_water_depth":s=function(e,t,r,n){e.uniform1f(t,r.cam_water_depth)},i=!0;break;case"u_fog_color_density":s=function(e,t,r,n){e.uniform4fv(t,r.fog_color_density)};break;case"u_fog_params":s=function(e,t,r,n){e.uniform4fv(t,r.fog_params)};break;case"u_underwater_fog_color_density":s=function(e,t,r,n){e.uniform4fv(t,r.water_fog_color_density)};break;case"u_bloom_key":s=function(e,t,r,n){e.uniform1f(t,r.bloom_key)};break;case"u_average_lum_val":s=function(e,t,r,n){e.uniform1f(t,r.average_luminance)};break;case"u_mipmap_1x1":s=function(e,t,r,n){e.uniform1f(t,r.last_mip_map_ind)};break;case"u_bloom_edge_lum":s=function(e,t,r,n){e.uniform1f(t,r.bloom_edge_lum)};break;case"u_time":s=function(e,t,r,n){e.uniform1f(t,r.time)},i=!0;break;case"u_wind":s=function(e,t,r,n){e.uniform3fv(t,r.wind)},i=!0;break;case"u_sky_tex_dvar":s=function(e,t,r,n){e.uniform1f(t,r.sky_tex_default_value)};break;case"u_sky_tex_fac":s=function(e,t,r,n){e.uniform4fv(t,r.sky_tex_fac)};break;case"u_sky_tex_color":s=function(e,t,r,n){e.uniform3fv(t,r.sky_tex_color)};break;case"u_horizon_color":s=function(e,t,r,n){e.uniform3fv(t,r.horizon_color)};break;case"u_zenith_color":s=function(e,t,r,n){e.uniform3fv(t,r.zenith_color)};break;case"u_environment_energy":s=function(e,t,r,n){e.uniform1f(t,r.environment_energy)};break;case"u_bsdf_cube_sky_dim":s=function(e,t,r,n){e.uniform1f(t,r.bsdf_cube_sky_dim)},i=!0;break;case"u_sky_color":s=function(e,t,r,n){e.uniform3fv(t,r.sky_color)};break;case"u_rayleigh_brightness":s=function(e,t,r,n){e.uniform1f(t,r.rayleigh_brightness)};break;case"u_mie_brightness":s=function(e,t,r,n){e.uniform1f(t,r.mie_brightness)};break;case"u_spot_brightness":s=function(e,t,r,n){e.uniform1f(t,r.spot_brightness)};break;case"u_scatter_strength":s=function(e,t,r,n){e.uniform1f(t,r.scatter_strength)};break;case"u_rayleigh_strength":s=function(e,t,r,n){e.uniform1f(t,r.rayleigh_strength)};break;case"u_mie_strength":s=function(e,t,r,n){e.uniform1f(t,r.mie_strength)};break;case"u_rayleigh_collection_power":s=function(e,t,r,n){e.uniform1f(t,r.rayleigh_collection_power)};break;case"u_mie_collection_power":s=function(e,t,r,n){e.uniform1f(t,r.mie_collection_power)};break;case"u_mie_distribution":s=function(e,t,r,n){e.uniform1f(t,r.mie_distribution)};break;case"u_light_positions":s=function(e,t,r,n){e.uniform4fv(t,r.light_positions)};break;case"u_light_directions":s=function(e,t,r,n){e.uniform3fv(t,r.light_directions)};break;case"u_light_color_intensities":s=function(e,t,r,n){e.uniform4fv(t,r.light_color_intensities)};break;case"u_sun_quaternion":s=function(e,t,r,n){e.uniform4fv(t,r.sun_quaternion)};break;case"u_sun_intensity":s=function(e,t,r,n){e.uniform3fv(t,r.sun_intensity)};break;case"u_sun_direction":s=function(e,t,r,n){e.uniform3fv(t,r.sun_direction)};break;case"u_debug_view_mode":s=function(e,t,r,n){e.uniform1i(t,r.debug_view_mode)};break;case"u_debug_colors_seed":s=function(e,t,r,n){e.uniform1f(t,r.debug_colors_seed)};break;case"u_debug_render_time_threshold":s=function(e,t,r,n){e.uniform1f(t,r.debug_render_time_threshold)};break;case"u_subpixel_jitter":s=function(e,t,r,n){e.uniform2fv(t,r.jitter_projection_space)},i=!0;break;case"u_subsample_indices":s=function(e,t,r,n){e.uniform4fv(t,r.jitter_subsample_ind)},i=!0;break;case"u_radial_blur_step":s=function(e,t,r,n){e.uniform1f(t,r.radial_blur_step)};break;case"u_god_rays_intensity":s=function(e,t,r,n){e.uniform1f(t,r.god_rays_intensity)};break;case"u_ssao_radius_increase":s=function(e,t,r,n){e.uniform1f(t,r.ssao_radius_increase)};break;case"u_ssao_blur_discard_value":s=function(e,t,r,n){e.uniform1f(t,r.ssao_blur_discard_value)},i=!0;break;case"u_ssao_influence":s=function(e,t,r,n){e.uniform1f(t,r.ssao_influence)};break;case"u_ssao_dist_factor":s=function(e,t,r,n){e.uniform1f(t,r.ssao_dist_factor)};break;case"u_texel_size":s=function(e,t,r,n){e.uniform2fv(t,r.texel_size)},i=!0;break;case"u_normal_offset":s=function(e,t,r,n){e.uniform1f(t,r.self_shadow_normal_offset)};break;case"u_v_light_ts":s=function(e,t,r,n){e.uniform4fv(t,r.v_light_ts)},i=!0;break;case"u_v_light_r":s=function(e,t,r,n){e.uniform4fv(t,r.v_light_r)},i=!0;break;case"u_v_light_tsr":s=function(e,t,r,n){e.uniformMatrix3fv(t,!1,r.v_light_tsr)},i=!0;break;case"u_p_light_matrix0":s=function(e,t,r,n){e.uniformMatrix4fv(t,!1,r.p_light_matrix[0])},i=!0;break;case"u_p_light_matrix1":s=function(e,t,r,n){e.uniformMatrix4fv(t,!1,r.p_light_matrix[1])},i=!0;break;case"u_p_light_matrix2":s=function(e,t,r,n){e.uniformMatrix4fv(t,!1,r.p_light_matrix[2])},i=!0;break;case"u_p_light_matrix3":s=function(e,t,r,n){e.uniformMatrix4fv(t,!1,r.p_light_matrix[3])},i=!0;break;case"u_outline_color":s=function(e,t,r,n){e.uniform3fv(t,r.outline_color)};break;case"u_draw_outline":s=function(e,t,r,n){e.uniform1f(t,r.draw_outline_flag)},i=!0;break;case"u_glow_mask_small_coeff":s=function(e,t,r,n){e.uniform1f(t,r.small_glow_mask_coeff)},i=!0;break;case"u_glow_mask_large_coeff":s=function(e,t,r,n){e.uniform1f(t,r.large_glow_mask_coeff)},i=!0;break;case"u_brightness":s=function(e,t,r,n){e.uniform1f(t,r.brightness)};break;case"u_contrast":s=function(e,t,r,n){e.uniform1f(t,r.contrast)};break;case"u_exposure":s=function(e,t,r,n){e.uniform1f(t,r.exposure)};break;case"u_saturation":s=function(e,t,r,n){e.uniform1f(t,r.saturation)};break;case"u_enable_hmd_stereo":s=function(e,t,r,n){e.uniform1i(t,r.enable_hmd_stereo)};break;case"u_distortion_params":s=function(e,t,r,n){e.uniform4fv(t,r.distortion_params)};break;case"u_chromatic_aberration_coefs":s=function(e,t,r,n){e.uniform4fv(t,r.chromatic_aberration_coefs)};break;case"u_motion_blur_exp":s=function(e,t,r,n){e.uniform1f(t,r.motion_blur_exp)},i=!0;break;case"u_motion_blur_decay_threshold":s=function(e,t,r,n){e.uniform1f(t,r.mb_decay_threshold)},i=!0;break;case"u_model_tsr":l=function(e,t,r,n){e.uniformMatrix3fv(t,!1,r.world_tsr)},i=!0;break;case"u_model_tsr_inverse":l=function(e,t,r,n){e.uniformMatrix3fv(t,!1,r.world_tsr_inv)},i=!0;break;case"u_transb":l=function(e,t,r,n){e.uniform4fv(t,r.trans_before)},i=!0;break;case"u_transa":l=function(e,t,r,n){e.uniform4fv(t,r.trans_after)},i=!0;break;case"u_arm_rel_trans":l=function(e,t,r,n){e.uniform4fv(t,r.arm_rel_trans)},i=!0;break;case"u_arm_rel_quat":l=function(e,t,r,n){e.uniform4fv(t,r.arm_rel_quat)},i=!0;break;case"u_quat":l=function(e,t,r,n){e.uniform4fv(t,Vm(r.world_tsr,N))},i=!0;break;case"u_quatsb":l=function(e,t,r,n){e.uniform4fv(t,r.quats_before)},i=!0;break;case"u_quatsa":l=function(e,t,r,n){e.uniform4fv(t,r.quats_after)},i=!0;break;case"u_frame_factor":l=function(e,t,r,n){e.uniform1f(t,r.frame_factor)},i=!0;break;case"au_center_pos":l=function(e,t,r,n){e.uniform3fv(t,r.center_pos)},i=!0;break;case"au_wind_bending_amp":l=function(e,t,r,n){e.uniform1f(t,r.wind_bending_amp)},i=!0;break;case"au_wind_bending_freq":l=function(e,t,r,n){e.uniform1f(t,r.wind_bending_freq)},i=!0;break;case"au_detail_bending_freq":l=function(e,t,r,n){e.uniform1f(t,r.detail_bending_freq)},i=!0;break;case"au_detail_bending_amp":l=function(e,t,r,n){e.uniform1f(t,r.detail_bending_amp)},i=!0;break;case"au_branch_bending_amp":l=function(e,t,r,n){e.uniform1f(t,r.branch_bending_amp)},i=!0;break;case"u_node_values":l=function(e,t,r,n){e.uniform4fv(t,n.node_values)},i=!0;break;case"u_node_rgbs":l=function(e,t,r,n){e.uniform3fv(t,n.node_rgbs)},i=!0;break;case"u_lod_coverage":l=function(e,t,r,n){e.uniform1f(t,n.lod_settings.coverage)},i=!0;break;case"u_lod_cmp_logic":l=function(e,t,r,n){e.uniform1f(t,n.lod_settings.cmp_logic)},i=!0;break;case"u_diffuse_color":l=function(e,t,r,n){e.uniform4fv(t,n.diffuse_color)},i=!0;break;case"u_diffuse_intensity":l=function(e,t,r,n){e.uniform1f(t,n.diffuse_intensity)},i=!0;break;case"u_diffuse_params":l=function(e,t,r,n){e.uniform2fv(t,n.diffuse_params)},i=!0;break;case"u_emit":l=function(e,t,r,n){e.uniform1f(t,n.emit)},i=!0;break;case"u_ambient":l=function(e,t,r,n){e.uniform1f(t,n.ambient)},i=!0;break;case"u_specular_color":l=function(e,t,r,n){e.uniform3fv(t,n.specular_color)},i=!0;break;case"u_specular_alpha":l=function(e,t,r,n){e.uniform1f(t,n.specular_alpha)},i=!0;break;case"u_specular_params":l=function(e,t,r,n){e.uniform3fv(t,n.specular_params)},i=!0;break;case"u_reflect_factor":l=function(e,t,r,n){e.uniform1f(t,n.reflect_factor)},i=!0;break;case"u_mirror_factor":l=function(e,t,r,n){e.uniform1f(t,n.mirror_factor)},i=!0;break;case"u_grass_map_dim":l=function(e,t,r,n){e.uniform3fv(t,n.grass_map_dim)},i=!0;break;case"u_grass_size":l=function(e,t,r,n){e.uniform1f(t,n.grass_size)},i=!0;break;case"u_scale_threshold":l=function(e,t,r,n){e.uniform1f(t,n.grass_scale_threshold)},i=!0;break;case"u_cube_fog":l=function(e,t,r,n){e.uniformMatrix4fv(t,!1,n.cube_fog)};break;case"u_jitter_amp":l=function(e,t,r,n){e.uniform1f(t,n.jitter_amp)},i=!0;break;case"u_jitter_freq":l=function(e,t,r,n){e.uniform1f(t,n.jitter_freq)},i=!0;break;case"u_wireframe_edge_color":l=function(e,t,r,n){e.uniform3fv(t,n.wireframe_edge_color)};break;case"u_cluster_id":l=function(e,t,r,n){e.uniform1f(t,n.cluster_id)},i=!0;break;case"u_batch_debug_id_color":l=function(e,t,r,n){e.uniform1f(t,n.debug_id_color)},i=!0;break;case"u_batch_debug_main_render_time":l=function(e,t,r,n){e.uniform1f(t,n.debug_main_batch_render_time)},i=!0;break;case"u_refr_bump":l=function(e,t,r,n){e.uniform1f(t,n.refr_bump)},i=!0;break;case"u_line_width":l=function(e,t,r,n){e.uniform1f(t,n.line_width)},i=!0;break;case"u_lamp_light_positions":l=function(e,t,r,n){e.uniform3fv(t,n.lamp_light_positions)};break;case"u_lamp_light_directions":l=function(e,t,r,n){e.uniform3fv(t,n.lamp_light_directions)};break;case"u_lamp_light_color_intensities":l=function(e,t,r,n){e.uniform3fv(t,n.lamp_light_color_intensities)};break;case"u_halo_size":l=function(e,t,r,n){e.uniform1f(t,n.halo_size)},i=!0;break;case"u_halo_hardness":l=function(e,t,r,n){e.uniform1f(t,n.halo_hardness)},i=!0;break;case"u_halo_rings_color":l=function(e,t,r,n){e.uniform3fv(t,n.halo_rings_color)},i=!0;break;case"u_halo_lines_color":l=function(e,t,r,n){e.uniform3fv(t,n.halo_lines_color)},i=!0;break;case"u_halo_stars_blend":l=function(e,t,r,n){e.uniform1f(t,n.halo_stars_blend)},i=!0;break;case"u_halo_stars_height":l=function(e,t,r,n){e.uniform1f(t,n.halo_stars_height)},i=!0;break;case"u_fresnel_params":l=function(e,t,r,n){e.uniform2fv(t,n.fresnel_params)},i=!0;break;case"u_texture_scale":l=function(e,t,r,n){e.uniform3fv(t,n.texture_scale)},i=!0;break;case"u_parallax_scale":l=function(e,t,r,n){e.uniform1f(t,n.parallax_scale)},i=!0;break;case"u_color_id":l=function(e,t,r,n){e.uniform3fv(t,r.color_id)},i=!0;break;case"u_diffuse_color_factor":l=function(e,t,r,n){e.uniform1f(t,n.diffuse_color_factor)},i=!0;break;case"u_alpha_factor":l=function(e,t,r,n){e.uniform1f(t,n.alpha_factor)},i=!0;break;case"u_specular_color_factor":l=function(e,t,r,n){e.uniform1f(t,n.specular_color_factor)},i=!0;break;case"u_normal_factor":l=function(e,t,r,n){e.uniform1f(t,n.normal_factor)},i=!0;break;case"u_normalmap0_scale":l=function(e,t,r,n){e.uniform2fv(t,n.normalmap_scales[0])},i=!0;break;case"u_normalmap1_scale":l=function(e,t,r,n){e.uniform2fv(t,n.normalmap_scales[1])},i=!0;break;case"u_normalmap2_scale":l=function(e,t,r,n){e.uniform2fv(t,n.normalmap_scales[2])},i=!0;break;case"u_normalmap3_scale":l=function(e,t,r,n){e.uniform2fv(t,n.normalmap_scales[3])},i=!0;break;case"u_foam_factor":l=function(e,t,r,n){e.uniform1f(t,n.foam_factor)},i=!0;break;case"u_foam_uv_freq":l=function(e,t,r,n){e.uniform2fv(t,n.foam_uv_freq)},i=!0;break;case"u_foam_mag":l=function(e,t,r,n){e.uniform2fv(t,n.foam_mag)},i=!0;break;case"u_foam_scale":l=function(e,t,r,n){e.uniform2fv(t,n.foam_scale)},i=!0;break;case"u_water_norm_uv_velocity":l=function(e,t,r,n){e.uniform1f(t,n.water_norm_uv_velocity)},i=!0;break;case"u_shallow_water_col":l=function(e,t,r,n){e.uniform3fv(t,n.shallow_water_col)},i=!0;break;case"u_shore_water_col":l=function(e,t,r,n){e.uniform3fv(t,n.shore_water_col)},i=!0;break;case"u_water_shallow_col_fac":l=function(e,t,r,n){e.uniform1f(t,n.shallow_water_col_fac)},i=!0;break;case"u_water_shore_col_fac":l=function(e,t,r,n){e.uniform1f(t,n.shore_water_col_fac)},i=!0;break;case"u_p_length":l=function(e,t,r,n){e.uniform1f(t,n.particles_data.time_length)},i=!0;break;case"u_p_cyclic":l=function(e,t,r,n){e.uniform1i(t,n.particles_data.cyclic)},i=!0;break;case"u_p_max_lifetime":l=function(e,t,r,n){e.uniform1f(t,n.particles_data.lifetime)},i=!0;break;case"u_p_fade_in":l=function(e,t,r,n){e.uniform1f(t,n.particles_data.fade_in)},i=!0;break;case"u_p_fade_out":l=function(e,t,r,n){e.uniform1f(t,n.particles_data.fade_out)},i=!0;break;case"u_p_size":l=function(e,t,r,n){e.uniform1f(t,n.particles_data.size)},i=!0;break;case"u_p_alpha_start":l=function(e,t,r,n){e.uniform1f(t,n.particles_data.alpha_start)},i=!0;break;case"u_p_alpha_end":l=function(e,t,r,n){e.uniform1f(t,n.particles_data.alpha_end)},i=!0;break;case"u_p_nfactor":l=function(e,t,r,n){e.uniform1f(t,n.particles_data.nfactor)},i=!0;break;case"u_p_gravity":l=function(e,t,r,n){e.uniform1f(t,n.particles_data.gravity)},i=!0;break;case"u_p_mass":l=function(e,t,r,n){e.uniform1f(t,n.particles_data.mass)},i=!0;break;case"u_p_color_ramp":l=function(e,t,r,n){e.uniform4fv(t,n.particles_data.color_ramp)},i=!0;break;case"u_p_wind_fac":l=function(e,t,r,n){e.uniform1f(t,n.particles_data.wind_factor)},i=!0;break;case"u_p_time":l=function(e,t,r,n){e.uniform1f(t,n.particles_data.time)},i=!0;break;case"u_p_tilt":l=function(e,t,r,n){e.uniform1f(t,n.particles_data.tilt)},i=!0;break;case"u_p_tilt_rand":l=function(e,t,r,n){e.uniform1f(t,n.particles_data.tilt_rand)},i=!0;break;case"u_position":l=function(e,t,r,n){e.uniform3fv(t,n.anchor_positions)},i=!0;break;case"u_va_frame_factor":l=function(e,t,r,n){e.uniform1f(t,r.va_frame_factor)},i=!0;break;case"u_refl_plane":l=function(e,t,r,n){e.uniform4fv(t,r.reflection_plane)},i=!0;break;case"u_outline_intensity":l=function(e,t,r,n){e.uniform1f(t,r.outline_intensity)},i=!0;break;case"u_obj_info":l=function(e,t,r,n){e.uniform3fv(t,n.obj_info_params)},i=!0}if(l){var c={name:_,fun:l,loc:t[_]};i?r.push(c):n.push(c)}s&&(c={name:_,fun:s,loc:t[_]},i?a.push(c):o.push(c))}if(n.length||o.length){var E=e.permanent_uniform_setters_table;for(var u in E)delete E[u];for(u=0;u<n.length;u++)E[(c=n[u]).name]=c;for(u=0;u<o.length;u++)E[(c=o[u]).name]=c}else e.no_permanent_uniforms=!0}t.setup_context=function(e){var t=I.background_color;e.clearColor(t[0],t[1],t[2],t[3]),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.enable(e.CULL_FACE),e.frontFace(e.CCW),e.cullFace(e.BACK),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),P=e},t.draw=function(e){e.do_render&&!e.force_do_not_render&&(e.type==c.RESOLVE?(i.start_subs(e),function(e){var t=e.camera;P.bindFramebuffer(P.READ_FRAMEBUFFER,t.framebuffer_prev),P.bindFramebuffer(P.DRAW_FRAMEBUFFER,t.framebuffer);var r=0;t.color_attachment&&(r|=P.COLOR_BUFFER_BIT),t.depth_attachment&&(r|=P.DEPTH_BUFFER_BIT),P.blitFramebuffer(0,0,t.width,t.height,0,0,t.width,t.height,r,P.NEAREST)}(e),i.stop_subs(e),_.gl("draw resolve")):e.type==c.COPY?(i.start_subs(e),function(e){var t=e.camera;P.bindFramebuffer(P.FRAMEBUFFER,t.framebuffer_prev),P.bindTexture(P.TEXTURE_2D,t.color_attachment.w_texture),P.copyTexSubImage2D(P.TEXTURE_2D,0,0,0,0,0,t.width,t.height,0)}(e),i.stop_subs(e),_.gl("draw copy")):(i.start_subs(e),function(e){var t=e.camera;if(P.bindFramebuffer(P.FRAMEBUFFER,t.framebuffer),e.assign_texture){var r=t.color_attachment;P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,r.w_target,r.w_texture,0)}switch(P.viewport(0,0,t.width,t.height),e.type!=c.MAIN_CUBE_REFLECT&&e.type!=c.MAIN_CUBE_REFLECT_BLEND&&L(e),e.blend?P.enable(P.BLEND):P.disable(P.BLEND),e.depth_test?P.enable(P.DEPTH_TEST):P.disable(P.DEPTH_TEST),e.type){case c.SHADOW_CAST:P.enable(P.POLYGON_OFFSET_FILL),P.polygonOffset(e.self_shadow_polygon_offset,e.self_shadow_polygon_offset),P.cullFace(P.BACK);break;case c.MAIN_PLANE_REFLECT:case c.MAIN_PLANE_REFLECT_BLEND:P.disable(P.POLYGON_OFFSET_FILL),P.cullFace(P.FRONT);break;case c.DEBUG_VIEW:P.enable(P.POLYGON_OFFSET_FILL),P.polygonOffset(-4,-4),P.cullFace(P.BACK);break;case c.MAIN_GLOW:if(I.msaa_samples>1||I.safari_glow_hack){P.enable(P.POLYGON_OFFSET_FILL),P.polygonOffset(-2,-2);break}default:P.disable(P.POLYGON_OFFSET_FILL),P.cullFace(P.BACK)}}(e),e.type==c.MAIN_CUBE_REFLECT||e.type==c.MAIN_CUBE_REFLECT_BLEND?function(e){for(var t=e.camera,r=t.color_attachment.w_texture,a=0;a<6;a++){var o=C(a);t.view_matrix=e.cube_view_matrices[a],eg(t.view_matrix,t.view_tsr),n.calc_sky_vp_inverse(t),P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,o,r,0),L(e);for(var _=e.draw_data,i=0;i<_.length;i++)for(var s=0;s<_[i].bundles.length;s++){var l=_[i].bundles[s];l.do_render=l.do_render_cube[a]}b(e)}}(e):b(e),i.stop_subs(e),_.gl("draw subscene: "+c.subs_label(e)),e.type==c.BRDF&&P.bindFramebuffer(P.FRAMEBUFFER,null)))},t.clear=function(e){if(e)P.bindFramebuffer(P.FRAMEBUFFER,e.camera.framebuffer);else{var t=I.background_color;if(t[0]===f[0]&&t[1]===f[1]&&t[2]===f[2]&&t[3]===f[3])return}L(e)},t.assign_attribute_setters=function(e){var t=e.attribute_setters;t.length=0;var r=e.bufs_data,n=r.pointers,a=e.shader.attributes;for(var _ in a){var i=n[_],s=l.get_vbo_type_by_attr_name(_),c=l.get_gl_type_by_attr_name(_),E=l.get_type_size_by_attr_name(_);t.push({vbo_type:s,gl_type:c,loc:a[_],base_offset:i.offset*E,frame_length:i.frames>1?i.length*E:0,num_comp:i.num_comp,divisor:i.divisor})}for(var _ in n){s=l.get_vbo_type_by_attr_name(_);var u=l.search_vbo_index_by_type(r.vbo_data,s),d=r.vbo_data[u],T=e.shaders_info.vert+" | "+e.shaders_info.frag,f=n[_].length*n[_].frames*l.get_type_size_by_attr_name(_);o.fill_vbo_garbage_info(d.debug_id,T,_,f,_ in a)}I.allow_vao_ext&&w(e)},t.assign_vao=w,t.cleanup_vao=function(e){for(var t=s.get_vertex_array_object(),r=0;r<e.vaos.length;r++)t.deleteVertexArray(e.vaos[r]);e.vaos.length=0},t.clone_attribute_setters=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push({vbo_type:n.vbo_type,gl_type:n.gl_type,loc:n.loc,base_offset:n.base_offset,frame_length:n.frame_length,num_comp:n.num_comp,divisor:n.divisor})}return t},t.assign_uniform_setters=U,t.assign_texture_uniforms=function(e){var t=e.shader,r=e.textures,n=e.texture_names;P.useProgram(t.program);for(var a=0;a<r.length;a++)P.uniform1i(t.uniforms[n[a]],a)},t.read_pixels=function(e,t,r,n,a,o){return P.bindFramebuffer(P.FRAMEBUFFER,e),P.readPixels(t,r,n,a,P.RGBA,P.UNSIGNED_BYTE,o),P.bindFramebuffer(P.FRAMEBUFFER,null),o},t.update_batch_permanent_uniform=function(e,t){var r=e.shader;if(!r.no_permanent_uniforms){P.useProgram(r.program),r.permanent_uniform_setters.length||U(r);var n=r.permanent_uniform_setters_table[t];n.fun(P,n.loc,null,e)}},t.render_target_create=function(e,t){var r=P.createFramebuffer();if(P.bindFramebuffer(P.FRAMEBUFFER,r),E.is_renderbuffer(e)?P.framebufferRenderbuffer(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.RENDERBUFFER,e.w_renderbuffer):E.is_texture(e)&&P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,(n=e).w_target==P.TEXTURE_CUBE_MAP?P.TEXTURE_CUBE_MAP_NEGATIVE_Z:n.w_target,n.w_texture,0),E.is_renderbuffer(t))P.framebufferRenderbuffer(P.FRAMEBUFFER,P.DEPTH_ATTACHMENT,P.RENDERBUFFER,t.w_renderbuffer);else if(E.is_texture(t)){var n;P.framebufferTexture2D(P.FRAMEBUFFER,P.DEPTH_ATTACHMENT,(n=t).w_target,n.w_texture,0)}return _.bound_fb(),P.bindFramebuffer(P.FRAMEBUFFER,null),r},t.render_target_cleanup=function(e,t,r,n,a){if(null==e)return P.bindFramebuffer(P.FRAMEBUFFER,e),P.viewport(0,0,n,a),void P.clear(P.COLOR_BUFFER_BIT|P.DEPTH_BUFFER_BIT);E.is_renderbuffer(t)?P.deleteRenderbuffer(t.w_renderbuffer):E.is_texture(t)&&P.deleteTexture(t.w_texture),E.is_renderbuffer(r)?P.deleteRenderbuffer(r.w_renderbuffer):E.is_texture(r)&&P.deleteTexture(r.w_texture),P.deleteFramebuffer(e)},t.increment_subpixel_index=function(){S=(S+1)%2},t.draw_resized_cubemap_texture=function(e,t,n,a,o,_){var i=e.w_texture;P.viewport(0,0,n,n),P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,t,i,0);var s=r.create_postprocessing_batch("FLIP_CUBEMAP_COORDS"),l=s.shader;P.activeTexture(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,o);var c=0,E=0;n!=a&&(c=1/(6*a),E=1/(4*a)),P.uniform1i(l.uniforms.u_tex_number,_),P.uniform2fv(l.uniforms.u_delta,[c,E]),P.useProgram(l.program),g(s,0),P.bindTexture(P.TEXTURE_2D,null)},t.draw_resized_texture=function(e,t,n,a,o,_){P.bindFramebuffer(P.FRAMEBUFFER,a);var i=e.w_texture,s=e.w_target;P.bindTexture(s,i),P.viewport(0,0,t,n),P.texImage2D(s,0,P.RGBA,t,n,0,P.RGBA,P.UNSIGNED_BYTE,null),P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,s,i,0);var l=r.create_postprocessing_batch(_),c=l.shader;P.activeTexture(P.TEXTURE0),P.bindTexture(s,o),P.useProgram(c.program),g(l,0),P.bindFramebuffer(P.FRAMEBUFFER,null),P.bindTexture(s,null)},t.cleanup=function(){S=0},t.set_draw_methods=function(){var e=s.get_instanced_arrays(),t=s.get_vertex_array_object();I.allow_instanced_arrays_ext=!!e,I.allow_vao_ext=!!t,e?(A=function(t,r,n,a){e.drawElementsInstanced(P.TRIANGLES,t,r,n,a)},h=function(t,r){e.vertexAttribDivisor(t,r)},v=function(t,r,n){e.drawArraysInstanced(P.TRIANGLES,t,r,n)}):(A=function(e,t,r){P.drawElements(P.TRIANGLES,e,t,r)},h=function(e,t){},v=function(e,t,r){P.drawArrays(P.TRIANGLES,e,t)}),t?(m=function(e){t.bindVertexArray(e)},g=function(e,t){var r=e.bufs_data;m(e.vaos[t]),r.ibo?A(r.count,r.ibo_type,0,r.instance_count):v(0,r.count,r.instance_count),m(null)}):g=function(e,t){for(var r=e.bufs_data,n=e.attribute_setters,a=0;a<r.vbo_data.length;a++){P.bindBuffer(P.ARRAY_BUFFER,r.vbo_data[a].vbo);for(var o=0;o<n.length;o++)(_=n[o]).vbo_type==r.vbo_data[a].type&&(P.enableVertexAttribArray(_.loc),P.vertexAttribPointer(_.loc,_.num_comp,_.gl_type,_.gl_type!=P.FLOAT,0,_.base_offset+_.frame_length*t),h(_.loc,_.divisor))}for(r.ibo?(P.bindBuffer(P.ELEMENT_ARRAY_BUFFER,r.ibo),A(r.count,r.ibo_type,0,r.instance_count)):v(0,r.count,r.instance_count),a=0;a<n.length;a++){var _;P.disableVertexAttribArray((_=n[a]).loc)}}},t.reset=function(){P=null,A=null,h=null,v=null,m=null}})),rI=wm(),nI=wm(),aI=new Float32Array(4),oI=new Float32Array(4),_I=new Float32Array(4);function iI(e,t,r,n,a){var o=e.render,_=o.frame_factor,i=o.bone_pointers[t],s=i.bone_index,l=i.tsr_local_rest,c=aI,E=o.trans_before,u=o.trans_after,d=o.quats_before,T=o.quats_after,f=E[4*s+1],p=E[4*s+2],P=E[4*s+3],S=u[4*s+1],A=u[4*s+2],h=u[4*s+3];c[0]=(1-_)*E[4*s]+_*u[4*s],c[1]=(1-_)*f+_*S,c[2]=(1-_)*p+_*A,c[3]=(1-_)*P+_*h;var v=oI,m=_I;v[0]=d[4*s],v[1]=d[4*s+1],v[2]=d[4*s+2],v[3]=d[4*s+3],m[0]=T[4*s],m[1]=T[4*s+1],m[2]=T[4*s+2],m[3]=T[4*s+3],Im(v,m,_,v);var g=rI;if(Xm(c,g),Hm(v,g),r){var O=nI;cg(l,i.tail,O),tg(g,O,g)}else tg(g,l,g);if(n){var N=i.parent_bone_ptr;if(N){var R=nI;Zm(N.tsr_local_pose,R),tg(R,g,g)}var I=nI;Zm(i.tsr_bone_rest,I),tg(I,g,g)}Dm(g,a)}function sI(e,t,r,n){var a=e.render,o=a.bone_pointers[t],_=a.trans_before,i=a.quats_before;n?tg(o.tsr_bone_rest,r,o.tsr_bone_pose):Dm(r,o.tsr_local_pose),cI(o,n,_,i),a.frame_factor=0,lI(e)}function lI(e){for(var t=e.render,r=t.skinned_renders,n=t.mesh_to_arm_bone_maps,a=0;a<r.length;a++){for(var o=r[a],_=n[a],i=0;i<_.length;i+=2)for(var s=_[i],l=_[i+1],c=0;c<4;c++)o.quats_before[s+c]=t.quats_before[l+c],o.quats_after[s+c]=t.quats_after[l+c],o.trans_before[s+c]=t.trans_before[l+c],o.trans_after[s+c]=t.trans_after[l+c];o.frame_factor=t.frame_factor}}var cI=function(){var e=dm(),t=wm(),r=wm(),n=Fv();return function a(o,_,i,s){var l=o.tsr_bone_pose,c=o.tsr_local_rest,E=o.tsr_local_pose,u=o.parent_bone_ptr;if(u){var d=u.tsr_local_pose;if(_)tg(d,l,E);else{var T=r;Zm(d,T),tg(T,E,l)}}else _?Dm(l,E):Dm(E,l);var f=t;Zm(c,f),tg(E,f,f);var p=o.bone_index;Qm(f,n),i[4*p]=n[0],i[4*p+1]=n[1],i[4*p+2]=n[2],i[4*p+3]=n[3],Vm(f,e),s[4*p]=e[0],s[4*p+1]=e[1],s[4*p+2]=e[2],s[4*p+3]=e[3];for(var P=o.descend_bones_ptrs,S=0;S<P.length;S++){var A=P[S];A.constraint||a(A,!0,i,s)}}}();function EI(e,t){return t in e.render.bone_pointers}new Float32Array(3);var uI=function(){var e=dm(),t=ih();return function(r,n){var a=r.data,o=n.light=function(e){var t={name:"",type:e,use_diffuse:!1,use_specular:!1,prev_direction:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),color_intensity:new Float32Array(3),energy:0,default_energy:0,distance:0,use_sphere:!1,spot_size:0,spot_blend:0,clip_start:.1,clip_end:30,falloff_type:"",generate_shadows:!1,need_sun_fog_update:!1,dynamic_intensity:!1};return t.use_diffuse=!0,t.use_specular=!0,t.energy=1,t.distance=25,t.falloff_type="INVERSE_SQUARE",t}(a.type);o.name=n.name,o.use_diffuse=a.use_diffuse,o.use_specular=a.use_specular;var _=_O(Vm(n.render.world_tsr,e),Ug,t);Rh(_,_),o.direction.set(_),o.color[0]=a.color[0],o.color[1]=a.color[1],o.color[2]=a.color[2],o.energy=o.default_energy=a.energy,fI(o),o.distance=a.distance,o.use_sphere=a.use_sphere,o.clip_start=a.clip_start,o.clip_end=a.clip_end,"POINT"!==o.type&&"SPOT"!==o.type||(o.distance=a.distance),"SPOT"===o.type?(o.spot_blend=a.spot_blend,o.spot_size=a.spot_size):"POINT"===o.type&&(o.spot_size=Math.PI/2),o.generate_shadows=a.b4w_generate_shadows,o.dynamic_intensity=a.b4w_dynamic_intensity}}();function dI(e,t){e.color[0]=t[0],e.color[1]=t[1],e.color[2]=t[2],fI(e)}function TI(e,t){e.energy=t,fI(e)}function fI(e){Sh(e.color,e.energy,e.color_intensity)}var pI=function(){var e=dm();return function(t){var r=t.light;if(r){if(_O(Vm(t.render.world_tsr,e),Ug,r.direction),Rh(r.direction,r.direction),"SUN"==r.type){var n=Math.acos(Ih(r.prev_direction,xg)),a=Math.acos(Ih(r.direction,xg)),o=Math.floor(n/.025),_=Math.floor(a/.025);r.need_sun_fog_update=o!=_}ch(r.direction,r.prev_direction)}}}(),PI=nA("__obj_util",(function(e,t){var r=dR(e).defaults;function n(e){var t={type:e,data_id:0,world_tsr:km(),world_tsr_inv:km(),pivot:new Float32Array(3),hover_pivot:new Float32Array(3),init_dist:0,init_fov:0,is_copied:!1,is_copied_deep:!1,color_id:null,outline_intensity:0,target_cam_upside_down:!1,vertical_axis:ih(),use_panning:!1,move_style:0,velocity_trans:1,velocity_rot:1,velocity_zoom:1,dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_bokeh:!1,dof_foreground_blur:!1,dof_object:null,horizontal_limits:null,vertical_limits:null,distance_limits:null,hover_vert_trans_limits:null,hover_horiz_trans_limits:null,pivot_limits:null,enable_hover_hor_rotation:!0,outline_anim_settings_default:{outline_duration:1,outline_period:1,outline_relapses:0},cube_reflection_id:-1,plane_reflection_id:-1,reflection_plane:new Float32Array(4),friction:0,elasticity:0,is_lod:!1,lod_center:new Float32Array(3),main_lod_offset:new Float32Array(3),lod_dist_min:0,lod_dist_max:1/0,lod_lower_border_range:0,lod_upper_border_range:0,do_not_render:!1,shadow_cast:!1,shadow_receive:!1,shadow_cast_only:!1,reflexible:!1,reflexible_only:!1,reflective:!1,reflection_type:"",wind_bending:!1,dynamic_geometry:!1,dynamic_grass:!1,hide:!1,hide_children:!1,selectable:!1,origin_selectable:!1,outlining:!1,origin_outlining:!1,outline_on_select:!1,is_hair_particles:!1,is_visible:!1,force_zsort:!1,wind_bending_angle:0,wind_bending_amp:0,wind_bending_freq:0,detail_bending_freq:0,detail_bending_amp:0,branch_bending_amp:0,main_bend_col:"",detail_bend_col:{leaves_stiffness:"",leaves_phase:"",overall_stiffness:""},bend_center_only:!1,center_pos:new Float32Array(3),billboard:!1,billboard_pres_glob_orientation:!1,billboard_type:"",billboard_spherical:!1,frame_factor:0,va_frame:0,va_frame_factor:0,max_bones:0,frames_blending:!1,vertex_anim:!1,use_shape_keys:!1,shape_keys_values:[],is_skinning:!1,anim_mixing:!1,anim_mix_factor:1,anim_mix_factor_change_speed:0,anim_destination_mix_factor:1,anim_mix_cb:null,mix_with_current:!1,blend_skel_slots:new Int8Array([-1,-1]),skinned_renders:[],mesh_to_arm_bone_maps:[],skinning_data_cache:[],quats_before:null,quats_after:null,trans_before:null,trans_after:null,trans_curr:null,quats_curr:null,bone_pointers:null,bone_skinning_info:null,pose_data:null,arm_rel_trans:null,arm_rel_quat:null,bb_original:{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0},bb_local:{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0},bb_world:{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0},bs_local:zN(),bs_world:zN(),be_local:VN(),be_world:VN(),bbr_local:wN(),bbr_world:wN(),bcyl_local:rR(),bcap_local:rR(),bcon_local:rR(),pass_index:0};return ch(Ug,t.vertical_axis),t}function a(e){return{scene:e,is_active:!1,batches:[],batch_world_bounds:[],plane_refl_subs:[],cube_refl_subs:null,shadow_subscenes:[],light_index:0,obj_has_nla_on_scene:!1,cameras:[],shadow_cameras:[]}}function o(e){return e.is_dynamic}function _(e,t){CN(t,e.bb_local),GN(e.bb_local,e.world_tsr,e.bb_world)}function i(e,t,r){e.bs_local=jN(t,r),BN(e.bs_local,e.world_tsr,e.bs_world)}function s(e,t,r,n,a,o){e.be_local=WN(t,r,n,o),Sh(e.be_local.axis_x,a[0],e.be_local.axis_x),Sh(e.be_local.axis_y,a[1],e.be_local.axis_y),Sh(e.be_local.axis_z,a[2],e.be_local.axis_z),XN(e.be_local,e.world_tsr,e.be_world)}function l(e,t,r,n){e.bcyl_local=aR(t,n),e.bcap_local=nR(r,n),e.bcon_local=oR(t,n)}function c(e,t,r,n,a,o){var _,i,s,l,c;e.bbr_local=(_=t,i=r,s=n,l=a,ch(o,(c=wN()).center),ch(_,c.axis_x),ch(i,c.axis_y),ch(s,c.axis_z),Sh(c.axis_x,l[0],c.axis_x),Sh(c.axis_y,l[1],c.axis_y),Sh(c.axis_z,l[2],c.axis_z),c),HN(e.bbr_local,e.world_tsr,e.bbr_world)}function E(e,t,r){GN(e.bounds_local.bb,t,r.bb),e.use_be&&XN(e.bounds_local.be,t,r.be),BN(e.bounds_local.bs,t,r.bs)}function u(e,t){for(var r=e.scenes_data,n=0;n<r.length;n++){var a=r[n];if(a.scene==t)return a}return null}function d(e){return e.parent_is_dupli?e.parent:e.parent?d(e.parent):null}t.LOD_DIST_MAX_INFINITY=1/0,t.create_render=n,t.clone_render=function(e){var t=n(e.type);return t.data_id=e.data_id,Dm(e.world_tsr,t.world_tsr),Dm(e.world_tsr_inv,t.world_tsr_inv),ch(e.pivot,t.pivot),ch(e.hover_pivot,t.hover_pivot),t.init_dist=e.init_dist,t.init_fov=e.init_fov,t.is_copied=e.is_copied,t.is_copied_deep=e.is_copied_deep,e.color_id&&(t.color_id=sh(e.color_id)),t.outline_intensity=e.outline_intensity,t.target_cam_upside_down=e.target_cam_upside_down,ch(e.vertical_axis,t.vertical_axis),t.use_panning=e.use_panning,t.move_style=e.move_style,t.velocity_trans=e.velocity_trans,t.velocity_rot=e.velocity_rot,t.velocity_zoom=e.velocity_zoom,t.dof_distance=e.dof_distance,t.dof_front_start=e.dof_front_start,t.dof_front_end=e.dof_front_end,t.dof_rear_start=e.dof_rear_start,t.dof_rear_end=e.dof_rear_end,t.dof_power=e.dof_power,t.dof_bokeh_intensity=e.dof_bokeh_intensity,t.dof_bokeh=e.dof_bokeh,t.dof_foreground_blur=e.dof_foreground_blur,t.dof_object=e.dof_object,t.horizontal_limits=lO(e.horizontal_limits),t.vertical_limits=lO(e.vertical_limits),t.distance_limits=lO(e.distance_limits),t.hover_vert_trans_limits=lO(e.hover_vert_trans_limits),t.hover_horiz_trans_limits=lO(e.hover_horiz_trans_limits),t.pivot_limits=e.pivot_limits,t.enable_hover_hor_rotation=e.enable_hover_hor_rotation,t.outline_anim_settings_default.outline_duration=e.outline_anim_settings_default.outline_duration,t.outline_anim_settings_default.outline_period=e.outline_anim_settings_default.outline_period,t.outline_anim_settings_default.outline_relapses=e.outline_anim_settings_default.outline_relapses,t.cube_reflection_id=e.cube_reflection_id,t.plane_reflection_id=e.plane_reflection_id,t.reflection_plane=e.reflection_plane,t.friction=e.friction,t.elasticity=e.elasticity,t.is_lod=e.is_lod,ch(e.lod_center,t.lod_center),ch(e.main_lod_offset,t.main_lod_offset),t.lod_dist_min=e.lod_dist_min,t.lod_dist_max=e.lod_dist_max,t.lod_lower_border_range=e.lod_lower_border_range,t.lod_upper_border_range=e.lod_upper_border_range,t.do_not_render=e.do_not_render,t.shadow_cast=e.shadow_cast,t.shadow_receive=e.shadow_receive,t.shadow_cast_only=e.shadow_cast_only,t.reflexible=e.reflexible,t.reflexible_only=e.reflexible_only,t.reflective=e.reflective,t.reflection_type=e.reflection_type,t.wind_bending=e.wind_bending,t.dynamic_geometry=e.dynamic_geometry,t.dynamic_grass=e.dynamic_grass,t.hide=e.hide,t.selectable=e.selectable,t.origin_selectable=e.origin_selectable,t.outlining=e.outlining,t.origin_outlining=e.origin_outlining,t.outline_on_select=e.outline_on_select,t.is_hair_particles=e.is_hair_particles,t.is_visible=e.is_visible,t.force_zsort=e.force_zsort,t.wind_bending_angle=e.wind_bending_angle,t.wind_bending_amp=e.wind_bending_amp,t.wind_bending_freq=e.wind_bending_freq,t.detail_bending_freq=e.detail_bending_freq,t.detail_bending_amp=e.detail_bending_amp,t.branch_bending_amp=e.branch_bending_amp,t.main_bend_col=e.main_bend_col,t.detail_bend_col=e.detail_bend_col,t.bend_center_only=e.bend_center_only,ch(e.center_pos,t.center_pos),t.billboard=e.billboard,t.billboard_pres_glob_orientation=e.billboard_pres_glob_orientation,t.billboard_type=e.billboard_type,t.billboard_spherical=e.billboard_spherical,t.frame_factor=e.frame_factor,t.va_frame=e.va_frame,t.va_frame_factor=e.va_frame_factor,t.max_bones=e.max_bones,t.frames_blending=e.frames_blending,t.vertex_anim=e.vertex_anim,t.use_shape_keys=e.use_shape_keys,t.shape_keys_values=lO(e.shape_keys_values),t.is_skinning=e.is_skinning,t.anim_mixing=e.anim_mixing,t.anim_mix_factor=e.anim_mix_factor,t.anim_mix_factor_change_speed=e.anim_mix_factor_change_speed,t.anim_destination_mix_factor=e.anim_destination_mix_factor,t.blend_skel_slots.set(e.blend_skel_slots),t.skinned_renders=lO(e.skinned_renders),t.mesh_to_arm_bone_maps=lO(e.mesh_to_arm_bone_maps),t.skinning_data_cache=lO(e.skinning_data_cache),t.quats_before=lO(e.quats_before),t.quats_after=lO(e.quats_after),t.trans_before=lO(e.trans_before),t.trans_after=lO(e.trans_after),t.bone_pointers=lO(e.bone_pointers),t.bone_skinning_info=lO(e.bone_skinning_info),t.pose_data=lO(e.pose_data),t.arm_rel_trans=lO(e.arm_rel_trans),t.arm_rel_quat=lO(e.arm_rel_quat),CN(e.bb_original,t.bb_original),CN(e.bb_local,t.bb_local),CN(e.bb_world,t.bb_world),QN(e.bs_local,t.bs_local),QN(e.bs_world,t.bs_world),qN(e.be_local,t.be_local),qN(e.be_world,t.be_world),_R(e.bcap_local,t.bcap_local),_R(e.bcyl_local,t.bcyl_local),_R(e.bcon_local,t.bcon_local),t.pass_index=e.pass_index,t},t.create_object=function(e,t,r){return r||(r=e),{name:e,uuid:HO(),origin_name:r,type:t,materials:[],is_meta:!0,_bpy_obj:null,mat_inheritance_data:{original_mat_names:[],is_disabled:[]},is_dynamic:!1,is_hair_dupli:!1,use_default_animation:!1,is_boundings_overridden:!1,render:null,constraint:null,sfx:null,light:null,armobj:null,anchor:null,field:null,metatags:null,custom_prop:null,scenes_data:[],vertex_anim:[],cons_descends:EN(),cons_armat_bone_descends:EN(),anim_slots:[],reflective_objs:[],nla_events:[],action_anim_cache:[],sensor_manifolds:null,sensor_manifolds_arr:[],parent:null,parent_is_dupli:!1,parent_bone:"",viewport_alignment:null,pinverse_tsr:null,use_obj_physics:!1,collision_id:"",correct_bounding_offset:"AUTO",is_vehicle:!1,is_character:!1,is_floating:!1,bob_synchronize_pos:!1,physics:null,vehicle:null,floater:null,vehicle_settings:null,floating_settings:null,character_settings:null,physics_constraints:[],physics_settings:{physics_type:"NO_COLLISION",use_ghost:!1,use_sleep:!1,mass:0,velocity_min:0,velocity_max:0,damping:0,rotation_damping:0,lock_location_x:!1,lock_location_y:!1,lock_location_z:!1,lock_rotation_x:!1,lock_rotation_y:!1,lock_rotation_z:!1,collision_margin:0,collision_group:0,collision_mask:0,use_collision_bounds:!1,collision_bounds_type:"BOX",use_collision_compound:!1},outline_animation:{time_start:0,outline_time:0,period:0,relapses:0},anim_behavior_def:0,def_action_slots:[],need_update_transform:!1,need_inv_zup_tsr:!1,meta_objects:[]}},t.init_scene_data=a,t.copy_bpy_object_props_by_link=function(e){return e instanceof Array?e.slice():e},t.copy_object_props_by_value=function e(t){if(!(t instanceof Object))return t;var r,n=null,a=null,o=null,_=null,i=null,s=null;t.textures&&(n=t.textures,t.textures=null),t.texture_names&&(a=t.texture_names,t.texture_names=null),t.bpy_tex_names&&(o=t.bpy_tex_names,t.bpy_tex_names=null),t.shape_keys&&(_=t.shape_keys,t.shape_keys=null),t.shader&&(i=t.shader,t.shader=null),t.vaos&&(s=t.vaos,t.vaos=null);var l=t.constructor;switch(l){case Int8Array:case Uint8Array:case Uint8ClampedArray:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:r=new l(t);break;case Array:r=new l(t.length);for(var c=0;c<t.length;c++)r[c]=e(t[c]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:r=t;break;case WebGLFramebuffer:case WebGLRenderbuffer:case WebGLTexture:case WebGLBuffer:r=null;break;case Function:r=t;break;default:for(var E in r=new l,t)r[E]=e(t[E])}return n&&(r.textures=n,t.textures=n),a&&(r.texture_names=a,t.texture_names=a),o&&(r.bpy_tex_names=o,t.bpy_tex_names=o),_&&(r.shape_keys=_,t.shape_keys=_),i&&(r.shader=i,t.shader=i),s&&(r.vaos=EN(),t.vaos=s),r},t.is_dynamic=o,t.is_dynamic_mesh=function(e){return"MESH"==e.type&&e.is_dynamic},t.append_scene_data=function(e,t){var r=a(t);e.scenes_data.push(r)},t.append_batch=function(e,t,r){var n=e.render,a=u(e,t);a.batches.push(r);var o=MN();E(r,n.world_tsr,o),a.batch_world_bounds.push(o)},t.update_render_bounds_billboard=function(e,t){var r=e.render,n=Math.max(Math.abs(t.max_x),Math.abs(t.min_x)),a=Math.max(Math.abs(t.max_y),Math.abs(t.min_y)),E=Math.max(Math.abs(t.max_z),Math.abs(t.min_z)),u=Math.sqrt(n*n+a*a+E*E),d=Math.sqrt(n*n+a*a),T={max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0};T.max_x=T.max_y=T.max_z=u,T.min_x=T.min_y=T.min_z=-u,_(r,T),i(r,u,[0,0,0]),s(r,[1,0,0],[0,1,0],[0,0,1],[u,u,u],[0,0,0]),o(e)?l(r,d,d,T):c(r,[1,0,0],[0,1,0],[0,0,1],[u,u,u],[0,0,0])},t.update_render_bounds_from_bpy=function(e,t,r){var n=e.render,a=r.bs_rad,E=r.bc_rad,u=r.bs_cen,d=r.be_cen,T=r.caxis_x,f=r.caxis_y,p=r.caxis_z,P=r.be_ax,S=r.rbb.rbb_c,A=r.rbb.rbb_s;_(n,t),i(n,a,u);var h=o(e);s(n,h?T:[1,0,0],h?f:[0,1,0],h?p:[0,0,1],P,d),o(e)?l(n,E,E,n.bb_local):c(n,T,f,p,A,S)},t.update_render_bounds_from_pos_arrays=function(e,t,r){for(var n=e.render,a=t.max_x-t.min_x,E=t.max_y-t.min_y,u=t.max_z-t.min_z,d=(t.max_x+t.min_x)/2,T=(t.max_y+t.min_y)/2,f=(t.max_z+t.min_z)/2,p=d,P=T,S=Math.max(a,Math.max(E,u))/2,A=Math.max(a,E)/2,h=[d/(a||1),T/(E||1),f/(u||1)],v=.5,m=0;m<r.length;m++)for(var g=r[m],O=0;O<g.length;O+=3){var N=g[O],R=g[O+1],I=g[O+2],b=Math.sqrt((d-N)*(d-N)+(T-R)*(T-R)+(f-I)*(f-I));b>S&&(d=(d-S*(N-d)/b+N)/2,T=((Y=T-S*(R-T)/b)+R)/2,f=((M=f-S*(I-f)/b)+I)/2,S=Math.sqrt((d-N)*(d-N)+(T-R)*(T-R)+(f-I)*(f-I)));var y=Math.sqrt((p-N)*(p-N)+(P-R)*(P-R));y>A&&(p=(p-A*(N-p)/y+N)/2,P=((Y=P-A*(R-P)/y)+R)/2,A=Math.sqrt((p-N)*(p-N)+(P-R)*(P-R))),N/=a||1,R/=E||1,I/=u||1;var L=Math.sqrt((h[0]-N)*(h[0]-N)+(h[1]-R)*(h[1]-R)+(h[2]-I)*(h[2]-I));if(L>v){var Y=h[1]-v*(R-h[1])/L,M=h[2]-v*(I-h[2])/L;h[0]=(h[0]-v*(N-h[0])/L+N)/2,h[1]=(Y+R)/2,h[2]=(M+I)/2,v=Math.sqrt((h[0]-N)*(h[0]-N)+(h[1]-R)*(h[1]-R)+(h[2]-I)*(h[2]-I))}}var x=a?a*h[0]:t.max_x,C=E?E*h[1]:t.max_y,w=u?u*h[2]:t.max_z,U=v*a,k=v*E,D=v*u;_(n,t),i(n,S,[d,T,f]),s(n,[1,0,0],[0,1,0],[0,0,1],[U,k,D],[x,C,w]),o(e)?l(n,A,A,n.bb_local):c(n,[(n.bb_local.max_x-n.bb_local.min_x)/2,0,0],[0,(n.bb_local.max_y-n.bb_local.min_y)/2,0],[0,0,(n.bb_local.max_z-n.bb_local.min_z)/2],[1,1,1],[(n.bb_local.max_x+n.bb_local.min_x)/2,(n.bb_local.max_y+n.bb_local.min_y)/2,(n.bb_local.max_z+n.bb_local.min_z)/2])},t.update_world_bounds_from_batch_tsr=E,t.remove_scene_data=function(e,t){for(var r=e.scenes_data,n=0;n<r.length;n++)if(r[n].scene==t){r.splice(n,1);break}},t.get_scene_data=u,t.update_refl_objects=function(e,t){for(var r=0;r<e.length;r++)Bv(t,e[r].render.reflection_plane)},t.scene_data_set_active=function(e,t,r){for(var n=0;n<e.scenes_data.length;n++){var a=e.scenes_data[n];r&&a.scene!=r||(a.is_active=t)}},t.scene_data_remove_batch=function(e,t){e.batches.splice(t,1),e.batch_world_bounds.splice(t,1)},t.get_shadow_lamps=function(e,t){for(var n=[],a=t?r.max_cast_lamps-1:r.max_cast_lamps,o=0;o<e.length;o++){var _=e[o];_.light.generate_shadows&&n.length<a&&n.push(_)}return n.length?n:e[0]?[e[0]]:[]},t.meta_obj_append_render=function(e,t){Fm(t.world_tsr),t.color_id=null,e.render=t},t.check_obj_soft_particles_accessibility=function(e,t){if(t.b4w_enable_soft_particles&&t.b4w_particles_softness>0){var r=t.material-1,n=e.materials;if(r>=0&&r<n.length&&("ADD"==n[r].blend_mode||"ALPHA"==n[r].blend_mode||"ALPHA_SORT"==n[r].blend_mode))return!0}return!1},t.check_inv_zup_tsr_is_needed=function(e){for(var t=e.scenes_data,r=0;r<t.length;r++)for(var n=t[r].batches,a=0;a<n.length;a++)for(var o=n[a].shaders_info.directives,_=0;_<o.length;_++){var i=o[_];if("USE_MODEL_TSR_INVERSE"==i[0]&&"1"==i[1])return!0}return!1},t.gen_dupli_name=function(e,t){return e+"*"+t},t.get_parent=function(e){return e.parent_is_dupli?null:e.parent},t.get_dg_parent=d,t.get_dg_objects=function(e,t){for(var r=[],n=0;n<t.length;n++){var a=t[n];d(a)==e&&r.push(a)}return r},t.get_object_data_id=function(e){return e.render.data_id},t.is_mesh=function(e){return"MESH"===e.type},t.is_armature=function(e){return"ARMATURE"===e.type},t.is_speaker=function(e){return"SPEAKER"===e.type},t.is_camera=function(e){return"CAMERA"===e.type},t.is_lamp=function(e){return"LAMP"===e.type},t.is_empty=function(e){return"EMPTY"===e.type},t.is_line=function(e){return"LINE"===e.type},t.is_world=function(e){return"WORLD"===e.type}})),SI=nA("__particles",(function(e,t){var r=gN(e),n=dR(e),a=JI(e),o=TR(e),_=VR(e),i=XI(e),s=AR(e),l=n.defaults,c=DR(),E=wm(),u=new Float32Array(3),d=[];function T(e,t){return{name:e,p_type:t,time:0,prev_time:-1,use_world_space:!1,count_factor:1,frame_start:0,frame_end:0,time_length:0,lifetime_frames:0,lifetime:0,cyclic:0,mass:0,nfactor:0,gravity:0,fade_in:0,fade_out:0,wind_factor:0,size:0,alpha_start:0,alpha_end:0,color_ramp_length:0,color_ramp:new Float32Array(16),need_buffers_update:!1,positions:null,positions_cache:null,tbn:null,tbn_cache:null,delay_attrs:null,delay_attrs_masked:null,emitter_tsr_snapshots:null,p_data:null,tilt:0,tilt_rand:0}}t.clone_particles_data=function(e){var t=T(e.name,e.type);return t.time=e.time,t.prev_time=e.prev_time,t.use_world_space=e.use_world_space,t.count_factor=e.count_factor,t.frame_start=e.frame_start,t.frame_end=e.frame_end,t.time_length=e.time_length,t.lifetime_frames=e.lifetime_frames,t.lifetime=e.lifetime,t.cyclic=e.cyclic,t.mass=e.mass,t.nfactor=e.nfactor,t.gravity=e.gravity,t.fade_in=e.fade_in,t.fade_out=e.fade_out,t.wind_factor=e.wind_factor,t.size=e.size,t.alpha_start=e.alpha_start,t.alpha_end=e.alpha_end,t.color_ramp_length=e.color_ramp_length,t.color_ramp.set(e.color_ramp),t.need_buffers_update=e.need_buffers_update,t.positions=lO(e.positions),t.positions_cache=lO(e.positions_cache),t.tbn=lO(e.tbn),t.tbn_cache=lO(e.tbn_cache),t.delay_attrs=lO(e.delay_attrs),t.delay_attrs_masked=lO(e.delay_attrs_masked),t.emitter_tsr_snapshots=lO(e.emitter_tsr_snapshots),t.p_data=lO(e.p_data),t.tilt=e.tilt,t.tilt_rand=e.tilt_rand,t};var f=function(){r.panic("_rand() undefined")};function p(e,t,r,n,a,o){for(var _=e.delay_attrs,i=e.emitter_tsr_snapshots,s=e.time,l=e.prev_time,d=0;d<_.length;d+=4){var T=_[d];s>l&&s>=T&&T>l||s<l&&(T>l||s>=T)?(Tg(n,i,d),Dm(n,E)):dg(i,d,E);var f=u;f[0]=t[3*d],f[1]=t[3*d+1],f[2]=t[3*d+2],rg(f,E,f),a[3*d]=f[0],a[3*d+1]=f[1],a[3*d+2]=f[2];var p=GR(r,d,c);HR(p,E,p),KR(o,p,d);for(var P=1;P<4;P++)a[3*(d+P)]=a[3*d],a[3*(d+P)+1]=a[3*d+1],a[3*(d+P)+2]=a[3*d+2],KR(o,p,d+P)}}function P(e,t){for(var r=0;r<t.length;r++){var n=t[r],a=n.particles_data;a&&a.use_world_space&&!n.forked_batch&&(p(a,a.positions,a.tbn,e.render.world_tsr,a.positions_cache,a.tbn_cache),a.need_buffers_update=!0)}}t.update=function(){for(var e=0;e<d.length;e++)for(var t=d[e],r=t.scenes_data,n=0;n<r.length;n++)P(t,r[n].batches)},t.obj_has_particles=function(e){for(var t=e.scenes_data,r=0;r<t.length;r++)for(var n=t[r].batches,a=0;a<n.length;a++)if(n[a].particles_data)return!0;return!1},t.obj_has_psys=function(e,t){for(var r=e.scenes_data,n=0;n<r.length;n++)for(var a=r[n].batches,o=0;o<a.length;o++){var _=a[o].particles_data;if(_&&_.name==t)return!0}return!1},t.obj_has_anim_particles=function(e){for(var t=e.scenes_data,r=0;r<t.length;r++)for(var n=t[r].batches,a=0;a<n.length;a++){var o=n[a].particles_data;if(o&&"EMITTER"==o.p_type)return!0}return!1},t.bpy_obj_has_particles=function(e){return e.particle_systems.length>0},t.bpy_obj_has_anim_particles=function(e){for(var t=0;t<e.particle_systems.length;t++)if("EMITTER"==e.particle_systems[t].settings.type)return!0;return!1},t.has_dynamic_grass_particles=function(e){for(var t=0;t<e.particle_systems.length;t++){var r=e.particle_systems[t].settings;if("HAIR"==r.type&&r.b4w_dynamic_grass)return!0}return!1},t.create_particles_data=function(e,t,r){var n,o,_,c=e.particles_data=T(t.name,t.settings.type);if(c.frame_start=t.settings.frame_start,c.frame_end=t.settings.frame_end,c.time_length=(c.frame_end-c.frame_start)/s.get_framerate(),c.lifetime_frames=t.settings.lifetime,c.lifetime=c.lifetime_frames/s.get_framerate(),c.cyclic=t.settings.b4w_cyclic?1:0,c.mass=t.settings.mass,c.nfactor=t.settings.normal_factor,c.gravity=9.81*t.settings.effector_weights.gravity,c.fade_in=t.settings.b4w_fade_in/s.get_framerate(),c.fade_out=t.settings.b4w_fade_out/s.get_framerate(),c.wind_factor=t.settings.effector_weights.wind,c.use_world_space="WORLD"==t.settings.b4w_coordinate_system,e.halo_particles){n=r.halo_settings.size;var E=r.halo_settings.hardness;E<30?(o=.5,_=.9):E<40?(o=.1,_=1):E<50?(o=0,_=.8):(o=0,_=.5)}else n=t.settings.particle_size,o=1,_=1;c.size=n,c.alpha_start=o,c.alpha_end=_,r.use_nodes&&"BILLBOARD"==t.settings.render_type&&(a.set_batch_directive(e,"NODES",1),a.set_batch_directive(e,"PARTICLE_BATCH",1),e.has_nodes=!0);var u=t.settings.texture_slots;if(u[0]&&u[0].use_map_size&&u[0].texture&&"BLEND"==u[0].texture.type&&u[0].texture.use_color_ramp&&l.allow_vertex_textures){var d=u[0].texture,f=[];i.calc_color_ramp_data(d.color_ramp,i.PART_COLORRAMP_TEXT_SIZE,f),f=new Uint8Array(f.map((function(e){return xO(255*e,0,255)})));var p=i.create_color_ramp_texture(f,i.PART_COLORRAMP_TEXT_SIZE);a.append_texture(e,p,"u_color_ramp_tex",d.name),a.set_batch_directive(e,"USE_COLOR_RAMP",1)}var P=r.texture_slots,S=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(P[0]&&"STRAND"==P[0].texture_coords&&P[0].texture&&"BLEND"==P[0].texture.type&&P[0].texture.use_color_ramp){for(var A=P[0].texture.color_ramp.elements,h=Math.min(4*A.length,S.length),v=0;v<h;v+=4){var m=A[v/4];S[v]=m.position,S[v+1]=m.color[0],S[v+2]=m.color[1],S[v+3]=m.color[2]}c.color_ramp_length=A.length}c.color_ramp.set(S)},t.generate_emitter_particles_submesh=function(e,t,n,a){var i=e.particles_data,l=a.world_tsr,u=n.settings.count,d=n.settings.frame_start/s.get_framerate(),T=n.settings.frame_end/s.get_framerate(),P=n.settings.lifetime/s.get_framerate(),S=n.settings.lifetime_random,A=n.settings.emit_from,h=n.settings.factor_random;if(n.settings.use_rotations)var v=n.settings.angular_velocity_mode,m=n.settings.angular_velocity_factor;else v="NONE",m=0;var g,O=n.settings.b4w_randomize_emission,N=n.settings.b4w_cyclic;i.tilt=n.settings.billboard_tilt,i.tilt_rand=n.settings.billboard_tilt_random,(g=n.seed)?(o.srand(g),f=function(){return o.rand()}):f=function(){return Math.random()};var R=function(e,t,n){switch(t){case"VERT":var a=n.va_frames[0].a_position,o=n.va_frames[0].a_tbn,i=function(e,t){for(var r=t.length/3,n=[],a=0;a<e;a++){var o=Math.round((r-1)*f());n.push(o),n.push(o),n.push(o),n.push(o)}return n}(e,a),s=function(e,t){for(var r=[],n=0;n<e.length;n++)r.push(t[3*e[n]]),r.push(t[3*e[n]+1]),r.push(t[3*e[n]+2]);return new Float32Array(r)}(i,a),l=function(e,t){for(var r=DR(e.length),n=0;n<e.length;n++)KR(r,GR(t,e[n],c),n);return r}(i,o);break;case"FACE":s=[],l=[];var E=[];eO(0,E);var u=_.geometry_random_points(n,e,!1,E);eO(0,E);var d=_.geometry_random_points(n,e,!0,E);l=DR(4*u.length);for(var T=0;T<u.length;T++)s.push(u[T][0],u[T][1],u[T][2]),s.push(u[T][0],u[T][1],u[T][2]),s.push(u[T][0],u[T][1],u[T][2]),s.push(u[T][0],u[T][1],u[T][2]),KR(l,d[T],4*T),KR(l,d[T],4*T+1),KR(l,d[T],4*T+2),KR(l,d[T],4*T+3);s=new Float32Array(s);break;case"VOLUME":r.panic("Particle emission from volume is not supported");break;default:r.panic("Wrong emit from option")}return[s,l]}(u,A,_.extract_submesh_all_mats(t,["a_position","a_tbn"],null,a)),I=R[0],b=R[1];i.positions=new Float32Array(I),i.tbn=new Float32Array(b),i.positions_cache=new Float32Array(I.length),i.tbn_cache=new Float32Array(b.length);var y=function(e,t,r,n,a){for(var o=[],_=(r-t)/e,i=0;i<e;i++){var s;s=n?_*i+10*_*(.5-f()):_*i,a||(s+=t),o.push(s),o.push(s),o.push(s),o.push(s)}return new Float32Array(o)}(u,d,T,O,N);if(i.delay_attrs=new Float32Array(y),i.delay_attrs_masked=new Float32Array(y),i.use_world_space){i.emitter_tsr_snapshots=new Float32Array(y.length*E.length);for(var L=0;L<8*y.length;L++)Tg(l,i.emitter_tsr_snapshots,L);p(i,I,b,l,I,b)}var Y=_.init_submesh("EMITTER_PARTICLES"),M=_.create_empty_va_frame();M.a_position=I,M.a_tbn=b,Y.va_frames[0]=M,e.draw_mode=_.DM_DYNAMIC_TRIANGLES,Y.indices=function(e){for(var t=[],r=0;r<e;r++)t.push(4*r,4*r+2,4*r+1,4*r,4*r+3,4*r+2);return new Uint16Array(t)}(u),Y.va_common.a_p_bb_vertex=_.gen_bb_vertices(u),Y.base_length=I.length/3;var x=function(e,t,r){for(var n=[],a=t*r,o=0;o<e;o++){var _=a*f();n.push(t-_),n.push(t-_),n.push(t-_),n.push(t-_)}return n}(u,P,S);return Y.va_common.a_p_data=function(e,t,r){for(var n=[],a=0;a<e;a++){var o=Math.random();n.push(t[4*a],r[4*a],o),n.push(t[4*a+1],r[4*a+1],o),n.push(t[4*a+2],r[4*a+2],o),n.push(t[4*a+3],r[4*a+3],o)}return new Float32Array(n)}(u,x,y),Y.va_common.a_p_vels=function(e,t,n,a){for(var o=[],_=0;_<e;_++){var i=[f()-.5,f()-.5,f()-.5];switch(Rh(i,i),o.push(t*i[0]),o.push(t*i[1]),o.push(t*i[2]),n){case"NONE":o.push(0);break;case"SPIN":case"VELOCITY":o.push(a);break;case"RAND":o.push(2*a*(f()-.5));break;default:r.panic("Undefined velocity factor")}for(var s=o.slice(-4),l=0;l<12;l++)o.push(s[l%4])}return new Float32Array(o)}(u,h,v,m),i.p_data=new Float32Array(Y.va_common.a_p_data),Y},t.set_time=function(e,t,r){for(var n=e.scenes_data,a=0;a<n.length;a++)for(var o=n[a].batches,_=0;_<o.length;_++){var i=o[_].particles_data;i&&i.name==t&&!o[_].forked_batch&&(i.prev_time=i.time,i.time=r)}},t.set_size=function(e,t,r){for(var n=e.scenes_data,a=0;a<n.length;a++)for(var o=n[a].batches,_=0;_<o.length;_++){var i=o[_].particles_data;i&&i.name==t&&(i.size=r)}},t.set_normal_factor=function(e,t,r){for(var n=e.scenes_data,a=0;a<n.length;a++)for(var o=n[a].batches,_=0;_<o.length;_++){var i=o[_].particles_data;i&&i.name==t&&(i.nfactor=r)}},t.get_normal_factor=function(e,t){for(var r=e.scenes_data,n=0;n<r.length;n++)for(var a=r[n].batches,o=0;o<a.length;o++){var _=a[o].particles_data;if(_&&_.name==t)return _.nfactor}return 0},t.set_factor=function(e,t,r){for(var n=e.scenes_data,a=0;a<n.length;a++)for(var o=n[a].batches,i=0;i<o.length;i++){var s=o[i],l=s.particles_data;if(l&&l.name==t){l.count_factor=r;var c=l.delay_attrs;if(1==r)var E=c;else if(0==r){E=l.delay_attrs_masked;for(var u=0;u<E.length;u+=4)E[u]=1e4,E[u+1]=E[u],E[u+2]=E[u],E[u+3]=E[u]}else{var d=4/r,T=(E=l.delay_attrs_masked,0);for(u=0;u<E.length;u+=4)u>=T?(E[u]=c[u],T+=d):E[u]=1e4,E[u+1]=E[u],E[u+2]=E[u],E[u+3]=E[u]}var f=s.bufs_data;if(f.pointers.a_p_data){var p=l.p_data;for(u=0;u<p.length;u+=3)p[u+1]=E[Math.round(u/3)];_.update_bufs_data_array(f,"a_p_data",3,p)}}}},t.update_start_pos=function(){var e=wm();return function(t,r,n,a){var o=t.scenes_data,_=Km(r,e);Bm(n,e),_=Hm(a,e);for(var i=0;i<o.length;i++)for(var s=o[i].batches,l=0;l<s.length;l++){var c=s[l].particles_data;if(c&&c.use_world_space)for(var E=0;E<8*c.delay_attrs.length;E++)Tg(_,c.emitter_tsr_snapshots,E)}}}(),t.update_particles_submesh=function(e,t,r){if(e.va_common.a_tbn=DR(4*r),FR(e.va_common.a_tbn),t.part_node_data){for(var n=[],a=0;a<r;a++)n.push(a,a,a,a);e.va_common[t.part_node_data.name]=new Float32Array(n)}},t.update_particles_objs_cache=function(e){-1==d.indexOf(e)&&d.push(e)},t.remove_obj_from_cache=function(e){var t=d.indexOf(e);-1!=t&&d.splice(t,1)},t.cleanup=function(){d.length=0}})),AI=nA("__debug_telemetry",(function(e,t){var r=mN(e),n=[],a={},o=["color: #3366FF","color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];t.fbmsg=function(){for(var e=[performance.now()],t=0;t<arguments.length;t++){var r=arguments[t];if(DO(r))for(var a=0;a<r.length;a++)e.push(r[a]);else e.push(arguments[t])}n.push(e)},t.msg=function(){for(var e=1,t=0;t<n.length;t++)(r=n[t])[1]==arguments[0]&&e++;var r=[e];for(t=0;t<arguments.length;t++){var a=arguments[t];if(DO(a))for(var o=0;o<a.length;o++)r.push(a[o]);else r.push(arguments[t])}n.push(r)},t.print_telemetry=function(e){e||(e=1);for(var t=0,a={},_=Math.max(0,performance.now()-1e3*e),i=0;i<n.length;i++){var s=n[i];if(!((e=s[0])<_)){var l=String(s[1]);a[l]||(a[l]=o[t++%o.length]);for(var c=a[l],E=["%c"+(e/1e3).toFixed(6),c,l],u=2;u<s.length;u++)E.push(s[u]);r.log.apply(this,E)}}n.splice(0)},t.plot_telemetry=function(e){e||(e=1);for(var t={},a=Math.max(0,performance.now()-1e3*e),o=0;o<n.length;o++){var _=n[o];if(!((e=_[0])<a))for(var i=2;i<_.length;i++){var s=String(_[1]);_.length>3&&(s+="_"+String(i-2)),t[s]||(t[s]=s+"\n"),t[s]+=String(e)+" "+_[i]+"\n"}}var l="";for(var s in t)l+=t[s]+"\n\n";r.log(l),n.splice(0)},t.exec_count=function(e){e in a?a[e]+=1:a[e]=1},t.update=function(){for(var e in a)r.log(e,a[e]),a[e]=0}}));function hI(e){if(""==e)return".";var t=0==e.indexOf("/")|0;t&&0==e.indexOf("//")&&0!=e.indexOf("///")&&(t=2);for(var r=e.split("/"),n=[],a=0;a<r.length;a++){var o=r[a];""!=o&&"."!=o&&(".."!=o||!t&&!n.length||n.length&&".."==n[n.length-1]?n.push(o):n.length&&n.pop())}for(e=(r=n).join("/"),a=0;a<t;a++)e="/"+e;return e||"."}function vI(e){var t=e.split("://",2);return t.length>1?(t[1]=hI(t[1]),t.join("://")):hI(e)}function mI(e){return/(?:\.([^.]+))?$/.exec(e)[1]}var gI=nA("__ipc",(function(e,t){var r=gN(e),n=TR(e),a=!0;t.IN_LOADED=0,t.IN_COLLISION=1,t.IN_COLLISION_POS_NORM=2,t.IN_COLLISION_IMPULSE=3,t.IN_ERROR=4,t.IN_FBMSG=5,t.IN_FLOATER_BOB_TRANSFORM=6,t.IN_LOG=7,t.IN_PROP_OFFSET=8,t.IN_RAY_HIT=9,t.IN_RAY_HIT_POS_NORM=10,t.IN_REMOVE_RAY_TEST=11,t.IN_TRANSFORM=12,t.IN_VEHICLE_SPEED=13,t.IN_PING=14,t.IN_FPS=15,t.IN_DEBUG_STATS=16;var o=t.IN_COLLISION,_=t.IN_COLLISION_POS_NORM,i=t.IN_PROP_OFFSET,s=t.IN_RAY_HIT,l=t.IN_RAY_HIT_POS_NORM,c=t.IN_TRANSFORM;t.OUT_INIT=100,t.OUT_ACTIVATE=101,t.OUT_ADD_BOAT_BOB=102,t.OUT_ADD_CAR_WHEEL=103,t.OUT_ADD_FLOATER_BOB=104,t.OUT_APPEND_BOUNDING_BODY=105,t.OUT_APPEND_BOAT=106,t.OUT_APPEND_CAR=107,t.OUT_APPEND_CHARACTER=108,t.OUT_APPEND_COLLISION_TEST=109,t.OUT_APPEND_CONSTRAINT=110,t.OUT_APPEND_FLOATER=111,t.OUT_APPEND_GHOST_MESH_BODY=112,t.OUT_APPEND_STATIC_MESH_BODY=113,t.OUT_APPEND_WATER=114,t.OUT_REMOVE_BODY=115,t.OUT_APPLY_CENTRAL_FORCE=116,t.OUT_APPLY_COLLISION_IMPULSE_TEST=117,t.OUT_APPLY_TORQUE=118,t.OUT_CHARACTER_JUMP=119,t.OUT_CHARACTER_ROTATION_INCREMENT=120,t.OUT_CLEAR_COLLISION_IMPULSE_TEST=121,t.OUT_DISABLE_SIMULATION=122,t.OUT_ENABLE_SIMULATION=123,t.OUT_PAUSE=124,t.OUT_APPEND_RAY_TEST=125,t.OUT_REMOVE_RAY_TEST=126,t.OUT_CHANGE_RAY_TEST_FROM_TO=127,t.OUT_REMOVE_COLLISION_TEST=128,t.OUT_REMOVE_CONSTRAINT=129,t.OUT_RESUME=130,t.OUT_SET_CHARACTER_FLY_VELOCITY=131,t.OUT_SET_CHARACTER_HOR_ROTATION=132,t.OUT_SET_CHARACTER_MOVE_DIR=133,t.OUT_SET_CHARACTER_MOVE_TYPE=134,t.OUT_SET_CHARACTER_ROTATION=135,t.OUT_SET_CHARACTER_RUN_VELOCITY=136,t.OUT_SET_CHARACTER_VERT_ROTATION=137,t.OUT_SET_CHARACTER_WALK_VELOCITY=138,t.OUT_SET_GRAVITY=139,t.OUT_SET_LINEAR_VELOCITY=140,t.OUT_SET_TRANSFORM=141,t.OUT_SET_WATER_TIME=142,t.OUT_ADD_WATER_WRAPPER=143,t.OUT_UPDATE_BOAT_CONTROLS=144,t.OUT_UPDATE_CAR_CONTROLS=145,t.OUT_PING=146,t.OUT_DEBUG=147,t.OUT_UPDATE_WORLD=148,t.OUT_SET_ANGULAR_VELOCITY=149,t.OUT_SET_CHARACTER_VERT_MOVE_DIR_ANGLE=150,t.OUT_UPDATE_BOUNDING_BODY=151,t.OUT_UPDATE_STATIC_MESH_BODY=152;var E=t.OUT_SET_TRANSFORM,u=tA.worker_listeners,d=tA.worker_namespaces,T={msg_id:c,body_id:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),linvel:new Float32Array(3),angvel:new Float32Array(3),len:0},f={msg_id:i,chassis_hull_body_id:0,prop_ind:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},p={msg_id:s,id:0,body_id_hit:0,hit_fract:0,hit_time:0,len:0},P={msg_id:l,id:0,body_id_hit:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},S={msg_id:o,body_id_a:0,body_id_b:0,result:0,len:0},A={msg_id:_,body_id_a:0,body_id_b:0,result:0,coll_point:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},h={msg_id:E,body_id:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},v=[T,f,p,P,S,A,h];function m(e,t,r){for(var n=0;n<d.length;n+=2)d[n+1]==e&&(u[n+Number(!t)]=r)}t.create_worker=function(t,o){var _={is_main:!!t,web_worker:null,buf_arr:[],fb_worker_ns:""};if(o)if(_.web_worker={addEventListener:function(e,t,n){"message"!=e&&r.panic("Wrong web worker event"),m(_.fb_worker_ns,_.is_main,t)},removeEventListener:function(e,t,n){"message"!=e&&r.panic("Wrong web worker event"),m(_.fb_worker_ns,_.is_main,null)},postMessage:function(e,t){!function(e,t){for(var r=0;r<d.length;r+=2)if(d[r+1]==e)return u[r+Number(!t)];return null}(_.fb_worker_ns,!_.is_main)({data:e})},terminate:function(){for(var e=0;e<d.length;e+=2)if(d[e+1]==_.fb_worker_ns)return u.splice(e,2),void d.splice(e,2)}},_.is_main){var i=e,s=n.unique_name(i+"_worker");d.push(i),d.push(s),u.push(null),u.push(null),_.fb_worker_ns=s;var l=function(e){for(var t=document.getElementsByTagName("script"),r=vI(e),n=0;n<t.length;n++)if(t[n].src==r)return t[n];return null}(t);l?a?l.addEventListener("load",(function(){tA.require("__bindings",_.fb_worker_ns)}),!1):(tA.cleanup("__bindings",_.fb_worker_ns),tA.cleanup("__ipc",_.fb_worker_ns),tA.require("__bindings",_.fb_worker_ns)):((l=document.createElement("script")).src=t,l.defer="defer",l.async="async",l.addEventListener("load",(function(){a=!1,tA.require("__bindings",_.fb_worker_ns)}),!1),document.head.appendChild(l))}else _.fb_worker_ns=e;else _.web_worker=t?new Worker(t):self;return _},t.attach_handler=function(e,t){!function(e){for(var t=0;t<e.length;t++){var r=e[t],n=0;for(var a in r){var o=r[a];switch(o.constructor){case Float32Array:n+=o.length;break;case Number:n+=1}}r.len=n-=1}}(v);e.web_worker.addEventListener("message",(function(r){!function r(n){if(n.constructor==ArrayBuffer)n=new Float32Array(n);else if(n[0].constructor==ArrayBuffer){for(var a=0;a<n.length;a++)r(n[a]);return}var u=0|n[0];switch(u){case c:(d=T).body_id=0|n[1],d.time=n[2],d.trans[0]=n[3],d.trans[1]=n[4],d.trans[2]=n[5],d.quat[0]=n[6],d.quat[1]=n[7],d.quat[2]=n[8],d.quat[3]=n[9],d.linvel[0]=n[10],d.linvel[1]=n[11],d.linvel[2]=n[12],d.angvel[0]=n[13],d.angvel[1]=n[14],d.angvel[2]=n[15];break;case i:(d=f).chassis_hull_body_id=0|n[1],d.prop_ind=0|n[2],d.trans[0]=n[3],d.trans[1]=n[4],d.trans[2]=n[5],d.quat[0]=n[6],d.quat[1]=n[7],d.quat[2]=n[8],d.quat[3]=n[9];break;case s:(d=p).id=0|n[1],d.body_id_hit=0|n[2],d.hit_fract=n[3],d.hit_time=n[4];break;case l:(d=P).id=0|n[1],d.body_id_hit=0|n[2],d.hit_fract=n[3],d.hit_time=n[4],d.hit_pos[0]=n[5],d.hit_pos[1]=n[6],d.hit_pos[2]=n[7],d.hit_norm[0]=n[8],d.hit_norm[1]=n[9],d.hit_norm[2]=n[10];break;case o:(d=S).body_id_a=0|n[1],d.body_id_b=0|n[2],d.result=!!n[3];break;case _:(d=A).body_id_a=0|n[1],d.body_id_b=0|n[2],d.result=!!n[3],d.coll_point[0]=n[4],d.coll_point[1]=n[5],d.coll_point[2]=n[6],d.coll_norm[0]=n[7],d.coll_norm[1]=n[8],d.coll_norm[2]=n[9],d.coll_dist=n[10];break;case E:(d=h).body_id=0|n[1],d.trans[0]=n[2],d.trans[1]=n[3],d.trans[2]=n[4],d.quat[0]=n[5],d.quat[1]=n[6],d.quat[2]=n[7],d.quat[3]=n[8];break;default:var d=n}t(e,u,d)}(r.data)}),!1)},t.cleanup=function(){},t.post_msg=function(e,t){if(e)switch(t){case c:var r=T;(n=new Float32Array(r.len))[0]=r.msg_id,n[1]=r.body_id,n[2]=r.time,n[3]=r.trans[0],n[4]=r.trans[1],n[5]=r.trans[2],n[6]=r.quat[0],n[7]=r.quat[1],n[8]=r.quat[2],n[9]=r.quat[3],n[10]=r.linvel[0],n[11]=r.linvel[1],n[12]=r.linvel[2],n[13]=r.angvel[0],n[14]=r.angvel[1],n[15]=r.angvel[2],e.buf_arr.push(n.buffer);break;case i:r=f,(n=new Float32Array(r.len))[0]=r.msg_id,n[1]=r.chassis_hull_body_id,n[2]=r.prop_ind,n[3]=r.trans[0],n[4]=r.trans[1],n[5]=r.trans[2],n[6]=r.quat[0],n[7]=r.quat[1],n[8]=r.quat[2],n[9]=r.quat[3],e.buf_arr.push(n.buffer);break;case s:r=p,(n=new Float32Array(r.len))[0]=r.msg_id,n[1]=r.id,n[2]=r.body_id_hit,n[3]=r.hit_fract,n[4]=r.hit_time,e.buf_arr.push(n.buffer);break;case l:r=P,(n=new Float32Array(r.len))[0]=r.msg_id,n[1]=r.id,n[2]=r.body_id_hit,n[3]=r.hit_fract,n[4]=r.hit_time,n[5]=r.hit_pos[0],n[6]=r.hit_pos[1],n[7]=r.hit_pos[2],n[8]=r.hit_norm[0],n[9]=r.hit_norm[1],n[10]=r.hit_norm[2],e.buf_arr.push(n.buffer);break;case o:r=S,(n=new Float32Array(r.len))[0]=r.msg_id,n[1]=r.body_id_a,n[2]=r.body_id_b,n[3]=r.result,e.buf_arr.push(n.buffer);break;case _:r=A,(n=new Float32Array(r.len))[0]=r.msg_id,n[1]=r.body_id_a,n[2]=r.body_id_b,n[3]=r.result,n[4]=r.coll_point[0],n[5]=r.coll_point[1],n[6]=r.coll_point[2],n[7]=r.coll_norm[0],n[8]=r.coll_norm[1],n[9]=r.coll_norm[2],n[10]=r.coll_dist,e.buf_arr.push(n.buffer);break;case E:r=h,(n=new Float32Array(r.len))[0]=r.msg_id,n[1]=r.body_id,n[2]=r.trans[0],n[3]=r.trans[1],n[4]=r.trans[2],n[5]=r.quat[0],n[6]=r.quat[1],n[7]=r.quat[2],n[8]=r.quat[3],e.buf_arr.push(n.buffer);break;default:for(var n=[],a=1;a<arguments.length;a++)n.push(arguments[a]);e.web_worker.postMessage(n)}},t.post_msg_arr=function(e){e&&e.buf_arr.length&&(e.web_worker.postMessage(e.buf_arr),e.buf_arr.length=0)},t.get_msg_cache=function(e){switch(e){case c:return T;case i:return f;case s:return p;case l:return P;case o:return S;case _:return A;case E:return h;default:return null}},t.terminate=function(e){e.web_worker.terminate(),e.web_worker=null},t.is_active=function(e){return!!e.web_worker},t.is_fallback=function(e){return!!e.fb_worker_ns}})),OI=nA("__hud",(function(e,t){var r=pR(e),n=mR(e),a=[5,30,4,10,5,3,5],o=null,_=[0,0];function i(e){e.font="bold 15px Courier New",e.textBaseline="middle",e.shadowBlur=0,e.shadowColor=null}function s(e){if(c(' SCENE "'+e.name+'"'),c(" Active                 Subscene   Lamps   Size   RenderCalls   Time"),e._render){var t=0,a=0,o=0;return r.traverse(e._render.graph,(function(e,r){var _=r;if(_.type!=n.SINK){for(var i=Math.round(_.camera.width)+"x"+Math.round(_.camera.height),s=0,l=0;l<_.draw_data.length;l++)s+=_.draw_data[l].bundles.length;var E=_.debug_render_calls;_.type!=n.MAIN_CUBE_REFLECT&&_.type!=n.MAIN_CUBE_REFLECT_BLEND||(s*=6);var u=_.do_render&&!_.force_do_not_render,d=u?_.debug_render_time:0;_.enqueue||(_.debug_render_time=0),c(u?" (\u2713)":" (\u2715)",n.subs_label(_),_.num_lights,i,E,"of",s,"  ",d.toFixed(3)),_.debug_render_calls=0,t+=s,u&&(a+=E,o+=d)}})),[t,a,o]}c("No INFO")}function l(){_[0]++}function c(){for(var e=30,t=80+20*_[0],r=arguments[0],n=1;n<arguments.length;n++){var i=arguments[n],s=a[n]-String(i).length;r+=E(s)+arguments[n]}l(),o.fillText(r,e,t)}function E(e){for(var t="",r=0;r<e;r++)t+=" ";return t}function u(e,t,r,n,a){return a.x=e,a.y=t,a.w=r,a.h=n,a}function d(e,t,r){var n=e.w*t;return r.x=e.x+n,r.y=e.y,r.w=e.w-2*n,r.h=e.h,r}function T(e){return e.x+e.w/2}function f(e){var t={x:0,y:0,w:0,h:0};return u(0,0,o.canvas.width,o.canvas.height,t),d(t,.01,t),function(e,t,r){var n=.02*e.h;r.x=e.x,r.y=e.y+n,r.w=e.w,r.h=e.h-2*n}(t,0,t),function(e,t,r,n){var a=e.w/8;n.x=e.x+a*t,n.y=e.y,n.w=a,n.h=e.h}(t,e,0,t),d(t,.02,t),t}function p(e,t,r,n,a){var o=n[0],_=n[1],i=n[2],s=n[3],l=n[5],c=(s-i)/n[4];if(c<1)var E=Math.floor(1/c-1e-5).toFixed(0).length;else E=0;if(l)var u=Math.log(_/i)/Math.log(s/i);else u=(_-i)/(s-i);if(e.textAlign="center",e.fillText(a?"["+o+"]":o,T(r),r.y),e.strokeStyle="#00FF00",e.lineWidth=t?3:1,t?(e.textAlign="right",e.fillText(s.toFixed(E),T(r)-10,r.y+15),e.textAlign="right",e.fillText(i.toFixed(E),T(r)-10,r.y+r.h-15)):(e.textAlign="right",e.fillText(i.toFixed(E),r.x+28,r.y+15),e.textAlign="left",e.fillText(s.toFixed(E),r.x+r.w-28,r.y+15)),e.beginPath(),t){var d=r.y+15+(r.h-30)*(1-u);e.moveTo(T(r),r.y+15),e.lineTo(T(r),r.y+r.h-15),e.moveTo(T(r)-5,r.y+15),e.lineTo(T(r)+5,r.y+15),e.moveTo(T(r)-5,r.y+r.h-15),e.lineTo(T(r)+5,r.y+r.h-15),e.moveTo(T(r)-5,d),e.lineTo(T(r)+5,d)}else{var f=r.x+30+(r.w-60)*u;e.moveTo(r.x+30,r.y+15),e.lineTo(r.x+r.w-30,r.y+15),e.moveTo(r.x+30,r.y+15-5),e.lineTo(r.x+30,r.y+15+5),e.moveTo(r.x+r.w-30,r.y+15-5),e.lineTo(r.x+r.w-30,r.y+15+5),e.moveTo(f,r.y+15-5),e.lineTo(f,r.y+15+5)}if(e.stroke(),"EQ_Q"==o){var p=1+1/(2*_*_)+Math.sqrt((2+1/(_*_))*(2+1/(_*_))/4-1),P=Math.log(p)/Math.log(2);t?(e.textAlign="left",e.fillText(_.toFixed(E),T(r)+10,d),e.textAlign="left",e.fillText("("+P.toFixed(E+1)+")",T(r)+10,d+10)):(e.textAlign="right",e.fillText(_.toFixed(E),f,r.y+30),e.textAlign="left",e.fillText("("+P.toFixed(E+1)+")",f,r.y+30))}else t?(e.textAlign="left",e.fillText(_.toFixed(E),T(r)+10,d)):(e.textAlign="center",e.fillText(_.toFixed(E),f,r.y+30))}t.init=function(e){var t=e.getContext("2d");return i(t),o=t,t},t.update_dim=function(){o&&i(o)},t.reset=function(){var e=o;e&&(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillStyle="rgba(0,0,0,0.5)",e.fillRect(0,0,e.canvas.width,e.canvas.height),_[0]=0,_[1]=0)},t.show_debug_info=function(e,t){var r=o;if(r){r.textAlign="left",r.fillStyle="rgba(0,255,0,255)",c(" FPS",(1/t).toFixed(2)),l();for(var n=0,a=0,_=0,i=0;i<e.length;i++){var E=s(e[i]);n+=E[0],a+=E[1],_+=E[2],l()}c(" ----------------------------------------------------------------"),c("    ","TOTAL ACTIVE","","",a,"of",n,"  ",_.toFixed(3))}},t.print=function(){var e=o;e&&(e.textAlign="left",e.fillStyle="rgba(0,255,0,255)",c.apply(Math,arguments))},t.plot_array=function(e,t,r,n,a,_,i){var s=o;if(s){var l=f(t);if(function(e,t,r,n){var a=e.h/5;n.x=e.x,n.y=e.y+4*a,n.w=e.w,n.h=a}(l,0,0,l),s.textAlign="center",s.fillStyle="#00FF00",o.fillText(e,T(l),l.y-10),s.strokeStyle="#00FF00",s.lineWidth=.5,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(l.x+l.w,l.y),s.lineTo(l.x+l.w,l.y+l.h),s.lineTo(l.x,l.y+l.h),s.closePath(),s.stroke(),!_&&!i){_=1e6,i=-1e6;for(var c=0;c<r.length;c++)_=Math.min(_,r[c]),i=Math.max(i,r[c])}s.textAlign="right",o.fillText(String(_),l.x-10,l.y+l.h),o.fillText(String(i),l.x-10,l.y),s.textAlign="center",o.fillText(String(n),l.x,l.y+l.h+15),o.fillText(String(a),l.x+l.w,l.y+l.h+15),s.strokeStyle="#FF0000",s.lineWidth=1.5,s.beginPath();var E=l.w/(r.length-1),u=l.h/(i-_);for(c=0;c<r.length;c++){var d=l.x+E*c,p=l.y+l.h-(r[c]-_)*u;0==c?s.moveTo(d,p):s.lineTo(d,p)}s.stroke()}},t.draw_mixer_strip=function(e,t,r,n,a,_,i){var s=o;if(s){s.textAlign="center",s.fillStyle="#00FF00",s.font="bold 12px Courier";var l=f(r);o.fillText(t?"["+e+"]":e,T(l),l.y),_>=0&&o.fillText(_?"[M]":"[ ]",T(l)-15,l.y+30),i>=0&&o.fillText(i?"[S]":"[ ]",T(l)+15,l.y+30);for(var c={x:0,y:0,w:0,h:0},E=0;E<n.length;E++){var d=n[E],P="VOLUME"==d[0];P?u(l.x,l.y+350,l.w,250,c):u(l.x,l.y+50+50*E,l.w,l.h,c),p(s,P,c,d,E==a)}}}})),NI=nA("__input",(function(e,t){var r=jI(e),n=fb(e),a=dR(e),o=mN(e),_=a.defaults,i=a.hmd_params,s=wm(),l=wm(),c=IA();t.DEVICE_GYRO=10,t.DEVICE_HMD=20,t.DEVICE_MOUSE=30,t.DEVICE_KEYBOARD=40,t.DEVICE_TOUCH=50,t.DEVICE_GAMEPAD0=60,t.DEVICE_GAMEPAD1=70,t.DEVICE_GAMEPAD2=80,t.DEVICE_GAMEPAD3=90,t.HMD_WEBVR_DESKTOP=2,t.HMD_WEBVR_MOBILE=4,t.HMD_NON_WEBVR=1,t.HMD_WEBVR1=8,t.HMD_WEBVR1_1=16,t.HMD_WEBVR_TYPE=0,t.HMD_ORIENTATION_QUAT=10,t.HMD_POSITION=20,t.HMD_FOV_LEFT=21,t.HMD_FOV_RIGHT=22,t.HMD_EYE_DISTANCE=23,t.HMD_DISTORTION=24,t.HMD_BASELINE_DIST=25,t.HMD_SCREEN_LENS_DIST=26,t.HMD_SCREEN_WIDTH=27,t.HMD_SCREEN_HEIGHT=28,t.HMD_BEVEL_SIZE=29,t.HMD_PROJ_LEFT=30,t.HMD_PROJ_RIGHT=31,t.MOUSE_LOCATION=40,t.MOUSE_LOCATION_PL=41,t.MOUSE_DOWN_WHICH=50,t.MOUSE_UP_WHICH=60,t.MOUSE_WHEEL=70,t.KEYBOARD_UP=80,t.KEYBOARD_DOWN=90,t.KEYBOARD_DOWN_MODIFIED=91,t.TOUCH_START=100,t.TOUCH_MOVE=110,t.TOUCH_END=120,t.GYRO_ORIENTATION_QUAT=130,t.GYRO_ORIENTATION_ANGLES=140,t.GMPD_BUTTON_0=300,t.GMPD_BUTTON_1=301,t.GMPD_BUTTON_2=302,t.GMPD_BUTTON_3=303,t.GMPD_BUTTON_4=304,t.GMPD_BUTTON_5=305,t.GMPD_BUTTON_6=306,t.GMPD_BUTTON_7=307,t.GMPD_BUTTON_8=308,t.GMPD_BUTTON_9=309,t.GMPD_BUTTON_10=310,t.GMPD_BUTTON_11=311,t.GMPD_BUTTON_12=312,t.GMPD_BUTTON_13=313,t.GMPD_BUTTON_14=314,t.GMPD_BUTTON_15=315,t.GMPD_BUTTON_16=316,t.GMPD_BUTTON_17=317,t.GMPD_BUTTON_18=318,t.GMPD_BUTTON_19=319,t.GMPD_BUTTON_20=320,t.GMPD_BUTTON_21=321,t.GMPD_BUTTON_22=322,t.GMPD_BUTTON_23=323,t.GMPD_BUTTON_24=324,t.GMPD_BUTTON_25=325,t.GMPD_TRACKPAD_BUTTON=300,t.GMPD_TRIGGER_BUTTON=301,t.GMPD_GRIPS_BUTTON=302,t.GMPD_MENU_BUTTON=303,t.GMPD_AXIS_0=326,t.GMPD_AXIS_1=327,t.GMPD_AXIS_2=328,t.GMPD_AXIS_3=329,t.GMPD_AXIS_4=330,t.GMPD_AXIS_5=331,t.GMPD_AXIS_6=332,t.GMPD_AXIS_7=333,t.GMPD_AXIS_8=334,t.GMPD_AXIS_9=335,t.GMPD_AXIS_10=336,t.GMPD_AXIS_11=337;var E=dm(),u=dm(),d=ih(),T=new Float32Array(2),f=ih(),p=dm(),P="ontouchstart"in document.documentElement,S=[];function A(e){var t=r.detect_mobile();return!(!(20!=e||navigator.getVRDevices||navigator.getVRDisplays||t&&J())||!(10!=e||t&&window.DeviceOrientationEvent))}function h(e,r){10==e||20==e?r=window:r||(r=40==e?document:n.get_container());for(var a=0;a<S.length;a++)if(S[a].type==e&&S[a].element==r)return S[a];var o=function(e,t){if(!A(e))return null;var r={type:e,registered:!1,orientation_quat_cb_list:[],orientation_angles_cb_list:[],mouse_down_which_cb_list:[],mouse_location_cb_list:[],mouse_up_which_cb_list:[],mouse_wheel_cb_list:[],keyboard_down_cb_list:[],keyboard_down_mod_cb_list:[],keyboard_up_cb_list:[],touch_start_cb_list:[],touch_move_cb_list:[],touch_end_cb_list:[],element:t,prevent_default:!0,registered_event_listeners:[],mouse_location:new Float32Array(2),mouse_which:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),registered_cb:null,webvr_hmd_device:null,webvr_sensor_devices:null,webvr_display:null,orientation:dm(),position:ih(),frame_data:window.VRFrameData?new VRFrameData:null,standing_tsr:wm(),fov_left:new Float32Array(4),fov_right:new Float32Array(4),inter_lens_dist:0,base_line_dist:0,screen_to_lens_dist:0,width_dist:0,height_dist:0,bevel_size:0,gamepad_btns:[],gamepad_axes:[0,0,0,0,0,0,0,0,0,0,0,0],gamepad_prev_axes:[0,0,0,0,0,0,0,0,0,0,0,0],gamepad_mapping:[]};return r.fov_left[0]=r.fov_left[1]=r.fov_left[2]=r.fov_left[3]=Math.PI/4,r.fov_right[0]=r.fov_right[1]=r.fov_right[2]=r.fov_right[3]=Math.PI/4,30==e||40==e||50==e?(r.registered=Boolean(t),50==e?document.addEventListener("touchstart",(function(){})):40==e&&(r.prevent_default=!1)):10==e?r.registered=!0:20==e&&v(r),r}(e,r);return 60!=e&&70!=e&&80!=e&&90!=e||function(e){e.gamepad_mapping.push(t.GMPD_BUTTON_0,t.GMPD_BUTTON_1,t.GMPD_BUTTON_2,t.GMPD_BUTTON_3,t.GMPD_BUTTON_4,t.GMPD_BUTTON_5,t.GMPD_BUTTON_6,t.GMPD_BUTTON_7,t.GMPD_BUTTON_8,t.GMPD_BUTTON_9,t.GMPD_BUTTON_10,t.GMPD_BUTTON_11,t.GMPD_BUTTON_12,t.GMPD_BUTTON_13,t.GMPD_BUTTON_14,t.GMPD_BUTTON_15,t.GMPD_BUTTON_16,t.GMPD_BUTTON_17,t.GMPD_BUTTON_18,t.GMPD_BUTTON_19,t.GMPD_BUTTON_20,t.GMPD_BUTTON_21,t.GMPD_BUTTON_22,t.GMPD_BUTTON_23,t.GMPD_BUTTON_24,t.GMPD_BUTTON_25,t.GMPD_AXIS_0,t.GMPD_AXIS_1,t.GMPD_AXIS_2,t.GMPD_AXIS_3,t.GMPD_AXIS_4,t.GMPD_AXIS_5,t.GMPD_AXIS_6,t.GMPD_AXIS_7,t.GMPD_AXIS_8,t.GMPD_AXIS_9,t.GMPD_AXIS_10,t.GMPD_AXIS_11)}(o),o&&S.push(o),o}function v(e){20==e.type&&(navigator.getVRDisplays?navigator.getVRDisplays().then((function(t){t.length>0&&(e.webvr_display=t[0],e.registered=!0,e.webvr_display.getFrameData(e.frame_data),e.registered_cb&&e.registered_cb())}),(function(t){o.error_once("WebVR displays are not found."),e.registered=!1})):navigator.getVRDevices?(navigator.getVRDevices().then((function(t){!function(e,t){var r=t.filter((function(e){return e instanceof HMDVRDevice})),n=null;r.length&&(n=r[0]);var a=null;n&&(a=t.filter((function(e){return-1!==e.deviceName.toLowerCase().indexOf("oculus")&&e.hardwareUnitId==n.hardwareUnitId&&e instanceof PositionSensorVRDevice}))),e.webvr_hmd_device=n,e.webvr_sensor_devices=a}(e,t),t.length&&(e.registered=!0),e.registered_cb&&e.registered_cb()}),(function(t){o.error_once("WebVR devices are not found."),e.registered=!1})),m(e,i.webvr)):(function(e){var t=i.nonwebvr;e.width_dist=t.width_dist,e.height_dist=t.height_dist,e.bevel_size=t.bevel_size,m(e,t),e.inter_lens_dist=t.inter_lens_dist,e.base_line_dist=t.base_line_dist,e.screen_to_lens_dist=t.screen_to_lens_dist,g(e)}(e),e.registered=!0))}function m(e,t){e.distortion_coefs[0]=t.distortion_coefs[0],e.distortion_coefs[1]=t.distortion_coefs[1],e.chromatic_aberration_coefs[0]=t.chromatic_aberration_coefs[0],e.chromatic_aberration_coefs[1]=t.chromatic_aberration_coefs[1],e.chromatic_aberration_coefs[2]=t.chromatic_aberration_coefs[2],e.chromatic_aberration_coefs[3]=t.chromatic_aberration_coefs[3]}function g(e){var t=Math.atan(e.inter_lens_dist/2/e.screen_to_lens_dist*i.nonwebvr.distor_scale),r=t,n=t;t&&(e.fov_left[0]=e.fov_right[0]=Math.min(t,Math.PI/3)),t&&(e.fov_left[1]=e.fov_right[3]=Math.min(t,Math.PI/3)),n&&(e.fov_left[2]=e.fov_right[2]=Math.min(n,Math.PI/3)),r&&(e.fov_left[3]=e.fov_right[1]=Math.min(r,Math.PI/3))}function O(e,t,r){switch(e.type){case 20:var n=R(e,0);if(1&n){if("left"==t)var a=e.fov_left;else a=e.fov_right;Bv(a,r)}else{var _=e.webvr_display||e.webvr_hmd_device;if(_){var i=_.getEyeParameters(t);if(a=i.fieldOfView||i.currentFieldOfView)r[0]=NO(a.upDegrees),r[1]=NO(a.rightDegrees),r[2]=NO(a.downDegrees),r[3]=NO(a.leftDegrees);else if(16&n){var s=c;yA("left"==t?e.frame_data.leftProjectionMatrix:e.frame_data.rightProjectionMatrix,s);var l=MA(s,s);l||(l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),xh([1,1,-1],l,d),r[0]=Math.atan(-d[1]/d[2]),r[1]=Math.atan(-d[0]/d[2]),xh([-1,-1,-1],l,d),r[2]=Math.atan(d[1]/d[2]),r[3]=Math.atan(d[0]/d[2])}}}break;default:o.error("fov is undefined for device: ",e.type)}return r}function N(e,t,r){switch(e.type){case 20:e.webvr_display&&("left"==t?yA(e.frame_data.leftProjectionMatrix,r):"right"==t?yA(e.frame_data.rightProjectionMatrix,r):o.error("Unknown type of eye: ",t));break;default:o.error("Projection matrix is undefined for device: ",e.type)}return r}function R(e,t){switch(t){case 0:var r=0;return navigator.getVRDisplays&&(r|=8,e.frame_data&&(r|=16)),navigator.getVRDevices&&(r|=_.is_mobile_device?4:2),r||1;case 23:var n=e.webvr_display||e.webvr_hmd_device;if(n){var a=n.getEyeParameters("left"),o=n.getEyeParameters("right");return e.webvr_display?o.offset[0]-a.offset[0]:o.eyeTranslation.x-a.eyeTranslation.x}return e.inter_lens_dist}}function I(e,t){if(e.webvr_display){var r=e.webvr_display;if(e.frame_data&&r.getFrameData(e.frame_data)){var n=e.frame_data.pose,a=uO(e.frame_data.leftViewMatrix,d);e.inter_lens_dist=2*mh(a)}else r.getPose&&(n=r.getPose());if(n){var o=vm(Cg,Math.PI/2,E);if(r.stageParameters&&r.stageParameters.sittingToStandingTransform){var _=eg(r.stageParameters.sittingToStandingTransform,s);Fm(l);var i=Hm(o,l);_=tg(i,_,e.standing_tsr)}else Fm(s),_=Hm(o,e.standing_tsr);n.orientation&&sg(n.orientation,_,e.orientation),n.position&&rg(n.position,_,e.position)}}}function b(e,t){if(e){for(var r=0;r<e.buttons.length;r++)t.gamepad_btns[r]=e.buttons[r].value||+e.buttons[r].pressed;if(e.axes)for(r=0;r<e.axes.length;r++)t.gamepad_axes[r]=e.axes[r];var n=e.pose;if(n){var a=h(20).standing_tsr;n.position&&rg(n.position,a,t.position),n.orientation&&sg(n.orientation,a,t.orientation)}}}function y(e){for(var t=0;t<e.gamepad_btns;t++)e.gamepad_btns[t]=0;for(t=0;t<e.gamepad_axes.length;t++)e.gamepad_prev_axes[t]=e.gamepad_axes[t],e.gamepad_axes[t]=0;e.position.set(Yg),e.orientation.set(Mg)}function L(e,t){var r=e.indexOf(t);r>=0&&(e[r]=null)}function Y(e){return null===e}function M(e,t,r,n){switch(t){case 130:r&&L(e.orientation_quat_cb_list,r),(n||e.orientation_angles_cb_list.every(Y)&&e.orientation_quat_cb_list.every(Y))&&(e.orientation_quat_cb_list.length=0,e.orientation_angles_cb_list.length=0,(a=e.registered_event_listeners.indexOf(t=141))>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("deviceorientation",w,!1)));break;case 140:r&&L(e.orientation_angles_cb_list,r),(n||e.orientation_angles_cb_list.every(Y)&&e.orientation_quat_cb_list.every(Y))&&(e.orientation_quat_cb_list.length=0,e.orientation_angles_cb_list.length=0,(a=e.registered_event_listeners.indexOf(t=141))>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("deviceorientation",w,!1)));break;case 50:r&&L(e.mouse_down_which_cb_list,r),(n||e.mouse_down_which_cb_list.every(Y))&&(e.mouse_down_which_cb_list.length=0,(a=e.registered_event_listeners.indexOf(t))>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("mousedown",F,!1)));break;case 40:r&&L(e.mouse_location_cb_list,r),(n||e.mouse_location_cb_list.every(Y))&&(e.mouse_location_cb_list.length=0,(a=e.registered_event_listeners.indexOf(t))>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("mousemove",k,!1)));break;case 41:r&&L(e.mouse_location_cb_list,r),(n||e.mouse_location_cb_list.every(Y))&&(e.mouse_location_cb_list.length=0,(a=e.registered_event_listeners.indexOf(t))>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("mousemove",D,!1)));break;case 60:if(r&&L(e.mouse_up_which_cb_list,r),n||e.mouse_up_which_cb_list.every(Y)){e.mouse_up_which_cb_list.length=0,(a=e.registered_event_listeners.indexOf(t))>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("mouseout",G,!1),e.element.removeEventListener("mouseup",K,!1));break}break;case 70:r&&L(e.mouse_wheel_cb_list,r),(n||e.mouse_wheel_cb_list.every(Y))&&(e.mouse_wheel_cb_list.length=0,(a=e.registered_event_listeners.indexOf(t))>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("wheel",X,!1)));break;case 90:r&&L(e.keyboard_down_cb_list,r),(n||e.keyboard_down_cb_list.every(Y))&&(e.keyboard_down_cb_list.length=0,(a=e.registered_event_listeners.indexOf(t))>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("keydown",H,!1)));break;case 80:r&&L(e.keyboard_up_cb_list,r),(n||e.keyboard_up_cb_list.every(Y))&&(e.keyboard_up_cb_list.length=0,(a=e.registered_event_listeners.indexOf(t))>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("keyup",j,!1)));break;case 100:r&&L(e.touch_start_cb_list,r),(n||e.touch_start_cb_list.every(Y))&&(e.touch_start_cb_list.length=0,(a=e.registered_event_listeners.indexOf(t))>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("touchstart",z,!1)));break;case 110:r&&L(e.touch_move_cb_list,r),(n||e.touch_move_cb_list.every(Y))&&(e.touch_move_cb_list.length=0,(a=e.registered_event_listeners.indexOf(t))>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("touchmove",Q,!1)));break;case 120:var a;r&&L(e.touch_end_cb_list,r),(n||e.touch_end_cb_list.every(Y))&&(e.touch_end_cb_list.length=0,(a=e.registered_event_listeners.indexOf(t))>=0&&(e.registered_event_listeners.splice(a,1),e.element.removeEventListener("touchend",V,!1)))}}function x(){return/iPad|iPhone|iPod/.test(navigator.platform)}function C(e,t){if(rO(e,8,t),"orientation"in window)var r=NO(window.orientation);else r="orientation"in window.screen?NO(window.screen.orientation.angle):0;return mm(t,vm(Fg,r,u),t),t}function w(e){var t=d;null===e.alpha||null===e.beta||null===e.gamma?t[0]=t[1]=t[2]=0:(t[0]=NO(e.alpha),t[1]=NO(e.beta),t[2]=NO(e.gamma));for(var r=h(10,e.currentTarget),n=0;n<r.orientation_angles_cb_list.length;n++)(o=r.orientation_angles_cb_list[n])&&(ch(t,f),o(f));if(r.orientation_quat_cb_list.length){var a=C(t,E);for(n=0;n<r.orientation_quat_cb_list.length;n++){var o;(o=r.orientation_quat_cb_list[n])&&(Bv(a,p),o(p))}}for(n=0;n<r.orientation_quat_cb_list.length;n++)r.orientation_quat_cb_list[n]||r.orientation_quat_cb_list.splice(n,1);for(n=0;n<r.orientation_angles_cb_list.length;n++)r.orientation_angles_cb_list[n]||r.orientation_angles_cb_list.splice(n,1)}function U(e,t){switch(e.type){case 30:e.mouse_location[0]=t.clientX,e.mouse_location[1]=t.clientY,e.mouse_which=t.which}}function k(e){if(P){if(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents)return;if(5==e.mozInputSource)return}var t=h(30,e.currentTarget);U(t,e);for(var r=0;r<t.mouse_location_cb_list.length;r++){var n=t.mouse_location_cb_list[r];n&&(T[0]=e.clientX,T[1]=e.clientY,n(T))}for(t.prevent_default&&e.preventDefault(),r=0;r<t.mouse_location_cb_list.length;r++)t.mouse_location_cb_list[r]||t.mouse_location_cb_list.splice(r,1)}function D(e){if(P){if(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents)return;if(5==e.mozInputSource)return}var t=h(30,e.currentTarget);U(t,e);for(var r=0;r<t.mouse_location_cb_list.length;r++){var n=t.mouse_location_cb_list[r];if(n){if("number"==typeof e.movementX)var a=e.movementX,o=e.movementY;else"number"==typeof e.webkitMovementX?(a=e.webkitMovementX,o=e.webkitMovementY):"number"==typeof e.mozMovementX?(a=e.mozMovementX,o=e.mozMovementY):(a=0,o=0);T[0]=a,T[1]=o,n(T)}}for(t.prevent_default&&e.preventDefault(),r=0;r<t.mouse_location_cb_list.length;r++)t.mouse_location_cb_list[r]||t.mouse_location_cb_list.splice(r,1)}function F(e){if(P){if(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents)return;if(5==e.mozInputSource)return}var t=h(30,e.currentTarget);U(t,e);for(var r=0;r<t.mouse_down_which_cb_list.length;r++){var n=t.mouse_down_which_cb_list[r];n&&n(e.which)}for(t.prevent_default&&(window.frameElement&&window.frameElement.focus(),e.preventDefault()),r=0;r<t.mouse_down_which_cb_list.length;r++)t.mouse_down_which_cb_list[r]||t.mouse_down_which_cb_list.splice(r,1)}function G(e){!n.is_child(e.relatedTarget)&&e.which&&K(e)}function K(e){if(P){if(e.sourceCapabilities&&e.sourceCapabilities.firesTouchEvents)return;if(5==e.mozInputSource)return}var t=h(30,e.currentTarget);U(t,e);for(var r=0;r<t.mouse_up_which_cb_list.length;r++){var n=t.mouse_up_which_cb_list[r];n&&n(e.which)}for(t.prevent_default&&e.preventDefault(),r=0;r<t.mouse_up_which_cb_list.length;r++)t.mouse_up_which_cb_list[r]||t.mouse_up_which_cb_list.splice(r,1)}function B(e){var t=0;return e.wheelDelta?t=e.wheelDelta%120==0?e.wheelDelta/120:qg(e.wheelDelta):e.deltaY&&(t=e.deltaY%3==0?-e.deltaY/3:-qg(e.deltaY)),xO(100*t,-2e3,2e3)}function X(e){for(var t=h(30,e.currentTarget),r=0;r<t.mouse_wheel_cb_list.length;r++){var n=t.mouse_wheel_cb_list[r];n&&n(B(e))}for(t.prevent_default&&e.preventDefault(),r=0;r<t.mouse_wheel_cb_list.length;r++)t.mouse_wheel_cb_list[r]||t.mouse_wheel_cb_list.splice(r,1)}function H(e){for(var t=h(40,e.currentTarget),r=e.ctrlKey||e.altKey||e.metaKey?t.keyboard_down_mod_cb_list:t.keyboard_down_cb_list,n=0;n<r.length;n++){var a=r[n];a?a(e.keyCode):r.splice(n--,1)}t.prevent_default&&e.preventDefault()}function j(e){for(var t=h(40,e.currentTarget),r=0;r<t.keyboard_up_cb_list.length;r++){var n=t.keyboard_up_cb_list[r];n&&n(e.keyCode)}for(t.prevent_default&&e.preventDefault(),r=0;r<t.keyboard_up_cb_list.length;r++)t.keyboard_up_cb_list[r]||t.keyboard_up_cb_list.splice(r,1)}function z(e){for(var t=h(50,e.currentTarget),r=0;r<t.touch_start_cb_list.length;r++){var n=t.touch_start_cb_list[r];n&&n(e.targetTouches)}for(r=0;r<t.touch_start_cb_list.length;r++)t.touch_start_cb_list[r]||t.touch_start_cb_list.splice(r,1)}function Q(e){for(var t=h(50,e.currentTarget),r=0;r<t.touch_move_cb_list.length;r++){var n=t.touch_move_cb_list[r];n&&n(e.targetTouches)}for(t.prevent_default&&e.preventDefault(),r=0;r<t.touch_move_cb_list.length;r++)t.touch_move_cb_list[r]||t.touch_move_cb_list.splice(r,1)}function V(e){for(var t=h(50,e.currentTarget),r=0;r<t.touch_end_cb_list.length;r++){var n=t.touch_end_cb_list[r];n&&n(e.targetTouches)}for(r=0;r<t.touch_end_cb_list.length;r++)t.touch_end_cb_list[r]||t.touch_end_cb_list.splice(r,1)}function q(e){switch(e){case 0:var t=60;break;case 1:t=70;break;case 2:t=80;break;case 3:t=90;break;default:t=60}return t}function W(e,t){return e.gamepad_mapping[t]}function J(){return!!(window.document.fullscreenEnabled||window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled)}t.can_use_device=A,t.init=function(){if("HMD"==_.stereo||"NONE"==_.stereo&&_.is_mobile_device){var e=h(20);e&&document.addEventListener("onvrdisplayconnect",(function(t){e.webvr_display=t.display,e.registered=!0,e.webvr_display.getFrameData(e.frame_data)}))}},t.get_device_by_type_element=h,t.request_register_device=v,t.switch_prevent_default=function(e,t){e.prevent_default=t},t.reset_device=function(e){switch(e.type){case 20:if(e.registered)if(e.webvr_display)e.webvr_display.resetPose();else if(e.webvr_sensor_devices)for(var t=0;t<e.webvr_sensor_devices.length;t++)e.webvr_sensor_devices[t].resetSensor();break;default:return void o.error("reset_device() is undefined for device: ",e.type)}},t.get_vector_param=function(e,t,r){switch(t){case 10:return function(e,t){switch(e.type){case 20:if(ch(Mg,t),e.webvr_display)t[0]=e.orientation[0],t[1]=e.orientation[1],t[2]=e.orientation[2],t[3]=e.orientation[3];else if(e.webvr_sensor_devices)for(var r=0;r<e.webvr_sensor_devices.length;r++){var n=e.webvr_sensor_devices[r],a=n.getState&&n.getState()||n.getImmediateState&&n.getImmediateState();a.orientation&&(t[0]=a.orientation.x,t[1]=a.orientation.y,t[2]=a.orientation.z,t[3]=a.orientation.w)}return t;default:return o.error("orientation_quat is undefined for device: ",e.type),t}}(e,r);case 20:return function(e,t){switch(e.type){case 20:if(ch(xg,t),e.webvr_display)t[0]=e.position[0],t[1]=e.position[1],t[2]=e.position[2];else if(e.webvr_sensor_devices)for(var r=0;r<e.webvr_sensor_devices.length;r++){var n=e.webvr_sensor_devices[r],a=n.getState&&n.getState()||n.getImmediateState&&n.getImmediateState();a.position&&(t[0]=a.position.x,t[1]=-a.position.z,t[2]=a.position.y)}return t;default:return o.error("position is undefined for device: ",e.type),t}}(e,r);case 21:return O(e,"left",r);case 22:return O(e,"right",r);case 30:return N(e,"left",r);case 31:return N(e,"right",r);case 40:case 41:return r[0]=e.mouse_location[0],r[1]=e.mouse_location[1],r}},t.get_value_param=R,t.set_config=function(e,t,r){switch(e.type){case 20:if(8&R(e,0))break;switch(t){case 24:e.distortion_coefs[0]=r[0],e.distortion_coefs[1]=r[1];break;case 23:e.inter_lens_dist=r,g(e);break;case 25:e.base_line_dist=r,g(e);break;case 26:e.screen_to_lens_dist=r,g(e);break;case 27:e.width_dist=r,g(e);break;case 28:e.height_dist=r,g(e);break;case 29:e.bevel_size=r,g(e)}break;case 60:case 70:case 80:case 90:e.gamepad_mapping[t]=r}},t.get_gamepad_btn_value=function(e,t){var r=t-300;return r<e.gamepad_btns.length&&e.gamepad_btns[W(e,r)-300]},t.get_gamepad_axis_value=function(e,t){return t-326<e.gamepad_axes.length?e.gamepad_axes[W(e,t-300)-326]:0},t.get_gamepad_position=function(e,t){return t.set(e.position),t},t.get_gamepad_orientation=function(e,t){return t.set(e.orientation),t},t.update=function(e){for(var t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],r=0;r<S.length;r++){var n=S[r];switch(n.type){case 60:y(n),b(t[0],n);break;case 70:y(n),b(t[1],n);break;case 80:y(n),b(t[2],n);break;case 90:y(n),b(t[3],n);break;case 20:I(n)}}},t.attach_param_cb=function(e,t,r){switch(t){case 130:e.orientation_quat_cb_list.push(r),t=141;break;case 140:e.orientation_angles_cb_list.push(r),t=141;break;case 50:e.mouse_down_which_cb_list.push(r);break;case 40:case 41:e.mouse_location_cb_list.push(r);break;case 60:e.mouse_up_which_cb_list.push(r);break;case 70:e.mouse_wheel_cb_list.push(r);break;case 90:e.keyboard_down_cb_list.push(r);break;case 91:e.keyboard_down_mod_cb_list.push(r),t=90;break;case 80:e.keyboard_up_cb_list.push(r);break;case 100:e.touch_start_cb_list.push(r);break;case 110:e.touch_move_cb_list.push(r);break;case 120:e.touch_end_cb_list.push(r)}-1==e.registered_event_listeners.indexOf(t)&&(e.registered_event_listeners.push(t),e.registered&&function(e,t){switch(t){case 50:x()||e.element.addEventListener("mousedown",F,!1);break;case 40:e.element.addEventListener("mousemove",k,!1);break;case 41:e.element.addEventListener("mousemove",D,!1);break;case 60:x()||(e.element!=window&&e.element.addEventListener("mouseout",G,!1),e.element.addEventListener("mouseup",K,!1));break;case 70:e.element.addEventListener("wheel",X,!1);break;case 90:e.element.addEventListener("keydown",H,!1);break;case 80:e.element.addEventListener("keyup",j,!1);break;case 100:e.element.addEventListener("touchstart",z,!1);break;case 110:e.element.addEventListener("touchmove",Q,!1);break;case 120:e.element.addEventListener("touchend",V,!1);break;case 141:e.element.addEventListener("deviceorientation",w,!1)}}(e,t))},t.detach_param_cb=function(e,t,r){M(e,t,r,!1)},t.gyro_angles_to_quat=C,t.cleanup=function(){for(var e=0;e<S.length;e++)for(var t=S[e],r=0;r<t.registered_event_listeners.length;r++)M(t,t.registered_event_listeners[r],null,!0);S.length=0},t.get_pressed_gmpd_btn=function(e){for(var t=h(q(e)),r=0;r<t.gamepad_btns.length;r++)if(t.gamepad_btns[r])return r+300;return-1},t.get_moved_gmpd_axis=function(e){for(var t=h(q(e)),r=0;r<t.gamepad_axes.length;r++)if(t.gamepad_prev_axes[r]-t.gamepad_axes[r])return r+326;return-1},t.get_first_gmpd_id=function(){for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],t=0;t<e.length;t++)if(e[t])return t;return 0},t.get_webvr_display=function(){var e=h(20);return e&&e.webvr_display},t.activate_pointerlock=function(e){e.element.addEventListener("mousedown",(function(t){e.value||function(e){var t=e.element,r=function r(){document.pointerLockElement===t||document.webkitPointerLockElement===t||document.mozPointerLockElement===t?e.value=1:(e.value=0,document.removeEventListener("pointerlockchange",r,!1),document.removeEventListener("webkitpointerlockchange",r,!1),document.removeEventListener("mozpointerlockchange",r,!1))};document.addEventListener("pointerlockchange",r,!1),document.addEventListener("webkitpointerlockchange",r,!1),document.addEventListener("mozpointerlockchange",r,!1);var n=t.requestPointerLock||t.webkitRequestPointerLock||t.mozRequestPointerLock;"function"==typeof n&&n.apply(t)}(e)}),!1)},t.add_click_listener=function(e,t){e.addEventListener(_.is_mobile_device?"touchend":"mouseup",t)},t.remove_click_listener=function(e,t){e.removeEventListener(_.is_mobile_device?"touchend":"mouseup",t)},t.check_fullscreen=J})),RI=nA("__prerender",(function(e,t){var r=vR(e),n=VR(e),a=KI(e),o=tI(e),_=mR(e),i=[_.MAIN_OPAQUE,_.MAIN_BLEND,_.MAIN_PLANE_REFLECT,_.MAIN_CUBE_REFLECT,_.MAIN_PLANE_REFLECT_BLEND,_.MAIN_CUBE_REFLECT_BLEND,_.MAIN_GLOW,_.MAIN_XRAY,_.SHADOW_CAST,_.SHADOW_RECEIVE,_.OUTLINE_MASK,_.DEBUG_VIEW,_.COLOR_PICKING,_.COLOR_PICKING_XRAY],s=new Float32Array(3);function l(e){e.sort(c)}function c(e,t){return e.z_index-t.z_index}function E(e,t){if(e.world_bounds){var r=e.world_bounds.bs;return vh(r.center,t)+r.radius*r.radius}return 1/0}function u(e,t){var n=e.obj_render;if(n.is_visible=!1,n.hide)return!1;var o=t.camera;if(t.type==_.SHADOW_CAST)var i=o.lod_eye;else i=jm(o.world_tsr,s);var l,c,E,u,d,T=e.batch;return!!a.update_lod_visibility(T,n,i)&&(n.is_visible=!0,t.type==_.DEBUG_VIEW?t.debug_view_mode==r.DV_BOUNDINGS?T.debug_sphere:!T.debug_sphere:!(t.type==_.OUTLINE_MASK&&0==n.outline_intensity||!T.do_not_cull&&e.world_bounds&&(l=o.frustum_planes,c=e.world_bounds.bs,E=e.world_bounds.be,u=T.use_be,d=c.center,function(e,t,r){return r<-tv(e,t.near)||r<-tv(e,t.left)||r<-tv(e,t.right)||r<-tv(e,t.top)||r<-tv(e,t.bottom)||r<-tv(e,t.far)}(d,l,c.radius)||u&&function(e,t,r,n,a){var o=Ih(r,t.far),_=Ih(n,t.far),i=Ih(a,t.far),s=Math.sqrt(o*o+_*_+i*i);return s<-tv(e,t.near)||s<-tv(e,t.far)||(o=Ih(r,t.left),_=Ih(n,t.left),i=Ih(a,t.left),Math.sqrt(o*o+_*_+i*i)<-tv(e,t.left)||(o=Ih(r,t.right),_=Ih(n,t.right),i=Ih(a,t.right),Math.sqrt(o*o+_*_+i*i)<-tv(e,t.right)||(o=Ih(r,t.top),_=Ih(n,t.top),i=Ih(a,t.top),Math.sqrt(o*o+_*_+i*i)<-tv(e,t.top)||(o=Ih(r,t.bottom),_=Ih(n,t.bottom),i=Ih(a,t.bottom),Math.sqrt(o*o+_*_+i*i)<-tv(e,t.bottom)))))}(d=E.center,l,E.axis_x,E.axis_y,E.axis_z))))}function d(e){var t=e.particles_data;if(t&&t.need_buffers_update){var r=e.bufs_data;n.make_dynamic(r);var a=r.pointers;n.vbo_source_data_set_attr(r.vbo_source_data,"a_position",t.positions_cache,a.a_position.offset),n.vbo_source_data_set_attr(r.vbo_source_data,"a_tbn",t.tbn_cache,a.a_tbn.offset),n.update_gl_buffers(r)}}t.prerender_subs=function(e){if(i.indexOf(e.type)>-1){for(var t=!1,r=e.type==_.MAIN_CUBE_REFLECT||e.type==_.MAIN_CUBE_REFLECT_BLEND,n=e.draw_data,a=0;a<n.length;a++){for(var c=n[a],T=c.bundles,f=!1,p=0;p<T.length;p++){var P=(h=T[p]).batch;if(r)for(var S=0;S<6;S++)e.camera.frustum_planes=e.cube_cam_frustums[S],h.do_render_cube[S]=u(h,e),h.do_render_cube[S]&&(t=!0,f=!0,d(P));else h.do_render=u(h,e),h.do_render&&(t=!0,f=!0,d(P));if(e.need_perm_uniforms_update&&(P.shader.need_uniforms_update=!0),h.do_render){var A=E(h,jm(e.camera.world_tsr,s));h.z_index=A}else h.z_index=1/0}T.length>0&&!T[0].batch.blend&&(l(T),n.z_index=T[0].z_index),c.do_render=f}switch(e.need_perm_uniforms_update=!1,e.type){case _.DEBUG_VIEW:break;default:e.type==_.MAIN_OPAQUE||e.type==_.SHADOW_RECEIVE||e.type==_.MAIN_GLOW||e.type==_.MAIN_PLANE_REFLECT||e.type==_.MAIN_CUBE_REFLECT||t?e.do_render=!0:(e.do_render&&o.clear(e),e.do_render=!1)}}else if(e.need_perm_uniforms_update){for(n=e.draw_data,a=0;a<n.length;a++)for(T=n[a].bundles,p=0;p<T.length;p++){var h;(P=(h=T[p]).batch).shader.need_uniforms_update=!0}e.need_perm_uniforms_update=!1}e.need_draw_data_sort&&_.sort_draw_data(e)}})),II=nA("__primitives",(function(e,t){var r=gN(e),n=dR(e),a=VR(e),o=n.defaults;function _(e,t,r,n){for(var o=[],_=[],i=[],s=e*t,l=2*r/(e-1),c=2*n/(t-1),E=0;E<e;E++)for(var u=E*l-r,d=0;d<t;d++)if(_.push(u,d*c-n,0),i.push(E/(e-1),d/(t-1)),E&&d){var T=E*t+d,f=T-1,p=(E-1)*t+d,P=p-1;o.push(T,f,p),o.push(f,P,p)}var S=a.create_empty_va_frame();S.a_position=new Float32Array(_),S.a_tbn=DR(s);var A=a.init_submesh("GRID_PLANE");return A.va_frames[0]=S,A.va_common.a_texcoord=new Float32Array(i),A.indices=new Uint32Array(o),A.base_length=_.length/3,A}function i(e){var t=e.length;t%4&&r.panic("Wrong array");for(var n=[],o=[],_=0;_<t;_+=4){var i=e[_+1],s=e[_+2],c=e[_+3];l(e[_],o),l(i,o),l(s,o),l(c,o),n.push(_,_+1,_+2),n.push(_,_+2,_+3)}var E=a.create_empty_va_frame();E.a_position=new Float32Array(o),E.a_tbn=DR(t/4);var u=a.init_submesh("FROM_QUADS");return u.va_frames[0]=E,u.indices=new Uint32Array(n),u.base_length=o.length/3,u}function s(e,t){var r=3*t;return[e[r],e[r+1],e[r+2]]}function l(e,t){t.push(e[0],e[1],e[2])}t.generate_line=function(){var e=a.init_submesh("LINE"),t=a.create_empty_va_frame();return t.a_position=new Float32Array(3),t.a_direction=new Float32Array(3),e.va_frames[0]=t,e.indices=new Uint32Array(1),e.base_length=1,e},t.generate_plane=function(e,t){var r=_(2,2,e,t);return r.name="PLANE",r},t.generate_grid=_,t.generate_cascaded_grid=function(e,t,r){var n=r/Math.pow(2,e-1),_=n,i=n,s=t+1,l=t+1,c=[],E=[],u=0,d=0,T=0,f=-1;function p(e,t){return e%2==1&&(0==t||t==l-1)||t%2==1&&(0==e||e==s-1)}for(var P=[],S=0;S<e;S++){for(var A=2*_/(s-1),h=2*i/(l-1),v=[],m=[],g=0;g<s;g++){for(var O=g*A-_,N=[],R=0;R<l;R++){var I=R*h-i;if(O>-d&&O<d&&I>-T&&I<T)N.push(-1);else{for(var b=null,y=0;y<P.length;y+=3)if(O==P[y]&&I==P[y+1]){b=P[y+2];break}if(null!==b)var L=b;else L=f+1;if(p(g,R))N.push(-2);else{if(null==b){if(0==R||R==l-1||0==g||g==s-1){if(S==e-1)var Y=A;else Y=2*A;v.push(O,I,L)}else Y=A;E.push(O,I,Y),u++,f++}N.push(L)}if(g&&R)if(1==g)p(g-1,R)?R>1?(c.push(M=(w=m[g-1][R+1])-1,C=L-1,L),c.push(w,M,L)):c.push(w=m[g-1][R+1],M=w-1,L):p(g,R)||c.push(w=m[g-1][R],C=L-1,L);else if(g==s-1){if(!p(g,R))if(R==l-1){var M=m[g-2][R];c.push(w=m[g-1][R-1],C=L-1,L),c.push(M,w,L)}else{var x=(w=m[g-1][R])+1;c.push(M=w-1,C=L-1,L),c.push(w,M,L),c.push(x,w,L),2==R&&c.push(M,x=m[g-2][R-2],C)}}else if(1==R)p(g,R-1)?c.push(C=m[g-1][R],w=m[g-1][R-1],L):(M=m[g-2][R-1],c.push(w=m[g-1][R],C=N[R-1],L),c.push(w,M,C));else if(R==l-1)p(g,R)||(M=m[g-2][R],c.push(w=m[g-1][R-1],C=N[R-1],L),c.push(M,w,L));else if(-1!=m[g-1][R]&&-1!=m[g-1][R-1]&&-1!=N[R-1]){var C;M=m[g-1][R-1],c.push(w=m[g-1][R],C=N[R-1],L),c.push(w,M,C),R==l-2&&p(g,R+1)&&c.push(x=m[g-1][R+1],w,L)}else if(R==l-2&&p(g,R+1)){var w;c.push(x=m[g-1][R+1],w=m[g-1][R],L)}}}m.push(N)}P=v,d=_,T=i,_*=2,i*=2}if(d<2e4){var U=-2*d/(s-1);E.push(-2e4,-2e4,U),E.push(-2e4,2e4,U),E.push(-d,-T,U),E.push(-d,T,U),E.push(2e4,-2e4,U),E.push(2e4,2e4,U),E.push(d,-T,U),E.push(d,T,U),c.push((L=f+1)+1,L+2,L+3,L+1,L+0,L+2,L+2,L+4,L+6,L+2,L+0,L+4,L+1,L+7,L+5,L+1,L+3,L+7,L+7,L+4,L+5,L+6,L+4,L+7),u+=8}var k=a.create_empty_va_frame();k.a_position=new Float32Array(E),k.a_tbn=DR(u),XR(k.a_tbn,[.707,0,0,.707],k.a_tbn);var D=a.init_submesh("MULTIGRID_PLANE");return D.va_frames[0]=k,D.indices=new Uint32Array(c),D.base_length=E.length/3,o.water_wireframe_debug&&(a.submesh_drop_indices(D,1,!0),k.a_polyindex=a.extract_polyindices(D)),D},t.generate_from_triangles=function(e){var t=e.length;t%3&&r.panic("Wrong array");for(var n=[],o=[],_=0;_<t;_+=3){var i=e[_+1],s=e[_+2];l(e[_],o),l(i,o),l(s,o),n.push(_,_+1,_+2)}var c=a.create_empty_va_frame();c.a_position=new Float32Array(o);var E=a.init_submesh("FROM_TRIANGLES");return E.va_frames[0]=c,E.indices=new Uint32Array(n),E.base_length=o.length/3,E},t.generate_from_quads=i,t.generate_frustum=function(e){e=function(e,t){t||(t=[]);for(var r=0;r<e.length;r+=3){var n=new Float32Array([e[r],e[r+1],e[r+2]]);t[r/3]=n}return t}(e,[]);var t=[];t.push(e[0],e[1],e[2],e[3]),t.push(e[0],e[3],e[5],e[4]),t.push(e[3],e[2],e[6],e[5]),t.push(e[1],e[7],e[6],e[2]),t.push(e[0],e[4],e[7],e[1]),t.push(e[4],e[5],e[6],e[7]);var r=i(t);return r.name="FRUSTUM",r},t.generate_fullscreen_tri=function(){var e=a.init_submesh("FULLSCREEN_TRI"),t=a.create_empty_va_frame();return t.a_position=new Float32Array([0,0,1,0,0,1]),e.va_frames[0]=t,e.indices=new Uint32Array([0,1,2]),e.base_length=3,e},t.generate_fullscreen_quad=function(){var e=a.init_submesh("FULLSCREEN_QUAD"),t=a.create_empty_va_frame();return t.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]),e.va_frames[0]=t,e.indices=new Uint32Array([0,2,1,1,2,3]),e.base_length=4,e},t.generate_billboard=function(){var e=a.init_submesh("BILLBOARD"),t=a.create_empty_va_frame();return t.a_bb_vertex=a.gen_bb_vertices(1),e.va_frames[0]=t,e.indices=new Uint32Array([0,2,1,0,3,2]),e.base_length=4,e},t.generate_uv_sphere=function(e,t,r,n,o,_){var i,c,E=a.init_submesh("UV_SPHERE"),u=[],d=[],T=[];for(c=0;c<=t;c++)for(i=0;i<=e;i++){var f=i/e,p=c/t,P=-r*Math.cos(2*f*Math.PI)*Math.sin(p*Math.PI),S=r*Math.cos(p*Math.PI),A=r*Math.sin(2*f*Math.PI)*Math.sin(p*Math.PI);o&&(P=Math.abs(P)<1e-5?0:P,S=Math.abs(S)<1e-5?0:S,A=Math.abs(A)<1e-5?0:A),d.push(P+n[0],S+n[1],A+n[2])}var h=0;for(c=0;c<t;c++)for(i=0;i<e;i++){var v=s(d,(e+1)*c+i+1),m=s(d,(e+1)*c+i),g=s(d,(e+1)*(c+1)+i),O=s(d,(e+1)*(c+1)+i+1);Math.abs(v[1])==r+n[1]?(l(v,u),l(g,u),l(O,u),_?T.push(h,h+1,h+1,h+2,h+2,h):T.push(h,h+1,h+2),h+=3):Math.abs(g[1])==r+n[1]?(l(v,u),l(m,u),l(g,u),_?T.push(h,h+1,h+1,h+2,h+2,h):T.push(h,h+1,h+2),h+=3):(l(v,u),l(m,u),l(g,u),l(O,u),_?(T.push(h,h+1),T.push(h+1,h+2),T.push(h+2,h+3),T.push(h+3,h)):(T.push(h,h+1,h+2),T.push(h,h+2,h+3)),h+=4)}var N={};if(N.a_position=u,_)N.a_tbn=DR();else{var R=a.calc_shared_indices(T,d,u),I=a.calc_normals(T,u,R);N.a_tbn=YR(I)}return E.va_frames[0]=N,E.indices=T,E.base_length=u.length/3,E},t.generate_index=function(e){var t=a.init_submesh("INDEX"),r=a.create_empty_va_frame();r.a_index=new Float32Array(3*e);for(var n=new Uint16Array(3*e),o=0;o<3*e;o++)r.a_index[o]=o,n[o]=o;return t.va_frames[0]=r,t.indices=n,t.base_length=3*e,t}})),bI=nA("__scenegraph",(function(e,t){var r=gN(e),n=pb(e),a=dR(e),o=HI(e),_=vR(e),i=TR(e),s=pR(e),l=tI(e),c=mR(e),E=XI(e),u=a.debug_subs,d=a.defaults,T=a.scenes,f=[c.GRASS_MAP,c.SHADOW_CAST,c.MAIN_CUBE_REFLECT,c.MAIN_CUBE_REFLECT_BLEND];function p(e,t){var r=[];s.traverse_edges(e,(function(t,n,a){var o=a;r.indexOf(o)>-1?s.replace_edge_attr(e,t,n,o,C(o)):r.push(o)})),s.traverse(e,(function(e,n){for(var a=n,o=0;o<a.slinks_internal.length;o++){var _=a.slinks_internal[o];t||a.type!=c.MAIN_PLANE_REFLECT&&a.type!=c.MAIN_CUBE_REFLECT&&a.type!=c.MAIN_XRAY||(_.use_renderbuffer=!0),r.indexOf(_)>-1?a.slinks_internal[o]=C(_):r.push(_)}}))}function P(e,t){s.traverse(e,(function(r,n){n.type==c.ANTIALIASING&&s.traverse_inputs(e,r,(function(e,t,r){var n=t;if(n.type==c.MOTION_BLUR)for(var a=0;a<n.slinks_internal.length;a++){var o=n.slinks_internal[a];o.min_filter=E.TF_LINEAR,o.mag_filter=E.TF_LINEAR}})),t||s.traverse_inputs(e,r,(function(e,t,r){"DEPTH"==r.from&&(r.use_renderbuffer=!0)}))})),s.traverse(e,(function(t,r){var n={};for(var a in function e(t,r,n){s.traverse_inputs(t,r,(function(r,a,o){var _=o;_.active&&_.from==_.to&&(n[_.from]=n[_.from]||[],-1==n[_.from].indexOf(_)&&n[_.from].push(_),e(t,r,n))})),s.traverse_outputs(t,r,(function(e,t,r){var a=r;a.active&&(n[a.from]=n[a.from]||[],-1==n[a.from].indexOf(a)&&n[a.from].push(a))}));var a=s.get_node_attr(t,r);if(a.type==c.MOTION_BLUR)for(var o=0;o<a.slinks_internal.length;o++){var _=a.slinks_internal[o];n[_.from].push(_)}}(e,t,n),n){for(var o=n[a],_=o[0],i=0;i<o.length;i++)if(o[i].min_filter==E.TF_LINEAR){_=o[i];break}var l=o[0];for(i=0;i<o.length;i++)if(o[i].mag_filter==E.TF_LINEAR){l=o[i];break}var u=o[0];for(i=0;i<o.length;i++)if(!o[i].use_renderbuffer){u=o[i];break}for(i=0;i<o.length;i++)o[i].min_filter=_.min_filter,o[i].mag_filter=l.mag_filter,o[i].use_renderbuffer=u.use_renderbuffer}}))}function S(e){var t=[c.MOTION_BLUR,c.SMAA_RESOLVE,c.SMAA_NEIGHBORHOOD_BLENDING,c.MAIN_PLANE_REFLECT,c.MAIN_CUBE_REFLECT,c.PERFORMANCE];d.webgl2||t.push(c.AVERAGE_LUMINANCE);var r=s.topsort(e),n=[];s.traverse(r,(function(e,a){for(var o=a,_=0;_<o.slinks_internal.length;_++){var i=o.slinks_internal[_];t.indexOf(o.type)>-1&&(i.unique_texture=!0);var l=m(n,i,A(i));i.texture=l,o.textures_internal[_]=l}for(_=0;_<o.textures_internal.length;_++)v(n,l=o.textures_internal[_]);s.traverse_outputs(r,e,(function(a,_,i){var l=i;if(!l.texture){if(t.indexOf(o.type)>-1)l.unique_texture=!0;else{var c=function(e,t,r){var n=null;return s.traverse_inputs(e,t,(function(e,t,a){if(a.active&&a.from==a.to&&a.from==r&&a.texture)return n=a.texture,!0})),s.traverse_outputs(e,t,(function(e,t,a){if(a.active&&a.from==r&&a.texture)return n=a.texture,!0})),n}(r,e,l.from);if(c&&l.active&&!l.texture)return h(n,c),void(l.texture=c)}c=m(n,l,A(l)),l.texture=c}})),s.traverse_inputs(r,e,(function(e,t,r){v(n,r.texture)})),s.traverse_outputs(r,e,(function(e,t,r){r.texture&&"NONE"==r.to&&v(n,r.texture)}))}))}function A(e){var t=e.to,r=e.active,n=e.texture;e.to="",e.active=!1,e.texture=null;var a=i.calc_variable_id(e,0);return e.to=t,e.active=r,e.texture=n,a}function h(e,t){for(var r=0;r<e.length;r++){var n=e[r];n.tex===t&&n.ref++}}function v(e,t){for(var r=0;r<e.length;r++){var n=e[r];n.tex===t&&n.ref&&n.ref--}}function m(e,t,r){if(t.parent_slink)return h(e,t.parent_slink.texture),t.parent_slink.texture;if(t.unique_texture)return g(t);for(var n=null,a=0;a<e.length;a++){var o=e[a];if(o.id==r&&0===o.ref){n=o;break}}if(n&&!d.firefox_tex_reuse_hack)return n.ref++,n.tex;var _=g(t);return e.push({id:r,ref:1,tex:_}),_}function g(e){var t=e.size_mult_x*e.size,n=e.size_mult_y*e.size,a=e.use_comparison,o=e.use_mipmap;switch(e.from){case"COLOR":if(e.use_renderbuffer){var _=E.create_texture(e.multisample?E.TT_RB_RGBA_MS:E.TT_RB_RGBA,a,o);E.resize(_,t,n)}else _=E.create_texture(e.floating_point?E.TT_RGBA_FLOAT:E.TT_RGBA_INT,a,o),E.resize(_,t,n),E.set_filters(_,e.min_filter,e.mag_filter);return _;case"DEPTH":return e.use_renderbuffer?(_=E.create_texture(e.multisample?E.TT_RB_DEPTH_MS:E.TT_RB_DEPTH,a,o),E.resize(_,t,n)):(_=E.create_texture(E.TT_DEPTH,a,o),E.resize(_,t,n),E.set_filters(_,e.min_filter,e.mag_filter)),_;case"CUBEMAP":return E.create_cubemap_texture(t,o);case"SCREEN":case"NONE":return null;default:r.panic("Wrong slink param: "+e.from)}}function O(e,t){var r=!1;s.traverse_edges(e,(function(n,a,o){var _=o;if(_){var i=s.get_node_attr(e,n),l=s.get_node_attr(e,a);return t(_,!1,i,l)?(r=!0,!0):void 0}})),r||s.traverse(e,(function(e,r){for(var n=r,a=0;a<n.slinks_internal.length;a++)if(t(n.slinks_internal[a],!0,n,null))return!0}))}function N(e){s.traverse(e,(function(t,r){if(r.type!=c.SINK){var a=r.camera;s.traverse_outputs(e,t,(function(e,t,r){r.texture&&r.active&&r.texture&&(n.set_attachment(a,r.from,r.texture),r.from==r.to&&t.camera&&n.set_attachment(t.camera,r.from,r.texture))}));for(var o=0;o<r.slinks_internal.length;o++){var _=r.slinks_internal[o];_.active&&_.from==_.to&&n.set_attachment(a,_.from,r.textures_internal[o])}!a.color_attachment&&!a.depth_attachment||a.framebuffer||(a.framebuffer=l.render_target_create(a.color_attachment,a.depth_attachment))}})),s.traverse(e,(function(t,r){if(r.type==c.RESOLVE||r.type==c.COPY){var n=U(e,r);r.camera.framebuffer_prev=n[0].camera.framebuffer}}))}function R(e,t,r,a,o,_,i,l){var u=i.cameras[0],d=r.lamps_number,T=r.water_params,f=r.world_fog_set,p=r.world_light_set,P=_.reflect_links_opaque,S=_.reflect_subscenes,A=o.subs_grass_map,h=o.slink_grass_map_d,v=o.slink_grass_map_c;if(e&&e.refl_plane_objs.length>0&&!l)for(var m=0;m<e.refl_plane_objs.length;m++){var g=n.clone_camera(u,!0);g.reflection_plane=new Float32Array(4),i.cameras.push(g);var O=c.create_subs_main(c.MAIN_PLANE_REFLECT,g,!1,T,d,f,p,null,r.sun_exist);O.refl_obj=e.refl_plane_objs[m],s.append_node_attr(a,O);var N=x("COLOR","u_plane_reflection",1,r.plane_refl_size,r.plane_refl_size,!0,!0);if(N.min_filter=E.TF_LINEAR,N.mag_filter=E.TF_LINEAR,P.push(N),e!=t){var R=x("COLOR","u_plane_reflection",1,r.plane_refl_size,r.plane_refl_size,!0,!0);R.min_filter=E.TF_LINEAR,R.mag_filter=E.TF_LINEAR,_.reflect_links_blend.push(R)}if(A&&(s.append_edge_attr(a,A,O,h),s.append_edge_attr(a,A,O,v)),e.has_blend_reflexible||t.has_blend_reflexible){var I=c.create_subs_main(c.MAIN_PLANE_REFLECT_BLEND,g,!1,T,d,f,p,null,r.sun_exist);I.refl_obj=e.refl_plane_objs[m],s.append_node_attr(a,I);var b=x("DEPTH","DEPTH",1,r.plane_refl_size,r.plane_refl_size,!0,!0),y=x("COLOR","COLOR",1,r.plane_refl_size,r.plane_refl_size,!0,!0);y.min_filter=E.TF_NEAREST,y.mag_filter=E.TF_NEAREST,s.append_edge_attr(a,O,I,b),s.append_edge_attr(a,O,I,y),t.plane_refl_subs_blend.push([I]),S.push(I),A&&(s.append_edge_attr(a,A,I,h),s.append_edge_attr(a,A,I,v))}else{var L=x("DEPTH","DEPTH",1,r.plane_refl_size,r.plane_refl_size,!0,!0);O.slinks_internal.push(L),S.push(O)}t.plane_refl_subs.push([O])}}function I(e,t,r,a,o,_,i){var l=r.lamps_number,u=r.water_params,d=r.world_fog_set,T=r.world_light_set,f=o.subs_grass_map,p=o.slink_grass_map_d,P=o.slink_grass_map_c,S=_.cube_reflect_links,A=_.cube_refl_subscenes;if(e&&e.refl_cube_objs.length&&!i)for(var h=0;h<e.refl_cube_objs.length;h++){var v=n.create_camera(n.TYPE_PERSP);v.width=r.cubemap_refl_size,v.height=r.cubemap_refl_size,n.set_frustum(v,Math.PI/2,.1,100),n.set_projection(v,!1);var m=c.create_subs_main(c.MAIN_CUBE_REFLECT,v,!1,u,l,d,T,null,r.sun_exist);m.refl_obj=e.refl_cube_objs[h],m.cube_view_matrices=hO();for(var g=0;g<6;g++)m.cube_cam_frustums.push(n.create_frustum_planes());s.append_node_attr(a,m);var O=x("CUBEMAP","u_cube_reflection",r.cubemap_refl_size,1,1,!1,!1);if(O.min_filter=E.TF_LINEAR,O.mag_filter=E.TF_LINEAR,S.push(O),e!=t){var N=x("CUBEMAP","u_cube_reflection",r.cubemap_refl_size,1,1,!1,!1);N.min_filter=E.TF_LINEAR,N.mag_filter=E.TF_LINEAR,_.cube_reflect_links_blend.push(N)}if(e==t&&!e.has_reflexible){var R=x("CUBEMAP","u_sky_reflection",1,1,1,!1);R.use_mipmap=!0,R.min_filter=E.TF_LINEAR_MIPMAP_LINEAR,R.mag_filter=E.TF_LINEAR,sky_reflect_links.push(R)}if(f&&(s.append_edge_attr(a,f,m,p),s.append_edge_attr(a,f,m,P)),e.has_blend_reflexible||t.has_blend_reflexible){var I=c.create_subs_main(c.MAIN_CUBE_REFLECT_BLEND,v,!1,u,l,d,T,null,r.sun_exist);I.refl_obj=e.refl_cube_objs[h],I.cube_view_matrices=m.cube_view_matrices,I.cube_cam_frustums=m.cube_cam_frustums,s.append_node_attr(a,I);var b=x("DEPTH","DEPTH",r.cubemap_refl_size,1,1,!1,!1),y=x("COLOR","COLOR",r.cubemap_refl_size,1,1,!1,!1);s.append_edge_attr(a,m,I,b),s.append_edge_attr(a,m,I,y),A.push(I),t.cube_refl_subs_blend.push(I),f&&(s.append_edge_attr(a,f,I,p),s.append_edge_attr(a,f,I,P))}else{var L=x("DEPTH","DEPTH",r.cubemap_refl_size,1,1,!1,!1);m.slinks_internal.push(L),A.push(m)}t.cube_refl_subs.push(m)}}t.check_slink_tex_conn=function(e){switch(e.to){case"COLOR":case"CUBEMAP":case"DEPTH":case"SCREEN":case"OFFSCREEN":case"RESOLVE":case"COPY":case"NONE":return!1;default:return!0}},t.traverse_slinks=O,t.update_rendering_graph=function(e,t,r,n,a){var o=e.graph,_=a.reflection_params,i=e.reflection_params,l=[],f=[],A=[],h=[],v=[],m=[];if(e.dynamic_grass){var g=c.create_subs_grass_map();s.append_node_attr(o,g);var O=T.grass_tex_size;g.camera.width=O,g.camera.height=O;var M=x("DEPTH","u_grass_map_depth",O,1,1,!1,!1);d.webgl2||(M.min_filter=E.TF_LINEAR,M.mag_filter=E.TF_LINEAR),(C=x("COLOR","u_grass_map_color",O,1,1,!1,!1)).min_filter=E.TF_LINEAR,C.mag_filter=E.TF_LINEAR}else{g=null,M=null;var C=null}var w={subs_grass_map:g,slink_grass_map_d:M,slink_grass_map_c:C};I(_,i,e,o,w,{cube_reflect_links:A,cube_refl_subscenes:m,cube_reflect_links_blend:h}),R(_,i,e,o,w,{reflect_links_opaque:l,reflect_subscenes:v,reflect_links_blend:f},t);var U=function(e,t,r){if(e.length)for(var n=0;n<e.length;n++)s.append_edge_attr(o,e[n],t,r[n])};U(m,b,A),U(m,y,h),U(v,b,l),U(v,y,f),e.queue=[];var k=e.depth_tex;if(p(o,k),P(o,k),u.enabled){var D=L(o);D&&Y(o,D)}S(o),N(o)};var b=null,y=null;function L(e){var t=null,r=0;return s.traverse(e,(function(e,n){if(n.type==u.subs_type){if(r==u.subs_number)return t=n,!0;r++}})),t}function Y(e,t){var r=s.node_by_attr(e,t),n=c.create_subs_postprocessing("NONE"),a=s.append_node_attr(e,n),o=s.get_sink_nodes(e)[0];s.traverse_edges(e,(function(t,r,n){r==o&&s.reconnect_edges(e,t,o,t,a)}));var _=function e(t,r){var n=!1,a=s.node_by_attr(r,t);if(s.out_edge_count(r,a)){var o=s.get_out_edge(r,a,0),_=s.get_edge_attr(r,a,o,0);n="COLOR"==_.from&&"COLOR"==_.to||"DEPTH"==_.from&&"DEPTH"==_.to?e(s.get_node_attr(r,o),r):"RESOLVE"==_.to}return n}(t,e);s.traverse_edges(e,(function(a,o,i){if(a==r){if(_){var l=c.create_subs_resolve();s.append_node_attr(e,l);var E=x("COLOR","RESOLVE",1,1,1,!0,!0);E.multisample=!0,E.use_renderbuffer=!0;var d=x("DEPTH","RESOLVE",1,1,1,!0,!0);d.multisample=!0,d.use_renderbuffer=!0,s.append_edge_attr(e,t,l,E),s.append_edge_attr(e,t,l,d),t=l}return s.append_edge_attr(e,t,n,x(u.slink_type,"u_color",i.size,i.size_mult_x,i.size_mult_y,i.update_dim,i.apply_resolution_factors)),!0}})),s.append_edge(e,a,o,x("SCREEN","NONE",.5,.5,.5,!0,!0))}function M(e,t){e.texel_size_multiplier=t}function x(e,t,r,n,a,o,_){return{from:e,to:t,size:r,size_mult_x:n,size_mult_y:a,update_dim:o,apply_resolution_factors:_,active:!0,texture:null,multisample:!1,floating_point:!1,use_renderbuffer:!1,min_filter:E.TF_NEAREST,mag_filter:E.TF_NEAREST,unique_texture:!1,use_comparison:!1,use_mipmap:!1}}function C(e,t){var n=x(e.from,e.to,e.size,e.size_mult_x,e.size_mult_y,e.update_dim,e.apply_resolution_factors);return n.active=e.active,!t&&e.texture&&r.panic("Failed to clone slink with attached texture"),n.texture=e.texture,n.multisample=e.multisample,n.use_renderbuffer=e.use_renderbuffer,n.min_filter=e.min_filter,n.mag_filter=e.mag_filter,n.unique_texture=e.unique_texture,n.use_comparison=e.use_comparison,n.use_mipmap=e.use_mipmap,n}function w(e,t,r){if(t.type==r)return!0;for(var n=k(e,t),a=0;a<n.length;a++)if(w(e,n[a],r))return!0;return!1}function U(e,t){var n=s.node_by_attr(e,t);n==s.NULL_NODE&&r.panic("Subscene not in graph");for(var a=[],o=s.in_edge_count(e,n),_=0;_<o;_++){var i=s.get_in_edge(e,n,_);i!=n&&a.push(s.get_node_attr(e,i))}return a}function k(e,t){var n=s.node_by_attr(e,t);n==s.NULL_NODE&&r.panic("Subscene not in graph");for(var a=[],o=s.out_edge_count(e,n),_=0;_<o;_++){var i=s.get_out_edge(e,n,_);i!=n&&a.push(s.get_node_attr(e,i))}return a}function D(e,t,r,n){var a,o,_="";if(_+=e.from+"\\n",_+="NONE"!=e.to?e.to+"\\n":"",_+="(",e.update_dim){var i=e.size_mult_x,s=e.size_mult_y;Math.round(i)!=i&&(i=i.toFixed(2)),Math.round(s)!=s&&(s=s.toFixed(2)),_+=(1==i?"":i)+"Sx"+(1==s?"":s)+"S",_+=e.apply_resolution_factors?" FACT":" VIEW"}else _+=e.size*(i=e.size_mult_x)+"x"+e.size*(s=e.size_mult_y);if("SCREEN"!=e.from){_+=" ",_+=e.use_renderbuffer?"RR":(o="",(a={min:e.min_filter,mag:e.mag_filter}).min==E.TF_LINEAR?o+="L":a.min==E.TF_NEAREST&&(o+="N"),a.mag==E.TF_LINEAR?o+="L":a.mag==E.TF_NEAREST&&(o+="N"),o);for(var l=0;l<n.length;l+=2)n[l]==e.texture&&(_+=" "+n[l+1])}return _+")\\n"}t.create_rendering_graph=function(e,t,r,a){var i=s.create(),l=[],A=[],h=[],v=[],m=[],g=[],O=[],w=[],D=[],F=e.lamps_number,G=e.water_params,K=e.shore_smoothing,B=e.soft_particles,X=e.ssao,H=e.god_rays,j=e.reflection_params,z=e.materials_params,Q=e.bloom_params,V=e.motion_blur,q=e.compositing,W=e.antialiasing,J=e.world_light_set,Z=e.world_fog_set,$=e.shadow_params,ee=e.mb_params,te=e.cc_params,re=e.god_rays_params,ne=e.outline_params,ae=e.dof,oe=e.depth_tex,_e=e.refractions,ie=Boolean(a.length),se=d.msaa_samples>1;d.reuse_depth_optimization=d.reuse_depth_optimization&&Boolean($)&&!(se&&X);var le=d.reuse_depth_optimization,ce=x("COLOR","COLOR",1,1,1,!0,!0),Ee=x("DEPTH","DEPTH",1,1,1,!0,!0);if(se){var ue=C(Ee);ce.multisample=!0,ce.use_renderbuffer=!0,Ee.multisample=!0,Ee.use_renderbuffer=!0}var de=t.cameras[0];if(e.dynamic_grass){var Te=c.create_subs_grass_map();s.append_node_attr(i,Te),Te.camera.width=ve=T.grass_tex_size,Te.camera.height=ve;var fe=x("DEPTH","u_grass_map_depth",ve,1,1,!1,!1);d.webgl2||(fe.min_filter=E.TF_LINEAR,fe.mag_filter=E.TF_LINEAR),(pe=x("COLOR","u_grass_map_color",ve,1,1,!1,!1)).min_filter=E.TF_LINEAR,pe.mag_filter=E.TF_LINEAR}else{Te=null,fe=null;var pe=null}if($){n.update_camera_shadows(de,$);for(var Pe=0;Pe<$.lamp_types.length;Pe++)for(var Se=$.csm_num,Ae=0;Ae<Se;Ae++){var he=c.create_subs_shadow_cast(Ae,Pe,$,F);s.append_node_attr(i,he),h.push(he);var ve=$.csm_resolution;t.shadow_cameras.push(Ve=he.camera),Ve.width=ve,Ve.height=ve,he.clear_color=!0;var me=Pe>0?Pe:Ae;if(d.rgba_fallback_shadows){var ge=x("COLOR","u_shadow_map"+me,ve,1,1,!1,!1);v.push(ge);var Oe=x("DEPTH","DEPTH",ve,1,1,!1,!1);Oe.use_renderbuffer=!0,he.slinks_internal.push(Oe)}else{var Ne=x("DEPTH","u_shadow_map"+me,ve,1,1,!1,!1);d.compared_mode_depth&&(Ne.min_filter=E.TF_LINEAR,Ne.mag_filter=E.TF_LINEAR,Ne.use_comparison=!0),v.push(Ne),(o.depth_only_issue()||d.shadows_color_slink_hack)&&he.slinks_internal.push(x("COLOR","COLOR",ve,1,1,!1,!1))}Te&&(s.append_edge_attr(i,Te,he,fe),s.append_edge_attr(i,Te,he,pe))}}var Re={subs_grass_map:Te,slink_grass_map_d:fe,slink_grass_map_c:pe};if(I(j,j,e,i,Re,{cube_reflect_links:w,cube_refl_subscenes:O},ie),R(j,j,e,i,Re,{reflect_links_opaque:g,reflect_subscenes:m},t),$){var Ie=n.clone_camera(de,!0);t.cameras.push(Ie);var be=c.create_subs_shadow_receive(i,Ie,F);for(s.append_node_attr(i,be),be.self_shadow_normal_offset=$.self_shadow_normal_offset,Ae=0;Ae<h.length;Ae++)s.append_edge_attr(i,he=h[Ae],be,v[Ae]);if(le){if(Ne=x("DEPTH","DEPTH",1,1,1,!0,!0),se){Ne.multisample=!0,Ne.use_renderbuffer=!0;var ye=c.create_subs_resolve();s.append_node_attr(i,ye);var Le=x("COLOR","RESOLVE",1,1,1,!0,!0);Le.multisample=!0,Le.use_renderbuffer=!0;var Ye=x("DEPTH","RESOLVE",1,1,1,!0,!0);Ye.multisample=!0,Ye.use_renderbuffer=!0,s.append_edge_attr(i,be,ye,Le),s.append_edge_attr(i,be,ye,Ye)}}else se?Ne=x("DEPTH","DEPTH",1,1,1,!0,!0):d.rgba_fallback_shadows?(Ne=x("DEPTH","DEPTH",1,1,1,!0,!0)).use_renderbuffer=!0:Ne=Ee;if(X){var Me=x("COLOR","u_color",1,1,1,!0,!0),xe=x("DEPTH","u_depth",1,1,1,!0,!0),Ce=n.clone_camera(de,!0);t.cameras.push(Ce);var we=e.ssao_params,Ue=c.create_subs_ssao(Ce,Z,we);s.append_node_attr(i,Ue);var ke=x("COLOR","u_ssao_mask",1,1,1,!0,!0);s.append_edge_attr(i,be,Ue,Me),s.append_edge_attr(i,be,Ue,xe);var De=n.clone_camera(de,!0);t.cameras.push(De);var Fe=c.create_subs_ssao_blur(De,we);s.append_node_attr(i,Fe);var Ge=x("COLOR","u_shadow_mask",1,1,1,!0,!0);s.append_edge_attr(i,Ue,Fe,ke),s.append_edge_attr(i,be,Fe,xe)}Te&&(s.append_edge_attr(i,Te,be,fe),s.append_edge_attr(i,Te,be,pe))}else be=null;var Ke=c.create_subs_main(c.MAIN_OPAQUE,de,!le,G,F,Z,J,null,e.sun_exist);if(b=Ke,s.append_node_attr(i,Ke),$&&(le?s.append_edge_attr(i,be,Ke,Ne):be.slinks_internal.push(Ne)),se){var Be=c.create_subs_resolve();s.append_node_attr(i,Be),A.push(Be);var Xe=x("COLOR","RESOLVE",1,1,1,!0,!0);Xe.multisample=!0,Xe.use_renderbuffer=!0;var He=x("DEPTH","RESOLVE",1,1,1,!0,!0);He.multisample=!0,He.use_renderbuffer=!0,s.append_edge_attr(i,Ke,Be,Xe),s.append_edge_attr(i,Ke,Be,He)}else A.push(Ke);if(be)if(ke)s.append_edge_attr(i,Fe,Ke,Ge);else{var je=x("COLOR","u_shadow_mask",1,1,1,!0,!0);s.append_edge_attr(i,le&&se?ye:be,Ke,je)}if(Te&&(s.append_edge_attr(i,Te,Ke,fe),s.append_edge_attr(i,Te,Ke,pe)),m.length){var ze=m.length;for(Pe=0;Pe<ze;Pe++)s.append_edge_attr(i,m[Pe],Ke,g[Pe])}if(O.length)for(Pe=0;Pe<O.length;Pe++)s.append_edge_attr(i,O[Pe],Ke,w[Pe]);if(l=A,A=[],!ie&&e.color_picking){var Qe=u.enabled&&(u.subs_type===c.COLOR_PICKING||u.subs_type===c.COLOR_PICKING_XRAY),Ve=n.clone_camera(de,!0);Qe||(Ve.width=Ve.height=1),t.cameras.push(Ve);var qe=c.create_subs_color_picking(Ve,!1,F);if(s.append_node_attr(i,qe),e.xray){Ve=n.clone_camera(de,!0),Qe||(Ve.width=Ve.height=1),t.cameras.push(Ve);var We=c.create_subs_color_picking(Ve,!0,F);s.append_node_attr(i,We);var Je=x("COLOR","COLOR",1,1,1,Qe,!0);s.append_edge_attr(i,qe,We,Je);var Ze=x("DEPTH","DEPTH",1,1,1,Qe,!0);s.append_edge_attr(i,qe,We,Ze)}}else qe=null;if(!z.refractions&&!_e||ie)$e=null;else{if(se)$e=Be;else{if(d.ios_copy_tex_hack)var $e=c.create_subs_postprocessing("NONE"),et=x("COLOR","u_color",1,1,1,!0,!0);else $e=c.create_subs_copy(),et=x("COLOR","COPY",1,1,1,!0,!0);s.append_node_attr(i,$e),s.append_edge_attr(i,l[0],$e,et)}var tt=x("COLOR","u_refractmap",1,1,1,!0,!0);d.webgl2&&(tt.use_mipmap=!0,tt.min_filter=E.TF_LINEAR_MIPMAP_LINEAR,tt.mag_filter=E.TF_LINEAR)}if(oe&&(_e||K||B)){var rt=n.clone_camera(de,!0);t.cameras.push(rt);var nt=c.create_subs_depth_pack(rt);s.append_node_attr(i,nt);var at=x("DEPTH","u_depth",1,1,1,!0,!0);s.append_edge_attr(i,se?Be:Ke,nt,at);var ot=x("COLOR","u_scene_depth",1,1,1,!0,!0);ot.min_filter=E.TF_NEAREST,ot.mag_filter=E.TF_NEAREST}else nt=null;var _t=function(r){var a=n.clone_camera(de,!0);t.cameras.push(a);var o=c.create_subs_main(r,a,!1,G,F,Z,J,$,e.sun_exist);if(s.append_node_attr(i,o),r==c.MAIN_XRAY){var _=x("COLOR","COLOR",1,1,1,!0,!0);s.append_edge_attr(i,l[0],o,_);var E=x("DEPTH","DEPTH",1,1,1,!0,!0);o.slinks_internal.push(E)}else{if(se&&l[0].type==c.RESOLVE)var u=Ke;else u=l[0];s.append_edge_attr(i,Ke,o,Ee),s.append_edge_attr(i,u,o,ce)}Te&&(s.append_edge_attr(i,Te,o,fe),s.append_edge_attr(i,Te,o,pe));for(var d=0;d<h.length;d++)s.append_edge_attr(i,h[d],o,v[d]);if(nt&&s.append_edge_attr(i,nt,o,ot),m.length){var T=m.length;for(d=0;d<T;d++)s.append_edge_attr(i,m[d],o,g[d])}if(O.length)for(d=0;d<O.length;d++)s.append_edge_attr(i,O[d],o,w[d]);return $e&&s.append_edge_attr(i,$e,o,tt),o};if(e.glow_over_blend){var it=_t(c.MAIN_BLEND);y=it,A.push(it),l=A,A=[]}if(e.glow_materials){var st=n.clone_camera(de,!0);t.cameras.push(st);var lt=c.create_subs_main(c.MAIN_GLOW,st,!1,G,F,Z,J);if(s.append_node_attr(i,lt),nt&&s.append_edge_attr(i,nt,lt,ot),$e&&s.append_edge_attr(i,$e,lt,tt),Te&&(s.append_edge_attr(i,Te,lt,fe),s.append_edge_attr(i,Te,lt,pe)),m.length)for(ze=m.length,Pe=0;Pe<ze;Pe++)s.append_edge_attr(i,m[Pe],lt,g[Pe]);if(O.length)for(Pe=0;Pe<O.length;Pe++)s.append_edge_attr(i,O[Pe],lt,w[Pe]);e.glow_over_blend&&s.append_edge_attr(i,lt,it,x("SCREEN","NONE",0,0,0,!1,!1)),s.append_edge_attr(i,se?Be:Ke,lt,se?ue:Ee),($t=c.create_subs_postprocessing("X_GLOW_BLUR")).subtype="GLOW_MASK_SMALL",M($t,e.glow_params.small_glow_mask_width),(er=x("COLOR","u_color",1,1,1,!0,!0)).min_filter=E.TF_LINEAR,er.mag_filter=E.TF_LINEAR,s.append_node_attr(i,$t),s.append_edge_attr(i,lt,$t,er),(ar=c.create_subs_postprocessing("Y_GLOW_BLUR")).subtype="GLOW_MASK_SMALL",M(ar,e.glow_params.small_glow_mask_width),(tr=x("COLOR","u_color",1,.5,.5,!0,!0)).min_filter=E.TF_LINEAR,tr.mag_filter=E.TF_LINEAR,s.append_node_attr(i,ar),s.append_edge_attr(i,$t,ar,tr);var ct=c.create_subs_postprocessing("X_GLOW_BLUR");ct.subtype="GLOW_MASK_LARGE",M(ct,e.glow_params.large_glow_mask_width);var Et=x("COLOR","u_color",1,.5,.5,!0,!0);Et.min_filter=E.TF_LINEAR,Et.mag_filter=E.TF_LINEAR,s.append_node_attr(i,ct),s.append_edge_attr(i,ar,ct,Et);var ut=c.create_subs_postprocessing("Y_GLOW_BLUR");ut.subtype="GLOW_MASK_LARGE",M(ut,e.glow_params.large_glow_mask_width);var dt=x("COLOR","u_color",1,.25,.25,!0,!0);dt.min_filter=E.TF_LINEAR,dt.mag_filter=E.TF_LINEAR,s.append_node_attr(i,ut),s.append_edge_attr(i,ct,ut,dt);var Tt=n.clone_camera(de,!0);t.cameras.push(Tt);var ft=c.create_subs_glow_combine(Tt,e);s.append_node_attr(i,ft);var pt=x("COLOR","u_src_color",1,1,1,!0,!0);if(pt.min_filter=E.TF_LINEAR,pt.mag_filter=E.TF_LINEAR,e.glow_over_blend)if(se){var Pt=c.create_subs_resolve();s.append_node_attr(i,Pt),s.append_edge_attr(i,it,Pt,Xe),s.append_edge_attr(i,it,Pt,He),s.append_edge_attr(i,Pt,ft,pt)}else s.append_edge_attr(i,it,ft,pt);else s.append_edge_attr(i,se?Be:Ke,ft,pt);(nr=x("COLOR","u_glow_mask_small",1,.5,.5,!0,!0)).min_filter=E.TF_LINEAR,nr.mag_filter=E.TF_LINEAR,s.append_edge_attr(i,ar,ft,nr);var St=x("COLOR","u_glow_mask_large",1,.25,.25,!0,!0);St.min_filter=E.TF_LINEAR,St.mag_filter=E.TF_LINEAR,s.append_edge_attr(i,ut,ft,St),l=[ft],A=[]}if(e.glow_over_blend||(it=_t(c.MAIN_BLEND),y=it,A.push(it),l=A,A=[]),d.debug_view){Ve=n.clone_camera(de,!0),t.cameras.push(Ve);var At=c.create_subs_debug_view(Ve);A.push(At),s.append_node_attr(i,At),s.append_edge_attr(i,l[0],At,ce),s.append_edge_attr(i,l[0],At,Ee),Te&&(s.append_edge_attr(i,Te,At,fe),s.append_edge_attr(i,Te,At,pe)),_.set_debug_view_subs(At),l=A,A=[]}if(se){var ht=c.create_subs_resolve();s.append_node_attr(i,ht),A.push(ht),s.append_edge_attr(i,l[0],ht,Xe),s.append_edge_attr(i,l[0],ht,He),l=A,A=[]}var vt=l.slice(0);if(!ie&&e.anchor_visibility){Ve=n.clone_camera(de,!0),t.cameras.push(Ve);var mt=c.create_subs_anchor_visibility(Ve);s.append_node_attr(i,mt),s.append_edge_attr(i,l[0],mt,se?ue:Ee)}if(H&&oe&&!ie){var gt=re.max_ray_length,Ot=re.intensity,Nt=re.steps_per_pass,Rt=l[0],It=!!G,bt=x("DEPTH","u_input",1,1,1,!0,!0),yt=x("COLOR","u_input",1,.25,.25,!0,!0);yt.min_filter=E.TF_LINEAR,yt.mag_filter=E.TF_LINEAR;var Lt=gt/Nt,Yt=n.clone_camera(de,!0);t.cameras.push(Yt);var Mt=c.create_subs_god_rays(Yt,It,gt,!0,Lt,F,Nt);s.append_node_attr(i,Mt),s.append_edge_attr(i,Rt,Mt,bt),Lt=gt/Nt*.5;var xt=n.clone_camera(de,!0);t.cameras.push(xt);var Ct=c.create_subs_god_rays(xt,It,gt,!1,Lt,F,Nt);s.append_node_attr(i,Ct),s.append_edge_attr(i,Mt,Ct,yt),Lt=gt/Nt*.25;var wt=n.clone_camera(de,!0);t.cameras.push(wt);var Ut=c.create_subs_god_rays(wt,It,gt,!1,Lt,F,Nt);s.append_node_attr(i,Ut),s.append_edge_attr(i,Ct,Ut,yt);var kt=c.create_subs_god_rays_comb(Ot,F);A.push(kt),s.append_node_attr(i,kt),(Ft=x("COLOR","u_main",1,1,1,!0,!0)).min_filter=E.TF_LINEAR,Ft.mag_filter=E.TF_LINEAR,s.append_edge_attr(i,Rt,kt,Ft);var Dt=x("COLOR","u_god_rays",1,1,1,!0,!0);Dt.min_filter=E.TF_LINEAR,Dt.mag_filter=E.TF_LINEAR,s.append_edge_attr(i,Ut,kt,Dt),l=A,A=[]}if(Q&&!ie){Rt=l[0];var Ft,Gt=c.create_subs_luminance();s.append_node_attr(i,Gt),(Ft=x("COLOR","u_input",1,1,1,!0,!0)).min_filter=E.TF_LINEAR,Ft.mag_filter=E.TF_LINEAR,s.append_edge_attr(i,Rt,Gt,Ft);var Kt=Q.key,Bt=Q.edge_lum,Xt=n.clone_camera(de,!0);t.cameras.push(Xt);var Ht=c.create_subs_luminance_truncated(Kt,Bt,F,Xt);s.append_node_attr(i,Ht);var jt=x("COLOR","u_luminance",1,.25,.25,!0,!0);if(jt.min_filter=E.TF_LINEAR,jt.mag_filter=E.TF_LINEAR,Q.adaptive){var zt=c.create_subs_av_luminance();s.append_node_attr(i,zt),zt.camera.width=1,zt.camera.height=1;var Qt=x("COLOR","u_input",1,.25,.25,!0,!0);if(Qt.use_mipmap=!0,Qt.min_filter=E.TF_LINEAR_MIPMAP_LINEAR,Qt.mag_filter=E.TF_LINEAR,d.webgl2)jt.use_mipmap=!0,jt.min_filter=E.TF_LINEAR_MIPMAP_LINEAR,s.append_edge_attr(i,Gt,zt,Qt);else{var Vt=c.create_resize_subs(),qt=x("COLOR","u_color",1,.25,.25,!0,!0);s.append_node_attr(i,Vt),s.append_edge_attr(i,Gt,Vt,qt),s.append_edge_attr(i,Vt,zt,Qt)}s.append_edge_attr(i,zt,Ht,x("COLOR","u_average_lum",1,1,1,!1,!1)),Ht.adaptive_bloom=!0}else Ht.adaptive_bloom=!1,Ht.average_luminance=Q.average_luminance;s.append_edge_attr(i,Rt,Ht,x("COLOR","u_main",1,1,1,!0,!0)),s.append_edge_attr(i,Gt,Ht,jt);var Wt=Ht,Jt=1,Zt=[];for(Ae=0;Ae<5;Ae++){var $t,er,tr;M($t=c.create_subs_postprocessing("X_BLOOM_BLUR"),e.glow_params.small_glow_mask_width),(er=x("COLOR","u_color",1,Jt,Jt,!0,!0)).min_filter=E.TF_LINEAR,er.mag_filter=E.TF_LINEAR,s.append_node_attr(i,$t),s.append_edge_attr(i,Wt,$t,er),Jt/=2,M(ar=c.create_subs_postprocessing("Y_BLOOM_BLUR"),e.glow_params.small_glow_mask_width),(tr=x("COLOR","u_color",1,Jt,Jt,!0,!0)).min_filter=E.TF_LINEAR,tr.mag_filter=E.TF_LINEAR,s.append_node_attr(i,ar),s.append_edge_attr(i,$t,ar,tr),Wt=ar,ar.bloom_blur_scale=Jt,$t.bloom_blur_scale=Jt,Zt.push(ar,Jt)}var rr=c.create_subs_bloom_combine(Q.blur,5);for(s.append_node_attr(i,rr),Ae=0;Ae<Zt.length;Ae+=2){var nr,ar=Zt[Ae],or=Zt[Ae+1];(nr=x("COLOR","u_bloom_level_"+(Ae/2).toString(),1,or,or,!0,!0)).min_filter=E.TF_LINEAR,nr.mag_filter=E.TF_LINEAR,s.append_edge_attr(i,ar,rr,nr)}s.append_edge_attr(i,Rt,rr,x("COLOR","u_main",1,1,1,!0,!0)),A.push(rr),l=A,A=[]}if(ae&&oe&&!ie){Rt=l[0];var _r=n.clone_camera(de,!0);t.cameras.push(_r);var ir=r.dof_bokeh&&d.tex_float_available&&d.cbuffer_float_available;if(ir){var sr=E.TF_NEAREST,lr=x("COLOR","u_color",1,1,1,!0,!0);lr.min_filter=sr,lr.mag_filter=sr;var cr=x("DEPTH","u_depth",1,1,1,!0,!0),Er=x("COLOR","u_color",1,.5,.5,!0,!0);Er.floating_point=!0,Er.min_filter=E.TF_NEAREST,Er.mag_filter=E.TF_NEAREST;var ur=x("COLOR","u_color",1,.5,.5,!0,!0);ur.floating_point=!0,ur.min_filter=E.TF_NEAREST,ur.mag_filter=E.TF_NEAREST;var dr=x("COLOR","u_blurred1",1,.5,.5,!0,!0);dr.floating_point=!0,dr.min_filter=sr,dr.mag_filter=sr;var Tr=x("COLOR","u_blurred2",1,.5,.5,!0,!0);Tr.floating_point=!0,Tr.min_filter=sr,Tr.mag_filter=sr;var fr=vt[0];if(r.dof_foreground_blur){var pr=n.clone_camera(de,!0);t.cameras.push(pr);var Pr=c.create_subs_coc(pr,"COC_FOREGROUND");pr.dof_distance=r.dof_distance,pr.dof_object=r.dof_object,pr.dof_front_start=r.dof_front_start,pr.dof_front_end=r.dof_front_end,pr.dof_rear_start=r.dof_rear_start,pr.dof_rear_end=r.dof_rear_end,pr.dof_power=r.dof_power,pr.dof_bokeh=r.dof_bokeh,pr.dof_bokeh_intensity=r.dof_bokeh_intensity,pr.dof_foreground_blur=r.dof_foreground_blur,pr.dof_on=!0,s.append_node_attr(i,Pr),s.append_edge_attr(i,Rt,Pr,lr),s.append_edge_attr(i,fr,Pr,cr);var Sr=c.create_subs_postprocessing("X_ALPHA_BLUR");s.append_node_attr(i,Sr),s.append_edge_attr(i,Pr,Sr,Er);var Ar=c.create_subs_postprocessing("Y_ALPHA_BLUR");s.append_node_attr(i,Ar),s.append_edge_attr(i,Sr,Ar,ur);var hr=n.clone_camera(de,!0),vr=c.create_subs_coc(hr,"COC_COMBINE");t.cameras.push(hr),hr.dof_distance=r.dof_distance,hr.dof_object=r.dof_object,hr.dof_front_start=r.dof_front_start,hr.dof_front_end=r.dof_front_end,hr.dof_rear_start=r.dof_rear_start,hr.dof_rear_end=r.dof_rear_end,hr.dof_power=r.dof_power,hr.dof_bokeh=r.dof_bokeh,hr.dof_bokeh_intensity=r.dof_bokeh_intensity,hr.dof_foreground_blur=r.dof_foreground_blur,hr.dof_on=!0,s.append_node_attr(i,vr),s.append_edge_attr(i,Rt,vr,lr),s.append_edge_attr(i,fr,vr,cr),s.append_edge_attr(i,Ar,vr,x("COLOR","u_coc_fg",1,.5,.5,!0,!0))}else hr=n.clone_camera(de,!0),t.cameras.push(hr),vr=c.create_subs_coc(hr,"COC_ALL"),hr.dof_distance=r.dof_distance,hr.dof_object=r.dof_object,hr.dof_front_start=r.dof_front_start,hr.dof_front_end=r.dof_front_end,hr.dof_rear_start=r.dof_rear_start,hr.dof_rear_end=r.dof_rear_end,hr.dof_power=r.dof_power,hr.dof_bokeh=r.dof_bokeh,hr.dof_bokeh_intensity=r.dof_bokeh_intensity,hr.dof_foreground_blur=r.dof_foreground_blur,hr.dof_on=!0,s.append_node_attr(i,vr),s.append_edge_attr(i,Rt,vr,lr),s.append_edge_attr(i,fr,vr,cr);(Ir=c.create_subs_postprocessing("X_DOF_BLUR")).camera.dof_bokeh_intensity=r.dof_bokeh_intensity,s.append_node_attr(i,Ir),s.append_edge_attr(i,vr,Ir,Er);var mr=c.create_subs_postprocessing("Y_DOF_BLUR");mr.camera.dof_bokeh_intensity=r.dof_bokeh_intensity,s.append_node_attr(i,mr),s.append_edge_attr(i,Ir,mr,ur);var gr=c.create_subs_postprocessing("Y_DOF_BLUR");gr.camera.dof_bokeh_intensity=r.dof_bokeh_intensity,s.append_node_attr(i,gr),s.append_edge_attr(i,Ir,gr,ur);var Or=c.create_subs_dof(_r,ir);_r.dof_distance=r.dof_distance,_r.dof_object=r.dof_object,_r.dof_front_start=r.dof_front_start,_r.dof_front_end=r.dof_front_end,_r.dof_rear_start=r.dof_rear_start,_r.dof_rear_end=r.dof_rear_end,_r.dof_power=r.dof_power,_r.dof_bokeh=r.dof_bokeh,_r.dof_bokeh_intensity=r.dof_bokeh_intensity,_r.dof_foreground_blur=r.dof_foreground_blur,_r.dof_on=!0,A.push(Or),s.append_node_attr(i,Or),s.append_edge_attr(i,Rt,Or,x("COLOR","u_sharp",1,1,1,!0,!0)),s.append_edge_attr(i,mr,Or,dr),s.append_edge_attr(i,gr,Or,Tr)}else{var Nr=x("COLOR","u_color",1,1,1,!0,!0);Nr.min_filter=E.TF_LINEAR,Nr.mag_filter=E.TF_LINEAR;var Rr=x("COLOR","u_color",1,1,1,!0,!0);Rr.min_filter=E.TF_LINEAR,Rr.mag_filter=E.TF_LINEAR;var Ir=c.create_subs_postprocessing("X_BLUR");s.append_node_attr(i,Ir),s.append_edge_attr(i,Rt,Ir,Nr);var br=c.create_subs_postprocessing("Y_BLUR");s.append_node_attr(i,br),s.append_edge_attr(i,Ir,br,Rr);var yr=vt[0];Or=c.create_subs_dof(_r,ir),_r.dof_distance=r.dof_distance,_r.dof_object=r.dof_object,_r.dof_front_start=r.dof_front_start,_r.dof_front_end=r.dof_front_end,_r.dof_rear_start=r.dof_rear_start,_r.dof_rear_end=r.dof_rear_end,_r.dof_power=r.dof_power,_r.dof_bokeh=r.dof_bokeh,_r.dof_bokeh_intensity=r.dof_bokeh_intensity,_r.dof_foreground_blur=r.dof_foreground_blur,_r.dof_on=!0,A.push(Or),s.append_node_attr(i,Or),s.append_edge_attr(i,Rt,Or,x("COLOR","u_sharp",1,1,1,!0,!0)),s.append_edge_attr(i,br,Or,x("COLOR","u_blurred",1,1,1,!0,!0)),s.append_edge_attr(i,yr,Or,x("DEPTH","u_depth",1,1,1,!0,!0))}l=A,A=[]}if(e.xray){var Lr=_t(c.MAIN_XRAY);A.push(Lr),l=A,A=[]}if(V&&!ie){var Yr=l[0],Mr=c.create_subs_motion_blur(ee.mb_decay_threshold,ee.mb_factor);A.push(Mr),s.append_node_attr(i,Mr);var xr=x("COLOR","u_mb_tex_curr",1,1,1,!0,!0);s.append_edge_attr(i,Yr,Mr,xr);var Cr=x("COLOR","u_mb_tex_accum",1,1,1,!0,!0);Mr.slinks_internal.push(Cr),l=A,A=[]}if(!ie&&e.outline){Rt=l[0];var wr=n.clone_camera(de,!0);t.cameras.push(wr);var Ur=c.create_subs_outline_mask(wr,F);s.append_node_attr(i,Ur);var kr=c.create_subs_postprocessing("X_EXTEND"),Dr=x("COLOR","u_color",1,1,1,!0,!0),Fr=x("COLOR","u_outline_mask",1,1,1,!0,!0);Fr.min_filter=E.TF_LINEAR,Fr.mag_filter=E.TF_LINEAR,kr.is_for_outline=!0,s.append_node_attr(i,kr),s.append_edge_attr(i,Ur,kr,Dr);var Gr=x("COLOR","u_color",1,.5,.5,!0,!0);Gr.min_filter=E.TF_LINEAR,Gr.mag_filter=E.TF_LINEAR;var Kr=c.create_subs_postprocessing("Y_EXTEND");Kr.is_for_outline=!0,s.append_node_attr(i,Kr),s.append_edge_attr(i,kr,Kr,Gr),(Ir=c.create_subs_postprocessing("X_BLUR")).is_for_outline=!0,s.append_node_attr(i,Ir),s.append_edge_attr(i,Kr,Ir,Gr);var Br=x("COLOR","u_color",1,.25,.25,!0,!0);Br.min_filter=E.TF_LINEAR,Br.mag_filter=E.TF_LINEAR;var Xr=x("COLOR","u_outline_mask_blurred",1,.25,.25,!0,!0);Xr.min_filter=E.TF_LINEAR,Xr.mag_filter=E.TF_LINEAR,(br=c.create_subs_postprocessing("Y_BLUR")).is_for_outline=!0,s.append_node_attr(i,br),s.append_edge_attr(i,Ir,br,Br);var Hr=c.create_subs_outline(ne);s.append_node_attr(i,Hr);var jr=x("COLOR","u_outline_src",1,1,1,!0,!0);jr.min_filter=E.TF_LINEAR,jr.mag_filter=E.TF_LINEAR,s.append_edge_attr(i,Rt,Hr,jr),s.append_edge_attr(i,Ur,Hr,Fr),s.append_edge_attr(i,br,Hr,Xr),A.push(Hr),l=A,A=[]}if(p(i,oe),(e.anaglyph_use||e.hmd_stereo_use||e.sidebyside_use)&&!ie){var zr=function(e,t,r,a){var o=r.cameras,_=t.hmd_stereo_use,i=t.anaglyph_use,l=t.reflection_params.plane_refl_subs,u=t.reflection_params.plane_refl_subs_blend,T=s.get_node_id(e,a),p=a,P=s.subgraph_node_conn(e,T,s.BACKWARD_DIR),S=[],A=[],h=[];P=s.clone(P,(function(t){var a;if(f.indexOf(t.type)>-1)A.push(t),a=t;else{if((a=c.clone_subs(t)).type==c.MAIN_PLANE_REFLECT)for(var i=0;i<l.length;i++)if(l[i][0]==t){l[i]=[t,a],a.camera.reflection_plane=t.camera.reflection_plane,r.cameras.push(a.camera);break}if(t.type==c.MAIN_PLANE_REFLECT_BLEND){for(i=0;i<l.length;i++)if(u[i][0]==t){u[i]=[t,a],a.camera=l[i][1].camera;break}}else o.indexOf(t.camera)>-1&&(_?(n.make_stereo(t.camera,n.TYPE_HMD_LEFT),n.make_stereo(a.camera,n.TYPE_HMD_RIGHT),a.force_do_not_render=!0):(n.make_stereo(t.camera,n.TYPE_STEREO_LEFT),n.make_stereo(a.camera,n.TYPE_STEREO_RIGHT)),o.push(a.camera));var E=s.node_by_attr(e,t);if(s.traverse_inputs(e,E,(function(e,t,r){f.indexOf(t.type)>-1&&S.push([t,a,r])})),t.type!==c.MOTION_BLUR)for(i=0;i<t.slinks_internal.length;i++)a.slinks_internal[i].parent_slink=t.slinks_internal[i];var d=!0;for(i=0;i<s.in_edge_count(e,E);i++){var T=s.get_in_edge(e,E,i),p=s.get_node_attr(e,T);-1==f.indexOf(p.type)&&(d=!1)}d&&h.push(a)}return a}),(function(e){var t=C(e,!0);return t.parent_slink=e,t}));for(var v=0;v<A.length;v++)s.remove_node(P,s.node_by_attr(P,A[v]));s.cleanup_loose_edges(P);var m=c.create_subs_stereo(_,i),g=s.append_node_attr(e,m);if(d.ios_copy_tex_hack)var O=c.create_subs_postprocessing("NONE"),N=x("COLOR","u_color",1,1,1,!0,!0);else O=c.create_subs_copy(),N=x("COLOR","COPY",1,1,1,!0,!0);N.min_filter=E.TF_LINEAR,N.mag_filter=E.TF_LINEAR,s.append_node_attr(e,O),s.append_edge_attr(e,p,O,N);var R=x("COLOR","u_sampler_left",1,1,1,!0,!0);if(R.unique_texture=!0,R.min_filter=E.TF_LINEAR,R.mag_filter=E.TF_LINEAR,s.append_edge_attr(e,O,m,R),!p.is_pp){if(d.ios_copy_tex_hack)var I=c.create_subs_postprocessing("NONE"),b=x("COLOR","u_color",1,1,1,!0,!0);else I=c.create_subs_copy(),b=x("COLOR","COPY",1,1,1,!0,!0);s.append_node_attr(P,I),b.parent_slink=N;var y=s.get_sink_nodes(P)[0],L=s.get_node_attr(P,y);s.append_edge_attr(P,L,I,b)}var Y=x("COLOR","u_sampler_right",1,1,1,!0,!0);for(p.is_pp&&(Y.parent_slink=N),Y.min_filter=E.TF_LINEAR,Y.mag_filter=E.TF_LINEAR,s.append_subgraph(P,e,[s.get_sink_nodes(P)[0],g,Y]),v=0;v<S.length;v++)s.append_edge_attr(e,S[v][0],S[v][1],S[v][2]);var M=x("SCREEN","NONE",0,0,0,!1,!1);for(v=0;v<h.length;v++)s.append_edge_attr(e,O,h[v],M);return s.traverse_edges(e,(function(t,r,n){s.get_node_attr(e,t).type===c.MOTION_BLUR&&(n.parent_slink=null)})),m}(i,e,t,l[0]);A.push(zr),l=A,A=[]}if(q&&!ie){Rt=l[0];var Qr=c.create_subs_compositing(te.brightness,te.contrast,te.exposure,te.saturation),Vr=x("COLOR","u_color",1,1,1,!0,!0);Vr.min_filter=E.TF_LINEAR,Vr.mag_filter=E.TF_LINEAR,(e.anaglyph_use||e.hmd_stereo_use||e.sidebyside_use)&&!ie&&(Vr.unique_texture=!0),s.append_node_attr(i,Qr),s.append_edge_attr(i,Rt,Qr,Vr),A.push(Qr),l=A,A=[]}if(!l[0].is_pp||l[0].type==c.MOTION_BLUR||l[0].type==c.RESOLVE){var qr=c.create_subs_postprocessing("NONE");s.append_node_attr(i,qr);var Wr=x("COLOR","u_color",1,1,1,!0,!0);Wr.min_filter=E.TF_LINEAR,Wr.mag_filter=E.TF_LINEAR,s.append_edge_attr(i,l[0],qr,Wr),A.push(qr),l=A,A=[]}if(W){if(Rt=l[0],d.smaa){var Jr=x("COLOR","u_color",1,1,1,!0,!1);Jr.min_filter=E.TF_LINEAR,Jr.mag_filter=E.TF_LINEAR;var Zr=c.create_subs_smaa(c.SMAA_EDGE_DETECTION,e);s.append_node_attr(i,Zr),s.append_edge_attr(i,Rt,Zr,Jr);var $r=c.create_subs_smaa(c.SMAA_BLENDING_WEIGHT_CALCULATION,e);s.append_node_attr(i,$r),s.append_edge_attr(i,Zr,$r,Jr);var en=x("COLOR","u_search_tex",1,1,1,!1,!1),tn=x("COLOR","u_area_tex",1,1,1,!1,!1);en.min_filter=E.TF_LINEAR,en.mag_filter=E.TF_LINEAR,tn.min_filter=E.TF_LINEAR,tn.mag_filter=E.TF_LINEAR,$r.slinks_internal.push(en),$r.slinks_internal.push(tn);var rn=c.create_subs_smaa(c.SMAA_NEIGHBORHOOD_BLENDING,e);s.append_node_attr(i,rn),s.append_edge_attr(i,Rt,rn,Jr);var nn=x("COLOR","u_blend",1,1,1,!0,!1);nn.min_filter=E.TF_LINEAR,nn.mag_filter=E.TF_LINEAR,s.append_edge_attr(i,$r,rn,nn),A.push(rn)}else{var an=c.create_subs_aa(e);s.append_node_attr(i,an);var on=x("COLOR","u_color",1,1,1,!0,!1);on.min_filter=E.TF_LINEAR,on.mag_filter=E.TF_LINEAR,(e.anaglyph_use||e.hmd_stereo_use||e.sidebyside_use)&&!ie&&(on.unique_texture=!0),s.append_edge_attr(i,Rt,an,on),A.push(an)}l=A,A=[]}if(A.push(l[0]),qe&&A.push(We||qe),mt&&A.push(mt),ve=1,e.sky_params.render_sky){var _n=e.world_light_set,sn=_n.sky_texture_param,ln=c.create_subs_sky(_n,F,e.sky_params,ve=sn?sn.tex_size:ve);if(s.append_node_attr(i,ln),A.push(ln),D.length&&(s.append_edge_attr(i,ln,Ke,D[0]),it&&s.append_edge_attr(i,ln,it,D[0]),lt&&s.append_edge_attr(i,ln,lt,D[0]),Lr&&s.append_edge_attr(i,ln,Lr,D[0])),j.has_pbr_reflexible)if(d.webgl2&&!d.is_mobile_device){var cn=c.create_subs_irradiance(F,ve);s.append_node_attr(i,cn),(pn=x("CUBEMAP","u_sky_reflection",ve,1,1,!1)).use_mipmap=!0,pn.min_filter=E.TF_LINEAR_MIPMAP_LINEAR,pn.mag_filter=E.TF_LINEAR,s.append_edge_attr(i,ln,cn,pn);var En=x("CUBEMAP","u_irradiance",32,1,1,!1);En.use_mipmap=!1,En.min_filter=E.TF_LINEAR,En.mag_filter=E.TF_LINEAR,s.append_edge_attr(i,cn,Ke,En),it&&s.append_edge_attr(i,cn,it,En),lt&&s.append_edge_attr(i,cn,lt,En),Lr&&s.append_edge_attr(i,cn,Lr,En),A.push(cn);var un=c.create_subs_rougness_convolution(F);s.append_node_attr(i,un),s.append_edge_attr(i,ln,un,pn);var dn=x("CUBEMAP","u_cube_r_convolution",128,1,1,!1);dn.use_mipmap=!1,dn.min_filter=E.TF_LINEAR_MIPMAP_LINEAR,dn.mag_filter=E.TF_LINEAR,s.append_edge_attr(i,un,Ke,dn),it&&s.append_edge_attr(i,un,it,dn),lt&&s.append_edge_attr(i,un,lt,dn),Lr&&s.append_edge_attr(i,un,Lr,dn);var Tn=c.create_subs_brdf();s.append_node_attr(i,Tn);var fn=x("COLOR","u_brdf",512,1,1,!1);fn.min_filter=E.TF_LINEAR,fn.mag_filter=E.TF_LINEAR,s.append_edge_attr(i,Tn,Ke,fn),it&&s.append_edge_attr(i,Tn,it,fn),lt&&s.append_edge_attr(i,Tn,lt,fn),Lr&&s.append_edge_attr(i,Tn,Lr,fn)}else{var pn;(pn=x("CUBEMAP","u_sky_reflection",ve,1,1,!1)).use_mipmap=!0,pn.min_filter=E.TF_LINEAR_MIPMAP_LINEAR,pn.mag_filter=E.TF_LINEAR,s.append_edge_attr(i,ln,Ke,pn),it&&s.append_edge_attr(i,ln,it,pn),lt&&s.append_edge_attr(i,ln,lt,pn),Lr&&s.append_edge_attr(i,ln,Lr,pn)}}var Pn=c.create_subs_sink();for(s.append_node_attr(i,Pn),Ae=0;Ae<A.length;Ae++){var Sn=A[Ae];switch(Sn.blend=!0,Sn.type){case c.COLOR_PICKING:case c.COLOR_PICKING_XRAY:s.append_edge_attr(i,Sn,Pn,x("COLOR","NONE",1,1,1,Qe,!1)),s.append_edge_attr(i,Sn,Pn,x("DEPTH","NONE",1,1,1,Qe,!1));break;case c.SKY:var An=x("CUBEMAP","u_sky",ve,1,1,!1);s.append_edge_attr(i,Sn,Pn,An);break;case c.IRRADIANCE:var hn=x("CUBEMAP","u_irradiance",ve,1,1,!1);hn.use_mipmap=!0,hn.min_filter=E.TF_NEAREST,hn.mag_filter=E.TF_NEAREST,s.append_edge_attr(i,cn,Pn,hn);break;case c.ANCHOR_VISIBILITY:var vn=x("COLOR","NONE",1,1,1,!0,!1);s.append_edge_attr(i,Sn,Pn,vn);break;default:if(ie){var mn=a[0],gn=x("COLOR","OFFSCREEN",1,1,1,!0,!0);for(gn.texture=mn,s.append_edge_attr(i,A[Ae],Pn,gn),Pe=1;Pe<a.length;Pe++){var On=a[Pe],Nn=c.create_subs_postprocessing("NONE");s.append_node_attr(i,Nn);var Rn=x("COLOR","SCALE",1,1,1,!0,!0);s.append_edge_attr(i,A[Ae],Nn,Rn);var In=On.source_size/mn.source_size;(gn=x("COLOR","OFFSCREEN",1,In,In,!0,!0)).texture=On,s.append_edge_attr(i,Nn,Pn,gn)}}else s.append_edge_attr(i,A[Ae],Pn,x("SCREEN","NONE",1,1,1,!0,!1))}}if(Be&&!k(i,Be).length&&(s.remove_node(i,s.node_by_attr(i,Be)),s.cleanup_loose_edges(i)),p(i,oe),P(i,oe),u.enabled){var bn=L(i);bn&&Y(i,bn)}if(S(i),N(i),$&&s.traverse(i,(function(e,t){t.type!=c.SHADOW_RECEIVE&&t.type!=c.MAIN_BLEND&&t.type!=c.MAIN_XRAY||function(e,t){for(var r=0,n=U(e,t),a=0,o=0;o<n.length;o++){var _=n[o];_.type==c.SHADOW_CAST&&(a++,t.p_light_matrix=t.p_light_matrix||new Array,t.p_light_matrix[_.shadow_lamp_index>0?_.shadow_lamp_index:r]=_.camera.proj_matrix,r++)}t.v_light_ts&&t.v_light_r||(d.mac_os_shadow_hack?t.v_light_tsr=new Float32Array(9*a):(t.v_light_ts=new Float32Array(4*a),t.v_light_r=new Float32Array(4*a)))}(i,t)})),!j.has_reflexible)for(Ae=0;Ae<w.length;Ae++)w[Ae].active=!1;return i},t.multiply_size_mult_by_graph=function(e,t,r){var n=[];s.traverse(e,(function(t,r){if(-1==f.indexOf(r.type)&&r.slinks_internal.length&&w(e,r,c.STEREO))for(var a=0;a<r.slinks_internal.length;a++){var o=r.slinks_internal[a];-1==n.indexOf(o)&&n.push(o)}})),s.traverse_edges(e,(function(t,r,a){var o=s.get_node_attr(e,t),_=s.get_node_attr(e,r);-1==f.indexOf(o.type)&&w(e,_,c.STEREO)&&-1==n.indexOf(a)&&n.push(a)}));for(var a=0;a<n.length;a++)n[a].size_mult_x*=t,n[a].size_mult_y*=r},t.set_texel_size=function(e,t,r){var n=e.texel_size_multiplier;e.texel_size[0]=t*e.texel_mask[0]*n,e.texel_size[1]=r*e.texel_mask[1]*n},t.set_texel_size_mult=M,t.create_performance_graph=function(){var e=s.create(),t=c.create_subs_perf(),r=n.create_camera(n.TYPE_NONE);r.width=512,r.height=512,t.camera=r,s.append_node_attr(e,t),t.slinks_internal.push(x("COLOR","u_color",512,1,1,!1,!1));var a=c.create_subs_sink();return s.append_node_attr(e,a),s.append_edge_attr(e,t,a,x("COLOR","NONE",512,1,1,!1,!1)),S(e),N(e),e},t.find_on_screen=function(e){var t=null;return s.traverse(e,(function(e,r){return!(!r.camera||null!==r.camera.framebuffer||(t=r,0))})),t},t.find_input=function(e,t,r){for(var n=U(e,t),a=0;a<n.length;a++)if(n[a].type==r)return n[a];return null},t.get_inputs_by_type=function(e,t,r){for(var n=U(e,t),a=[],o=0;o<n.length;o++)n[o].type==r&&a.push(n[o]);return a},t.has_lower_subs=w,t.has_upper_subs=function e(t,r,n){if(r.type==n)return!0;for(var a=U(t,r),o=0;o<a.length;o++)if(e(t,a[o],n))return!0;return!1},t.get_inputs=U,t.get_outputs=k,t.find_subs=function(e,t){var r=null;return s.traverse(e,(function(e,n){return n.type==t&&(r=n,!0)})),r},t.debug_convert_to_dot=function(e){var t="digraph scenegraph {\n";t+="    ",t+='size="11.7,16.5";\n',t+="    ",t+='ratio="fill";\n',t+="    ",t+='node [shape=box margin="0.25,0.055"];\n';var r=function(e){var t=[],r=[];return O(e,(function(e,n,a,o){e.texture&&-1==t.indexOf(e.texture)&&(t.push(e.texture),r.push(e.texture,t.length-1))})),r}(e);return s.traverse(e,(function(e,n){t+="    ",t+=function(e,t,r){var n=c.subs_label(t);if(t.camera){n+="\\n";for(var a=0;a<r.length;a+=2){var o=t.camera.color_attachment;r[a]==o&&(E.is_renderbuffer(o)?n+="CR"+r[a+1]+" ":n+="C"+r[a+1]+" ")}for(a=0;a<r.length;a+=2){var _=t.camera.depth_attachment;r[a]==_&&(E.is_renderbuffer(_)?n+="DR"+r[a+1]:n+="D"+r[a+1])}}for(t.slinks_internal.length&&(n+="\\n-----\\n"),a=0;a<t.slinks_internal.length;a++)n+=D(t.slinks_internal[a],0,0,r);if(t.type==c.SINK)var i="dotted";else i=t.enqueue?"solid":"dashed";return i+=",bold",String(e)+' [label="'+n+'" color="black" style="'+i+'"];\n'}(e,n,r)})),s.traverse_edges(e,(function(e,n,a){t+="    ",t+=function(e,t,r,n){var a=D(r,0,0,n);if(r.active)var o="solid";else o="dotted";return String(e)+" -> "+String(t)+' [label="'+a+'" style="'+o+'"];\n'}(e,n,a,r)})),t+="}"},t.create_rendering_queue=function(e){for(var t=s.topsort_attr(e),r=[],n=0;n<t.length;n++){var a=t[n];a.enqueue&&r.push(a)}return r}})),yI=nA("__sfx",(function(e,t){var r=gN(e),n=dR(e),a=mN(e),o=AR(e),_=n.defaults,i=n.sfx,s=new Float32Array(3),l=new Float32Array(3),c=dm(),E=[],u=[],d=null,T=null,f=[],p=[1],P=null;t.AST_NONE=10,t.AST_ARRAY_BUFFER=20,t.AST_HTML_ELEMENT=30,t.create_sfx=function(){return{uuid:-1,filepath:"",behavior:"NONE",muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1e4,cone_angle_inner:360,cone_angle_outer:360,cone_volume_outer:1,autoplay:!1,cyclic:!1,loop:!1,loop_start:0,loop_end:0,delay:0,delay_random:0,volume_random:0,pitch_random:0,fade_in:0,fade_out:0,start_time:0,pause_time:0,buf_offset:0,duration:0,vp_rand_end_time:0,base_seed:1,src:null,state:10,last_position:new Float32Array(3),velocity:new Float32Array(3),enable_doppler:!1,last_doppler_shift:1,bgm_start_timeout:-1,bgm_stop_timeout:-1,duck_time:0,proc_chain_in:null,source_node:null,source_node2:null,panner_node:null,filter_node:null,gain_node:null,fade_gain_node:null,rand_gain_node:null,update_counter:0}},t.init=function(){var e=document.createElement("audio"),t=document.createElement("video");e.canPlayType&&(""!=e.canPlayType("audio/ogg")&&(E.push("ogg"),E.push("ogv"),E.push("oga")),""!=e.canPlayType("audio/mpeg")&&E.push("mp3"),""!=e.canPlayType("audio/mp4")&&(E.push("mp4"),E.push("m4v"),E.push("m4a")),""!=e.canPlayType("audio/webm")&&E.push("webm")),t.canPlayType&&(""!=t.canPlayType("video/ogg")&&(u.push("ogv"),u.push("ogg"),u.push("oga")),""!=t.canPlayType("video/mp4")&&(u.push("m4v"),u.push("mp4")),""!=t.canPlayType("video/webm")&&u.push("webm"),""!=t.canPlayType("video/mpeg")&&u.push("mp3"))},t.attach_scene_sfx=function(e){if(i.webaudio&&!d&&(d=function(){var e=window.AudioContext||window.webkitAudioContext;if(e){try{var t=new e}catch(YM){return a.error('Unable to initialize AudioContext: "'+YM+'". The audio is disabled.'),null}return t.createGain?t:(a.warn("deprecated WebAudio implementation"),null)}return a.warn("WebAudio is not supported"),null}())&&a.log("%cINIT WEBAUDIO: "+d.sampleRate+"Hz","color: #00a"),d){var t={listener_last_eye:new Float32Array(3),listener_velocity:new Float32Array(3),update_counter:0},n=d.createGain(),o=d.createGain();if(t.gain_node=n,t.fade_gain_node=o,n.connect(o),o.connect(d.destination),e.b4w_enable_dynamic_compressor){var _=d.createDynamicsCompressor(),s=e.b4w_dynamic_compressor_settings;_.threshold.value=s.threshold,_.knee.value=s.knee,_.ratio.value=s.ratio,_.attack.value=s.attack,_.release.value=s.release,_.connect(n),t.compressor_node=_,t.proc_chain_in=_}else t.compressor_node=null,t.proc_chain_in=n;switch(e.audio_distance_model){case"INVERSE":case"INVERSE_CLAMPED":t.distance_model="inverse";break;case"LINEAR":case"LINEAR_CLAMPED":t.distance_model="linear";break;case"EXPONENT":case"EXPONENT_CLAMPED":t.distance_model="exponential";break;case"NONE":t.distance_model="none";break;default:r.panic("Wrong audio distance model")}t.doppler_factor=e.audio_doppler_factor,t.speed_of_sound=e.audio_doppler_speed,t.muted=!1,t.volume=e.audio_volume,n.gain.value=L(t),t.duck_time=0}else t=null;e._sfx=t},t.set_active_scene=function(e){T=e},t.detect_audio_container=function(e){return e||(e="ogg"),E.indexOf(e)>-1?e:E.indexOf("m4a")>-1?"m4a":E.indexOf("oga")>-1?"oga":""},t.detect_video_container=function(e){return e||(e="webm"),u.indexOf(e)>-1?e:u.indexOf("m4v")>-1?"m4v":u.indexOf("webm")>-1?"webm":""},t.update_object=function(e,t){var n=e.data,o=t.sfx;if(e.data.sound){switch(o.uuid=e.data.sound.uuid,o.filepath=e.data.sound.filepath,n.b4w_behavior){case"POSITIONAL":case"BACKGROUND_SOUND":o.behavior=d?n.b4w_behavior:"NONE";break;case"BACKGROUND_MUSIC":o.behavior=d?!window.MediaElementAudioSourceNode&&(a.warn("MediaElementAudioSourceNode not found"),1)||_.chrome_html_bkg_music_hack?"BACKGROUND_SOUND":"BACKGROUND_MUSIC":"NONE";break;default:r.panic("Wrong speaker behavior")}n.sound||(o.behavior="NONE"),o.enable_doppler=n.b4w_enable_doppler,o.muted=n.muted,o.volume=n.volume,o.pitch=n.pitch,o.attenuation=n.attenuation,o.dist_ref=n.distance_reference,o.dist_max=n.distance_max||1e4,o.cone_angle_inner=n.cone_angle_inner,o.cone_angle_outer=n.cone_angle_outer,o.cone_volume_outer=n.cone_volume_outer,o.autoplay=n.b4w_auto_play,o.cyclic=n.b4w_cyclic_play,o.loop=n.b4w_loop,o.loop_start=n.b4w_loop_start,o.loop_end=n.b4w_loop_end,o.delay=n.b4w_delay,o.delay_random=n.b4w_delay_random,o.volume_random=n.b4w_volume_random,o.pitch_random=n.b4w_pitch_random,o.fade_in=n.b4w_fade_in,o.fade_out=n.b4w_fade_out,f.push(t)}},t.source_type=function(e){switch("SPEAKER"!=e.type&&r.panic("Wrong object type"),e.sfx.behavior){case"POSITIONAL":case"BACKGROUND_SOUND":return t.AST_ARRAY_BUFFER;case"BACKGROUND_MUSIC":return t.AST_HTML_ELEMENT;case"NONE":return t.AST_NONE;default:r.panic("Wrong speaker behavior")}},t.update_spkobj=function(e,t){var n=e.sfx;switch(n.behavior){case"POSITIONAL":case"BACKGROUND_SOUND":case"BACKGROUND_MUSIC":n.src=t;break;case"NONE":break;default:r.panic("Wrong speaker behavior")}},t.play_empty_sound=function(){var e=d.createBufferSource();e.buffer=d.createBuffer(1,22050,22050),e.connect(d.destination),e.start(0)},t.decode_audio_data=function(e,t,r){d?d.decodeAudioData(e,t,r):r()},t.speaker_remove=function(e){N(e),e.sfx=null,f.splice(f.indexOf(e),1)},t.cleanup=function(){for(var e=0;e<f.length;e++){var t=f[e].sfx;if("BACKGROUND_MUSIC"==t.behavior){var r=t.src;r&&r.pause()}else t.source_node&&t.source_node.disconnect(),t.source_node2&&t.source_node2.disconnect()}if(T&&T._sfx){var n=T._sfx;n.listener_last_eye[0]=0,n.listener_last_eye[1]=0,n.listener_last_eye[2]=0,n.listener_velocity[0]=0,n.listener_velocity[1]=0,n.listener_velocity[2]=0}T=null,f.splice(0),P=null},t.update=function(e,t){if(d&&0!=f.length){for(var r=0;r<f.length;r++){var n=f[r],a=n.sfx,o=a.source_node,_=d.currentTime;!a.loop&&20==a.state&&a.duration&&a.start_time+a.duration<_&&("BACKGROUND_MUSIC"==a.behavior||o&&!jg(o.onended))&&(a.state=50),a.cyclic&&50==a.state&&h(n),20==a.state&&a.vp_rand_end_time-_<3&&g(a)}P&&P.speakers.length&&(-1==P.active||e>P.active_start_time+P.durations[P.active])&&function(e,t){if(e.active>-1&&N(e.speakers[e.active]),-1==e.active&&e.random)var r=Math.round(Math.random()*(e.speakers.length-1));else if(e.random){var n=1+Math.round(Math.random()*(e.speakers.length-2));r=(e.active+n)%e.speakers.length}else r=(e.active+1)%e.speakers.length;h(e.speakers[r]),e.active=r,e.active_start_time=t}(P,e)}};var S=function(){var e=dm(),t=ih();return function(r,n){var a=r.sfx;if(!a.proc_chain_in){if(i.mix_mode)(o=d.createBiquadFilter()).type="peaking";else var o=null;var _=d.createGain();switch(a.behavior){case"POSITIONAL":"string"!=typeof(u=d.createPanner()).panningModel?(u.panningModel=u.EQUALPOWER,u.distanceModel=u.INVERSE_DISTANCE):(u.panningModel="equalpower",u.distanceModel=n.distance_model);var s=jm(r.render.world_tsr,t),l=Vm(r.render.world_tsr,e);u.setPosition(s[0],s[1],s[2]),ch(s,a.last_position);var c=t;if(_O(l,Fg,c),u.setOrientation(c[0],c[1],c[2]),u.refDistance=a.dist_ref,u.maxDistance=a.dist_max,u.rolloffFactor=a.attenuation,u.coneInnerAngle=a.cone_angle_inner,u.coneOuterAngle=a.cone_angle_outer,u.coneOuterGain=a.cone_volume_outer,(T=d.createGain()).gain.value=L(a),o?(u.connect(o),o.connect(T)):u.connect(T),T.connect(_),a.proc_chain_in=u,a.volume_random){var E=d.createGain();_.connect(E),E.connect(n.proc_chain_in)}else E=null,_.connect(n.proc_chain_in);break;case"BACKGROUND_SOUND":var u=null;(T=d.createGain()).gain.value=L(a),o?(a.proc_chain_in=o,o.connect(T)):a.proc_chain_in=T,T.connect(_),a.volume_random?(E=d.createGain(),_.connect(E),E.connect(n.proc_chain_in)):(E=null,_.connect(n.proc_chain_in));break;case"BACKGROUND_MUSIC":var T;u=null,E=null,(T=d.createGain()).gain.value=L(a),o?(a.proc_chain_in=o,o.connect(T)):a.proc_chain_in=T,T.connect(_),_.connect(n.proc_chain_in)}a.panner_node=u,a.filter_node=o,a.gain_node=T,a.fade_gain_node=_,a.rand_gain_node=E}}}();function A(e,t,r){var n=e.sfx;if("NONE"!=n.behavior){var a=n.loop,_=n.pitch;if(n.src&&(a||r>=0)){n.base_seed=Math.floor(5e4*Math.random());var i=d.currentTime+t;if(i=Math.max(0,i),n.start_time=i,n.state=20,"POSITIONAL"==n.behavior&&"none"==T._sfx.distance_model&&(n.behavior="BACKGROUND_SOUND"),S(e,T._sfx),"POSITIONAL"==n.behavior||"BACKGROUND_SOUND"==n.behavior){var s=d.createBufferSource();if(s.buffer=n.src,s.playbackRate.value=_,a){if(n.source_node&&n.source_node.disconnect(),n.source_node2&&n.source_node2.disconnect(),s.loop=!0,s.loopStart=n.loop_start,s.loopEnd=n.loop_end,n.loop_end){var l=d.createBufferSource();l.buffer=n.src,l.playbackRate.value=_,n.source_node2=l,l.connect(n.proc_chain_in)}s.start(i),n.duration=0}else{var c=s.buffer?s.buffer.duration:0;if(r>c){var E=i+r+n.fade_out;s.loop=!0,s.start(i),s.stop(E),n.duration=r}else s.loop=!1,s.start(i),n.duration=c}s.connect(n.proc_chain_in),n.source_node=s,v(n),m(n),g(n)}else if("BACKGROUND_MUSIC"==n.behavior){o.clear_timeout(n.bgm_start_timeout),o.clear_timeout(n.bgm_stop_timeout);var u=function(){!function(e){var t=e.sfx,r=t.src;r&&(r.volume=1,r.loop=t.loop,t.source_node=t.source_node||d.createMediaElementSource(r),t.source_node.connect(t.proc_chain_in),20==t.state&&(r.currentTime&&(r.currentTime=0),r.play()))}(e)};if(0==t?u():n.bgm_start_timeout=o.set_timeout(u,1e3*t),a)n.duration=0;else{var f=Y(e);n.duration=f}}O(n,i)}}}function h(e){var t=e.sfx,r=t.duration;A(e,t.delay+t.delay_random*Math.random(),r)}function v(e){var t=e.source_node2||e.source_node;jg(t.onended)&&(t.onended=function(){e.state=50})}function m(e){e.volume_random&&e.rand_gain_node.gain.cancelScheduledValues(e.start_time),e.pitch_random&&(e.source_node.playbackRate.cancelScheduledValues(e.start_time),e.source_node2&&e.source_node2.playbackRate.cancelScheduledValues(e.start_time)),e.vp_rand_end_time=e.start_time}function g(e){if(e.volume_random||e.pitch_random){var t=e.rand_gain_node,r=e.source_node,n=r.buffer?r.buffer.duration:0;if(n){var a=e.start_time;p[0]=e.base_seed;for(var o=0;o<5;){var _=e.pitch+e.pitch_random*$g(p);if(a>=e.vp_rand_end_time){if(e.volume_random){var i=1-xO(e.volume_random,0,1)*Math.random();t.gain.setTargetAtTime(i,a,.015)}e.pitch_random&&(r.playbackRate.setTargetAtTime(_,a,.015),e.source_node2&&e.source_node2.playbackRate.setTargetAtTime(_,a,.015)),o++}a+=n/_}e.vp_rand_end_time=a-.001}}}function O(e,t){if(e.fade_in||e.fade_out){var r=e.fade_gain_node;r.gain.cancelScheduledValues(t),e.fade_in?(r.gain.setTargetAtTime(0,t,.015),r.gain.linearRampToValueAtTime(1,t+e.fade_in)):r.gain.setTargetAtTime(1,t,.015),e.fade_out&&!e.loop&&(r.gain.setTargetAtTime(1,t+e.duration,.015),r.gain.linearRampToValueAtTime(0,t+e.duration+e.fade_out))}}function N(e){"SPEAKER"!=e.type&&r.panic("Wrong object type");var t=e.sfx;if(50!=t.state){if(20==t.state||40==t.state){var n=t.fade_gain_node,a=d.currentTime;if(t.fade_out&&(n.gain.setTargetAtTime(n.gain.value,a,.015),n.gain.linearRampToValueAtTime(0,a+t.fade_out,.015)),"BACKGROUND_MUSIC"==t.behavior)t.src&&(o.clear_timeout(t.bgm_start_timeout),o.clear_timeout(t.bgm_stop_timeout),t.bgm_stop_timeout=o.set_timeout((function(){var t;(t=e.sfx.src)&&(t.currentTime&&(t.currentTime=0),t.pause())}),1e3*t.fade_out));else{var _=t.source_node;_.onended=function(){},t.duration<_.buffer.duration?t.fade_out&&20==t.state?_.stop(a+t.fade_out):20==t.state&&(_.stop(0),_.disconnect()):_.disconnect(),t.start_time=0,t.pause_time=0,t.buf_offset=0}t.state=30}}else t.state=30}function R(e){var t=e.sfx;if(20==t.state){var r=d.currentTime;if(t.pause_time=r,"BACKGROUND_MUSIC"==t.behavior){var n=t.src;n&&n.pause()}else t.buf_offset=r>t.start_time?function(e,t){p[0]=e.base_seed;for(var r,n=e.source_node.buffer.duration,a=e.start_time;a<t;)a+=n/(r=e.pitch+e.pitch_random*$g(p));return(n/r-(a-t))*r}(t,r):0,t.source_node.onended=function(){},t.source_node.stop(0),t.source_node.disconnect(),m(t);t.state=40}}function I(e){var t=e.sfx;if(40==t.state){var r=d.currentTime;if(t.start_time+=r-t.pause_time,"BACKGROUND_MUSIC"==t.behavior)t.src.play();else{!function(e){var t=e.sfx,r=d.createBufferSource();if(r.loop=t.source_node.loop,r.loopStart=t.source_node.loopStart,r.loopEnd=t.source_node.loopEnd,r.buffer=t.source_node.buffer,r.playbackRate.value=t.source_node.playbackRate.value,r.connect(t.proc_chain_in),t.source_node=r,t.source_node2){var n=d.createBufferSource();n.loop=t.source_node2.loop,n.buffer=t.source_node2.buffer,n.playbackRate.value=t.source_node2.playbackRate.value,n.connect(t.proc_chain_in),t.source_node2=n}}(e),t.vp_rand_end_time=r;var n=t.source_node;v(t),n.start(t.start_time,t.buf_offset),g(t)}O(t,t.start_time),t.state=20}}function b(e,t,r){var n=1,a=t.doppler_factor;if(a>0){var o=t.speed_of_sound;if(0!=Ih(e.velocity,e.velocity)||0!=Ih(t.listener_velocity,t.listener_velocity)){var _=dh(e.last_position,t.listener_last_eye,s),i=mh(_),l=Ih(_,t.listener_velocity)/i,c=Ih(_,e.velocity)/i;l=-l,c=-c;var E=o/a;n=(o-a*(l=Math.min(l,E)))/(o-a*(c=Math.min(c,E))),isFinite(n)||(n=0),n=Math.min(n,16),n=CO(n=Math.max(n,.125),e.last_doppler_shift,r,.3),e.source_node.playbackRate.value=n,e.last_doppler_shift=n}}}function y(e){var t=e.sfx;return!(!t||20!=t.state&&40!=t.state&&30!=t.state&&50!=t.state)}function L(e){return e.muted?0:e.volume}function Y(e){var t=e.sfx;if("POSITIONAL"==t.behavior||"BACKGROUND_SOUND"==t.behavior){var r=t.src;return r?r.duration:0}var n=t.src;return n?n.duration:0}t.play=A,t.play_def=h,t.stop=N,t.is_playing=function(e){return 20==e.sfx.state},t.speaker_pause=R,t.speaker_resume=I,t.loop_stop=function(e,t,r){var n=e.sfx,a=n.source_node2;if(y(e)&&("POSITIONAL"==n.behavior||"BACKGROUND_SOUND"==n.behavior)&&a){var o=d.currentTime+t;n.source_node.stop(o),a.start(o,n.loop_end)}},t.playrate=function(e,t){var r=e.sfx;r.pitch=t,!y(e)||"POSITIONAL"!=r.behavior&&"BACKGROUND_SOUND"!=r.behavior||(r.source_node.playbackRate.value=t,r.source_node2&&(r.source_node2.playbackRate.value=t),m(r),g(r))},t.get_playrate=function(e){return e.sfx.pitch},t.cyclic=function(e,t){e.sfx.cyclic=Boolean(t)},t.is_autoplay=function(e){return e.sfx.autoplay},t.is_cyclic=function(e){return e.sfx.cyclic},t.listener_update_transform=function(e,t,r,n,a){var o=e._sfx;if(o){var _=s;_[0]=0,_[1]=0,_[2]=-1,wh(_,r,_);var i=l;i[0]=0,i[1]=1,i[2]=0,wh(i,r,i);var c=d.listener;if(c.setPosition(t[0],t[1],t[2]),c.setOrientation(_[0],_[1],_[2],i[0],i[1],i[2]),n&&o.update_counter!=a){if(o.listener_stride)o.listener_stride=!1,ch(t,o.listener_last_eye);else{var E=o.listener_velocity;E[0]=(t[0]-o.listener_last_eye[0])/n,E[1]=(t[1]-o.listener_last_eye[1])/n,E[2]=(t[2]-o.listener_last_eye[2])/n,ch(t,o.listener_last_eye);for(var u=0;u<f.length;u++){var T=f[u],p=T.sfx;y(T)&&"POSITIONAL"==p.behavior&&p.enable_doppler&&b(p,o,n)}}o.update_counter=a}else ch(t,o.listener_last_eye)}},t.listener_stride=function(){var e=T._sfx;e&&(e.listener_stride=!0)},t.speaker_update_transform=function(e,t,r){var n=e.sfx;if(y(e)&&"POSITIONAL"==n.behavior){var a=jm(e.render.world_tsr,s),o=Vm(e.render.world_tsr,c),_=n.panner_node;_.setPosition(a[0],a[1],a[2]);var i=l;if(_O(o,Fg,i),_.setOrientation(i[0],i[1],i[2]),n.enable_doppler){var E=n.last_position;if(t&&n.update_counter!=r){if(n.stride)ch(a,E),n.stride=!1;else{var u=n.velocity;u[0]=(a[0]-E[0])/t,u[1]=(a[1]-E[1])/t,u[2]=(a[2]-E[2])/t,ch(a,E),b(n,T._sfx,t)}n.update_counter=r}else ch(a,E)}}},t.speaker_stride=function(e){var t=e.sfx;y(e)&&"POSITIONAL"==t.behavior&&t.enable_doppler&&(t.stride=!0)},t.get_spk_behavior=function(e){return e.sfx.behavior},t.check_active_speakers=function(){for(var e=0;e<f.length;e++)if(y(f[e]))return!0;return!1},t.set_master_volume=function(e){var t=T._sfx;t&&(t.volume=e,d&&(t.gain_node.gain.value=L(t)))},t.get_master_volume=function(){var e=T._sfx;return e?e.volume:0},t.set_volume=function(e,t){var r=e.sfx;r.volume=t,y(e)&&(r.gain_node.gain.value=L(r))},t.get_volume=function(e){return e.sfx.volume},t.mute=function(e,t){e.sfx.muted=Boolean(t),y(e)&&(e.sfx.gain_node.gain.value=L(e.sfx))},t.is_muted=function(e){return e.sfx.muted},t.mute_master=function(e){var t=T._sfx;t&&(t.muted=Boolean(e),d&&(t.gain_node.gain.value=L(t)))},t.is_master_muted=function(){var e=T._sfx;return!!e&&e.muted},t.get_speaker_objects=function(){return f},t.pause=function(){for(var e=0;e<f.length;e++)R(f[e])},t.resume=function(){for(var e=0;e<f.length;e++)I(f[e])},t.set_compressor_params=function(e,t){if(e._sfx&&e._sfx.compressor_node){var r=e._sfx.compressor_node;r.threshold.value=t.threshold,r.knee.value=t.knee,r.ratio.value=t.ratio,r.attack.value=t.attack,r.release.value=t.release}},t.get_compressor_params=function(e){if(!e._sfx||!e._sfx.compressor_node)return null;var t=e._sfx.compressor_node;return{threshold:t.threshold.value,knee:t.knee.value,ratio:t.ratio.value,attack:t.attack.value,release:t.release.value}},t.duck=function(e,t,r){if(y(e)){var n=e.sfx,a=n.fade_gain_node,o=d.currentTime;a.gain.setTargetAtTime(a.gain.value,o,.015),a.gain.linearRampToValueAtTime(t,o+r),n.duck_time=r}},t.unduck=function(e){if(y(e)){var t=e.sfx,r=t.fade_gain_node,n=d.currentTime;r.gain.setTargetAtTime(r.gain.value,n,.015),r.gain.linearRampToValueAtTime(1,n+t.duck_time),t.duck_time=0}},t.duck_master=function(e,t){if(d){var r=T._sfx,n=r.fade_gain_node,a=d.currentTime;n.gain.setTargetAtTime(n.gain.value,a,.015),n.gain.linearRampToValueAtTime(e,a+t),r.duck_time=t}},t.unduck_master=function(){if(d){var e=T._sfx,t=e.fade_gain_node,r=d.currentTime;t.gain.setTargetAtTime(t.gain.value,r,.015),t.gain.linearRampToValueAtTime(1,r+e.duck_time),e.duck_time=0}},t.apply_playlist=function(e,t,r){P={active:-1,active_start_time:0,random:r,speakers:[],durations:[]};for(var n=0;n<e.length;n++){var o=e[n],_=Y(o);0!=_?(N(o),o.sfx.cyclic=!1,P.speakers.push(o),P.durations.push(_+t)):a.warn("Ignoring speaker with zero duration: "+o.name)}},t.get_duration=Y,t.clear_playlist=function(){if(P)for(var e=P.speakers,t=0;t<e.length;t++)N(e[t]);P=null},t.get_positional_params=function(e){var t=e.sfx;return t&&"POSITIONAL"==t.behavior?{dist_ref:t.dist_ref,dist_max:t.dist_max,attenuation:t.attenuation}:null},t.set_positional_params=function(e,t){var r=e.sfx;if(r&&"POSITIONAL"==r.behavior){r.dist_ref=t.dist_ref,r.dist_max=t.dist_max,r.attenuation=t.attenuation;var n=r.panner_node;n&&(n.refDistance=r.dist_ref,n.maxDistance=r.dist_max,n.rolloffFactor=r.attenuation)}},t.set_filter_params=function(e,t){var r=e.sfx;r&&r.filter_node&&(r.filter_node.frequency.value=t.freq,r.filter_node.Q.value=t.Q,r.filter_node.gain.value=t.gain)},t.get_filter_params=function(e){var t=e.sfx;return t&&t.filter_node?{freq:t.filter_node.frequency.value,Q:t.filter_node.Q.value,gain:t.filter_node.gain.value}:null},t.get_filter_freq_response=function(e,t,r,n){var a=e.sfx;if(!a||!a.filter_node)return null;a.filter_node.getFrequencyResponse(t,r,n)},t.reset=function(){E.length=0,u.length=0,d=null}})),LI=nA("__scenes",(function(e,t){var r=gN(e),n=JI(e),a=pb(e),o=dR(e),_=fb(e),i=vR(e),s=pR(e),l=OI(e),c=NI(e),E=WI(e),u=KI(e),d=XI(e),T=PI(e),f=RI(e),p=II(e),P=mN(e),S=tI(e),A=bI(e),h=yI(e),v=qI(e),m=mR(e),g=XI(e),O=o.debug_subs,N=o.defaults,R=o.context_limits,I=o.outlining,b=o.scenes,y=[m.GRASS_MAP,m.SHADOW_CAST,m.MAIN_OPAQUE,m.MAIN_BLEND,m.MAIN_XRAY,m.MAIN_GLOW,m.MAIN_PLANE_REFLECT,m.MAIN_CUBE_REFLECT,m.MAIN_PLANE_REFLECT_BLEND,m.MAIN_CUBE_REFLECT_BLEND,m.COLOR_PICKING,m.COLOR_PICKING_XRAY,m.SHADOW_RECEIVE,m.OUTLINE_MASK,m.DEBUG_VIEW];t.OBJECT_SUBSCENE_TYPES=y;var L=[m.MAIN_OPAQUE,m.MAIN_BLEND,m.MAIN_XRAY,m.MAIN_GLOW,m.MAIN_PLANE_REFLECT,m.MAIN_CUBE_REFLECT,m.GOD_RAYS,m.GOD_RAYS_COMBINE,m.SKY,m.MAIN_PLANE_REFLECT_BLEND,m.MAIN_CUBE_REFLECT_BLEND,m.LUMINANCE_TRUNCED,m.SHADOW_RECEIVE,m.SHADOW_CAST,m.COLOR_PICKING,m.COLOR_PICKING_XRAY,m.OUTLINE_MASK],Y=[m.MAIN_OPAQUE,m.SSAO,m.MAIN_BLEND,m.MAIN_XRAY,m.MAIN_GLOW,m.MAIN_PLANE_REFLECT,m.MAIN_CUBE_REFLECT,m.MAIN_PLANE_REFLECT_BLEND,m.MAIN_CUBE_REFLECT_BLEND],M=[m.SHADOW_CAST,m.MAIN_OPAQUE,m.MAIN_BLEND,m.MAIN_XRAY,m.MAIN_GLOW,m.MAIN_PLANE_REFLECT,m.MAIN_CUBE_REFLECT,m.MAIN_PLANE_REFLECT_BLEND,m.MAIN_CUBE_REFLECT_BLEND,m.COLOR_PICKING,m.COLOR_PICKING_XRAY,m.SHADOW_RECEIVE,m.GOD_RAYS,m.OUTLINE_MASK,m.DEBUG_VIEW],x=[m.MAIN_OPAQUE,m.MAIN_BLEND,m.MAIN_XRAY,m.MAIN_GLOW,m.MAIN_PLANE_REFLECT,m.MAIN_CUBE_REFLECT,m.MAIN_PLANE_REFLECT_BLEND,m.MAIN_CUBE_REFLECT_BLEND],C=null,w=null,U=[],k=null,D=Math.PI/2,F=new Float32Array(2),G=new Float32Array(3),K=new Float32Array(3),B=new Float32Array(4),X=(new Float32Array(4),new Float32Array(16)),H=new Float32Array(24),j=new Float32Array(24),z={max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0},Q={max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0},V=0,q=-1/0,W=new Uint8Array(4);function J(){return C||(C=Z(U)),C}function Z(e){for(var t=0;t<e.length;t++){var r=e[t];if(!r._render_to_textures||!r._render_to_textures.length)return r}return null}function $(){return w||r.panic("No active scene available"),w}function ee(){return U}function te(e,t,r){if(!N.reflections)return!1;switch(e.b4w_render_reflections){case"OFF":return!1}for(var n=[],a=[],o=!1,_=!1,i=!1,s=0;s<t.length;s++){var l=t[s];if(l.render.reflective&&"CUBE"==l.render.reflection_type&&a.push(l),l.render.reflective&&"PBR"==l.render.reflection_type&&(_=!0),l.reflective_objs.length){for(var c=null,E=0;E<n.length;E++)if(n[E]==l){c=E;break}null==c&&n.push(l)}}for(s=0;s<r.length;s++){var u=r[s];u.b4w_reflexible&&(o=!0),re(u)&&(i=!0)}return{refl_plane_objs:n,refl_cube_objs:a,cube_refl_subs:[],cube_refl_subs_blend:[],plane_refl_subs:[],plane_refl_subs_blend:[],has_reflexible:o,has_pbr_reflexible:_,has_blend_reflexible:i}}function re(e){if(e.b4w_reflexible){for(var t=e._object.materials,r=0;r<t.length;r++){var n=t[r].blend_mode;if("OPAQUE"!=n&&"CLIP"!=n&&"ALPHA_ANTIALIASING"!=n)return!0}return!1}}t.create_scene_render=function(){return{}},t.set_active=function(e){w=e,h.set_active_scene(e)},t.prepare_rendering=function(e,t){var r=e._render,n=A.create_rendering_queue(r.graph);if(e==t){Ne(e,_.get_viewport_width(),_.get_viewport_height());for(var a=0;a<n.length;a++)e._render.queue.push(n[a])}else{var o=e._render_to_textures[0];for(Ne(e,o.source_size,o.source_size),a=0;a<n.length;a++)t._render.queue.push(n[a])}for(var i=Re(e,M),s=0;s<i.length;s++)i[s].wind.set(r.wind);for(a=0;a<r.queue.length;a++)r.queue[a].type==m.SHADOW_CAST&&S.draw(r.queue[a])},t.get_main=J,t.find_main_scene=Z,t.get_active=$,t.check_active=function(){return!!w},t.get_camera=function(e){return e._camera},t.get_all_scenes=ee,t.get_rendered_scenes=function(){if(1==U.length)return U;for(var e=0;e<U.length;e++)s.traverse(o=U[e]._render.graph,(function(t,r){for(var a=r,o=a.draw_data,_=0;_<o.length;_++)for(var i=o[_].bundles,s=0;s<i.length;s++){for(var l=i[s],c=l.batch.textures,E=l.batch.bpy_tex_names,u=null,T=0;T<c.length;T++)if("SCENE"==c[T].source&&c[T].source_id==U[e].name&&a.type!=m.COPY){P.error('Texture-scene loop detected. A scene is rendered to texture "'+E[T]+'" yet this texture belongs to the same scene.'),u=l.batch;break}if(u){var f=u.textures;for(u.textures=[],u.texture_names=[],n.update_batch_material_error(u,null),n.update_shader(u),m.append_draw_data(a,l),T=0;T<f.length;T++)d.cleanup_unused(f[T])}}}));var t=[];for(e=0;e<U.length;e++){var r=U[e];if(!r._render_to_textures.length){var a=s.node_by_attr(k,r);s.enforce_acyclic(k,a);var o=s.subgraph_node_conn(k,a,s.BACKWARD_DIR);o=s.topsort(o),s.traverse(o,(function(e,r){t.push(r)}));break}}return t},t.update_scene_graph=function(e,r,n,a,o,_){var i=T.get_scene_data(r._camera,r),s={reflection_params:te(e,n,o)};A.update_rendering_graph(r._render,i,r._camera.render,[],s),t.prepare_rendering(r,r),t.generate_auxiliary_batches(r,r._render.graph)},t.append_scene=function(e,t,r,n,i){e._render_to_textures=e._render_to_textures||[],e._nla=null;var l=e._render,u=T.get_scene_data(e._camera,e),d=e._camera.render;l.video_textures=[];var f=e.world;l.lamps_number=r.length,l.sun_exist=function(e){for(var t=0;t<e.length;t++)if("SUN"==e[t].light.type)return!0;return!1}(r),l.sky_params=function(e,t){var r=e.b4w_sky_settings,n={};return n.render_sky=r.render_sky||r.procedural_skydome,n.procedural_skydome=r.procedural_skydome,n.use_as_environment_lighting=r.use_as_environment_lighting,n.sky_color=r.color,n.rayleigh_brightness=r.rayleigh_brightness,n.mie_brightness=r.mie_brightness,n.spot_brightness=r.spot_brightness,n.scatter_strength=r.scatter_strength,n.rayleigh_strength=r.rayleigh_strength,n.mie_strength=r.mie_strength,n.rayleigh_collection_power=r.rayleigh_collection_power,n.mie_collection_power=r.mie_collection_power,n.mie_distribution=r.mie_distribution,n.reflexible=r.reflexible,n.reflexible_only=r.reflexible_only,!t&&r.procedural_skydome&&P.warn("There is no sun on the scene. Procedural sky will use a default sun position."),n}(f,l.sun_exist),l.world_light_set=function(e,t){var r=e.light_settings,n={};if(n.environment_energy=r.environment_energy,n.use_environment_light=r.use_environment_light,n.environment_color=r.environment_color,n.horizon_color=e.horizon_color.slice(0),n.zenith_color=e.zenith_color.slice(0),n.use_sky_paper=e.use_sky_paper,n.use_sky_blend=e.use_sky_blend,n.use_sky_real=e.use_sky_real,n.sky_texture_slot=null,n.sky_texture_param=null,n.environment_texture_slot=null,n.ngraph_proxy_id="",t.render_sky&&e.use_nodes&&e.node_tree){var a=E.compose_ngraph_proxy(e.node_tree,e.uuid,!1,e.name+"(World)",e.name,"MAIN",null,[]);n.ngraph_proxy_id=a.id}var o=!0;if(n.use_environment_light&&"SKY_TEXTURE"==n.environment_color&&(!t.procedural_skydome||!t.use_as_environment_lighting)){for(var _=null,i=0;i<e.texture_slots.length;i++)if(e.texture_slots[i].texture.b4w_use_as_environment_lighting&&!e.texture_slots[i].texture.b4w_use_as_skydome){_=e.texture_slots[i];break}_?n.environment_texture_slot=_:o=!1}for(i=0;i<e.texture_slots.length;i++)if(e.texture_slots[i].texture.b4w_use_as_skydome){var s=e.texture_slots[i];if(s.texture.image){o=!0,n.sky_texture_slot=s;var l=Math.min(R.max_cube_map_texture_size,g.calc_pot_size(s.texture.image.size[0]/3));n.sky_texture_param={tex_size:l,blend_factor:s.blend_factor,horizon_factor:s.horizon_factor,zenith_up_factor:s.zenith_up_factor,zenith_down_factor:s.zenith_down_factor,color:s.color,default_value:s.default_value,invert:s.invert,use_rgb_to_intensity:s.use_rgb_to_intensity,blend_type:s.blend_type,use_map_blend:s.use_map_blend,use_map_horizon:s.use_map_horizon,use_map_zenith_up:s.use_map_zenith_up,use_map_zenith_down:s.use_map_zenith_down}}break}return n.use_environment_light=!!n.use_environment_light&&o,n}(f,l.sky_params),l.world_fog_set=function(e){var t=e.fog_settings,r={};r.use_fog=t.use_fog,r.intensity=t.intensity,r.depth=t.depth,r.start=t.start,r.height=t.height,r.falloff=t.falloff,r.color=t.use_custom_color?t.color.slice(0):e.horizon_color.slice(0);var n=r.color;return r.fog_color_density=new Float32Array([n[0],n[1],n[2],1/r.depth]),r.fog_params=new Float32Array([r.intensity,r.depth,r.start,r.height]),r}(f),l.hmd_stereo_use=!e._render_to_textures.length&&function(e){if("HMD"==N.stereo){if(e.cameras[0].type!=a.TYPE_PERSP)return P.warn("Head-mounted display stereo is disabled for the non-perspective camera"),N.stereo="NONE",!1;if(!c.can_use_device(c.DEVICE_HMD))return P.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices"),N.stereo="NONE",!1}return"HMD"==N.stereo}(u),l.anaglyph_use=!e._render_to_textures.length&&function(e){return e.cameras[0].type!=a.TYPE_PERSP&&"ANAGLYPH"==N.stereo?(P.warn("Anaglyph stereo is disabled for the non-perspective camera"),N.stereo="NONE",!1):"ANAGLYPH"==N.stereo}(u),l.sidebyside_use=!e._render_to_textures.length&&function(e){return e.cameras[0].type!=a.TYPE_PERSP&&"SIDEBYSIDE"==N.stereo?(P.warn("Side-by-side stereo is disabled for the non-perspective camera"),N.stereo="NONE",!1):"SIDEBYSIDE"==N.stereo}(u),l.anchor_visibility=!l.anaglyph_use&&!l.sidebyside_use&&function(e,t){switch(e.b4w_enable_anchors_visibility){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var r=0;r<t.length;r++){var n=t[r]._object;if(n.anchor&&n.anchor.detect_visibility)return!0}return!1}}(e,i),l.reflection_params=te(e,t,n),l.bloom_params=function(e){if(!N.bloom||!e.b4w_enable_bloom)return null;var t={},r=e.b4w_bloom_settings;return t.blur=r.blur,t.edge_lum=r.edge_lum,t.key=r.key,t.adaptive=r.adaptive,t.average_luminance=r.average_luminance,t}(e),l.mb_params=function(e){var t={},r=e.b4w_motion_blur_settings;return t.mb_decay_threshold=r.motion_blur_decay_threshold,t.mb_factor=r.motion_blur_factor,t}(e),l.cc_params=function(e){var t={},r=e.b4w_color_correction_settings;return t.brightness=r.brightness,t.contrast=r.contrast,t.exposure=r.exposure,t.saturation=r.saturation,t}(e),l.god_rays_params=function(e){var t={},r=e.b4w_god_rays_settings;return t.intensity=r.intensity,t.max_ray_length=r.max_ray_length,t.steps_per_pass=r.steps_per_pass,t}(e),l.outline_params=function(e){var t={};return t.outline_color=e.b4w_outline_color,t.outline_factor=e.b4w_outline_factor,t}(e),l.glow_params=function(e){var t={},r=e.b4w_glow_settings;return t.small_glow_mask_coeff=r.small_glow_mask_coeff,t.large_glow_mask_coeff=r.large_glow_mask_coeff,t.small_glow_mask_width=r.small_glow_mask_width,t.large_glow_mask_width=r.large_glow_mask_width,t}(e),l.dof=N.dof&&(d.dof_distance>0||d.dof_object),l.motion_blur=N.motion_blur&&e.b4w_enable_motion_blur,l.compositing=N.compositing&&e.b4w_enable_color_correction,l.antialiasing=N.antialiasing&&1==N.msaa_samples&&"NONE"!=e.b4w_antialiasing_quality,l.ssao=N.ssao&&e.b4w_enable_ssao,l.god_rays=N.god_rays&&e.b4w_enable_god_rays&&l.sun_exist,l.depth_tex=N.depth_tex_available,l.glow_over_blend=e.b4w_glow_settings.render_glow_over_blend,l.ssao_params=function(e){var t={},r=e.b4w_ssao_settings;return t.radius_increase=r.radius_increase,t.hemisphere=r.hemisphere,t.blur_depth=r.blur_depth,t.blur_discard_value=r.blur_discard_value,t.influence=r.influence,t.dist_factor=r.dist_factor,t.samples=r.samples,t}(e);var p=function(e){for(var t={refractions:!1},r=ge(e),n=function e(r,n){if(r)for(var a=r.nodes,o=0;o<a.length;o++){var _=a[o];"GROUP"==_.type&&_.node_group&&e(_.node_group.node_tree,n),"GROUP"==_.type&&"B4W_REFRACTION"==_.node_tree_name&&(t.refractions=!0),"BSDF_TRANSPARENT"==_.type&&(_.b4w_use_alpha?n.blend_mode="ALPHA_SORT":t.refractions=!0),"BSDF_PRINCIPLED"==_.type&&(t.refractions=!0)}},a=0;a<r.length;a++){var o=r[a];o.is_refractive&&(t.refractions=!0),o.node_tree&&n(o.node_tree,o)}return t}(n);switch(l.materials_params=p,l.refractions=function(e,t){if(!N.refractions)return!1;switch(e.b4w_render_refractions){case"OFF":return!1;case"ON":return!0;case"AUTO":return t.refractions}}(e,p),l.shadow_params=function(e,t,r){if(!function(e,t,r){if(0==t.length)return!1;if(!N.shadows)return!1;switch(e.b4w_render_shadows){case"OFF":return!1;case"ON":return!0}var n=!1,a=!1,o=N.ssao&&e.b4w_enable_ssao;if(0==t.length&&!o)return!1;for(var _=0;_<r.length;_++){var i=r[_];if(i.b4w_shadow_cast&&(n=!0),i.b4w_shadow_receive&&(a=!0),(o||n)&&a)return!0}return!1}(e,t,r))return null;var n=e.b4w_shadow_settings,a={};n.csm_resolution>R.max_texture_size?(a.csm_resolution=R.max_texture_size,P.error("Shadow map texture has unsupported size. Changed to "+R.max_texture_size+".")):a.csm_resolution=n.csm_resolution,N.shadow_blur_samples=N.shadow_blur_samples?N.shadow_blur_samples:n.blur_samples,a.soft_shadows=n.soft_shadows;var o=T.get_shadow_lamps(t,N.ssao&&e.b4w_enable_ssao);a.self_shadow_polygon_offset=n.self_shadow_polygon_offset,a.self_shadow_normal_offset=n.self_shadow_normal_offset,a.enable_csm=n.b4w_enable_csm&&1==o.length,n.b4w_enable_csm&&n.csm_num>1&&o.length>1&&P.warn("Disabling Cascaded Shadow Maps because of multiple shadow casting lamps."),a.lamp_types=[],a.spot_sizes=[],a.clip_start=[],a.clip_end=[];for(var _=0;_<o.length;_++)a.lamp_types.push(o[_].light.type),a.spot_sizes.push(o[_].light.spot_size),a.clip_start.push(o[_].light.clip_start),a.clip_end.push(o[_].light.clip_end),"SPOT"!=a.lamp_types[_]&&"POINT"!=a.lamp_types[_]||!a.enable_csm||(P.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),a.enable_csm=!1);return a.enable_csm?(a.csm_num=n.csm_num,a.csm_first_cascade_border=n.csm_first_cascade_border,a.first_cascade_blur_radius=n.first_cascade_blur_radius,a.csm_last_cascade_border=n.csm_last_cascade_border,a.last_cascade_blur_radius=n.last_cascade_blur_radius,a.fade_last_cascade=n.fade_last_cascade,a.blend_between_cascades=n.blend_between_cascades):(a.csm_num=1,a.csm_first_cascade_border=n.csm_first_cascade_border,a.first_cascade_blur_radius=n.first_cascade_blur_radius,a.csm_last_cascade_border=n.csm_last_cascade_border,a.last_cascade_blur_radius=n.last_cascade_blur_radius,a.fade_last_cascade=!1,a.blend_between_cascades=!1),a}(e,r,n),l.water_params=function(e){for(var t=ge(e),r=[],n=0;n<t.length;n++){var a=t[n];if(a.water_settings.is_water){for(var o={},_=0;_<e.length;_++)for(var i=e[_],s=i._object.materials,l=0;l<s.length;l++)s[l]==a&&(o.water_level=i.location[2]);o.fog_color_density=new Float32Array(4),o.fog_color_density.set(a.water_settings.fog_color),o.fog_color_density[3]=a.water_settings.fog_density,a.water_settings.is_dynamic?(o.dynamic=!0,o.waves_height=a.water_settings.waves_height,o.waves_length=a.water_settings.waves_length,o.dst_noise_scale0=a.water_settings.dst_noise_scale0,o.dst_noise_scale1=a.water_settings.dst_noise_scale1,o.dst_noise_freq0=a.water_settings.dst_noise_freq0,o.dst_noise_freq1=a.water_settings.dst_noise_freq1,o.dir_min_shore_fac=a.water_settings.dir_min_shore_fac,o.dir_freq=a.water_settings.dir_freq,o.dir_noise_scale=a.water_settings.dir_noise_scale,o.dir_noise_freq=a.water_settings.dir_noise_freq,o.dir_min_noise_fac=a.water_settings.dir_min_noise_fac,o.dst_min_fac=a.water_settings.dst_min_fac,o.waves_hor_fac=a.water_settings.waves_hor_fac):(o.dynamic=!1,o.waves_height=0,o.waves_length=0),o.caustics=a.water_settings.enable_caust,o.caustic_scale=a.water_settings.caust_scale,o.caustic_brightness=a.water_settings.caust_brightness,o.caustic_speed=new Float32Array([.3,.7]),o.shoremap_image=null;var c=a.texture_slots;for(_=0;_<c.length;_++){var E=c[_].texture;if(!0===E.b4w_shore_dist_map&&"FILE"==E.image.source){o.shoremap_image=E.image,o.shoremap_tex_size=E.image.size[0],o.max_shore_dist=E.b4w_max_shore_dist;var u=E.b4w_shore_boundings;o.shoremap_center=[(u[0]+u[1])/2,(u[2]+u[3])/2],o.shoremap_size=[u[0]-u[1],u[2]-u[3]]}}r.push(o)}}if(r.length>0){if(!(o=r[0]).dynamic)for(n=0;n<r.length;n++)r[n].dynamic&&(o=r[n]);return o}return null}(n),l.xray=function(e){for(var t=0;t<e.length;t++)for(var r=e[t]._object.materials,n=0;n<r.length;n++){var a=r[n];if(a.render_above_all&&"OPAQUE"!=a.blend_mode&&"CLIP"!=a.blend_mode&&"ALPHA_ANTIALIASING"!=a.blend_mode)return!0}return!1}(n),l.soft_particles=function(e){for(var t=0;t<e.length;t++)for(var r=e[t].particle_systems,n=0;n<r.length;n++)if(T.check_obj_soft_particles_accessibility(e[t]._object,r[n].settings))return!0;return!1}(n),l.shore_smoothing=function(e){if(!N.shore_smoothing)return!1;for(var t=ge(e),r=0;r<t.length;r++){var n=t[r];if(n.water_settings.is_water&&n.water_settings.shore_smoothing)return!0}return!1}(n),l.dynamic_grass=function(e,t){if(!N.dynamic_grass)return!1;switch(e.b4w_render_dynamic_grass){case"OFF":return!1;case"ON":return!0}for(var r=!1,n=!1,a=0;a<t.length;a++){for(var o=t[a],_=o._object.materials,i=0;i<_.length;i++)_[i].terrain_settings.is_terrain&&(r=!0);var s=o.particle_systems;for(i=0;i<s.length;i++){var l=s[i].settings;"HAIR"==l.type&&l.b4w_dynamic_grass&&(n=!0)}if(r&&n)return!0}return!1}(e,n),l.color_picking=function(e,t){if(I.outlining_overview_mode)return!0;if(!N.enable_selectable)return!1;switch(e.b4w_enable_object_selection){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var r=0;r<t.length;r++)if(t[r]._object.render.selectable)return!0;return!1}}(e,n),l.outline=function(e,t){if(I.outlining_overview_mode)return!0;if(!N.enable_outlining)return!1;switch(e.b4w_enable_outlining){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var r=0;r<t.length;r++)if(t[r]._object.render.outlining)return!0;return!1}}(e,n),l.glow_materials=function(e,t){if(!N.glow_materials)return!1;switch(e.b4w_enable_glow_materials){case"OFF":return!1;case"ON":return!0;case"AUTO":for(var r=0;r<t.length;r++)for(var n=t[r]._object.materials,a=0;a<n.length;a++)if(E.check_material_glow_output(n[a]))return!0;return!1}}(e,n),l.lod_smooth_type=e.b4w_lod_smooth_type,l.lod_hyst_interval=e.b4w_lod_hyst_interval,N.reflection_quality?N.reflection_quality:e.b4w_reflection_quality){case"LOW":l.cubemap_refl_size=b.cube_reflect_low,l.plane_refl_size=b.plane_reflect_low;break;case"MEDIUM":l.cubemap_refl_size=b.cube_reflect_medium,l.plane_refl_size=b.plane_reflect_medium;break;case"HIGH":l.cubemap_refl_size=b.cube_reflect_high,l.plane_refl_size=b.plane_reflect_high;break;default:l.cubemap_refl_size=b.cube_reflect_low,l.plane_refl_size=b.plane_reflect_low}_.is_hidpi()?(P.log("%cENABLE HIDPI MODE","color: #00a"),l.aa_quality="AA_QUALITY_LOW",l.resolution_factor=1,N.msaa_samples=1):N.msaa_samples>1?(P.log("%cENABLE MSAA RENDERING: "+N.msaa_samples+"x","color: #00a"),l.resolution_factor=1):(l.aa_quality="AA_QUALITY_"+e.b4w_antialiasing_quality,l.resolution_factor=N.quality===o.P_ULTRA?1.33:1);var S=e._render_to_textures.sort((function(e,t){return t.source_size-e.source_size}));l.graph=A.create_rendering_graph(l,u,d,S),l.queue=[],l.need_shadow_update=!1,l.need_grass_map_update=!1,l.need_outline=!1,l.wind=new Float32Array(3),U.push(e),k||(k=s.create()),s.append_node_attr(k,e);for(var h=0;h<t.length;h++)T.scene_data_set_active(t[h],!0,e);var v=_.get_container();_.resize(v.clientWidth,v.clientHeight,!0)},t.append_scene_vtex=function(e,t,r){for(var n=0;n<t.length;n++){var a=t[n]._render;a&&a.is_movie&&(a.vtex_data_id=r,e._render.video_textures.push(t[n]))}},t.get_graph=function(e){return e._render.graph},t.generate_auxiliary_batches=function(e,t){s.traverse(t,(function(r,a){var o=a,_=null;switch(o.type){case m.POSTPROCESSING:_=n.create_postprocessing_batch(o.pp_effect);break;case m.SSAO:_=n.create_ssao_batch(o);break;case m.SSAO_BLUR:_=n.create_ssao_blur_batch(o);break;case m.DEPTH_PACK:_=n.create_depth_pack_batch();break;case m.GOD_RAYS:_=n.create_god_rays_batch(o.pack,o.water,o.steps_per_pass);break;case m.GOD_RAYS_COMBINE:_=n.create_god_rays_combine_batch();break;case m.MOTION_BLUR:_=n.create_motion_blur_batch(o.mb_decay_threshold);break;case m.COC:_=n.create_coc_batch(o.coc_type);break;case m.DOF:_=n.create_dof_batch(o);var i=o.camera.dof_power;if(o.dof_bokeh){i/=2;var s=A.get_inputs_by_type(t,o,m.POSTPROCESSING);A.set_texel_size_mult(s[0],i),A.set_texel_size_mult(s[1],i),s[0]=A.find_input(t,s[0],m.POSTPROCESSING),A.set_texel_size_mult(s[0],i)}else{var l=A.find_input(t,o,m.POSTPROCESSING),c=A.find_input(t,l,m.POSTPROCESSING);A.set_texel_size_mult(l,i),A.set_texel_size_mult(c,i)}break;case m.OUTLINE:_=n.create_outline_batch();var E=A.find_input(t,o,m.POSTPROCESSING),u=A.find_input(t,E,m.POSTPROCESSING),d=A.find_input(t,u,m.POSTPROCESSING),f=A.find_input(t,d,m.POSTPROCESSING);A.set_texel_size_mult(u,o.blur_texel_size_mult),A.set_texel_size_mult(E,o.blur_texel_size_mult),A.set_texel_size_mult(f,o.ext_texel_size_mult*o.outline_factor),A.set_texel_size_mult(d,o.ext_texel_size_mult*o.outline_factor);break;case m.GLOW_COMBINE:_=n.create_glow_combine_batch();break;case m.COMPOSITING:_=n.create_compositing_batch();break;case m.ANTIALIASING:_=n.create_antialiasing_batch(o);break;case m.SMAA_RESOLVE:case m.SMAA_EDGE_DETECTION:case m.SMAA_BLENDING_WEIGHT_CALCULATION:case m.SMAA_NEIGHBORHOOD_BLENDING:_=n.create_smaa_batch(o.type);break;case m.STEREO:_=n.create_stereo_batch(o.subtype);break;case m.SKY:_=n.create_cube_sky_batch(e,o);break;case m.IRRADIANCE:_=n.create_cube_irradiance_batch(e,o);break;case m.ROUGHNESS_CONVOLUTION:_=n.create_cube_roughness_convolution_batch(e,o);break;case m.BRDF:_=n.create_brdf_batch(e,o);break;case m.LUMINANCE:_=n.create_luminance_batch();break;case m.AVERAGE_LUMINANCE:_=n.create_average_luminance_batch();break;case m.LUMINANCE_TRUNCED:_=n.create_luminance_truncated_batch(o.adaptive_bloom);break;case m.BLOOM:_=n.create_bloom_combine_batch(o.bloom_blur_num);break;case m.RESIZE:_=n.create_postprocessing_batch("NONE");break;case m.VELOCITY:_=n.create_velocity_batch();break;case m.ANCHOR_VISIBILITY:_=n.create_anchor_visibility_batch();break;case m.PERFORMANCE:_=n.create_performance_batch()}if(_){var p=m.init_bundle(_,T.create_render("NONE"));m.append_draw_data(o,p),Pe(t,o,_,!1),ce(_)}}))};var ne=function(){var e=dm(),t=ih();return function(r,o){for(var _=Re(o,L),i=r.light,s=r.render,l=T.get_scene_data(r,o),c=jm(s.world_tsr,t),E=Vm(s.world_tsr,e),u=0;u<_.length;u++){switch(Ae(r,l,O=_[u]),i.type){case"SUN":O.sun_quaternion.set(E),O.sun_intensity=i.color_intensity,ch(i.direction,O.sun_direction),O.type==m.SKY&&O.procedural_skydome&&(O.need_fog_update=i.need_sun_fog_update,ve(o,O));break;case"HEMI":case"POINT":case"SPOT":break;default:P.error("Unknown light type: "+i.type+'".')}for(var d=O.draw_data,f=0;f<d.length;f++)for(var p=d[f].bundles,S=0;S<p.length;S++){var A=p[S].batch;A.lamp_uuid_indexes&&n.set_lamp_data(A,r)}}var h=Ie(o,m.MAIN_OPAQUE).camera,v=l.shadow_subscenes,g=o._render.shadow_params;for(u=0;u<v.length;u++){var O;a.set_view_trans_quat((O=v[u]).camera,c,E),pe(O,o,h,g,!0),fe(O,o._render.graph)}}}();function ae(e,t){for(var r=Re(e,[m.MAIN_OPAQUE,m.MAIN_BLEND,m.MAIN_GLOW]),n=0;n<r.length;n++)r[n].bsdf_cube_sky_dim=t}function oe(e,t,r,o,_){switch(e.type){case m.MAIN_OPAQUE:_e(e,t,r,"OPAQUE",o,_);break;case m.MAIN_BLEND:_e(e,t,r,"BLEND",o,_);break;case m.MAIN_XRAY:_e(e,t,r,"XRAY",o,_);break;case m.MAIN_GLOW:_e(e,t,r,"GLOW",o,_);break;case m.MAIN_PLANE_REFLECT:case m.MAIN_CUBE_REFLECT:ue(e,t,r,!1,o,_);break;case m.MAIN_PLANE_REFLECT_BLEND:case m.MAIN_CUBE_REFLECT_BLEND:ue(e,t,r,!0,o,_);break;case m.SHADOW_RECEIVE:!function(e,t,r,a,o){for(var _=T.get_scene_data(t,a),i=_.batches,s=0;s<i.length;s++){var l=i[s];if("SHADOW"==l.type&&"RECEIVE"==l.subtype&&l.shadow_receive&&(o||(se(l,e,t,r,"SHADOW",a),n.update_shader(l)))){var c=m.init_bundle(l,t.render,_.batch_world_bounds[s]);m.append_draw_data(e,c),Pe(r,e,l,!1),ce(l)}}}(e,t,r,o,_);break;case m.SHADOW_CAST:!function(e,t,r,a,o){for(var _=!1,i=t.render,s=T.get_scene_data(t,a),l=s.batches,c=A.find_subs(r,m.GRASS_MAP),E=0;E<l.length;E++){var u=l[E];if("SHADOW"==u.type&&"CAST"==u.subtype){if(_=!0,!o){ie(u);var d=e.num_lights;n.set_batch_directive(u,"NUM_LIGHTS",d);var f=d%2==0?d/2:Math.floor(d/2)+1;if(n.set_batch_directive(u,"NUM_LFACTORS",f),le(u.shaders_info,e.camera),v.set_directive(u.shaders_info,"SHADOW_USAGE","SHADOW_CASTING"),u.dynamic_grass&&c&&Ee(u,c,i),n.set_batch_directive(u,"SHADOW_TEX_RES",v.glsl_value(a._render.shadow_params.csm_resolution)),!n.update_shader(u))continue}u.dynamic_grass&&(a._render.shadow_params.dynamic_grass_cast=!0);var p=m.init_bundle(u,i,s.batch_world_bounds[E]);m.append_draw_data(e,p),Pe(r,e,u,!1),ce(u)}}if(_){var P=a._render.shadow_params;pe(e,a,A.find_subs(r,m.MAIN_OPAQUE).camera,P,!0)}}(e,t,r,o,_);break;case m.COLOR_PICKING:case m.COLOR_PICKING_XRAY:!function(e,t,r,a,o){for(var _=t.render,i=T.get_scene_data(t,a),s=i.batches,l=0;l<s.length;l++){var c=s[l];if("COLOR_ID"==c.type&&(e.type==m.COLOR_PICKING&&"COLOR_ID"==c.subtype||e.type==m.COLOR_PICKING_XRAY&&"COLOR_ID_XRAY"==c.subtype)&&(o||(se(c,e,t,r,"COLOR_ID",a),n.set_batch_directive(c,"USE_OUTLINE",0),n.update_shader(c)))){var E=m.init_bundle(c,_,i.batch_world_bounds[l]);m.append_draw_data(e,E)}}}(e,t,r,o,_);break;case m.OUTLINE_MASK:!function(e,t,r,a,o){for(var _=t.render,i=T.get_scene_data(t,a),s=i.batches,l=0;l<s.length;l++){var c=s[l];if("COLOR_ID"==c.type&&"OUTLINE"==c.subtype&&(o||(se(c,e,t,r,"COLOR_ID",a),n.set_batch_directive(c,"USE_OUTLINE",1),n.update_shader(c)))){var E=m.init_bundle(c,_,i.batch_world_bounds[l]);m.append_draw_data(e,E)}}}(e,t,r,o,_);break;case m.GRASS_MAP:!function(e,t,r,o){for(var _=t.render,i=T.get_scene_data(t,r),s=i.batches,l=0;l<s.length;l++){var c=s[l];if("GRASS_MAP"==c.type){o||n.update_shader(c)||(n.apply_shader(c,"error.glslv","error.glslf"),n.update_shader(c));var E=m.init_bundle(c,_,i.batch_world_bounds[l]);m.append_draw_data(e,E);var u=e.camera,d=_.bb_world,f=e.grass_map_dim[0],p=e.grass_map_dim[1],P=e.grass_map_dim[2];0==f&&0==p?(f=d.min_z,p=d.max_z):(f=Math.min(f,d.min_z),p=Math.max(p,d.max_z));var S=1e-4*(p-f);p+=S,e.grass_map_dim[0]=f-=S,e.grass_map_dim[1]=p,a.set_frustum2(u,P/2,P/2,-p,-f),a.set_projection(u,!1)}}}(e,t,o,_);break;case m.DEBUG_VIEW:!function(e,t,r,a,o){for(var _=t.render,i=T.get_scene_data(t,a),s=i.batches,l=0;l<s.length;l++){var c=s[l];if("DEBUG_VIEW"==c.type){if(!o){if(c.dynamic_grass){var E=A.find_subs(r,m.GRASS_MAP);E&&Ee(c,E,_)}n.update_shader(c)||(n.apply_shader(c,"error.glslv","error.glslf"),n.update_shader(c))}var u=m.init_bundle(c,_,i.batch_world_bounds[l]);m.append_draw_data(e,u),Pe(r,e,c,!1),ce(c)}}}(e,t,r,o,_)}}function _e(e,t,r,a,o,_){for(var i=t.render,s=T.get_scene_data(t,o),l=s.batches,c=0;c<l.length;c++){var E=l[c];if(!E.shadow_cast_only&&!E.reflexible_only&&("MAIN"==E.type||"NODES_GLOW"==E.type||"PARTICLES"==E.type||"LINE"==E.type)&&("OPAQUE"==E.subtype&&"OPAQUE"==a||"BLEND"==E.subtype&&"BLEND"==a||"XRAY"==E.subtype&&"XRAY"==a||"NODES_GLOW"==E.type&&"GLOW"==a)){_||(se(E,e,t,r,a,o),n.update_shader(E)||(n.apply_shader(E,"error.glslv","error.glslf"),n.update_shader(E)));var u=m.init_bundle(E,i,s.batch_world_bounds[c]);m.append_draw_data(e,u),Pe(r,e,E,!1),ce(E)}}}function ie(e){e.lod_settings.use_smoothing&&n.set_batch_directive(e,"USE_LOD_SMOOTHING",1)}function se(e,t,a,_,i,l){var c=a.render,E=l._render,u=T.get_scene_data(a,l),d="NO_SHADOWS",f=Re(l,[m.SHADOW_CAST]);if(f.length&&e.shadow_receive){switch(i){case"OPAQUE":d="SHADOW_MAPPING_OPAQUE";break;case"BLEND":case"XRAY":d="SHADOW_MAPPING_BLEND";break;case"COLOR_ID":case"REFLECT":case"GLOW":d="NO_SHADOWS";break;case"SHADOW":d="SHADOW_MASK_GENERATION";break;default:r.panic("Wrong subscene type")}for(var p=0;p<f.length;p++)n.assign_shadow_receive_dirs(e,l._render.shadow_params,f[p])}var P="NO_SOFT_SHADOWS";if(E.shadow_params&&E.shadow_params.soft_shadows)switch(N.shadow_blur_samples){case"16x":P="POISSON_X_16";break;case"8x":P="POISSON_X_8";break;case"4x":P="POISSON_X_4"}var S=e.shaders_info;if(v.set_directive(S,"SHADOW_USAGE",d),v.set_directive(S,"POISSON_DISK_NUM",P),ie(e),e.dynamic_grass){var h=A.find_subs(_,m.GRASS_MAP);h&&Ee(e,h,c)}if(le(S,t.camera),"SHADOW"!=e.type&&"COLOR_ID"!=i||e.has_nodes){var O=t.num_lights;v.set_directive(S,"NUM_LIGHTS",O);var R=O%2==0?O/2:Math.floor(O/2)+1;v.set_directive(S,"NUM_LFACTORS",R),v.set_directive(S,"REFLECTION_PASS","REFL_PASS_NONE"),v.set_directive(S,"SSAO_ONLY",0);var I=E.water_params;if(I&&(v.set_directive(S,"WATER_EFFECTS",1),v.set_directive(S,"WAVES_HEIGHT",v.glsl_value(I.waves_height)),v.set_directive(S,"WAVES_LENGTH",v.glsl_value(I.waves_length)),v.set_directive(S,"WATER_LEVEL",v.glsl_value(I.water_level))),t.caustics&&e.caustics){v.set_directive(S,"CAUSTICS",1);var b=E.shadow_params;if(b){var y=b.lamp_types,L=0;for(p=0;p<y.length;p++)"SUN"==y[p]&&(L=p);v.set_directive(S,"SUN_NUM",L)}v.set_directive(S,"CAUST_SCALE",v.glsl_value(t.caust_scale)),v.set_directive(S,"CAUST_SPEED",v.glsl_value(t.caust_speed,2)),v.set_directive(S,"CAUST_BRIGHT",v.glsl_value(t.caust_brightness))}var Y=u.cube_refl_subs,M=u.plane_refl_subs,x=A.find_subs(_,m.SKY),C=A.find_subs(_,m.IRRADIANCE),w=A.find_subs(_,m.ROUGHNESS_CONVOLUTION);if(-1!==e.texture_names.indexOf("u_mirrormap"))v.set_directive(S,"REFLECTION_TYPE","REFL_MIRRORMAP");else if(e.reflective&&C&&w&&!Y&&!M.length)n.append_texture(e,C.camera.color_attachment,"u_cube_irradiance"),n.append_texture(e,w.camera.color_attachment,"u_cube_r_convolution"),v.set_directive(S,"REFLECTION_TYPE","REFL_PBR_STANDARD");else if(!e.reflective||Y||M.length||N.quality==o.P_LOW)if(e.reflective&&Y){var D=Y.camera.color_attachment;E.reflection_params.has_reflexible||(Y.force_do_not_render=!0,x&&(D=x.camera.color_attachment)),n.append_texture(e,D,"u_cube_reflection"),v.set_directive(S,"REFLECTION_TYPE","REFL_CUBE")}else if(e.reflective&&M)for(p=0;p<M.length;p++)n.append_texture(e,D=M[p].camera.color_attachment,"u_plane_reflection"),v.set_directive(S,"REFLECTION_TYPE","REFL_PLANE");else v.set_directive(S,"REFLECTION_TYPE","REFL_NONE");else x?(n.append_texture(e,x.camera.color_attachment,"u_sky_reflection"),v.set_directive(S,"REFLECTION_TYPE","REFL_PBR_SIMPLE")):v.set_directive(S,"REFLECTION_TYPE","REFL_NONE");x?e.draw_proc_sky?n.append_texture(e,D=x.camera.color_attachment,"u_sky"):x.procedural_skydome&&(e.cube_fog=x.cube_fog,v.set_directive(S,"PROCEDURAL_FOG",1)):v.set_directive(S,"PROCEDURAL_FOG",0);var F=E.world_light_set;if(F.use_environment_light)if(v.set_directive(S,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==F.environment_color){if(F.environment_texture_slot){var G=F.environment_texture_slot.texture;D=g.get_batch_texture(F.environment_texture_slot),n.append_texture(e,D,"u_sky_texture",G.name)}else x&&n.append_texture(e,D=x.camera.color_attachment,"u_sky_texture");v.set_directive(S,"SKY_TEXTURE",1)}else"SKY_COLOR"==F.environment_color&&v.set_directive(S,"SKY_COLOR",1);var K=E.world_fog_set;if(K.use_fog&&(v.set_directive(S,"USE_FOG",1),v.set_directive(S,"FOG_TYPE",K.falloff)),e.refractive&&e.blend?(N.depth_tex_available&&v.set_directive(S,"USE_REFRACTION_CORRECTION",1),"MAIN"==e.type&&e.has_nodes||"NODES_GLOW"==e.type?(v.set_directive(S,"REFRACTIVE",1),v.set_directive(S,"USE_REFRACTION",E.refractions?1:0)):v.set_directive(S,"REFRACTIVE",E.refractions?1:0),(E.materials_params.refractions||E.refractions)&&v.set_directive(S,"HAS_REFRACT_TEXTURE",1)):(v.set_directive(S,"REFRACTIVE",0),v.set_directive(S,"USE_REFRACTION",0),v.set_directive(S,"USE_REFRACTION_CORRECTION",0)),e.water&&(N.shore_smoothing&&e.water_shore_smoothing&&A.find_subs(_,m.DEPTH_PACK)?v.set_directive(S,"SHORE_SMOOTHING",1):v.set_directive(S,"SHORE_SMOOTHING",0),v.set_directive(S,"DYNAMIC",e.water_dynamic&&I&&I.waves_height?1:0)),"PARTICLES"==e.type&&v.set_directive(S,"COLOR_RAMP_LENGTH",e.particles_data.color_ramp_length),!e.forked_batch)for(var B=e.textures,X=0;X<B.length;X++)if("SCENE"==(D=B[X]).source)for(var H=0;H<U.length;H++)for(var j=U[H],z=U[H]._render_to_textures,Q=0;Q<z.length;Q++)z[Q]==D&&s.append_edge_attr(k,j,l,null)}}function le(e,t){v.set_directive(e,"CAMERA_TYPE",t.type==a.TYPE_ORTHO||t.type==a.TYPE_ORTHO_ASPECT||t.type==a.TYPE_ORTHO_ASYMMETRIC?"CAM_TYPE_ORTHO":"CAM_TYPE_PERSP")}function ce(e){e.textures.length>8&&P.warn(e.type,"too many textures used - "+e.textures.length+' (max 8), materials "'+e.material_names.join(", ")+'"')}function Ee(e,t,r){e.grass_map_dim=t.grass_map_dim;var n=t.grass_map_dim[0],o=t.grass_map_dim[1],_=t.grass_map_dim[2],i=r.bb_local,s=Math.max(i.max_x-i.min_x,i.max_y-i.min_y);_=0==_?s:Math.max(_,s),t.grass_map_dim[2]=_;var l=t.camera;a.set_frustum2(l,_/2,_/2,-o,-n),a.set_projection(l,!1);var c=e.grass_size||0;c=0==c?s:Math.max(c,s),e.grass_size=c}function ue(e,t,r,a,o,_){for(var i=t.render,s=T.get_scene_data(t,o),l=s.batches,c=0;c<l.length;c++){var E=l[c];if(("MAIN"==E.type||"PARTICLES"==E.type||"LINE"==E.type)&&"REFLECT"==E.subtype&&E.blend==a){if(e.type==m.MAIN_PLANE_REFLECT||e.type==m.MAIN_PLANE_REFLECT_BLEND){if(Ge(o,e)==i.plane_reflection_id)continue}else if(Ke(o,e)==i.cube_reflection_id)continue;if(!_){se(E,e,t,r,"REFLECT",o);var u=E.shaders_info;v.set_directive(u,"WATER_EFFECTS",0),v.set_directive(u,"REFLECTION_PASS",e.type==m.MAIN_PLANE_REFLECT||e.type==m.MAIN_PLANE_REFLECT_BLEND?"REFL_PASS_PLANE":"REFL_PASS_CUBE"),v.set_directive(u,"TEXTURE_NORM",0),n.update_shader(E)||(n.apply_shader(E,"error.glslv","error.glslf"),n.update_shader(E))}if(!m.find_bundle(e,E,i)){var d=m.init_bundle(E,i,s.batch_world_bounds[c]);m.append_draw_data(e,d),Pe(r,e,E,!1),ce(E)}}}}function de(e){!function(e){var t=u.get_scene_objs(e,"LAMP",u.DATA_ID_ALL),r=T.get_shadow_lamps(t,N.ssao&&e.b4w_enable_ssao);if(r.length)for(var n=0;n<r.length;n++)for(var o=r[n],_=o.render,i=jm(_.world_tsr,G),s=Vm(_.world_tsr,B),l=0;l<o.scenes_data.length;l++){var c=o.scenes_data[l],E=c.shadow_subscenes;if(c.scene==e)for(var d=0;d<E.length;d++)a.set_view_trans_quat(E[d].camera,i,s)}}(e);var t=Ie(e,m.MAIN_OPAQUE),r=!0,n=e._render.shadow_params;s.traverse(e._render.graph,(function(a,o){o.type===m.SHADOW_CAST&&(pe(o,e,t.camera,n,r),r=!1)}))}function Te(e){s.traverse(e._render.graph,(function(e,t){t.type===m.OUTLINE&&(t.draw_outline_flag=1)}))}t.update_lamp_scene=ne,t.append_object=function(e,t,r){switch(t.type){case"MESH":case"LINE":case"WORLD":var n=e._render.graph,a=t.render;!A.find_subs(n,m.SHADOW_CAST)&&a.shadow_receive&&(a.shadow_receive=!1);for(var o=Re(e,y),_=0;_<o.length;_++)oe(o[_],t,n,e,r);break;case"LAMP":ne(t,e)}for(var i=T.get_scene_data(t,e),s=i.batches,l=0;l<s.length;l++)null==s[l].shader&&"PHYSICS"!=s[l].type&&(T.scene_data_remove_batch(i,l),l--);T.scene_data_set_active(t,!0,e)},t.init_cube_sky_dim=function(e,t){if(e&&e._render&&e._render.graph){var r=e._render.graph,a=A.find_subs(e._render.graph,m.SKY);if(a){var o=null;if(A.traverse_slinks(r,(function(e,t,r,n){if("CUBEMAP"==e.from&&r.type==m.SKY&&n.type==m.SINK)return o=e.texture,!0})),o){var _=b.cubemap_tex_size,i=n.get_batch_by_type(t,"SKY",e);if(i&&i.has_nodes){var s=E.get_ngraph_proxy_cached(i.ngraph_proxy_id),l=E.get_max_env_texture_height(s.graph);-1!=l&&(_=d.calc_pot_size(l/2))}else{var c=e._render.world_light_set.sky_texture_param;c&&(_=c.tex_size)}_=Math.min(_,R.max_cube_map_texture_size),a.camera.width=_,a.camera.height=_,g.set_cubemap_tex_size(o,_),ae(e,_);var u=A.find_subs(e._render.graph,m.IRRADIANCE);if(u){u.camera.width=32,u.camera.height=32;var T=null;A.traverse_slinks(r,(function(e,t,r,n){if("CUBEMAP"==e.from&&r.type==m.IRRADIANCE&&n.type==m.MAIN_OPAQUE)return T=e.texture,!0})),T&&g.set_cubemap_tex_size(T,32)}var f=A.find_subs(e._render.graph,m.ROUGHNESS_CONVOLUTION);if(f){f.camera.width=128,f.camera.height=128;var p=null;A.traverse_slinks(r,(function(e,t,r,n){if("CUBEMAP"==e.from&&r.type==m.ROUGHNESS_CONVOLUTION&&n.type==m.MAIN_OPAQUE)return p=e.texture,!0})),p&&g.set_cubemap_tex_size(p,128)}}}}},t.update_cube_sky_dim=function(e,t){for(var r=e.scenes_data,n=0;n<r.length;n++){var a=r[n].scene,o=a._render.graph,_=A.find_subs(a._render.graph,m.SKY);if(_){var i=null;if(A.traverse_slinks(o,(function(e,t,r,n){if("CUBEMAP"==e.from&&r.type==m.SKY&&n.type==m.IRRADIANCE)return i=e.texture,!0})),i){var s=d.calc_pot_size(t.height/2);s=Math.min(s,R.max_cube_map_texture_size),_.camera.width=s,_.camera.height=s,g.set_cubemap_tex_size(i,s),ae(a,s)}}}},t.add_object_subs_reflect=ue,t.schedule_shadow_update=function(e){e._render.need_shadow_update=!0},t.update_shadow_billboard_view=function(e,t){s.traverse(t,(function(t,r){var n=r;n.type===m.SHADOW_CAST&&(Dm(e.world_tsr,n.camera.world_tsr),Dm(e.view_tsr,n.camera.shadow_cast_billboard_view_tsr))}))};var fe=function(){var e=dm(),t=ih(),r=Fv();return function(n,a){for(var o=n.camera,_=A.get_outputs(a,n),i=0;i<_.length;i++){var s=_[i];if(s.type==m.MAIN_OPAQUE||s.type==m.SHADOW_RECEIVE||s.type==m.MAIN_BLEND||s.type==m.MAIN_XRAY)if(N.mac_os_shadow_hack)s.v_light_tsr.set(o.view_tsr,9*n.shadow_lamp_index);else{var l=jm(o.view_tsr,t),c=zm(o.view_tsr),E=Vm(o.view_tsr,e);Xv(l[0],l[1],l[2],c,r),s.v_light_ts.set(r,4*n.shadow_lamp_index),s.v_light_r.set(E,4*n.shadow_lamp_index)}}}}();function pe(e,t,r,n,o){if(0!=e.draw_data.length){var _=e.camera;if(Dm(r.world_tsr,_.world_tsr),Dm(r.view_tsr,_.shadow_cast_billboard_view_tsr),"SUN"===n.lamp_types[e.shadow_lamp_index]||"HEMI"===n.lamp_types[e.shadow_lamp_index]){var i=KN(function(e,t,r){!function(e){e.max_x=0,e.min_x=0,e.max_y=0,e.min_y=0,e.max_z=0,e.min_z=0}(r);for(var n=0;n<e.draw_data.length;n++)for(var a=e.draw_data[n].bundles,o=0;o<a.length;o++){var _=a[o].batch,i=a[o].obj_render;if(_.dynamic_grass){var s=Vm(t,B),l=wh(Fg,s,K),c=-l[0],E=l[1],u=jm(t,K),d=u[0]-_.grass_size*(1+c)/2,T=u[1]-_.grass_size*(1-E)/2,f=GN(_.bounds_local.bb,i.world_tsr,Q),p=f.max_z-f.min_z;(P=Q).min_x=d,P.min_y=T,P.min_z=_.grass_map_dim[0]-p,P.max_x=d+_.grass_size,P.max_y=T+_.grass_size,P.max_z=_.grass_map_dim[1]+p}else var P=i.bb_world;0==n&&0==o?CN(P,r):DN(r,P)}return r}(e,r.world_tsr,z),H);if(fO(i,_.view_matrix,i),n.enable_csm){var s=ch(r.csm_centers[e.csm_index],G);fO(s,MA(r.view_matrix,X),s),fO(s,_.view_matrix,s);var l=r.csm_radii[e.csm_index];if(o){V=0,q=-1/0;for(var c=2;c<i.length;c+=3)V=Math.min(V,i[c]),q=Math.max(q,i[c])}(E=z).max_x=s[0]+l,E.max_y=s[1]+l,E.max_z=q,E.min_x=s[0]-l,E.min_y=s[1]-l,E.min_z=V}else{var E,u=function(e,t){var r=j;r.set(e);var n=D/9,a=LA(X);DA(a,n,Fg,a);for(var o=-1,_=-1,i=0;i<10;i++){var s=FN(r,0,r.length,Q),l=(s.max_x-s.min_x)*(s.max_y-s.min_y);(-1==o||o-l>.1)&&(o=l,_=i,CN(s,t)),fO(r,a,r)}return _*n}(i,E=z);if(u>0){var d=LA(X);DA(d,u,Fg,d),wA(d,_.view_matrix,_.view_matrix),eg(_.view_matrix,_.view_tsr)}E=function(e){var t=e.max_x-e.min_x,r=e.max_y-e.min_y;if(t&&r){var n=Math.abs(t-r)/2;t/r>2?(e.max_y+=n,e.min_y-=n):r/t>2&&(e.max_x+=n,e.min_x-=n)}return e.max_x+=.005,e.max_y+=.005,e.max_z+=.005,e.min_x-=.005,e.min_y-=.005,e.min_z-=.005,e}(E),fe(e,t._render.graph)}a.set_frustum_asymmetric(_,E.min_x,E.max_x,E.min_y,E.max_y,-E.max_z,-E.min_z),a.set_projection(_,!1)}else"SPOT"!==n.lamp_types[e.shadow_lamp_index]&&"POINT"!==n.lamp_types[e.shadow_lamp_index]||a.set_projection(_,!1)}}function Pe(e,t,a,o){var _=s.node_by_attr(e,t);s.traverse_inputs(e,_,(function(e,t,_){var i=_,s=t;if(i.active){switch(i.from){case"COLOR":case"CUBEMAP":var l=s.camera.color_attachment;break;case"DEPTH":l=s.camera.depth_attachment;break;case"SCREEN":l=null;break;case m.MAIN_CUBE_REFLECT:return;default:r.panic("Wrong slink")}switch(i.to){case"COLOR":case"CUBEMAP":case"DEPTH":case"NONE":case"SCREEN":case"OFFSCREEN":case"RESOLVE":case"COPY":case"u_cube_reflection":case"u_plane_reflection":break;default:if(!l){if(o)return;r.panic("Connection of SCREEN is forbidden")}l.w_renderbuffer&&r.panic("Batch texture can't use renderbuffer"),v.check_uniform(a.shader,i.to)&&(o?n.replace_texture(a,l,i.to):n.append_texture(a,l,i.to))}}}));for(var i=0;i<t.slinks_internal.length;i++){var l=t.slinks_internal[i],c=t.textures_internal[i];switch(l.to){case"COLOR":case"CUBEMAP":case"DEPTH":case"NONE":case"SCREEN":case"OFFSCREEN":case"RESOLVE":case"COPY":break;default:c.w_renderbuffer&&r.panic("Batch texture can't use renderbuffer"),v.check_uniform(a.shader,l.to)&&(o?n.replace_texture(a,c,l.to):n.append_texture(a,c,l.to))}}}function Se(e,t){if(e.render.hide=t,T.is_lamp(e))for(var r=0;r<e.scenes_data.length;r++)for(var n=e.scenes_data[r],a=Re(n.scene,L),o=0;o<a.length;o++)s=(_=e).render,(i=a[o]).light_positions[4*(c=n.light_index)+3]=(l=_.light).use_diffuse&&!s.hide?1:0,i.light_color_intensities[4*c+3]=l.use_specular&&!s.hide?1:0,i.need_perm_uniforms_update=!0;var _,i,s,l,c}t.update_shadow_receive_subs=fe,t.get_csm_borders=function(e,t){for(var r=e._render.shadow_params,n=new Float32Array(r.csm_num),o=0;o<r.csm_num;o++)n[o]=a.csm_far_plane(r,t,o);return n},t.connect_render_targets_batch=Pe,t.change_visibility_rec=function e(t,r){Se(t,r);for(var n=0;n<t.cons_descends.length;n++)t.cons_descends[n].parent==t&&e(t.cons_descends[n],r)},t.change_visibility=Se,t.is_hidden=function(e){return e.render.hide},t.remove_object_bundles=function(e,t){for(var r=0;r<e.scenes_data.length;r++)for(var a=Re(e.scenes_data[r].scene,y),o=0;o<a.length;o++)for(var _=a[o].draw_data,i=0;i<_.length;i++)for(var s=_[i].bundles,l=s.length-1;l>=0;l--){var c=s[l];c.obj_render==e.render&&(c.batch?void 0!==t&&-1==c.batch.material_names.indexOf(t)&&0!=c.batch.material_names.length||(n.clear_batch(c.batch),s.splice(l,1)):s.splice(l,1))}},t.update_lamp_scene_color_intensity=function(e,t){for(var r=e.light,n=T.get_scene_data(e,t).light_index,a=Re(t,L),o=0;o<a.length;o++){var _=a[o];_.light_color_intensities.set(r.color_intensity,4*n),_.need_perm_uniforms_update=!0}};var Ae=function(){var e=ih(),t=Fv();return function(r,n,a){var o=r.render,_=r.light,i=n.light_index,s=jm(r.render.world_tsr,e),l=_.color_intensity;a.light_directions.set(_.direction,3*i),t[0]=s[0],t[1]=s[1],t[2]=s[2],t[3]=_.use_diffuse&&!o.hide?1:0,a.light_positions.set(t,4*i),t[0]=l[0],t[1]=l[1],t[2]=l[2],t[3]=_.use_specular&&!o.hide?1:0,a.light_color_intensities.set(t,4*i),a.need_perm_uniforms_update=!0}}();function he(e){var t=Ie(e,m.SKY);t&&ve(e,t)}function ve(e,t){if(f.prerender_subs(t),S.draw(t),t.need_fog_update)for(var r=Re(e,Y),a=0;a<r.length;a++)for(var o=r[a].draw_data,_=0;_<o.length;_++)for(var i=o[_].bundles,s=0;s<i.length;s++){var l=i[s];if(l.do_render){var c=l.batch;n.check_batch_perm_uniform(c,"u_cube_fog")&&S.update_batch_permanent_uniform(c,"u_cube_fog")}}!function(e){var t=Ie(e,m.IRRADIANCE);t&&(f.prerender_subs(t),S.draw(t));var r=Ie(e,m.ROUGHNESS_CONVOLUTION);r&&(f.prerender_subs(r),S.draw(r));var n=Ie(e,m.BRDF);n&&(f.prerender_subs(n),S.draw(n))}(e)}function me(e){var t=e.camera;S.render_target_cleanup(t.framebuffer,t.color_attachment,t.depth_attachment,t.width,t.height);for(var r=e.draw_data,a=0;a<r.length;a++)for(var o=r[a].bundles,_=0;_<o.length;_++){var i=o[_].batch;i&&n.clear_batch(i)}}function ge(e){for(var t=[],r=0;r<e.length;r++)for(var n=e[r]._object.materials,a=0;a<n.length;a++){var o=n[a];-1==t.indexOf(o)&&t.push(o)}return t}function Oe(e,t,r,n){var a=t,o=r;_.is_hidpi()&&(a*=window.devicePixelRatio,o*=window.devicePixelRatio);var i=J();if(i){var s=i._render;a*=s.resolution_factor,o*=s.resolution_factor}return a*=e.size_mult_x,o*=e.size_mult_y,n[0]=Math.floor(a),n[1]=Math.floor(o),n}function Ne(e,t,r){var n=e._render,o=T.get_scene_data(e._camera,e).cameras;if(0!=r)var _=t/r;else _=1;for(var i=0;i<o.length;i++){var s=o[i];a.set_aspect(s,_),a.set_projection(s,!1),n.shadow_params&&a.update_camera_shadows(s,n.shadow_params)}if(n.shadow_params){n.need_shadow_update=!0;var l=Re(e,[m.SHADOW_RECEIVE]);for(i=0;i<l.length;i++)l[i].need_perm_uniforms_update=!0;var c=Re(e,[m.MAIN_BLEND]);for(i=0;i<c.length;i++)c[i].need_perm_uniforms_update=!0}!function(e,t,r){var n=e._render.graph,a=1/0;A.traverse_slinks(n,(function(e,n,o,_){e.update_dim&&(a=Math.min(a,function(e,t,r){var n=Oe(e,t,r,F);return n[0]>R.max_texture_size||n[1]>R.max_texture_size?(P.warn("Texture size exceeds platform limits, downscaling"),Math.min(R.max_texture_size/n[0],R.max_texture_size/n[0])):1}(e,t,r)))})),A.traverse_slinks(n,(function(o,_,i,s){var l,c,E;if(o.update_dim)if(s&&s.type==m.SINK||i.is_pp&&!o.apply_resolution_factors?(l=t*o.size_mult_x,c=r*o.size_mult_y):(l=(E=Oe(o,t,r,F))[0]*a,c=E[1]*a),_)for(var u=0;u<i.slinks_internal.length;u++)i.slinks_internal[u]==o&&g.resize(o.texture,l,c);else{g.is_texture(o.texture)&&(g.resize(o.texture,l,c),o.texture.use_mipmap&&(s.last_mip_map_ind=o.texture.mipmap_count));var d=i.camera;switch(d.width=l,d.height=c,i.type){case m.DOF:ye(e,{dof_power:i.camera.dof_power});break;case m.GLOW_COMBINE:Me(e,{small_glow_mask_width:i.small_glow_mask_width,large_glow_mask_width:i.large_glow_mask_width});break;case m.BLOOM:Ye(e,{blur:i.bloom_blur});break;case m.RESIZE:d.width=d.color_attachment.width,d.height=d.color_attachment.height;break;case m.OUTLINE:var T=A.find_input(n,i,m.POSTPROCESSING),f=A.find_input(n,T,m.POSTPROCESSING),p=A.find_input(n,f,m.POSTPROCESSING),P=A.find_input(n,p,m.POSTPROCESSING);A.set_texel_size(T,1/l,1/l),A.set_texel_size(f,1/l,1/l),A.set_texel_size(p,1/l,1/l),A.set_texel_size(P,1/l,1/l);break;default:A.set_texel_size(i,1/l,1/c)}}}))}(e,t,r)}function Re(e,t){for(var r=[],n=0;n<t.length;n++){var a=t[n];e._render.graph&&s.traverse(e._render.graph,(function(e,t){t.type==a&&r.push(t)}))}return r}function Ie(e,t){return A.find_subs(e._render.graph,t)}function be(e){var t=J();t&&s.traverse(t._render.graph,(function(t,r){var n=r.camera;n&&n.type==a.TYPE_HMD_RIGHT&&(r.force_do_not_render=e)}))}function ye(e,t){var r=Re(e,[m.DOF]);if(!r.length)return P.error("DOF is not enabled on the scene. Check camera settings"),0;for(var n=0;n<r.length;n++)Le(r[n],t,e)}function Le(e,t,r){var n=e.dof_bokeh,a=n?Re(r,[m.COC]):[],o=r._render.graph;if("boolean"==typeof t.dof_on&&(e.camera.dof_on=t.dof_on,n))for(var _=0;_<a.length;_++)a[_].camera.dof_on=t.dof_on;if("number"==typeof t.dof_distance&&(e.camera.dof_distance=t.dof_distance,n))for(_=0;_<a.length;_++)a[_].camera.dof_distance=t.dof_distance;if("number"==typeof t.dof_front_start&&(e.camera.dof_front_start=t.dof_front_start,n))for(_=0;_<a.length;_++)a[_].camera.dof_front_start=t.dof_front_start;if("number"==typeof t.dof_front_end&&(e.camera.dof_front_end=t.dof_front_end,n))for(_=0;_<a.length;_++)a[_].camera.dof_front_end=t.dof_front_end;if("number"==typeof t.dof_rear_start&&(e.camera.dof_rear_start=t.dof_rear_start,n))for(_=0;_<a.length;_++)a[_].camera.dof_rear_start=t.dof_rear_start;if("number"==typeof t.dof_rear_end&&(e.camera.dof_rear_end=t.dof_rear_end,n))for(_=0;_<a.length;_++)a[_].camera.dof_rear_end=t.dof_rear_end;if("number"==typeof t.dof_bokeh_intensity&&(e.camera.dof_bokeh_intensity=t.dof_bokeh_intensity,n&&((d=A.get_inputs_by_type(o,e,m.POSTPROCESSING))[0].camera.dof_bokeh_intensity=t.dof_bokeh_intensity,d[1].camera.dof_bokeh_intensity=t.dof_bokeh_intensity,d[0]=A.find_input(o,d[0],m.POSTPROCESSING),d[0].camera.dof_bokeh_intensity=t.dof_bokeh_intensity)),"number"==typeof t.dof_power)if(n){var i=t.dof_power;e.camera.dof_power=i,i/=2;var s=e.camera.width,l=e.camera.height,c=[1/s,0],E=[1/s*.5,1/l*.866],u=[-1/s*.5,1/l*.866],d=A.get_inputs_by_type(o,e,m.POSTPROCESSING);A.set_texel_size_mult(d[0],i),A.set_texel_size(d[0],u[0],u[1]),A.set_texel_size_mult(d[1],i),A.set_texel_size(d[1],E[0],E[1]),d[0]=A.find_input(o,d[0],m.POSTPROCESSING),A.set_texel_size_mult(d[0],i),A.set_texel_size(d[0],c[0],c[1]),e.camera.dof_foreground_blur&&(d[0]=A.find_input(o,d[0],m.COC),d[0]=A.find_input(o,d[0],m.POSTPROCESSING),A.set_texel_size(d[0],1/s,1/l),d[0]=A.find_input(o,d[0],m.POSTPROCESSING),A.set_texel_size(d[0],1/s,1/l))}else{e.camera.dof_power=t.dof_power;var T=A.find_input(o,e,m.POSTPROCESSING),f=A.find_input(o,T,m.POSTPROCESSING);A.set_texel_size_mult(T,e.camera.dof_power),A.set_texel_size(T,1/e.camera.width,1/e.camera.height),A.set_texel_size_mult(f,e.camera.dof_power),A.set_texel_size(f,1/e.camera.width,1/e.camera.height)}}function Ye(e,t){var r=Re(e,[m.LUMINANCE_TRUNCED]),n=Re(e,[m.BLOOM]);if(!r.length||!n.length)return P.error("Bloom is not enabled on the scene"),0;if("number"==typeof t.key)for(var a=0;a<r.length;a++)r[a].bloom_key=t.key,r[a].need_perm_uniforms_update=!0;if("number"==typeof t.edge_lum)for(a=0;a<r.length;a++)r[a].bloom_edge_lum=t.edge_lum,r[a].need_perm_uniforms_update=!0;if("number"==typeof t.blur)for(a=0;a<n.length;a++){n[a].bloom_blur=t.blur;for(var o=e._render.graph,_=n[a].camera.width/.5,i=n[a].camera.height/.5,s=A.get_inputs_by_type(o,n[a],m.POSTPROCESSING),l=0;l<s.length;++l){var c=s[l],E=A.find_input(o,c,m.POSTPROCESSING),u=_*c.bloom_blur_scale,d=i*c.bloom_blur_scale;A.set_texel_size_mult(c,t.blur),A.set_texel_size(c,1/u,1/d),A.set_texel_size_mult(E,t.blur),A.set_texel_size(E,1/u,1/d)}}if("number"==typeof t.average_luminance)for(a=0;a<r.length;a++)r[a].adaptive_bloom||(r[a].average_luminance=t.average_luminance,r[a].need_perm_uniforms_update=!0)}function Me(e,t){var r=Re(e,[m.GLOW_COMBINE]);if(!r.length)return P.error("Glow is not enabled on the scene"),null;for(var n=0;n<r.length;n++)xe(r[n],t,e)}function xe(e,t,r){for(var n=r._render.graph,a=A.get_inputs(n,e),o=0;o<a.length;++o){var _=a[o];if(_.type==m.POSTPROCESSING&&"GLOW_MASK_LARGE"==_.subtype)var i=_;if(_.type==m.POSTPROCESSING&&"GLOW_MASK_SMALL"==_.subtype)var s=_}var l=A.find_input(n,i,m.POSTPROCESSING),c=A.find_input(n,s,m.POSTPROCESSING);"number"==typeof t.small_glow_mask_coeff&&(e.small_glow_mask_coeff=t.small_glow_mask_coeff,e.need_perm_uniforms_update=!0),"number"==typeof t.large_glow_mask_coeff&&(e.large_glow_mask_coeff=t.large_glow_mask_coeff,e.need_perm_uniforms_update=!0),"number"==typeof t.small_glow_mask_width&&(e.small_glow_mask_width=t.small_glow_mask_width,A.set_texel_size_mult(s,t.small_glow_mask_width),A.set_texel_size(s,1/e.camera.width,1/e.camera.height),s.need_perm_uniforms_update=!0,A.set_texel_size_mult(c,t.small_glow_mask_width),A.set_texel_size(c,1/e.camera.width,1/e.camera.height),c.need_perm_uniforms_update=!0),"number"==typeof t.large_glow_mask_width&&(e.large_glow_mask_width=t.large_glow_mask_width,A.set_texel_size_mult(i,t.large_glow_mask_width),A.set_texel_size(i,1/e.camera.width,1/e.camera.height),i.need_perm_uniforms_update=!0,A.set_texel_size_mult(l,t.large_glow_mask_width),A.set_texel_size(l,1/e.camera.width,1/e.camera.height),l.need_perm_uniforms_update=!0)}function Ce(e,t,r){var n=e._render,a=n.water_params;if(!a.dynamic)return a.water_level;var o=a.waves_height,_=a.waves_length,i=a.water_level,s=mh(n.wind)||1,l=Ie(e,m.MAIN_OPAQUE).time,c=F;c[0]=20/_*(t-.25*(l*=s)),c[1]=20/_*(r-.25*l);var E=YO(c);c[0]=17/_*(r+.1*l),c[1]=17/_*(t+.1*l);var u=E+YO(c)-1,d=a.dst_noise_scale0,T=a.dst_noise_scale1,f=a.dst_noise_freq0,p=a.dst_noise_freq1,P=F;P[0]=d*(t+f*l),P[1]=d*(r+f*l);var S=IO(P);P[0]=T*(r-p*l),P[1]=T*(t-p*l);var A=o*S*IO(P);if(a.shoremap_image){var h=(t-a.shoremap_center[0])/a.shoremap_size[0],v=(a.shoremap_center[1]+r)/a.shoremap_size[1];if(v+=.5,(h+=.5)>1||h<0||v>1||v<0)var g=A;else{var O=GO(n.shore_distances,a.shoremap_tex_size,h,v),N=a.dir_min_shore_fac,R=a.dir_freq,I=a.dir_noise_scale,b=a.dir_noise_freq,y=a.dir_min_noise_fac,L=a.dst_min_fac,Y=_/a.max_shore_dist/Math.PI,M=[I/_*(t+b*l),I/_*(r+b*l)],x=Math.sqrt(O),C=o*Math.max(O,N)*Math.sin(x/Y+R*l)*Math.max(IO(M),y),w=Math.max(x,L);g=C*(1-w)+A*w,u*=O}}else g=A;return i+(g+.05*u)}function we(e,t,r){t.is_for_outline&&t.type==m.POSTPROCESSING&&r.do_render!=t.do_render&&(t.do_render=r.do_render),r.do_render||t.type!=m.OUTLINE||(t.draw_outline_flag=0)}function Ue(e,t,r,a){for(var o=s.get_node_attr(e,t).draw_data,_=0;_<o.length;_++)for(var i=o[_].bundles,l=0;l<i.length;l++)n.replace_texture(i[l].batch,a,r)}function ke(e){for(var t=Re(e,[m.GRASS_MAP]),r=0;r<t.length;r++){var n=t[r],o=n.camera,_=e._camera.render,i=jm(_.world_tsr,G),s=K;s[0]=0,s[1]=0,s[2]=-n.grass_map_dim[2]/2;var l=Vm(_.world_tsr,B);wh(s,l,s),s[0]+=i[0],s[1]+=i[1],s[2]=0,hm(l),a.set_view_trans_quat(o,s,l)}}function De(e,t){s.traverse(e,(function(n,o){var _=o;if(_.type==m.MOTION_BLUR){_.slinks_internal[0]&&_.textures_internal[0]||r.panic("Wrong MOTION_BLUR subscene");var i=_.slinks_internal[0],l=_.textures_internal[0];_.textures_internal[0]=_.camera.color_attachment,s.traverse_outputs(e,n,(function(t,r,n){n.active&&Ue(e,t,n.to,l)})),function e(t,r,n,o){var _=s.get_node_attr(t,r);a.set_attachment(_.camera,n,o),_.assign_texture=!0,s.traverse_outputs(t,r,(function(e,r,a){var _=a;_.active&&_.from==n&&A.check_slink_tex_conn(_)&&Ue(t,e,_.to,o)})),s.traverse_inputs(t,r,(function(r,a,_){_.active&&_.from==n&&_.from==_.to&&e(t,r,n,o)}))}(e,n,i.from,l),Ue(e,n,i.to,_.textures_internal[0]),_.motion_blur_exp=Math.exp(-t/_.mb_factor)}}))}function Fe(e){return e._render.wind}function Ge(e,t){for(var r=e._render.reflection_params.plane_refl_subs,n=0;n<r.length;n++)for(var a=0;a<r[n].length;a++)if(r[n][a]==t)return n;var o=e._render.reflection_params.plane_refl_subs_blend;for(n=0;n<o.length;n++)for(a=0;a<o[n].length;a++)if(o[n][a]==t)return n;return null}function Ke(e,t){if(!e._render.reflection_params)return null;for(var r=e._render.reflection_params.cube_refl_subs,n=0;n<r.length;n++)if(r[n]==t)return n;var a=e._render.reflection_params.cube_refl_subs_blend;for(n=0;n<a.length;n++)if(a[n]==t)return n;return null}t.update_sky_texture=function(e){for(var t=e.scenes_data,r=0;r<t.length;r++)he(t[r].scene)},t.update_world_texture=he,t.update_sky=ve,t.cleanup=function(){for(var e=0;e<U.length;e++){var t=U[e];s.traverse(t._render.graph,(function(e,t){t.type!=m.SINK&&me(t)})),t._render.graph=null,t._render.queue=[]}C=null,w=null,U.length=0,k=null},t.clear_subscene=me,t.make_frustum_shot=function(e,t,r){var o,_=a.extract_frustum_corners(e,e.near,e.far,null,!0),i=p.generate_frustum(_),s=T.create_render("DYNAMIC");s.bb_world=s.bb_local={max_x:1e12,min_x:-1e12,max_y:1e12,min_y:-1e12,max_z:1e12,min_z:-1e12},s.bs_world=s.bs_local=(o||(o=zN()),Eh(0,0,0,o.center),o.radius=1e12,o);var l=s.bs_world.radius;s.be_world=s.be_local=WN([l,0,0],[0,l,0],[0,0,l],s.bs_world.center);var c=n.create_shadeless_batch(i,r,.5);c.do_not_cull=!0;var E=m.init_bundle(c,s);m.append_draw_data(t,E)},t.get_scene_timeline=function(e){return[e.frame_start,e.frame_end]},t.setup_dim=function(e,t,r){_.setup_viewport_dim(e,t,r),w&&Ne(w,e,t)},t.subs_array=Re,t.get_subs=Ie,t.render_both_eyes=function(){be(!1)},t.render_one_eye=function(){be(!0)},t.get_environment_colors=function(e){var t=Ie(e,m.MAIN_OPAQUE),r=t.horizon_color,n=t.zenith_color,a=[],o=[];return a[0]=r[0],a[1]=r[1],a[2]=r[2],o[0]=n[0],o[1]=n[1],o[2]=n[2],[t.environment_energy,a,o]},t.set_environment_colors=function(e,t,r,n){for(var a=Re(e,L),o=0;o<a.length;o++){var _=a[o];_.horizon_color.set(r),_.zenith_color.set(n),_.environment_energy=t,_.need_perm_uniforms_update=!0}var i=A.find_subs(e._render.graph,m.SKY);i&&ve(e,i)},t.get_sky_params=function(e){var t=Ie(e,m.SKY);if(t&&t.procedural_skydome){var r={};return r.color=new Array(3),ch(t.sky_color,r.color),r.procedural_skydome=t.procedural_skydome,r.use_as_environment_lighting=t.use_as_environment_lighting,r.rayleigh_brightness=t.rayleigh_brightness,r.mie_brightness=t.mie_brightness,r.spot_brightness=t.spot_brightness,r.scatter_strength=t.scatter_strength,r.rayleigh_strength=t.rayleigh_strength,r.mie_strength=t.mie_strength,r.rayleigh_collection_power=t.rayleigh_collection_power,r.mie_collection_power=t.mie_collection_power,r.mie_distribution=t.mie_distribution,r}return null},t.get_fog_intensity=function(e){return Re(e,Y)[0].fog_params[0]},t.get_fog_depth=function(e){return Re(e,Y)[0].fog_params[1]},t.get_fog_start=function(e){return Re(e,Y)[0].fog_params[2]},t.get_fog_height=function(e){return Re(e,Y)[0].fog_params[3]},t.set_fog_intensity=function(e,t){for(var r=Re(e,Y),n=0;n<r.length;n++){var a=r[n];a.fog_params[0]=t,a.need_perm_uniforms_update=!0}},t.set_fog_depth=function(e,t){for(var r=Re(e,Y),n=0;n<r.length;n++){var a=r[n];a.fog_params[1]=t,a.need_perm_uniforms_update=!0}},t.set_fog_start=function(e,t){for(var r=Re(e,Y),n=0;n<r.length;n++){var a=r[n];a.fog_params[2]=t,a.need_perm_uniforms_update=!0}},t.set_fog_height=function(e,t){for(var r=Re(e,Y),n=0;n<r.length;n++){var a=r[n];a.fog_params[3]=t,a.need_perm_uniforms_update=!0}},t.get_fog_color_density=function(e,t){var r=t||[],n=Re(e,Y)[0].fog_color_density;return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r},t.set_fog_color_density=function(e,t){for(var r=Re(e,Y),n=0;n<r.length;n++){var a=r[n];a.fog_color_density.set(t),a.need_perm_uniforms_update=!0}},t.get_ssao_params=function(e){var t=Ie(e,m.SSAO),r=Ie(e,m.SSAO_BLUR),n=Ie(e,m.MAIN_OPAQUE);if(!t)return null;var a={};return a.quality=t.ssao_samples,a.use_hemisphere=t.ssao_hemisphere,a.use_blur_depth=r.ssao_blur_depth,a.blur_discard_value=r.ssao_blur_discard_value,a.radius_increase=t.ssao_radius_increase,a.influence=t.ssao_influence,a.dist_factor=t.ssao_dist_factor,a.ssao_only=n.ssao_only,a.ssao_white=t.ssao_white,a},t.get_dof_params=function(e){var t=Ie(e,m.DOF);if(!t)return null;var r={};return r.dof_on=t.camera.dof_on,r.dof_bokeh=t.dof_bokeh,r.dof_distance=t.camera.dof_distance,r.dof_front_start=t.camera.dof_front_start,r.dof_front_end=t.camera.dof_front_end,r.dof_rear_start=t.camera.dof_rear_start,r.dof_rear_end=t.camera.dof_rear_end,r.dof_power=t.camera.dof_power,r.dof_bokeh_intensity=t.camera.dof_bokeh_intensity,r.dof_object=t.camera.dof_object,r},t.set_dof_params=ye,t.get_god_rays_params=function(e){var t=Re(e,[m.GOD_RAYS]),r=Ie(e,m.GOD_RAYS_COMBINE);if(!t||!r)return null;var a={};return a.god_rays_max_ray_length=t[0].max_ray_length,a.god_rays_intensity=r.god_rays_intensity,a.god_rays_steps=n.get_batch_directive(t[0].draw_data[0].bundles[0].batch,"STEPS_PER_PASS")[1],a},t.set_god_rays_params=function(e,t){var r=Re(e,[m.GOD_RAYS]),a=Re(e,[m.GOD_RAYS_COMBINE]);if(!r.length||!a.length)return P.error("God Rays are not enabled on the scene"),0;if("number"==typeof t.god_rays_intensity)for(var o=0;o<a.length;o++)a[o].god_rays_intensity=t.god_rays_intensity;if("number"==typeof t.god_rays_max_ray_length){var _=t.god_rays_max_ray_length;for(o=0;o<r.length;o++)r[o].max_ray_length=_,r[o].radial_blur_step=_/r[o].steps_per_pass/(o+1),r[o].need_perm_uniforms_update=!0}if("number"==typeof t.god_rays_steps){var i=v.glsl_value(t.god_rays_steps,1);for(_=r[0].max_ray_length,o=0;o<r.length;o++){r[o].steps_per_pass=i,r[o].radial_blur_step=_/i/(o+1),r[o].need_perm_uniforms_update=!0;var s=r[o].draw_data[0].bundles[0],l=s.batch;n.set_batch_directive(l,"STEPS_PER_PASS",i),n.update_shader(l),m.append_draw_data(r[o],s)}}for(o=0;o<a.length;o++)a.need_perm_uniforms_update=!0},t.get_bloom_params=function(e){var t=Ie(e,m.LUMINANCE_TRUNCED),r=Ie(e,m.BLOOM);if(!t||!r)return null;var n={};return n.key=t.bloom_key,n.edge_lum=t.bloom_edge_lum,n.blur=r.bloom_blur,n.adaptive=t.adaptive_bloom,n.average_luminance=t.average_luminance,n},t.set_bloom_params=Ye,t.get_glow_material_params=function(e){var t=Ie(e,m.GLOW_COMBINE);if(!t)return null;var r={};return r.small_glow_mask_coeff=t.small_glow_mask_coeff,r.large_glow_mask_coeff=t.large_glow_mask_coeff,r.small_glow_mask_width=t.small_glow_mask_width,r.large_glow_mask_width=t.large_glow_mask_width,r},t.set_glow_material_params=Me,t.get_wind_params=function(e){var t=Fe(e),r=mh(t);if(0==r)return null;var n=RO(Math.atan2(t[0],-t[1])),a={};return a.wind_dir=n,a.wind_strength=r,a},t.schedule_grass_map_update=function(e){e._render.need_grass_map_update=!0},t.get_water_surface_level=Ce,t.get_water_mat_params=function(e,t){var r=e._render.water_params,n=Ie(e,m.MAIN_OPAQUE);if(n&&r){t.waves_height=r.waves_height,t.waves_length=r.waves_length,t.water_fog_density=n.water_fog_color_density[3];var a=t.water_fog_color=[];a[0]=n.water_fog_color_density[0],a[1]=n.water_fog_color_density[1],a[2]=n.water_fog_color_density[2]}},t.set_water_params=function(e,t){var r=e._render.water_params;if(!r)return P.error("set_water_params() - no water parameters on the scene"),null;"number"==typeof t.dst_noise_scale0&&(r.dst_noise_scale0=t.dst_noise_scale0),"number"==typeof t.dst_noise_scale1&&(r.dst_noise_scale1=t.dst_noise_scale1),"number"==typeof t.dst_noise_freq0&&(r.dst_noise_freq0=t.dst_noise_freq0),"number"==typeof t.dst_noise_freq1&&(r.dst_noise_freq1=t.dst_noise_freq1),"number"==typeof t.dir_min_shore_fac&&(r.dir_min_shore_fac=t.dir_min_shore_fac),"number"==typeof t.dir_freq&&(r.dir_freq=t.dir_freq),"number"==typeof t.dir_noise_scale&&(r.dir_noise_scale=t.dir_noise_scale),"number"==typeof t.dir_noise_freq&&(r.dir_noise_freq=t.dir_noise_freq),"number"==typeof t.dir_min_noise_fac&&(r.dir_min_noise_fac=t.dir_min_noise_fac),"number"==typeof t.dst_min_fac&&(r.dst_min_fac=t.dst_min_fac),"number"==typeof t.waves_hor_fac&&(r.waves_hor_fac=t.waves_hor_fac),"number"==typeof t.water_dynamic&&(r.dynamic=t.water_dynamic);for(var n=Re(e,x),a=0;a<n.length;a++){var o=n[a];"number"==typeof t.water_fog_density&&r.fog_color_density&&(o.water_fog_color_density[3]=t.water_fog_density),"object"==typeof t.water_fog_color&&r.fog_color_density&&o.water_fog_color_density.set(t.water_fog_color),o.need_perm_uniforms_update=!0}},t.get_shore_dist=function(e,t,r){var n=e._render.water_params;if(!n.shoremap_image)return 100;var a=n.water_level,o=(t[0]-n.shoremap_center[0])/n.shoremap_size[0],_=(n.shoremap_center[1]+t[1])/n.shoremap_size[1];if(_+=.5,!((o+=.5)>1||o<0||_>1||_<0)){var i=n.max_shore_dist*GO(w._render.shore_distances,n.shoremap_tex_size,o,_),s=(a-t[2])*r;return Math.sqrt(i*i+s*s)}},t.update=function(e,t){S.clear();for(var r=$()._camera.render,n=0;n<U.length;n++){var a=(h=U[n])._render.graph;if((v=h._render).water_params){var o=jm(r.world_tsr,G),_=o[2]-Ce(h,o[0],o[1]);Km(o,r.world_tsr)}for(var i=0;i<v.video_textures.length;i++){var c=v.video_textures[i]._render,E=c.video_file,u=c.seq_video;if((!h.b4w_use_nla||!c.use_nla)&&(E||u)&&g.video_is_played(c)){var d=g.video_get_current_frame(c),T=g.video_get_start_frame(c);E&&N.is_mobile_device&&(T-=5);var p=g.video_get_end_frame(c);if(d>=p&&c.use_cyclic||d<T)g.reset_video(c),u&&(c.seq_last_discrete_mark=g.seq_video_get_discrete_timemark(c,e));else if(d>=p&&!c.use_cyclic)g.pause_video(c);else if(g.video_update_is_available(c))if(E)g.update_video_texture(c);else{var P=g.seq_video_get_discrete_timemark(c,e);P!=c.seq_last_discrete_mark&&(g.update_seq_video_texture(c),c.seq_cur_frame++),c.seq_last_discrete_mark=P}}}s.traverse(a,(function(t,r){var n=r;M.indexOf(n.type)>-1&&(n.time=e),v.water_params&&(n.cam_water_depth=_)}))}for(n=0;n<U.length;n++){a=(v=(h=U[n])._render).graph;var h,v,O=v.queue;if(O.length){v.need_shadow_update&&(de(h),v.need_shadow_update=!1),v.need_grass_map_update&&(ke(h),v.need_grass_map_update=!1),v.need_outline&&(Te(h),v.need_outline=!1),v.motion_blur&&De(a,t);var R=A.find_subs(a,m.OUTLINE_MASK);for(i=0;i<O.length;i++){var I=O[i];f.prerender_subs(I),R&&we(0,I,R),S.draw(I)}}}N.show_hud_debug_info&&l.show_debug_info(U,t)},t.request_outline=function(e){e._render.need_outline=!0},t.get_all_subscenes=function(e){var t=[];return s.traverse(e._render.graph,(function(e,r){t.push(r)})),t},t.get_cam_water_depth=function(){var e=Ie(w,m.MAIN_BLEND);return e||w._render.water_params?e.cam_water_depth:null},t.update_scene_permanent_uniforms=function(e){s.traverse(e._render.graph,(function(e,t){t.need_perm_uniforms_update=!0}))},t.set_debug_view_mode=function(e,t){e.debug_view_mode=t,e.do_render=t!=i.DV_NONE,e.blend=t==i.DV_TRANSPARENT_WIREFRAME,e.need_perm_uniforms_update=!0;for(var r=$(),n=0;n<x.length;n++)for(var a=Re(r,[x[n]]),o=0;o<a.length;o++)a[o].do_not_debug=t==i.DV_RENDER_TIME},t.set_debug_colors_seed=function(e,t){e.debug_colors_seed=t,e.need_perm_uniforms_update=!0},t.set_render_time_threshold=function(e,t){e.debug_render_time_threshold=t,e.need_perm_uniforms_update=!0},t.set_wireframe_edge_color=function(e,t){for(var r=e.draw_data,n=0;n<r.length;n++)for(var a=r[n].bundles,o=0;o<a.length;o++){var _=a[o].batch;ch(t,_.wireframe_edge_color),_.shader.need_uniforms_update=!0}},t.update_force_scene=function(){var e=dm();return function(t,r){var n=r.field,a=t._render.wind;if(n&&"WIND"==n.type&&a){var o=Vm(r.render.world_tsr,e);wh(Ug,o,a),Rh(a,a),Sh(a,n.strength,a);for(var _=Re(t,M),i=0;i<_.length;i++)_[i].wind.set(a);return!0}return!1}}(),t.pick_color=function(e,t,r){var n=Ie(e,m.COLOR_PICKING);if(n){var o=O.enabled&&(O.subs_type===m.COLOR_PICKING||O.subs_type===m.COLOR_PICKING_XRAY);if(o)var i=_.canvas_to_viewport_coords(t,r,F,n.camera);else{var s=_.get_canvas();a.set_color_pick_proj(n.camera,t,r,s.clientWidth,s.clientHeight)}f.prerender_subs(n),n.do_render&&S.draw(n);var l=Ie(e,m.COLOR_PICKING_XRAY);if(l){yA(n.camera.proj_matrix,l.camera.proj_matrix),yA(n.camera.view_proj_matrix,l.camera.view_proj_matrix),dO(l.camera.view_proj_matrix,l.camera.frustum_planes),f.prerender_subs(l),l.do_render&&S.draw(l);var c=l.camera}else c=n.camera;return n.do_render||l&&l.do_render?o?(i[1]=c.height-i[1],S.read_pixels(c.framebuffer,i[0],i[1],1,1,W)):S.read_pixels(l?l.camera.framebuffer:n.camera.framebuffer,0,0,1,1,W):null}return P.error("Object Selection is not available on the scene"),null},t.set_outline_color=function(e){for(var t=Re($(),[m.OUTLINE]),r=0;r<t.length;r++){var n=t[r];n.outline_color.set(e),n.need_perm_uniforms_update=!0}},t.get_wind=Fe,t.get_meta_tags=function(e){var t={title:"",description:""};return e.b4w_tags&&(t.title=e.b4w_tags.title,t.description=e.b4w_tags.description),t},t.get_custom_prop=function(e){return e.b4w_custom_prop},t.update_cube_reflect_subs=function(e,t){var r=G;Oh(t,r);for(var n=0;n<6;n++){var a=e.cube_view_matrices[n],o=e.cube_cam_frustums[n],_=e.camera;UA(Hg[n],r,a),wA(_.proj_matrix,a,_.view_proj_matrix),dO(_.view_proj_matrix,o)}},t.update_plane_reflect_subs=function(e,t,r){!function(e,t,r,n){n||(n=new Float32Array(4)),wh(r,t,n),n[3]=-Ih(e,n)}(t,r,Ug,e.camera.reflection_plane)},t.assign_scene_data_subs=function(e,t,r){var n=e._render.reflection_params;if(n&&t)for(var a=0;a<t.length;a++){var o=t[a],_=T.get_scene_data(o,e);if(-1!=o.render.plane_reflection_id){var i=n.plane_refl_subs,s=n.plane_refl_subs_blend,l=o.render.plane_reflection_id;s.length&&l<s.length?_.plane_refl_subs=s[l]:i.length&&l<i.length&&(_.plane_refl_subs=i[l])}else if(-1!=o.render.cube_reflection_id){var c=n.cube_refl_subs,E=n.cube_refl_subs_blend;l=o.render.cube_reflection_id,E.length?_.cube_refl_subs=E[l]:c.length&&(_.cube_refl_subs=c[l])}}if(r){var u=T.get_shadow_lamps(r,N.ssao&&e.b4w_enable_ssao),d=e._render.shadow_params;for(a=0;a<u.length;a++)if(_=T.get_scene_data(u[a],e),d)for(var f=Re(e,[m.SHADOW_CAST]),p=0;p<f.length;p++)a==f[p].shadow_lamp_index&&_.shadow_subscenes.push(f[p])}},t.marker_frame=function(e,t){return e.timeline_markers[t]},t.set_hmd_params=function(e){var t=Ie($(),m.STEREO);t&&(e.distortion_coefs&&(t.distortion_params[0]=e.distortion_coefs[0],t.distortion_params[1]=e.distortion_coefs[1],t.need_perm_uniforms_update=!0),e.chromatic_aberration_coefs&&(t.chromatic_aberration_coefs[0]=e.chromatic_aberration_coefs[0],t.chromatic_aberration_coefs[1]=e.chromatic_aberration_coefs[1],t.chromatic_aberration_coefs[2]=e.chromatic_aberration_coefs[2],t.chromatic_aberration_coefs[3]=e.chromatic_aberration_coefs[3],t.need_perm_uniforms_update=!0),e.base_line_factor&&(t.distortion_params[2]=e.base_line_factor,t.need_perm_uniforms_update=!0),e.inter_lens_factor&&(t.distortion_params[3]=e.inter_lens_factor,t.need_perm_uniforms_update=!0),null!=e.enable_hmd_stereo&&(t.enable_hmd_stereo=e.enable_hmd_stereo,t.need_perm_uniforms_update=!0))},t.multiply_size_mult=function(e,r){for(var n=ee(),a=0;a<n.length;a++){var o=t.get_graph(n[a]);A.multiply_size_mult_by_graph(o,e,r)}},t.update_all_mesh_shaders=function(e){for(var t=u.get_scene_objs(e,"LAMP",u.DATA_ID_ALL),r=Re(e,y),a=0;a<r.length;a++)for(var o=r[a],_=o.draw_data,i=0;i<_.length;i++)for(var s=_[i].bundles,l=0;l<s.length;l++){var c=s[l],E=c.batch;"MAIN"==E.type&&(n.update_batch_lights(E,t,e),n.update_shader(E),m.append_draw_data(o,c))}},t.recalculate_draw_data=function(e){for(var t=0;t<U.length;t++)s.traverse(U[t]._render.graph,(function(t,r){for(var n=r,a=n.draw_data,o=0;o<a.length;o++)for(var _=a[o].bundles,i=0;i<_.length;i++){var s=_[i];s.batch==e&&m.append_draw_data(n,s)}}))}})),YI=nA("__constraints",(function(e,t){var r=gN(e),n=CI(e),a=pb(e);t.CONS_TYPE_STIFF_OBJ=1,t.CONS_TYPE_STIFF_BONE=2,t.CONS_TYPE_TRACK_OBJ=3,t.CONS_TYPE_FOLLOW_OBJ=5,t.CONS_TYPE_STIFF_TRANS_OBJ=7,t.CONS_TYPE_COPY_LOC_OBJ=8,t.CONS_TYPE_SEMI_STIFF_OBJ=12,t.CONS_TYPE_CHILD_OF=13,t.CONS_TYPE_CHILD_OF_BONE=14,t.CONS_TYPE_SEMI_SOFT_OBJ=15,t.CONS_TYPE_STIFF_TRANS_ROT_OBJ=16,t.CONS_TYPE_STIFF_VIEWPORT=17,t.BONE_CONS_TYPE_STIFF_OBJ=18,new Float32Array(2),new Float32Array(2);var o=new Float32Array(3),_=(new Float32Array(3),new Float32Array(4)),i=(new Float32Array(4),wm()),s=new Float32Array(3);function l(e){return{type:e,obj_parent:null,target:null,use_offset:!1,tsr_restore:null,tsr_offset:null,euler_offset:null,axes:null,track_axis:null,vertical_axis:null,use_target_z:!1,influence:0,bone_name:"",softness:0,clamp_left:0,clamp_right:0,clamp_up:0,clamp_down:0,dist_min:0,dist_max:0,left_edge:!1,left_right_dist:0,top_edge:!1,top_bottom_dist:0,distance:0,hor_units:"",vert_units:""}}function c(e,t){e.constraint&&e.constraint.obj_parent&&E(e.constraint.obj_parent,e),t.obj_parent&&function(e,t){-1==e.cons_descends.indexOf(t)?e.cons_descends.push(t):r.panic("Descendant object override is forbidden")}(t.obj_parent,e),e.constraint=t}function E(e,t){var n=e.cons_descends.indexOf(t);-1!=n?e.cons_descends.splice(n,1):r.panic("No descendant object")}function u(e,t,r,n,a,o){var _=l(3);_.obj_parent=t,_.track_axis=new Float32Array(r),_.vertical_axis=new Float32Array(n),_.use_target_z=a,_.tsr_restore=new Float32Array(e.render.world_tsr),_.influence=o,c(e,_),A(e,_,0)}function d(e,t,r,n,a,o){var _=l(8);_.obj_parent=t,_.tsr_offset=wm(),Km(r,_.tsr_offset),_.axes=new Float32Array(n),_.influence=o,_.use_offset=a,_.tsr_restore=new Float32Array(e.render.world_tsr),c(e,_),A(e,_,0)}t.append_stiff_obj=function(e,t,r,n,a){var o=l(1);o.obj_parent=t,o.tsr_offset=wm(),n=n||dm(),Km(r,o.tsr_offset),Bm(a,o.tsr_offset),Hm(n,o.tsr_offset),o.tsr_restore=new Float32Array(e.render.world_tsr),c(e,o),A(e,o,0)},t.append_stiff_bone=function(e,t,r,n,a,o){var _=l(2);_.obj_parent=t,_.bone_name=r,_.tsr_restore=new Float32Array(e.render.world_tsr),_.tsr_offset=wm(),Km(new Float32Array(n),_.tsr_offset),Hm(new Float32Array(a),_.tsr_offset),Bm(o,_.tsr_offset),c(e,_),A(e,_,0)},t.append_semi_stiff_obj=function(){var e=dm(),t=dm();return function(r,n,a,o,_,i,s,E){var u=l(12),d=Vm(n.render.world_tsr,t);if(o){var T=Bv(o,e);mm(d,T,T),Hm(T,r.render.world_tsr)}else o=dm();u.obj_parent=n,u.tsr_offset=wm(),Km(a,u.tsr_offset),Hm(o,u.tsr_offset),u.parent_prev_rotation=new Float32Array(d),u.clamp_left=qO(_),u.clamp_right=qO(i),u.clamp_up=VO(s,-Math.PI,Math.PI),u.clamp_down=VO(E,-Math.PI,Math.PI),u.tsr_restore=new Float32Array(r.render.world_tsr),c(r,u),A(r,u,0)}}(),t.append_semi_soft_obj=function(e,t,r,n){var a=l(15);a.obj_parent=t,a.softness=n,a.tsr_restore=new Float32Array(e.render.world_tsr),a.tsr_offset=wm(),Km(new Float32Array(r),a.tsr_offset),c(e,a),A(e,a,0)},t.append_stiff_trans_rot_obj=function(e,t,r,n,a){var o=l(16);o.obj_parent=t,o.tsr_restore=new Float32Array(e.render.world_tsr),o.tsr_offset=wm(),Km(new Float32Array(r),o.tsr_offset),Hm(new Float32Array(n),o.tsr_offset),Bm(a,o.tsr_offset),c(e,o),A(e,o,0)},t.remove_parent_descendant=E,t.append_track_obj=u,t.append_follow_obj=function(e,t,r,n){var a=l(5);a.obj_parent=t,a.dist_min=r,a.dist_max=n,a.tsr_restore=new Float32Array(e.render.world_tsr),c(e,a),A(e,a,0)},t.append_stiff_trans_obj=function(e,t,r){var n=l(7);n.obj_parent=t,n.tsr_offset=wm(),n.tsr_restore=new Float32Array(e.render.world_tsr),Km(new Float32Array(r),n.tsr_offset),c(e,n),A(e,n,0)},t.append_copy_loc_obj=d;var T=function(){var e=dm();return function(t,r,n,a,o){var _=l(9);_.obj_parent=r;var i=Vm(t.render.world_tsr,e);_.euler_offset=oO(i,new Float32Array(3)),_.axes=new Float32Array(n),_.influence=o,_.use_offset=a,_.tsr_restore=new Float32Array(t.render.world_tsr),c(t,_),A(t,_,0)}}();function f(e,t,r){var n=l(11);n.obj_parent=t,n.tsr_offset=wm(),Dm(e.render.world_tsr,n.tsr_offset),n.tsr_restore=new Float32Array(e.render.world_tsr),n.influence=r,c(e,n),A(e,n,0)}function p(e,t,r){var n=l(13);n.obj_parent=t,n.tsr_offset=new Float32Array(r),c(e,n),A(e,n,0)}function P(e,t,r,n){var a=l(14);a.obj_parent=t,a.bone_name=r,a.tsr_offset=new Float32Array(n),c(e,a),A(e,a,0)}function S(e,t,r){var n=l(17);if(n.obj_parent=t,n.tsr_restore=new Float32Array(e.render.world_tsr),n.tsr_offset=wm(),jg(r.right)?(n.left_edge=!1,n.left_right_dist=r.right):jg(r.left)?(n.left_edge=!0,n.left_right_dist=r.left):(n.left_edge=!0,n.left_right_dist=0),jg(r.bottom)?(n.top_edge=!1,n.top_bottom_dist=r.bottom):jg(r.top)?(n.top_edge=!0,n.top_bottom_dist=r.top):(n.top_edge=!0,n.top_bottom_dist=0),n.distance=jg(r.distance)?r.distance:0,jg(r.rotation))var a=new Float32Array(r.rotation);else a=dm();Hm(a,n.tsr_offset),n.hor_units=jg(r.hor_units)?r.hor_units:"widths",n.vert_units=jg(r.vert_units)?r.vert_units:"heights",c(e,n),A(e,n,0)}t.append_copy_rot_obj=T,t.append_copy_trans_obj=f,t.append_child_of=p,t.append_child_of_bone=P,t.append_stiff_viewport=S,t.update_constraint=function(e,t){e.constraint&&A(e,e.constraint,t)};var A=function(){var e=dm(),t=dm(),r=dm(),n=wm(),o=ih(),_=ih(),i=ih();return function(l,c,E){switch(c.type){case 1:tg(c.obj_parent.render.world_tsr,c.tsr_offset,l.render.world_tsr);break;case 12:var u=jm(l.render.world_tsr,o),d=Vm(l.render.world_tsr,e),T=jm(c.tsr_offset,_),f=c.obj_parent.render.world_tsr,p=Vm(c.obj_parent.render.world_tsr,t);mm(Ym(c.parent_prev_rotation,c.parent_prev_rotation),d,d),mm(p,d,d),Hm(d,l.render.world_tsr),rg(T,f,u),Km(u,l.render.world_tsr),Bv(p,c.parent_prev_rotation),m(l,c);break;case 15:u=jm(l.render.world_tsr,o),d=Vm(l.render.world_tsr,e);var P=jm(f=c.obj_parent.render.world_tsr,_),S=c.softness,A=Bv(d,t);T=jm(c.tsr_offset,i),wO(rg(T,f,i),u,E,S,u),Km(u,l.render.world_tsr),pN(u,A,P,Fg),Km(P,f),UO(A,d,E,.16*S,d),Hm(d,l.render.world_tsr);break;case 2:T=jm(c.tsr_offset,_);var h=zm(c.tsr_offset),v=Vm(c.tsr_offset,t),g=iI(c.obj_parent,c.bone_name,!0,!1,n);tg(c.obj_parent.render.world_tsr,g,g),mm(d=Vm(g,e),v,d),Hm(d,l.render.world_tsr),Bm(h*zm(g),l.render.world_tsr),u=jm(l.render.world_tsr,o),rg(T,g,u),Km(u,l.render.world_tsr);break;case 3:u=jm(l.render.world_tsr,o),d=Vm(l.render.world_tsr,e);var O=jm(c.obj_parent.render.world_tsr,_),N=c.influence;if(c.use_target_z)var R=Vm(c.obj_parent.render.world_tsr,t),I=wh(Ug,R,i);else I=Ug;pN(u,d,O,c.track_axis);var b=dh(O,u,_);Rh(b,b),function(e,t,r,n){var a=wh(t,e,pg),o=dh(r,Sh(n,Ih(n,r),Pg),Pg),_=hm(yg);Rh(o,o),Math.abs(Ih(a,o))<.999999&&tN(a,o,_),am(_,_),mm(_,e,e)}(d,c.vertical_axis,I,b),Im(U=Vm(c.tsr_restore,t),d,N,d),Hm(d,l.render.world_tsr),Km(u,c.tsr_restore);break;case 5:pN(u=jm(l.render.world_tsr,o),d=Vm(l.render.world_tsr,e),O=jm(c.obj_parent.render.world_tsr,_),Fg),Km(O,c.obj_parent.render.world_tsr);var y=hh(u,O);if(y>c.dist_max)var L=y-c.dist_max;else L=y<c.dist_min?y-c.dist_min:0;L&&(dh(O,u,i),Rh(i,i),Sh(o,L,i),uh(u,i,u),Km(u,l.render.world_tsr));break;case 7:f=c.obj_parent.render.world_tsr,u=jm(l.render.world_tsr,o),T=jm(c.tsr_offset,_),rg(T,f,u),Km(u,l.render.world_tsr),Hm(Vm(l.render.world_tsr,e),c.tsr_restore);break;case 8:P=jm(c.obj_parent.render.world_tsr,o);var Y=c.axes,M=jm(c.tsr_offset,_);T=Eh(0,0,0,i),c.use_offset&&uh(T,M,T),N=c.influence,u=o,Y[0]&&(u[0]=(1-N)*M[0]+N*(qg(Y[0])*P[0]+T[0])),Y[1]&&(u[1]=(1-N)*M[1]+N*(qg(Y[1])*P[1]+T[1])),Y[2]&&(u[2]=(1-N)*M[2]+N*(qg(Y[2])*P[2]+T[2])),Km(u,l.render.world_tsr),Hm(Vm(l.render.world_tsr,e),c.tsr_restore);break;case 9:Y=c.axes;var x=function(e,t,r){var n=mA(e,Ng),a=fg,o=pg;return AN(n,a,o),ch(Math.abs(a[0]-t[0])+Math.abs(a[1]-t[1])+Math.abs(a[2]-t[2])>Math.abs(o[0]-t[0])+Math.abs(o[1]-t[1])+Math.abs(o[2]-t[2])?o:a,r),r}(p=Vm(c.obj_parent.render.world_tsr,e),c.euler_offset,_);PN(x,c.euler_offset),Y[0]?(c.use_offset&&SN(x,Eh(c.euler_offset[0],0,0,o),x),x[0]=qg(Y[0])*x[0]):x[0]=c.euler_offset[0],Y[1]?(c.use_offset&&SN(x,Eh(0,c.euler_offset[1],0,o),x),x[1]=qg(Y[1])*x[1]):x[1]=c.euler_offset[1],Y[2]?(c.use_offset&&SN(x,Eh(0,0,c.euler_offset[2],o),x),x[2]=qg(Y[2])*x[2]):x[2]=c.euler_offset[2],PN(x,c.euler_offset),N=c.influence;var C=tO(x,e);Hm(d=Im(z=Vm(c.tsr_restore,t),C,N,e),l.render.world_tsr),Km(jm(l.render.world_tsr,o),c.tsr_restore);break;case 11:N=c.influence,P=jm(c.obj_parent.render.world_tsr,o),p=Vm(c.obj_parent.render.world_tsr,e);var w=jm(c.tsr_offset,_),U=Vm(c.tsr_offset,t);Km(u=sO(w,P,N,o),l.render.world_tsr),Hm(d=Im(U,p,N,e),l.render.world_tsr),Km(jm(l.render.world_tsr,o),c.tsr_restore);break;case 16:d=Vm(l.render.world_tsr,e),f=c.obj_parent.render.world_tsr,p=Vm(c.obj_parent.render.world_tsr,t),T=jm(c.tsr_offset,_),mm(p,v=Vm(c.tsr_offset,r),d),Hm(d,l.render.world_tsr),Km(u=rg(T,f,o),l.render.world_tsr);break;case 13:tg(c.obj_parent.render.world_tsr,c.tsr_offset,l.render.world_tsr);break;case 14:var k=c.tsr_offset;iI(c.obj_parent,c.bone_name,!0,!1,g=n),tg(c.obj_parent.render.world_tsr,g,g),tg(g,k,l.render.world_tsr);break;case 17:var D=c.obj_parent,F=a.get_first_cam(D),G=(u=o,a.get_edge(F,"LEFT")),K=a.get_edge(F,"RIGHT"),B=a.get_edge(F,"TOP"),X=a.get_edge(F,"BOTTOM");if("heights"==c.hor_units)var H=B-X;else H=K-G;if(u[0]=c.left_edge?G+H*c.left_right_dist:K-H*c.left_right_dist,"heights"==c.vert_units)var j=B-X;else j=K-G;u[1]=c.top_edge?B-j*c.top_bottom_dist:X+j*c.top_bottom_dist,a.is_ortho(F)?u[2]=-c.distance:(u[2]=-1,Rh(u,u),Sh(u,c.distance/Math.abs(u[2]),u)),_g(u,D.render.world_tsr,u),uh(jm(D.render.world_tsr,_),u,u),Km(u,l.render.world_tsr);var z=Vm(l.render.world_tsr,e);mm(Vm(D.render.world_tsr,t),v=Vm(c.tsr_offset,r),z),Hm(z,l.render.world_tsr)}if("CAMERA"==l.render.type&&l.render.move_style!=a.MS_STATIC){var Q=l.render.vertical_axis;12==c.type&&(Q=wh(Q,p=Vm(c.obj_parent.render.world_tsr,e),s)),a.correct_up(l,Q)}}}();function h(e,t,r,n,a,o){var _=l(18);_.bone_name=r,_.target=t,_.tsr_offset=wm(),Km(new Float32Array(n),_.tsr_offset),Hm(new Float32Array(a),_.tsr_offset),Bm(o,_.tsr_offset),function(e,t){var r=t.target,n=t.bone_name,a=e.render.bone_pointers[n];(function(e,t,r){for(var n=e.cons_armat_bone_descends,a=0;a<n;a++){var o=n[a];if(o[0]==t&&o[1]==r)return void n.splice(a,1)}})(r,e,n),r.cons_armat_bone_descends.push([e,n]),a.constraint=t}(e,_),v(e,_)}function v(e,t){switch(t.type){case 18:var r=t.target.render.world_tsr,n=i;Zm(e.render.world_tsr,n),tg(n,r,n),sI(e,t.bone_name,n,!1)}e.need_update_transform=!0}t.update_bone_constraint=function(e,t){var r=e.render.bone_pointers[t];r.constraint&&v(e,r.constraint)};var m=function(){var e=dm(),t=dm(),r=dm(),n=dm(),o=new Float32Array(2),_=new Float32Array(2);return function(i,s){var l=Vm(i.render.world_tsr,e),c=mm(Vm(s.obj_parent.render.world_tsr,t),Vm(s.tsr_offset,r),n),E=a.get_camera_angles_from_quat(c,i.render.vertical_axis,o),u=a.get_camera_angles_from_quat(l,i.render.vertical_axis,_),d=rN(u[0],E[0]+s.clamp_right,E[0]+s.clamp_left),T=rN(u[1],E[1]+s.clamp_down,E[1]+s.clamp_up);!function(e,t,r,n,a){if(r||n){var o=hm(yg);r&&mm(o,vm(t,r,Lg),o);var _=Bv(e,a);if(n){var i=vm(_O(_,Cg,fg),n,Lg);am(i,i),mm(o,i,o)}mm(o,_,_),am(_,_)}}(l,i.render.vertical_axis,d,T,l),Hm(l,i.render.world_tsr)}}();t.check_constraint=function(e){return!!e.constraint},t.remove=function(e,t){e.constraint.obj_parent&&E(e.constraint.obj_parent,e),t&&Dm(e.constraint.tsr_restore,e.render.world_tsr),e.constraint=null},t.get_type=function(e){return e.constraint?e.constraint.type:null},t.has_child_of=function(e){var t=e.constraint;return!(!t||13!=t.type&&14!=t.type)},t.get_child_of_parent_tsr=function(e){var t=e.constraint;if(t&&13==t.type)return t.obj_parent.render.world_tsr;if(t&&14==t.type){var r=i;return iI(t.obj_parent,t.bone_name,!0,!1,r),tg(t.obj_parent.render.world_tsr,r,r),r}return null},t.get_child_of_offset=function(e){var t=e.constraint;return!t||13!=t.type&&14!=t.type?null:t.tsr_offset},t.prepare_object_relations=function(e,t){for(var r=t.render,a=0;a<e.constraints.length;a++){var i=e.constraints[a],s=i.type;if(i.target){var l=i.target._object;if("COPY_LOCATION"==s)d(t,l,new Float32Array(jm(t.render.world_tsr,o)),c=new Float32Array(i.axes),i.use_offset,i.influence);else if("COPY_ROTATION"==s){var c=new Float32Array(i.axes);T(t,l,c,i.use_offset,i.influence)}else if("COPY_TRANSFORMS"==s)f(t,l,i.influence);else if("TRACK_TO"==s){var E=i.track_axis;if("TRACK_Y"==E)var A=wg;else"TRACK_NEGATIVE_Y"==E?A=Dg:"TRACK_X"==E?A=Cg:"TRACK_NEGATIVE_X"==E?A=kg:"TRACK_Z"==E?A=Ug:"TRACK_NEGATIVE_Z"==E&&(A=Fg);var v=i.up_axis;if("UP_X"==v)var m=Cg;else"UP_Y"==v?m=wg:"UP_Z"==v&&(m=Ug);u(t,l,A,m,i.use_target_z,i.influence)}}}if(t.parent){!t.parent_is_dupli&&t.physics_settings.use_collision_compound&&t.parent.physics_settings.use_collision_compound&&(t.use_obj_physics=!1);var g=!1;for(a=0;a<t.scenes_data.length;a++)if(t.scenes_data[a].scene._physics){g=!0;break}if(g&&n.has_dynamic_settings(t)){if(t.parent_is_dupli)var O=Dm(r.world_tsr,wm());else O=r.world_tsr;tg(t.parent.render.world_tsr,O,r.world_tsr)}else if(t.parent_is_dupli||!t.parent_bone)if(O=Dm(r.world_tsr,wm()),t.viewport_alignment&&"CAMERA"==t.parent.type){var N={distance:t.viewport_alignment.distance,rotation:Vm(O,_)};switch(t.viewport_alignment.alignment){case"TOP_LEFT":N.top=0,N.left=0;break;case"TOP":N.top=0,N.left=.5;break;case"TOP_RIGHT":N.top=0,N.right=0;break;case"LEFT":N.top=.5,N.left=0;break;case"CENTER":N.top=.5,N.left=.5;break;case"RIGHT":N.top=.5,N.right=0;break;case"BOTTOM_LEFT":N.bottom=0,N.left=0;break;case"BOTTOM":N.bottom=0,N.left=.5;break;case"BOTTOM_RIGHT":N.bottom=0,N.right=0}S(t,t.parent,N)}else p(t,t.parent,O);else O=Dm(r.world_tsr,wm()),P(t,t.parent,t.parent_bone,O)}if("ARMATURE"==t.type){var R=e.pose.bones;for(a=0;a<R.length;a++){var I=R[a],b=I.constraints;if(b)for(var y=0;y<b.length;y++){var L=b[y];"COPY_TRANSFORMS"!=L.type||L.subtarget||L.mute||h(t,l=L.target._object,I.name,Yg,Mg,1)}}}},t.check_compatibility=function(e,t){return function e(t,r){for(var n=0;n<t.length;n++){var a=t[n];if(!e(a.cons_descends,r)||a.name==r.name)return!1}return!0}(e.cons_descends,t)},t.check_self_applying=function(e,t){return e.name!=t.name}})),MI=nA("__transform",(function(e,t){var r=pb(e),n=YI(e),a=KI(e),o=PI(e),_=LI(e),i=yI(e),s=new Float32Array(3),l=new Float32Array(3),c=new Float32Array(4),E=wm(),u=wm(),d=0,T=0;function f(e,t){n.has_child_of(e)?Km(t,n.get_child_of_offset(e)):Km(t,e.render.world_tsr)}function p(e,t){var r=e.render;if(n.has_child_of(e)){Hm(t,r.world_tsr);var a=n.get_child_of_parent_tsr(e),o=Zm(a,E),_=n.get_child_of_offset(e);tg(o,r.world_tsr,_)}else Hm(t,r.world_tsr)}function P(e,t){n.has_child_of(e)?Hm(t,n.get_child_of_offset(e)):Hm(t,e.render.world_tsr)}function S(e,t){return Vm(e.render.world_tsr,t),t}function A(e,t){return n.has_child_of(e)?Vm(n.get_child_of_offset(e),t):Vm(e.render.world_tsr,t),t}function h(e,t){n.has_child_of(e)?Dm(t,n.get_child_of_offset(e)):Dm(t,e.render.world_tsr)}function v(e,t){return n.has_child_of(e)?Dm(n.get_child_of_offset(e),t):Dm(e.render.world_tsr,t),t}t.update=function(e){d=e,T++},t.set_translation=function(e,t){var r=e.render;if(n.has_child_of(e)){Km(t,r.world_tsr);var a=n.get_child_of_parent_tsr(e),o=Zm(a,E),_=n.get_child_of_offset(e);tg(o,r.world_tsr,_)}else Km(t,r.world_tsr)},t.set_translation_rel=f,t.get_translation=function(e,t){return jm(e.render.world_tsr,t),t},t.get_translation_rel=function(e,t){return n.has_child_of(e)?jm(n.get_child_of_offset(e),t):jm(e.render.world_tsr,t),t},t.set_rotation=p,t.set_rotation_rel=P,t.get_rotation=S,t.get_rotation_rel=A,t.set_rotation_euler=function(e,t){p(e,tO(t,c))},t.set_rotation_euler_rel=function(e,t){P(e,tO(t,c))},t.get_rotation_euler=function(e,t){return oO(S(e,c),t)},t.get_rotation_euler_rel=function(e,t){return oO(A(e,c),t)},t.set_scale=function(e,t){var r=e.render;if(n.has_child_of(e)){Bm(t,r.world_tsr);var a=n.get_child_of_parent_tsr(e),o=Zm(a,E),_=n.get_child_of_offset(e);tg(o,r.world_tsr,_)}else Bm(t,r.world_tsr)},t.set_scale_rel=function(e,t){var r=e.render;n.has_child_of(e)?Bm(t,n.get_child_of_offset(e)):Bm(t,r.world_tsr)},t.get_scale=function(e,t){return zm(e.render.world_tsr,t)},t.get_scale_rel=function(e,t){return n.has_child_of(e)?zm(n.get_child_of_offset(e),t):zm(e.render.world_tsr,t)},t.set_tsr=function(e,t){if(Dm(t,e.render.world_tsr),n.has_child_of(e)){var r=n.get_child_of_parent_tsr(e),a=Zm(r,E),o=n.get_child_of_offset(e);tg(a,e.render.world_tsr,o)}},t.set_tsr_rel=h,t.get_tsr=function(e,t){return Dm(e.render.world_tsr,t)},t.get_tsr_rel=v,t.get_object_size=function(){var e=ih();return function(t){var r=t.render,n=r.bb_original,a=zm(r.world_tsr,e),o=a[0]*(n.max_x-n.min_x),_=a[1]*(n.max_y-n.min_y),i=a[2]*(n.max_z-n.min_z);return.5*Math.sqrt(o*o+_*_+i*i)}}(),t.get_object_center=function(e,t,r){if(t)ch((n=e.render).bs_world.center,r);else{var n,a=(n=e.render).bb_original;r[0]=(a.max_x+a.min_x)/2,r[1]=(a.max_y+a.min_y)/2,r[2]=(a.max_z+a.min_z)/2,rg(r,n.world_tsr,r)}return r},t.move_local=function(e,t,r,n){var a=v(e,E),o=s;o[0]=t,o[1]=r,o[2]=n,rg(o,a,o),f(e,o)},t.rotate_local=function(e,t){var r=v(e,E),n=Hm(t,Fm(u));tg(r,n,n),h(e,n)},t.update_transform=function e(t){var l=t.render,u=t.scenes_data,f=t.type;n.update_constraint(t,d),"CAMERA"==f&&r.update_camera(t),GN(l.bb_local,l.world_tsr,l.bb_world),BN(l.bs_local,l.world_tsr,l.bs_world);for(var p=0;p<u.length;p++)for(var P=u[p].batches,S=0;S<P.length;S++)o.update_world_bounds_from_batch_tsr(P[S],l.world_tsr,u[p].batch_world_bounds[S]);switch(f){case"MESH":if(t.need_inv_zup_tsr&&Zm(t.render.world_tsr,t.render.world_tsr_inv),M=t.armobj){var A=M.render.world_tsr;0!=A[3]&&0!=A[4]&&0!=A[5]?(Zm(A,E),tg(E,l.world_tsr,E),Qm(E,l.arm_rel_trans),Vm(E,l.arm_rel_quat)):Qm(A,l.arm_rel_trans)}l.force_zsort=!0;break;case"CAMERA":for(p=0;p<u.length;p++)r.update_camera_transform(t,u[p]);break;case"SPEAKER":i.speaker_update_transform(t,d,T);break;case"LAMP":pI(t)}var h=jm(l.world_tsr,s),v=Vm(l.world_tsr,c);for(p=0;p<u.length;p++){var m=u[p];if(m.is_active){var g=m.scene,O=g._render;switch(P=m.batches,f){case"MESH":l.shadow_cast&&_.schedule_shadow_update(g);var N=m.cube_refl_subs;null!=l.cube_reflection_id&&N&&_.update_cube_reflect_subs(N,h);break;case"EMPTY":a.update_force(t);break;case"CAMERA":if(_.get_active()==g&&_.get_camera(g)==t){if(_.schedule_grass_map_update(g),O.shadow_params){(O.shadow_params.enable_csm||O.shadow_params.dynamic_grass_cast)&&_.schedule_shadow_update(g);var R=o.get_scene_data(t,g);_.update_shadow_billboard_view(R.cameras[0],O.graph)}i.listener_update_transform(g,h,v,d,T)}break;case"LAMP":_.update_lamp_scene(t,g)}var I=m.plane_refl_subs,b=t.reflective_objs;if(b.length)for(S=0;S<I.length;S++){var y=I[S].camera;_.update_plane_reflect_subs(I[S],h,v),o.update_refl_objects(b,y.reflection_plane),r.set_view(y,_.get_camera(g))}}}var L=t.cons_descends;for(p=0;p<L.length;p++)e(L[p]);var Y=t.cons_armat_bone_descends;for(p=0;p<Y.length;p++){var M,x=Y[p];n.update_bone_constraint(M=x[0],x[1])}},t.distance=function(e,t){return hh(jm(e.render.world_tsr,s),jm(t.render.world_tsr,l))},t.obj_point_distance=function(e,t){return hh(jm(e.render.world_tsr,s),t)}})),xI=nA("__navmesh",(function(e,t){var r=VR(e),n=ih(),a=ih(),o=Fv(),_=Fv(),i=Fv(),s=IA(),l=IA(),c=IA(),E=ih(),u=ih(),d=ih(),T=ih(),f=ih();function p(e,t){return parseFloat(e.toFixed(t))}function P(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0;r<e.length;r++)if(e[r]==t)return r;return-1}var S=function(e,t){function r(e){var t=e[0];e[0]=e[1],e[1]=e[2],e[2]=t}for(var n=e.vertex_ids,a=t.vertex_ids,o=[],_=0;_<n.length;_++)P(a,n[_])>=0&&o.push(n[_]);if(o.length<2)return[];for(P(o,n[0])>=0&&P(o,n[n.length-1])>=0&&r(n),P(o,a[0])>=0&&P(o,a[a.length-1])>=0&&r(a),o=[],_=0;_<n.length;_++)P(a,n[_])>=0&&o.push(n[_]);return o};function A(e,t){e.push(t[0]),e.push(t[1]),e.push(t[2])}function h(e,t,r,o){return qg(Ih(o,bh(dh(t,e,n),dh(r,e,a),n)))}function v(e,t){return dh(e,t,n),Ih(n,n)<1e-5}function m(e,t,r){var o=dh(t.right,t.left,n),_=r.normal,i=t.normal,s=Math.acos(Ih(_,i));s*=-qg(Ih(o,bh(_,i,a)));var l=LA(c);return UA(l,t.left,l),DA(l,s,o,l),UA(l,Sh(t.left,-1,a),l),wA(e,l,e),e}function g(e,t,r,a,s,l,c){var E=xh(r,l,o);E[3]=1;var u=dh(xh(a,l,n),E,_),d=bh(s,dh(t,e,n),i);if(Math.abs(Ih(d,u))<.01)var T=.5;else Rh(d,d),d[3]=-Ih(d,t),T=-om(d,E)/om(d,u);return Ah(r,dh(a,r,n),T,c)}function O(e,t,r,n,a,o,_,i,l){for(var c=LA(s),E=a;E<r;E++)e[E].is_crucial&&(E>a||!E)&&(A(_,g(t,n,e[E].left,e[E].right,o,c,ih())),i&&A(l,e[E].normal),E&&m(c,e[E],e[E-1]))}function N(e,t,r,n,a){for(var o=null,_=Number.MAX_VALUE,i=0;i<e.length;i++){var s=e[i],l=a(r,s.centroid,s.vertex_ids,t,_);l<_&&(o=s,_=l)}return n>0&&_>n?null:o}function R(e,t){for(var r=0;r<e.neighbours.length;r++)if(e.neighbours[r]===t.id)return e.portals[r]}function I(e,t,r,n,a){e.push({left:t,right:r,is_crucial:n,normal:a})}t.navmesh_build_from_bufs_data=function(e){for(var t=r.get_vbo_source_by_type(e.vbo_source_data,r.VBO_FLOAT),o=e.ibo_array,_=[],i=0;i<o.length;i+=3)_.push({indices:new Uint32Array([o[i],o[i+1],o[i+2]]),centroid:new Float32Array(3),normal:new Float32Array(3)});var s,l=[];for(i=0;i<t.length;i+=3){var c=new Float32Array(3);c[0]=t[i],c[1]=t[i+1],c[2]=t[i+2],l.push(c)}return function(e){for(var t={},r=e.vertices,n=0;n<r.length;n++)r[n][0]=p(r[n][0],2),r[n][1]=p(r[n][1],2),r[n][2]=p(r[n][2],2);t.vertices=e.vertices;var a=function(e){for(var t=e.polygons,r=[],n=0,a=function e(t){for(var r=t.neighbours,n=0;n<r.length;n++){var a=r[n];null==a.island&&(a.island=t.island,e(a))}},o=0;o<t.length;o++){var _=t[o];null==_.island&&(_.island=n++,a(_)),r[_.island]||(r[_.island]=[]),r[_.island].push(t[o])}return r}(e);t.islands=[];var o=function(e,t){for(var r=0;r<e.length;r++)if(t===e[r])return r};for(n=0;n<a.length;n++){for(var _=[],i=a[n],s=0;s<i.length;s++){for(var l=[],c=i[s],E=0;E<c.neighbours.length;E++)l.push(o(i,c.neighbours[E]));var u=[];for(E=0;E<c.neighbours.length;E++)u.push(S(c,c.neighbours[E]));c.centroid[0]=p(c.centroid[0],2),c.centroid[1]=p(c.centroid[1],2),c.centroid[2]=p(c.centroid[2],2),_.push({id:o(i,c),neighbours:l,vertex_ids:c.vertex_ids,centroid:c.centroid,normal:c.normal,portals:u,f:0,g:0,h:0,cost:1,visited:!1,closed:!1,parent:null})}t.islands.push(_)}return t}((function(e){var t,r;for(t=0;t<e.faces.length;t++)uh(e.vertices[(r=e.faces[t]).indices[0]],e.vertices[r.indices[1]],n),uh(n,e.vertices[r.indices[2]],n),Sh(n,1/3,r.centroid)}(s={vertices:l,faces:_}),function(e){for(var t=0;t<e.faces.length;t++){var r=e.faces[t],o=bh(dh(e.vertices[r.indices[1]],e.vertices[r.indices[0]],n),dh(e.vertices[r.indices[2]],e.vertices[r.indices[0]],a),n);Rh(o,o),ch(o,r.normal)}}(s),function(e){var t,r,n,a,o,_,i={},s=[],l=[],c=Math.pow(10,4);for(n=0,a=e.vertices.length;n<a;n++)t=e.vertices[n],void 0===i[r=Math.round(t[0]*c)+"_"+Math.round(t[1]*c)+"_"+Math.round(t[2]*c)]?(i[r]=n,s.push(t),l[n]=s.length-1):l[n]=l[i[r]];var E=[];for(n=0,a=e.faces.length;n<a;n++){(o=e.faces[n]).indices[0]=l[o.indices[0]],o.indices[1]=l[o.indices[1]],o.indices[2]=l[o.indices[2]],_=[o.indices[0],o.indices[1],o.indices[2]];for(var u=0;u<3;u++)if(_[u]==_[(u+1)%3]){E.push(n);break}}for(n=E.length-1;n>=0;n--)e.faces.splice(E[n],1);for(e.vertices.length=0,n=0;n<s.length;n++)e.vertices.push(s[n])}(s),function(e){for(var t=[],r=e.vertices,n=0,a=0;a<e.faces.length;a++){var o=e.faces[a];t.push({id:n++,vertex_ids:o.indices,centroid:o.centroid,normal:o.normal,neighbours:[]})}var _,i,s={polygons:t,vertices:r},l={};for(a=0;a<t.length;a++)for(var c=0;c<3;c++)(d=(_=t[a].vertex_ids[c])>(i=t[a].vertex_ids[(c+1)%3])?i+"-"+_:_+"-"+i)in l||(l[d]=[]),l[d].push(t[a]);for(var E=Object.keys(l),u=(a=0,E.length);a<u;a++){var d=E[a];for(c=0;c<l[d].length;c++)for(var T=c+1;T<l[d].length;T++)l[d][c].neighbours.push(l[d][T]),l[d][T].neighbours.push(l[d][c])}return s}(s)))},t.navmesh_get_island=function(e,t,r){for(var a=null,o=Number.MAX_VALUE,_=e.islands,i=0;i<_.length;i++)for(var s=0;s<_[i].length;s++){var l=_[i][s];dh(l.centroid,t,n);var c=r(t,l.centroid,l.vertex_ids,e.vertices,o);c<o&&(a=i,o=c)}return a},t.is_vector_in_poly=function(e,t,r){for(var n=[],a=0;a<t.length;a++)n.push(r[t[a]]);return!!function(e,t){for(var r=!1,n=-1,a=e.length,o=a-1;++n<a;o=n)(e[n][1]<=t[1]&&t[1]<e[o][1]||e[o][1]<=t[1]&&t[1]<e[n][1])&&t[0]<(e[o][0]-e[n][0])*(t[1]-e[n][1])/(e[o][1]-e[n][1])+e[n][0]&&(r=!r);return r}(n,e)},t.navmesh_find_path=function(e,t,r,a){var o=function(e,t,r,a){var o=e.islands[a.island],_=e.vertices,i=N(o,_,t,a.allowed_distance,a.distance_to_closest);if(!i)return null;var s=N(o,_,r,a.allowed_distance,a.distance_to_farthest);return s?function(e,t,r,a,o,_){function i(e,t){return dh(e,t,n),Ih(n,n)}function s(e,t){for(var r=[],n=0;n<t.neighbours.length;n++)r.push(e[t.neighbours[n]]);return r}!function(e){for(var t=0;t<e.length;t++){var r=e[t];r.f=0,r.g=0,r.h=0,r.cost=1,r.visited=!1,r.closed=!1,r.parent=null}}(e);var l,c,E,u={content:[],score_function:function(e){return e.f}};for(rv(u,t);u.content.length>0;){var d=(c=(l=u).content[0],E=l.content.pop(),l.content.length>0&&(l.content[0]=E,ov(l,0)),c);if(d===r){for(var T=d,f=[];T.parent;)f.push(T),T=T.parent;return f.push(t),f.reverse()}d.closed=!0;for(var p=s(e,d),P=0,S=p.length;P<S;P++){var A=p[P];if(!A.closed){var h=d.g+hh(A.centroid,d.centroid),v=A.visited;(!v||h<A.g)&&(A.visited=!0,A.parent=d,A.h=A.h||i(A.centroid,o)+i(A.centroid,a),A.g=h,A.f=A.g+A.h,v?av(u,A):rv(u,A))}}}return[]}(o,i,s,t,r):null}(e,t,r,a);return o&&o.length?a.do_not_pull_string?function(e,t){if(t){for(var r=new Float32Array(3*e.length),n=0;n<e.length;n++)r.set(e[n].centroid,3*n);return{positions:r,normals:null}}var a=new Float32Array(3*e.length),o=new Float32Array(3*e.length);for(n=0;n<e.length;n++)a.set(e[n].centroid,3*n),o.set(e[n].normal,3*n);return{positions:a,normals:o}}(o,a.return_normals):function(e,t,r,n,a){var o=[];I(o,t,t,!1,e[0]&&e[0].normal||Ug);for(var _=0;_<e.length;_++){var i=e[_],s=e[_+1];if(s){var c=Math.abs(Ih(i.normal,s.normal))<.999,p=R(i,s);I(o,n[p[0]],n[p[1]],c,s.normal)}}return I(o,r,r,!1,o[o.length-1].normal),function(e,t){var r,n,a,o,_,i,s=[],c=[],p=0,P=0,S=0;r=e[0].right,a=e[0].right,o=ch(n=e[0].left,E),_=ch(a,u),i=ch(e[0].normal,f),A(s,r),t&&A(c,e[0].normal);var g=LA(l);function N(t,s){P=p=s,S=p,n=r=t,a=r,ch(t,o),ch(t,_),ch(e[p].normal,i)}for(var R=1;R<e.length;R++){var I=e[R].left,b=e[R].right,y=xh(I,g,d),L=xh(b,g,T);if(e[R].is_crucial&&m(g,e[R],e[R-1]),h(r,_,L,i)<=0){if(!(v(r,a)||h(r,o,L,i)>0)){var Y=v(o,r);Y||O(e,o,P,r,p,i,s,t,c),g=LA(g),N(n,P),R=p,Y||(A(s,r),t&&A(c,e[R].normal));continue}a=b,ch(L,_),S=R}if(h(r,o,y,i)>=0){if(!(v(r,n)||h(r,_,y,i)<0)){var M=v(_,r);M||O(e,_,S,r,p,i,s,t,c),g=LA(g),N(a,S),R=p,M||(A(s,r),t&&A(c,e[R].normal));continue}n=I,ch(y,o),P=R}}var x=e.length-1,C=e[x].left,w=v(r,C);return w||O(e,o,x,r,p,i,s,t,c),w&&p||A(s,C),t?(A(c,e[x].normal),{positions:new Float32Array(s),normals:new Float32Array(c)}):{positions:new Float32Array(s),normals:null}}(o,a)}(o,t,r,e.vertices,a.return_normals):null}})),CI=nA("__physics",(function(e,t){var r=gN(e),n=dR(e),a=AI(e),o=gI(e),_=PI(e),i=mN(e),s=LI(e),l=mR(e),c=MI(e),E=xI(e),u=JI(e),d=n.physics,T=n.defaults,f=n.assets,p=0,P=[],S=[],A={},h=[],v=["ANY"],m={body:0,constraint:0,ray_test:0},g=new Float32Array(3),O=(new Float32Array(3),new Float32Array(4)),N=wm();function R(e,t){for(var r=e.cons_descends,n=0;n<r.length;n++)r[n].physics_settings.use_collision_compound&&t.push(r[n]),R(r[n],t);return null}function I(e,t,r){for(var n=e._physics.bundles,a=0;a<n.length;a++)for(var o=n[a].physics,_=0;_<o.collision_tests.length;_++){var i=o.collision_tests[_];"ANY"!=i.collision_id&&r!=i.collision_id||ce(i,e,t)}}function b(e,t){for(var r=e._physics.bundles,n=0;n<r.length;n++){var a=r[n].batch;if(a&&a.id==t.id)return!0}return!1}function y(e,t,r){if(o.is_active(e))switch(t){case o.IN_LOADED:L(e)._physics.worker_loaded=!0;var n=Date.now()-performance.now();o.post_msg(e,o.OUT_INIT,n,d.max_fps,d.calc_fps?T.fps_measurement_interval:0);break;case o.IN_LOG:i.log_raw("URANIUM:",r.slice(1));break;case o.IN_ERROR:i.error(r);break;case o.IN_FBMSG:a.fbmsg.apply(this,r.slice(1));break;case o.IN_TRANSFORM:(l=M(r.body_id))&&x(l,r.time,r.trans,r.quat,r.linvel,r.angvel);break;case o.IN_PROP_OFFSET:var _=M(r.chassis_hull_body_id);_&&function(e,t,r,n){Gm(r,1,n,e.vehicle.prop_offsets[t])}(_,r.prop_ind,r.trans,r.quat);break;case o.IN_FLOATER_BOB_TRANSFORM:var s=M(r[1]);s&&function(e,t,r,n){var a=e.floater.bobs[t];c.set_translation(a,r),c.set_rotation(a,n),c.update_transform(a)}(s,r[2],r[3],r[4]);break;case o.IN_VEHICLE_SPEED:(l=M(r[1]))&&(l.vehicle.speed=r[2]);break;case o.IN_COLLISION:C(L(e),r.body_id_a,r.body_id_b,r.result,null,null,0);break;case o.IN_COLLISION_POS_NORM:C(L(e),r.body_id_a,r.body_id_b,r.result,r.coll_point,r.coll_norm,r.coll_dist);break;case o.IN_COLLISION_IMPULSE:var l;if(l=M(r[1])){var E=l.physics;E.col_imp_test_cb&&E.col_imp_test_cb(r[2])}break;case o.IN_RAY_HIT:case o.IN_RAY_HIT_POS_NORM:var u=L(e)._physics.ray_tests[r.id];if(u){var f=M(r.body_id_hit);t==o.IN_RAY_HIT?U(u,r.hit_fract,f,r.hit_time,null,null):U(u,r.hit_fract,f,r.hit_time,r.hit_pos,r.hit_norm)}break;case o.IN_REMOVE_RAY_TEST:fe(r.id);break;case o.IN_PING:var S=P.indexOf(e),A=(r[2]-r[1]).toFixed(3),h=(performance.now()-r[2]).toFixed(3),v=(performance.now()-r[1]).toFixed(3);i.log("Physics #"+S+" Ping: OUT "+A+" ms, IN "+h+" ms, ALL "+v+" ms");break;case o.IN_FPS:p=r[1];break;case o.IN_DEBUG_STATS:S=P.indexOf(e),i.log("Worker: #"+String(S)),i.log(r[1]);break;default:i.error("Wrong message: "+t)}}function L(e){for(var t=0;t<P.length;t++)if(P[t]==e)return S[t]}function Y(e){for(var t=0;t<S.length;t++)if(S[t]==e)return P[t]}function M(e){return A[e]||null}wm(),t.init_scene_physics=function(e){e._physics={worker_loaded:!1,bundles:[],ray_tests:{},ray_tests_arr:[]};var t=d.uranium_path;f.prevent_caching&&(t+="?v="+eI()),i.log("%cLOAD PHYSICS","color: #0a0",d.use_workers?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+d.max_fps),i.log("%cPHYSICS PATH","color: #0a0",t);var r=o.create_worker(t,!d.use_workers);o.attach_handler(r,y),P.push(r),S.push(e),d.ping&&setInterval((function(){o.post_msg(r,o.OUT_PING,performance.now())}),1e3)},t.check_worker_loaded=function(e){return!e._physics||e._physics.worker_loaded},t.cleanup=function(){for(var e=0;e<P.length;e++)o.terminate(P[e]);for(var t in P.length=0,S.length=0,A={},h.length=0,v=["ANY"],m)m[t]=0},t.append_object=function(e,t){if(ee(t)){var r=e.physics_settings,n=Y(t),a=[];r.use_collision_compound&&R(e,a);var s=t._physics.bundles;if(me(e)||ge(e)||e.is_character||Ne(e)||e.use_obj_physics){var l=Oe(e);if(l)var c=function(e,t){var r=j(F(),"NAVMESH"),n=_.get_scene_data(e,t).batches;r.navmesh=null;for(var a=0;a<n.length;a++){var o=n[a];if("PHYSICS"==o.type){r.navmesh=E.navmesh_build_from_bufs_data(o.bufs_data);break}}return r}(e,t);else c=function(e,t,r){var n=Q(e,t,!1);o.post_msg(r,o.OUT_APPEND_BOUNDING_BODY,n.body_id,n.trans,n.quat,n.physics_type,n.is_ghost,n.disable_sleeping,n.mass,n.velocity_min,n.velocity_max,n.damping,n.rotation_damping,n.collision_id_num,n.collision_margin,n.collision_group,n.collision_mask,n.bounding_type,n.worker_bounding,n.size,n.friction,n.restitution,n.comp_children_params,n.correct_bound_offset),A[n.body_id]=e,h.push(e);var a=j(n.body_id,"BOUNDING");return a.type=n.physics_type,a.mass=n.mass,a.is_ghost=n.is_ghost,a.collision_id=n.collision_id,a.collision_id_num=n.collision_id_num,a}(e,a,n);e.physics=c;var u={batch:null,physics:c};l||(s.push(u),I(t,n,c.collision_id))}else for(var d=_.get_scene_data(e,t).batches,T=0;T<d.length;T++){var f=d[T];"PHYSICS"!=f.type||b(t,f)||(f.submesh.base_length?f.water&&t._render.water_params?G(f,t,n):(c=f.use_ghost?z(e,f,n):B(e,f,n),e.physics=c,s.push(u={batch:f,physics:c}),I(t,n,c.collision_id)):i.error("Object "+e.name+" has collision material with no assigned vertices"))}for(me(e)||ge(e)?(function(e,t){var r=e.physics.body_id;if(me(e)?(e.vehicle.type=10,o.post_msg(t,o.OUT_APPEND_CAR,r,e.vehicle.suspension_compression,e.vehicle.suspension_stiffness,e.vehicle.suspension_damping,e.vehicle.wheel_friction,e.vehicle.max_suspension_travel_cm)):ge(e)&&(e.vehicle.type=20,o.post_msg(t,o.OUT_APPEND_BOAT,r,e.vehicle.floating_factor,e.vehicle.water_lin_damp,e.vehicle.water_rot_damp)),e.vehicle.props){var n=e.vehicle.props;switch(e.vehicle.type){case 10:J(n[0],e,r,!0,t),J(n[1],e,r,!0,t),J(n[2],e,r,!1,t),J(n[3],e,r,!1,t);break;case 20:for(var a=0;a<n.length;a++)J(n[a],e,r,!1,t)}}}(e,n),Se(e,e.vehicle,n)):e.is_character?function(e,t){var r=e.render,n=e.physics,a=r.bb_local.max_z-r.bb_local.min_z,_=n.body_id,i=e.character_settings,s=i.walk_speed,l=i.run_speed,c=i.step_height,E=i.jump_strength,u=i.waterline,d=Z(e);o.post_msg(t,o.OUT_APPEND_CHARACTER,_,d,a,s,l,c,E,u),n.is_character=!0}(e,n):Ne(e)&&$(e,n),T=0;T<h.length;T++){var p=h[T];p.physics&&te(p)}}},t.find_obj_by_body_id=M;var x=function(){var e=ih();return function(t,r,n,a,o,_){var i=t.physics;i.curr_time=r,Gm(n,zm(t.render.world_tsr,e),a,i.curr_tsr),ch(o,i.linvel),ch(_,i.angvel)}}();function C(e,t,r,n,a,o,_){for(var i=e._physics.bundles,s=0;s<i.length;s++)for(var l=i[s].physics,c=0;c<l.collision_tests.length;c++){for(var E=l.collision_tests[c],u=E.pairs,d=!1,T=0;T<u.length;T++){var f=u[T];if(f[0]===t&&f[1]===r){E.pair_results[T]=n,d=!0;break}}if(d){var p=w(E);if(a&&E.body_id_src!=t&&((S=a)[0]=S[0]+(A=o)[0]*(h=_),S[1]=S[1]+A[1]*h,S[2]=S[2]+A[2]*h,A[0]*=-1,A[1]*=-1,A[2]*=-1),p)P=M(E.body_id_src==t?r:t);else var P=null;E.callback(p,P,a,o,_)}}var S,A,h}function w(e){for(var t=e.pair_results,r=!1,n=0;n<t.length;n++)r=r||t[n];return r}function U(e,t,r,n,a,o){var _=e.callback;a?_(e.id,t,r,n,a,o):_(e.id,t,r,n)}function k(e,t,r){e&&o.is_fallback(e)&&o.post_msg(e,o.OUT_UPDATE_WORLD,t,r);for(var n=0;n<h.length;n++){var a=h[n],_=a.physics;if(_.simulated&&_.curr_time){if(o.is_fallback(e))var i=t-_.curr_time;else i=performance.now()/1e3-_.curr_time;i=Math.min(i,10/d.max_fps),i-=1/d.max_fps,T.no_phy_interp_hack&&(i=0);var s=N;ug(_.curr_tsr,i,_.linvel,_.angvel,N),c.set_tsr(a,s),c.update_transform(a),se(a),a.vehicle&&D(a),a.vehicle&&a.vehicle.steering_wheel&&Ae(a),a.vehicle&&a.vehicle.speedometer&&he(a),a.vehicle&&a.vehicle.tachometer&&ve(a)}}o.post_msg_arr(e)}function D(e){for(var t=e.vehicle.props,r=e.render.world_tsr,n=N,a=0;a<t.length;a++){var o=t[a];tg(r,e.vehicle.prop_offsets[a],n),c.set_tsr(o,n),c.update_transform(o)}}function F(){return m.body++,m.body}function G(e,t,r){var n=t._render.water_params;if(o.post_msg(r,o.OUT_APPEND_WATER,n.water_level),e.water_dynamics){var a={};a.dst_noise_scale0=e.dst_noise_scale0,a.dst_noise_scale1=e.dst_noise_scale1,a.dst_noise_freq0=e.dst_noise_freq0,a.dst_noise_freq1=e.dst_noise_freq1,a.dir_min_shore_fac=e.dir_min_shore_fac,a.dir_freq=e.dir_freq,a.dir_noise_scale=e.dir_noise_scale,a.dir_noise_freq=e.dir_noise_freq,a.dir_min_noise_fac=e.dir_min_noise_fac,a.dst_min_fac=e.dst_min_fac,a.waves_hor_fac=e.waves_hor_fac;var _=n.waves_height,i=n.waves_length;n.shoremap_image?o.post_msg(r,o.OUT_ADD_WATER_WRAPPER,a,n.shoremap_size[0],n.shoremap_size[1],n.shoremap_center[0],n.shoremap_center[1],n.max_shore_dist,_,i,n.shoremap_tex_size,t._render.shore_distances):o.post_msg(r,o.OUT_ADD_WATER_WRAPPER,a,0,0,0,0,0,_,i,0,null)}}function K(e,t,r){if(r)var n=e.physics.body_id;else n=F();var a=t.submesh;return{body_id:n,submesh:a,positions:a.va_frames[0].a_position,indices:a.indices||null,trans:jm(e.render.world_tsr,g),friction:t.friction,restitution:t.elasticity,collision_id:t.collision_id,collision_id_num:H(t.collision_id),collision_margin:t.collision_margin,collision_group:t.collision_group,collision_mask:t.collision_mask}}function B(e,t,r){var n=K(e,t);o.post_msg(r,o.OUT_APPEND_STATIC_MESH_BODY,n.body_id,n.positions,n.indices,n.trans,n.friction,n.restitution,n.collision_id_num,n.collision_margin,n.collision_group,n.collision_mask);var a=j(n.body_id,"STATIC_MESH");return a.collision_id=n.collision_id,a.collision_id_num=n.collision_id_num,a}function X(e,t,r){var n=K(e,t,!0);o.post_msg(r,o.OUT_UPDATE_STATIC_MESH_BODY,n.body_id,n.positions,n.indices,n.trans,n.friction,n.restitution,n.collision_id_num,n.collision_margin,n.collision_group,n.collision_mask)}function H(e){var t=v.indexOf(e);return-1==t?(v.push(e),v.length-1):t}function j(e,t){return{body_id:e,type:t,mass:0,is_ghost:!1,simulated:!0,is_vehicle:!1,is_character:!1,is_floater:!1,cons_id:null,collision_id:"",collision_id_num:0,collision_callbacks:{},collision_tests:[],col_imp_test_cb:null,curr_time:0,curr_tsr:wm(),linvel:new Float32Array(3),angvel:new Float32Array(3),cached_trans:new Float32Array(3),cached_quat:new Float32Array(4),navmesh:null}}t.update=function(e,t){for(var r=0;r<P.length;r++){k(P[r],e,t);var n=S[r],a=n._render.water_params;if(a&&a.waves_height>0){var _=s.get_subs(n,l.MAIN_OPAQUE),i=mh(_.wind)||1;o.post_msg(P[r],o.OUT_SET_WATER_TIME,_.time*i)}}},t.get_active_scene=function(){return S[0]},t.pause=function(){for(var e=0;e<P.length;e++)o.post_msg(P[e],o.OUT_PAUSE)},t.resume=function(){for(var e=0;e<P.length;e++)o.post_msg(P[e],o.OUT_RESUME)};var z=function(){var e=ih();return function(t,r,n){var a=F(),_=r.submesh,i=_.va_frames[0].a_position,s=_.indices||null,l=r.collision_id,c=H(l),E=r.collision_margin,u=r.collision_group,d=r.collision_mask,T=jm(t.render.world_tsr,e);o.post_msg(n,o.OUT_APPEND_GHOST_MESH_BODY,a,i,s,T,c,E,u,d);var f=j(a,"STATIC_MESH");return f.is_ghost=!0,f.collision_id=l,f.collision_id_num=c,f}}(),Q=function(){var e=dm(),t=ih();return function(r,n,a){var o=r.render,_=r.physics_settings,i=_.physics_type;if(a)var s=function(e){for(var t in A)if(A[t]===e)return t;return-1}(r);else s=F();if(!(s<=0)){if("CAMERA"==r.type)var l=q(u=_.use_collision_bounds?_.collision_bounds_type:"BOX",o),c=.5,E=0;else if("EMPTY"==r.type){var u="EMPTY";l=null,c=0,E=0}else{l=q(u=_.use_collision_bounds?_.collision_bounds_type:"BOX",o);var d=zm(o.world_tsr,t);1==d[0]&&1==d[1]&&1==d[2]||function(e,t,r){switch(t){case"BOX":e.min_x*=r[0],e.max_x*=r[0],e.min_y*=r[1],e.max_y*=r[1],e.min_z*=r[2],e.max_z*=r[2];break;case"CYLINDER":case"CONE":case"CAPSULE":e.height*=r[2],e.radius*=Math.max(r[0],r[1]);break;case"SPHERE":e.radius*=Math.max(r[0],r[1])}}(l,u,d),c=o.friction,E=o.elasticity}var T=W(l);return{body_id:s,trans:jm(o.world_tsr,t),quat:Vm(o.world_tsr,e),is_ghost:_.use_ghost,disable_sleeping:_.use_sleep,mass:_.mass,velocity_min:_.velocity_min,velocity_max:_.velocity_max,damping:_.damping,rotation_damping:_.rotation_damping,collision_id:r.collision_id,collision_id_num:H(r.collision_id),collision_margin:_.collision_margin,collision_group:_.collision_group,collision_mask:_.collision_mask,size:o.bs_local.radius,worker_bounding:T,correct_bound_offset:r.correct_bounding_offset,restitution:E,friction:c,bounding_type:u,physics_type:i,comp_children_params:V(o,n,u,T)}}}}(),V=function(){var e=dm(),t=dm(),r=wm(),n=ih();return function(a,o,_,i){if(!o.length)return[];var s=[],l={};l.quat=new Float32Array([0,0,0,1]),l.trans=new Float32Array(3),l.worker_bounding=i,l.bounding_type=_,s.push(l);for(var c=Zm(a.world_tsr,r),E=Ym(Vm(a.world_tsr,e),e),u=0;u<o.length;u++){var d={},T=o[u],f=T.physics_settings.collision_bounds_type,p=new Float32Array(4),P=new Float32Array(3),S=jm(T.render.world_tsr,n),A=Vm(T.render.world_tsr,t);rg(S,c,P),mm(E,A,p),d.trans=P,d.quat=p,d.bounding_type=f,d.worker_bounding=W(q(f,T.render)),s.push(d)}return s}}();function q(e,t){switch(e){case"BOX":var r=t.bb_local;break;case"CYLINDER":r=t.bcyl_local;break;case"CONE":r=t.bcon_local;break;case"SPHERE":r=t.bs_local;break;case"CAPSULE":r=t.bcap_local}return r}function W(e){if(!e)return null;var t=e,r={};return"number"==typeof t.min_x&&(r.min_x=t.min_x),"number"==typeof t.min_y&&(r.min_y=t.min_y),"number"==typeof t.min_z&&(r.min_z=t.min_z),"number"==typeof t.max_x&&(r.max_x=t.max_x),"number"==typeof t.max_y&&(r.max_y=t.max_y),"number"==typeof t.max_z&&(r.max_z=t.max_z),"object"==typeof t.center&&(r.center=t.center),"number"==typeof t.radius&&(r.radius=t.radius),"number"==typeof t.height&&(r.height=t.height),r}var J=function(){var e=wm(),t=ih();return function(r,n,a,_,i){var s=jm(r.render.world_tsr,t),l=Zm(n.render.world_tsr,e),c=new Float32Array(3);switch(rg(s,l,c),n.vehicle.type){case 10:var E=n.vehicle_settings,u=r.render.bb_local;o.post_msg(i,o.OUT_ADD_CAR_WHEEL,a,c,E.suspension_rest_length,E.roll_influence,(u.max_z-u.min_z)/2,_);break;case 20:o.post_msg(i,o.OUT_ADD_BOAT_BOB,a,c,r.bob_synchronize_pos)}}}(),Z=function(){var e=dm(),t=ih(),r=ih();return function(n){var a=Vm(n.render.world_tsr,e),o=t,_=r;switch(n.type){case"CAMERA":o[0]=0,o[1]=-1,o[2]=0,wh(o,a,o),_[0]=0,_[1]=0,_[2]=-1;break;case"MESH":o[0]=0,o[1]=0,o[2]=1,wh(o,a,o),_[0]=0,_[1]=0,_[2]=1;break;case"EMPTY":o[0]=0,o[1]=1,o[2]=0,wh(o,a,o),_[0]=0,_[1]=1,_[2]=0}o[1]=0,Rh(o,o);var i=Ih(o,_),s=-o[0]*_[2]>0?-1:1;return Math.acos(i)*s}}(),$=function(){var e=ih(),t=wm();return function(r,n){var a=r.physics.body_id;if(o.post_msg(n,o.OUT_APPEND_FLOATER,a,r.floater.floating_factor,r.floater.water_lin_damp,r.floater.water_rot_damp),r.floater.bobs)for(var _=r.floater.bobs,i=0;i<_.length;i++){var s=_[i],l=jm(s.render.world_tsr,e),c=Zm(r.render.world_tsr,t),E=new Float32Array(3);rg(l,c,E),o.post_msg(n,o.OUT_ADD_FLOATER_BOB,a,E,s.bob_synchronize_pos)}r.physics.is_floater=!0}}();function ee(e){return Boolean(e._physics)}t.enable_simulation=function(e){var t=e.physics;if(t||r.panic("No object physics"),!t.simulated){var n=t.body_id,a=ie(n);t.simulated=!0,o.post_msg(a,o.OUT_ENABLE_SIMULATION,n)}},t.disable_simulation=function(e){var t=e.physics;if(t||r.panic("No object physics"),t.simulated){var n=t.body_id,a=ie(n);t.simulated=!1,o.post_msg(a,o.OUT_DISABLE_SIMULATION,n)}},t.scene_has_physics=ee,t.obj_has_physics=function(e){return Boolean(e.physics)},t.has_dynamic_physics=function(e){var t=e.physics;return!!(t&&t.simulated&&("RIGID_BODY"==t.type||"DYNAMIC"==t.type)&&t.mass>0&&0==t.is_ghost)},t.has_simulated_physics=function(e){var t=e.physics;return!(!t||!t.simulated)},t.set_gravity=function(e,t,r,n){var a=e.physics.body_id,_=ie(a);o.post_msg(_,o.OUT_SET_GRAVITY,a,t,r,n)};var te=function(){var e=dm(),t=wm(),r=wm(),n=ih();return function(a){if(!re(a))for(var o=0;o<a.physics_constraints.length;o++){var _=a.physics_constraints[o],i=_.target,s=_.pivot_type;if(i.physics){var l=ne(_),c=ae(_);"HINGE"==s&&Om(c,Math.PI/2,c);var E=Fm(t);E=Hm(c,E=Km(l,E));var u=tg(a.render.world_tsr,E,t),d=Zm(i.render.world_tsr,r),T=tg(d,u,d);_e(s,a,l,c,i,jm(T,n),Vm(T,e),oe(_),null,null)}}}}();function re(e){return e.physics&&e.physics.cons_id}function ne(e){return new Float32Array([e.pivot_x,e.pivot_y,e.pivot_z])}function ae(e){return tO(new Float32Array([e.axis_x,e.axis_y,e.axis_z]),new Float32Array(4))}function oe(e){var t={};return t.use_limit_x=e.use_limit_x,t.use_limit_y=e.use_limit_y,t.use_limit_z=e.use_limit_z,t.use_angular_limit_x=e.use_angular_limit_x,t.use_angular_limit_y=e.use_angular_limit_y,t.use_angular_limit_z=e.use_angular_limit_z,t.limit_max_x=e.limit_max_x,t.limit_min_x=e.limit_min_x,t.limit_max_y=e.limit_max_y,t.limit_min_y=e.limit_min_y,t.limit_max_z=e.limit_max_z,t.limit_min_z=e.limit_min_z,t.limit_angle_max_x=e.limit_angle_max_x,t.limit_angle_min_x=e.limit_angle_min_x,t.limit_angle_max_y=e.limit_angle_max_y,t.limit_angle_min_y=e.limit_angle_min_y,t.limit_angle_max_z=e.limit_angle_max_z,t.limit_angle_min_z=e.limit_angle_min_z,t}function _e(e,t,r,n,a,_,i,s,l,c){var E=(m.constraint++,m.constraint.toString(16)),u=t.physics.body_id,d=a.physics.body_id,T=ie(u);o.post_msg(T,o.OUT_APPEND_CONSTRAINT,E,e,s,u,r,n,d,_,i,l,c),t.physics.cons_id=E}function ie(e){for(var t=0;t<S.length;t++)for(var r=S[t]._physics.bundles,n=0;n<r.length;n++)if(r[n].physics.body_id==e)return P[t];return null}function se(e){if(function(e){var t=e.physics;return!!t&&(0===t.mass||!0===t.is_ghost||!1===t.simulated||"RIGID_BODY"!==t.type&&"DYNAMIC"!==t.type)}(e)&&function(e){var t=jm(e.render.world_tsr,g),r=Vm(e.render.world_tsr,O);return t[0]!=e.physics.cached_trans[0]||t[1]!=e.physics.cached_trans[1]||t[2]!=e.physics.cached_trans[2]||r[0]!=e.physics.cached_quat[0]||r[1]!=e.physics.cached_quat[1]||r[2]!=e.physics.cached_quat[2]||r[3]!=e.physics.cached_quat[3]}(e)){var t=e.physics,r=e.render,n=o.get_msg_cache(o.OUT_SET_TRANSFORM);n.body_id=t.body_id;var a=jm(r.world_tsr,n.trans),_=Vm(r.world_tsr,n.quat);ch(a,t.cached_trans),Bv(_,t.cached_quat),"DYNAMIC"==t.type&&hm(n.quat);var i=ie(t.body_id);o.post_msg(i,o.OUT_SET_TRANSFORM)}for(var s=e.cons_descends,l=0;l<s.length;l++)se(s[l])}t.has_constraint=re,t.apply_constraint=_e,t.clear_constraint=function(e){var t=e.physics,r=t.cons_id,n=ie(t.body_id);o.post_msg(n,o.OUT_REMOVE_CONSTRAINT,r),t.cons_id=null},t.pull_to_constraint_pivot=function(){var e=dm(),r=wm(),n=wm(),a=wm();return function(o,_,i,s,l,E){var u=Gm(_,1,i,r),d=Gm(l,1,E,n);Zm(u,u),tg(d,u,u),c.get_tsr(s,d),tg(d,u,u),c.set_tsr(o,u),c.update_transform(o);var T=jm(o.render.world_tsr,a),f=Vm(o.render.world_tsr,e);t.set_transform(o,T,f)}}(),t.set_transform=function(e,t,r){var n=e.physics,a=o.get_msg_cache(o.OUT_SET_TRANSFORM);Gm(jm(e.render.world_tsr,a.trans),1,Vm(e.render.world_tsr,a.quat),n.curr_tsr),a.body_id=n.body_id,ch(t,a.trans),Bv(r,a.quat);var _=ie(n.body_id);o.post_msg(_,o.OUT_SET_TRANSFORM)},t.sync_transform=se,t.sync_bounding=function(e,t){var r=e.physics_settings,n=Y(t),a=[];r.use_collision_compound&&R(e,a),(me(e)||ge(e)||e.is_character||Ne(e)||e.use_obj_physics)&&(Oe(e)||function(e,t,r){var n=Q(e,t,!0);o.post_msg(r,o.OUT_UPDATE_BOUNDING_BODY,n.body_id,n.trans,n.quat,n.physics_type,n.is_ghost,n.disable_sleeping,n.mass,n.velocity_min,n.velocity_max,n.damping,n.rotation_damping,n.collision_id_num,n.collision_margin,n.collision_group,n.collision_mask,n.bounding_type,n.worker_bounding,n.size,n.friction,n.restitution,n.comp_children_params,n.correct_bound_offset)}(e,a,n))},t.sync_mesh=function(e,t){for(var r=Y(t),n=e.scenes_data[0].batches,a=0;a<n.length;a++){var o=n[a];"PHYSICS"==o.type&&(u.update_batch_geometry(n[a],n[a].submesh,e.render.shape_keys_values),o.use_ghost?i.error("The function is not implemented for ghost objects yet"):X(e,o,r),I(t,r,e.physics.collision_id))}},t.apply_velocity=function(e,t,r,n){var a=g;le(e,t,r,n,a);var _=e.physics.body_id,i=Math.abs(0),s=Math.abs(0),l=Math.abs(0),c=Math.abs(a[0]),E=Math.abs(a[1]),u=Math.abs(a[2]);a[0]=c?a[0]/c*Math.max(c,i):0,a[1]=E?a[1]/E*Math.max(E,s):0,a[2]=u?a[2]/u*Math.max(u,l):0;var d=ie(_);o.post_msg(d,o.OUT_SET_LINEAR_VELOCITY,_,a[0],a[1],a[2])},t.apply_velocity_world=function(e,t,r,n){var a=e.physics.body_id,_=ie(a);o.post_msg(_,o.OUT_SET_LINEAR_VELOCITY,a,t,r,n)};var le=function(){var e=dm();return function(t,r,n,a,o){var _=o||new Float32Array(3),i=Vm(t.render.world_tsr,e);return _[0]=r,_[1]=n,_[2]=a,wh(_,i,_)}}();function ce(e,t,n){var a=e.pairs,_=e.pair_results,i=e.body_id_src,s=[];!function(e,t,n,a){n||r.panic("At least one destination required");for(var o=0;o<t._physics.bundles.length;o++){var _=t._physics.bundles[o];if("ANY"==e||_.physics.collision_id==e&&"NAVMESH"!=_.physics.type){var i=_.physics.body_id;n&&-1==n.indexOf(i)&&n.push(i)}}}(e.collision_id,t,s);for(var l=0;l<s.length;l++){var c=s[l];i<c&&!Ee(a,i,c)?(a.push([i,c]),_.push(!1)):i>c&&!Ee(a,c,i)&&(a.push([c,i]),_.push(!1))}o.post_msg(n,o.OUT_ACTIVATE,i),o.post_msg(n,o.OUT_APPEND_COLLISION_TEST,a,e.calc_pos_norm)}function Ee(e,t,r){for(var n=0;n<e.length;n++)if(e[n][0]==t&&e[n][1]==r)return!0;return!1}function ue(e,t,r){for(var n=e._physics.bundles,a=r,_=0;_<n.length;_++)for(var i=n[_].physics,s=0;s<i.collision_tests.length;s++)for(var l=i.collision_tests[s],c=0;c<l.pairs.length;c++)for(var E=l.pairs[c],u=0;u<a.length;u++){var d=a[u];E[0]==d[0]&&E[1]==d[1]&&(a.splice(u,1),u--)}a.length&&o.post_msg(t,o.OUT_REMOVE_COLLISION_TEST,a)}function de(e){if(Te(e)){var t=e.physics,r=ie(t.body_id);o.post_msg(r,o.OUT_CLEAR_COLLISION_IMPULSE_TEST,t.body_id),t.col_imp_test_cb=null}}function Te(e){return!(!e.physics||!e.physics.col_imp_test_cb)}function fe(e){var t=pe(e),r=Pe(e),n=t._physics;n.ray_tests[e]&&(delete n.ray_tests[e],n.ray_tests_arr.splice(n.ray_tests_arr.indexOf,1),o.post_msg(r,o.OUT_REMOVE_RAY_TEST,e))}function pe(e){for(var t=0;t<S.length;t++){var r=S[t];if(r._physics.ray_tests[e])return r}return null}function Pe(e){for(var t=0;t<S.length;t++)if(S[t]._physics.ray_tests[e])return P[t];return null}function Se(e,t,r){if(t.steering_wheel){var n=e.physics.body_id,a=t.engine_force*t.force_max,_=t.brake_force*t.brake_max,i=-t.steering*t.steering_max*2*Math.PI/t.steering_ratio;switch(t.inverse_control&&(i*=-1),t.type){case 10:o.post_msg(r,o.OUT_UPDATE_CAR_CONTROLS,n,a,_,i);break;case 20:o.post_msg(r,o.OUT_UPDATE_BOAT_CONTROLS,n,a,_,i)}}}t.apply_force=function(e,t,r,n,a){var _=g;a?(_[0]=t,_[1]=r,_[2]=n):le(e,t,r,n,_);var i=e.physics.body_id,s=ie(i);o.post_msg(s,o.OUT_APPLY_CENTRAL_FORCE,i,_[0],_[1],_[2])},t.apply_torque=function(e,t,r,n){var a=g;le(e,t,r,n,a);var _=e.physics.body_id,i=ie(_);o.post_msg(i,o.OUT_APPLY_TORQUE,_,a[0],a[1],a[2])},t.set_angular_velocity=function(e,t,r,n){var a=e.physics.body_id,_=ie(a);o.post_msg(_,o.OUT_SET_ANGULAR_VELOCITY,a,t,r,n)},t.set_character_move_dir=function(e,t,r){var n=e.physics.body_id,a=ie(n);o.post_msg(a,o.OUT_SET_CHARACTER_MOVE_DIR,n,t,r)},t.set_character_move_type=function(e,t){var r=e.physics.body_id,n=ie(r);o.post_msg(n,o.OUT_SET_CHARACTER_MOVE_TYPE,r,t)},t.set_character_walk_velocity=function(e,t){var r=e.physics.body_id,n=ie(r);o.post_msg(n,o.OUT_SET_CHARACTER_WALK_VELOCITY,r,t)},t.set_character_run_velocity=function(e,t){var r=e.physics.body_id,n=ie(r);o.post_msg(n,o.OUT_SET_CHARACTER_RUN_VELOCITY,r,t)},t.set_character_fly_velocity=function(e,t){var r=e.physics.body_id,n=ie(r);o.post_msg(n,o.OUT_SET_CHARACTER_FLY_VELOCITY,r,t)},t.character_jump=function(e){var t=e.physics.body_id,r=ie(t);o.post_msg(r,o.OUT_CHARACTER_JUMP,t)},t.character_rotation_inc=function(e,t,r){var n=e.physics.body_id,a=ie(n);o.post_msg(a,o.OUT_CHARACTER_ROTATION_INCREMENT,n,t,r)},t.set_character_rotation=function(e,t,r){var n=e.physics.body_id,a=ie(n);o.post_msg(a,o.OUT_SET_CHARACTER_ROTATION,n,t,r)},t.set_character_rotation_h=function(e,t){var r=e.physics.body_id,n=ie(r);o.post_msg(n,o.OUT_SET_CHARACTER_HOR_ROTATION,r,t)},t.set_character_rotation_v=function(e,t){var r=e.physics.body_id,n=ie(r);o.post_msg(n,o.OUT_SET_CHARACTER_VERT_ROTATION,r,t)},t.set_character_vert_move_dir_angle=function(e,t){var r=e.physics.body_id,n=ie(r);o.post_msg(n,o.OUT_SET_CHARACTER_VERT_MOVE_DIR_ANGLE,r,t)},t.append_collision_test=function(e,t,r,n){var a=e.physics;if(!a.navmesh){for(var o=a.body_id,_=0;_<a.collision_tests.length;_++)if((i=a.collision_tests[_]).collision_id==t&&i.callback==r)return;var i;a.collision_tests.push(i={body_id_src:o,calc_pos_norm:n||!1,collision_id:t,callback:r,pairs:[],pair_results:[]});var s=ie(o);ce(i,L(s),s)}},t.remove_collision_test=function(e,t,r){for(var n=e.physics,a=ie(n.body_id),o=L(a),_=0;_<n.collision_tests.length;_++){var i=n.collision_tests[_];if(i.collision_id==t&&i.callback==r){if(w(i)){var s=Eh(0,0,0,g);i.callback(!1,null,s,s,0)}n.collision_tests.splice(_,1),_--,ue(o,a,i.pairs)}}},t.apply_collision_impulse_test=function(e,t){Te(e)&&de(e);var r=e.physics,n=ie(r.body_id);o.post_msg(n,o.OUT_APPLY_COLLISION_IMPULSE_TEST,r.body_id),r.col_imp_test_cb=t},t.clear_collision_impulse_test=de,t.append_ray_test=function(e,t,r,n,a,_,i,s,l){var c=(m.ray_test++,m.ray_test),E={id:c,body_id:e?e.physics.body_id:0,from:new Float32Array(t),to:new Float32Array(r),collision_id:n,collision_id_num:H(n),autoremove:_,calc_all_hits:i,calc_pos_norm:s,ign_src_rot:l,callback:a},u=ie(E.body_id)||P[0],d=L(u)._physics;return d.ray_tests[c]=E,d.ray_tests_arr.push(E),o.post_msg(u,o.OUT_APPEND_RAY_TEST,E.id,E.body_id,E.from,E.to,E.collision_id_num,E.autoremove,E.calc_all_hits,E.calc_pos_norm,E.ign_src_rot),c},t.remove_ray_test=fe,t.change_ray_test_from_to=function(e,t,r){var n=pe(e),a=Pe(e),_=n._physics.ray_tests[e];_&&!_.autoremove&&(_.from.set(t),_.to.set(r),o.post_msg(a,o.OUT_CHANGE_RAY_TEST_FROM_TO,e,t,r))},t.is_ray_test=function(e){return!!pe(e)._physics.ray_tests[e]},t.vehicle_throttle=function(e,t){var r=e.vehicle;r.engine_force=t,Se(e,r,ie(e.physics.body_id))},t.vehicle_steer=function(e,t){var r=e.vehicle;r.steering=t,Se(e,r,ie(e.physics.body_id))},t.vehicle_brake=function(e,t){var r=e.vehicle;r.brake_force=t,Se(e,r,ie(e.physics.body_id))};var Ae=function(){var e=dm(),t=dm(),r=ih();return function(n){var a=n.vehicle,o=a.steering_wheel;if(o){var _=n.vehicle.steering_wheel_axis;tg(n.render.world_tsr,n.vehicle.steering_wheel_tsr,o.render.world_tsr);var i=vm(_g(_,n.render.world_tsr,r),-a.steering*a.steering_max*2*Math.PI,e),s=Vm(o.render.world_tsr,t);mm(i,s,s),am(s,s),Hm(s,o.render.world_tsr),c.update_transform(o)}}}(),he=function(){var e=dm(),t=dm(),r=ih();return function(n){var a=n.vehicle,o=a.speedometer;if(o){var _=n.vehicle.speedometer_axis;tg(n.render.world_tsr,n.vehicle.speedometer_tsr,o.render.world_tsr);var i=r;_g(_,n.render.world_tsr,i);var s=Math.abs(a.speed)*a.speed_ratio;s>a.max_speed_angle&&(s=a.max_speed_angle);var l=vm(i,-s,e),E=Vm(o.render.world_tsr,t);mm(l,E,E),am(E,E),Hm(E,o.render.world_tsr),c.update_transform(o)}}}(),ve=function(){var e=dm(),t=dm(),r=ih();return function(n){var a=n.vehicle,o=a.tachometer;if(o){var _=n.vehicle.tachometer_axis;tg(n.render.world_tsr,n.vehicle.tachometer_tsr,o.render.world_tsr);var i=r;_g(_,n.render.world_tsr,i);var s=e;vm(i,-Math.abs(a.engine_force)*a.delta_tach_angle,s);var l=Vm(o.render.world_tsr,t);mm(s,l,l),am(l,l),Hm(l,o.render.world_tsr),c.update_transform(o)}}}();function me(e){return e.is_vehicle&&"CHASSIS"==e.vehicle_settings.part}function ge(e){return e.is_vehicle&&"HULL"==e.vehicle_settings.part}function Oe(e){return"NAVMESH"==e.physics_settings.physics_type}function Ne(e){return e.is_floating&&"MAIN_BODY"==e.floating_settings.part}t.is_vehicle_chassis=me,t.is_vehicle_hull=ge,t.is_navigation_mesh=Oe,t.is_car_wheel=function(e){if(!e.is_vehicle)return!1;var t=e.vehicle_settings.part;return"WHEEL_FRONT_LEFT"==t||"WHEEL_FRONT_RIGHT"==t||"WHEEL_BACK_LEFT"==t||"WHEEL_BACK_RIGHT"==t},t.is_boat_bob=function(e){return!!e.is_vehicle&&"BOB"==e.vehicle_settings.part},t.is_floater_bob=function(e){return!!e.is_floating&&"BOB"==e.floating_settings.part},t.is_vehicle_steering_wheel=function(e){return!(!e.is_vehicle||"STEERING_WHEEL"!=e.vehicle_settings.part)},t.is_vehicle_speedometer=function(e){return!(!e.is_vehicle||"SPEEDOMETER"!=e.vehicle_settings.part)},t.is_vehicle_tachometer=function(e){return!(!e.is_vehicle||"TACHOMETER"!=e.vehicle_settings.part)},t.get_vehicle_speed=function(e){return e.vehicle.speed},t.wheel_index=function(e){switch(e){case"WHEEL_FRONT_RIGHT":return 0;case"WHEEL_FRONT_LEFT":return 1;case"WHEEL_BACK_LEFT":return 2;case"WHEEL_BACK_RIGHT":return 3}},t.has_character_physics=function(e){return e.physics&&e.physics.is_character},t.is_floater_main=Ne,t.get_fps=function(){return p},t.debug_workers=function(){for(var e=0;e<P.length;e++)o.post_msg(P[e],o.OUT_DEBUG)},t.remove_object=function(e){var t=e.physics.body_id;if("BOUNDING"==e.physics.type){var r=h.indexOf(e);-1==r&&i.error("Object "+e.name+" doesn't have bounding physics"),delete A[t],h.splice(r,1)}var n=ie(t),a=L(n);!function(e,t,r){for(var n=e._physics.bundles,a=[],_=0;_<n.length;_++)for(var i=n[_].physics,s=0;s<i.collision_tests.length;s++)for(var l=i.collision_tests[s],c=0;c<l.pairs.length;c++){var E=l.pairs[c],u=l.pair_results[c];if(E[0]==r||E[1]==r){if(l.pairs.splice(c,1),l.pair_results.splice(c,1),c--,u&&!w(l)){var d=Eh(0,0,0,g);l.callback(!1,null,d,d,0)}a.push(E)}}a.length&&o.post_msg(t,o.OUT_REMOVE_COLLISION_TEST,a)}(a,n,t),Te(e)&&de(e);for(var _=a._physics.bundles,s=0;s<_.length;s++)_[s].physics.body_id==t&&(_.splice(s,1),s--);o.post_msg(n,o.OUT_REMOVE_BODY,t)},t.has_dynamic_settings=function(e){var t=e.physics_settings;return e.is_vehicle||e.is_floating||e.is_character||e.use_obj_physics&&!t.use_ghost&&t.mass>0&&("DYNAMIC"==t.physics_type||"RIGID_BODY"==t.physics_type)}})),wI=nA("__animation",(function(e,t){var r=gN(e),n=dR(e),a=PI(e),o=SI(e),_=CI(e),i=mN(e),s=LI(e),l=yI(e),c=mR(e),E=AR(e),u=MI(e),d=n.animation,T=n.context_limits;t.LAST_FRAME_EPSILON=1e-6,t.OBJ_ANIM_TYPE_NONE=0,t.OBJ_ANIM_TYPE_ARMATURE=10,t.OBJ_ANIM_TYPE_OBJECT=20,t.OBJ_ANIM_TYPE_VERTEX=30,t.OBJ_ANIM_TYPE_SOUND=40,t.OBJ_ANIM_TYPE_PARTICLES=50,t.OBJ_ANIM_TYPE_MATERIAL=60,t.OBJ_ANIM_TYPE_LIGHT=70,t.OBJ_ANIM_TYPE_ENVIRONMENT=80,t.SLOT_0=0,t.SLOT_1=1,t.SLOT_2=2,t.SLOT_3=3,t.SLOT_4=4,t.SLOT_5=5,t.SLOT_6=6,t.SLOT_7=7,t.SLOT_ALL=-1,t.AB_CYCLIC=10,t.AB_FINISH_RESET=20,t.AB_FINISH_STOP=30;var f=new Array(3),p=new Float32Array(3),P=new Float32Array(3),S=new Float32Array(3),A=new Float32Array(4),h=new Float32Array(4),v=new Float32Array(4),m=new Float32Array(4),g=new Float32Array(4),O=new Float32Array(4),N=new Float32Array(4),R=new Float32Array(4),I=wm(),b=wm(),y=[],L=[];function Y(e,t){var r=e.anim_slots[t];r&&r.finish_callback&&r.exec_finish_callback&&(r.exec_finish_callback=!1,r.finish_callback(e,t))}function M(e,t,r){var n=e.anim_slots[r];n.type=30;var a=t.frame_start,o=t.frame_end-a+1;n.start=a,n.length=o,n.current_frame_float=a,n.animation_name=t.name;for(var _=0,i=0;i<e.vertex_anim.length;i++){var s=e.vertex_anim[i];if(s==t)break;_+=s.frame_end-s.frame_start+1}n.va_frame_offset=_}function x(e,t,r){t.type=50,t.animation_name=r.name,t.start=r.frame_start,t.length=r.frame_end-t.start,r.cyclic||(t.length+=r.lifetime_frames)}function C(e,t){var r={type:null,animation_name:null,action_frame_range:null,action_step:0,action_bflags:null,channels_mask:new Int8Array(8),quats:null,scale:null,trans:null,bone_space_quats:null,bone_space_trans:null,skinning_data:[],play:!1,behavior:20,current_frame_float:0,start:0,length:0,trans_smooth_period:0,quat_smooth_period:0,exec_finish_callback:!1,va_frame_offset:null,speed:1,volume:null,pitch:null,color:null,energy:null,zenith_color:null,horizon_color:null,fog_intensity:null,fog_depth:null,fog_start:null,fog_height:null,fog_color:null,nodemat_values:[],node_value_inds:[],nodemat_rgbs:[],node_rgb_inds:[],node_batches:null};if(!e.anim_slots.length)for(var n=0;n<8;n++)e.anim_slots.push(null);e.anim_slots[t]=r}function w(e){-1==y.indexOf(e)&&y.push(e)}function U(e){return e.replace(/_B4W_BAKED$/,"")}function k(e,t){return{name_list:e,action:t}}function D(e,t,r){if(e.animation_data){var n=e.animation_data.action;n&&60==n._render.type&&t.push(k(r,n))}for(var a=e.nodes,o=0;o<a.length;o++){var _=a[o];if(_.node_group){var i=_.node_group.node_tree;if(i){var s=r.slice();s.push(_.name),D(i,t,s)}}}}function F(e){return!(!a.is_mesh(e)||!e.render.vertex_anim)}function G(e,t,r){var n=e.anim_slots;if(-1==r)for(var a=0;a<8;a++){var o;(o=n[a])&&(o.current_frame_float=t,B(e,0,a,!0))}else(o=n[r])&&(o.current_frame_float=t,B(e,0,r,!0))}function K(e,t,r){if(-1==t)for(var n=0;n<8;n++){var a;(a=e[n])&&r(a)}else(a=e[t])&&r(a)}function B(e,t,r,n){$(e,t,r,n),Y(e,r),e.render.anim_mixing&&(ae(e,t),te(e,t))}function X(e,t,r,n){var _=r.frame_range;if(_[0]>_[1])return i.warn('Incompatible action "'+r.name+'" has been applied to object "'+e.name+'"'),!1;var s=r._render,l=e.anim_slots[n];switch(l.animation_name=r.name,l.action_frame_range=_,l.action_step=s.pierce_step,l.action_bflags=s.bflags,l.channels_mask.set(s.channels_mask),l.start=_[0],l.length=_[1]-_[0],l.current_frame_float=_[0],s.type){case 10:if(a.is_armature(e)){l.type=10;var c=H(e,t,r);c||j(e,t,r,c=oe(r,e.render.bone_pointers)),l.trans=c.trans,l.quats=c.quats,l.bone_space_quats=c.bone_space_quats,l.bone_space_trans=c.bone_space_trans,z(e,n,r,c)}break;case 40:a.is_speaker(e)&&(l.volume=s.params.volume||null,l.pitch=s.params.pitch||null,l.type=40);break;case 70:a.is_lamp(e)&&(l.color=s.params.color||null,l.energy=s.params.energy||null,l.type=70);break;case 60:if("MESH"==e.type||"WORLD"==e.type){l.type=60;var E=function(e,t,r,n){var a=[],o=[],_=[],i=[],s=[],l=r._render,c=t?t[0]:null;for(var E in l.params)for(var u=q(E,t),d=0;d<e.scenes_data.length;d++)for(var T=e.scenes_data[d].batches,f=0;f<T.length;f++){var p=T[f];if(n||!c||-1!=p.material_names.indexOf(c)){var P=p.node_rgb_inds,S=J(E,u,l,o,a,p.node_value_inds),A=W(E,u,l,i,_,P);(S||A)&&s.push(p)}}return{val_inds:a,values:o,rgb_inds:_,rgbs:i,node_batches:s}}(e,t,r,a.is_world(e));l.node_value_inds=E.val_inds,l.nodemat_values=E.values,l.node_rgb_inds=E.rgb_inds,l.nodemat_rgbs=E.rgbs,l.node_batches=E.node_batches}break;case 20:var u=s.params.tsr;if(!u)return i.warn('Incompatible action "'+r.name+'" has been applied to object "'+e.name+'"'),!1;l.type=20;var d=H(e,t,r);d||j(e,t,r,d=Z(e,r,u)),l.trans=d.trans,l.scale=d.scale,l.quats=d.quats,o.obj_has_particles(e)&&o.update_start_pos(e,l.trans[0],l.scale[0],l.quats[0]);break;case 80:a.is_world(e)&&(l.energy=s.params["light_settings.environment_energy"]||null,l.horizon_color=s.params.horizon_color||null,l.zenith_color=s.params.zenith_color||null,l.fog_intensity=s.params["mist_settings.intensity"]||null,l.fog_depth=s.params["mist_settings.depth"]||null,l.fog_start=s.params["mist_settings.start"]||null,l.fog_height=s.params["mist_settings.height"]||null,l.fog_color=s.params.b4w_fog_color||null,l.type=80)}return a.is_armature(e)&&10!=s.type&&V(e,n),!0}function H(e,t,r){var n=e.action_anim_cache;if(t)var a=t.join("%join%");else a=null;for(var o=0;o<n.length;o+=3)if(r==n[o]&&a==n[o+1])return n[o+2];return null}function j(e,t,r,n){var a=e.action_anim_cache;if(t)var o=t.join("%join%");else o=null;a.push(r,o,n)}function z(e,t,r,n){var a=e.render,o=a.skinned_renders,_=e.anim_slots[t],i=_.skinning_data,s=function(e,t){for(var r=e.skinning_data_cache,n=0;n<r.length;n+=2)if(t==r[n])return r[n+1];return null}(a,r);if(s)_.skinning_data=s;else{for(var l=0;l<o.length;l++){var c=ie(n,o[l].bone_skinning_info);i.push(c)}!function(e,t,r){e.skinning_data_cache.push(t,r)}(a,r,i)}if(a.anim_mixing){var E=a.blend_skel_slots;if(t>E[1]){var u=E[1];E[1]=t,E[0]=u}else t>E[0]&&t<E[1]&&(E[0]=t);Q(e)}}function Q(e){var t=e.render.blend_skel_slots;if(-1!=t[0]&&-1!=t[1]){var r=e.anim_slots,n=r[t[1]].current_frame_float,a=Math.floor(n),o=n-a,_=r[t[0]];n=_.current_frame_float,a=Math.floor(n),_.current_frame_float=a+o}}function V(e,t){var r=e.render.blend_skel_slots,n=r[1];if(r[0]=-1,r[1]=-1,-1!=t)for(var a=e.anim_slots,o=n;o>=0;o--){var _=a[o];if(_&&10==_.type){if(o>r[1]){r[1]=o;continue}o>r[0]&&(r[1]=o);break}}}function q(e,t){var r=e.match(/"(.*?)"/)[1];if(t&&t.length>1){for(var n=t[1],a=2;a<t.length;a++)n=n+"%join%"+t[a];n+="%join%"+r}else n=r;return n}function W(e,t,r,n,a,o){if(!o)return!1;for(var _=!1,i=0;i<o.length;i+=2)t==o[i]&&(a.push(o[i+1]),n.push(new Float32Array(r.params[e])),_=!0);return _}function J(e,t,r,n,a,o){if(!o)return!1;for(var _=!1,i=0;i<o.length;i+=3)t==o[i]&&(a.push(4*o[i+1]+o[i+2]),n.push(new Float32Array(r.params[e])),_=!0);return _}t.get_max_bones=function(){return OO((T.max_vertex_uniform_vectors-50)/4)},t.frame_to_sec=function(e){return e/E.get_framerate()},t.update=function(e){for(var t=0;t<y.length;t++){for(var r=y[t],n=0;n<8;n++)$(r,e,n);r.render.anim_mixing&&(ae(r,e),te(r,e))}for(t=0;t<y.length;t++)for(r=y[t],n=0;n<8&&r.anim_slots.length;n++)Y(r,n)},t.get_all_actions=function(){return L},t.get_anim_names=function(e){var t=[];if(F(e))for(var r=0;r<e.vertex_anim.length;r++)t.push(e.vertex_anim[r].name);var n=function(e){for(var t=[],r=0;r<L.length;r++){var n=L[r],a=n._render;20==a.type?t.push(n):60!=n._render.type||"MESH"!=e.type&&"WORLD"!=e.type?(10==a.type&&"ARMATURE"==e.type||40==a.type&&"SPEAKER"==e.type||80==a.type&&"WORLD"==e.type)&&t.push(n):t.push(n)}return t}(e);for(r=0;r<n.length;r++)t.push(U(n[r].name));if(o.obj_has_particles(e)&&o.obj_has_anim_particles(e)){var a=e.scenes_data;for(r=0;r<a.length;r++)for(var _=a[r].batches,i=0;i<_.length;i++){var s=_[i].particles_data;s&&t.push(s.name)}}return t},t.strip_baked_suffix=U,t.get_anim_type=function(e,t){var r=e.anim_slots[t];return r?r.type:0},t.apply_def=function(e){for(var t=0,r=e.scenes_data,n=0;n<r.length;n++)for(var a=r[n].batches,o=0;o<a.length;o++){var _=a[o].particles_data;_&&"EMITTER"==_.p_type&&!a[o].forked_batch&&(Te(e,t),x(0,e.anim_slots[t],_),fe(e,t),e.anim_slots[t].behavior=_.cyclic?10:e.anim_behavior_def,t++)}var i=function(e){return e.def_action_slots.slice()}(e);for(n=0;n<i.length;n++){var s=i[n],l=s.name_list,c=s.action;Te(e,t),X(e,l,c,t)?(fe(e,t),e.anim_slots[t].behavior=e.anim_behavior_def,t++):e.anim_slots[t]=null}F(e)&&(Te(e,t),M(e,e.vertex_anim[0],t),fe(e,t),e.anim_slots[t].behavior=e.anim_behavior_def,t++)},t.anim_behavior_bpy_b4w=function(e){switch(e){case"CYCLIC":return 10;case"FINISH_RESET":return 20;case"FINISH_STOP":return 30;default:r.panic("Wrong animation behavior")}},t.get_bpy_material_actions=function(e){for(var t=[],r=e.data.materials,n=0;n<r.length;n++){var a=r[n],o=a.node_tree;o&&D(o,t,[a.name])}return t},t.get_bpy_world_material_actions=function(e){var t=[],r=e.node_tree;return r&&D(r,t,[e.name]),t},t.init_action_slot=k,t.play=function(e,t,r){K(e.anim_slots,r,(function(e){e.play=!0,e.finish_callback=t||null,e.exec_finish_callback=!1})),e.render.anim_mixing&&Q(e)},t.stop=function(e,t){K(e.anim_slots,t,(function(e){e.play=!1,e.finish_callback=null,e.exec_finish_callback=!1}))},t.is_play=function(e,t){var r=e.anim_slots;if(-1==t){for(var n=0;n<8;n++)if(r[n]&&r[n].play)return!0}else{var a=r[t];if(a)return a.play}return!1},t.set_frame=G,t.set_first_frame=function(e,t){K(e.anim_slots,t=t||0,(function(r){G(e,r.start,t)}))},t.get_current_frame_float=function(e,t){var r=e.anim_slots[t];return r&&r.current_frame_float?r.current_frame_float:0},t.is_cyclic=function(e,t){var r=e.anim_slots[t];return r&&10==r.behavior},t.set_behavior=function(e,t,r){K(e.anim_slots,r,(function(e){e.behavior=t}))},t.get_behavior=function(e,t){var r=e.anim_slots[t];return r&&r.behavior},t.apply_smoothing=function(e,t,r,n){K(e.anim_slots,n,(function(e){e.trans_smooth_period=t||0,e.quat_smooth_period=r||0}))},t.remove_slot_animation=function(e,t){if(-1==t)for(var r=0;r<8;r++)e.anim_slots[r]=null;else e.anim_slots[t]=null;e.render.anim_mixing&&V(e,t)},t.update_object_animation=B,t.obj_is_animatable=function(e){if("ARMATURE"==e.type)return!0;if(e.armobj)return!0;if("WORLD"==e.type)return!0;for(var t=0;t<e.def_action_slots.length;t++){var r=e.def_action_slots[t].action._render.type;if(20==r||10==r||40==r&&"SPEAKER"==e.type||70==r&&"LAMP"==e.type||60==r&&"MESH"==e.type)return!0}return!(!o.obj_has_particles(e)||!o.obj_has_anim_particles(e))||!("MESH"!=e.type||!e.vertex_anim.length)},t.bpy_mesh_empty_is_animatable=function(e){if(Ae(e))return!0;if(e._def_action_slots)for(var t=0;t<e._def_action_slots.length;t++){var r=e._def_action_slots[t].action._render.type;if(20==r||60==r&&"MESH"==e.type)return!0}return!(!o.bpy_obj_has_particles(e)||!o.bpy_obj_has_anim_particles(e))||!("MESH"!=e.type||!e.data.b4w_vertex_anim.length)},t.is_animated=function(e){return Boolean(e.anim_slots.length)},t.init_action_cache=function(e,t,r,n,o){if(r)var _=Wg("uuid",r,L);else _=Wg("name",n,L)||Wg("name",n+"_B4W_BAKED",L);if(_){C(e,o),w(e);var s=_.frame_range;if(s[0]>s[1])return i.warn('Incompatible action "'+_.name+'" has been applied to object "'+e.name+'"'),!1;var l=_._render;switch(l.type){case 10:if(a.is_armature(e)){var c=H(e,t,_);c||j(e,t,_,c=oe(_,e.render.bone_pointers)),z(e,o,_,c)}break;case 20:var E=l.params.tsr;if(!E)return i.warn('Incompatible action "'+_.name+'" has been applied to object "'+e.name+'"'),!1;var u=H(e,t,_);u||j(e,t,_,u=Z(e,_,E))}}},t.delete_cached_anim_data_by_mat=function(e,t){for(var r=e.action_anim_cache,n=[],a=0;a<r.length;a+=3)(60!=r[a]._render.type||null!==r[a+1]&&r[a+1].split("%join%")[0]!=t)&&n.push(r[a],r[a+1],r[a+2]);e.action_anim_cache=n};var Z=function(){var e=wm();return function(t,r,n){for(var a=r._render.num_pierced,o=[],_=[],i=[],s=0;s<a;s++){var l=dg(n,s,e),c=jm(l,ih()),E=zm(l,ih()),u=Vm(l,dm());o.push(c),_.push(E),i.push(u)}return{trans:o,scale:_,quats:i}}}();function $(e,t,n,i){var d=e.anim_slots[n];if(d&&null!=d.type&&(d.play||i)){var T=e.render,A=d.current_frame_float,h=d.start,v=d.length;A+=d.speed*t*E.get_framerate();var m=d.type,R=d.speed;if(R>=0&&A>=h+v||R<0&&A<h)switch(i||(d.exec_finish_callback=!0),d.behavior){case 10:A=R>=0?(A-h)%v+h:h+v-1e-6;break;case 20:A=R>=0?h:h+v-1e-6,d.play=!1;break;case 30:A=R>=0?h+v-1e-6:h,d.play=!1}switch(d.current_frame_float=A,m){case 10:if(!T.anim_mixing){var b=(U=ee(d))[0],y=U[1],L=U[2];T.quats_before=d.quats[b],T.quats_after=d.quats[y],T.trans_before=d.trans[b],T.trans_after=d.trans[y],T.frame_factor=L,function(e,t,r,n){for(var a=e.skinned_renders,o=t.skinning_data,_=0;_<a.length;_++){var i=a[_],s=o[_];i.quats_before=s.quats[r],i.quats_after=s.quats[n],i.trans_before=s.trans[r],i.trans_after=s.trans[n],i.frame_factor=e.frame_factor}}(T,d,b,y),u.update_transform(e)}break;case 20:var Y=function(e,t,r,n){var a=r[0],o=r[1],_=r[2],i=e.trans,s=i[a][1],l=i[a][2],c=i[o][1],E=i[o][2];return n[0]=(1-_)*i[a][0]+_*i[o][0],n[1]=(1-_)*s+_*c,n[2]=(1-_)*l+_*E,n}(d,0,U=ee(d),p),M=function(e,t,r,n){var a=r[0],o=r[1],_=r[2],i=e.scale,s=i[a][1],l=i[a][2],c=i[o][1],E=i[o][2];return n[0]=(1-_)*i[a][0]+_*i[o][0],n[1]=(1-_)*s+_*c,n[2]=(1-_)*l+_*E,n}(d,0,U,P),x=function(e,t,r,n){var a=r[0],o=r[1],_=r[2],i=e.quats,s=O;s[0]=i[a][0],s[1]=i[a][1],s[2]=i[a][2],s[3]=i[a][3];var l=N;return l[0]=i[o][0],l[1]=i[o][1],l[2]=i[o][2],l[3]=i[o][3],Im(s,l,_,n),n}(d,0,U,g);if(e.parent&&e.pinverse_tsr){var C=I;Gm(Y,M,x,C),tg(e.pinverse_tsr,C,C),jm(C,Y),zm(C,M),Vm(C,x)}if(d.trans_smooth_period&&wO(Y,u.get_translation(e,S),t,d.trans_smooth_period,Y),d.quat_smooth_period){var w=O;u.get_rotation(e,w),UO(x,w,t,d.quat_smooth_period,x)}($=d.channels_mask)[0]&&u.set_translation_rel(e,Y),$[1]&&u.set_rotation_rel(e,x),$[2]&&u.set_scale_rel(e,M),u.update_transform(e),_.sync_transform(e);break;case 30:var U=function(e){var t=e.current_frame_float-e.start;t<0&&(t=0),t>=e.length&&(t=e.length);var r=Math.floor(t),n=r+1,a=t-r;10!=e.behavior&&n==e.length&&(n=r-=1,a=1);var o=e.va_frame_offset;return f[0]=r+o,f[1]=n+o,f[2]=a,f}(d);T.va_frame=U[0],T.va_frame_factor=U[2];break;case 40:var k=(U=ee(d))[0],D=U[1],F=U[2];d.volume&&l.set_volume(e,(1-F)*d.volume[k]+F*d.volume[D]),d.pitch&&l.playrate(e,(1-F)*d.pitch[k]+F*d.pitch[D]);break;case 50:if(10==d.behavior)var G=(A-h)/E.get_framerate();else G=A/E.get_framerate();o.set_time(e,d.animation_name,G);break;case 60:k=(U=ee(d))[0],D=U[1],F=U[2];for(var K=d.nodemat_values,B=d.node_value_inds,X=d.nodemat_rgbs,H=d.node_rgb_inds,j=d.node_batches,z=0;z<B.length;z++)for(var Q=K[z],V=B[z],q=(1-F)*Q[k]+F*Q[D],W=0;W<j.length;W++)j[W].node_values[V]=q;for(z=0;z<H.length;z++){var J=X[z],Z=(V=H[z],yh(J.subarray(3*k,3*k+3),J.subarray(3*D,3*D+3),F,p));for(W=0;W<j.length;W++)j[W].node_rgbs[3*V]=Z[0],j[W].node_rgbs[3*V+1]=Z[1],j[W].node_rgbs[3*V+2]=Z[2]}a.is_world(e)&&s.update_sky_texture(e);break;case 70:k=(U=ee(d))[0],D=U[1],F=U[2];var $=d.channels_mask;(ae=d.energy)&&$[0]&&TI(e.light,(1-F)*ae[k]+F*ae[D]);var te=d.color;te&&$[1]&&(p[0]=(1-F)*te[3*k]+F*te[3*D],p[1]=(1-F)*te[3*k+1]+F*te[3*D+1],p[2]=(1-F)*te[3*k+2]+F*te[3*D+2],dI(e.light,p));var re=e.scenes_data;for(z=0;z<re.length;z++)s.update_lamp_scene_color_intensity(e,re[z].scene);break;case 80:k=(U=ee(d))[0],D=U[1],F=U[2],$=d.channels_mask;var ne=s.get_subs((re=e.scenes_data)[0].scene,c.MAIN_OPAQUE),ae=d.energy;if($[0])var oe=(1-F)*ae[k]+F*ae[D];else oe=ne.energy;var _e=d.horizon_color;if($[1]){p[0]=(1-F)*_e[3*k]+F*_e[3*D],p[1]=(1-F)*_e[3*k+1]+F*_e[3*D+1],p[2]=(1-F)*_e[3*k+2]+F*_e[3*D+2];var ie=p}else ie=ne.horizon_color;var se=d.zenith_color;if($[2]){P[0]=(1-F)*se[3*k]+F*se[3*D],P[1]=(1-F)*se[3*k+1]+F*se[3*D+1],P[2]=(1-F)*se[3*k+2]+F*se[3*D+2];var le=P}else le=ne.zenith_color;var ce=d.fog_intensity;if($[3])var Ee=(1-F)*ce[k]+F*ce[D];var ue=d.fog_depth;if($[4])var de=(1-F)*ue[k]+F*ue[D];var Te=d.fog_start;if($[5])var fe=(1-F)*Te[k]+F*Te[D];var pe=d.fog_height;if($[6])var Pe=(1-F)*pe[k]+F*pe[D];var Se=d.fog_color;if($[7]){g[0]=(1-F)*Se[3*k]+F*Se[3*D],g[1]=(1-F)*Se[3*k+1]+F*Se[3*D+1],g[2]=(1-F)*Se[3*k+2]+F*Se[3*D+2];var Ae=g}for(z=0;z<re.length;z++){var he=e.scenes_data[z].scene;($[0]||$[1]||$[2])&&s.set_environment_colors(he,oe,ie,le),$[3]&&s.set_fog_intensity(he,Ee),$[4]&&s.set_fog_depth(he,de),$[5]&&s.set_fog_start(he,fe),$[6]&&s.set_fog_height(he,Pe),$[7]&&s.set_fog_color_density(he,Ae)}break;default:r.panic("Unknown animation type:"+m)}}}function ee(e){var t=e.action_frame_range[0],r=e.action_frame_range[1]-t,n=e.current_frame_float-t;n<0&&(n=0),n>=r&&(n=r),n/=e.action_step;var a=Math.floor(n);if(e.action_bflags[a])var o=n-a;else o=0;var _=Math.ceil(a+o);return f[0]=a,f[1]=_,f[2]=o,f}function te(e,t){var r=e.render,n=r.anim_mix_factor,a=r.blend_skel_slots,o=a[0],_=a[1];if(-1!=_){if(-1!=o){var i=e.anim_slots[o];if(i.play||0==t||r.mix_with_current){var s=ee(i),l=s[0],c=s[1];r.frame_factor=s[2];var E=i.quats[l],d=i.quats[c],T=i.trans[l],f=i.trans[c]}else n=1}else n=1;var p=e.anim_slots[_];if(p.play||0==t||r.mix_with_current){var P=ee(p),S=P[0],A=P[1];r.frame_factor=P[2]}else{if(-1==o||!i.play)return;n=0}var h=p.quats[S],v=p.quats[A],m=p.trans[S],g=p.trans[A];if(1!=n||r.mix_with_current)if(0!=n||r.mix_with_current){var O=r.bone_pointers;if(r.mix_with_current&&!r.trans_curr&&!r.quats_curr)for(var N in r.trans_curr=new Float32Array(r.trans_before.length),r.quats_curr=new Float32Array(r.quats_before.length),O)(R=O[N]).parent_bone_ptr||ne(r,R);for(var N in O){var R;(R=O[N]).parent_bone_ptr||re(r,R,i,p,l,c,S,A)}}else r.quats_before.set(E),r.quats_after.set(d),r.trans_before.set(T),r.trans_after.set(f);else r.quats_before.set(h),r.quats_after.set(v),r.trans_before.set(m),r.trans_after.set(g);u.update_transform(e),lI(e)}}function re(e,t,r,n,a,o,_,i){var s=t.parent_bone_ptr,l=e.anim_mix_factor,c=g,E=O,u=A,d=h,T=N,f=R,p=v,P=m,S=4*t.bone_index,b=n.bone_space_quats[_],y=n.bone_space_trans[_],L=n.bone_space_quats[i],Y=n.bone_space_trans[i];if(!e.mix_with_current)var M=r.bone_space_quats[a],x=r.bone_space_trans[a],C=r.bone_space_quats[o],w=r.bone_space_trans[o];for(var U=0;U<4;U++)E[U]=b[S+U],d[U]=y[S+U],f[U]=L[S+U],P[U]=Y[S+U],e.mix_with_current?(c[U]=e.quats_curr[S+U],u[U]=e.trans_curr[S+U],T[U]=e.quats_curr[S+U],p[U]=e.trans_curr[S+U]):(c[U]=M[S+U],u[U]=x[S+U],T[U]=C[S+U],p[U]=w[S+U]);for(Im(c,E,l,c),sO(u,d,l,u),Xm(u,I),Hm(c,I),s&&tg(s.tsr_local_pose_b,I,I),Dm(I,t.tsr_local_pose_b),tg(I,t.tsr_local_rest_i,I),Qm(I,u),Vm(I,c),Im(T,f,l,T),sO(p,P,l,p),Xm(p,I),Hm(T,I),s&&tg(s.tsr_local_pose_a,I,I),Dm(I,t.tsr_local_pose_a),tg(I,t.tsr_local_rest_i,I),Qm(I,p),Vm(I,T),U=0;U<4;U++)e.quats_before[S+U]=c[U],e.trans_before[S+U]=u[U],e.quats_after[S+U]=T[U],e.trans_after[S+U]=p[U];var k=t.descend_bones_ptrs;for(U=0;U<k.length;U++)re(e,k[U],r,n,a,o,_,i)}function ne(e,t){for(var r=4*t.bone_index,n=t.parent_bone_ptr,a=e.anim_mix_factor,o=A,_=g,i=h,s=O,l=0;l<4;l++)o[l]=e.trans_before[r+l],_[l]=e.quats_before[r+l],i[l]=e.trans_after[r+l],s[l]=e.quats_after[r+l];for(Xm(o,I),Hm(_,I),tg(I,t.tsr_local_rest,I),Dm(I,t.tsr_local_pose_b),n&&(Zm(n.tsr_local_pose_b,b),tg(b,I,I)),Qm(I,o),Vm(I,_),Xm(i,I),Hm(s,I),tg(I,t.tsr_local_rest,I),Dm(I,t.tsr_local_pose_a),n&&(Zm(n.tsr_local_pose_a,b),tg(b,I,I)),Qm(I,i),Vm(I,s),Im(_,s,a,_),sO(o,i,a,o),l=0;l<4;l++)e.quats_curr[r+l]=_[l],e.trans_curr[r+l]=o[l];var c=t.descend_bones_ptrs;for(l=0;l<c.length;l++)ne(e,c[l])}function ae(e,t){var r=e.render,n=r.anim_mix_factor,a=r.anim_mix_factor_change_speed;if(0!=a){!r.mix_with_current||r.trans_curr||r.quats_curr||(n=r.anim_mix_factor=0);var o=r.anim_destination_mix_factor-n,_=a*t;qg(o)==qg(a)&&Math.abs(_)<Math.abs(o)?r.anim_mix_factor+=_:(r.anim_mix_factor=r.anim_destination_mix_factor,r.anim_mix_factor_change_speed=0,r.anim_mix_cb&&(r.anim_mix_cb(),r.anim_mix_cb=null),r.mix_with_current&&(r.trans_curr=null,r.quats_curr=null,r.mix_with_current=!1))}}function oe(e,t){for(var r=[],n=[],a=[],o=[],_=e._render.num_pierced,i=0;i<_;i++){for(var s in t){var l=t[s],c=l.tsr_basis,E=e._render.bones[s];E?dg(E,i,c):Fm(c),l.tsr_channel_cache_valid=!1}var u=_e(t);r.push(u.trans),n.push(u.quats),a.push(u.bone_space_trans),o.push(u.bone_space_quats)}return{trans:r,quats:n,bone_space_trans:a,bone_space_quats:o}}function _e(e){var t=[],r=[],n=[],a=[],o=new Float32Array(4),_=new Float32Array(4),i=new Float32Array(4),s=new Float32Array(4);for(var l in e){var c=e[l];le(c,o,_);var E=c.bone_index;tg(c.tsr_bone_rest,c.tsr_basis,I),Qm(I,i),Vm(I,s);for(var u=0;u<4;u++){var d=4*E+u;t[d]=o[u],r[d]=_[u],n[d]=i[u],a[d]=s[u]}}return{trans:t,quats:r,bone_space_trans:n,bone_space_quats:a}}function ie(e,t){for(var r=[],n=[],a=e.trans,o=e.quats,_=0;_<a.length;_++){var i=se(a[_],o[_],t);r.push(i.trans),n.push(i.quats)}return{trans:r,quats:n}}function se(e,t,r){var n=[],a=[];for(var o in r)for(var _=r[o],i=_.bone_index,s=_.deform_bone_index,l=0;l<4;l++){var c=4*s+l,E=4*i+l;n[c]=e[E],a[c]=t[E]}return{trans:n=new Float32Array(n),quats:a=new Float32Array(a)}}function le(e,t,r){var n=e.chain,a=n[n.length-1],o=a.tsr_channel_cache;a.tsr_channel_cache_valid||Fm(o);for(var _=n.length-1;_>=0;_--){var i=n[_],s=i.tsr_channel_cache;if(i.tsr_channel_cache_valid)o=s;else{var l=i.tsr_local_rest,c=i.tsr_basis;Zm(l,I),tg(c,I,I),tg(l,I,I),tg(o,I,s),o=s,i.tsr_channel_cache_valid=!0}}var E=i.tsr_channel_cache;Qm(E,t),Vm(E,r)}function ce(e,t,r){var n=t[0],a=t[1],o=(r[1]-a)/(r[0]-n);return o*e+(a-o*n)}function Ee(e,t,r,n){var a,o,_,i,s=[],l=[];s[0]=e[0]-t[0],s[1]=e[1]-t[1],l[0]=n[0]-r[0],l[1]=n[1]-r[1],_=n[0]-e[0],(a=Math.abs(s[0]))+(o=Math.abs(l[0]))!=0&&a+o>_&&(t[0]=e[0]-(i=_/(a+o))*s[0],t[1]=e[1]-i*s[1],r[0]=n[0]-i*l[0],r[1]=n[1]-i*l[1])}function ue(e,t,r,n,a){var o=function e(t,r,n,a,o,_,i){var s=t+(r-t)/2,l=de(s,a,o,_,i)-n;return Math.abs(l)<.02?s:l>0?e(t,s,n,a,o,_,i):e(s,r,n,a,o,_,i)}(0,1,e,t[0],r[0],n[0],a[0]);return de(o,t[1],r[1],n[1],a[1])}function de(e,t,r,n,a){var o=1-e;return t*o*o*o+3*r*o*o*e+3*n*o*e*e+a*e*e*e}function Te(e,t){C(e,t),w(e)}function fe(e,t){u.update_transform(e),_.sync_transform(e),B(e,0,t,!0)}function pe(e,t,r,n){if(n=n||0,a.is_mesh(e)){var o=Pe(e,r);if(o)return Te(e,n),M(e,o,n),fe(e,n),!0;var _=Se(e,r);if(_&&"EMITTER"==_.p_type)return Te(e,n),function(e,t,r){for(var n=e.scenes_data,a=0;a<n.length;a++)for(var o=n[a].batches,_=0;_<o.length;_++){var i=o[_].particles_data;i&&i.name==t&&x(0,e.anim_slots[r],i)}}(e,_.name,n),fe(e,n),!0}var s=Wg("name",r,L)||Wg("name",r+"_B4W_BAKED",L);if(s){if(Te(e,n),X(e,t,s,n))return fe(e,n),!0;e.anim_slots[n]=null}return i.error('Unsupported object: "'+e.name+'" or animation name: "'+r+'"'),!1}function Pe(e,t){for(var r=0;r<e.vertex_anim.length;r++){var n=e.vertex_anim[r];if(n.name===t)return n}return null}function Se(e,t){for(var r=e.scenes_data,n=0;n<r.length;n++)for(var a=r[n].batches,o=0;o<a.length;o++){var _=a[o].particles_data;if(_&&_.name===t)return _}return null}function Ae(e){for(var t=e.modifiers,r=0;r<t.length;r++){var n=t[r];if("ARMATURE"==n.type)return n.object}return null}t.calc_pose_data=_e,t.extract_skinned_pose_data=se,t.append_action=function(e){var t=new RegExp(/pose.bones\[\".+\"\]/g),n=wm(),a=function(e,a,o,_,i){if(o.search(t)>-1)var s=a,l=o.split('"')[1],c=n;else s=e,8==i||9==i?(l="tsr",c=n):i>1?(l=o,c=new Float32Array(i)):(l=o,c=0);return s[l]||(s[l]=function(e,t){if("object"==typeof t&&t.length)for(var n=t.length,a=new Float32Array(e*n),o=0;o<e;o++)for(var _=0;_<n;_++)a[o*n+_]=t[_];else if("number"==typeof t)for(a=new Float32Array(e),o=0;o<e;o++)a[o]=t;else r.panic("Wrong storage default value");return a}(_,c)),s[l]},o=function(e,t){if(e.indexOf("location")>-1)var r=0,n=t;else e.indexOf("rotation_quaternion")>-1?(r=6,n=0==t?NaN:t-1):e.indexOf("scale")>-1?(r=3,n=t):(r=0,n=t);return r+n},_=e._render={type:0,num_pierced:0,pierce_step:0,params:null,bones:null,bflags:null,channels_mask:new Int8Array(8)};_.pierce_step=1/d.frame_steps;var i=e.fcurves,s={},l={},c=0;for(var E in i){var u,T,f,p=i[E];for(var P in Object.keys(p),p){var S=(u=p[P])._pierced_points;c||(c=S.length);var A=(f=a(s,l,E,c,T=u.num_channels)).length/c,h=o(E,0|P);if(h==h)if(E.indexOf("scale")>-1&&8===T)for(var v=0;v<c;v++)f[v*A+h]=S[v],f[v*A+h+1]=S[v],f[v*A+h+2]=S[v];else for(v=0;v<c;v++)f[v*A+h]=S[v]}if(E.indexOf("rotation_quaternion")>-1&&0 in p)for(S=(u=p[0])._pierced_points,A=(f=a(s,l,E,c,T=u.num_channels)).length/c,v=0;v<c;v++)S[v]<0&&(f[v*A+6]=-f[v*A+6],f[v*A+7]=-f[v*A+7],f[v*A+8]=-f[v*A+8])}jO(s)&&(_.params=s),jO(l)&&(_.bones=l),_.num_pierced=c,_.bflags=e._bflags,"tsr"in s&&function(e,t){for(var r in t[0]=t[1]=t[2]=0,e)"location"==r?t[0]=1:"rotation_quaternion"==r?t[1]=1:"scale"==r&&(t[2]=1)}(i,_.channels_mask),("color"in s||"energy"in s)&&function(e,t){for(var r in t[0]=t[1]=0,e)"energy"==r?t[0]=1:"color"==r&&(t[1]=1)}(i,_.channels_mask),("light_settings.environment_energy"in s||"horizon_color"in s||"zenith_color"in s||"mist_settings.intensity"in s||"mist_settings.depth"in s||"mist_settings.start"in s||"mist_settings.height"in s||"b4w_fog_color"in s)&&function(e,t){for(var r in t[0]=t[1]=t[2]=0,t[3]=t[4]=t[5]=0,t[6]=t[7]=0,e)"light_settings.environment_energy"==r?t[0]=1:"horizon_color"==r?t[1]=1:"zenith_color"==r?t[2]=1:"mist_settings.intensity"==r?t[3]=1:"mist_settings.depth"==r?t[4]=1:"mist_settings.start"==r?t[5]=1:"mist_settings.height"==r?t[6]=1:"b4w_fog_color"==r&&(t[7]=1)}(i,_.channels_mask),function(e){var t=e._render;t.type=t.bones?10:t.params?"volume"in t.params||"pitch"in t.params?40:function(e){var t=e._render.params;if(t)for(var r in t)if(-1!=r.indexOf("nodes"))return!0;return!1}(e)?60:function(e){if(e._render.params){var t=e.fcurves;for(var r in t)if("color"==r&&!t[r][3])return!0;if("energy"==r)return!0}return!1}(e)?70:function(e){var t=e._render.params;return"light_settings.environment_energy"in t||"horizon_color"in t||"zenith_color"in t||"mist_settings.intensity"in t||"mist_settings.depth"in t||"mist_settings.start"in t||"mist_settings.height"in t||"b4w_fog_color"in t}(e)?80:function(e){if(e._render.params){var t=e.fcurves;for(var r in t)if("location"==r||"rotation_quaternion"==r||"scale"==r)return!0}return!1}(e)?20:0:0}(e),L.push(e)},t.get_approx_curve_length=function(e,t){return(t-e)*d.frame_steps+1},t.approximate_curve=function(e,t,n,a,o,_){for(var i=new Float32Array(2),s=new Float32Array(2),l=new Float32Array(2),c=new Float32Array(2),E=t[1],u=t[2],T=t[e.last_frame_offset+1],f=t[e.last_frame_offset+2],p=0,P=0,S=null,A=o;A<=_;A++)if(A<E)for(var h=0;h<d.frame_steps;h++)n[p++]=u;else if(A>T)for(h=0;h<d.frame_steps;h++)n[p++]=f;else{var v=t[P],m=3;0===v&&(m+=2),0===S&&(m+=2);var g=2===v?0:1;if(t[P+1]==t[P+m+1]){S=v,P+=m;continue}var O=0;if(A==t[P+1]&&(g&&(a[p]=1),n[p]=t[P+2],p++,O++),A==T)for(h=O;h<d.frame_steps;h++)n[p++]=f;else for(i[0]=t[P+1],i[1]=t[P+2],0!==v?(s[0]=0,s[1]=0):0===S?(s[0]=t[P+5],s[1]=t[P+6]):(s[0]=t[P+3],s[1]=t[P+4]),0!==v?(l[0]=0,l[1]=0):(l[0]=t[P+m+3],l[1]=t[P+m+4]),c[0]=t[P+m+1],c[1]=t[P+m+2],h=O;h<d.frame_steps;h++){var N=A+h/d.frame_steps;switch(v){case 0:Ee(i,s,l,c),g&&(a[p]=1),n[p]=ue(N,i,s,l,c),p++;break;case 1:g&&(a[p]=1),n[p]=ce(N,i,c),p++;break;case 2:g&&(a[p]=1),n[p]=t[P+2],p++;break;default:r.panic("Unknown keyframe interpolation mode: "+v)}}A+1==t[P+m+1]&&(S=v,P+=m)}},t.apply=pe,t.apply_by_uuid=function(e,t,r,n){n=n||0;var a=Wg("uuid",r,L);if(a){if(Te(e,n),X(e,t,a,n))return fe(e,n),!0;e.anim_slots[n]=null}return i.error('Unsupported object: "'+e.name+'" or animation uuid: "'+r+'"'),!1},t.validate_action_by_name=function(e,t){var r=Wg("name",t,L)||Wg("name",t+"_B4W_BAKED",L);if(r){if(0==r._render.type)return!1}else if(!(Se(e,t)||a.is_mesh(e)&&Pe(e,t)))return!1;return!0},t.get_slot_num_by_anim=function(e,t){for(var r=e.anim_slots,n=0;n<r.length;n++){var a=r[n];if(a&&U(a.animation_name)==U(t))return n}return-1},t.get_anim_by_slot_num=function(e,t){var r=e.anim_slots[t];return r&&r.animation_name?U(r.animation_name):null},t.remove=function(e){e.anim_slots.length=0;var t=y.indexOf(e);-1!=t&&y.splice(t,1)},t.remove_actions=function(e){for(var t=L.length-1;t>=0;t--)L[t]._data_id==e&&L.splice(t,1)},t.apply_to_first_empty_slot=function(e,t){if(!e.anim_slots.length)return pe(e,null,t,0)?0:-1;for(var r=0;r<e.anim_slots.length;r++)if(!e.anim_slots[r])return pe(e,null,t,r)?r:-1},t.set_skel_mix_factor=function(e,t,r,n){var a=e.render;a.anim_mix_factor_change_speed=(t-a.anim_mix_factor)/r,a.anim_destination_mix_factor=t,a.anim_mix_cb&&a.anim_mix_cb(),a.anim_mix_cb=n},t.mix_from_cur_pos=function(e,t,r,n){var a=e.render;a.blend_skel_slots[1]=t,a.anim_mix_factor_change_speed=1/r,a.anim_destination_mix_factor=1,a.anim_mix_cb&&a.anim_mix_cb(),a.anim_mix_cb=n,a.trans_curr=null,a.quats_curr=null,a.mix_with_current=!0},t.set_speed=function(e,t,r){K(e.anim_slots,r,(function(e){e.speed=t}))},t.get_speed=function(e,t){return e.anim_slots[t].speed},t.get_anim_start_frame=function(e,t){return e.anim_slots[t].start},t.get_anim_length=function(e,t){return e.anim_slots[t].length},t.cleanup=function(){y.length=0,L.length=0},t.fcurve_replace_euler_by_quat=function(e){var t=(e[0]||e[1]||e[2])._pierced_points.length,r=g,n=p,a=Boolean(e[0]);a||(e[0]={_pierced_points:new Float32Array(t),num_channels:8});var o=Boolean(e[1]);o||(e[1]={_pierced_points:new Float32Array(t),num_channels:8});var _=Boolean(e[2]);_||(e[2]={_pierced_points:new Float32Array(t),num_channels:8}),e[3]={_pierced_points:new Float32Array(t),num_channels:8};for(var i=0;i<t;i++)n[0]=a?e[0]._pierced_points[i]:0,n[1]=o?e[1]._pierced_points[i]:0,n[2]=_?e[2]._pierced_points[i]:0,tO(n,r),e[0]._pierced_points[i]=r[3],e[1]._pierced_points[i]=r[0],e[2]._pierced_points[i]=r[1],e[3]._pierced_points[i]=r[2]},t.get_bpy_armobj=Ae,t.slot_by_anim_type=function(e,t){for(var r=7,n=0,a=0;a<L.length;a++){var o=L[a];if(o.name==t){n=o._render.type;break}}if(0==n)if(Pe(e,t))n=30;else{var _=Se(e,t);_&&"EMITTER"==_.p_type&&(n=50)}for(a=0;a<8;a++){var i=e.anim_slots[a];if(i){if(i.type==n)return a}else a<r&&(r=a)}return r}}));function UI(){return{name:"",type:"",uuid:"",use_nodes:!1,node_tree:null,texture_slots:[],blend_mode:"",use_shadeless:!1,use_transparency:!1,use_backface_culling:!1,use_tangent_shading:!1,use_orco_tex_coord:!1,use_vertex_color_paint:!1,use_double_sided_lighting:!1,do_not_render:!1,render_above_all:!1,is_lens_flares:!1,is_wettable:!1,is_refractive:!1,refr_bump:0,pass_index:0,offset_z:0,diffuse_shader:"",diffuse_color:new Float32Array(3),diffuse_intensity:0,diffuse_toon_size:0,diffuse_toon_smooth:0,roughness:0,diffuse_fresnel:0,diffuse_fresnel_factor:0,darkness:0,alpha:0,specular_shader:"",specular_color:new Float32Array(3),specular_intensity:0,specular_toon_size:0,specular_toon_smooth:0,specular_hardness:0,specular_ior:0,specular_slope:0,specular_alpha:0,emit:0,ambient:0,water_settings:{is_water:!1,shore_smoothing:!1,absorb_factor:0,foam_factor:0,shallow_col:new Float32Array(3),shore_col:new Float32Array(3),shallow_col_fac:0,shore_col_fac:0,fog_color:new Float32Array(3),fog_density:0,sss_strength:0,sss_width:0,norm_uv_velocity:0,is_dynamic:!1,waves_height:0,waves_length:0,dst_noise_scale0:0,dst_noise_scale1:0,dst_noise_freq0:0,dst_noise_freq1:0,dir_min_shore_fac:0,dir_freq:0,dir_noise_scale:0,dir_noise_freq:0,dir_min_noise_fac:0,dst_min_fac:0,waves_hor_fac:0,is_generated_mesh:!1,num_cascads:0,num_subdivs:0,detailed_dist:0,enable_caust:!1,caust_scale:0,caust_brightness:0},terrain_settings:{is_terrain:!1,dynamic_grass_size:"",dynamic_grass_color:""},raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:0},halo_settings:{size:0,hardness:0,rings_color:new Float32Array(3),lines_color:new Float32Array(3),ring_count:0,line_count:0,star_tip_count:0,is_sky_stars:!1,stars_blend_height:0,stars_min_height:0},physics_settings:{use_coll_physics:!1,use_ghost:!1,friction:0,elasticity:0,collision_id:"",collision_margin:0,collision_group:0,collision_mask:0}}}function kI(){var e=UI();return e.name="DEFAULT",e.type="SURFACE",e.uuid=HO(),e.use_nodes=!1,e.node_tree=null,e.texture_slots=[],e.blend_mode="OPAQUE",e.use_shadeless=!1,e.use_transparency=!1,e.use_backface_culling=!0,e.use_vertex_color_paint=!1,e.use_double_sided_lighting=!1,e.render_above_all=!1,e.is_refractive=!1,e.refr_bump=0,e.pass_index=0,e.offset_z=0,e.diffuse_shader="LAMBERT",e.diffuse_color.set([.8,.8,.8]),e.diffuse_intensity=.8,e.alpha=1,e.specular_shader="COOKTORR",e.specular_color.set([1,1,1]),e.specular_intensity=.5,e.specular_hardness=50,e.specular_alpha=1,e.emit=0,e.ambient=1,e.water_settings.is_water=!1,e.terrain_settings.is_terrain=!1,e.raytrace_mirror.reflect_factor=0,e.raytrace_mirror.fresnel=0,e.raytrace_mirror.fresnel_factor=1.25,e.physics_settings.use_coll_physics=!1,e}function DI(e,t){t.name=e.name,t.type=e.type,t.uuid=e.uuid,t.use_nodes=e.use_nodes,t.node_tree=e.node_tree,t.texture_slots=e.texture_slots,t.blend_mode=e.game_settings.alpha_blend,t.use_shadeless=e.use_shadeless,t.use_transparency=e.use_transparency,t.use_backface_culling=e.game_settings.use_backface_culling,t.use_tangent_shading=e.use_tangent_shading,t.use_orco_tex_coord=e.use_orco_tex_coord,t.use_vertex_color_paint=e.use_vertex_color_paint,t.use_double_sided_lighting=e.b4w_double_sided_lighting,t.do_not_render=e.b4w_do_not_render,t.render_above_all=e.b4w_render_above_all,t.is_lens_flares=e.b4w_lens_flares,t.is_wettable=e.b4w_wettable,t.is_refractive=e.b4w_refractive,t.refr_bump=e.b4w_refr_bump,t.pass_index=e.pass_index,t.offset_z=e.offset_z,t.diffuse_shader=e.diffuse_shader,t.diffuse_color.set(e.diffuse_color),t.diffuse_intensity=e.diffuse_intensity,t.diffuse_toon_size=e.diffuse_toon_size,t.diffuse_toon_smooth=e.diffuse_toon_smooth,t.roughness=e.roughness,t.diffuse_fresnel=e.diffuse_fresnel,t.diffuse_fresnel_factor=e.diffuse_fresnel_factor,t.darkness=e.darkness,t.alpha=e.alpha,t.specular_shader=e.specular_shader,t.specular_color.set(e.specular_color),t.specular_intensity=e.specular_intensity,t.specular_toon_size=e.specular_toon_size,t.specular_toon_smooth=e.specular_toon_smooth,t.specular_hardness=e.specular_hardness,t.specular_ior=e.specular_ior,t.specular_slope=e.specular_slope,t.specular_alpha=e.specular_alpha,t.emit=e.emit,t.ambient=e.ambient;var r=t.water_settings;r.is_water=e.b4w_water,r.shore_smoothing=e.b4w_water_shore_smoothing,r.absorb_factor=e.b4w_water_absorb_factor,r.foam_factor=e.b4w_foam_factor,r.shallow_col.set(e.b4w_shallow_water_col),r.shore_col.set(e.b4w_shore_water_col),r.shallow_col_fac=e.b4w_shallow_water_col_fac,r.shore_col_fac=e.b4w_shore_water_col_fac,r.fog_color.set(e.b4w_water_fog_color),r.fog_density=e.b4w_water_fog_density,r.sss_strength=e.b4w_water_sss_strength,r.sss_width=e.b4w_water_sss_width,r.norm_uv_velocity=e.b4w_water_norm_uv_velocity,r.is_dynamic=e.b4w_water_dynamic,r.waves_height=e.b4w_waves_height,r.waves_length=e.b4w_waves_length,r.dst_noise_scale0=e.b4w_water_dst_noise_scale0,r.dst_noise_scale1=e.b4w_water_dst_noise_scale1,r.dst_noise_freq0=e.b4w_water_dst_noise_freq0,r.dst_noise_freq1=e.b4w_water_dst_noise_freq1,r.dir_min_shore_fac=e.b4w_water_dir_min_shore_fac,r.dir_freq=e.b4w_water_dir_freq,r.dir_noise_scale=e.b4w_water_dir_noise_scale,r.dir_noise_freq=e.b4w_water_dir_noise_freq,r.dir_min_noise_fac=e.b4w_water_dir_min_noise_fac,r.dst_min_fac=e.b4w_water_dst_min_fac,r.waves_hor_fac=e.b4w_water_waves_hor_fac,r.is_generated_mesh=e.b4w_generated_mesh,r.num_cascads=e.b4w_water_num_cascads,r.num_subdivs=e.b4w_water_subdivs,r.detailed_dist=e.b4w_water_detailed_dist,r.enable_caust=e.b4w_water_enable_caust,r.caust_scale=e.b4w_water_caust_scale,r.caust_brightness=e.b4w_water_caust_brightness;var n=t.terrain_settings;n.is_terrain=e.b4w_terrain,n.dynamic_grass_size=e.b4w_dynamic_grass_size,n.dynamic_grass_color=e.b4w_dynamic_grass_color;var a=t.raytrace_mirror;a.reflect_factor=e.raytrace_mirror.reflect_factor,a.fresnel=e.raytrace_mirror.fresnel,a.fresnel_factor=e.raytrace_mirror.fresnel_factor;var o=t.halo_settings;o.size=e.halo.size,o.hardness=e.halo.hardness,o.rings_color.set(e.halo.b4w_halo_rings_color),o.lines_color.set(e.halo.b4w_halo_lines_color),o.ring_count=e.halo.ring_count,o.line_count=e.halo.line_count,o.star_tip_count=e.halo.star_tip_count,o.is_sky_stars=e.b4w_halo_sky_stars,o.stars_blend_height=e.b4w_halo_stars_blend_height,o.stars_min_height=e.b4w_halo_stars_min_height;var _=t.physics_settings;_.use_coll_physics=e.b4w_collision,_.use_ghost=e.b4w_use_ghost,_.friction=e.physics.friction,_.elasticity=e.physics.elasticity,_.collision_id=e.b4w_collision_id,_.collision_margin=e.b4w_collision_margin,_.collision_group=e.b4w_collision_group,_.collision_mask=e.b4w_collision_mask}function FI(e){var t=e;t.name=e.name,t.type=e.type,t.uuid=e.uuid,t.use_nodes=e.use_nodes,t.node_tree=e.node_tree,t.texture_slots=e.texture_slots.slice(),t.blend_mode=e.blend_mode,t.use_shadeless=e.use_shadeless,t.use_transparency=e.use_transparency,t.use_backface_culling=e.use_backface_culling,t.use_tangent_shading=e.use_tangent_shading,t.use_orco_tex_coord=e.use_orco_tex_coord,t.use_vertex_color_paint=e.use_vertex_color_paint,t.use_double_sided_lighting=e.use_double_sided_lighting,t.do_not_render=e.do_not_render,t.render_above_all=e.render_above_all,t.is_lens_flares=e.is_lens_flares,t.is_wettable=e.is_wettable,t.is_refractive=e.is_refractive,t.refr_bump=e.refr_bump,t.pass_index=e.pass_index,t.offset_z=e.offset_z,t.diffuse_shader=e.diffuse_shader,t.diffuse_color.set(e.diffuse_color),t.diffuse_intensity=e.diffuse_intensity,t.diffuse_toon_size=e.diffuse_toon_size,t.diffuse_toon_smooth=e.diffuse_toon_smooth,t.roughness=e.roughness,t.diffuse_fresnel=e.diffuse_fresnel,t.diffuse_fresnel_factor=e.diffuse_fresnel_factor,t.darkness=e.darkness,t.alpha=e.alpha,t.specular_shader=e.specular_shader,t.specular_color.set(e.specular_color),t.specular_intensity=e.specular_intensity,t.specular_toon_size=e.specular_toon_size,t.specular_toon_smooth=e.specular_toon_smooth,t.specular_hardness=e.specular_hardness,t.specular_ior=e.specular_ior,t.specular_slope=e.specular_slope,t.specular_alpha=e.specular_alpha,t.emit=e.emit,t.ambient=e.ambient;var r=e.water_settings,n=t.water_settings;n.is_water=r.is_water,n.shore_smoothing=r.shore_smoothing,n.absorb_factor=r.absorb_factor,n.foam_factor=r.foam_factor,n.shallow_col.set(r.shallow_col),n.shore_col.set(r.shore_col),n.shallow_col_fac=r.shallow_col_fac,n.shore_col_fac=r.shore_col_fac,n.fog_color=r.fog_color,n.fog_density=r.fog_density,n.sss_strength=r.sss_strength,n.sss_width=r.sss_width,n.norm_uv_velocity=r.norm_uv_velocity,n.is_dynamic=r.is_dynamic,n.waves_height=r.waves_height,n.waves_length=r.waves_length,n.dst_noise_scale0=r.dst_noise_scale0,n.dst_noise_scale1=r.dst_noise_scale1,n.dst_noise_freq0=r.dst_noise_freq0,n.dst_noise_freq1=r.dst_noise_freq1,n.dir_min_shore_fac=r.dir_min_shore_fac,n.dir_freq=r.dir_freq,n.dir_noise_scale=r.dir_noise_scale,n.dir_noise_freq=r.dir_noise_freq,n.dir_min_noise_fac=r.dir_min_noise_fac,n.dst_min_fac=r.dst_min_fac,n.waves_hor_fac=r.waves_hor_fac,n.is_generated_mesh=r.is_generated_mesh,n.num_cascads=r.num_cascads,n.num_subdivs=r.num_subdivs,n.detailed_dist=r.detailed_dist,n.enable_caust=r.enable_caust,n.caust_scale=r.caust_scale,n.caust_brightness=r.caust_brightness;var a=e.terrain_settings,o=t.terrain_settings;o.is_terrain=a.is_terrain,o.dynamic_grass_size=a.dynamic_grass_size,o.dynamic_grass_color=a.dynamic_grass_color;var _=e.raytrace_mirror,i=t.raytrace_mirror;i.reflect_factor=_.reflect_factor,i.fresnel=_.fresnel,i.fresnel_factor=_.fresnel_factor;var s=e.halo_settings,l=t.halo_settings;l.size=s.size,l.hardness=s.hardness,l.rings_color.set(s.rings_color),l.lines_color.set(s.lines_color),l.ring_count=s.ring_count,l.line_count=s.line_count,l.star_tip_count=s.star_tip_count,l.is_sky_stars=s.is_sky_stars,l.stars_blend_height=s.stars_blend_height,l.stars_min_height=s.stars_min_height;var c=e.physics_settings,E=t.physics_settings;return E.use_coll_physics=c.use_coll_physics,E.use_ghost=c.use_ghost,E.friction=c.friction,E.elasticity=c.elasticity,E.collision_id=c.collision_id,E.collision_margin=c.collision_margin,E.collision_group=c.collision_group,E.collision_mask=c.collision_mask,t}var GI=nA("__nla",(function(e,t){var r=wI(e),n=KI(e),a=PI(e),o=mN(e),_=LI(e),i=yI(e),s=XI(e),l=AR(e),c=[],E=-1;function u(e,t,r){for(var n=0;n<e.length;n++){var a=e[n];t.frame_start>a.frame_end||t.frame_end<a.frame_start?(o.warn("NLA: Strip is out of scene range: "+r+" ["+a.frame_start+":"+a.frame_end+"]"),e.splice(n,1),n--):a.anim_name||"CLIP"!=a.type||(o.warn('NLA: no action in strip for object "'+r+'".'),e.splice(n,1),n--)}}function d(e,t){for(var r=0;r<e.length;r++){for(var n=e[r],a=t.frame_start,o=t.frame_end+1,_=0;_<e.length;_++){var i=e[_];n.anim_slot==i.anim_slot&&(i.frame_end<=n.frame_start&&(a=n.frame_start),i.frame_start>=n.frame_end&&(o=Math.min(o,i.frame_start)))}n.ext_frame_start=a,n.ext_frame_end=o,T(n)}}function T(e){e.action_frame_final=e.repeat%1==0?e.action_frame_end:e.action_frame_start+e.repeat%1*(e.action_frame_end-e.action_frame_start)}function f(e,t){for(var n=r.get_all_actions(),a=[],o=0,_=0;_<e.length;_++){var i=e[_];if(""!=i.anim_uuid)var s=Wg("uuid",i.anim_uuid,n);else{var l=i.anim_name;s=Wg("name",l,n)||Wg("name",l+"_B4W_BAKED",n)}if(s){var c=s.fcurves,E=[];for(var u in c)E.push(u);a.push(E)}}for(_=0;_<a.length;_++){for(var d=!1,T=0;T<_;T++)if(oN(a[_],a[T])){e[_].anim_slot=e[T].anim_slot,d=!0;break}d||(e[_].anim_slot=t+o++)}return o}function p(e,t,r){if(e.animation_data){var n=e.animation_data.nla_tracks;if(n)for(var a=0;a<n.length;a++)n[a].name_list=r,t.push(n[a])}var o=e.nodes;for(a=0;a<o.length;a++){var _=o[a];if(_.node_group){var i=_.node_group.node_tree;if(i){var s=r.slice();s.push(_.name),p(i,t,s)}}}}function P(e,t){e.is_stopped=!0,e.frame_offset-=t-e.range_end,e.user_callback&&e.user_callback()}function S(e,t){return e.user_callback&&e.user_callback(),Y(e.range_start,t),e.rewinded_to_start=!0,g(e,t)}function A(e,t,r){for(var n=0;n<e.objects.length;n++){var a=e.objects[n];if(a)for(var o=0;o<a.length;o++){for(var _=a[o],i=_.nla_events,s=0;s<i.length;s++)"SOUND"==(l=i[s]).type&&t<e.last_frame-1e-6&&(l.scheduled=!1);for(s=0;s<i.length;s++){var l;switch((l=i[s]).type){case"CLIP":if(l.ext_frame_start<=t&&t<l.ext_frame_end&&!l.scheduled){for(O(_,l),n=0;n<i.length;n++)i[n]!=l&&i[n].anim_slot==l.anim_slot&&(i[n].scheduled=!1);l.scheduled=!0}l.scheduled&&N(_,l,t);break;case"SOUND":(t<e.last_frame-1e-6||e.last_frame<l.frame_start)&&l.frame_start<=t&&t<l.frame_end&&(l.scheduled||(I(_,l,t),l.scheduled=!0)),e.last_frame<l.frame_end&&l.frame_end<=t&&l.scheduled&&(l.scheduled=!1)}}}}}function h(e,t,r){for(var n=0;n<t.textures.length;n++){var a=t.textures[n];if(a.video_file||a.seq_video){var o=s.video_get_current_frame(a),_=m(r,a),i=s.video_get_start_frame(a),l=!1,c=!1;if((t.force_update||t.rewinded_to_start)&&(c=!0),!t.is_stopped){var E=(f=v(r,T=a),T.frame_offset<=f&&f<=T.frame_offset+s.video_get_duration(T)),u=s.video_is_played(a);a.use_cyclic&&_==i&&(c=!0),u||o==_||(c=!0),E&&!u?s.play_video(a):E&&u?l=!0:!E&&u&&(a.video_file&&o<_?l=!0:s.pause_video(a))}if(c)s.set_frame_video(a.video_tex_name,_,a.vtex_data_id),a.seq_video&&(a.seq_last_discrete_mark=s.seq_video_get_discrete_timemark(a,e));else if(l&&s.video_update_is_available(a))if(a.video_file)s.update_video_texture(a);else{var d=s.seq_video_get_discrete_timemark(a,e);d!=a.seq_last_discrete_mark&&(a.seq_cur_frame=_,s.update_seq_video_texture(a)),a.seq_last_discrete_mark=d}}}var T,f}function v(e,t){var r=Math.round(e)-t.frame_start;return t.use_cyclic&&(r%=t.frame_duration)<0&&(r+=t.frame_duration),t.frame_offset+r}function m(e,t){var r=xO(v(e,t),t.frame_offset,t.frame_offset+s.video_get_duration(t)-1);return t.seq_video&&(r=s.video_frame_to_seq_frame(t,r))==t.seq_movie_length&&r--,r}function g(e,t){var r=(t-E)*l.get_framerate()+e.frame_offset;return r>e.frame_start?(r-=e.frame_start,e.cyclic&&(r%=e.frame_end-e.frame_start+1),r+=e.frame_start):r=e.frame_start,r}function O(e,t,n,a){var o=t.name_list;""!=t.anim_uuid?r.apply_by_uuid(e,o,t.anim_uuid,t.anim_slot):r.apply(e,o,t.anim_name,t.anim_slot),r.set_behavior(e,r.AB_FINISH_STOP,t.anim_slot);var _=R(t.frame_start,t);r.set_frame(e,_,t.anim_slot)}function N(e,t,n,a){var o=R(n,t),_=r.get_current_frame_float(e,t.anim_slot);Math.abs(o-_)>1e-6&&r.set_frame(e,o,t.anim_slot)}function R(e,t){if((e=xO(e,t.frame_start,t.frame_end))==t.frame_end)var r=t.action_frame_final;else r=t.action_frame_start+(e-t.frame_start)/t.scale%(t.action_frame_end-t.action_frame_start);return t.use_reverse&&(r=t.action_frame_end-r+t.action_frame_start),r}function I(e,t,r){var n=(t.frame_start-r)/l.get_framerate(),a=(t.frame_end-t.frame_start)/l.get_framerate();i.play(e,n,a)}function b(e,t){for(var r=[],n=0;n<e.length;n++){var a=e[n],o=a.strips;if(o)for(var _=0;_<o.length;_++){var i=o[_],s={type:"CLIP",frame_start:0,frame_end:0,scheduled:!1,paused:!1,anim_name:"",anim_uuid:"",anim_slot:0,name_list:null,action_frame_start:0,action_frame_end:0,ext_frame_start:0,ext_frame_end:0,use_reverse:!1,scale:1,repeat:1,action_frame_final:0};s.type=i.type,s.frame_start=i.frame_start,s.frame_end=i.frame_end,s.anim_slot=t,s.action_frame_start=i.action_frame_start,s.action_frame_end=i.action_frame_end,s.use_reverse=i.use_reverse,s.scale=i.scale,s.repeat=i.repeat,i.action&&(s.anim_name=i.action.name,s.anim_uuid=i.action.uuid,s.name_list=a.name_list),r.push(s)}}return r}function y(e){return!("SPEAKER"!=e.type&&"LAMP"!=e.type||!e.data.animation_data||!e.data.animation_data.nla_tracks.length)}function L(e,t){if(e.animation_data){var r=e.animation_data.nla_tracks;if(r&&r.length)return!0}for(var n=e.nodes,a=0;a<n.length;a++){var o=n[a];if(o.node_group){var _=o.node_group.node_tree;_&&L(_,t)}}return!1}function Y(e,t){var r=_.get_active();if(r._nla){var n=g(r._nla,t);r._nla.frame_offset-=n-e,r._nla.force_update=!0}}t.update_object=function(e,t){var r=function(e){for(var t=null,r=e.scenes_data.length-1;r>=0;r--){var n=e.scenes_data[r];if(n.scene.b4w_use_nla&&(t=n,n.scene._is_main))break}return t}(t);if(r){r.obj_has_nla_on_scene=!0;var n=0,o=e.animation_data;if(o&&o.nla_tracks.length){var _=o.nla_tracks;(a.is_armature(t)||a.is_camera(t)||a.is_mesh(t)||a.is_empty(t)||a.is_line(t)||a.is_lamp(t)||a.is_speaker(t)||a.is_world(t))&&(c=b(_,n)).length&&(t.nla_events=t.nla_events.concat(c),n++)}if(y(e)&&(c=b(_=e.data.animation_data.nla_tracks,n)).length&&(t.nla_events=t.nla_events.concat(c),n++),a.is_mesh(t))for(var i=t.materials,s=0;s<i.length;s++){var l=i[s];l.use_nodes&&l.node_tree&&(p(l.node_tree,_=[],[l.name]),(c=b(_,n)).length&&(n+=f(c,n),t.nla_events=t.nla_events.concat(c)))}if(a.is_world(t)){var c;e.use_nodes&&e.node_tree&&(p(e.node_tree,_=[],[e.name]),(c=b(_,n)).length&&(n+=f(c,n),t.nla_events=t.nla_events.concat(c)))}else{for(s=0;s<e.particle_systems.length;s++){var E=e.particle_systems[s],u=E.settings;"EMITTER"==u.type&&u.b4w_allow_nla&&((T={type:"CLIP",frame_start:0,frame_end:0,scheduled:!1,paused:!1,anim_name:"",anim_uuid:"",anim_slot:0,name_list:null,action_frame_start:0,action_frame_end:0,ext_frame_start:0,ext_frame_end:0,use_reverse:!1,scale:1,repeat:1,action_frame_final:0}).type="CLIP",T.frame_start=r.scene.frame_start,T.frame_end=r.scene.frame_end+1,T.anim_name=E.name,T.anim_slot=n,T.action_frame_start=T.frame_start,T.action_frame_end=T.frame_end,t.nla_events.push(T),n++)}var d=n+1;for(s=0;s<t.vertex_anim.length;s++){var T,P=t.vertex_anim[s];P.allow_nla&&(n=d,(T={type:"CLIP",frame_start:0,frame_end:0,scheduled:!1,paused:!1,anim_name:"",anim_uuid:"",anim_slot:0,name_list:null,action_frame_start:0,action_frame_end:0,ext_frame_start:0,ext_frame_end:0,use_reverse:!1,scale:1,repeat:1,action_frame_final:0}).type="CLIP",T.frame_start=P.frame_start,T.frame_end=P.frame_end,T.anim_name=P.name,T.anim_slot=n,T.action_frame_start=T.frame_start,T.action_frame_end=T.frame_end,t.nla_events.push(T))}}}},t.update_scene=function(e,t,r){e._nla||(e._nla={frame_start:e.frame_start,frame_end:e.frame_end,frame_offset:0,last_frame:-1,range_end:e.frame_end,range_start:e.frame_start,user_callback:null,cyclic:t,objects:[],textures:[],scene_name:e.name,is_stopped:!1,force_update:!1,rewinded_to_start:!0},c.push(e._nla));for(var a=e._nla,o=n.get_scene_objs_derived(e,"ALL",r),_=0;_<o.length;_++){var i=o[_];if(i.nla_events.length){a.objects[r]||(a.objects[r]=[]);for(var s=0;s<i.scenes_data.length;s++){var l=i.scenes_data[s];l.scene==e&&l.obj_has_nla_on_scene&&a.objects[r].push(i)}u(i.nla_events,a,i.name),d(i.nla_events,a)}}var E=e._render.video_textures;for(_=0;_<E.length;_++){var T=E[_]._render;if(T.use_nla&&(T.video_file||T.seq_video)&&T.vtex_data_id==r){var f={type:"CLIP",frame_start:0,frame_end:0,scheduled:!1,paused:!1,anim_name:"",anim_uuid:"",anim_slot:0,name_list:null,action_frame_start:0,action_frame_end:0,ext_frame_start:0,ext_frame_end:0,use_reverse:!1,scale:1,repeat:1,action_frame_final:0};f.type="VIDEO",T.use_cyclic?(f.frame_start=0,f.frame_end=a.frame_end):(f.frame_start=xO(T.frame_start,0,a.frame_end),f.frame_end=xO(T.frame_start+T.frame_duration,0,a.frame_end)),f.anim_name=E[_].name,a.textures.push(T)}}},t.prepare=function(){for(var e=0;e<c.length;e++)for(var t=c[e],n=0;n<t.objects.length;n++){var a=t.objects[n];if(a)for(e=0;e<a.length;e++)for(var o=a[e],_=o.nla_events,i=0;i<_.length;i++){var s=_[i];r.init_action_cache(o,s.name_list,s.uuid,s.anim_name,s.anim_slot)}}},t.start=function(){E=0},t.get_start_time=function(){return E},t.get_frame_offset=function(e){return e._nla?e._nla.frame_offset:null},t.set_frame_offset=function(e,t){return!!e._nla&&(e._nla.frame_offset=t,!0)},t.update=function(e,t){if(!(E<0)){0==E&&(E=e);for(var r=0;r<c.length;r++){var n=c[r];n.is_stopped&&(n.frame_offset-=l.get_framerate()*t);var a=g(n,e);(!n.is_stopped||n.force_update)&&a>=n.range_end&&(n.cyclic?a=S(n,e):P(n,a)),n.is_stopped&&!n.force_update||(A(n,a),h(e,n,a),n.last_frame=a),n.force_update=!1,n.rewinded_to_start=!1}}},t.cleanup=function(e){if(0==e)c.length=0,E=-1;else for(var t=0;t<c.length;t++)c[t].objects[e]=null},t.bpy_obj_has_nla=function(e){var t=e.animation_data;return!!(t&&t.nla_tracks.length||y(e)||function(e){if("MESH"!=e.type||!e.data)return!1;var t=e.data.materials;if(!t)return!1;for(var r=0;r<t.length;r++){var n=t[r],a=n.node_tree;if(n.use_nodes&&a&&L(a))return!0}return!1}(e))},t.set_frame=Y,t.get_frame=function(e){var t=_.get_active();return t._nla?g(t._nla,e):-1},t.stop_nla=function(){var e=_.get_active();if(e._nla){e._nla.is_stopped=!0;for(var t=e._nla.textures,r=0;r<t.length;r++)s.pause_video(t[r])}},t.play_nla=function(e){var t=_.get_active();t._nla&&(t._nla.is_stopped=!1,t._nla.user_callback=e||null)},t.get_frame_start=function(){var e=_.get_active();return e._nla?e._nla.frame_start:-1},t.get_frame_end=function(){var e=_.get_active();return e._nla?e._nla.frame_end:-1},t.is_play=function(){var e=_.get_active();return!!e._nla&&!e._nla.is_stopped},t.check_nla=function(){var e=_.get_active();return!!e._nla&&e.b4w_use_nla},t.check_logic_nodes=function(){var e=_.get_active();return!!e._nla&&e.b4w_logic_nodes.length>0},t.set_range=function(e,t){var r=_.get_active();if(!r._nla)return!1;r._nla.range_start=e,r._nla.range_end=t},t.set_range_end=function(e){var t=_.get_active();if(!t._nla)return!1;t._nla.range_end=e},t.set_range_start=function(e){var t=_.get_active();if(!t._nla)return!1;t._nla.range_start=e},t.reset_range=function(){var e=_.get_active();if(!e._nla)return!1;var t=e._nla;t.range_start=t.frame_start,t.range_end=t.frame_end},t.set_cyclic=function(e){var t=_.get_active();if(!t._nla)return!1;t._nla.cyclic=e},t.clear_callback=function(){var e=_.get_active();e._nla&&(e._nla.user_callback=null)},t.set_offset_from_range_start=function(e){var t=_.get_active()._nla;t&&(t.frame_offset=-(e-E)*l.get_framerate()+t.range_start,t.force_update=!0)},t.get_frame_end=function(){var e=_.get_active()._nla;return e?e.frame_end:null}})),KI=nA("__objects",(function(e,t){var r=wI(e),n=gN(e),a=JI(e),o=pb(e),_=dR(e),i=YI(e),s=fb(e),l=TR(e),c=VR(e),E=GI(e),u=PI(e),d=SI(e),T=CI(e),f=mN(e),p=II(e),P=LI(e),S=mR(e),A=yI(e),h=XI(e),v=AR(e),m=MI(e),g=ZI(e),O=tI(e),N=pR(e),R=bI(e),I=_.defaults,b=_.outlining,y={ALL:[]},L=0,Y=0,M=[],x=[],C=[],w=new Float32Array(3),U=new Float32Array(4);function k(e){for(var t=e.scenes_data,r=e.render,n=0;n<t.length;n++){var a=t[n].scene;a._render.outline&&r.outline_intensity&&P.request_outline(a)}}function D(e){e.render.outline_intensity=0;var t=C.indexOf(e);-1!=t&&C.splice(t,1)}function F(e,t){return-1!=e._bsdf_types.indexOf(t)}function G(e){if(e.field)for(var t=e.scenes_data,r=0;r<t.length;r++)P.update_force_scene(t[r].scene,e)}function K(e,t){for(var r=e.scenes_data,n=t.scenes_data,a=0;a<r.length;a++){for(var o=!1,_=0;_<n.length;_++)if(r[a].scene==n[_].scene){o=!0;break}o||B(t,r[a].scene)&&u.append_scene_data(t,r[a].scene)}}function B(e,t){return!(!t._is_main&&"SPEAKER"==e.type||!t._is_primary_thread&&"LAMP"==e.type)}function X(e){var t=r.bpy_mesh_empty_is_animatable(e),n=e.b4w_do_not_batch,a=e.b4w_collision,o=e.b4w_vehicle,_=e.b4w_floating,i=e.b4w_character,s=d.has_dynamic_grass_particles(e),l=E.bpy_obj_has_nla(e),c=e.data.b4w_shape_keys.length>0,u=e.b4w_dynamic_geometry,T=H(e);return t||n||a||o||c||_||s||i||l||u||function(e){for(var t=e.data,r=0;r<t.materials.length;r++){var n=t.materials[r];if(n.water_settings.is_water)return!0;if(n.is_lens_flares)return!0;if(z(n.node_tree))return!0}return!1}(e)||T}function H(e){var t=!1,r=e.constraints.length;if(r){for(var n=null,a=r-1;a>=0;a--){var o=e.constraints[a];if("LOCKED_TRACK"!=o.type||"REFLECTION PLANE"!=o.name){n=o;break}}if(!n)return!1;if(!n.target)return!1;var _=n.target,i=_.type;if(_.parent){var s=_.parent.type;return"MESH"==s?t||X(_.parent):"EMPTY"!=s||t||j(_.parent)}t="MESH"==i?t||X(_):"EMPTY"!=i||t||j(_)}return t}function j(e){var t=r.bpy_mesh_empty_is_animatable(e),n=E.bpy_obj_has_nla(e),a=e.b4w_do_not_batch,o=Boolean(e.b4w_anchor),_=H(e);return t||n||a||o||_}function z(e){if(!e)return!1;for(var t=e.nodes,r=0;r<t.length;r++){var n=t[r];if("VECT_TRANSFORM"==n.type){var a=n.convert_from,o=n.convert_to;if(n.outputs[0].is_linked&&("WORLD"!=a||"CAMERA"!=o)&&("CAMERA"!=a||"WORLD"!=o)&&("OBJECT"!=a||"OBJECT"!=o))return!0}if("NORMAL_MAP"==n.type){var _=n.space;if(n.outputs[0].is_linked&&("OBJECT"==_||"BLENDER_OBJECT"==_))return!0}if("TEX_COORD"==n.type&&n.outputs[3].is_linked)return!0;if("OBJECT_INFO"==n.type&&(n.outputs[0].is_linked||n.outputs[1].is_linked||n.outputs[3].is_linked))return!0}return!1}function Q(e){if(J(e,y.ALL,!1,-1)){for(var t,r=1;J(e+(t="."+(String(r).length<3?("000"+String(r)).slice(-3):String(r))),y.ALL,!1,-1);)r++;return f.error('Object "'+e+'" already exists. Name was replaced by "'+e+t+'".'),t}return""}function V(e,t,r){for(var n=y[t]||[],a=[],o=0;o<n.length;o++){var _=n[o];if(_.render.data_id==r||-1==r)for(var i=_.scenes_data,s=0;s<i.length;s++)i[s].scene==e&&a.push(_)}return a}function q(e,t){var r=y[e]||[];if(-1==t)return r;for(var n=[],a=0;a<r.length;a++){var o=r[a];o.render.data_id==t&&n.push(o)}return n}function W(e,t,r,n){for(var o=0;o<e.scenes_data.length;o++)for(var _=e.scenes_data[o].batches,i=0;i<_.length;i++){var s=_[i];s.bufs_data&&(s.bufs_data.cleanup_gl_data_on_unload=t),s.cleanup_gl_data_on_unload=t,s.shader&&(s.shader.cleanup_gl_data_on_unload=r),a.set_cleanup_nodemat(n)}}function J(e,t,r,n,a){for(var o=null,_=0;_<t.length;_++){var i=t[_];if(!((r?i.origin_name:i.name)!=e||i.render.data_id!=n&&-1!=n||a&&i.is_meta||u.get_dg_parent(o=i)))break}return o}function Z(e,t,r,n){for(var a=0;a<r.length;a++){var o=r[a];if(o.origin_name==t&&(o.render.data_id==n||-1==n)){var _=u.get_dg_parent(o);if(_&&_.origin_name==e)return o}}return null}function $(e,t,r){for(var n=0;n<t.length;n++){for(var a=t[n],o=e.length-1,_=a,i=!0;o>=0&&i;)i=_&&_.origin_name==e[o]&&(_.render.data_id==r||-1==r),_&&(_=u.get_dg_parent(_)),o--;if(i&&!_)return a}return null}function ee(e,t){var r=0,n=e.outline_animation;0==n.time_start&&(n.time_start=t);var a=t-n.time_start;if(n.relapses&&a/n.period>=n.relapses)D(e);else{var o=a%n.period;if(o<n.outline_time){var _=o/(n.outline_time/5),i=Math.floor(_);switch(i){case 0:r=(_-i)/2;break;case 1:r=(_-i)/2+.5;break;case 2:r=1;break;case 3:r=1-(_-i)/2;break;case 4:r=.5-(_-i)/2}}e.render.outline_intensity=r}}function te(e){y.ALL.push(e),y[e.type]||(y[e.type]=[]),y[e.type].push(e);var t=e.render.plane_reflection_id;if(null!=t)for(var r=0;r<M.length;r++){var n=M[r];n.render.plane_reflection_id==t&&n.reflective_objs.push(e)}}function re(e,t,r){if(!t.is_lod)return!0;var n=e.lod_settings;if(n.dest_coverage!=n.coverage)if(n.use_smoothing){var a=qg(n.dest_coverage-n.coverage);n.coverage+=a*v.get_delta()/.4,n.coverage=xO(n.coverage,0,1)}else n.coverage=n.dest_coverage;if("STATIC"==t.type)var o=t.lod_center;else o=uh(t.bs_world.center,t.main_lod_offset,w);var _=hh(o,r);if(0==n.hyst_prev_state)var i=Math.max(t.lod_dist_min-n.hyst_interval_min/2,0),s=t.lod_dist_max+n.hyst_interval_max/2;else-1==n.hyst_prev_state?(i=t.lod_dist_min+n.hyst_interval_min/2,s=t.lod_dist_max+n.hyst_interval_max/2):(i=Math.max(t.lod_dist_min-n.hyst_interval_min/2,0),s=Math.max(t.lod_dist_max-n.hyst_interval_max/2,0));return n.hyst_prev_state=_<i?-1:_<s?0:1,n.dest_coverage=_<i||_>s?0:1,n.cmp_logic=0==n.dest_coverage?-1:1,Math.abs(_-n.prev_dist)>I.lod_leap_smooth_threshold&&(0==n.coverage||1==n.coverage)&&(n.coverage=n.dest_coverage),n.prev_dist=_,0!=n.dest_coverage||0!=n.coverage}t.GET_OBJECT_BY_NAME=0,t.GET_OBJECT_BY_DUPLI_NAME=1,t.GET_OBJECT_BY_DUPLI_NAME_LIST=2,t.DATA_ID_ALL=-1,t.update=function(e,t){for(var r=0;r<C.length;r++){var n=C[r];ee(n,e),n.render.outline_intensity&&k(n)}var a=y.ARMATURE;if(a)for(r=0;r<a.length;r++){var o=a[r];o.need_update_transform&&(m.update_transform(o),o.need_update_transform=!1)}},t.set_outline_intensity=function(e,t){e.render.outline_intensity=t,k(e)},t.apply_outline_anim=function(e,t,r,n){var a=e.outline_animation;a.time_start=0,a.outline_time=t,a.period=r,a.relapses=n,-1==C.indexOf(e)&&C.push(e)},t.clear_outline_anim=D,t.create_object_from_bpy=function(e,t){var _,i,s=u.create_object(t?"%meta_world%"+e.name:e.name,t?"WORLD":e.type,t?"%meta_world%"+e.name:e.origin_name);if("MESH"==s.type)for(var c=0;c<e.data.materials.length;c++)s.materials.push(e.data.materials[c]);for(c=0;c<e._scenes.length;c++)u.append_scene_data(s,e._scenes[c]);return e._object=s,t?((i=s).uuid=(_=e).uuid,i.is_meta=!1,i.def_action_slots=_._def_action_slots,i.is_dynamic=_._is_dynamic,i.render=u.create_render(i.type),i.use_default_animation=_.b4w_use_default_animation,i.anim_behavior_def=r.anim_behavior_bpy_b4w(_.b4w_anim_behavior),te(i)):function(e,t){if(t.uuid=e.uuid,t.is_meta=!1,t.def_action_slots=e._def_action_slots,t.is_dynamic=e._is_dynamic,t.is_hair_dupli=e._is_hair_dupli||!1,function(e,t){t.is_vehicle=e.b4w_vehicle,t.is_character=e.b4w_character,t.is_floating=e.b4w_floating,t.use_obj_physics=e.b4w_collision,t.collision_id=e.b4w_collision_id,t.correct_bounding_offset=e.b4w_correct_bounding_offset;var r=e.game;t.physics_settings={physics_type:r.physics_type,use_ghost:r.use_ghost,use_sleep:r.use_sleep,mass:r.mass,velocity_min:r.velocity_min,velocity_max:r.velocity_max,damping:r.damping,rotation_damping:r.rotation_damping,lock_location_x:r.lock_location_x,lock_location_y:r.lock_location_y,lock_location_z:r.lock_location_z,lock_rotation_x:r.lock_rotation_x,lock_rotation_y:r.lock_rotation_y,lock_rotation_z:r.lock_rotation_z,collision_margin:r.collision_margin,collision_group:r.collision_group,collision_mask:r.collision_mask,use_collision_bounds:r.use_collision_bounds,collision_bounds_type:r.collision_bounds_type,use_collision_compound:r.use_collision_compound};var n=e.b4w_vehicle_settings;n&&(t.vehicle_settings={name:n.name,part:n.part,suspension_rest_length:n.suspension_rest_length,suspension_compression:n.suspension_compression,suspension_stiffness:n.suspension_stiffness,suspension_damping:n.suspension_damping,wheel_friction:n.wheel_friction,roll_influence:n.roll_influence,max_suspension_travel_cm:n.max_suspension_travel_cm,force_max:n.force_max,brake_max:n.brake_max,steering_max:n.steering_max,max_speed_angle:n.max_speed_angle,delta_tach_angle:n.delta_tach_angle,speed_ratio:n.speed_ratio,steering_ratio:n.steering_ratio,inverse_control:n.inverse_control,floating_factor:n.floating_factor,water_lin_damp:n.water_lin_damp,water_rot_damp:n.water_rot_damp,synchronize_position:n.synchronize_position});var a=e.b4w_floating_settings;a&&(t.floating_settings={name:a.name,part:a.part,floating_factor:a.floating_factor,water_lin_damp:a.water_lin_damp,water_rot_damp:a.water_rot_damp,synchronize_position:a.synchronize_position});var o=e.b4w_character_settings;o&&(t.character_settings={walk_speed:o.walk_speed,run_speed:o.run_speed,step_height:o.step_height,jump_strength:o.jump_strength,waterline:o.waterline});for(var _=0;_<e.constraints.length;_++){var i=e.constraints[_];"RIGID_BODY_JOINT"==i.type&&t.physics_constraints.push({target:i.target._object,pivot_type:i.pivot_type,pivot_x:i.pivot_x,pivot_y:i.pivot_y,pivot_z:i.pivot_z,axis_x:i.axis_x,axis_y:i.axis_y,axis_z:i.axis_z,use_limit_x:i.use_limit_x,use_limit_y:i.use_limit_y,use_limit_z:i.use_limit_z,use_angular_limit_x:i.use_angular_limit_x,use_angular_limit_y:i.use_angular_limit_y,use_angular_limit_z:i.use_angular_limit_z,limit_max_x:i.limit_max_x,limit_max_y:i.limit_max_y,limit_max_z:i.limit_max_z,limit_min_x:i.limit_min_x,limit_min_y:i.limit_min_y,limit_min_z:i.limit_min_z,limit_angle_max_x:i.limit_angle_max_x,limit_angle_max_y:i.limit_angle_max_y,limit_angle_max_z:i.limit_angle_max_z,limit_angle_min_x:i.limit_angle_min_x,limit_angle_min_y:i.limit_angle_min_y,limit_angle_min_z:i.limit_angle_min_z})}}(e,t),"MESH"===t.type)var _=t.is_dynamic?"DYNAMIC":"STATIC";else _=t.type;var i=t.render=u.create_render(_);!function(e,t){e.parent?(t.parent=e.parent._object,"BONE"==e.parent_type&&"ARMATURE"==e.parent.type&&(t.parent_bone=e.parent_bone),e.pinverse_tsr&&(9===e.pinverse_tsr.length?t.pinverse_tsr=Dm(e.pinverse_tsr,wm()):(t.pinverse_tsr=wm(),Gm(Eh(e.pinverse_tsr[0],e.pinverse_tsr[1],e.pinverse_tsr[2],w),e.pinverse_tsr[3],Xv(e.pinverse_tsr[4],e.pinverse_tsr[5],e.pinverse_tsr[6],e.pinverse_tsr[7],U),t.pinverse_tsr)))):e.dg_parent&&(t.parent=e.dg_parent._object,t.parent_is_dupli=!0)}(e,t);var s=e.location,c=e.scale,E=U;switch($O(e.rotation_quaternion,E),m.set_translation(t,s),m.set_rotation(t,E),m.set_scale(t,c),t.use_default_animation=e.b4w_use_default_animation,t.anim_behavior_def=r.anim_behavior_bpy_b4w(e.b4w_anim_behavior),e.b4w_object_tags&&(t.metatags={title:e.b4w_object_tags.title,description:e.b4w_object_tags.description,category:e.b4w_object_tags.category}),t.custom_prop=e.b4w_custom_prop,e.b4w_viewport_alignment&&(t.viewport_alignment={alignment:e.b4w_viewport_alignment.alignment,distance:e.b4w_viewport_alignment.distance}),i.hide=e.b4w_hidden_on_load,i.hide_children=e.b4w_hide_chldr_on_load,e.type){case"ARMATURE":!function(e,t){for(var r=e.data.bones,n=e.pose.bones,a={},o=0;o<n.length;o++){var _=(d=n[o]).bone,i=a[u=_.name]={bone_index:0,vgroup_index:-1,parent_bone_ptr:null,descend_bones_ptrs:[],chain:[],constraint:null,tsr_bone_rest:wm(),tsr_bone_pose:wm(),tsr_local_rest:wm(),tsr_local_rest_i:wm(),tsr_local_pose:wm(),tsr_local_pose_b:wm(),tsr_local_pose_a:wm(),tsr_basis:wm(),tsr_channel_cache:wm(),tsr_channel_cache_valid:!1,tail:new Float32Array(3)},s=new Float32Array(_.matrix_local),l=new Float32Array(16);MA(s,l);var c=new Float32Array(d.matrix_basis),E=i.tail;dh(Qg(_.tail_local),Qg(_.head_local),E),pO(E,l,E),eg(s,i.tsr_local_rest),eg(c,i.tsr_basis),Dm(i.tsr_local_rest,i.tsr_local_pose),Zm(i.tsr_local_rest,i.tsr_local_rest_i)}for(o=0;o<r.length;o++){var u,d,T=(d=Wg("name",u=r[o].name,n)).parent_recursive;(i=a[u]).chain.push(i);for(var f=0;f<T.length;f++){var p;i.chain.push(p=a[T[f].name])}T.length?(i.parent_bone_ptr=p=a[T[0].name],Zm(p.tsr_local_rest,rI),tg(rI,i.tsr_local_rest,i.tsr_bone_rest),p.descend_bones_ptrs.push(i)):Dm(i.tsr_local_rest,i.tsr_bone_rest),i.bone_index=o,i.name=u,tg(i.tsr_bone_rest,i.tsr_basis,i.tsr_bone_pose)}t.render.bone_pointers=a}(e,t);var d=i.bone_pointers,T=r.calc_pose_data(d);for(var f in e.b4w_animation_mixing?(i.quats_before=new Float32Array(T.quats),i.quats_after=new Float32Array(T.quats),i.trans_before=new Float32Array(T.trans),i.trans_after=new Float32Array(T.trans)):(i.quats_before=T.quats,i.quats_after=T.quats,i.trans_before=T.trans,i.trans_after=T.trans),d){var p=d[f];1==p.chain.length&&cI(p,!0,T.trans,T.quats)}i.pose_data=T,i.frame_factor=0,i.anim_mixing=e.b4w_animation_mixing;break;case"MESH":i.bb_original=a.bb_bpy_to_b4w(e.data.b4w_boundings.bb),t.is_boundings_overridden=e.data.is_boundings_overridden,i.do_not_render=e.b4w_do_not_render,i.selectable=b.outlining_overview_mode||e.b4w_selectable,i.origin_selectable=e.b4w_selectable,i.outlining=b.outlining_overview_mode||e.b4w_outlining,i.origin_outlining=e.b4w_outlining,i.outline_on_select=b.outlining_overview_mode||e.b4w_outline_on_select,i.billboard=e.b4w_billboard,i.billboard_pres_glob_orientation=e.b4w_pres_glob_orientation,i.billboard_type="BASIC",i.billboard_spherical="SPHERICAL"==e.b4w_billboard_geometry;var P=i.outline_anim_settings_default;if(P.outline_duration=e.b4w_outline_settings.outline_duration,P.outline_period=e.b4w_outline_settings.outline_period,P.outline_relapses=e.b4w_outline_settings.outline_relapses,i.selectable&&(i.color_id=l.gen_color_id(L),L++),function(e,t){for(var r=0;r<e.data.b4w_vertex_anim.length;r++){var n=e.data.b4w_vertex_anim[r];t.vertex_anim.push({name:n.name,frame_start:n.frame_start,frame_end:n.frame_end,averaging:n.averaging,averaging_interval:n.averaging_interval,allow_nla:n.allow_nla})}t.render.vertex_anim=!!t.vertex_anim.length}(e,t),function(e,t){"MESH"!=e.type&&n.panic("Wrong object type: "+e.name);var r=t.render;if(e.data.b4w_shape_keys.length){r.use_shape_keys=!0;for(var a=0;a<e.data.b4w_shape_keys.length;a++){var o={};o.value=e.data.b4w_shape_keys[a].value,o.name=e.data.b4w_shape_keys[a].name,r.shape_keys_values.push(o)}}else r.use_shape_keys=!1}(e,t),i.shadow_cast=e.b4w_shadow_cast,i.shadow_receive=e.b4w_shadow_receive,i.shadow_cast_only=e.b4w_shadow_cast_only&&i.shadow_cast,i.reflexible=e.b4w_reflexible,i.reflexible_only=e.b4w_reflexible_only&&i.reflexible,i.reflective=e.b4w_reflective,i.reflection_type=e.b4w_reflection_type,i.reflective||function(e){for(var t=e.materials,r=0;r<t.length;r++){var n=t[r];n.use_nodes&&(F(n.node_tree,"BSDF_GLOSSY")||F(n.node_tree,"BSDF_DIFFUSE")||F(n.node_tree,"BSDF_PRINCIPLED"))&&(e.render.reflective=!0,e.render.reflection_type="PBR")}}(t),i.caustics=e.b4w_caustics,i.wind_bending=e.b4w_wind_bending,e.b4w_wind_bending){i.wind_bending_angle=e.b4w_wind_bending_angle;var S=a.wb_angle_to_amp(NO(e.b4w_wind_bending_angle),i.bb_original,e.scale[0]);i.wind_bending_amp=S,i.wind_bending_freq=e.b4w_wind_bending_freq,i.detail_bending_freq=e.b4w_detail_bending_freq,i.detail_bending_amp=e.b4w_detail_bending_amp,i.branch_bending_amp=e.b4w_branch_bending_amp,i.main_bend_col=e.b4w_main_bend_stiffness_col;var h=e.b4w_detail_bend_colors;i.detail_bend_col.leaves_stiffness=h.leaves_stiffness_col,i.detail_bend_col.leaves_phase=h.leaves_phase_col,i.detail_bend_col.overall_stiffness=h.overall_stiffness_col}if(i.dynamic_geometry=e.b4w_dynamic_geometry,i.dynamic_geometry){t._bpy_obj=e;for(var v=0;v<t.materials.length;v++)t.mat_inheritance_data.original_mat_names.push(t.materials[v].name),t.mat_inheritance_data.is_disabled.push(!1)}var g=t.materials[0];i.friction=g.physics_settings.friction,i.elasticity=g.physics_settings.elasticity,i.lod_dist_min=0,i.lod_dist_max=u.LOD_DIST_MAX_INFINITY,i.pass_index=e.pass_index;break;case"LINE":i.bb_local={max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0},i.be_local=VN(),i.bb_world={max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0},i.be_world=VN();break;case"CAMERA":o.camera_object_to_camera(e,t),o.assign_boundings(t);break;case"LAMP":uI(e,t);break;case"SPEAKER":t.sfx=A.create_sfx();var O=!1;for(v=0;v<t.scenes_data.length;v++)if(t.scenes_data[v].scene._sfx){O=!0;break}O&&A.update_object(e,t);break;case"EMPTY":i.bb_local={max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0};var N=zN();i.bs_local=N,e.field&&(t.field={type:e.field.type,strength:e.field.strength}),e.b4w_anchor&&(t.anchor={type:e.b4w_anchor.type,detect_visibility:e.b4w_anchor.detect_visibility,element_id:e.b4w_anchor.element_id,max_width:e.b4w_anchor.max_width})}te(t)}(e,s),s},t.update_object_relations=function(e,t){var n=t.render;if("MESH"==t.type){var a=r.get_bpy_armobj(e);if(a){var o=a._object,_=o.render.pose_data;!function(e,t,n){var a=t.render,o=e.data;t.armobj=n;var _=o.vertex_groups;if(_.length){var i=n.render.bone_pointers,s=0,l={};for(var c in i){var E=Wg("name",c,_);E&&(l[c]={vgroup_index:E.index,bone_index:i[c].bone_index,deform_bone_index:s++})}a.bone_skinning_info=l;var u=s,d=r.get_max_bones();a.max_bones=u,u>2*d?(a.is_skinning=!1,f.error('too many bones for "'+e.name+'" / '+a.max_bones+" bones (max "+d+" with blending, "+2*d+" without blending). Skinning will be disabled.")):a.is_skinning=!0}}(e,t,o);var s=r.extract_skinned_pose_data(_.trans,_.quats,n.bone_skinning_info);a.b4w_animation_mixing?(n.quats_before=new Float32Array(s.quats),n.quats_after=new Float32Array(s.quats),n.trans_before=new Float32Array(s.trans),n.trans_after=new Float32Array(s.trans)):(n.quats_before=s.quats,n.quats_after=s.quats,n.trans_before=s.trans,n.trans_after=s.trans),n.arm_rel_trans=new Float32Array(4),n.arm_rel_quat=dm(),n.pose_data=s,n.frame_factor=0}n.reflective&&function(e,t){var r=t.render;if("CUBE"==r.reflection_type)r.cube_reflection_id=Y++,x.push(t);else if("PLANE"==r.reflection_type){var n=function(e,t){for(var r=e.constraints,n=0;n<r.length;n++){var a=r[n];if("LOCKED_TRACK"==a.type&&"REFLECTION PLANE"==a.name){if(a.target&&a.target._object)return a.target._object;f.warn('Reflection plane target for object: "'+t.name+"\" is not present on the scene. Using object's Z-axis.")}}return null}(e,t);n||(n=function(e){var t=l.unique_name("%reflection%"),r=u.create_object(t,"EMPTY"),n=u.create_render("EMPTY");return n.data_id=e.render.data_id,r.render=n,K(e,r),i.append_stiff_obj(r,e,[0,0,0],null,1),te(r),r}(t));for(var a=null,o=0;o<M.length;o++)if(M[o]==n){a=o;break}null==a&&(a=M.length,M.push(n)),n.render.plane_reflection_id=a,r.plane_reflection_id=a,n.reflective_objs.push(t)}}(e,t)}},t.update_force=G,t.unload_plane_reflections=function(e){if(e.render.plane_reflection_id>=0)for(var t=0;t<e.scenes_data.length;t++){for(var r=e.scenes_data[t].scene._render.graph,n=0;n<M.length;n++){var a=M[n];if(a.render.plane_reflection_id==e.render.plane_reflection_id){var o=a.reflective_objs.indexOf(e);o>-1&&a.reflective_objs.splice(o,1);var _=[];N.traverse(r,(function(e,t){t.type!=S.MAIN_PLANE_REFLECT&&t.type!=S.MAIN_PLANE_REFLECT_BLEND||t.refl_obj!=a||_.push(t)}));for(var i=0;i<_.length;i++){var s=_[i],l=N.get_node_id(r,s);N.remove_node(r,l),P.clear_subscene(s)}N.cleanup_loose_edges(r)}}e.scenes_data[t].scene._render.queue=R.create_rendering_queue(r)}},t.unload_cube_reflections=function(e){if(e.render.cube_reflection_id>=0)for(var t=0;t<e.scenes_data.length;t++){for(var r=e.scenes_data[t].scene._render.graph,n=0;n<x.length;n++){var a=x[n];if(a.render.cube_reflection_id==e.render.cube_reflection_id){var o=[];N.traverse(r,(function(e,t){t.type!=S.MAIN_CUBE_REFLECT&&t.type!=S.MAIN_CUBE_REFLECT_BLEND||t.refl_obj!=a||o.push(t)}));for(var _=0;_<o.length;_++){var i=o[_],s=N.get_node_id(r,i);N.remove_node(r,s),P.clear_subscene(i)}N.cleanup_loose_edges(r)}}e.scenes_data[t].scene._render.queue=R.create_rendering_queue(r)}},t.copy_scene_data=K,t.check_bpy_obj_scene_compatibility=B,t.update_objects_dynamics=function(e){for(var t=0;t<e.length;t++){var n=e[t];!n.render||"DYNAMIC"!=n.render.type&&"CAMERA"!=n.render.type||m.update_transform(n),n.use_default_animation&&r.obj_is_animatable(n)&&(r.apply_def(n),n.anim_slots.length&&r.play(n,null,r.SLOT_ALL))}},t.bpy_obj_is_dynamic=function(e){if(e.b4w_hidden_on_load)return!0;if(e.dg_parent&&e.dg_parent._is_dynamic)return!0;if(e.parent&&e.parent._is_dynamic)return!0;switch(e.type){case"MESH":return X(e);case"EMPTY":return j(e);default:return!0}},t.get_meta_tags=function(e){return lO(e.metatags)},t.get_custom_prop=function(e){return e.custom_prop},t.cleanup=function(){L=0,Y=0,M.length=0,x.length=0,C.length=0,y={ALL:[]}},t.copy=function(e,t,r){var n=function(e,t,r){var n=t,o=u.get_dg_parent(e),_=o?u.gen_dupli_name(o.name,t):t,i=Q(_),s=u.create_object(_+=i,e.type,n+=i);s.is_meta=e.is_meta,s._bpy_obj=e._bpy_obj,s.mat_inheritance_data.original_mat_names=u.copy_bpy_object_props_by_link(e.mat_inheritance_data.original_mat_names),s.mat_inheritance_data.is_disabled=u.copy_bpy_object_props_by_link(e.mat_inheritance_data.is_disabled),s.is_dynamic=e.is_dynamic,s.is_hair_dupli=e.is_hair_dupli,s.use_default_animation=e.use_default_animation,s.def_action_slots=e.def_action_slots,s.render=u.clone_render(e.render),s.render.is_lod=!1,s.metatags=u.copy_object_props_by_value(e.metatags),s.custom_prop=u.copy_object_props_by_value(e.custom_prop),K(e,s),s.action_anim_cache=u.copy_bpy_object_props_by_link(e.action_anim_cache),s.parent=u.copy_bpy_object_props_by_link(e.parent),s.parent_is_dupli=e.parent_is_dupli,s.parent_bone=e.parent_bone,s.vertex_anim=u.copy_bpy_object_props_by_link(e.vertex_anim),s.anim_behavior_def=e.anim_behavior_def,e.physics&&!(e.is_vehicle||e.is_character||e.is_floating)&&(s.use_obj_physics=e.use_obj_physics,s.physics=null),s.collision_id=e.collision_id,s.correct_bounding_offset=e.correct_bounding_offset,s.physics_settings=u.copy_object_props_by_value(e.physics_settings),function(e,t,r){for(var n=[],o=0;o<e.scenes_data.length;o++){var _=t.scenes_data[o],i=e.scenes_data[o].batches;if(r){for(var s=_.batches,l=0;l<i.length;l++)if(!i[l].forked_batch){var E=u.copy_object_props_by_value(i[l]);E.bufs_data=c.clone_bufs_data(i[l].bufs_data),u.append_batch(t,_.scene,E),n.push(i[l].bufs_data)}for(l=0;l<i.length;l++)if(i[l].forked_batch){var d=u.copy_object_props_by_value(i[l]);u.append_batch(t,_.scene,d);for(var T=0;T<n.length;T++)n[T]==i[l].bufs_data&&(d.bufs_data=s[T].bufs_data)}for(l=0;l<s.length;l++)s[l].bufs_data&&c.update_gl_buffers(s[l].bufs_data),I.allow_vao_ext&&s[l].bufs_data&&O.assign_vao(s[l]),s[l].odd_id_prop=a.generate_odd_id(s[l],t.render,t.uuid),a.update_batch_id(s[l]);h.share_batch_canvas_textures(s)}else for(l=0;l<i.length;l++)u.append_batch(t,_.scene,i[l])}}(e,s,r);for(var l=0;l<e.materials.length;l++)s.materials.push(FI(e.materials[l]));return u.scene_data_set_active(s,!1),te(s),s}(e,t,r);return n.render.is_copied=!0,n.render.is_copied_deep=r,n.render.color_id=l.gen_color_id(L),L++,n},t.get_bpy_def_action_slots=function(e,t){var n=[],a=e.animation_data,o=e.data?e.data.animation_data:null;if(a&&a.action){var _=a.action;(_._render.type==r.OBJ_ANIM_TYPE_OBJECT||_._render.type==r.OBJ_ANIM_TYPE_ARMATURE&&"ARMATURE"==e.type||_._render.type==r.OBJ_ANIM_TYPE_LIGHT&&"LAMP"==e.type||_._render.type==r.OBJ_ANIM_TYPE_ENVIRONMENT&&t)&&n.push(r.init_action_slot(null,_))}return o&&o.action&&("SPEAKER"==e.type||"LAMP"==e.type)&&n.push(r.init_action_slot(null,o.action)),"MESH"==e.type&&n.push.apply(n,r.get_bpy_material_actions(e)),t&&n.push.apply(n,r.get_bpy_world_material_actions(e)),n},t.update_boundings=function(e){for(var t=e.render,r=null,n=e.scenes_data[0].batches,o=0;o<n.length;o++){var _=e.scenes_data[0].batch_world_bounds[o];if((l=n[o]).bufs_data&&_.be&&_.bb){var i=c.get_vbo_type_by_attr_name("a_position");(E=c.get_vbo_source_by_type(l.bufs_data.vbo_source_data,i))&&(a.update_local_bounds_from_pos(l,E.subarray(d=l.bufs_data.pointers.a_position.offset,l.bufs_data.pointers.a_position.length+d)),u.update_world_bounds_from_batch_tsr(l,t.world_tsr,_),"MAIN"==l.type&&(r?DN(r,l.bounds_local.bb):r=UN(l.bounds_local.bb)))}}if(r=r||{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0},t.billboard)u.update_render_bounds_billboard(e,r);else{var s=[];for(o=0;o<n.length;o++){var l,E;if("MAIN"==(l=n[o]).type&&(i=c.get_vbo_type_by_attr_name("a_position"),E=c.get_vbo_source_by_type(l.bufs_data.vbo_source_data,i))){var d,T=n[o].bufs_data.pointers;s.push(E.subarray(d=T.a_position.offset,T.a_position.length+d))}}u.update_render_bounds_from_pos_arrays(e,r,s)}if(I.debug_view)for(o=0;o<n.length;o++)if("DEBUG_VIEW"===n[o].type&&n[o].debug_sphere){var f=t.be_local,P=p.generate_uv_sphere(16,8,1,f.center,!1,!1);c.scale_submesh_xyz(P,[f.axis_x[0],f.axis_y[1],f.axis_z[2]],f.center),c.submesh_drop_indices(P,1,!0),P.va_common.a_polyindex=c.extract_polyindices(P),a.update_batch_geometry(n[o],P);break}},t.get_scene_objs=V,t.get_scene_objs_derived=function(e,t,r){for(var n=y[t]||[],a=[],o=0;o<n.length;o++){var _=n[o];if(!(_.render.data_id!=r&&-1!=r||_.is_meta))for(var i=_.scenes_data,s=0;s<i.length;s++)i[s].scene==e&&a.push(_)}return a},t.get_all_objects=q,t.get_first_character=function(e){var t=y.MESH;if(t)for(var r=0;r<t.length;r++){var n=t[r];if(T.has_character_physics(n))for(var a=n.scenes_data,o=0;o<a.length;o++)if(a[o].scene==e)return n}return null},t.obj_switch_cleanup_flags=W,t.get_selectable_objects=function(){var e=[],t=y.MESH;if(t)for(var r=0;r<t.length;r++){var n=t[r];n.render.selectable&&!n.is_meta&&e.push(n)}return e},t.get_outlining_objects=function(){var e=[],t=y.MESH;if(t)for(var r=0;r<t.length;r++){var n=t[r];n.render.outlining&&!n.is_meta&&e.push(n)}return e},t.get_object=function(){var e=null,r=y.ALL;switch(arguments[0]){case t.GET_OBJECT_BY_NAME:e=J(arguments[1],r,!0,arguments[2],arguments[3]);break;case t.GET_OBJECT_BY_DUPLI_NAME:e=Z(arguments[1],arguments[2],r,arguments[3]);break;case t.GET_OBJECT_BY_DUPLI_NAME_LIST:e=$(arguments[1],r,arguments[2])}return e},t.get_world_by_name=function(e,t){return J("%meta_world%"+e,y.WORLD,!0,t)},t.get_world_name=function(e){return e.origin_name.replace("%meta_world%","")},t.pick_object=function(e,r){var n=P.get_main();if(!n)return f.error("No active scene"),null;var a=P.get_subs(n,S.STEREO);if(a&&a.enable_hmd_stereo){var o=s.get_canvas();e=o.clientHeight/2,r=o.clientWidth/2}var _=g.pick_anchor(e,r);if(_)return _;var i=P.pick_color(n,e,r);if(!i)return null;for(var l=V(n,"MESH",-1),c=0;c<l.length;c++){var E=l[c].render,u=E.color_id;if(u&&Math.abs(255*u[0]-i[0])<3&&Math.abs(255*u[1]-i[1])<3&&Math.abs(255*u[2]-i[2])<3){if(E.outlining&&E.outline_on_select)if(b.outlining_overview_mode)t.apply_outline_anim(l[c],b.outline_duration,b.outline_period,b.outline_relapses);else{var d=E.outline_anim_settings_default;t.apply_outline_anim(l[c],d.outline_duration,d.outline_period,d.outline_relapses)}return l[c]}}return null},t.set_wind_params=function(e,t){for(var r=V(e,"EMPTY",-1),n=0;n<r.length;n++){var a=r[n];if(a.field&&"WIND"===a.field.type){var o=a;break}}if(!o)return f.error("There is no wind on the scene"),0;if("number"==typeof t.wind_dir){var _=NO(t.wind_dir);Eh(Math.sin(_),-Math.cos(_),0,w),iO(w,Ug,U),m.set_rotation(o,U)}"number"==typeof t.wind_strength&&(o.field.strength=t.wind_strength),G(o)},t.remove_object=function(e){i.check_constraint(e)&&i.remove(e),function(e){var t=y.ALL,r=y[e.type],n=t.indexOf(e),a=r.indexOf(e);-1!=n&&t.splice(n,1),-1!=a&&r.splice(a,1)}(e)},t.objects_storage_add=te,t.objects_storage_check=function(e){return y[e.type]&&y[e.type].indexOf(e)>-1},t.update_lod_scene=function(e,t){e.render.is_lod&&function(e,t){var r=e.render,n=t._render;if(r.is_lod)for(var a=m.get_translation(t._camera,w),o=0;o<e.scenes_data.length;o++)if(e.scenes_data[o].scene==t)for(var _=0;_<e.scenes_data[o].batches.length;_++){var i=e.scenes_data[o].batches[_],s=i.lod_settings;if(I.lod_smooth_transitions&&("SHADOW"!=i.type||"RECEIVE"!=i.subtype||I.reuse_depth_optimization)){var l=n.lod_smooth_type;("ALL"==l||"NON-OPAQUE"==l&&(i.blend||i.alpha_clip))&&(s.use_smoothing=!0)}re(i,r,a),s.coverage=s.dest_coverage,s.hyst_interval_min=Math.min(n.lod_hyst_interval,.6*r.lod_lower_border_range),s.hyst_interval_max=Math.min(n.lod_hyst_interval,.6*r.lod_upper_border_range)}}(e,t)},t.update_lod_visibility=re,t.set_hair_particles_wind_bend_params=function(e){for(var t=e.render,r=t.wind_bending_amp,n=t.wind_bending_freq,a=t.detail_bending_freq,o=t.detail_bending_amp,_=t.branch_bending_amp,i=e.scenes_data,s=0;s<i.length;s++)for(var l=i[s].batches,E=0;E<l.length;E++){var u=l[E].bufs_data,d=u.pointers,T=d.au_wind_bending_amp,f=d.au_wind_bending_freq,p=d.au_detail_bending_amp,P=d.au_detail_bending_freq,S=d.au_branch_bending_amp;if(f){var A=Array.apply(null,Array(f.length)).map((function(){return n}));c.update_gl_buffer_sub_data(u,c.VBO_FLOAT,new Float32Array(A),f.offset)}T&&(A=Array.apply(null,Array(T.length)).map((function(){return r})),c.update_gl_buffer_sub_data(u,c.VBO_FLOAT,new Float32Array(A),T.offset)),p&&(A=Array.apply(null,Array(p.length)).map((function(){return o})),c.update_gl_buffer_sub_data(u,c.VBO_FLOAT,new Float32Array(A),p.offset)),P&&(A=Array.apply(null,Array(P.length)).map((function(){return a})),c.update_gl_buffer_sub_data(u,c.VBO_FLOAT,new Float32Array(A),P.offset)),S&&(A=Array.apply(null,Array(S.length)).map((function(){return _})),c.update_gl_buffer_sub_data(u,c.VBO_FLOAT,new Float32Array(A),S.offset))}},t.inherit_material=function(e,t,n,o){if(e.render.dynamic_geometry&&n.render.dynamic_geometry){var _=a.find_batch_material(e,t,"MAIN"),i=null;a.iterate_batches_by_mat(n,o,(function(e){i||(i={}),e.particles_data&&(i[e.particles_data.name]=e.particles_data)}),"PARTICLES");for(var s=function(e,t){W(e,!0,!1,!0);for(var n=q("ALL",-1),a=0;a<n.length;a++){var o=n[a];o!=e&&W(o,!1,!1,!1)}for(P.remove_object_bundles(e,t),a=0;a<e.scenes_data.length;a++)for(var _=e.scenes_data[a].batches.length-1;_>=0;_--){var i=e.scenes_data[a].batches[_];0!=i.material_names.length&&-1==i.material_names.indexOf(t)||u.scene_data_remove_batch(e.scenes_data[a],_)}for(T.obj_has_physics(e)&&T.remove_object(e),a=0;a<n.length;a++)n[a]!=e&&W(n[a],!0,!0,!0);r.delete_cached_anim_data_by_mat(e,t);var s=e._bpy_obj._object;return e._bpy_obj._object=e,s}(n,o),l=function(e,t,r,n){var a=e.mat_inheritance_data.original_mat_names.indexOf(t),o=r.mat_inheritance_data.original_mat_names.indexOf(n),_=e.materials[a];r.materials[o]=_;var i=_.name;_.name=n;for(var s=0;s<r.materials.length;s++)r.mat_inheritance_data.is_disabled[s]=!(s==o);return i}(e,t,n,o),E=P.get_active(),f=0;f<n.scenes_data.length;f++){var p=n.scenes_data[f].scene;P.set_active(p);var S=V(p,"LAMP",0),A=n.scenes_data[f].batches;n.scenes_data[f].batches=[],n.scenes_data[f].batch_world_bounds=[],a.generate_main_batches(p,[n._bpy_obj],S,[]),a.create_forked_batches(n,P.get_graph(p),p),P.assign_scene_data_subs(p,[n]),P.append_object(p,n,!1),T.append_object(n,p);for(var v=0;v<A.length;v++)u.append_batch(n,p,A[v])}!function(e,t,r,n){for(var a=0;a<r.materials.length;a++)r.mat_inheritance_data.is_disabled[a]=!1;var o=e.mat_inheritance_data.original_mat_names.indexOf(t);e.materials[o].name=n}(e,t,n,l),function(e,t){e._bpy_obj._object=t,W(e,!0,!0,!0)}(n,s),function(e,t,n,o,_){for(var i=1;i<e.render.shape_keys_values.length;i++)c.apply_shape_key(e,e.render.shape_keys_values[i].name,e.render.shape_keys_values[i].value);if(r.is_animated(e))for(i=0;i<e.anim_slots.length;i++){var s=e.anim_slots[i];if(s)switch(s.type){case r.OBJ_ANIM_TYPE_PARTICLES:var l=r.get_current_frame_float(e,i);r.set_frame(e,l,i);break;case r.OBJ_ANIM_TYPE_MATERIAL:if(s.node_batches)for(var E=s.node_batches.length-1;E>=0;E--)-1!=s.node_batches[E].material_names.indexOf(t)&&s.node_batches.splice(E,1)}}if(o&&a.iterate_batches_by_mat(e,t,(function(t){if(t.particles_data){var r=t.particles_data.name;if(o[r]){var n=t.particles_data.count_factor!=o[r].count_factor;t.particles_data=d.clone_particles_data(o[r]),n&&d.set_factor(e,r,t.particles_data.count_factor)}}}),"PARTICLES"),_){var u=a.find_batch_material(e,t,"MAIN");u&&(u.diffuse_color.set(_.diffuse_color),u.diffuse_intensity=_.diffuse_intensity,u.diffuse_color_factor=_.diffuse_color_factor,u.diffuse_params.set(_.diffuse_params),u.specular_color.set(_.specular_color),u.specular_color_factor=_.specular_color_factor,u.specular_params.set(_.specular_params),u.specular_alpha=_.specular_alpha,u.emit=_.emit,u.ambient=_.ambient,u.alpha_factor=_.alpha_factor,u.mirror_factor=_.mirror_factor,u.normal_factor=_.normal_factor,u.reflect_factor=_.reflect_factor,u.refr_bump=_.refr_bump,u.fresnel_params.set(_.fresnel_params),u.parallax_scale=_.parallax_scale,u.texture_scale.set(_.texture_scale),u.shallow_water_col.set(_.shallow_water_col),u.shallow_water_col_fac=_.shallow_water_col_fac,u.shore_water_col.set(_.shore_water_col),u.shore_water_col_fac=_.shore_water_col_fac,u.foam_factor=_.foam_factor,u.water_norm_uv_velocity=_.water_norm_uv_velocity,u.node_values=_.node_values.slice(),u.node_rgbs=_.node_rgbs.slice())}a.iterate_batches_by_mat(e,t,(function(t){for(var r=0;r<t.bpy_tex_names.length;r++){var a=t.bpy_tex_names[r],o=t.textures[r];if("IMAGE"==o.source||"ENVIRONMENT"==o.source){var _=h.get_texture_by_name(n,a);_&&o.img_full_filepath!=_.img_full_filepath&&h.set_texture_by_name(e,a,_)}}}))}(n,o,e,i,_),P.set_active(E)}},t.create_line=function(e){e=e||"",e+=Q(e);var t=u.create_object(e,"LINE");return t.render=u.create_render("EMPTY"),t.is_dynamic=!0,a.generate_line_batches(P.get_main(),[t]),P.append_object(P.get_main(),t),te(t),t},t.create_empty=function(e){e=e||"",e+=Q(e);var t=u.create_object(e,"EMPTY");return t.render=u.create_render("EMPTY"),t.is_dynamic=!0,u.append_scene_data(t,P.get_main()),te(t),t},t.generate_mesh_render_boundings=function(e,t){var r=t.render,n=UN(r.bb_original);r.billboard?u.update_render_bounds_billboard(t,n):u.update_render_bounds_from_bpy(t,n,e.data.b4w_boundings)},t.set_nodemat_value=function(e,t,r,n){for(var o=u.is_world(e),_=!1,i=0;i<e.scenes_data.length;i++)for(var s=e.scenes_data[i].batches,l=0;l<s.length;l++){var c=s[l];(o||-1!=c.material_names.indexOf(t))&&(_|=a.set_nodemat_value(c,r,n))}return _&&o&&P.update_sky_texture(e),_},t.set_nodemat_rgb=function(e,t,r,n,o,_){for(var i=u.is_world(e),s=!1,l=0;l<e.scenes_data.length;l++)for(var c=e.scenes_data[l].batches,E=0;E<c.length;E++){var d=c[E];(i||-1!=d.material_names.indexOf(t))&&(s|=a.set_nodemat_rgb(d,r,n,o,_))}return s&&i&&P.update_sky_texture(e),s},t.get_nodemat_value=function(e,t,r){var n=a.find_batch_material_any(e,t,"MAIN")||a.find_batch_material_any(e,t,"PARTICLES");return a.get_nodemat_value(n,r)},t.get_nodemat_rgb=function(e,t,r,n){var o=a.find_batch_material_any(e,t,"MAIN")||a.find_batch_material_any(e,t,"PARTICLES");return a.get_nodemat_rgb(o,r,n)}})),BI=nA("__curve",(function(e,t){var r=gN(e);function n(e,t,r,n,a){var o=n.length;a||(a=new Float32Array(o));for(var _=o+e,i=new Float32Array(_),s=1;s<=_-1;s++)i[s-1]=t>=r[s-1]&&t<r[s+1-1]?1:0;for(var l=2;l<=e;l++)for(s=1;s<=_-l;s++){if(0!=i[s-1])var c=(t-r[s-1])*i[s-1]/(r[s+l-1-1]-r[s-1]);else c=0;if(0!=i[s+1-1])var E=(r[s+l-1]-t)*i[s+1-1]/(r[s+l-1]-r[s+1-1]);else E=0;i[s-1]=c+E}t==r[_-1]&&(i[o-1]=1);var u=0;for(s=1;s<=o;s++)u+=i[s-1]*n[s-1];for(s=1;s<=o;s++)a[s-1]=0!=u?i[s-1]*n[s-1]/u:0;return a}function a(e){var t=e.knot;return t[t.length-1]}function o(e){var t=e.cumulative_length;return t[t.length-1]}function _(e,t,r,n,a){var o=1-e;return t*o*o*o+3*r*o*o*e+3*n*o*e*e+a*e*e*e}t.create_spline=function(e){var t={},a=e.data,o=a.splines[0];if(!o||"NURBS"!=o.type||!o.use_endpoint_u)return null;var _=o.order_u;t.order=_;var i=o.points,s=function(e,t,r){r||(r=[]);var n=e+t,a=e+2;r[0]=0;for(var o=2;o<=n;o++)r[o-1]=o>t&&o<a?r[o-2]+1:r[o-2];return r}(i.length/5,_,[]);t.knot=s,"2D"==a.dimensions?t.is_3d=!1:"3D"==a.dimensions?t.is_3d=!0:r.panic("Wrong curve dimensions");for(var l=[],c=[],E=0;E<i.length;E+=5)l.push(i[E]),l.push(i[E+1]),l.push(i[E+2]),t.is_3d&&l.push(i[E+3]),c.push(i[E+4]);t.cpoints=l,t.weights=c,i=function(e,t,r){r||(r=[]);for(var a=e.cpoints,o=e.is_3d?4:3,_=e.weights,i=e.knot,s=e.order,l=a.length/o,c=l+s,E=0,u=i[c-1]/999,d=0;d<1e3;d++){i[c-1]-E<5e-6&&(E=i[c-1]);for(var T=n(s,E,i,_),f=0;f<o;f++){r[o*d+f]=0;for(var p=0;p<l;p++)r[o*d+f]+=T[p]*a[o*p+f]}E+=u}return r}(t,0,[]);var u=t.is_3d?4:3,d=new Float32Array(1e3);for(d[0]=0,E=1;E<1e3;E+=1){var T=i[(E-1)*u],f=i[(E-1)*u+1],p=i[(E-1)*u+2],P=i[E*u],S=i[E*u+1],A=i[E*u+2],h=Math.sqrt((P-T)*(P-T)+(S-f)*(S-f)+(A-p)*(A-p));d[E]=d[E-1]+h}return t.cumulative_length=d,t},t.spline_point=function(e,t,r){r||(r=[]),t=function(e,t){Math.max(t,0);var r=a(e);return Math.min(t,r)}(e,t);var o=e.cpoints,_=e.is_3d?4:3,i=e.weights,s=e.knot,l=e.order,c=o.length/_,E=c+l;s[E-1]-t<5e-6&&(t=s[E-1]);var u=new Float32Array(c);n(l,t,s,i,u);for(var d=0;d<_;d++){r[d]=0;for(var T=0;T<c;T++)r[d]+=u[T]*o[_*T+d]}return r},t.spline_derivative=function(e,t,r){r||(r=[]);var n=e.cpoints,a=e.is_3d?4:3,o=e.weights,_=e.knot,i=e.order,s=n.length/a,l=s+i;_[l-1]-t<5e-6&&(t=_[l-1]);var c=new Float32Array(s);!function(e,t,r,n,a){var o=n.length;a||(a=new Float32Array(o));var _=new Float32Array(o),i=new Float32Array(o);!function(e,t,r,n,a,o){a||(a=new Float32Array(e)),o||(o=new Float32Array(e));for(var _=e+t,i=new Float32Array(_),s=new Float32Array(_),l=1;l<=_-1;l++)i[l-1]=r>=n[l-1]&&r<n[l+1-1]?1:0;r==n[_-1]&&(i[e-1]=1);for(var c=2;c<=t;c++)for(l=1;l<=_-c;l++){if(0!=i[l-1])var E=(r-n[l-1])*i[l-1]/(n[l+c-1-1]-n[l-1]);else E=0;if(0!=i[l+1-1])var u=(n[l+c-1]-r)*i[l+1-1]/(n[l+c-1]-n[l+1-1]);else u=0;if(0!=i[l-1])var d=i[l-1]/(n[l+c-1-1]-n[l-1]);else d=0;if(0!=i[l+1-1])var T=-i[l+1-1]/(n[l+c-1]-n[l+1-1]);else T=0;if(0!=s[l-1])var f=(r-n[l-1])*s[l-1]/(n[l+c-1-1]-n[l-1]);else f=0;if(0!=s[l+1-1])var p=(n[l+c-1]-r)*s[l+1-1]/(n[l+c-1]-n[l+1-1]);else p=0;i[l-1]=E+u,s[l-1]=d+T+f+p}for(l=1;l<=e;l++)a[l-1]=i[l-1],o[l-1]=s[l-1]}(o,e,t,r,_,i);for(var s=0,l=1;l<=o;l++)s+=_[l-1]*n[l-1];var c=0;for(l=1;l<=o;l++)c+=i[l-1]*n[l-1];for(l=1;l<=o;l++)a[l-1]=0!=s?i[l-1]*n[l-1]/s+_[l-1]*n[l-1]*c/(s*s):0}(i,t,_,o,c);for(var E=0;E<a;E++){r[E]=0;for(var u=0;u<s;u++)r[E]+=c[u]*n[a*u+E]}return r},t.spline_max_t=a,t.spline_length=o,t.spline_len_to_t=function(e,t){if(t<=0)return 0;var r=a(e);if(t>=o(e))return r;var n=e.cumulative_length,_=PO(n,t,0,n.length-1);return r*(_+(t-n[_])/(n[_+1]-n[_]))/1e3},t.linear_interpolation=function(e,t,r,n,a){return r+(a-n)*(e-r)/(t-n)},t.linear=function(e,t,r){var n=t[0],a=t[1],o=(r[1]-a)/(r[0]-n);return o*e+(a-o*n)},t.bezier=function(e,t,r,n,a,o){var i=function e(t,r,n,a,o,i,s,l){var c=t+(r-t)/2,E=_(c,a,o,i,s)-n;return l=l||.01,Math.abs(E)<l?c:E>0?e(t,c,n,a,o,i,s,l):e(c,r,n,a,o,i,s,l)}(0,1,e,t[0],r[0],n[0],a[0],o);return _(i,t[1],r[1],n[1],a[1])},t.calchandle_curvemap=function(e,t,r,n,a){var o=new Float32Array(3),_=new Float32Array(3),i=new Float32Array(3),s=new Float32Array(3),l=new Float32Array(3),c=new Float32Array(3);ch(e[1],_),null==t?(ch(r[1],i),o[0]=2*_[0]-i[0],o[1]=2*_[1]-i[1]):ch(t[1],o),null==r?(ch(t[1],o),i[0]=2*_[0]-o[0],i[1]=2*_[1]-o[1]):ch(r[1],i),dh(_,o,s),dh(i,_,l);var E=mh(s),u=mh(l);if(0==E&&(E=1),0==u&&(u=1),"AUTO"==n||"AUTO"==a){c[0]=l[0]/u+s[0]/E,c[1]=l[1]/u+s[1]/E;var d=2.5614*mh(c);0!=d&&("AUTO"==n&&Ah(_,c,-(E/=d),e[0]),"AUTO"==a&&Ah(_,c,u/=d,e[2]))}"VECTOR"==n&&Ah(_,s,-1/3,e[0]),"VECTOR"==a&&Ah(_,l,1/3,e[2])},t.correct_bezpart=function(e,t,r,n){var a,o,_,i,s=[],l=[];s[0]=e[0]-t[0],s[1]=e[1]-t[1],l[0]=n[0]-r[0],l[1]=n[1]-r[1],_=n[0]-e[0],(a=Math.abs(s[0]))+(o=Math.abs(l[0]))!=0&&a+o>_&&(t[0]=e[0]-(i=_/(a+o))*s[0],t[1]=e[1]-i*s[1],r[0]=n[0]-i*l[0],r[1]=n[1]-i*l[1])}})),XI=nA("__textures",(function(e,t){var r=gN(e),n=jI(e),a=dR(e),o=SR(e),_=HI(e),i=fR(e),s=mN(e),l=AR(e),c=tI(e),E=KI(e),u=PI(e),d=BI(e),T=LI(e),f=a.defaults,p=a.context_limits,P=a.sfx,S=null,A=null,h=null;t.TF_NEAREST=0,t.TF_LINEAR=0,t.TF_NEAREST_MIPMAP_NEAREST=0,t.TF_LINEAR_MIPMAP_NEAREST=0,t.TF_NEAREST_MIPMAP_LINEAR=0,t.TF_LINEAR_MIPMAP_LINEAR=0,t.TT_RGBA_INT=10,t.TT_RGB_INT=20,t.TT_RGBA_FLOAT=30,t.TT_RGB_FLOAT=40,t.TT_DEPTH=50,t.TT_RB_RGBA=60,t.TT_RB_DEPTH=70,t.TT_RB_RGBA_MS=80,t.TT_RB_DEPTH_MS=90,t.CURVE_NODES_TEXT_SIZE=128,t.COLORRAMP_TEXT_SIZE=128,t.PART_COLORRAMP_TEXT_SIZE=128;var v,m={textures:[],loaded_status:[]},g={},O={},N=null,R=["TEXTURE_CUBE_MAP_POSITIVE_X","TEXTURE_CUBE_MAP_NEGATIVE_X","TEXTURE_CUBE_MAP_POSITIVE_Y","TEXTURE_CUBE_MAP_NEGATIVE_Y","TEXTURE_CUBE_MAP_POSITIVE_Z","TEXTURE_CUBE_MAP_NEGATIVE_Z"],I=[[2,0],[0,0],[2,1],[1,0],[1,1],[0,1]];function b(){return h||(h=N.createFramebuffer()),h}function y(){return A||(A=N.createTexture()),A}function L(e,t,r){e.img_uuid=t.uuid,e.img_filepath=t.filepath,e.img_source=t.source,e.img_name=t.name,e.img_full_filepath=vI(r+t.filepath),e.img_comp_method=t._comp_method,-1==m.textures.indexOf(e)&&(m.textures.push(e),m.loaded_status.push(!1))}function Y(e,t,r){var n=t.indexOf(".dds")>-1,a=t.indexOf(".pvr")>-1;e.img_comp_method=n?"dds":a?"pvr":"",e.img_filepath=t,e.img_full_filepath=r,e.img_uuid=HO(),m.textures.push(e),m.loaded_status.push(!0)}function M(e,r,n){var a={type:0,source:"",source_id:"",width:0,height:0,compress_ratio:1,anisotropic_filtering:0,source_size:1024,enable_canvas_mipmapping:!1,canvas_context:null,w_target:0,w_texture:null,w_renderbuffer:null,is_movie:!1,vtex_data_id:-1,video_file:null,video_tex_name:"",movie_length:0,fps:0,frame_start:0,frame_offset:0,frame_duration:0,need_resize:!1,scale_fac:1,use_mipmap:!1,mipmap_count:0,seq_video:null,seq_movie_length:0,seq_fps:0,seq_cur_frame:-1,seq_video_played:!1,seq_last_discrete_mark:-1,video_was_stopped:!1,use_auto_refresh:!1,use_cyclic:!1,use_nla:!1,repeat:!0,img_full_filepath:"",img_filepath:"",img_uuid:"",img_source:"",img_name:"",img_comp_method:""};if(a.type=e,a.source="NONE",a.use_mipmap=n,e==t.TT_RB_RGBA||e==t.TT_RB_DEPTH||e==t.TT_RB_RGBA_MS||e==t.TT_RB_DEPTH_MS)a.w_renderbuffer=N.createRenderbuffer();else{var o=N.TEXTURE_2D,_=N.createTexture();N.bindTexture(o,_),N.texParameteri(o,N.TEXTURE_MAG_FILTER,N.LINEAR),N.texParameteri(o,N.TEXTURE_MIN_FILTER,n?v[f.texture_min_filter]:N.LINEAR),N.texParameteri(o,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE),N.texParameteri(o,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE);var i=B(a),s=X(a),l=j(a);if(e==t.TT_DEPTH)var c=null;else c=e==t.TT_RGBA_FLOAT?new Float32Array([204,204,204,255]):new Uint8Array([204,204,204,255]);N.texImage2D(o,0,s,1,1,0,i,l,c),f.compared_mode_depth&&r&&N.texParameterf(o,N.TEXTURE_COMPARE_MODE,N.COMPARE_REF_TO_TEXTURE),N.bindTexture(o,null),a.w_target=o,a.w_texture=_}return a}function x(e){var t=e.w_target;N.bindTexture(t,e.w_texture);var r=B(e),n=X(e),a=j(e),o=e.canvas_context.canvas;N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0),N.texImage2D(t,0,n,r,a,o),N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1),e.enable_canvas_mipmapping&&N.generateMipmap(t),N.bindTexture(t,null),e.width=o.width,e.height=o.height}function C(e){var t=e.w_target;N.bindTexture(t,e.w_texture),N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0),4!=e.video_file.length?e.need_resize?k(e,e.video_file,e.width*e.scale_fac,e.height*e.scale_fac,!1):N.texImage2D(t,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,e.video_file):N.texImage2D(t,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,e.video_file),N.bindTexture(t,null)}function w(e){var t=e.w_target;N.bindTexture(t,e.w_texture),N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0),e.need_resize?k(e,e.seq_video[e.seq_cur_frame],e.width*e.scale_fac,e.height*e.scale_fac,!1):N.texImage2D(t,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,e.seq_video[e.seq_cur_frame]),N.bindTexture(t,null)}function U(){return S||(S=document.createElement("canvas")),S}function k(e,t,r,n,a){a||(F(N.TEXTURE_2D),N.texImage2D(N.TEXTURE_2D,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,t)),N.bindTexture(N.TEXTURE_2D,null);var o=b(),_=y();c.draw_resized_texture(e,r,n,o,_,"NONE")}function D(e,t,r,n){for(var a=0;a<6;a++){var o=R[a],_=I[a],i=U();i.width=n,i.height=n;var s=i.getContext("2d");s.translate(n/2,n/2),"TEXTURE_CUBE_MAP_POSITIVE_X"==o?(s.rotate(Math.PI/2),s.scale(1,-1)):"TEXTURE_CUBE_MAP_NEGATIVE_X"==o?(s.rotate(Math.PI/2),s.scale(-1,1)):"TEXTURE_CUBE_MAP_POSITIVE_Y"==o||"TEXTURE_CUBE_MAP_POSITIVE_Z"==o?s.scale(1,-1):"TEXTURE_CUBE_MAP_NEGATIVE_Y"!=o&&"TEXTURE_CUBE_MAP_NEGATIVE_Z"!=o||s.scale(-1,1),s.drawImage(t,_[0]*r,_[1]*r,r,r,-n/2,-n/2,n,n),f.d3d9_canvas_resizing_hack?N.texImage2D(N[o],0,N.RGBA,n,n,0,N.RGBA,N.UNSIGNED_BYTE,new Uint8Array(s.getImageData(0,0,n,n).data.buffer)):N.texImage2D(N[o],0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,i)}}function F(e){N.bindTexture(e,null);var t,r=y();N.bindTexture(e,r),N.texParameteri(t=e,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE),N.texParameteri(t,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE),N.texParameteri(t,N.TEXTURE_MAG_FILTER,N.LINEAR),N.texParameteri(t,N.TEXTURE_MIN_FILTER,N.LINEAR)}function G(e,t,r){var a,E=e.source,u=e.w_texture,d=e.w_target,T=e.img_comp_method,S=e.img_filepath,A=1,h=1;if(N.bindTexture(d,u),e.repeat?(N.texParameteri(d,N.TEXTURE_WRAP_S,N.REPEAT),N.texParameteri(d,N.TEXTURE_WRAP_T,N.REPEAT)):(N.texParameteri(d,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE),N.texParameteri(d,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE)),N.texParameteri(d,N.TEXTURE_MIN_FILTER,e.is_movie||"NODE_TEX"==E?N.LINEAR:v[f.texture_min_filter]),e.anisotropic_filtering&&N.texParameterf(d,i.get_aniso().TEXTURE_MAX_ANISOTROPY_EXT,e.anisotropic_filtering),4==t.length){var m=!0;t=new Uint8Array([255*t[0],255*t[1],255*t[2],255*t[3]])}if("IMAGE"==E)if(m)N.texImage2D(d,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,t),e.width=1,e.height=1;else if(T){var g=o.get_width_height(t,T),I=cN(g.width)||cN(g.height);if(z(g.width,g.height))return void s.error('Image "'+S+'" has unsupported size: '+g.width+"x"+g.height+". Max available: "+p.max_texture_size+"x"+p.max_texture_size+".");A=g.width,h=g.height,(I||"pvr"==T)&&(e.need_resize=!0,F(d),A=K(A*e.scale_fac),h=K(h*e.scale_fac)),"dds"==T?o.upload_dds_levels(N,i.get_s3tc(),t,!0):"pvr"==T&&o.upload_pvr_levels(N,i.get_pvr(),t,!0),e.need_resize&&(k(e,null,A,h,!0),N.bindTexture(d,u),N.generateMipmap(d)),e.width=A,e.height=h,e.compress_ratio=o.get_compress_ratio(t,T)}else{if(N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!0),e.is_movie?f.seq_video_fallback?(A=t[0].width,h=t[0].height):(A=t.videoWidth,h=t.videoHeight):(A=t.width,h=t.height),e.width=A,e.height=h,z(A,h)&&(s.warn('Image "'+S+'" has unsupported size: '+A+"x"+h+". Max available: "+p.max_texture_size+"x"+p.max_texture_size+". Reduced image size will be used."),e.scale_fac=Math.min(p.max_texture_size/A,p.max_texture_size/h),e.need_resize=!0),e.is_movie)if(r in O||(O[r]={}),O[r][e.video_tex_name]=e,f.seq_video_fallback)e.seq_video=t,e.seq_movie_length=t.length,e.fps=e.seq_fps*e.movie_length/t.length,L=t[0];else{e.video_file=t,e.video_file.loop=e.use_cyclic,e.fps=t.duration?e.movie_length/t.duration:l.get_framerate(),P.disable_playback_rate_hack||(t.playbackRate=l.get_framerate()/e.fps,P.clamp_playback_rate_hack&&t.playbackRate>2&&(t.playbackRate=2));var L=t;(a=e).video_file.oncanplay=function(){J(a)&&C(a)}}else L=t;if(A=K(e.width*e.scale_fac),h=K(e.height*e.scale_fac),e.need_resize||f.resize_texture_canvas_hack){var Y=U(),M=Y.getContext("2d");Y.width=A,Y.height=h,M.drawImage(L,0,0,e.width,e.height,0,0,A,h),f.d3d9_canvas_resizing_hack?N.texImage2D(d,0,N.RGBA,A,h,0,N.RGBA,N.UNSIGNED_BYTE,new Uint8Array(M.getImageData(0,0,A,h).data.buffer)):N.texImage2D(d,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,Y)}else f.webgl2||!cN(e.width)&&!cN(e.height)?N.texImage2D(d,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,L):(k(e,L,A,h,!1),e.need_resize=!0);e.width=A,e.height=h,e.is_movie||(N.bindTexture(d,u),N.generateMipmap(d))}else if("ENVIRONMENT_MAP"==E)if(m){for(var x=0;x<6;x++)N.texImage2D(N["TEXTURE_CUBE_MAP_"+R[x]],0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,t);e.width=3,e.height=2}else{if(N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1),t.width%3||t.height%2)return void s.error('Cubemap Image "'+S+'" has unsupported size: '+t.width+"x"+t.height+". The width must be multiple of three and the height - multiple of two.");var w=t.width/3;if(w>p.max_cube_map_texture_size){s.warn('Cubemap Image "'+S+'" has unsupported size: '+t.width+"x"+t.height+". Max available: "+3*p.max_cube_map_texture_size+"x"+2*p.max_cube_map_texture_size+". Reduced image size will be used.");var G=K(w*(p.max_cube_map_texture_size/w));e.need_resize=!0}else G=K(w),!f.webgl2&&z(3*G,2*G)&&(e.need_resize=!0);e.need_resize||f.resize_cubemap_canvas_hack?D(0,t,w,G):function(e,t,r,n){F(N.TEXTURE_2D),N.texImage2D(N.TEXTURE_2D,0,N.RGBA,N.RGBA,N.UNSIGNED_BYTE,t),N.bindTexture(N.TEXTURE_2D,null);for(var a=0;a<6;a++)N.texImage2D(N.TEXTURE_CUBE_MAP_POSITIVE_X+a,0,N.RGBA,r,r,0,N.RGBA,N.UNSIGNED_BYTE,null);N.bindTexture(e.w_target,null);var o=b();N.bindFramebuffer(N.FRAMEBUFFER,o);var _=y();for(a=0;a<6;a++)c.draw_resized_cubemap_texture(e,N[R[a]],r,n,_,a);N.bindFramebuffer(N.FRAMEBUFFER,null),N.bindTexture(e.w_target,e.w_texture),N.texParameteri(e.w_target,N.TEXTURE_MIN_FILTER,v[f.texture_min_filter]),N.texParameteri(e.w_target,N.TEXTURE_MAG_FILTER,N.LINEAR)}(e,t,G,w),_.ff_cubemap_out_of_memory()&&(s.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),D(0,t,w,n.NVIDIA_OLD_GPU_CUBEMAP_MAX_SIZE)),e.width=3*G,e.height=2*G,N.generateMipmap(d)}else"NODE_TEX"==E&&(N.pixelStorei(N.UNPACK_FLIP_Y_WEBGL,!1),N.texImage2D(d,0,N.RGBA,t.width,t.height,0,N.RGBA,N.UNSIGNED_BYTE,t.data),e.width=t.width,e.height=t.height);N.bindTexture(d,null)}function K(e){return cN(e)?xO(Math.pow(2,(0|e).toString(2).length),2,p.max_texture_size):e}function B(e){var n;switch(e.type){case t.TT_RGBA_INT:n=N.RGBA;break;case t.TT_RGB_INT:n=N.RGB;break;case t.TT_RGBA_FLOAT:n=N.RGBA;break;case t.TT_RGB_FLOAT:n=N.RGB;break;case t.TT_DEPTH:n=N.DEPTH_COMPONENT;break;default:r.panic("Wrong texture type")}return n}function X(e){var n;switch(e.type){case t.TT_RGBA_INT:n=f.webgl2?N.RGBA8:N.RGBA;break;case t.TT_RGB_INT:n=f.webgl2?N.RGB8:N.RGB;break;case t.TT_RGBA_FLOAT:n=f.webgl2?N.RGBA32F:N.RGBA;break;case t.TT_RGB_FLOAT:n=f.webgl2?N.RGB8:N.RGB;break;case t.TT_DEPTH:n=f.webgl2?H(p.depth_bits):N.DEPTH_COMPONENT;break;default:r.panic("Wrong texture type")}return n}function H(e){var t;switch(e){case 16:t=N.DEPTH_COMPONENT16;break;case 24:t=N.DEPTH_COMPONENT24;break;case 32:t=N.DEPTH_COMPONENT32F;break;default:t=N.DEPTH_COMPONENT24}return t}function j(e){var n;switch(e.type){case t.TT_RGBA_INT:case t.TT_RGB_INT:n=N.UNSIGNED_BYTE;break;case t.TT_RGBA_FLOAT:case t.TT_RGB_FLOAT:n=N.FLOAT;break;case t.TT_DEPTH:n=N.UNSIGNED_INT;break;default:r.panic("Wrong texture type")}return n}function z(e,t){return e>p.max_texture_size||t>p.max_texture_size}function Q(e){e.video_file?e.video_file.play():e.seq_video&&(e.seq_video_played=!0),e.video_was_stopped=!1}function V(e){e.video_file?e.video_file.pause():e.seq_video&&(e.seq_video_played=!1),e.video_was_stopped=!0}function q(e){e.video_file?e.video_file.currentTime=e.frame_offset/e.fps:e.seq_video&&(e.seq_cur_frame=Z(e,e.frame_offset),w(e))}function W(e){return e.video_file?!e.video_file.paused:!!e.seq_video&&e.seq_video_played}function J(e){return e.video_file||e.seq_video?!e.video_file||e.video_file.readyState>=2:0}function Z(e,t){return Math.round(t*e.seq_movie_length/e.movie_length)}function $(e,t){if(u.is_dynamic(e))return te(e,t);for(var r=e.meta_objects,n=0;n<r.length;n++){var a=te(r[n],t);if(a)return a}return null}function ee(e,t,r){if(u.is_dynamic(e))re(e,t,r);else for(var n=e.meta_objects,a=0;a<n.length;a++)re(n[a],t,r)}function te(e,t){var r=e.scenes_data;if(r.length)for(var n=r[0].batches,a=0;a<n.length;a++){var o=n[a];if("MAIN"==o.type||"SKY"==o.type)for(var _=0;_<o.textures.length;_++)if(o.bpy_tex_names[_]==t)return o.textures[_]}return null}function re(e,t,r){var n=e.scenes_data;if(n.length)for(var a=n[0].batches,o=0;o<a.length;o++){var _=a[o];if("MAIN"==_.type)for(var i=0;i<_.textures.length;i++)if(_.bpy_tex_names[i]==t){var s=_.textures[i];_.textures[i]=r,le(s)}}}function ne(e,t){var r=e.scenes_data;if(r.length)for(var n=r[0].batches,a=0;a<n.length;a++){var o=n[a];if("MAIN"==o.type)for(var _=0;_<o.textures.length;_++){var i=o.textures[_],s=o.bpy_tex_names[_];-1==t.indexOf(s)&&"NODE_TEX"!=i.source&&t.push(s)}}}function ae(e){var t={type:0,source:"",source_id:"",width:0,height:0,compress_ratio:1,anisotropic_filtering:0,source_size:1024,enable_canvas_mipmapping:!1,canvas_context:null,w_target:0,w_texture:null,w_renderbuffer:null,is_movie:!1,vtex_data_id:-1,video_file:null,video_tex_name:"",movie_length:0,fps:0,frame_start:0,frame_offset:0,frame_duration:0,need_resize:!1,scale_fac:1,use_mipmap:!1,mipmap_count:0,seq_video:null,seq_movie_length:0,seq_fps:0,seq_cur_frame:-1,seq_video_played:!1,seq_last_discrete_mark:-1,video_was_stopped:!1,use_auto_refresh:!1,use_cyclic:!1,use_nla:!1,repeat:!0,img_full_filepath:"",img_filepath:"",img_uuid:"",img_source:"",img_name:"",img_comp_method:""};t.source="CANVAS",t.width=e.width,t.height=e.height,t.enable_canvas_mipmapping=e.enable_canvas_mipmapping,t.type=e.type;var r=document.createElement("canvas");return r.width=t.width,r.height=t.height,t.canvas_context=r.getContext("2d"),t.w_target=N.TEXTURE_2D,t.w_texture=N.createTexture(),N.bindTexture(N.TEXTURE_2D,t.w_texture),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MIN_FILTER,t.enable_canvas_mipmapping?v[f.texture_min_filter]:N.LINEAR),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MAG_FILTER,N.LINEAR),N.bindTexture(N.TEXTURE_2D,null),t}function oe(e,t,r){for(var n=e.elements,a=e.interpolation,o=0;o<t;o++){var _=o/(t-1),i=ie(n,_,!0),s=se(n,_,!0);i&&s&&("CONSTANT"==a?r.push.apply(r,i.color):_e(r,i,s,_)),s&&!i&&r.push.apply(r,s.color),i&&!s&&r.push.apply(r,i.color)}}function _e(e,t,r,n){if(t==r)e.push.apply(e,t.color);else{var a=d.linear_interpolation(r.color[0],r.position,t.color[0],t.position,n);e.push(a);var o=d.linear_interpolation(r.color[1],r.position,t.color[1],t.position,n);e.push(o);var _=d.linear_interpolation(r.color[2],r.position,t.color[2],t.position,n);e.push(_);var i=d.linear_interpolation(r.color[3],r.position,t.color[3],t.position,n);e.push(i)}}function ie(e,t,r){for(var n=null,a=0;a<e.length;a++){if(r)var o=t-e[a].position;else o=t-e[a][1][0];if(o>=0)if(n){if(r)var _=t-n.position;else _=t-e[a][1][0];o<=_&&(n=e[a])}else n=e[a]}return n}function se(e,t,r){for(var n=null,a=0;a<e.length;a++){if(r)var o=e[a].position-t;else o=e[a][1][0]-t;if(o>=0)if(n){if(r)var _=n.position-t;else _=n[1][0]-t;o<=_&&(n=e[a])}else n=e[a]}return n}function le(e){f.enable_texture_cache||function(e){for(var t=E.get_all_objects("ALL",E.DATA_ID_ALL),r=0;r<t.length;r++){var n=t[r];if(ce(n,e))return!0;for(var a=n.meta_objects,o=0;o<a.length;o++)if(ce(a[o],e))return!0}return!1}(e)||function(e){e.w_texture&&N.deleteTexture(e.w_texture);var t=m.textures.indexOf(e);-1!=t&&(m.textures.splice(t,1),m.loaded_status.splice(t,1))}(e)}function ce(e,t){for(var r=0;r<e.scenes_data.length;r++)for(var n=e.scenes_data[r].batches,a=0;a<n.length;a++)for(var o=n[a].textures,_=0;_<o.length;_++)if(o[_]==t)return!0}function Ee(e,t){for(var r=0;r<m.textures.length;r++){var n=m.textures[r];if(n.img_full_filepath==e&&n.type==t.type&&n.source==t.source&&n.repeat==t.repeat&&n.anisotropic_filtering==t.anisotropic_filtering&&n.use_nla==t.use_nla)return n}return null}t.setup_context=function(e){v=[e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR],t.TF_NEAREST=e.NEAREST,t.TF_LINEAR=e.LINEAR,t.TF_NEAREST_MIPMAP_NEAREST=e.NEAREST_MIPMAP_NEAREST,t.TF_LINEAR_MIPMAP_NEAREST=e.LINEAR_MIPMAP_NEAREST,t.TF_NEAREST_MIPMAP_LINEAR=e.NEAREST_MIPMAP_LINEAR,t.TF_LINEAR_MIPMAP_LINEAR=e.LINEAR_MIPMAP_LINEAR,N=e},t.get_canvas_context=function(e,t){return t in g&&e in g[t]?g[t][e].canvas_context:null},t.update_canvas_context=function(e,t){return t in g&&e in g[t]&&(x(g[t][e]),!0)},t.append_img_info=L,t.create_texture=M,t.create_cubemap_texture=function(e,r){var n=N.createTexture(),a=N.TEXTURE_CUBE_MAP;N.bindTexture(a,n),N.texParameteri(a,N.TEXTURE_MAG_FILTER,N.LINEAR),N.texParameteri(a,N.TEXTURE_MIN_FILTER,r?v[f.texture_min_filter]:N.LINEAR),N.texParameteri(a,N.TEXTURE_WRAP_S,N.CLAMP_TO_EDGE),N.texParameteri(a,N.TEXTURE_WRAP_T,N.CLAMP_TO_EDGE);for(var o=0;o<6;o++)N.texImage2D(N[R[o]],0,N.RGBA,e,e,0,N.RGBA,N.UNSIGNED_BYTE,null);N.bindTexture(a,null);var _={type:0,source:"",source_id:"",width:0,height:0,compress_ratio:1,anisotropic_filtering:0,source_size:1024,enable_canvas_mipmapping:!1,canvas_context:null,w_target:0,w_texture:null,w_renderbuffer:null,is_movie:!1,vtex_data_id:-1,video_file:null,video_tex_name:"",movie_length:0,fps:0,frame_start:0,frame_offset:0,frame_duration:0,need_resize:!1,scale_fac:1,use_mipmap:!1,mipmap_count:0,seq_video:null,seq_movie_length:0,seq_fps:0,seq_cur_frame:-1,seq_video_played:!1,seq_last_discrete_mark:-1,video_was_stopped:!1,use_auto_refresh:!1,use_cyclic:!1,use_nla:!1,repeat:!0,img_full_filepath:"",img_filepath:"",img_uuid:"",img_source:"",img_name:"",img_comp_method:""};return _.type=t.TT_RGBA_INT,_.source="NONE",_.width=3*e,_.height=2*e,_.compress_ratio=1,_.use_mipmap=r,_.w_texture=n,_.w_target=N.TEXTURE_CUBE_MAP,_},t.set_cubemap_tex_size=function(e,t){var r=e.w_target;N.bindTexture(r,e.w_texture);for(var n=0;n<6;n++)N.texImage2D(N[R[n]],0,N.RGBA,t,t,0,N.RGBA,N.UNSIGNED_BYTE,null);N.bindTexture(r,null),e.width=3*t,e.height=2*t},t.set_filters=function(e,t,r){var n=e.w_target;N.bindTexture(n,e.w_texture),t&&N.texParameteri(n,N.TEXTURE_MIN_FILTER,t),r&&N.texParameteri(n,N.TEXTURE_MAG_FILTER,r),N.bindTexture(n,null)},t.resize=function(e,n,a){if(n=Math.max(n,1),a=Math.max(a,1),e.width!=n||e.height!=a){switch(e.type){case t.TT_RB_RGBA:N.bindRenderbuffer(N.RENDERBUFFER,e.w_renderbuffer),N.renderbufferStorage(N.RENDERBUFFER,N.RGB565,n,a),N.bindRenderbuffer(N.RENDERBUFFER,null);break;case t.TT_RB_DEPTH:N.bindRenderbuffer(N.RENDERBUFFER,e.w_renderbuffer),N.renderbufferStorage(N.RENDERBUFFER,H(p.depth_bits),n,a),N.bindRenderbuffer(N.RENDERBUFFER,null);break;case t.TT_RB_RGBA_MS:N.bindRenderbuffer(N.RENDERBUFFER,e.w_renderbuffer),N.renderbufferStorageMultisample(N.RENDERBUFFER,f.msaa_samples,N.RGBA8,n,a),N.bindRenderbuffer(N.RENDERBUFFER,null);break;case t.TT_RB_DEPTH_MS:N.bindRenderbuffer(N.RENDERBUFFER,e.w_renderbuffer),N.renderbufferStorageMultisample(N.RENDERBUFFER,f.msaa_samples,H(p.depth_bits),n,a),N.bindRenderbuffer(N.RENDERBUFFER,null);break;default:var o=e.w_target;N.bindTexture(o,e.w_texture);var _=B(e),i=X(e),s=j(e);if(e.use_mipmap){if(!f.webgl2){var l=Math.max(n,a);n=K(l),a=K(l)}e.mipmap_count=Math.round(Math.log(Math.max(n,a))/Math.log(2)+.5)}N.texImage2D(o,0,i,n,a,0,_,s,null),N.bindTexture(o,null)}z(n,a)?r.panic('Slink texture "'+e.type+'" has unsupported size: '+n+"x"+a+". Max available: "+p.max_texture_size+"x"+p.max_texture_size+"."):(e.width=n,e.height=a)}},t.create_texture_bpy=function(e,r,n,a,o){var _=e.type;if("BLEND"==_)return null;var l=e.image,c={type:0,source:"",source_id:"",width:0,height:0,compress_ratio:1,anisotropic_filtering:0,source_size:1024,enable_canvas_mipmapping:!1,canvas_context:null,w_target:0,w_texture:null,w_renderbuffer:null,is_movie:!1,vtex_data_id:-1,video_file:null,video_tex_name:"",movie_length:0,fps:0,frame_start:0,frame_offset:0,frame_duration:0,need_resize:!1,scale_fac:1,use_mipmap:!1,mipmap_count:0,seq_video:null,seq_movie_length:0,seq_fps:0,seq_cur_frame:-1,seq_video_played:!1,seq_last_discrete_mark:-1,video_was_stopped:!1,use_auto_refresh:!1,use_cyclic:!1,use_nla:!1,repeat:!0,img_full_filepath:"",img_filepath:"",img_uuid:"",img_source:"",img_name:"",img_comp_method:""};if(c.type=t.TT_RGBA_INT,c.width=1,c.height=1,function(e,t,r){if(f.anisotropic_available){var n=t.b4w_anisotropic_filtering;if("DEFAULT"===n&&(n=r),"OFF"!==n&&f.anisotropic_filtering){var a=parseFloat(n.split("x")[0]);e.anisotropic_filtering=a}}}(c,e,r),function(e,t){("REPEAT"!=t.extension||t.b4w_shore_dist_map)&&(e.repeat=!1)}(c,e),l){"IMAGE"==_&&"MOVIE"==l.source&&function(e,t){e.is_movie=!0,e.video_tex_name=t.name,e.frame_start=t.frame_start,e.frame_offset=t.frame_offset,e.frame_duration=t.frame_duration,e.use_auto_refresh=t.use_auto_refresh,e.use_cyclic=t.use_cyclic,e.movie_length=t.movie_length,e.use_nla=t.b4w_nla_video,0!=e.frame_offset&&s.warn('Frame offset for texture "'+t.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.')}(c,e),c.source=_;var E=Ee(vI(o+l.filepath),c);if(E)return E;L(c,l,o)}var u=new Uint8Array([204,204,204,255]);switch(_){case"IMAGE":var d=N.createTexture();N.bindTexture(T=N.TEXTURE_2D,d),N.texImage2D(T,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,u);break;case"NONE":if("NONE"==e.b4w_source_type)return null;d=N.createTexture();var T=N.TEXTURE_2D;if(c.source=e.b4w_source_type,"SCENE"==c.source){if(!e.b4w_source_id)return null;var p=Wg("name",e.b4w_source_id,n);if(!p)return null;c.source_id=e.b4w_source_id,c.source_size=e.b4w_source_size,p._render_to_textures=p._render_to_textures||[],p._render_to_textures.push(c),N.bindTexture(T,d),N.texImage2D(T,0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,u)}else"CANVAS"==c.source&&(function(e,t,r){var n=t.b4w_source_id,a=t.b4w_source_size;e.source_id=n,e.enable_canvas_mipmapping=t.b4w_enable_canvas_mipmapping;var o=document.createElement("canvas");o.width=a,o.height=a,e.canvas_context=o.getContext("2d"),r in g||(g[r]={}),g[r][n]=e}(c,e,a),N.bindTexture(T,d));break;case"ENVIRONMENT_MAP":d=N.createTexture(),N.bindTexture(T=N.TEXTURE_CUBE_MAP,d);for(var P=["POSITIVE_X","NEGATIVE_X","POSITIVE_Y","NEGATIVE_Y","POSITIVE_Z","NEGATIVE_Z"],S=0;S<6;S++)N.texImage2D(N["TEXTURE_CUBE_MAP_"+P[S]],0,N.RGBA,1,1,0,N.RGBA,N.UNSIGNED_BYTE,u);break;default:return s.error('texture "'+e.name+'" has unsupported type "'+_+'"'),null}return c.w_texture=d,c.w_target=T,"NONE"==_?(N.texParameteri(T,N.TEXTURE_MIN_FILTER,c.enable_canvas_mipmapping?v[f.texture_min_filter]:N.LINEAR),c.anisotropic_filtering&&N.texParameterf(T,i.get_aniso().TEXTURE_MAX_ANISOTROPY_EXT,c.anisotropic_filtering),"CANVAS"==c.source&&x(c)):(N.generateMipmap(T),N.bindTexture(T,null)),c},t.update_texture_canvas=x,t.update_video_texture=C,t.update_seq_video_texture=w,t.update_texture=G,t.calc_pot_size=K,t.is_texture=function(e){return!(!e||!e.w_texture&&!e.w_renderbuffer)},t.is_renderbuffer=function(e){return!(!e||!e.w_renderbuffer)},t.is_float=function(e){return e.type==t.TT_RGBA_FLOAT||e.type==t.TT_RGB_FLOAT},t.get_texture_texel_size=function(e){var r=0;switch(e.type){case t.TT_RGBA_INT:case t.TT_RGB_INT:r=4;break;case t.TT_RGBA_FLOAT:case t.TT_RGB_FLOAT:r=32;break;case t.TT_DEPTH:r=3;break;case t.TT_RB_RGBA:case t.TT_RB_DEPTH:r=2;break;case t.TT_RB_RGBA_MS:r=4*f.msaa_samples;break;case t.TT_RB_DEPTH_MS:r=3*f.msaa_samples}return r},t.cleanup=function(){if(!f.seq_video_fallback)for(var e in O)for(var t in O[e])O[e][t].video_file.pause(),O[e][t].video_file.src="",O[e][t].video_file.load();m.textures.length=0,m.loaded_status.length=0,g={},O={}},t.pause=function(){for(var e in O)for(var t in O[e]){var r=O[e][t];W(r)&&V(r)}},t.reset=function(){for(var e in O)for(var t in O[e])q(O[e][t])},t.play=function(e){for(var t in O)for(var r in O[t]){var n=O[t][r];e&&!n.video_was_stopped||Q(n)}},t.get_video_texture=function(e,t){return t in O&&e in O[t]?O[t][e]:null},t.video_allow_nla=function(e){return e.use_nla},t.play_video=Q,t.pause_video=V,t.reset_video=q,t.set_frame_video=function(e,t,r){if(r in O&&e in O[r]){var n=O[r][e];return n.video_file?n.video_file.currentTime=t/n.fps:n.seq_video&&(n.seq_cur_frame=t,w(n)),!0}return!1},t.video_is_played=W,t.video_update_is_available=J,t.video_get_current_frame=function(e){return e.video_file||e.seq_video?e.video_file?Math.round(e.video_file.currentTime*e.fps):e.seq_cur_frame:0},t.video_get_start_frame=function(e){return e.video_file||e.seq_video?e.video_file?e.frame_offset:Z(e,e.frame_offset):0},t.video_get_end_frame=function(e){if(!e.video_file&&!e.seq_video)return 0;var t=Math.min(e.frame_duration,e.movie_length-e.frame_offset);return e.video_file?e.frame_offset+t:Z(e,e.frame_offset+t)},t.seq_video_get_discrete_timemark=function(e,t){return Math.round(t*e.seq_fps*(l.get_framerate()/e.fps))},t.video_get_duration=function(e){return Math.min(e.frame_duration,e.movie_length-e.frame_offset)},t.video_frame_to_seq_frame=Z,t.get_canvas_context_by_object=function(e,t){var r=$(e,t);return r&&"CANVAS"==r.source?r.canvas_context:null},t.get_texture_by_name=$,t.set_texture_by_name=ee,t.get_texture_names=function(e){var t=[];if(u.is_dynamic(e))ne(e,t);else for(var r=e.meta_objects,n=0;n<r.length;n++)ne(r[n],t);return t},t.share_batch_canvas_textures=function(e){for(var t={},r=0;r<e.length;r++){for(var n=e[r].textures,a=e[r].texture_names,o=[],_=[],i=0;i<n.length;i++){var s=n[i],l=a[i];"CANVAS"==s.source&&(l in t?s=t[l]:((c=s=ae(n[i])).canvas_context.drawImage(n[i].canvas_context.canvas,0,0),x(c),t[l]=s)),o.push(s),_.push(l)}e[r].textures=o}var c},t.extract_col_ramps_data=function(e,t){for(var r=[],n=0;n<e.length;n++)oe(e[n].data.value.color_ramp,t,r);return new Uint8Array(r.map((function(e){return xO(255*e,0,255)})))},t.calc_color_ramp_data=oe,t.extract_vec_curves_data=function(e,t){for(var r=new Float32Array(3),n=new Float32Array(3),a=[],o=0;o<e.length;o++){for(var _=e[o].data.value,i=[],s=_.curve_mapping.curves_data,l=_.curve_mapping.curve_extend,c=_.curve_mapping.curves_handle_types,E=0;E<s.length;E++){for(var u=l[E],T=s[E],f=[],p=c[E],P=0;P<T.length;P++)f.push([new Float32Array(3),new Float32Array(T[P].concat(0)),new Float32Array(3)]);for(d.calchandle_curvemap(f[0],null,f[1],p[0],p[0]),P=1;P<f.length-1;P++)d.calchandle_curvemap(f[P],f[P-1],f[P+1],p[P],p[P]);if(d.calchandle_curvemap(f[f.length-1],f[f.length-2],null,p[f.length-1],p[f.length-1]),f.length>2){if("AUTO"==p[0]){dh(f[0][2],f[0][1],r);var S=mh(r);ch(f[1][0],n),n[0]<f[0][1][0]&&(n[0]=f[0][1][0]),dh(n,f[0][1],n),(A=mh(n))>1e-8&&(Sh(n,S/A,n),uh(f[0][1],n,f[0][2]),dh(f[0][1],n,f[0][0]))}var A,h=f.length-1;"AUTO"==p[0]&&(dh(f[h][0],f[h][1],r),S=mh(r),ch(f[h-1][2],n),n[0]>f[h][1][0]&&(n[0]=f[h][1][0]),dh(n,f[h][1],n),(A=mh(n))>1e-8&&(Sh(n,S/A,n),uh(f[h][1],n,f[h][0]),dh(f[h][1],n,f[h][2])))}for(h=0;h<f.length-1;h++)d.correct_bezpart(f[h][1],f[h][2],f[h+1][0],f[h+1][1]);var v=[];if(s.length<=3)var m=Math.round(-t/2),g=Math.round(t/2);else m=0,g=t;for(P=m;P<g;P++){var O=P/(g-1),N=ie(f,O,!1),R=se(f,O,!1);if(N&&R)v.push(d.bezier(O,N[1],N[2],R[0],R[1],.001));else if(R&&!N)if("EXTRAPOLATED"==u){var I=R[1][0]==R[2][0]?R[1][1]:d.linear(O,R[1],R[2]);v.push(I)}else v.push(R[1][1]);else N&&!R&&("EXTRAPOLATED"==u?(I=N[0][0]==N[1][0]?N[1][1]:d.linear(O,N[0],N[1]),v.push(I)):v.push(N[1][1]))}i.push(v)}a.push(i)}var b=[];for(P=0;P<a.length;P++)for(i=a[P],E=0;E<i[0].length;E++){if(i.length<=3){var y=xO(127.5*(i[0][E]+1),0,255),L=xO(127.5*(i[1][E]+1),0,255),Y=xO(127.5*(i[2][E]+1),0,255);h=255}else y=xO(255*i[0][E],0,255),L=xO(255*i[1][E],0,255),Y=xO(255*i[2][E],0,255),h=xO(255*i[3][E],0,255);b.push(y,L,Y,h)}return new Uint8Array(b)},t.create_color_ramp_texture=function(e,r){var n=M(t.TT_RGBA_INT,!1);return n.source="NODE_TEX",n.repeat=!1,G(n,{width:r,height:e.length/(4*r),data:e}),n},t.change_image=function(e,t,r,n,a){var o=vI(a);if("WORLD"!=e.type){var _=Ee(o,t);if(_)var i=_;else!function(e,t){N.bindTexture(e.w_target,e.w_texture);var r=N.getTexParameter(e.w_target,N.TEXTURE_MAG_FILTER),n=N.getTexParameter(e.w_target,N.TEXTURE_MIN_FILTER),a=N.getTexParameter(e.w_target,N.TEXTURE_WRAP_S),o=N.getTexParameter(e.w_target,N.TEXTURE_WRAP_T);t.w_texture=N.createTexture(),N.bindTexture(t.w_target,t.w_texture),N.texParameteri(t.w_target,N.TEXTURE_MAG_FILTER,r),N.texParameteri(t.w_target,N.TEXTURE_MIN_FILTER,n),N.texParameteri(t.w_target,N.TEXTURE_WRAP_S,a),N.texParameteri(t.w_target,N.TEXTURE_WRAP_T,o),N.bindTexture(t.w_target,null)}(t,i=function(e){var t={type:0,source:"",source_id:"",width:0,height:0,compress_ratio:1,anisotropic_filtering:0,source_size:1024,enable_canvas_mipmapping:!1,canvas_context:null,w_target:0,w_texture:null,w_renderbuffer:null,is_movie:!1,vtex_data_id:-1,video_file:null,video_tex_name:"",movie_length:0,fps:0,frame_start:0,frame_offset:0,frame_duration:0,need_resize:!1,scale_fac:1,use_mipmap:!1,mipmap_count:0,seq_video:null,seq_movie_length:0,seq_fps:0,seq_cur_frame:-1,seq_video_played:!1,seq_last_discrete_mark:-1,video_was_stopped:!1,use_auto_refresh:!1,use_cyclic:!1,use_nla:!1,repeat:!0,img_full_filepath:"",img_filepath:"",img_uuid:"",img_source:"",img_name:"",img_comp_method:""};return t.type=e.type,t.anisotropic_filtering=e.anisotropic_filtering,t.source=e.source,t.source_id=e.source_id,t.width=e.width,t.height=e.height,t.compress_ratio=e.compress_ratio,t.source_size=e.source_size,t.enable_canvas_mipmapping=e.enable_canvas_mipmapping,t.canvas_context=e.canvas_context,t.w_target=e.w_target,t.w_texture=e.w_texture,t.w_renderbuffer=e.w_renderbuffer,t.is_movie=e.is_movie,t.vtex_data_id=e.vtex_data_id,t.video_file=e.video_file,t.video_tex_name=e.video_tex_name,t.movie_length=e.movie_length,t.fps=e.fps,t.frame_start=e.frame_start,t.frame_offset=e.frame_offset,t.frame_duration=e.frame_duration,t.need_resize=e.need_resize,t.scale_fac=e.scale_fac,t.seq_video=e.seq_video,t.seq_movie_length=e.seq_movie_length,t.seq_fps=e.seq_fps,t.seq_cur_frame=e.seq_cur_frame,t.seq_video_played=e.seq_video_played,t.seq_last_discrete_mark=e.seq_last_discrete_mark,t.video_was_stopped=e.video_was_stopped,t.use_auto_refresh=e.use_auto_refresh,t.use_cyclic=e.use_cyclic,t.use_nla=e.use_nla,t.repeat=e.repeat,t.img_filepath=e.img_filepath,t.img_full_filepath=e.img_full_filepath,t.img_uuid=e.img_uuid,t.img_source=e.img_source,t.img_name=e.img_name,t.img_comp_method=e.img_comp_method,t}(t)),Y(i,a,o),G(i,n,0);ee(e,r,i)}else Y(i=t,a,o),G(i,n,0),T.update_cube_sky_dim(e,i),T.update_sky_texture(e)},t.cleanup_unused=le,t.get_batch_texture=function(e){return e.texture._render},t.reset_mod=function(){N=null},t.get_img_textures=function(){return m.textures},t.get_cache_loaded_status=function(e){var t=m.textures.indexOf(e);return-1!=t&&m.loaded_status[t]},t.set_cache_loaded_status=function(e,t){var r=m.textures.indexOf(e);-1!=r&&(m.loaded_status[r]=t)}})),HI=nA("__debug_check",(function(e,t){var r=gN(e),n=dR(e),a=mN(e),o=XI(e),_=n.defaults,i=-1,s=-1,l=null,c=[];t.setup_context=function(e){for(var t=["INVALID_ENUM","INVALID_VALUE","INVALID_OPERATION","OUT_OF_MEMORY","INVALID_FRAMEBUFFER_OPERATION","CONTEXT_LOST_WEBGL"],r=0;r<t.length;r++){var n=t[r];n in e&&(c[e[n]]=n)}l=e},t.browser=function(e){switch(e.toLowerCase()){case"chrome":return E("mozilla")&&E("applewebkit")&&E("chrome");case"firefox":return E("mozilla")&&E("gecko")&&E("firefox");case"msie":return E("mozilla")&&E("trident")&&E("msie");case"opera":return E("opera")&&E("presto");case"safari":return E("mozilla")&&E("applewebkit")&&E("safari")&&!E("chrome");default:return!1}};var E=function(e){return navigator.userAgent.toLowerCase().indexOf(e)>-1};t.finite=function(e){if(DO(e)){for(var t=0;t<e.length;t++)if(!isFinite(e[t]))return!1;return Boolean(e.length)}return!!isFinite(e)},t.gl=function(e){if(_.gl_debug){var t=l.getError();t!=l.NO_ERROR&&r.panic(t in c?"GL Error: "+t+", gl."+c[t]+" ("+e+")":"Unknown GL error: "+t+" ("+e+")")}},t.bound_fb=function(){if(!_.gl_debug&&!_.check_framebuffer_hack)return!0;switch(l.checkFramebufferStatus(l.FRAMEBUFFER)){case l.FRAMEBUFFER_COMPLETE:return!0;case l.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return a.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT"),!1;case l.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return a.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT"),!1;case l.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return a.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS"),!1;case l.FRAMEBUFFER_UNSUPPORTED:return a.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED"),!1;case l.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:return a.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE"),!1;default:return a.error("FRAMEBUFFER CHECK FAILED"),!1}},t.depth_only_issue=function(){if(-1!=s)return s;var e=l.createFramebuffer();l.bindFramebuffer(l.FRAMEBUFFER,e);var t=o.create_texture(o.TT_DEPTH,!1);return o.resize(t,1,1),l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,t.w_target,t.w_texture,0),l.checkFramebufferStatus(l.FRAMEBUFFER)!=l.FRAMEBUFFER_COMPLETE?(s=!0,a.warn("depth-only issue was found")):s=!1,l.bindFramebuffer(l.FRAMEBUFFER,null),l.deleteFramebuffer(e),s},t.multisample_issue=function(){if(1==_.msaa_samples)return!1;if(-1!=i)return i;var e=l.createRenderbuffer();l.bindRenderbuffer(l.RENDERBUFFER,e),l.renderbufferStorageMultisample(l.RENDERBUFFER,_.msaa_samples,l.RGBA8,1,1);var t=l.getRenderbufferParameter(l.RENDERBUFFER,l.RENDERBUFFER_SAMPLES);return t!=_.msaa_samples?(i=!0,a.warn("multisample issue was found: requested "+_.msaa_samples+", got "+t),l.getError()==l.INVALID_OPERATION&&a.warn("the error from multisample issue detected, ignoring")):i=!1,l.bindRenderbuffer(l.RENDERBUFFER,null),i},t.ff_cubemap_out_of_memory=function(){return!(!E("firefox")||l.getError()!=l.OUT_OF_MEMORY||(a.warn("Firefox/old GPUs cubemap issue was found."),0))},t.reset=function(){l=null}})),jI=nA("__compat",(function(e,t){var r=dR(e),n=HI(e),a=fR(e),o=mN(e),_=tI(e),i=["R600","RV610","RV630","RV620","RV635","RV670","RS780","RS880","RV770","RV730","RV710","RV740","CEDAR","REDWOOD","JUNIPER","CYPRESS","PALM (Wrestler/Ontario)","SUMO (Llano)","SUMO2 (Llano)","ARUBA (Trinity/Richland)","BARTS","TURKS","CAICOS","CAYMAN"];t.NVIDIA_OLD_GPU_CUBEMAP_MAX_SIZE=256;var s=r.animation,l=r.defaults,c=r.debug_subs,E=r.context,u=r.context_limits,d=r.sfx,T=r.physics,f=r.assets;function p(e){return navigator.userAgent.indexOf(e)>-1}function P(){return navigator.userAgent.match(/Windows Phone/i)||navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)}function S(){return!window.ActiveXObject&&"ActiveXObject"in window}t.detect_tegra_invalid_enum_issue=function(e){e.getError()==e.INVALID_ENUM&&o.warn("Possible Tegra invalid enum issue detected, ignoring")},t.set_hardware_defaults=function(e,A){var h=function(e){A&&o.warn(e)};u.max_combined_texture_image_units=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),u.max_fragment_uniform_vectors=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),u.max_texture_image_units=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),u.max_varying_vectors=e.getParameter(e.MAX_VARYING_VECTORS),u.max_vertex_attribs=e.getParameter(e.MAX_VERTEX_ATTRIBS),u.max_vertex_texture_image_units=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),u.max_vertex_uniform_vectors=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),u.max_cube_map_texture_size=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),u.max_renderbuffer_size=e.getParameter(e.MAX_RENDERBUFFER_SIZE),u.max_texture_size=e.getParameter(e.MAX_TEXTURE_SIZE),u.max_viewport_dims=e.getParameter(e.MAX_VIEWPORT_DIMS);var v=a.get_renderer_info();if(v){var m=e.getParameter(v.UNMASKED_VENDOR_WEBGL),g=e.getParameter(v.UNMASKED_RENDERER_WEBGL);m.indexOf("Qualcomm")>-1&&g.indexOf("330")>-1&&(p("Chrome")||p("Firefox"))&&(h("Chrome/Firefox and Qualcomm 330 detected, force enable WebGL 1, disable blending cascaded shadow maps."),l.webgl2=!1,l.chrome_csm_blend_hack=!0)}u.depth_bits=l.webgl2?24:16,l.webgl2&&!c.enabled&&(l.compared_mode_depth=!0),l.webgl2?(l.msaa_samples=Math.min(l.msaa_samples,e.getParameter(e.MAX_SAMPLES)),p("Firefox")&&(h("Firefox and WebGL 2 detected, applying framebuffer hack."),l.check_framebuffer_hack=!0),p("Windows")&&p("Chrome")&&(h("Windows, Chrome and WebGL 2 detected, applying multisample hack, disabling MSAA."),l.msaa_samples=1)):l.msaa_samples=1,p("Firefox")&&"NONE"!==l.stereo&&(h("Firefox and Stereo rendering detected, disable texture reusage"),l.firefox_tex_reuse_hack=!0),(l.webgl2&&n.multisample_issue()||p("Firefox"))&&(h("Firefox detected, disabling multisample"),l.msaa_samples=1),p("Mac OS X")&&p("Chrome/60")&&(h("macOS and Chrome 60 detected, disabling multisample"),l.msaa_samples=1),_.set_draw_methods();var O=Boolean(a.get_depth_texture());if(p("Firefox/28.0")&&(p("Linux")||p("Macintosh"))&&(h("Firefox 28 detected, applying depth hack"),O=!1),p("Windows Phone")||(p("iPad")||p("iPhone")?(h("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),E.alpha||(l.background_color[3]=1),l.ios_copy_tex_hack=!0,l.vert_anim_mix_normals_hack=!0,l.smaa=!1,l.ssao=!1,l.init_wa_context_hack=!0,Boolean(a.get_pvr())&&f.pvr_available&&(l.compress_format="pvr")):p("Mac OS X")&&p("Safari")&&!p("Chrome")&&(h("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),l.safari_canvas_alpha_hack=!0,d.audio_loading_hack=!0,d.clamp_playback_rate_hack=!0)),p("Windows")&&(p("Chrome/40")||p("Firefox/33")||p("Firefox/34")||p("Firefox/35")||p("Firefox/36"))&&(h("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),l.clear_procedural_sky_hack=!0),p("Chrome")&&!P()&&r.is_built_in_data()&&(h('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),l.chrome_html_bkg_music_hack=!0),p("Mac OS X")&&(l.mac_os_shadow_hack=!0,h("OS X detected, applying shadows hack")),P()&&(h("Mobile detected, applying various hacks for video textures."),l.is_mobile_device=!0,p("iPad")||p("iPhone")||p("Windows Phone")||(h("Mobile (not iOS) detected, disable playback rate for video textures."),d.disable_playback_rate_hack=!0)),p("iPad")&&(h('iPad detected, use "autoplay" hack for video textures.'),l.ipad_video_hack=!0),(p("Firefox/35.0")||p("Firefox/36.0"))&&p("Windows")&&(h("Windows/Firefox 35/36 detected, applying shadows slink hack"),l.shadows_color_slink_hack=!0),(p("iPhone")||S())&&(h("iPhone or IE11 detected. Enable sequential video fallback for video textures."),l.seq_video_fallback=!0),u.max_varying_vectors<10&&(h("Not enough varyings, disable shadows on blend objects"),l.disable_blend_shadows_hack=!0),p("Windows Phone")&&(h("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),l.debug_view=!1,l.glow_materials=!1,l.ssao=!1,l.smaa=!1,l.shadows=!1,l.reflections=!1,l.refractions=!1,l.quality_aa_method=!1),(p("UCBrowser")||p("Chrome")&&p("Nexus")&&l.is_mobile_device)&&(h("Mobile Nexus Chrome or UCBrowser detected, disable workers."),T.use_workers=!1),p("Firefox")&&(h("Firefox detected, disabling workers"),T.use_workers=!1),(S()||p("Edge"))&&(h("IE11 or Edge detected, disabling workers"),T.use_workers=!1),p("Chrome")&&p("Linux")&&(h("Chrome and Linux detected, disabling wasm physics."),T.use_wasm=!1),v){m=e.getParameter(v.UNMASKED_VENDOR_WEBGL),g=e.getParameter(v.UNMASKED_RENDERER_WEBGL),m.indexOf("Intel")&&(g.indexOf("3000")>-1||g.indexOf("2000")>-1)&&(l.reuse_depth_optimization=!1,h("Intel HD Graphics 2000/3000 detected, disable depth reuse.")),p("Chrome")&&g.indexOf("Mali-T720")>-1&&(h('Chrome and ARM Mali-T720 detected, changing "Alpha Anti-Aliasing" materials to "Alpha Clip".'),l.mali_alpha_antialias_hack=!0),g.indexOf("AMD")>-1&&p("Windows")&&p("Firefox")&&(h("AMD, Windows and Firefox detected, disabling depth textures."),O=!1),m.indexOf("ARM")>-1&&/\b4\d{2}\b/.test(g)&&(h("ARM Mali-400 series detected, applying lamps, depth and frames blending hacks"),O=!1,s.frames_blending_hack=!0,l.mali4_lamps_hack=!0),m.indexOf("ARM")>-1&&g.indexOf("Mali-T604")>-1&&(h("ARM Mali-T604 detected, disabling shadows."),l.shadows=!1),m.indexOf("ARM")>-1&&g.indexOf("Mali-T760")>-1&&(h("ARM Mali-T760 detected, disabling SSAO."),l.ssao=!1,l.skinning_hack=!0,l.webgl2&&(l.msaa_samples=1,h("ARM Mali-T760 and WebGL 2 detected, switching MSAA samples to 1."))),m.indexOf("ARM")>-1&&g.indexOf("Mali-T720")>-1&&(h("ARM Mali-T720 detected, disabling depth textures."),O=!1,l.webgl2&&(l.msaa_samples=1,h("ARM Mali-T720 and WebGL 2 detected, switching MSAA samples to 1."))),m.indexOf("Qualcomm")>-1&&g.indexOf("Adreno")>-1&&(h("Qualcomm Adreno detected, applying shader constants hack."),l.shader_constants_hack=!0,g.indexOf("420")>-1&&(h("Qualcomm Adreno420 detected, setting max cubemap size to 12288x8192, setting max texture size to 4096x4096."),u.max_texture_size=Math.min(u.max_texture_size,4096),u.max_cube_map_texture_size=Math.min(u.max_cube_map_texture_size,4096)),p("Chrome")&&(g.match(/4../)||g.match(/5../))&&(h("Qualcomm Adreno 4xx or 5xx detected, switch MSAA samples to 1."),l.msaa_samples=1)),m.indexOf("NVIDIA")>-1&&g.indexOf("Tegra 3")>-1&&(h("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),l.force_low_quality_nodes=!0),p("Windows")&&p("Chrome")&&!p("Edge")&&(g.match(/NVIDIA GeForce 8..0/)||g.match(/NVIDIA GeForce 9..0/)||g.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(h("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 768x512, use canvas for resizing."),u.max_cube_map_texture_size=t.NVIDIA_OLD_GPU_CUBEMAP_MAX_SIZE,l.resize_cubemap_canvas_hack=!0),g.indexOf("PowerVR")>-1&&g.indexOf("SGX")>-1&&(h("PowerVR SGX series detected, use canvas for resizing. Disable shadows. Apply skinning hack, disable skin blending between frames."),l.resize_cubemap_canvas_hack=!0,l.skinning_hack=!0,l.shadows=!1),p("Windows")&&g.indexOf("Direct3D9")>-1&&(h("DirectX 9.0 detected, using canvas for resizing textures/cubemap textures."),l.d3d9_canvas_resizing_hack=!0,l.resize_cubemap_canvas_hack=!0,l.resize_texture_canvas_hack=!0);for(var N="",R=0;R<i.length;R++)if(g.indexOf(i[R])>-1){N=i[R];break}N&&(h("Architecture "+N+" detected. Blending between frames and shadows on blend objects will be disabled."),l.skinning_hack=!0,l.disable_blend_shadows_hack=!0)}if(0==u.max_vertex_texture_image_units&&(h("Vertex textures are not allowed. Disabling vertex textures"),l.allow_vertex_textures=!1),O||(l.foam=!1,l.dynamic_grass=!1,l.water_dynamic=!1,l.shore_smoothing=!1,l.shore_distance=!1,l.smaa=!1,l.ssao=!1,l.rgba_fallback_shadows=!0),l.use_compression=Boolean(a.get_s3tc())||"pvr"==l.compress_format,l.depth_tex_available=O,e.getShaderPrecisionFormat)var I=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);e.getShaderPrecisionFormat&&0!==I.precision||(l.precision="mediump"),(S()&&p("Touch")||p("Edge"))&&(h("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),l.ie11_edge_touchscreen_hack=!0),(S()||p("Edge"))&&(l.ie_edge_anchors_floor_hack=!0,l.ie11_edge_mouseoffset_hack=!0,l.resize_cubemap_canvas_hack=!0),P()&&p("Firefox")&&(o.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 12288x8192, setting max texture size to 4096x4096."),l.mobile_firefox_media_hack=!0,u.max_texture_size=Math.min(u.max_texture_size,4096),u.max_cube_map_texture_size=Math.min(u.max_cube_map_texture_size,4096));var b=Boolean(a.get_aniso());l.anisotropic_available=b;var y=Boolean(a.get_texture_lod());l.texture_lod_available=y;var L=Boolean(a.get_texture_float());l.tex_float_available=L;var Y=Boolean(a.get_texture_half_float());l.tex_hfloat_available=Y;var M=Boolean(a.get_texture_float_linear());l.tex_float_lin_available=M;var x=Boolean(a.get_texture_half_float_linear());l.tex_hfloat_lin_available=x;var C=Boolean(a.get_color_buffer_float());l.cbuffer_float_available=C;var w=Boolean(a.get_color_buffer_half_float());l.cbuffer_hfloat_available=w},t.check_user_agent=p,t.detect_mobile=P,t.apply_context_alpha_hack=function(){p("Firefox/35.0")&&p("Windows")&&(o.warn("Windows/Firefox 35 detected, forcing context's alpha"),r.context.alpha=!0)},t.is_ie11=S}));!function(e){("undefined"!=typeof window?window:"undefined"!=typeof self?self:this).pako=function e(t,r,n){function a(_,i){if(!r[_]){if(!t[_]){if(o)return o(_,!0);var s=new Error("Cannot find module '"+_+"'");throw s.code="MODULE_NOT_FOUND",s}var l=r[_]={exports:{}};t[_][0].call(l.exports,(function(e){return a(t[_][1][e]||e)}),l,l.exports,e,t,r,n)}return r[_].exports}for(var o=!1,_=0;_<n.length;_++)a(n[_]);return a}({1:[function(e,t,r){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,r,n,a){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),a);else for(var o=0;o<n;o++)e[a+o]=t[r+o]},flattenChunks:function(e){var t,r,n,a,o,_;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(_=new Uint8Array(n),a=0,t=0,r=e.length;t<r;t++)_.set(o=e[t],a),a+=o.length;return _}},o={arraySet:function(e,t,r,n,a){for(var o=0;o<n;o++)e[a+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,a)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(n)},{}],2:[function(e,t,r){var n=e("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(l){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(l){o=!1}for(var _=new n.Buf8(256),i=0;i<256;i++)_[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;function s(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&a))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var r="",_=0;_<t;_++)r+=String.fromCharCode(e[_]);return r}_[254]=_[254]=1,r.string2buf=function(e){var t,r,a,o,_,i=e.length,s=0;for(o=0;o<i;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<i&&56320==(64512&(a=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(a-56320),o++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new n.Buf8(s),_=0,o=0;_<s;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<i&&56320==(64512&(a=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(a-56320),o++),r<128?t[_++]=r:r<2048?(t[_++]=192|r>>>6,t[_++]=128|63&r):r<65536?(t[_++]=224|r>>>12,t[_++]=128|r>>>6&63,t[_++]=128|63&r):(t[_++]=240|r>>>18,t[_++]=128|r>>>12&63,t[_++]=128|r>>>6&63,t[_++]=128|63&r);return t},r.buf2binstring=function(e){return s(e,e.length)},r.binstring2buf=function(e){for(var t=new n.Buf8(e.length),r=0,a=t.length;r<a;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,n,a,o,i=t||e.length,l=new Array(2*i);for(n=0,r=0;r<i;)if((a=e[r++])<128)l[n++]=a;else if((o=_[a])>4)l[n++]=65533,r+=o-1;else{for(a&=2===o?31:3===o?15:7;o>1&&r<i;)a=a<<6|63&e[r++],o--;o>1?l[n++]=65533:a<65536?l[n++]=a:(l[n++]=55296|(a-=65536)>>10&1023,l[n++]=56320|1023&a)}return s(l,n)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+_[e[r]]>t?r:t}},{"./common":1}],3:[function(e,t,r){t.exports=function(e,t,r,n){for(var a=65535&e|0,o=e>>>16&65535|0,_=0;0!==r;){r-=_=r>2e3?2e3:r;do{o=o+(a=a+t[n++]|0)|0}while(--_);a%=65521,o%=65521}return a|o<<16|0}},{}],4:[function(e,t,r){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],5:[function(e,t,r){var n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,a){var o=n,_=a+r;e^=-1;for(var i=a;i<_;i++)e=e>>>8^o[255&(e^t[i])];return-1^e}},{}],6:[function(e,t,r){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],7:[function(e,t,r){t.exports=function(e,t){var r,n,a,o,_,i,s,l,c,E,u,d,T,f,p,P,S,A,h,v,m,g,O,N,R;N=e.input,a=(n=e.next_in)+(e.avail_in-5),R=e.output,_=(o=e.next_out)-(t-e.avail_out),i=o+(e.avail_out-257),s=(r=e.state).dmax,l=r.wsize,c=r.whave,E=r.wnext,u=r.window,d=r.hold,T=r.bits,f=r.lencode,p=r.distcode,P=(1<<r.lenbits)-1,S=(1<<r.distbits)-1;e:do{T<15&&(d+=N[n++]<<T,d+=N[n++]<<(T+=8),T+=8),A=f[d&P];t:for(;;){if(d>>>=h=A>>>24,T-=h,0==(h=A>>>16&255))R[o++]=65535&A;else{if(!(16&h)){if(0==(64&h)){A=f[(65535&A)+(d&(1<<h)-1)];continue t}if(32&h){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}v=65535&A,(h&=15)&&(T<h&&(d+=N[n++]<<T,T+=8),v+=d&(1<<h)-1,d>>>=h,T-=h),T<15&&(d+=N[n++]<<T,d+=N[n++]<<(T+=8),T+=8),A=p[d&S];r:for(;;){if(d>>>=h=A>>>24,T-=h,!(16&(h=A>>>16&255))){if(0==(64&h)){A=p[(65535&A)+(d&(1<<h)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(m=65535&A,T<(h&=15)&&(d+=N[n++]<<T,(T+=8)<h&&(d+=N[n++]<<T,T+=8)),(m+=d&(1<<h)-1)>s){e.msg="invalid distance too far back",r.mode=30;break e}if(d>>>=h,T-=h,m>(h=o-_)){if((h=m-h)>c&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(g=0,O=u,0===E){if(g+=l-h,h<v){v-=h;do{R[o++]=u[g++]}while(--h);g=o-m,O=R}}else if(E<h){if(g+=l+E-h,(h-=E)<v){v-=h;do{R[o++]=u[g++]}while(--h);if(g=0,E<v){v-=h=E;do{R[o++]=u[g++]}while(--h);g=o-m,O=R}}}else if(g+=E-h,h<v){v-=h;do{R[o++]=u[g++]}while(--h);g=o-m,O=R}for(;v>2;)R[o++]=O[g++],R[o++]=O[g++],R[o++]=O[g++],v-=3;v&&(R[o++]=O[g++],v>1&&(R[o++]=O[g++]))}else{g=o-m;do{R[o++]=R[g++],R[o++]=R[g++],R[o++]=R[g++],v-=3}while(v>2);v&&(R[o++]=R[g++],v>1&&(R[o++]=R[g++]))}break}}break}}while(n<a&&o<i);d&=(1<<(T-=(v=T>>3)<<3))-1,e.next_in=n-=v,e.next_out=o,e.avail_in=n<a?a-n+5:5-(n-a),e.avail_out=o<i?i-o+257:257-(o-i),r.hold=d,r.bits=T}},{}],8:[function(e,t,r){var n=e("../utils/common"),a=e("./adler32"),o=e("./crc32"),_=e("./inffast"),i=e("./inftrees");function s(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function l(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function c(e){var t;return e&&e.state?(e.total_in=e.total_out=(t=e.state).total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(852),t.distcode=t.distdyn=new n.Buf32(592),t.sane=1,t.back=-1,0):-2}function E(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,c(e)):-2}function u(e,t){var r,n;return e&&e.state?(t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==(n=e.state).window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,E(e))):-2}function d(e,t){var r,n;return e?(n=new l,e.state=n,n.window=null,0!==(r=u(e,t))&&(e.state=null),r):-2}var T,f,p=!0;function P(e){if(p){var t;for(T=new n.Buf32(512),f=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(i(1,e.lens,0,288,T,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;i(2,e.lens,0,32,f,0,e.work,{bits:5}),p=!1}e.lencode=T,e.lenbits=9,e.distcode=f,e.distbits=5}function S(e,t,r,a){var o,_=e.state;return null===_.window&&(_.wsize=1<<_.wbits,_.wnext=0,_.whave=0,_.window=new n.Buf8(_.wsize)),a>=_.wsize?(n.arraySet(_.window,t,r-_.wsize,_.wsize,0),_.wnext=0,_.whave=_.wsize):((o=_.wsize-_.wnext)>a&&(o=a),n.arraySet(_.window,t,r-a,o,_.wnext),(a-=o)?(n.arraySet(_.window,t,r-a,a,0),_.wnext=a,_.whave=_.wsize):(_.wnext+=o,_.wnext===_.wsize&&(_.wnext=0),_.whave<_.wsize&&(_.whave+=o))),0}r.inflateReset=E,r.inflateReset2=u,r.inflateResetKeep=c,r.inflateInit=function(e){return d(e,15)},r.inflateInit2=d,r.inflate=function(e,t){var r,l,c,E,u,d,T,f,p,A,h,v,m,g,O,N,R,I,b,y,L,Y,M,x,C=0,w=new n.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(r=e.state).mode&&(r.mode=13),u=e.next_out,c=e.output,E=e.next_in,l=e.input,f=r.hold,p=r.bits,A=d=e.avail_in,h=T=e.avail_out,Y=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;p<16;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}if(2&r.wrap&&35615===f){r.check=0,w[0]=255&f,w[1]=f>>>8&255,r.check=o(r.check,w,2,0),f=0,p=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&f)<<8)+(f>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&f)){e.msg="unknown compression method",r.mode=30;break}if(p-=4,L=8+(15&(f>>>=4)),0===r.wbits)r.wbits=L;else if(L>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<L,e.adler=r.check=1,r.mode=512&f?10:12,f=0,p=0;break;case 2:for(;p<16;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}if(r.flags=f,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=f>>8&1),512&r.flags&&(w[0]=255&f,w[1]=f>>>8&255,r.check=o(r.check,w,2,0)),f=0,p=0,r.mode=3;case 3:for(;p<32;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}r.head&&(r.head.time=f),512&r.flags&&(w[0]=255&f,w[1]=f>>>8&255,w[2]=f>>>16&255,w[3]=f>>>24&255,r.check=o(r.check,w,4,0)),f=0,p=0,r.mode=4;case 4:for(;p<16;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}r.head&&(r.head.xflags=255&f,r.head.os=f>>8),512&r.flags&&(w[0]=255&f,w[1]=f>>>8&255,r.check=o(r.check,w,2,0)),f=0,p=0,r.mode=5;case 5:if(1024&r.flags){for(;p<16;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}r.length=f,r.head&&(r.head.extra_len=f),512&r.flags&&(w[0]=255&f,w[1]=f>>>8&255,r.check=o(r.check,w,2,0)),f=0,p=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((v=r.length)>d&&(v=d),v&&(r.head&&(L=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,l,E,v,L)),512&r.flags&&(r.check=o(r.check,l,v,E)),d-=v,E+=v,r.length-=v),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===d)break e;v=0;do{L=l[E+v++],r.head&&L&&r.length<65536&&(r.head.name+=String.fromCharCode(L))}while(L&&v<d);if(512&r.flags&&(r.check=o(r.check,l,v,E)),d-=v,E+=v,L)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===d)break e;v=0;do{L=l[E+v++],r.head&&L&&r.length<65536&&(r.head.comment+=String.fromCharCode(L))}while(L&&v<d);if(512&r.flags&&(r.check=o(r.check,l,v,E)),d-=v,E+=v,L)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;p<16;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}if(f!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}f=0,p=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;p<32;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}e.adler=r.check=s(f),f=0,p=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=u,e.avail_out=T,e.next_in=E,e.avail_in=d,r.hold=f,r.bits=p,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){f>>>=7&p,p-=7&p,r.mode=27;break}for(;p<3;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}switch(r.last=1&f,p-=1,3&(f>>>=1)){case 0:r.mode=14;break;case 1:if(P(r),r.mode=20,6===t){f>>>=2,p-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}f>>>=2,p-=2;break;case 14:for(f>>>=7&p,p-=7&p;p<32;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}if((65535&f)!=(f>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&f,f=0,p=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(v=r.length){if(v>d&&(v=d),v>T&&(v=T),0===v)break e;n.arraySet(c,l,E,v,u),d-=v,E+=v,T-=v,u+=v,r.length-=v;break}r.mode=12;break;case 17:for(;p<14;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}if(r.nlen=257+(31&f),p-=5,r.ndist=1+(31&(f>>>=5)),p-=5,r.ncode=4+(15&(f>>>=5)),f>>>=4,p-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;p<3;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}r.lens[U[r.have++]]=7&f,f>>>=3,p-=3}for(;r.have<19;)r.lens[U[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Y=i(0,r.lens,0,19,r.lencode,0,r.work,M={bits:r.lenbits}),r.lenbits=M.bits,Y){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;N=(C=r.lencode[f&(1<<r.lenbits)-1])>>>16&255,R=65535&C,!((O=C>>>24)<=p);){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}if(R<16)f>>>=O,p-=O,r.lens[r.have++]=R;else{if(16===R){for(x=O+2;p<x;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}if(f>>>=O,p-=O,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}L=r.lens[r.have-1],v=3+(3&f),f>>>=2,p-=2}else if(17===R){for(x=O+3;p<x;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}p-=O,L=0,v=3+(7&(f>>>=O)),f>>>=3,p-=3}else{for(x=O+7;p<x;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}p-=O,L=0,v=11+(127&(f>>>=O)),f>>>=7,p-=7}if(r.have+v>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;v--;)r.lens[r.have++]=L}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,Y=i(1,r.lens,0,r.nlen,r.lencode,0,r.work,M={bits:r.lenbits}),r.lenbits=M.bits,Y){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,Y=i(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,M={bits:r.distbits}),r.distbits=M.bits,Y){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(d>=6&&T>=258){e.next_out=u,e.avail_out=T,e.next_in=E,e.avail_in=d,r.hold=f,r.bits=p,_(e,h),u=e.next_out,c=e.output,T=e.avail_out,E=e.next_in,l=e.input,d=e.avail_in,f=r.hold,p=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;N=(C=r.lencode[f&(1<<r.lenbits)-1])>>>16&255,R=65535&C,!((O=C>>>24)<=p);){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}if(N&&0==(240&N)){for(I=O,b=N,y=R;N=(C=r.lencode[y+((f&(1<<I+b)-1)>>I)])>>>16&255,R=65535&C,!(I+(O=C>>>24)<=p);){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}f>>>=I,p-=I,r.back+=I}if(f>>>=O,p-=O,r.back+=O,r.length=R,0===N){r.mode=26;break}if(32&N){r.back=-1,r.mode=12;break}if(64&N){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&N,r.mode=22;case 22:if(r.extra){for(x=r.extra;p<x;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}r.length+=f&(1<<r.extra)-1,f>>>=r.extra,p-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;N=(C=r.distcode[f&(1<<r.distbits)-1])>>>16&255,R=65535&C,!((O=C>>>24)<=p);){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}if(0==(240&N)){for(I=O,b=N,y=R;N=(C=r.distcode[y+((f&(1<<I+b)-1)>>I)])>>>16&255,R=65535&C,!(I+(O=C>>>24)<=p);){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}f>>>=I,p-=I,r.back+=I}if(f>>>=O,p-=O,r.back+=O,64&N){e.msg="invalid distance code",r.mode=30;break}r.offset=R,r.extra=15&N,r.mode=24;case 24:if(r.extra){for(x=r.extra;p<x;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}r.offset+=f&(1<<r.extra)-1,f>>>=r.extra,p-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===T)break e;if(r.offset>(v=h-T)){if((v=r.offset-v)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}m=v>r.wnext?r.wsize-(v-=r.wnext):r.wnext-v,v>r.length&&(v=r.length),g=r.window}else g=c,m=u-r.offset,v=r.length;v>T&&(v=T),T-=v,r.length-=v;do{c[u++]=g[m++]}while(--v);0===r.length&&(r.mode=21);break;case 26:if(0===T)break e;c[u++]=r.length,T--,r.mode=21;break;case 27:if(r.wrap){for(;p<32;){if(0===d)break e;d--,f|=l[E++]<<p,p+=8}if(e.total_out+=h-=T,r.total+=h,h&&(e.adler=r.check=r.flags?o(r.check,c,h,u-h):a(r.check,c,h,u-h)),h=T,(r.flags?f:s(f))!==r.check){e.msg="incorrect data check",r.mode=30;break}f=0,p=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;p<32;){if(0===d)break e;d--,f+=l[E++]<<p,p+=8}if(f!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}f=0,p=0}r.mode=29;case 29:Y=1;break e;case 30:Y=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=u,e.avail_out=T,e.next_in=E,e.avail_in=d,r.hold=f,r.bits=p,(r.wsize||h!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&S(e,e.output,e.next_out,h-e.avail_out)?(r.mode=31,-4):(h-=e.avail_out,e.total_in+=A-=e.avail_in,e.total_out+=h,r.total+=h,r.wrap&&h&&(e.adler=r.check=r.flags?o(r.check,c,h,e.next_out-h):a(r.check,c,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0===A&&0===h||4===t)&&0===Y&&(Y=-5),Y)},r.inflateEnd=function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},r.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?-2:(r.head=t,t.done=!1,0):-2},r.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?-2:11===r.mode&&a(1,t,n,0)!==r.check?-3:S(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,0):-2},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":1,"./adler32":3,"./crc32":5,"./inffast":7,"./inftrees":9}],9:[function(e,t,r){var n=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],_=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],i=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,s,l,c,E,u){var d,T,f,p,P,S,A,h,v,m=u.bits,g=0,O=0,N=0,R=0,I=0,b=0,y=0,L=0,Y=0,M=0,x=null,C=0,w=new n.Buf16(16),U=new n.Buf16(16),k=null,D=0;for(g=0;g<=15;g++)w[g]=0;for(O=0;O<s;O++)w[t[r+O]]++;for(I=m,R=15;R>=1&&0===w[R];R--);if(I>R&&(I=R),0===R)return l[c++]=20971520,l[c++]=20971520,u.bits=1,0;for(N=1;N<R&&0===w[N];N++);for(I<N&&(I=N),L=1,g=1;g<=15;g++)if(L<<=1,(L-=w[g])<0)return-1;if(L>0&&(0===e||1!==R))return-1;for(U[1]=0,g=1;g<15;g++)U[g+1]=U[g]+w[g];for(O=0;O<s;O++)0!==t[r+O]&&(E[U[t[r+O]]++]=O);if(0===e?(x=k=E,S=19):1===e?(x=a,C-=257,k=o,D-=257,S=256):(x=_,k=i,S=-1),M=0,O=0,g=N,P=c,b=I,y=0,f=-1,p=(Y=1<<I)-1,1===e&&Y>852||2===e&&Y>592)return 1;for(;;){A=g-y,E[O]<S?(h=0,v=E[O]):E[O]>S?(h=k[D+E[O]],v=x[C+E[O]]):(h=96,v=0),d=1<<g-y,N=T=1<<b;do{l[P+(M>>y)+(T-=d)]=A<<24|h<<16|v|0}while(0!==T);for(d=1<<g-1;M&d;)d>>=1;if(0!==d?(M&=d-1,M+=d):M=0,O++,0==--w[g]){if(g===R)break;g=t[r+E[O]]}if(g>I&&(M&p)!==f){for(0===y&&(y=I),P+=N,L=1<<(b=g-y);b+y<R&&!((L-=w[b+y])<=0);)b++,L<<=1;if(Y+=1<<b,1===e&&Y>852||2===e&&Y>592)return 1;l[f=M&p]=I<<24|b<<16|P-c|0}}return 0!==M&&(l[P+M]=g-y<<24|64<<16|0),u.bits=I,0}},{"../utils/common":1}],10:[function(e,t,r){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],11:[function(e,t,r){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/lib/inflate.js":[function(e,t,r){var n=e("./zlib/inflate"),a=e("./utils/common"),o=e("./utils/strings"),_=e("./zlib/constants"),i=e("./zlib/messages"),s=e("./zlib/zstream"),l=e("./zlib/gzheader"),c=Object.prototype.toString;function E(e){if(!(this instanceof E))return new E(e);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==_.Z_OK)throw new Error(i[r]);this.header=new l,n.inflateGetHeader(this.strm,this.header)}function u(e,t){var r=new E(t);if(r.push(e,!0),r.err)throw r.msg||i[r.err];return r.result}E.prototype.push=function(e,t){var r,i,s,l,E,u,d=this.strm,T=this.options.chunkSize,f=this.options.dictionary,p=!1;if(this.ended)return!1;i=t===~~t?t:!0===t?_.Z_FINISH:_.Z_NO_FLUSH,d.input="string"==typeof e?o.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?new Uint8Array(e):e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new a.Buf8(T),d.next_out=0,d.avail_out=T),(r=n.inflate(d,_.Z_NO_FLUSH))===_.Z_NEED_DICT&&f&&(u="string"==typeof f?o.string2buf(f):"[object ArrayBuffer]"===c.call(f)?new Uint8Array(f):f,r=n.inflateSetDictionary(this.strm,u)),r===_.Z_BUF_ERROR&&!0===p&&(r=_.Z_OK,p=!1),r!==_.Z_STREAM_END&&r!==_.Z_OK)return this.onEnd(r),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&r!==_.Z_STREAM_END&&(0!==d.avail_in||i!==_.Z_FINISH&&i!==_.Z_SYNC_FLUSH)||("string"===this.options.to?(s=o.utf8border(d.output,d.next_out),l=d.next_out-s,E=o.buf2string(d.output,s),d.next_out=l,d.avail_out=T-l,l&&a.arraySet(d.output,d.output,s,l,0),this.onData(E)):this.onData(a.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(p=!0)}while((d.avail_in>0||0===d.avail_out)&&r!==_.Z_STREAM_END);return r===_.Z_STREAM_END&&(i=_.Z_FINISH),i===_.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===_.Z_OK):i!==_.Z_SYNC_FLUSH||(this.onEnd(_.Z_OK),d.avail_out=0,!0)},E.prototype.onData=function(e){this.chunks.push(e)},E.prototype.onEnd=function(e){e===_.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=E,r.inflate=u,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},r.ungzip=u},{"./utils/common":1,"./utils/strings":2,"./zlib/constants":4,"./zlib/gzheader":6,"./zlib/inflate":8,"./zlib/messages":10,"./zlib/zstream":11}]},{},[])("/lib/inflate.js")}();var zI=window.pako.inflate,QI=nA("__assets",(function(e,t){var r=gN(e),n=dR(e),a=jI(e),o=mN(e),_=yI(e),i=n.defaults,s=n.assets;t.AT_ARRAYBUFFER=10,t.AT_ARRAYBUFFER_ZIP=20,t.AT_JSON=30,t.AT_JSON_ZIP=40,t.AT_TEXT=50,t.AT_AUDIOBUFFER=60,t.AT_IMAGE_ELEMENT=70,t.AT_AUDIO_ELEMENT=80,t.AT_VIDEO_ELEMENT=90,t.AT_SEQ_VIDEO_ELEMENT=100;var l=[],c=0,E={},u={},d={},T={},f={};function p(){return n.is_built_in_data()?b4w.require(n.paths.built_in_data_module).data:null}function P(){var e={_source_url:null,_parse_response:function(t){switch(e.responseType){case"json":case"text":return t;case"arraybuffer":for(var r=atob(t),n=r.length,a=new Int8Array(n),o=0;o<n;o++)a[o]=r.charCodeAt(o);return a.buffer;default:return t}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(t,r,n){e._source_url=r,e.readyState=1},send:function(){e.status=404,e.readyState=4;var t=p();t&&e._source_url in t&&(e.status=200,t[e._source_url]&&(e.response=e._parse_response(t[e._source_url]))),"[object Function]"==={}.toString.call(e.onreadystatechange)&&e.onreadystatechange()}};return e}function S(e){for(var n=0,a=0;a<e.length;a++){var o=e[a];if(20===o.state&&n++,n>=s.max_requests)break;if(10===o.state)switch(o.state=20,n++,o.type){case t.AT_JSON_ZIP:case t.AT_ARRAYBUFFER:case t.AT_ARRAYBUFFER_ZIP:A(o,"arraybuffer");break;case t.AT_JSON:A(o,"json");break;case t.AT_TEXT:A(o,"text");break;case t.AT_AUDIOBUFFER:h(o);break;case t.AT_IMAGE_ELEMENT:v(o);break;case t.AT_AUDIO_ELEMENT:m(o);break;case t.AT_VIDEO_ELEMENT:g(o);break;case t.AT_SEQ_VIDEO_ELEMENT:O(o);break;default:r.panic("Wrong asset type: "+o.type)}}}function A(e,r){var n=e.url.split("?v=")[0];if(n in u)e.asset_cb("json"==r?lO(u[n]):u[n],e.id,e.type,e.url,e.param);else{var a=p();if(a&&e.url in a)var _=new P;else _=new XMLHttpRequest;var i=null;if("GET"==e.request_method)_.open("GET",e.url,!0);else if("POST"==e.request_method)switch(_.open("POST",e.url,!0),e.type){case t.AT_TEXT:i="text/plain";break;case t.AT_JSON:i="application/json"}if(e.overwrite_header)for(var s in e.overwrite_header)"Content-Type"==s?i=e.overwrite_header[s]:_.setRequestHeader(s,e.overwrite_header[s]);i&&_.setRequestHeader("Content-Type",i),"text"==r?(_.overrideMimeType("text/plain"),_.responseType="text"):"json"==r?(_.overrideMimeType("application/json"),_.responseType="text"):_.responseType=r,_.onreadystatechange=function(){if(40!=e.state&&4==_.readyState){if(200==_.status||0==_.status){var a=_.response;if(!a||"arraybuffer"==r&&0==a.byteLength)o.error("empty responce when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param);else{switch(e.type){case t.AT_JSON_ZIP:try{a=zI(a,{to:"string"})}catch(YM){return o.error(YM+" (parsing gzipped file "+e.url+")"),void e.asset_cb(null,e.id,e.type,e.url,e.param)}case t.AT_JSON:try{a=JSON.parse(a,e.json_reviver)}catch(YM){return o.error(YM+" (parsing JSON "+e.url+")"),void e.asset_cb(null,e.id,e.type,e.url,e.param)}break;case t.AT_ARRAYBUFFER_ZIP:try{a=zI(a).buffer}catch(YM){return o.error(YM+" (parsing gzipped file "+e.url+")"),void e.asset_cb(null,e.id,e.type,e.url,e.param)}}e.is_fetch&&(u[n]=e.type==t.AT_JSON||e.type==t.AT_JSON_ZIP?lO(a):a),e.asset_cb(a,e.id,e.type,e.url,e.param)}}else o.error(_.status+" when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param);e.state=30}},_.addEventListener("progress",(function(t){t.lengthComputable&&e.progress_cb(t.loaded/t.total)}),!1),_.send(e.post_data)}}function h(e){var t=e.url.split("?v=")[0];if(t in f)return e.asset_cb(f[t],e.id,e.type,e.url,e.param),void(e.state=30);"GET"!=e.request_method&&r.panic("Unsupported request type for audio buffer");var n=p();if(n&&e.url in n)var a=new P;else a=new XMLHttpRequest;a.open("GET",e.url,!0),a.responseType="arraybuffer",a.onreadystatechange=function(){if(40!=e.state&&4==a.readyState)if(200==a.status||0==a.status){var t=a.response;t?_.decode_audio_data(t,(function(t){if(e.asset_cb(t,e.id,e.type,e.url,e.param),e.state=30,e.is_fetch){var r=e.url.split("?v=")[0];f[r]=t}}),(function(){o.error("failed to decode "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=30})):(o.error("empty responce when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=30)}else o.error(a.status+" when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=30},a.send()}function v(e){var t=e.url.split("?v=")[0];if(t in d)return e.asset_cb(d[t],e.id,e.type,e.url,e.param),void(e.state=30);"GET"!=e.request_method&&r.panic("Unsupported request type for image element");var n=document.createElement("img");i.allow_cors&&(n.crossOrigin="Anonymous"),n.onload=function(){if(40!=e.state&&(e.asset_cb(n,e.id,e.type,e.url,e.param),e.state=30,e.is_fetch)){var t=e.url.split("?v=")[0];d[t]=n}},n.addEventListener("error",(function(){40!=e.state&&(o.error("could not load image: "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=30)}),!1);var _=p();if(_&&e.url in _)if(_[e.url]){var s=function(e){var t="image";switch(mI(e).toLowerCase()){case"jpeg":case"jpg":t+="/jpeg";break;case"png":t+="/png"}return t}(e.url);n.src="data:"+s+";base64,"+_[e.url]}else{if(a.is_ie11())(l=document.createEvent("CustomEvent")).initCustomEvent("error",!1,!1,null);else var l=new CustomEvent("error");n.dispatchEvent(l)}else n.src=e.url}function m(e){var t=e.url.split("?v=")[0];if(t in T)return e.asset_cb(T[t],e.id,e.type,e.url,e.param),void(e.state=30);"GET"!=e.request_method&&r.panic("Unsupported request type for audio element");var n=document.createElement("audio");i.allow_cors&&(n.crossOrigin="Anonymous"),n.addEventListener("loadeddata",(function(){if(40!=e.state&&(e.asset_cb(n,e.id,e.type,e.url,e.param),e.state=30,e.is_fetch)){var t=e.url.split("?v=")[0];T[t]=n}}),!1),n.addEventListener("error",(function(){40!=e.state&&(o.error("could not load sound: "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=30)}),!1),n.addEventListener("stalled",(function(){40!=e.state&&(o.error("could not load sound: "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=30)}),!1);var _=p();if(_&&e.url in _)if(_[e.url]){var s=function(e){var t="audio";switch(mI(e).toLowerCase()){case"ogv":case"ogg":t+="/ogg";break;case"mp3":t+="/mpeg";break;case"m4v":case"mp4":t+="/mp4";break;case"webm":t+="/webm"}return t}(e.url);n.src="data:"+s+";base64,"+_[e.url],40!=e.state&&(e.asset_cb(n,e.id,e.type,e.url,e.param),e.state=30)}else{if(a.is_ie11())(l=document.createEvent("CustomEvent")).initCustomEvent("error",!1,!1,null);else var l=new CustomEvent("error");n.dispatchEvent(l)}else n.src=e.url,i.is_mobile_device&&n.load();i.mobile_firefox_media_hack&&(n.autoplay=!0,n.pause()),setTimeout((function(){n.some_prop_to_prevent_gc=1}),5e3)}function g(e){var t=e.url.split("?v=")[0];if(t in d)return e.asset_cb(d[t],e.id,e.type,e.url,e.param),void(e.state=30);"GET"!=e.request_method&&r.panic("Unsupported request type for video element");var n=document.createElement("video");function _(t){40!=e.state&&(o.error("could not load video: "+e.url,e.param),e.asset_cb(null,e.id,e.type,e.url),e.state=30)}n.muted=!0,i.allow_cors&&(n.crossOrigin="Anonymous"),n.addEventListener("loadeddata",(function(){if(n.removeEventListener("error",_,!1),40!=e.state&&(e.asset_cb(n,e.id,e.type,e.url,e.param),e.state=30,e.is_fetch)){var t=e.url.split("?v=")[0];d[t]=n}}),!1),n.addEventListener("error",_,!1);var s=p();if(s&&e.url in s)if(s[e.url]){var l=function(e){var t="video";switch(mI(e).toLowerCase()){case"ogv":t+="/ogg";break;case"webm":t+="/webm";break;case"m4v":case"mp4":t+="/mp4"}return t}(e.url);n.src="data:"+l+";base64,"+s[e.url],40!=e.state&&n.addEventListener("loadeddata",(function(){e.asset_cb(n,e.id,e.type,e.url,e.param),e.state=30}),!1)}else{if(a.is_ie11())(c=document.createEvent("CustomEvent")).initCustomEvent("error",!1,!1,null);else var c=new CustomEvent("error");n.dispatchEvent(c)}else n.src=e.url,i.is_mobile_device&&n.load();(i.mobile_firefox_media_hack||i.ipad_video_hack)&&(n.autoplay=!0,n.pause()),setTimeout((function(){n.some_prop_to_prevent_gc=1}),1e4)}function O(e){var t=e.url.split("?v=")[0];if(t in d)return e.asset_cb(d[t],e.id,e.type,e.url,e.param),void(e.state=30);"GET"!=e.request_method&&r.panic("Unsupported request type for seq video element");var n=p();if(n&&e.url in n)var a=new P;else a=new XMLHttpRequest;function _(t){if(e.asset_cb(t,e.id,e.type,e.url,e.param),e.state=30,e.is_fetch){var r=e.url.split("?v=")[0];d[r]=t}}a.open("GET",e.url,!0),a.responseType="arraybuffer",a.onreadystatechange=function(){if(40!=e.state&&4==a.readyState)if(200==a.status||0==a.status){var t=a.response;t?function(e,t){for(var r=new Int32Array(e),n=new Int8Array(e),a=r[3],o={images:[],blobs:[],fps:r[4]},_=20,i=0;i<a;i++){var s=r[_/4],l=n.subarray(_+4,_+4+s),c=new Blob([l],{type:"image/jpg"}),E=document.createElement("img");E.src=window.URL.createObjectURL(c),o.images.push(E),o.blobs.push(c),_+=s+8-s%4}E.onload=function(){for(var e=0;e<o.images.length;e++)window.URL.revokeObjectURL(o.images[e].src);delete o.blobs,t(o)}}(t,_):(o.error("empty responce when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=30)}else o.error(a.status+" when trying to get "+e.url),e.asset_cb(null,e.id,e.type,e.url,e.param),e.state=30},a.addEventListener("progress",(function(t){t.lengthComputable&&e.progress_cb(t.loaded/t.total)}),!1),a.send()}t.split_extension=function(e){var t=e.split("."),r=Array(2);return r[0]=t.slice(0,-1).join("."),r[1]=String(t.slice(-1)),r},t.get_text_sync=function(e){if(E[e])return E[e];if(s.prevent_caching)var t=e+"?v="+eI();else t=e;var n=new XMLHttpRequest;if(n.overrideMimeType("text/plain"),n.open("GET",t,!1),n.send(null),200==n.status||0==n.status){var a=n.responseText;if(a.length)return E[e]=a,a;r.panic("Error XHR: responce is empty, GET "+e)}else r.panic("Error XHR: "+n.status+", GET "+e)},t.cleanup=function(){for(var e=0;e<l.length;e++)l[e].state=40;l=[],c=0,E={}},t.enqueue=function(e,t,r,n,a){for(var o=0;o<e.length;o++){var _=e[o],i={id:_.id,type:_.type,url:_.url,is_fetch:_.is_fetch,request_method:_.request_method?_.request_method:"GET",overwrite_header:_.overwrite_header?_.overwrite_header:null,post_data:_.post_data?_.post_data:null,param:_.param?_.param:null,state:10,asset_cb:t||function(){},pack_cb:r||function(){},progress_cb:n||function(){},json_reviver:a||null,pack_index:c};if(s.prevent_caching){var E=p();E&&i.url in E||(i.url+="?v="+eI())}l.push(i)}S(l),c++},t.update=function(){S(l),function(e){for(var t=0,r=!0,n=0;n<e.length;n++){var a=e[n];if(a.pack_index===e[t].pack_index)30!==a.state&&(r=!1);else{if(r){e[n-1].pack_cb();var o=n-t;e.splice(t,o),n-=o}t=n,r=30===e[n].state}if(n===e.length-1&&r){var _=e[n];e.splice(t),_.pack_cb()}}}(l)},t.check_image_extension=function(e){return"png"==e||"jpg"==e||"jpeg"==e||"gif"==e||"bmp"==e||"dds"==e||"pvr"==e},t.clear_cache=function(){u={},d={},T={},f={}}}));tA.module.shader_texts=function(e,t){e["anchors.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",")",";","}"]}]},e["anchors.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"ANCHOR_NUM",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","vec3","u_position","[","ANCHOR_NUM","]",";","uniform","mat4","u_view_proj_matrix",";","uniform","vec2","u_texel_size",";","GLSL_IN","float","a_index",";","void","main","(",")","{","int","c","=","int","(","mod","(","a_index",",","3.0",")",")",";","int","d","=","int","(","a_index","/","3.0",")",";","vec2","e",";","if","(","c","==","0",")","{","e","=","vec2","(","-","4.0","*","u_texel_size","[","0","]",",","-","u_texel_size","[","1","]",")",";","}","else","if","(","c","==","1",")","{","e","=","vec2","(","4.0","*","u_texel_size","[","0","]",",","-","u_texel_size","[","1","]",")",";","}","else","{","e","=","vec2","(","0.0",",","5.0","*","u_texel_size","[","1","]",")",";","}","vec4","f","=","u_view_proj_matrix","*","vec4","(","u_position","[","d","]",",","1.0",")",";","f",".","xy","+=","e","*","f",".","w",";","gl_Position","=","f",";","}"]}]},e["color_id.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"USE_OUTLINE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_time",";","uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sampler",";","uniform","float","u_alpha_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_OUTLINE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_color_id",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_lamp_light_positions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_directions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_color_intensities","[","NUM_LAMP_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_csm_center_dists",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map0",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";","uniform","sampler2D","u_shadow_mask",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_OUTLINE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_outline_intensity",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_lod_coverage",";","uniform","float","u_lod_cmp_logic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";","GLSL_IN","vec4","i",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";","GLSL_IN","vec4","o",";","GLSL_IN","vec4","u",";","GLSL_IN","vec4","v",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","C","(","u_lod_coverage",",","u_lod_cmp_logic",")",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","u_camera_eye_frag","-","h",")",";","vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","float","L","=","I",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","(","GLSL_TEXTURE","(","u_sampler",",","A",")",")",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","M","=","u_alpha_factor","*","L",";","M","+=","(","1.0","-","step","(","0.0",",","M",")",")",";","L","=","mix","(","M",",","1.0",",","u_diffuse_color",".","a",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","u_diffuse_color",".","a",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_OUTLINE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","1.0",",","1.0",",","u_outline_intensity",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","u_color_id",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["color_id.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_JITTER",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM_MIX_NORMALS_FACTOR",TOKENS:["u_va_frame_factor"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"scale_texcoord.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","1.0",",","1.0",",","0.0",",","0.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsb","[","MAX_BONES","]",";","uniform","vec4","u_transb","[","MAX_BONES","]",";","uniform","vec4","u_arm_rel_trans",";","uniform","vec4","u_arm_rel_quat",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsa","[","MAX_BONES","]",";","uniform","vec4","u_transa","[","MAX_BONES","]",";","uniform","float","u_frame_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","PRECISION","float","u_time",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_texture_scale",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_bending_col_detail",";","AU_QUALIFIER","float","au_detail_bending_amp",";","AU_QUALIFIER","float","au_branch_bending_amp",";","AU_QUALIFIER","float","au_detail_bending_freq",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["AU_QUALIFIER","float","au_wind_bending_amp",";","AU_QUALIFIER","float","au_wind_bending_freq",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","h",";","GLSL_OUT","vec4","i",";","GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslv"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","mat3","N","=","u_view_tsr",";","vec3","O","=","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA","CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},{TYPE:"logical_or_expr",PLACES:6},{TYPE:"logical_and_expr",PLACES:3},"USE_TBN_SHADING","CALC_TBN",{TYPE:"logical_and_expr",PLACES:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:7}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","P",",","Q",";","vec4","S","=","R","(","a_tbn",",","P",",","Q",")",";","vec3","U","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","T","(","S",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","W","=","Q","*","cross","(","U",",","V",")",";","vec4","Y","=","X","(","W",",","Q","*","P",")",";","V","=","T","(","Y",",","U",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","vec3","(","0.0",")",";","vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ac","=","normalize","(","_","(","u_model_tsr",",","U",")",")",";","vec3","ad","=","cross","(","vec3","(","0.0",",","0.0",",","1.0",")",",","ac",")",";","vec3","ae","=","cross","(","ac",",","ad",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","mix","(","O",",","a_position_next",",","u_va_frame_factor",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","af",",","ah",";","vec4","ai","=","R","(","a_tbn_next",",","af",",","ah",")",";","vec3","aj","=","T","(","ai",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";","U","=","mix","(","U",",","aj",",","VERTEX_ANIM_MIX_NORMALS_FACTOR",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ak","=","T","(","ai",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","al","=","ah","*","cross","(","aj",",","ak",")",";","vec4","am","=","X","(","al",",","ah","*","af",")",";","ak","=","T","(","am",",","aj",")",";","V","=","mix","(","V",",","ak",",","u_va_frame_factor",")",";","W","=","mix","(","W",",","al",",","u_va_frame_factor",")",";"]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["an","(","O",",","V",",","W",",","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","ao",")",";","Z","=","as","(","u_camera_eye",",","aq",",","N",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","aq",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","O","-","ao",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","U",",","mat4","(","0.0",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ay","=","T","(","a_tbn",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ay","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","ay",",","mat4","(","0.0",")",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","az","(","a_texcoord",",","u_texture_scale",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["h","=","aw",".","O",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:12}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","aw",".","U",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aA","=","(","dot","(","cross","(","aw",".","U",",","aw",".","V",")",",","aw",".","W",")","<","0.0",")","?","-","1.0",":","1.0",";","k","=","vec4","(","aw",".","V",",","aA",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["B","=","aw",".","aB",";"]}]}}]},{TYPE:"txt",TOKENS:["i","=","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";","vec4","f","=","u_proj_matrix","*","i",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["f",".","xy","+=","u_subpixel_jitter","*","f",".","w",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["l","=","aC","(","f",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["m","=","-","i",".","z","/","u_view_max_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["J","(",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";","}"]}]},e["debug_view.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DEBUG_SPHERE",TOKENS:["0"]},{TYPE:"var",NAME:"WIREFRAME_QUALITY",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_SPHERE_DYNAMIC",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","int","u_debug_view_mode",";","uniform","float","u_cluster_id",";","uniform","float","u_batch_debug_id_color",";","uniform","float","u_batch_debug_main_render_time",";","uniform","float","u_debug_colors_seed",";","uniform","float","u_debug_render_time_threshold",";","uniform","vec3","u_wireframe_edge_color",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","aD",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","const","float","aE","=","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE_DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","vec3","aF","=","vec3","(","1.0",",","0.05",",","0.05",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","vec3","aF","=","vec3","(","0.05",",","0.05",",","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","vec3","aG","=","vec3","(","0.4",",","0.4",",","1.0",")",";","const","vec3","aH","=","vec3","(","1.0",",","0.4",",","0.4",")",";","const","vec3","aI","=","vec3","(","1.0",",","1.0",",","1.0",")",";","const","vec3","aJ","=","vec3","(","0.0",",","133.0","/","255.0",",","66.0","/","255.0",")",";","const","vec3","aK","=","vec3","(","160.0","/","255.0",",","38.0","/","255.0",",","33.0","/","255.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aP","(",")","{","float","aL","=","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIREFRAME_QUALITY",0,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aM","=","sign","(","aD","-","vec3","(","0.02","*","aE",")",")",";","if","(","aM",".","x","<","0.0","||","aM",".","y","<","0.0","||","aM",".","z","<","0.0",")","aL","=","0.0",";"]}]}},{TYPE:"elif",EXPRESSION:["WIREFRAME_QUALITY",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"txt",TOKENS:["vec3","aN","=","fwidth","(","aD",")",";","vec3","aO","=","smoothstep","(","vec3","(","0.0",")",",","aN","*","aE",",","aD",")",";","aL","=","min","(","min","(","aO",".","x",",","aO",".","y",")",",","aO",".","z",")",";","aL","=","clamp","(","aL",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","aL",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec3","aQ","=","vec3","(","0.0",")",";","float","L","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aM","=","sign","(","aD","-","vec3","(","0.02","*","aE",")",")",";","if","(","aM",".","x","<","0.0","||","aM",".","y","<","0.0","||","aM",".","z","<","0.0",")","{","aQ","=","aF",";","L","=","1.0",";","}","else","discard",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","u_debug_view_mode","==","DV_OPAQUE_WIREFRAME",")","{","float","aL","=","aP","(",")",";","aQ","=","vec3","(","mix","(","u_wireframe_edge_color",",","aI",",","aL",")",")",";","L","=","1.0",";","}","else","if","(","u_debug_view_mode","==","DV_TRANSPARENT_WIREFRAME",")","{","float","aL","=","aP","(",")",";","aQ","=","u_wireframe_edge_color",";","L","=","mix","(","1.0",",","0.0",",","aL",")",";","}","else","if","(","u_debug_view_mode","==","DV_FRONT_BACK_VIEW",")","{","float","aL","=","aP","(",")",";","if","(","gl_FrontFacing",")","aQ","=","mix","(","u_wireframe_edge_color",",","aG",",","aL",")",";","else","aQ","=","mix","(","u_wireframe_edge_color",",","aH",",","aL",")",";","L","=","1.0",";","}","else","if","(","u_debug_view_mode","==","DV_CLUSTERS_VIEW",")","{","float","aR","=","u_cluster_id","+","u_debug_colors_seed","+","2.0",";","aQ","=","vec3","(","fract","(","aR","*","19.73",")",",","fract","(","aR","*","6.34",")",",","fract","(","aR","*","1.56",")",")",";","L","=","1.0",";","}","else","if","(","u_debug_view_mode","==","DV_BATCHES_VIEW",")","{","float","aR","=","u_batch_debug_id_color","+","u_debug_colors_seed",";","aQ","=","vec3","(","fract","(","aR","*","19.73",")",",","fract","(","aR","*","6.34",")",",","fract","(","aR","*","1.56",")",")",";","L","=","1.0",";","}","else","if","(","u_debug_view_mode","==","DV_RENDER_TIME",")","{","float","aS",";","if","(","u_debug_render_time_threshold",">","0.0",")","aS","=","clamp","(","u_batch_debug_main_render_time",",","0.0",",","u_debug_render_time_threshold",")","/","u_debug_render_time_threshold",";","else","aS","=","1.0",";","float","aT","=","clamp","(","2.0","*","aS",",","0.0",",","1.0",")",";","float","aU","=","clamp","(","2.0","*","aS","-","1.0",",","0.0",",","1.0",")",";","float","aV","=","aS",";","aQ","=","mix","(","aJ",",","aK",",","vec3","(","aT",",","aU",",","aV",")",")",";","L","=","1.0",";","}"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["debug_view.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"USE_INSTANCED_PARTCLS",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_VIEW_SPECIAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_SPHERE",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";","GLSL_IN","float","a_polyindex",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_part_ts",";","GLSL_IN","vec4","a_part_r",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_bending_col_detail",";","AU_QUALIFIER","float","au_detail_bending_amp",";","AU_QUALIFIER","float","au_branch_bending_amp",";","AU_QUALIFIER","float","au_detail_bending_freq",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["AU_QUALIFIER","float","au_wind_bending_amp",";","AU_QUALIFIER","float","au_wind_bending_freq",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","aD",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","1.0",",","1.0",",","0.0",",","0.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","float","u_time",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsb","[","MAX_BONES","]",";","uniform","vec4","u_transb","[","MAX_BONES","]",";","uniform","vec4","u_arm_rel_trans",";","uniform","vec4","u_arm_rel_quat",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsa","[","MAX_BONES","]",";","uniform","vec4","u_transa","[","MAX_BONES","]",";","uniform","float","u_frame_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_grass_map_depth",";","uniform","sampler2D","u_grass_map_color",";","uniform","vec4","u_camera_quat",";","uniform","vec3","u_grass_map_dim",";","uniform","float","u_grass_size",";","uniform","float","u_scale_threshold",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"include",FILE:"dynamic_grass.glslv"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","if","(","a_polyindex","==","0.0",")","aD","=","vec3","(","1.0",",","0.0",",","0.0",")",";","else","if","(","a_polyindex","==","1.0",")","aD","=","vec3","(","0.0",",","0.0",",","1.0",")",";","else","aD","=","vec3","(","0.0",",","1.0",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_VIEW_SPECIAL_SKYDOME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gl_Position","=","vec4","(","a_position",".","xy",",","0.9999999",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","aZ","(","a_part_ts",".","xyz",",","aY","(",")",")",";","Z","=","a_","(","vec3","(","a_part_ts",".","w",")",",","Z",")",";","Z","=","bc","(","a_part_r",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","bd","(","u_model_tsr",",","Z",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["mat3","N","=","u_view_tsr",";","vec3","O","=","a_position",";","vec4","S","=","R","(","a_tbn",")",";","vec3","U","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_SPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","mix","(","O",",","a_position_next",",","u_va_frame_factor",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";","an","(","O",",","V",",","W",",","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","a_part_ts",".","xyz",";","O","=","ap","(","Z",",","O",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","be","(","O",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","ao",",","u_grass_map_depth",",","u_grass_map_color",",","u_grass_map_dim",",","u_grass_size",",","u_camera_eye",",","u_camera_quat",",","N",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","ao",")",";","Z","=","as","(","u_camera_eye",",","aq",",","N",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","bf","=","aq",";","Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","bf",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","O","-","ao",",","ao",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","ao",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","U",",","mat4","(","0.0",")",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["error.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","0.0",",","1.0",",","1.0",")",";","}"]}]},e["error.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","void","main","(",")","{","gl_Position","=","u_proj_matrix","*","bh","(","u_view_tsr",")","*","vec4","(","a_position",",","1.0",")",";","}"]}]},e["grass_map.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_SIZE",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_COLOR",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","bi",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","bi",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bi",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","bi",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","bi",",","vec3","(","1.0",")",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","bi",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["grass_map.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_SIZE",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_grass_size",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","bi",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","bi",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bi",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","1.0",",","1.0",",","0.0",",","0.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","float","u_time",";","uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","mat3","N","=","u_view_tsr",";","mat3","Z","=","u_model_tsr",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","vec3","(","0.0",")",")",";","Z","=","as","(","u_camera_eye",",","aq",",","N",",","u_model_tsr",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","vec3","(","0.0",")",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","a_position",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","a_position",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec4","f","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_SIZE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bi","=","vec4","(","a_grass_size",",","a_grass_color",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bi","=","a_grass_size",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bi","=","a_grass_color",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["halo.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";","uniform","vec3","u_halo_rings_color",";","uniform","vec3","u_halo_lines_color",";","uniform","float","u_halo_hardness",";","uniform","float","u_halo_size",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_sun_intensity",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_halo_stars_blend",";","uniform","float","u_halo_stars_height",";","uniform","float","u_cam_water_depth",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","bj",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_IN","float","bk",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"halo_color.glslf"},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec4","bm","=","bl","(",")",";","vec3","aQ","=","bm",".","rgb",";","float","aM","=","bm",".","a",";","aW","(","aQ",")",";","aX","(","aQ",",","aM",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","aM",")",";","}"]}]},e["halo.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","PRECISION","float","u_halo_size",";","uniform","vec3","u_camera_eye",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","1.0",",","1.0",",","0.0",",","0.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec2","a_halo_bb_vertex",";","GLSL_IN","float","a_random_vals",";","GLSL_OUT","vec2","A",";","GLSL_OUT","float","bk",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","bj",";"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","mat3","N","=","u_view_tsr",";","mat3","Z","=","u_model_tsr",";","vec3","O","=","ap","(","Z",",","a_position",")",";","A","=","a_halo_bb_vertex","*","2.0","-","1.0",";","bk","=","a_random_vals",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","bo","=","bn","(","O",",","N",")",";","mat3","bp","=","N",";","bp","[","0","]","[","0","]","=","0.0",";","bp","[","0","]","[","1","]","=","0.0",";","bp","[","0","]","[","2","]","=","0.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","bo","=","bn","(","O",",","N",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec2","bq","=","(","a_halo_bb_vertex","*","2.0","-","1.0",")","*","u_halo_size",";","vec3","bs","=","vec3","(","bq","[","0","]",",","0.0",",","bq","[","1","]",")",";","vec3","bt","=","ap","(","bo",",","bs",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","f","=","u_proj_matrix","*","vec4","(","ap","(","bp",",","bt",")",",","1.0",")",";","f",".","z","=","0.99999","*","f",".","w",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bj","=","vec4","(","bt",",","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","f","=","u_proj_matrix","*","vec4","(","ap","(","N",",","bt",")",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["irradiance_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_reflection",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","GLSL_IN","vec3","bu",";","void","main","(",")","{","vec3","bv","=","normalize","(","bu",")",";","vec3","bw",";","vec3","bx","=","vec3","(","0.0",")",";","vec3","by","=","vec3","(","0.0",",","0.0",",","1.0",")",";","vec3","bz","=","vec3","(","1.0",",","0.0",",","0.0",")",";","const","float","bA","=","0.025",";","float","bB","=","0.0",";","for","(","float","bC","=","0.0",";","bC","<","2.0","*","M_PI",";","bC","+=","bA",")","{","for","(","float","bD","=","0.0",";","bD","<","0.5","*","M_PI",";","bD","+=","bA",")","{","vec3","bE","=","vec3","(","sin","(","bD",")","*","cos","(","bC",")",",","sin","(","bD",")","*","sin","(","bC",")",",","cos","(","bD",")",")",";","vec3","bF","=","bE",".","x","*","bz","+","bE",".","y","*","by","+","bE",".","z","*","bv",";","vec3","bw","=","GLSL_TEXTURE_CUBE","(","u_sky_reflection",",","bF",")",".","rgb",";","bG","(","bw",")",";","bx","+=","bw","*","cos","(","bD",")","*","sin","(","bD",")",";","bB","++",";","}","}","bx","=","M_PI","*","bx","*","(","1.0","/","float","(","bB",")",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","bx",",","1.0",")",";","}"]}]},e["lens_flares.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sampler",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","aQ","=","GLSL_TEXTURE","(","u_sampler",",","A",")",";","aW","(","aQ",".","rgb",")",";","aX","(","aQ",".","rgb",",","aQ",".","a",")",";","GLSL_OUT_FRAG_COLOR","=","aQ",";","}"]}]},e["lens_flares.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"define",NAME:"LIGHT_INDEX",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","GLSL_IN","float","a_lf_dist",";","GLSL_IN","vec2","a_lf_bb_vertex",";","GLSL_IN","vec2","a_texcoord",";","GLSL_OUT","vec2","A",";","void","main","(",")","{","A","=","a_texcoord",";","vec3","bH","=","normalize","(","u_light_directions","[","LIGHT_INDEX","]",")",";","vec4","f","=","u_proj_matrix","*","vec4","(","bI","(","u_view_tsr",",","bH",")",",","0.0",")",";","f",".","x","/=","f",".","w",";","f",".","y","/=","f",".","w",";","f","+=","99999.0","*","step","(","f",".","z",",","0.0",")",";","f","+=","100.0","*","(","step","(","1.0",",","abs","(","f",".","x",")",")","+","step","(","1.0",",","abs","(","f",".","y",")",")",")",";","f",".","x","=","a_lf_dist","*","f",".","x",";","f",".","y","=","a_lf_dist","*","f",".","y",";","float","bJ","=","u_proj_matrix","[","1","]","[","1","]","/","u_proj_matrix","[","0","]","[","0","]",";","vec2","bK","=","vec2","(","a_lf_bb_vertex",".","x","/","bJ",",","a_lf_bb_vertex",".","y",")",";","if","(","a_lf_dist","<","0.999",")","{","const","float","bL","=","1.9",";","bK","*=","(","1.0","+","bL","*","length","(","f",".","xy",")",")",";","}","gl_Position","=","vec4","(","f",".","xy","+","bK",",","0.999999",",","1.0",")",";","}"]}]},e["line.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec3","aQ","=","u_diffuse_color",".","xyz",";","float","L","=","u_diffuse_color",".","a",";","aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["line.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec3","a_direction",";","uniform","mat3","u_model_tsr",";","uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","float","u_height",";","uniform","float","u_line_width",";","void","main","(",")","{","mat3","N","=","u_view_tsr",";","mat3","Z","=","u_model_tsr",";","au","aw","=","av","(","a_position",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","normalize","(","a_direction",")",",","Z",")",";","vec4","bM","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";","bM",".","xyz","/=","bM",".","w",";","vec4","bN","=","u_proj_matrix","*","vec4","(","ap","(","N",",","aw",".","O","+","aw",".","U",")",",","1.0",")",";","bN",".","xyz","/=","bN",".","w",";","float","bJ","=","u_proj_matrix","[","1","]","[","1","]","/","u_proj_matrix","[","0","]","[","0","]",";","vec2","bO","=","(","bN","-","bM",")",".","xy",";","bO",".","x","*=","bJ",";","float","bP","=","M_PI","/","2.0",";","mat2","bQ","=","mat2","(","cos","(","bP",")",",","sin","(","bP",")",",","-","sin","(","bP",")",",","cos","(","bP",")",")",";","bO","=","bQ","*","bO",";","bO","=","normalize","(","bO",")",";","vec2","bR","=","(","u_line_width","/","u_height",")","*","vec2","(","1.0","/","bJ",",","1.0",")",";","gl_Position","=","vec4","(","bM",".","xy","+","bO",".","xy","*","bR","/","2.0",",","bM",".","z",",","1.0",")",";","gl_Position","*=","bM",".","w",";","}"]}]},e["main.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"NORMAL_TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_PROJ_MATRIX_FRAG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"PARALLAX",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_SKY_DIM",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"WETTABLE",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"SSAO_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TEXTURE_LOD_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_TEXTURE_LOD_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_EXT_shader_texture_lod",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"caustics.glslf"}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS","USE_REFRACTION_CORRECTION",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_time",";","uniform","vec2","u_texel_size",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_BSDF_SKY_DIM",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_bsdf_cube_sky_dim",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_sun_quaternion",";","uniform","vec3","u_sun_intensity",";","uniform","vec3","u_sun_direction",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_PROJ_MATRIX_FRAG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_proj_matrix_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_lod_coverage",";","uniform","float","u_lod_cmp_logic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_STANDARD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_irradiance",";","uniform","samplerCube","u_cube_r_convolution",";","uniform","sampler2D","u_brdf",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shadow_mask",";"]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_csm_center_dists",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_NODE_BSDF_PRINCIPLED",{TYPE:"logical_or_expr",PLACES:2},"USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP","NUM_LAMP_LIGHTS",0,{TYPE:"non_equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_lamp_light_positions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_directions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_color_intensities","[","NUM_LAMP_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"nodes.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","C","(","u_lod_coverage",",","u_lod_cmp_logic",")",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bS","=","length","(","i",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bT","=","h",".","z","-","WATER_LEVEL",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","u_camera_eye_frag","-","h",")",";","vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","vec3","aQ","=","E",";","float","L","=","I",";","vec3","U","=","G",";","vec4","bU","=","H",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WETTABLE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","max","(","aQ","-","sqrt","(","0.01","*","-","min","(","bT",",","0.0",")",")",",","0.5","*","aQ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bV","(","aQ",",","bT",",","u_time",",","bU",",","U",",","u_sun_direction",",","u_sun_intensity",",","u_sun_quaternion",",","h",",","bS",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","min","(","1.0",",","L",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bW","(","aQ",",","bS",",","D",",","bT",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bW","(","aQ",",","bS",",","D",",","1.0",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bX","=","GLSL_TEXTURE_PROJ","(","u_shadow_mask",",","l",")",".","a",";","aQ","=","vec3","(","bX",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aQ","=","max","(","vec3","(","0.0",")",",","aQ",")",";","aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["main.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN",TOKENS:["0"]},{TYPE:"var",NAME:"USE_INSTANCED_PARTCLS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"PARALLAX",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_JITTER",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"MAC_OS_SHADOW_HACK",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM_MIX_NORMALS_FACTOR",TOKENS:["u_va_frame_factor"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"scale_texcoord.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_part_ts",";","GLSL_IN","vec4","a_part_r",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_bending_col_detail",";","AU_QUALIFIER","float","au_detail_bending_amp",";","AU_QUALIFIER","float","au_branch_bending_amp",";","AU_QUALIFIER","float","au_detail_bending_freq",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["AU_QUALIFIER","float","au_wind_bending_amp",";","AU_QUALIFIER","float","au_wind_bending_freq",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE",{TYPE:"logical_or_expr",PLACES:9}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","h",";","GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bY",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bZ",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","1.0",",","1.0",",","0.0",",","0.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"BILLBOARD","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_grass_map_depth",";","uniform","sampler2D","u_grass_map_color",";","uniform","vec4","u_camera_quat",";","uniform","vec3","u_grass_map_dim",";","uniform","float","u_grass_size",";","uniform","float","u_scale_threshold",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsb","[","MAX_BONES","]",";","uniform","vec4","u_transb","[","MAX_BONES","]",";","uniform","vec4","u_arm_rel_trans",";","uniform","vec4","u_arm_rel_quat",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsa","[","MAX_BONES","]",";","uniform","vec4","u_transa","[","MAX_BONES","]",";","uniform","float","u_frame_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","PRECISION","float","u_time",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_texture_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_normal_offset",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_v_light_tsr","[","NUM_CAST_LAMPS","]",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_v_light_ts","[","NUM_CAST_LAMPS","]",";","uniform","vec4","u_v_light_r","[","NUM_CAST_LAMPS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{TYPE:"include",FILE:"dynamic_grass.glslv"},{TYPE:"include",FILE:"shadow.glslv"},{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslv"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","b_","=","u_view_refl_matrix",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","b_","=","mat4","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["mat3","N","=","u_view_tsr",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","aZ","(","a_part_ts",".","xyz",",","aY","(",")",")",";","Z","=","a_","(","vec3","(","a_part_ts",".","w",")",",","Z",")",";","Z","=","bc","(","a_part_r",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","bd","(","u_model_tsr",",","Z",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","O","=","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_TBN_SHADING","CALC_TBN",{TYPE:"logical_and_expr",PLACES:2},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:14}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","P",",","Q",";","vec4","S","=","R","(","a_tbn",",","P",",","Q",")",";","vec3","ca","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:13}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","ca",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","T","(","S",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","W","=","Q","*","cross","(","U",",","V",")",";","vec4","Y","=","X","(","W",",","Q","*","P",")",";","V","=","T","(","Y",",","U",")",";"]}]}},{TYPE:"elif",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cb","=","ap","(","Z",",","O",")",";","vec3","ac","=","normalize","(","bI","(","Z",",","ca",")",")",";","vec3","D","=","cb","-","u_camera_eye",";","vec3","W","=","cross","(","D",",","ac",")",";","vec3","V","=","cross","(","ac",",","W",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ac","=","normalize","(","bI","(","Z",",","ca",")",")",";","vec3","ad","=","cross","(","vec3","(","0.0",",","0.0",",","1.0",")",",","ac",")",";","vec3","ae","=","cross","(","ac",",","ad",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","mix","(","O",",","a_position_next",",","u_va_frame_factor",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"USE_NODE_BSDF_BEGIN","USE_NODE_TEX_COORD_RE","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:10}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","af",",","ah",";","vec4","ai","=","R","(","a_tbn_next",",","af",",","ah",")",";","vec3","aj","=","T","(","ai",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_BSDF_BEGIN","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:8}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["U","=","mix","(","U",",","aj",",","VERTEX_ANIM_MIX_NORMALS_FACTOR",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ak","=","T","(","ai",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","al","=","ah","*","cross","(","aj",",","ak",")",";","vec4","am","=","X","(","al",",","ah","*","af",")",";","ak","=","T","(","am",",","aj",")",";","V","=","mix","(","V",",","ak",",","u_va_frame_factor",")",";","W","=","mix","(","W",",","al",",","u_va_frame_factor",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["an","(","O",",","V",",","W",",","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","a_part_ts",".","xyz",";","O","=","ap","(","Z",",","O",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","be","(","O",",","V",",","ae",",","W",",","U",",","ao",",","u_grass_map_depth",",","u_grass_map_color",",","u_grass_map_dim",",","u_grass_size",",","u_camera_eye",",","u_camera_quat",",","N",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","ao",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","(","b_","*","vec4","(","O",",","1.0",")",")",".","xyz",";","ao","=","(","b_","*","vec4","(","ao",",","1.0",")",")",".","xyz",";","aq","=","(","b_","*","vec4","(","aq",",","1.0",")",")",".","xyz",";"]}]}}]},{TYPE:"txt",TOKENS:["Z","=","as","(","u_camera_eye",",","aq",",","N",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","bf","=","aq",";","Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","bf",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","O","-","ao",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aA","=","(","dot","(","cross","(","aw",".","U",",","aw",".","V",")",",","aw",".","W",")","<","0.0",")","?","-","1.0",":","1.0",";","k","=","vec4","(","aw",".","V",",","aA",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["B","=","aw",".","aB",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","U",",","b_",")",";"]}]}}]},{TYPE:"txt",TOKENS:["h","=","aw",".","O",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:13}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","aw",".","U",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bY","=","u_camera_eye","-","aw",".","O",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","az","(","a_texcoord",",","u_texture_scale",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bZ","=","aw",".","aQ",";"]}]}},{TYPE:"elif",EXPRESSION:["VERTEX_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bZ","=","a_color",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cc","=","b_","*","vec4","(","aw",".","O",",","1.0",")",";","cc",".","xyz","=","ap","(","N",",","cc",".","xyz",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cc","=","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["i","=","cc",";"]}]}}]},{TYPE:"txt",TOKENS:["vec4","f","=","u_proj_matrix","*","cc",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["f",".","xy","+=","u_subpixel_jitter","*","f",".","w",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["l","=","aC","(","f",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cd","(","aw",".","O",",","aw",".","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"USE_NODE_B4W_REFRACTION",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["m","=","-","cc",".","z","/","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["J","(",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["main_stack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"TEXTURE_SPEC_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR0_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"TEXTURE_COLOR1_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"PARALLAX",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_PLANE"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_SPEC",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_AS_SPEC",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_STENCIL_ALPHA_MASK",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_STENCIL_ALPHA_MASK_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"NORMAL_TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"DOUBLE_SIDED_LIGHTING",TOKENS:["0"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"WETTABLE",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"PARALLAX_LOD_DIST",TOKENS:["5.0"]},{TYPE:"var",NAME:"PARALLAX_STEPS",TOKENS:["5.0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"SSAO_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"caustics.glslf"}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_time",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_sun_quaternion",";","uniform","vec3","u_sun_intensity",";","uniform","vec3","u_sun_direction",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_lod_coverage",";","uniform","float","u_lod_cmp_logic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_colormap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_SPEC","ALPHA_AS_SPEC",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_specmap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_STENCIL_ALPHA_MASK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_colormap1",";","uniform","sampler2D","u_stencil0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shadow_mask",";"]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_csm_center_dists",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";","uniform","float","u_specular_alpha",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_reflect_factor",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";","uniform","vec2","u_diffuse_params",";","uniform","float","u_diffuse_intensity",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_normal_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_diffuse_color_factor",";","uniform","float","u_alpha_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_SPEC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_specular_color_factor",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_specular_color",";","uniform","vec3","u_specular_params",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_parallax_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_refr_bump",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bY",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"shadow.glslf"}]}}]},{TYPE:"include",FILE:"mirror.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"refraction.glslf"}]}}]},{TYPE:"include",FILE:"environment.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"lighting_nodes.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","C","(","u_lod_coverage",",","u_lod_cmp_logic",")",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2},"SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"CAUSTICS","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:3},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bS","=","length","(","i",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bT","=","h",".","z","-","WATER_LEVEL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ce","=","A",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","cf","=","normalize","(","j",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing","==","false",")"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing",")"]}]}}]},{TYPE:"txt",TOKENS:["cf","=","cf",";","else","cf","=","-","cf",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","W","=","cross","(","cf",",","k",".","xyz",")","*","k",".","w",";","mat3","cg","=","mat3","(","k",".","xyz",",","W",",","cf",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","N","=","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ch","=","normalize","(","bI","(","N",",","j",")",")",".","st",";","ch","=","ch","*","vec2","(","0.495",")","+","vec2","(","0.5",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"PARALLAX",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","bS","<","PARALLAX_LOD_DIST",")","{","float","ci","=","clamp","(","0.5","*","(","PARALLAX_LOD_DIST","-","bS",")",",","0.0",",","1.0",")",";","float","cj","=","u_parallax_scale","*","ci",";","vec3","ck","=","normalize","(","bY","*","cg",")",";","float","cl","=","1.0","/","PARALLAX_STEPS",";","vec2","cm","=","ck",".","xy","*","cj","/","(","PARALLAX_STEPS","*","ck",".","z",")",";","float","cn","=","1.0",";","float","co",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","cp","=","ch",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","cp","=","ce",";"]}]}}]},{TYPE:"txt",TOKENS:["co","=","GLSL_TEXTURE","(","u_normalmap0",",","cp",")",".","a",";","for","(","float","cq","=","1.0",";","cq","<=","PARALLAX_STEPS",";","cq","++",")","{","if","(","co","<","cn",")","{","cn","-=","cl",";","cp","-=","cm",";","co","=","GLSL_TEXTURE","(","u_normalmap0",",","cp",")",".","a",";","}","}","vec2","cr","=","cp","+","cm",";","float","cs","=","GLSL_TEXTURE","(","u_normalmap0",",","cr",")",".","a","-","(","cn","+","cl",")",";","float","ct","=","co","-","cn",";","float","cu","=","ct","/","(","ct","-","cs",")",";","cp","=","cu","*","cr","+","(","1.0","-","cu",")","*","cp",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ce","+=","cp","-","ch",";"]}]}}]},{TYPE:"txt",TOKENS:["ch","=","cp",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ch","+=","cp","-","ce",";"]}]}}]},{TYPE:"txt",TOKENS:["ce","=","cp",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cv",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cv","=","GLSL_TEXTURE","(","u_normalmap0",",","ch",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cv","=","GLSL_TEXTURE","(","u_normalmap0",",","ce",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","cw","=","cv",".","rgb","-","0.5",";","cw","=","mix","(","vec3","(","0.0",",","0.0",",","1.0",")",",","cw",",","u_normal_factor",")",";","vec3","U","=","cg","*","cw",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","cf",";"]}]}}]},{TYPE:"txt",TOKENS:["U","=","normalize","(","U",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ch","=","normalize","(","bI","(","N",",","U",")",")",".","st",";","ch","=","ch","*","vec2","(","0.495",")","+","vec2","(","0.5",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","bY",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cx","=","bZ",";","bG","(","cx",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_COLOR","DYNAMIC_GRASS",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cy","=","vec4","(","cx",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cy","=","u_diffuse_color",";"]}]}}]},{TYPE:"txt",TOKENS:["float","cz","=","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cA","=","GLSL_TEXTURE","(","u_colormap0",",","ch",")",";"]}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cA","=","GLSL_TEXTURE","(","u_colormap0",",","ce",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bG","(","cA",".","rgb",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_STENCIL_ALPHA_MASK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cB",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cB","=","GLSL_TEXTURE","(","u_colormap1",",","ch",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cB","=","GLSL_TEXTURE","(","u_colormap1",",","ce",")",";"]}]}}]},{TYPE:"txt",TOKENS:["bG","(","cB",".","rgb",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_STENCIL_ALPHA_MASK_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cC","=","GLSL_TEXTURE","(","u_stencil0",",","ch",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cC","=","GLSL_TEXTURE","(","u_stencil0",",","ce",")",";"]}]}}]},{TYPE:"txt",TOKENS:["cA","=","mix","(","cA",",","cB",",","cC",".","r",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cy",".","rgb","=","mix","(","cy",".","rgb",",","cA",".","rgb",",","u_diffuse_color_factor",")",";","float","M","=","u_alpha_factor","*","cA",".","a",";","M","+=","(","1.0","-","step","(","0.0",",","M",")",")",";","cy",".","a","=","mix","(","M",",","1.0",",","u_diffuse_color",".","a",")",";","cz","=","cA",".","a",";"]}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cy",".","rgb","*=","mix","(","vec3","(","1.0",")",",","cA",".","rgb",",","u_diffuse_color_factor",")",";","cy",".","a","=","cA",".","a",";","cz","=","cA",".","a",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aQ","=","cy",".","rgb",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cD","=","u_diffuse_intensity","*","cy",".","rgb",";","vec3","cF","=","u_environment_energy","*","cE","(","U",")",";","vec3","cG","=","u_ambient","*","cF",";","vec4","bU","=","cH","(","cD",")",";","vec3","cI","=","u_emit","*","cy",".","rgb",";","vec3","cJ","=","u_specular_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_SPEC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_AS_SPEC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cK","=","vec3","(","cz",")",";"]}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cK","=","GLSL_TEXTURE","(","u_specmap0",",","ch",")",".","rgb",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cK","=","GLSL_TEXTURE","(","u_specmap0",",","ce",")",".","rgb",";"]}]}}]},{TYPE:"txt",TOKENS:["bG","(","cK",".","rgb",")",";","cJ","=","mix","(","cJ",",","cK",",","u_specular_color_factor",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","cL","=","u_specular_params","[","0","]",";","vec2","cM","=","vec2","(","u_specular_params","[","1","]",",","u_specular_params","[","2","]",")",";","vec3","cN","=","cL","*","cJ",";","vec3","aQ",";","vec3","cO",";","cP","(","cI",",","cG",",","cD",",","cN",",","h",",","U",",","D",",","cM",",","u_diffuse_params",",","bU",",","0.0",",","vec4","(","0.0",")",",","aQ",",","cO",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cQ","(","aQ",",","D",",","U",",","u_reflect_factor",",","N",")",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cQ","(","aQ",",","D",",","U",",","u_reflect_factor",",","mat3","(","0.0",")",")",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cQ","(","aQ",",","D",",","U",",","u_mirror_factor",",","mat3","(","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","+=","cO",";"]}]}}]},{TYPE:"txt",TOKENS:["float","L","=","cy",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WETTABLE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","max","(","aQ","-","sqrt","(","0.01","*","-","min","(","bT",",","0.0",")",")",",","0.5","*","aQ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAUSTICS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bV","(","aQ",",","bT",",","u_time",",","bU",",","U",",","u_sun_direction",",","u_sun_intensity",",","u_sun_quaternion",",","h",",","bS",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","cO",".","r",",","cO",".","g",")",",","cO",".","b",")","*","u_specular_alpha",";","L","=","cy",".","a","*","(","1.0","-","t",")","+","t",";"]}]}}]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","cR","=","-","(","bI","(","N",",","U",")",")",".","xy",";","aQ","=","mix","(","cS","(","l",",","cR","*","u_refr_bump",")",",","aQ",",","L",")",";","L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bW","(","aQ",",","bS",",","D",",","bT",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bW","(","aQ",",","bS",",","D",",","1.0",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bX","=","GLSL_TEXTURE_PROJ","(","u_shadow_mask",",","l",")",".","a",";","aQ","=","vec3","(","bX",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["node_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bu",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"nodes.glslf"},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","USE_NODE_TEXTURE_ENVIRONMENT_MIRROR_BALL","USE_NODE_GEOMETRY_NO","USE_NODE_GEOMETRY_GL","USE_NODE_GEOMETRY_IN","USE_NODE_TEX_COORD_GE","USE_NODE_TEX_COORD_OB","USE_NODE_TEX_COORD_NO","USE_NODE_B4W_REFLECT_WORLD",{TYPE:"logical_or_expr",PLACES:9}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D","=","-","normalize","(","bu",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","E","=","max","(","vec3","(","0.0",")",",","E",")",";","aW","(","E",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","E",",","_1_0",")",";","}"]}]},e["particle_system.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"NORMAL_TEXCOORD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_STRENGTH",TOKENS:["0.25"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TEXTURE_LOD_EXT",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_TEXTURE_LOD_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_EXT_shader_texture_lod",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","NODES",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","float","u_time",";","uniform","vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_lamp_light_positions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_directions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_color_intensities","[","NUM_LAMP_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";","uniform","float","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:7}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","j",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"particles_nodes.glslf"},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec3","D","=","normalize","(","u_camera_eye_frag","-","h",")",";","vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","vec3","aQ","=","E",";","float","L","=","I",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","min","(","1.0",",","L",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bW","(","aQ",",","length","(","i",")",",","D",",","1.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","cT","=","-","i",".","z","/","u_view_max_depth",";","vec4","cU","=","GLSL_TEXTURE_PROJ","(","u_scene_depth",",","l",")",";","float","cW","=","cV","(","cU",")",";","float","cX","=","cW","-","cT",";","float","cY","=","u_view_max_depth","/","SOFT_STRENGTH","*","cX",";","L","=","L","*","min","(","cY",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["particle_system.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"BILLBOARD_ALIGN",TOKENS:["BILLBOARD_ALIGN_VIEW"]},{TYPE:"var",NAME:"TEXTURE_NORM_CO",TOKENS:["TEXTURE_COORDS_NONE"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"HALO_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"PARTICLES_SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"COLOR_RAMP_LENGTH",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"WORLD_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_COLOR_RAMP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";","GLSL_IN","vec3","a_p_data",";","GLSL_IN","vec4","a_p_vels",";","GLSL_IN","vec2","a_p_bb_vertex",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","cZ",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:8}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","h",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bY",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","bk",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_p_color_ramp","[","COLOR_RAMP_LENGTH","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_p_time",";","uniform","float","u_p_length",";","uniform","int","u_p_cyclic",";","uniform","float","u_p_fade_in",";","uniform","float","u_p_fade_out",";","uniform","float","u_p_nfactor",";","uniform","float","u_p_gravity",";","uniform","float","u_p_mass",";","uniform","float","u_p_wind_fac",";","uniform","float","u_p_max_lifetime",";","uniform","float","u_p_tilt",";","uniform","float","u_p_tilt_rand",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_view_refl_matrix",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","vec3","u_wind",";","uniform","float","u_p_size",";","uniform","vec3","u_camera_eye",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WORLD_SPACE",{TYPE:"logic_negative_expr",PLACES:1},"NODES","HALO_PARTICLES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_COLOR_RAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"particles.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"particles_nodes.glslv"}]}}]},{TYPE:"txt",TOKENS:["float","db","(","vec2","c_",",","vec2","da",")","{","return","(","atan","(","da",".","y",",","da",".","x",")","-","atan","(","c_",".","y",",","c_",".","x",")",")",";","}","void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","b_","=","u_view_refl_matrix",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","b_","=","mat4","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["mat3","N","=","u_view_tsr",";","dc","pp",";","pp","=","dd","(",")",";","float","de",";","mat3","bo","=","aY","(",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","df","=","(","b_","*","vec4","(","pp",".","O",",","1.0",")",")",".","xyz",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","df","=","pp",".","O",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","U","=","vec3","(","0.0",",","-","1.0",",","0.0",")",";","if","(","BILLBOARD_ALIGN","==","BILLBOARD_ALIGN_VIEW",")","{","de","=","pp",".","bP",";","bo","=","bn","(","df",",","N",")",";","}","else","if","(","BILLBOARD_ALIGN","==","BILLBOARD_ALIGN_XY",")","{","de","=","db","(","vec2","(","EPSILON",",","1.0",")",",","vec2","(","U",".","x",",","-","U",".","y",")",")","+","pp",".","bP",";","bo","=","aZ","(","df",",","bo",")",";","vec4","dg","=","X","(","RIGHT_VECTOR",",","-","M_PI","/","2.0",")",";","bo","=","bc","(","dg",",","bo",")",";","}","else","if","(","BILLBOARD_ALIGN","==","BILLBOARD_ALIGN_YZ",")","{","de","=","pp",".","bP",";","bo","=","aZ","(","df",",","bo",")",";","vec4","dh","=","X","(","UP_VECTOR",",","M_PI","/","2.0",")",";","bo","=","bc","(","dh",",","bo",")",";","}","else","if","(","BILLBOARD_ALIGN","==","BILLBOARD_ALIGN_ZX",")","{","de","=","pp",".","bP",";","bo","=","aZ","(","df",",","bo",")",";","}","vec3","bs","=","vec3","(","(","a_p_bb_vertex","[","0","]","*","2.0","-","1.0",")","*","pp",".","di","*","u_p_size",",","0.0",",","(","a_p_bb_vertex","[","1","]","*","2.0","-","1.0",")","*","pp",".","di","*","u_p_size",")",";","float","dj","=","a_p_data","[","2","]",";","float","dk","=","u_p_tilt","*","u_p_tilt_rand","*","(","2.0","*","dj","-","1.0",")",";","float","dl","=","(","dk","+","u_p_tilt",")","*","M_PI",";","vec4","dm","=","X","(","TOWARD_VECTOR",",","dl","+","de",")",";","vec3","bt","=","ap","(","bo",",","T","(","dm",",","bs",")",")",";","vec4","cc","=","vec4","(","ap","(","N",",","bt",")",",","1.0",")",";","vec4","f","=","u_proj_matrix","*","cc",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bk","=","dj",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","dn","=","aY","(",")",";","dm","=","X","(","TOWARD_VECTOR",",","de",")",";","dn","=","bc","(","dm",",","dn",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE","NODES",{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},"USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","1.0",",","0.0",",","0.0",")",";","vec3","W","=","vec3","(","0.0",",","0.0",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","vec3","(","0.0",")",",","vec3","(","0.0",")",",","V",",","vec3","(","0.0",")",",","W",",","U",",","bd","(","bo",",","dn",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_NORM_CO","TEXTURE_COORDS_NONE",{TYPE:"non_equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_TBN_SHADING",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aA","=","(","dot","(","cross","(","aw",".","U",",","aw",".","V",")",",","aw",".","W",")","<","0.0",")","?","-","1.0",":","1.0",";","k","=","vec4","(","aw",".","V",",","aA",")",";"]}]}}]},{TYPE:"txt",TOKENS:["J","(","pp",".","O",",","pp",".","dp",",","pp",".","dq",",","pp",".","dr",",","pp",".","di",",","a_p_bb_vertex",",","a_p_data","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","U",",","bd","(","bo",",","dn",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_p_bb_vertex",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_p_bb_vertex","*","2.0","-","1.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cZ","=","pp",".","L",";"]}]}}]},{TYPE:"txt",TOKENS:["bZ","=","pp",".","aQ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1},"PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:11}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","aw",".","U",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["l","=","aC","(","f",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["i","=","cc",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","h","=","bt",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bY","=","u_camera_eye","-","bt",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["particle_system_stack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_STRENGTH",TOKENS:["0.25"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"HALO_PARTICLES",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"PARTICLES_SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","NODES",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sampler",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec2","u_diffuse_params",";","uniform","float","u_diffuse_intensity",";","uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec3","u_specular_color",";","uniform","vec3","u_specular_params",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_halo_size",";","uniform","vec3","u_halo_rings_color",";","uniform","float","u_halo_hardness",";","uniform","vec3","u_halo_lines_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_sun_intensity",";","uniform","float","u_halo_stars_blend",";","uniform","float","u_halo_stars_height",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_p_alpha_start",";","uniform","float","u_p_alpha_end",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";","uniform","float","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:8}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","cZ",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bY",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"NODES",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","bk",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","bj",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","j",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"lighting_nodes.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"environment.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"halo_color.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","bY",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HALO_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","bm","=","bl","(",")",";","vec3","aQ","=","bm",".","rgb","*","bZ",";","float","ds","=","0.9","*","length","(","A",")",";","float","dt","=","smoothstep","(","u_p_alpha_start",",","u_p_alpha_end",",","ds",")",";","float","L","=","bm",".","a","*","(","1.0","-","dt",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cy","=","u_diffuse_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cA","=","GLSL_TEXTURE","(","u_sampler",",","A",")",";","bG","(","cA",".","rgb",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cy",".","rgb","=","mix","(","cy",".","rgb",",","cA",".","rgb",",","u_diffuse_color_factor",")",";"]}]}},{TYPE:"elif",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cy",".","rgb","*=","mix","(","vec3","(","1.0",")",",","cA",".","rgb",",","u_diffuse_color_factor",")",";"]}]}}]},{TYPE:"txt",TOKENS:["cy",".","a","=","cA",".","a",";"]}]}}]},{TYPE:"txt",TOKENS:["cy",".","rgb","*=","bZ",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PARTICLES_SHADELESS",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cD","=","u_diffuse_intensity","*","cy",".","rgb",";","vec3","cI","=","u_emit","*","cy",".","rgb",";","vec3","U","=","normalize","(","j",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logic_negative_expr",PLACES:1},"SKY_COLOR",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cF","=","u_environment_energy","*","cE","(","vec3","(","0.0",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cF","=","u_environment_energy","*","cE","(","U",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","cG","=","u_ambient","*","cF",";","float","cL","=","u_specular_params","[","0","]",";","vec2","cM","=","vec2","(","u_specular_params","[","1","]",",","u_specular_params","[","2","]",")",";","vec3","cN","=","cL","*","u_specular_color",";","vec3","aQ",";","vec3","cO",";","cP","(","cI",",","cG",",","cD",",","cN",",","h",",","U",",","D",",","cM",",","u_diffuse_params",",","vec4","(","1.0",")",",","0.0",",","vec4","(","0.0",")",",","aQ",",","cO",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aQ","=","cy",".","rgb",";"]}]}}]},{TYPE:"txt",TOKENS:["float","L","=","cy",".","a","*","cZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA_CLIP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";","L","=","1.0",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bW","(","aQ",",","length","(","i",")",",","D",",","1.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","cT","=","-","i",".","z","/","u_view_max_depth",";","vec4","cU","=","GLSL_TEXTURE_PROJ","(","u_scene_depth",",","l",")",";","float","cW","=","cV","(","cU",")",";","float","cX","=","cW","-","cT",";","float","cY","=","u_view_max_depth","/","SOFT_STRENGTH","*","cX",";","L","=","L","*","min","(","cY",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA","ALPHA_CLIP",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["proc_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","vec3","u_sky_color",";","uniform","vec3","u_sun_direction",";","uniform","float","u_rayleigh_brightness",";","uniform","float","u_mie_brightness",";","uniform","float","u_spot_brightness",";","uniform","float","u_scatter_strength",";","uniform","float","u_rayleigh_strength",";","uniform","float","u_mie_strength",";","uniform","float","u_rayleigh_collection_power",";","uniform","float","u_mie_collection_power",";","uniform","float","u_mie_distribution",";","GLSL_IN","vec3","bu",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","const","float","du","=","0.99",";","const","float","dv","=","1.8",";","const","int","dw","=","8",";","float","dB","(","vec3","O",",","vec3","bH",")","{","float","a","=","dot","(","bH",",","bH",")",";","float","b","=","2.0","*","dot","(","bH",",","O",")",";","float","dx","=","dot","(","O",",","O",")","-","1.0",";","float","dy","=","b","*","b","-","4.0","*","a","*","dx",";","float","dz","=","sqrt","(","dy",")",";","float","q","=","(","-","b","-","dz",")","/","2.0",";","float","dA","=","dx","/","q",";","return","dA",";","}","float","dD","(","float","L",",","float","g",")","{","float","a","=","3.0","*","(","1.0","-","g","*","g",")",";","float","b","=","2.0","*","(","2.0","+","g","*","g",")",";","float","dx","=","1.0","+","L","*","L",";","float","dC","=","pow","(","1.0","+","g","*","g","-","2.0","*","g","*","L",",","1.5",")",";","dC","=","max","(","dC",",","0.00001",")",";","return","(","a","/","b",")","*","(","dx","/","dC",")",";","}","float","dI","(","vec3","O",",","vec3","bH",",","float","dE",")","{","float","dF","=","dot","(","bH",",","-","O",")",";","if","(","dF","<","0.0",")","{","return","1.0",";","}","vec3","dG","=","O","+","dF","*","bH",";","if","(","length","(","dG",")","<","dE",")","{","return","0.0",";","}","else","if","(","length","(","dG",")",">=","dE",")","{","vec3","da","=","normalize","(","dG",")","*","dE","-","O",";","float","dH","=","acos","(","dot","(","normalize","(","da",")",",","bH",")",")",";","return","smoothstep","(","0.0",",","1.0",",","pow","(","dH","*","2.0",",","3.0",")",")",";","}","else","return","1.0",";","}","vec3","dJ","(","float","aM",",","vec3","aQ",",","float","aL",")","{","return","aQ","-","aQ","*","pow","(","u_sky_color",",","vec3","(","aL","/","aM",")",")",";","}","void","main","(",")","{","vec3","bv","=","normalize","(","bu",")",";","vec3","dK","=","u_sun_direction",";","float","L","=","dot","(","bv",",","dK",")",";","float","dL","=","dD","(","L",",","-","0.01",")","*","u_rayleigh_brightness","*","dK",".","z",";","float","dM","=","dD","(","L","-","0.5",",","u_mie_distribution",")","*","u_mie_brightness","*","(","1.0","-","dK",".","z",")",";","float","dN","=","smoothstep","(","0.0",",","100.0",",","dD","(","L",",","0.9995",")",")","*","u_spot_brightness",";","vec3","dO","=","vec3","(","0.0",",","0.0",",","du",")",";","float","dP","=","dB","(","dO",",","bv",")",";","float","dQ","=","dP","/","float","(","dw",")",";","float","dR","=","dI","(","dO",",","bv",",","du","-","0.3",")",";","vec3","dS","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec3","dT","=","vec3","(","0.0",",","0.0",",","0.0",")",";","for","(","int","cq","=","0",";","cq","<","dw",";","cq","++",")","{","float","dU","=","dQ","*","float","(","cq",")",";","vec3","O","=","dO","+","bv","*","dU",";","float","dV","=","dI","(","O",",","dK",",","du","-","0.2",")",";","float","dW","=","dB","(","O",",","dK",")",";","vec3","dX","=","dJ","(","dW",",","vec3","(","dv",")",",","u_scatter_strength",")","*","dV",";","dS","+=","dJ","(","sqrt","(","dU",")",",","u_sky_color","*","dX",",","u_rayleigh_strength",")",";","dT","+=","dJ","(","dU",",","dX",",","u_mie_strength",")",";","}","dS","=","dS","*","dR","*","pow","(","dP",",","u_rayleigh_collection_power",")","/","float","(","dw",")",";","dT","=","(","dT","*","dR","*","pow","(","dP",",","u_mie_collection_power",")",")","/","float","(","dw",")",";","vec3","aQ","=","vec3","(","dN","*","dT","+","dM","*","dT","+","dL","*","dS",")",";","aW","(","aQ",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","1.0",")",";","}"]}]},e["r_convolution_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_reflection",";","uniform","float","u_roughness",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","GLSL_IN","vec3","bu",";","float","eb","(","int","cw",",","int","dY",")","{","float","dZ","=","1.0","/","float","(","dY",")",";","float","d_","=","1.0",";","float","ea","=","0.0",";","for","(","int","cq","=","0",";","cq","<","32",";","++","cq",")","{","if","(","cw",">","0",")","{","d_","=","mod","(","float","(","cw",")",",","2.0",")",";","ea","+=","d_","*","dZ",";","dZ","=","dZ","/","2.0",";","cw","=","int","(","float","(","cw",")","/","2.0",")",";","}","}","return","ea",";","}","vec2","ed","(","int","cq",",","int","ec",")","{","return","vec2","(","float","(","cq",")","/","float","(","ec",")",",","eb","(","cq",",","2",")",")",";","}","vec3","ek","(","vec2","ee",",","vec3","ec",",","float","ef",")","{","float","a","=","ef","*","ef",";","float","bC","=","2.0","*","M_PI","*","ee",".","x",";","float","eg","=","sqrt","(","(","1.0","-","ee",".","y",")","/","(","1.0","+","(","a","*","a","-","1.0",")","*","ee",".","y",")",")",";","float","eh","=","sqrt","(","1.0","-","eg","*","eg",")",";","vec3","ei",";","ei",".","x","=","cos","(","bC",")","*","eh",";","ei",".","y","=","sin","(","bC",")","*","eh",";","ei",".","z","=","eg",";","vec3","by","=","abs","(","ec",".","z",")","<","0.999","?","vec3","(","0.0",",","0.0",",","1.0",")",":","vec3","(","1.0",",","0.0",",","0.0",")",";","vec3","V","=","normalize","(","cross","(","by",",","ec",")",")",";","vec3","ej","=","cross","(","ec",",","V",")",";","vec3","bF","=","V","*","ei",".","x","+","ej","*","ei",".","y","+","ec","*","ei",".","z",";","return","normalize","(","bF",")",";","}","void","main","(",")","{","vec3","el","=","vec3","(","0.0",")",";","if","(","u_roughness","!=","0.0",")","{","vec3","ec","=","normalize","(","bu",")",";","vec3","em","=","ec",";","vec3","en","=","em",";","const","int","eo","=","1024",";","float","ep","=","0.0",";","for","(","int","cq","=","0",";","cq","<","eo",";","++","cq",")","{","vec2","ee","=","ed","(","cq",",","eo",")",";","vec3","ei","=","ek","(","ee",",","ec",",","u_roughness",")",";","vec3","eq","=","normalize","(","2.0","*","dot","(","en",",","ei",")","*","ei","-","en",")",";","float","er","=","max","(","dot","(","ec",",","eq",")",",","0.0",")",";","if","(","er",">","0.0",")","{","vec3","bw","=","GLSL_TEXTURE_CUBE","(","u_sky_reflection",",","eq",")",".","rgb",";","bG","(","bw",")",";","el","+=","bw","*","er",";","ep","+=","er",";","}","}","el","=","el","/","ep",";","}","else","{","vec3","bw","=","GLSL_TEXTURE_CUBE","(","u_sky_reflection",",","normalize","(","bu",")",")",".","rgb",";","bG","(","bw",")",";","el","=","bw",";","}","GLSL_OUT_FRAG_COLOR","=","vec4","(","el",",","1.0",")",";","}"]}]},e["shadow.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"SHADELESS",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR_INVERSE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_VIEW_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_MODEL_TSR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LAMP_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_BLEND_TYPE",TOKENS:["TEXTURE_BLEND_TYPE_MIX"]},{TYPE:"var",NAME:"NUM_VALUES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_RGBS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"USE_LOD_SMOOTHING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1","USE_DERIVATIVES_EXT",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"coverage.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_time",";","uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye_frag",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2},"CAMERA_TYPE","CAM_TYPE_ORTHO",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_direction",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_VIEW_TSR",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_VIEW_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_MODEL_TSR_INVERSE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr_inverse",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_cube_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_emit",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_refl_plane",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_LAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_lamp_light_positions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_directions","[","NUM_LAMP_LIGHTS","]",";","uniform","vec3","u_lamp_light_color_intensities","[","NUM_LAMP_LIGHTS","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_VALUE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_node_values","[","NUM_VALUES","]",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_RGB"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_node_rgbs","[","NUM_RGBS","]",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_colormap0",";","uniform","float","u_alpha_factor",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_pcf_blur_radii",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_csm_center_dists",";","uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","GLSL_SMPLR2D_SHDW","u_shadow_map3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_OBJECT_INFO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_obj_info",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS","SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_camera_range",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_lod_coverage",";","uniform","float","u_lod_cmp_logic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","h",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","k",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},"RGBA_SHADOWS",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADELESS",{TYPE:"logic_negative_expr",PLACES:1},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"shadow.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_LOD_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","C","(","u_lod_coverage",",","u_lod_cmp_logic",")",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","u_camera_eye_frag","-","h",")",";","vec3","E",";","vec3","F",";","vec3","G",";","vec4","H",";","float","I",";","J","(","D",",","E",",","F",",","G",",","H",",","I",")",";","float","L","=","I",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","(","GLSL_TEXTURE","(","u_colormap0",",","A",")",")",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","M","=","u_alpha_factor","*","L",";","M","+=","(","1.0","-","step","(","0.0",",","M",")",")",";","L","=","mix","(","M",",","1.0",",","u_diffuse_color",".","a",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","u_diffuse_color",".","a",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["if","(","L","<","0.5",")","discard",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","NO_SHADOWS",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","et","=","es","(","-","i",".","z",",","u_camera_range",")",";","GLSL_OUT_FRAG_COLOR","=","eu","(","et",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",")",";"]}]}}]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","ev","(","i",".","z",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR",".","a","*=","clamp","(","k",".","r",",","0.999999999",",","1.0",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["shadow.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN",TOKENS:["0"]},{TYPE:"var",NAME:"USE_INSTANCED_PARTCLS",TOKENS:["0"]},{TYPE:"var",NAME:"NODES",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"SMAA_JITTER",TOKENS:["0"]},{TYPE:"var",NAME:"MAC_OS_SHADOW_HACK",TOKENS:["0"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"AU_QUALIFIER",TOKENS:["GLSL_IN"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"HAIR_BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_TEX_RES",TOKENS:["2048.0"]},{TYPE:"var",NAME:"VERTEX_ANIM",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"TEXTURE_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"VERTEX_ANIM_MIX_NORMALS_FACTOR",TOKENS:["u_va_frame_factor"]},{TYPE:"var",NAME:"MAX_BONES",TOKENS:["0"]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"scale_texcoord.glslv"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";","GLSL_IN","vec4","a_tbn",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_part_ts",";","GLSL_IN","vec4","a_part_r",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_influence",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_bending_col_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_bending_col_detail",";","AU_QUALIFIER","float","au_detail_bending_amp",";","AU_QUALIFIER","float","au_branch_bending_amp",";","AU_QUALIFIER","float","au_detail_bending_freq",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["AU_QUALIFIER","float","au_wind_bending_amp",";","AU_QUALIFIER","float","au_wind_bending_freq",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position_next",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn_next",";"]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","h",";","GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","k",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},"RGBA_SHADOWS",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","i",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","n",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","o",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","u",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","v",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","1.0",",","1.0",",","0.0",",","0.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","mat3","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_grass_map_depth",";","uniform","sampler2D","u_grass_map_color",";","uniform","vec4","u_camera_quat",";","uniform","vec3","u_grass_map_dim",";","uniform","float","u_grass_size",";","uniform","float","u_scale_threshold",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsb","[","MAX_BONES","]",";","uniform","vec4","u_transb","[","MAX_BONES","]",";","uniform","vec4","u_arm_rel_trans",";","uniform","vec4","u_arm_rel_quat",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_quatsa","[","MAX_BONES","]",";","uniform","vec4","u_transa","[","MAX_BONES","]",";","uniform","float","u_frame_factor",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_jitter_amp",";","uniform","float","u_jitter_freq",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_wind",";","uniform","PRECISION","float","u_time",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_va_frame_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logic_negative_expr",PLACES:1},"TEXTURE_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_texture_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_normal_offset",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_v_light_tsr","[","NUM_CAST_LAMPS","]",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_v_light_ts","[","NUM_CAST_LAMPS","]",";","uniform","vec4","u_v_light_r","[","NUM_CAST_LAMPS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{TYPE:"include",FILE:"dynamic_grass.glslv"},{TYPE:"include",FILE:"shadow.glslv"},{TYPE:"include",FILE:"skin.glslv"},{TYPE:"include",FILE:"wind_bending.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"nodes.glslv"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","mat3","N","=","u_view_tsr",";","vec3","O","=","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_NO","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:13}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","P",",","Q",";","vec4","S","=","R","(","a_tbn",",","P",",","Q",")",";","vec3","ca","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";","vec3","U","=","ca",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","U","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA","CALC_TBN_SPACE",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","T","(","S",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","W","=","Q","*","cross","(","U",",","V",")",";","vec4","Y","=","X","(","W",",","Q","*","P",")",";","V","=","T","(","Y",",","U",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","0.0",")",";","vec3","W","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["VERTEX_ANIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","mix","(","O",",","a_position_next",",","u_va_frame_factor",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","af",",","ah",";","vec4","ai","=","R","(","a_tbn_next",",","af",",","ah",")",";","vec3","aj","=","T","(","ai",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";","U","=","mix","(","U",",","aj",",","VERTEX_ANIM_MIX_NORMALS_FACTOR",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ak","=","T","(","ai",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";","vec3","al","=","ah","*","cross","(","aj",",","ak",")",";","vec4","am","=","X","(","al",",","ah","*","af",")",";","ak","=","T","(","am",",","aj",")",";","V","=","mix","(","V",",","ak",",","u_va_frame_factor",")",";","W","=","mix","(","W",",","al",",","u_va_frame_factor",")",";"]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["an","(","O",",","V",",","W",",","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_INSTANCED_PARTCLS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","aZ","(","a_part_ts",".","xyz",",","aY","(",")",")",";","Z","=","a_","(","vec3","(","a_part_ts",".","w",")",",","Z",")",";","Z","=","bc","(","a_part_r",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","bd","(","u_model_tsr",",","Z",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","Z","=","u_model_tsr",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{TYPE:"logical_or_expr",PLACES:3},"USE_INSTANCED_PARTCLS",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","au_center_pos",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","a_part_ts",".","xyz",";","O","=","ap","(","Z",",","O",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ao","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ac","=","normalize","(","_","(","Z",",","ca",")",")",";","vec3","ad","=","cross","(","vec3","(","0.0",",","0.0",",","1.0",")",",","ac",")",";","vec3","ae","=","cross","(","ac",",","ad",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","a_shade_tangs",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ae","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","be","(","O",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","U",",","ao",",","u_grass_map_depth",",","u_grass_map_color",",","u_grass_map_dim",",","u_grass_size",",","u_camera_eye",",","u_camera_quat",",","N",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aq","=","ap","(","Z",",","ao",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["HAIR_BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","ew","=","u_shadow_cast_billboard_view_tsr",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","ew","=","N",";"]}]}}]},{TYPE:"txt",TOKENS:["Z","=","as","(","u_camera_eye",",","aq",",","ew",",","Z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND","BILLBOARD_JITTERED",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","at","(","u_wind",",","u_time",",","u_jitter_amp",",","u_jitter_freq",",","aq",",","Z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","O","-","ao",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";","aw",".","ao","=","aq",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["au","aw","=","av","(","O",",","ao",",","V",",","ae",",","W",",","U",",","Z",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ay","=","ca",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ay","=","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["ax","(","aw",".","O",",","aw",".","ao",",","ay",",","mat4","(","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["h","=","aw",".","O",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{TYPE:"logical_and_expr",PLACES:3},"USE_NODE_TEX_COORD_NO","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:12}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","aw",".","U",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","aA","=","(","dot","(","cross","(","aw",".","U",",","aw",".","V",")",",","aw",".","W",")","<","0.0",")","?","-","1.0",":","1.0",";","k","=","vec4","(","aw",".","V",",","aA",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["B","=","aw",".","aB",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec4","cc","=","vec4","(","ap","(","N",",","aw",".","O",")",",","1.0",")",";","vec4","f","=","u_proj_matrix","*","cc",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_JITTER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["f",".","xy","+=","u_subpixel_jitter","*","f",".","w",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["l","=","aC","(","f",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["m","=","-","cc",".","z","/","u_view_max_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["J","(",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["TEXTURE_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","az","(","a_texcoord",",","u_texture_scale",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cd","(","aw",".","O",",","aw",".","U",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"NODES","ALPHA",{TYPE:"logical_and_expr",PLACES:2},"SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2},"RGBA_SHADOWS",{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["i","=","cc",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ey","=","(","u_proj_matrix","*","vec4","(","ex","(","N",")",",","1.0",")",")",".","xy",";","float","ez","=","SHADOW_TEX_RES","/","2.0",";","ey","=","floor","(","ey","*","ez","+","0.5",")","/","ez","-","ey",";","f",".","xy","+=","ey",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["sky.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYREAL",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"var",NAME:"PROCEDURAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYPAPER",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"REFLECTION_PASS","REFL_PASS_NONE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_camera_eye_frag",";","uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND","WO_SKYPAPER",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_sky_tex_fac",";","uniform","vec3","u_sky_tex_color",";","uniform","float","u_sky_tex_dvar",";","uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND","WO_SKYPAPER","WO_SKYTEX",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"sky_blending.glslf"}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bu",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec3","bw",";","vec3","bv","=","normalize","(","bu",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND","WO_SKYPAPER",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eA","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYREAL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eA","=","abs","(","A",".","y",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eA","=","(","A",".","y","+","1.0",")","*","0.5",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","eB","=","u_horizon_color",";","vec3","eC","=","u_zenith_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","eD","=","vec3","(","A",",","0.0",")",";","vec4","eE","=","GLSL_TEXTURE_CUBE","(","u_sky",",","bv",")",";","bG","(","eE",".","rgb",")",";","bw","=","eF","(","eB",",","eC",",","eE",",","eA",",","eD",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bw","=","mix","(","eB",",","eC",",","eA",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bw","=","GLSL_TEXTURE_CUBE","(","u_sky",",","bv",")",".","rgb",";","bG","(","bw",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"REFLECTION_PASS","REFL_PASS_NONE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eG","=","WATER_LEVEL","-","u_camera_eye_frag",".","z",";","vec3","eH","=","vec3","(","0.0",")",";","vec3","eI","=","mix","(","u_underwater_fog_color_density",".","rgb",",","eH",",","min","(","-","bv",".","z",",","1.0",")",")",";","eI","*=","min","(","1.0","-","min","(","0.03","*","eG",",","0.8",")",",","1.0",")",";","float","aL","=","clamp","(","sign","(","0.01","*","eG","-","bv",".","z",")",",","0.0",",","1.0",")",";","bw","=","mix","(","bw",",","eI",",","aL",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","bw",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","bw",",","1.0",")",";","}"]}]},e["sky.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PROCEDURAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","mat4","u_sky_vp_inverse",";","GLSL_IN","vec3","a_position",";","GLSL_OUT","vec3","bu",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec4","O","=","vec4","(","a_position",".","xy",",","0.9999999",",","1.0",")",";","vec4","bv","=","u_sky_vp_inverse","*","O",";","bu","=","bv",".","xyz",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_position",".","xy",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","O",";","}"]}]},e["skybox.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PROCEDURAL_SKYDOME",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_view_matrix",";","GLSL_IN","vec3","a_position",";","GLSL_OUT","vec3","bu",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec4","O","=","vec4","(","a_position",".","xy",",","0.999999",",","1.0",")",";","vec4","bv","=","u_cube_view_matrix","*","O",";","bu","=","bv",".","xyz",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_SKYDOME",{TYPE:"logic_negative_expr",PLACES:1},"WO_SKYTEX","WO_SKYBLEND",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_position",".","xy",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","O",";","}"]}]},e["tex_skybox.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"WO_SKYTEX",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYREAL",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYPAPER",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","GLSL_IN","vec3","bu",";","GLSL_IN","vec2","A",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_sky_tex_fac",";","uniform","vec3","u_sky_tex_color",";","uniform","float","u_sky_tex_dvar",";","uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"sky_blending.glslf"}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","vec3","bv","=","normalize","(","bu",")",";","vec3","bw",";","float","eA","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYPAPER"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bw","=","GLSL_TEXTURE_CUBE","(","u_sky_texture",",","bv",")",".","xyz",";","bG","(","bw",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bw","=","vec3","(","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","acos","(","bv",".","z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYREAL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eA","=","abs","(","L","*","INV_PI","-","0.5",")","*","2.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eA","=","1.0","-","L","*","INV_PI",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec3","eB","=","u_horizon_color",";","vec3","eC","=","u_zenith_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYTEX"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","eE","=","GLSL_TEXTURE_CUBE","(","u_sky_texture",",","bv",")",";","bG","(","eE",".","rgb",")",";","vec3","eD","=","vec3","(","bu",".","xy",",","0.0",")",";","bw","=","eF","(","eB",",","eC",",","eE",",","eA",",","eD",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bw","=","mix","(","eB",",","eC",",","eA",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bw","=","eB",";"]}]}}]}]}}]}]}}]},{TYPE:"txt",TOKENS:["aW","(","bw",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","bw",",","1.0",")",";","}"]}]},e["water.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_WIREFRAME",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_NORMALMAPS",TOKENS:["0"]},{TYPE:"var",NAME:"FOAM",TOKENS:["0"]},{TYPE:"var",NAME:"SHORE_PARAMS",TOKENS:["0"]},{TYPE:"var",NAME:"GENERATED_MESH",TOKENS:["0"]},{TYPE:"var",NAME:"ABSORB",TOKENS:["6.0"]},{TYPE:"var",NAME:"SSS_STRENGTH",TOKENS:["1.0"]},{TYPE:"var",NAME:"SSS_WIDTH",TOKENS:["0.45"]},{TYPE:"var",NAME:"ALPHA",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"WAVES_HEIGHT",TOKENS:["1.0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"var",NAME:"SHORE_SMOOTHING",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC",TOKENS:["0"]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"REFL_BUMP",TOKENS:["0.002"]},{TYPE:"txt",TOKENS:["uniform","float","u_time",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_sky_texture",";"]}]}},{TYPE:"elif",EXPRESSION:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec3","u_horizon_color",";","uniform","vec3","u_zenith_color",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_environment_energy",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_light_positions","[","NUM_LIGHTS","]",";","uniform","vec3","u_light_directions","[","NUM_LIGHTS","]",";","uniform","vec4","u_light_color_intensities","[","NUM_LIGHTS","]",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec3","u_sun_intensity",";","uniform","vec3","u_sun_direction",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_color_density",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat4","u_cube_fog",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_refractmap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_plane_reflection",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_foam",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec4","u_diffuse_color",";","uniform","vec2","u_diffuse_params",";","uniform","float","u_diffuse_intensity",";","uniform","float","u_ambient",";","uniform","vec2","u_fresnel_params",";","uniform","vec3","u_specular_color",";","uniform","vec3","u_specular_params",";","uniform","vec3","u_shallow_water_col",";","uniform","vec3","u_shore_water_col",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_water_norm_uv_velocity",";","uniform","vec2","u_normalmap0_scale",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_normalmap1_scale",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_normalmap2_scale",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_mirror_factor",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_reflect_factor",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_water_shallow_col_fac",";","uniform","float","u_water_shore_col_fac",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_foam_factor",";","uniform","vec2","u_foam_uv_freq",";","uniform","vec2","u_foam_mag",";","uniform","vec2","u_foam_scale",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_refr_bump",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","aE","=","1.0",";","uniform","vec3","u_wireframe_edge_color",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","bY",";","GLSL_IN","vec3","h",";","GLSL_IN","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","k",";","GLSL_IN","vec3","eJ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH","DYNAMIC",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","eK",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","eL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","aD",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","B",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"include",FILE:"environment.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"refraction.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"fog.glslf"}]}}]},{TYPE:"txt",TOKENS:["vec3","eT","(","in","vec2","eM",",","in","vec3","U",",","in","vec3","eN",",","in","vec3","eO",",","out","float","eP",",","in","float","eQ",")","{","eP","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","eR","=","eM",".","xy","+","U",".","xy","*","REFL_BUMP","/","m",";","eP","=","u_reflect_factor",";","vec3","eS",";","if","(","u_cam_water_depth","<","0.0",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},"WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eS","=","u_underwater_fog_color_density",".","rgb",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eS","=","u_diffuse_color",".","rgb",";"]}]}}]},{TYPE:"txt",TOKENS:["}","else","{","eS","=","GLSL_TEXTURE","(","u_plane_reflection",",","eR",")",".","rgb",";","bG","(","eS",")",";","}"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eP","=","u_mirror_factor",";","vec3","eS","=","eO","*","GLSL_TEXTURE_CUBE","(","u_mirrormap",",","eN",")",".","rgb",";","bG","(","eS",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eP","=","u_reflect_factor",";","vec3","eS","=","eO","*","vec3","(","0.3",",","0.5",",","1.0",")",";","bG","(","eS",")",";"]}]}}]},{TYPE:"txt",TOKENS:["eP","=","min","(","eP","*","eQ",",","1.0",")",";","return","eS",";","}"]},{TYPE:"include",FILE:"lighting_nodes.glslf"},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","cg","=","mat3","(","k",",","eJ",",","j",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","U","=","normalize","(","j",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC","FOAM",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bT","=","h",".","z","-","WATER_LEVEL",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","bT","=","h",".","z",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ce","=","vec2","(","eK",".","x",",","-","eK",".","y",")","+","0.5",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ce","=","vec2","(","h",".","x",",","-","h",".","y",")","+","0.5",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ce","=","A",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","eU","=","vec3","(","0.0",")",";","eU","+=","GLSL_TEXTURE","(","u_normalmap0",",","ce","*","u_normalmap0_scale","+","vec2","(","0.3",",","0.5",")","*","u_water_norm_uv_velocity","*","u_time",")",".","xyz","-","0.5",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eU","+=","GLSL_TEXTURE","(","u_normalmap0",",","ce","*","u_normalmap1_scale","+","vec2","(","-","0.3",",","0.7",")","*","u_water_norm_uv_velocity","*","u_time",")",".","xyz","-","0.5",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eU","+=","GLSL_TEXTURE","(","u_normalmap0",",","ce","*","u_normalmap2_scale","+","vec2","(","0.0",",","1.1",")","*","u_water_norm_uv_velocity","*","u_time",")",".","xyz","-","0.5",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eU","+=","GLSL_TEXTURE","(","u_normalmap0",",","ce","*","u_normalmap3_scale","+","vec2","(","-","0.66",",","-","0.3",")","*","u_water_norm_uv_velocity","*","u_time",")",".","xyz","-","0.5",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["U","=","mix","(","U",",","normalize","(","cg","*","eU",")",",","0.3",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["U","=","mix","(","U",",","normalize","(","cg","*","eU",")",",","0.5",")",";"]}]}}]},{TYPE:"txt",TOKENS:["U","=","normalize","(","U",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","D","=","normalize","(","bY",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","eM","=","l",".","xy","/","l",".","z",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","eM","=","vec2","(","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","eV","=","eM","+","U",".","xy","*","u_refr_bump","/","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","u_diffuse_color",".","a",";","vec4","cU","=","GLSL_TEXTURE_PROJ","(","u_scene_depth",",","l",")",";","float","cW","=","cV","(","cU",")",";","float","cX","=","max","(","cW","-","m",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eX","=","eW","(","cW",",","eV",",","eM",")",";","float","eY","=","max","(","eX","-","m",",","0.0",")",";","float","eZ","=","u_view_max_depth","/","ABSORB","*","eY",";","float","e_","=","min","(","L","*","eZ",",","1.0",")",";","L","=","min","(","15.0","*","L","*","u_view_max_depth","*","cX",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","cY","=","u_view_max_depth","/","ABSORB","*","cX",";","if","(","u_cam_water_depth",">","0.0",")","L","=","min","(","L","*","cY",",","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","L","=","u_diffuse_color",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","e_","=","L",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","u_cam_water_depth","<","0.0",")","e_","=","0.0",";","vec3","fa","=","GLSL_TEXTURE","(","u_refractmap",",","eV",")",".","rgb",";","bG","(","fa",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fb","=","pow","(","min","(","eL",".","b","/","u_water_shallow_col_fac",",","1.0",")",",","0.3",")",";","vec3","cy","=","mix","(","u_shallow_water_col",",","u_diffuse_color",".","rgb",",","fb",")",";","fb","=","pow","(","min","(","eL",".","b","/","u_water_shore_col_fac",",","1.0",")",",","0.3",")",";","cy","=","mix","(","u_shore_water_col",",","cy",",","fb",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","cy","=","u_diffuse_color",".","rgb",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fc","=","max","(","1.0","-","u_view_max_depth","*","cX",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fc","=","1.0","-","L",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fd","=","max","(","bT","/","WAVES_HEIGHT","+","0.1",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fe","=","normalize","(","vec3","(","eL",".","rg",",","0.0",")",")",";","vec3","ff","=","normalize","(","mix","(","UP_VECTOR",",","fe",",","0.8",")",")",";","float","fg","=","1.25","*","max","(","dot","(","U",",","ff",")","-","0.2",",","0.0",")",";","fg","+=","max","(","dot","(","U",",","-","UP_VECTOR",")",",","0.0",")",";","fc","+=","fg","*","(","1.0","-","eL",".","b",")",";","fd","*=","(","1.0","-","0.95","*","pow","(","eL",".","b",",","0.1",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["fc","+=","fd",";","fc","=","min","(","u_foam_factor","*","fc",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec4","fh","=","GLSL_TEXTURE","(","u_foam",",","u_foam_mag","*","sin","(","u_foam_uv_freq","*","u_time",")","+","ce","*","u_foam_scale",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","cL","=","u_specular_params","[","0","]",";","vec2","cM","=","vec2","(","u_specular_params","[","1","]",",","u_specular_params","[","2","]",")",";","vec3","cN","=","cL","*","u_specular_color",";","vec3","cF","=","u_environment_energy","*","cE","(","U",")",";","vec3","cG","=","u_ambient","*","cF",";","vec3","eO","=","cG","+","u_sun_intensity",";","float","eP",";","vec3","eN","=","reflect","(","-","D",",","U",")",";","vec3","fi","=","normalize","(","eN","+","D",")",";","float","fj","=","1.0","-","dot","(","D",",","fi",")",";","float","ec","=","u_fresnel_params","[","0","]",";","float","fk","=","u_fresnel_params","[","1","]",";","float","fl","=","fk","+","(","1.0","-","fk",")","*","pow","(","fj",",","ec",")",";","vec3","eS","=","eT","(","eM",",","U",",","eN",",","eO",",","eP",",","fl",")",";","vec3","cD","=","u_diffuse_intensity","*","cy",";","vec3","aQ",";","vec3","cO",";","cP","(","vec3","(","0.0",")",",","vec3","(","0.0",")",",","cD",",","cN",",","h",",","U",",","D",",","cM",",","u_diffuse_params",",","vec4","(","1.0",")",",","0.0",",","vec4","(","0.0",")",",","aQ",",","cO",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fm","=","max","(","dot","(","u_sun_direction",",","-","j",")","+","SSS_WIDTH",",","0.0",")","*","max","(","dot","(","-","D",",","u_sun_direction",")","-","0.5",",","0.0",")","*","max","(","0.0",",","length","(","u_sun_intensity",")","-","0.1",")",";","fm","=","clamp","(","SSS_STRENGTH","*","fm",",","0.0",",","1.0",")",";","aQ","=","mix","(","aQ",",","u_shallow_water_col",",","fm",")",";","aQ","=","mix","(","aQ",",","u_shore_water_col",",","fm",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","mix","(","fa",",","aQ",",","e_",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aQ","=","mix","(","aQ",",","eS",",","eP",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fn","=","mix","(","fh",".","g",",","fh",".","r",",","max","(","4.0","*","(","fc","-","0.75",")",",","0.0",")",")",";","fn","=","mix","(","fh",".","b",",","fn",",","max","(","2.0","*","fc","-","1.0",",","0.0",")",")",";","fn","=","mix","(","0.0",",","fn",",","fc",")",";","aQ","=","mix","(","aQ",",","eO",",","fn",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aQ","+=","cO",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fo","=","m","*","u_view_max_depth",";","float","fp","=","1.0",";","if","(","u_cam_water_depth",">","1.0",")","fp","=","2.0",";","bW","(","aQ",",","fo",",","D",",","fp",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aW","(","aQ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","max","(","L",",","cO",".","r",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOAM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","+=","fn",";"]}]}}]}]}},{TYPE:"elif",EXPRESSION:["SHORE_SMOOTHING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["L","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aX","(","aQ",",","L",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"extension",TOKENS:["GL_OES_standard_derivatives",":","enable"]}]}}]},{TYPE:"txt",TOKENS:["vec3","aN","=","fwidth","(","aD",")",";","vec3","aO","=","smoothstep","(","vec3","(","0.0",")",",","aN","*","aE",",","aD",")",";","float","fq","=","min","(","min","(","aO",".","x",",","aO",".","y",")",",","aO",".","z",")",";","fq","=","clamp","(","fq",",","0.0",",","1.0",")",";","aQ","=","mix","(","u_wireframe_edge_color",",","aQ",",","fq",")",";","L","=","mix","(","1.0",",","L",",","fq",")",";"]}]}},{TYPE:"elif",EXPRESSION:["DEBUG_WIREFRAME",2,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aM","=","sign","(","aD","-","vec3","(","0.02","*","aE",")",")",";","float","fq","=","1.0",";","if","(","aM",".","x","<","0.0","||","aM",".","y","<","0.0","||","aM",".","z","<","0.0",")","fq","=","0.0",";","aQ","=","mix","(","u_wireframe_edge_color",",","aQ",",","fq",")",";","L","=","mix","(","1.0",",","L",",","fq",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","L",")",";","}"]}]},e["water.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"USE_TBN_SHADING",TOKENS:["0"]},{TYPE:"var",NAME:"DEBUG_WIREFRAME",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_NORMALMAPS",TOKENS:["0"]},{TYPE:"var",NAME:"FOAM",TOKENS:["0"]},{TYPE:"var",NAME:"SHORE_PARAMS",TOKENS:["0"]},{TYPE:"var",NAME:"MAX_SHORE_DIST",TOKENS:["100.0"]},{TYPE:"var",NAME:"SHORE_MAP_SIZE_X",TOKENS:["1.0"]},{TYPE:"var",NAME:"SHORE_MAP_SIZE_Y",TOKENS:["1.0"]},{TYPE:"var",NAME:"SHORE_MAP_CENTER_X",TOKENS:["0.0"]},{TYPE:"var",NAME:"SHORE_MAP_CENTER_Y",TOKENS:["0.0"]},{TYPE:"var",NAME:"GENERATED_MESH",TOKENS:["0"]},{TYPE:"var",NAME:"DST_NOISE_SCALE_0",TOKENS:["0.05"]},{TYPE:"var",NAME:"DST_NOISE_SCALE_1",TOKENS:["0.03"]},{TYPE:"var",NAME:"DST_NOISE_FREQ_0",TOKENS:["1.3"]},{TYPE:"var",NAME:"DST_NOISE_FREQ_1",TOKENS:["1.0"]},{TYPE:"var",NAME:"DIR_MIN_SHR_FAC",TOKENS:["0.4"]},{TYPE:"var",NAME:"DIR_FREQ",TOKENS:["0.5"]},{TYPE:"var",NAME:"DIR_NOISE_SCALE",TOKENS:["0.05"]},{TYPE:"var",NAME:"DIR_NOISE_FREQ",TOKENS:["0.07"]},{TYPE:"var",NAME:"DIR_MIN_NOISE_FAC",TOKENS:["0.5"]},{TYPE:"var",NAME:"DST_MIN_FAC",TOKENS:["0.2"]},{TYPE:"var",NAME:"WAVES_HOR_FAC",TOKENS:["5.0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WAVES_HEIGHT",TOKENS:["1.0"]},{TYPE:"var",NAME:"WAVES_LENGTH",TOKENS:["10.0"]},{TYPE:"var",NAME:"WATER_LEVEL",TOKENS:["0.0"]},{TYPE:"var",NAME:"SHORE_SMOOTHING",TOKENS:["0"]},{TYPE:"var",NAME:"DYNAMIC",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},"DYNAMIC",{TYPE:"logic_negative_expr",PLACES:1},"NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","a_tbn",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},"NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","a_polyindex",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","bY",";","GLSL_OUT","vec3","h",";","GLSL_OUT","vec3","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","k",";","GLSL_OUT","vec3","eJ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2},"GENERATED_MESH","DYNAMIC",{TYPE:"logical_and_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","eK",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","eL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","l",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","m",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","aD",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_TBN_SHADING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec3","B",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["STATIC_BATCH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","mat3","u_model_tsr","=","mat3","(","0.0",",","0.0",",","0.0",",","1.0",",","1.0",",","1.0",",","0.0",",","0.0",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","mat3","u_model_tsr",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","mat3","u_view_tsr",";","uniform","mat4","u_proj_matrix",";","uniform","vec3","u_camera_eye",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_time",";","uniform","vec3","u_wind",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_shore_dist_map",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fx","(","in","vec2","fr",")","{","vec2","fs","=","0.5","+","vec2","(","(","fr",".","x","-","SHORE_MAP_CENTER_X",")","/","SHORE_MAP_SIZE_X",",","(","fr",".","y","-","SHORE_MAP_CENTER_Y",")","/","SHORE_MAP_SIZE_Y",")",";","vec4","ft","=","GLSL_TEXTURE","(","u_shore_dist_map",",","fs",")",";","const","vec2","fu","=","vec2","(","1.0","/","255.0",",","1.0",")",";","float","fv","=","dot","(","ft",".","ba",",","fu",")",";","vec2","fw","=","normalize","(","ft",".","rg","*","2.0","-","1.0",")",";","return","vec3","(","fw",",","fv",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMALL_WAVES_FAC",TOKENS:["0.2"]},{TYPE:"txt",TOKENS:["void","fM","(","inout","vec3","fr",",","in","float","fy",",","in","vec3","ft",")","{","float","fA","=","fz","(","DST_NOISE_SCALE_0","*","(","fr",".","xy","+","DST_NOISE_FREQ_0","*","fy",")",")","*","fz","(","DST_NOISE_SCALE_1","*","(","fr",".","yx","-","DST_NOISE_FREQ_1","*","fy",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fB","=","WAVES_LENGTH","/","MAX_SHORE_DIST","/","M_PI",";","float","fv","=","ft",".","b",";","float","fC","=","sqrt","(","fv",")",";","float","fD","=","max","(","fv",",","DIR_MIN_SHR_FAC",")","*","sin","(","fC","/","fB","+","DIR_FREQ","*","fy",")",";","float","fE","=","max","(","fz","(","DIR_NOISE_SCALE","*","(","fr",".","xy","+","DIR_NOISE_FREQ","*","fy",")",")",",","DIR_MIN_NOISE_FAC",")",";","fD","*=","fE",";","float","fF","=","WAVES_HEIGHT","*","mix","(","fD",",","fA",",","max","(","fC",",","DST_MIN_FAC",")",")",";","vec2","fw","=","ft",".","rg",";","float","fG","=","WAVES_HOR_FAC","*","fD","*","max","(","MAX_SHORE_DIST","/","35.0","*","(","0.05","-","fv",")",",","0.0",")",";","vec2","fH","=","fG","*","fw",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fF","=","WAVES_HEIGHT","*","fA",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fI","=","1.0","*","(","fr",".","xy","-","0.3","*","fy",")",";","vec2","fJ","=","0.7","*","(","fr",".","yx","+","0.07","*","fy",")",";","float","fL","=","fK","(","fI",")",".","x","+","fK","(","fJ",")",".","x","-","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["fr",".","xy","+=","fH",";","fL","*=","fv",";"]}]}}]},{TYPE:"txt",TOKENS:["fF","+=","SMALL_WAVES_FAC","*","fL",";"]}]}}]},{TYPE:"txt",TOKENS:["fr",".","z","+=","fF",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEBUG_WIREFRAME"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","a_polyindex","==","0.0",")","aD","=","vec3","(","1.0",",","0.0",",","0.0",")",";","else","if","(","a_polyindex","==","1.0",")","aD","=","vec3","(","0.0",",","0.0",",","1.0",")",";","else","aD","=","vec3","(","0.0",",","1.0",",","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","O","=","a_position",";","float","fN","=","abs","(","O",".","z",")",";","vec2","fO","=","u_camera_eye",".","xy","-","mod","(","u_camera_eye",".","xy",",","fN",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O",".","z","=","WATER_LEVEL",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O",".","z","=","0.0",";"]}]}}]},{TYPE:"txt",TOKENS:["O",".","xy","+=","fO",";","vec3","cb","=","O",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","a_texcoord",";"]}]}}]},{TYPE:"txt",TOKENS:["au","aw","=","av","(","a_position",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","u_model_tsr",")",";","vec3","cb","=","aw",".","O",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eL","=","fx","(","cb",".","xy",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fP","=","length","(","u_wind",")",";","if","(","fP","==","0.0",")","fP","=","1.0",";","float","fQ","=","u_time",";","fQ","*=","fP",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fR","=","fN",";","vec3","fS","=","cb","+","vec3","(","fR",",","0.0",",","0.0",")",";","vec3","fT","=","cb","+","vec3","(","0.0",",","fR",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2},"FOAM",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eK","=","cb",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fS","=","cb","+","vec3","(","0.05",",","0.0",",","0.0",")",";","vec3","fT","=","cb","+","vec3","(","0.0",",","0.05",",","0.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_PARAMS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fU","=","fx","(","fS",".","xy",")",";","vec3","fV","=","fx","(","fT",".","xy",")",";","fM","(","fS",",","fQ",",","fU",")",";","fM","(","fT",",","fQ",",","fV",")",";","fM","(","cb",",","fQ",",","eL",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["fM","(","fS",",","fQ",",","vec3","(","0.0",")",")",";","fM","(","fT",",","fQ",",","vec3","(","0.0",")",")",";","fM","(","cb",",","fQ",",","vec3","(","0.0",")",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","a_position",".","z","<","0.0",")","{","cb",".","z","=","WATER_LEVEL","-","1.0",";","fS",".","z","=","cb",".","z",";","fT",".","z","=","cb",".","z",";","}"]}]}}]},{TYPE:"txt",TOKENS:["vec3","ej","=","normalize","(","fS","-","cb",")",";","vec3","V","=","normalize","(","fT","-","cb",")",";","j","=","normalize","(","cross","(","ej",",","V",")",")",";","float","fW","=","dot","(","j",",","UP_VECTOR",")",";","float","aL","=","clamp","(","0.8","-","fW",",","0.0",",","1.0",")",";","j","=","mix","(","j",",","UP_VECTOR",",","aL",")",";"]}]}},{TYPE:"elif",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","S","=","R","(","a_tbn",")",";","j","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["j","=","vec3","(","0.0",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_NORMALMAPS",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GENERATED_MESH",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","T","(","S",",","vec3","(","1.0",",","0.0",",","0.0",")",")",";"]}]}},{TYPE:"elif",EXPRESSION:["DYNAMIC",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","V","=","vec3","(","1.0",",","0.0",",","0.0",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["k","=","V",";","eJ","=","cross","(","j",",","k",")",";"]}]}}]},{TYPE:"txt",TOKENS:["h","=","cb",";","bY","=","u_camera_eye","-","cb",";","vec4","cc","=","vec4","(","ap","(","u_view_tsr",",","cb",")",",","1.0",")",";","vec4","f","=","u_proj_matrix","*","cc",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","fX","=","f",".","x",";","float","fY","=","f",".","y",";","float","fZ","=","f",".","w",";","l",".","x","=","(","fX","+","fZ",")","/","2.0",";","l",".","y","=","(","fY","+","fZ",")","/","2.0",";","l",".","z","=","fZ",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["m","=","-","cc",".","z","/","u_view_max_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","f",";","}"]}]},e["postprocessing/antialiasing.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"AA_METHOD",TOKENS:["AA_METHOD_FXAA_LIGHT"]},{TYPE:"var",NAME:"AA_QUALITY",TOKENS:["AA_QUALITY_LOW"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","uniform","vec2","u_texel_size",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_REDUCE_MIN",TOKENS:["(","1.0","/","128.0",")"]},{TYPE:"define",NAME:"FXAA_REDUCE_MUL",TOKENS:["(","1.0","/","8.0",")"]},{TYPE:"define",NAME:"FXAA_SPAN_MAX",TOKENS:["8.0"]},{TYPE:"txt",TOKENS:["vec4","gc","(","float","x",",","float","y",")","{","vec2","f_","=","A","+","vec2","(","x",",","y",")","*","u_texel_size",";","return","GLSL_TEXTURE","(","u_color",",","f_",")",";","}","vec4","gx","(",")","{","vec4","gd","=","gc","(","-","1.0",",","-","1.0",")",";","vec4","ge","=","gc","(","1.0",",","-","1.0",")",";","vec4","gf","=","gc","(","-","1.0",",","1.0",")",";","vec4","gh","=","gc","(","1.0",",","1.0",")",";","vec4","gi","=","gc","(","0.0",",","0.0",")",";","float","gk","=","gj","(","gi",")",";","float","gl","=","gj","(","gd",")",";","float","gm","=","gj","(","ge",")",";","float","gn","=","gj","(","gf",")",";","float","go","=","gj","(","gh",")",";","float","gp","=","min","(","gk",",","min","(","min","(","gl",",","gm",")",",","min","(","gn",",","go",")",")",")",";","float","gq","=","max","(","gk",",","max","(","max","(","gl",",","gm",")",",","max","(","gn",",","go",")",")",")",";","vec2","bH",";","bH",".","x","=","-","(","(","gl","+","gm",")","-","(","gn","+","go",")",")",";","bH",".","y","=","(","(","gl","+","gn",")","-","(","gm","+","go",")",")",";","float","gs","=","max","(","(","gl","+","gm","+","gn","+","go",")","*","(","0.25","*","FXAA_REDUCE_MUL",")",",","FXAA_REDUCE_MIN",")",";","float","gt","=","1.0","/","(","min","(","abs","(","bH",".","x",")",",","abs","(","bH",".","y",")",")","+","gs",")",";","bH","=","min","(","vec2","(","FXAA_SPAN_MAX",",","FXAA_SPAN_MAX",")",",","max","(","vec2","(","-","FXAA_SPAN_MAX",",","-","FXAA_SPAN_MAX",")",",","bH","*","gt",")",")","*","u_texel_size",";","vec4","gu","=","0.5","*","(","GLSL_TEXTURE","(","u_color",",","A","+","bH","*","(","1.0","/","3.0","-","0.5",")",")","+","GLSL_TEXTURE","(","u_color",",","A","+","bH","*","(","2.0","/","3.0","-","0.5",")",")",")",";","vec4","gv","=","gu","*","0.5","+","0.25","*","(","GLSL_TEXTURE","(","u_color",",","A","+","bH","*","-","0.5",")","+","GLSL_TEXTURE","(","u_color",",","A","+","bH","*","0.5",")",")",";","float","gw","=","gj","(","gv",")",";","if","(","(","gw","<","gp",")","||","(","gw",">","gq",")",")","return","gu",";","else","return","gv",";","}"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GREEN_AS_LUMA",TOKENS:["1"]},{TYPE:"include",FILE:"fxaa.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_QUALITY","AA_QUALITY_HIGH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["39"]},{TYPE:"define",NAME:"FXAA_QUALITY_SUBPIX",TOKENS:["1.00"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD",TOKENS:["0.063"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",TOKENS:["0.0312"]}]}},{TYPE:"elif",EXPRESSION:["AA_QUALITY","AA_QUALITY_MEDIUM",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["20"]},{TYPE:"define",NAME:"FXAA_QUALITY_SUBPIX",TOKENS:["0.65"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD",TOKENS:["0.166"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",TOKENS:["0.0625"]}]}},{TYPE:"elif",EXPRESSION:["AA_QUALITY","AA_QUALITY_LOW",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["12"]},{TYPE:"define",NAME:"FXAA_QUALITY_SUBPIX",TOKENS:["0.50"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD",TOKENS:["0.166"]},{TYPE:"define",NAME:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",TOKENS:["0.0833"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","gx","(",")",";"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","gy","=","u_texel_size",";","GLSL_OUT_FRAG_COLOR","=","gz","(","A",",","u_color",",","gy",",","FXAA_QUALITY_SUBPIX",",","FXAA_QUALITY_EDGE_THRESHOLD",",","FXAA_QUALITY_EDGE_THRESHOLD_MIN",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/bloom_combine.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"BLUR_PASS_NUM",TOKENS:["BLUR_PASS_5"]},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_main",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_1",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_2",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_1",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_3",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_2",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_4",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_3",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_5",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_bloom_level_4",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gA","=","GLSL_TEXTURE","(","u_main",",","A",")",";","vec4","gB","=","vec4","(","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_1",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gB","+=","GLSL_TEXTURE","(","u_bloom_level_0",",","A",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_2",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gB","+=","GLSL_TEXTURE","(","u_bloom_level_1",",","A",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_3",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gB","+=","GLSL_TEXTURE","(","u_bloom_level_2",",","A",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_4",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gB","+=","GLSL_TEXTURE","(","u_bloom_level_3",",","A",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLUR_PASS_NUM","BLUR_PASS_5",{TYPE:"ge_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gB","+=","GLSL_TEXTURE","(","u_bloom_level_4",",","A",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","gA","+","gB",";","}"]}]},e["postprocessing/coc.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"COC_TYPE",TOKENS:["COC_ALL"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","uniform","sampler2D","u_depth",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_COMBINE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","float","u_view_max_depth",";","uniform","float","u_dof_dist",";","uniform","float","u_dof_front_start",";","uniform","float","u_dof_front_end",";","uniform","float","u_dof_rear_start",";","uniform","float","u_dof_rear_end",";","uniform","vec2","u_camera_range",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","if","(","u_dof_dist",">","0.0",")","{","float","et","=","gC","(","u_depth",",","A",",","u_camera_range",")",";","et","*=","u_view_max_depth",";","float","gD","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_COMBINE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","gE","=","GLSL_TEXTURE","(","u_coc_fg",",","A",")",";","float","gF","=","gE",".","a",";"]}]}}]},{TYPE:"txt",TOKENS:["if","(","et","<","u_dof_dist",")","gD","=","(","u_dof_dist","-","et","-","u_dof_front_start",")","/","(","u_dof_front_end","-","u_dof_front_start",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_FOREGROUND",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","gD","=","(","et","-","u_dof_dist","-","u_dof_rear_start",")","/","(","u_dof_rear_end","-","u_dof_rear_start",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gD","=","clamp","(","gD",",","0.0",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_COMBINE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["gD","=","max","(","gD",",","gF",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COC_TYPE","COC_FOREGROUND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","gD",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",".","xyz","*","gD",",","gD",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","else","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",".","xyz",",","0.0",")",";","}"]}]},e["postprocessing/compositing.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","uniform","float","u_brightness",";","uniform","float","u_contrast",";","uniform","float","u_exposure",";","uniform","float","u_saturation",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gG","=","GLSL_TEXTURE","(","u_color",",","A",")",";","vec3","aQ","=","gG",".","rgb",";","if","(","u_brightness","<","0.0",")","aQ","=","aQ","*","(","1.0","+","u_brightness",")",";","else","aQ","=","aQ","+","(","(","1.0","-","aQ",")","*","u_brightness",")",";","aQ","=","(","aQ","-","0.5",")","*","(","tan","(","(","u_contrast","+","1.0",")","*","M_PI_4",")",")","+","0.5",";","aQ","*=","u_exposure",";","float","dv","=","gj","(","vec4","(","aQ",",","0.0",")",")",";","aQ","=","mix","(","vec3","(","dv",")",",","aQ",",","u_saturation",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","gG",".","a",")",";","}"]}]},e["postprocessing/depth_pack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_depth",";","uniform","vec2","u_camera_range",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","GLSL_OUT_FRAG_COLOR","=","eu","(","clamp","(","gC","(","u_depth",",","A",",","u_camera_range",")",",","0.0",",","0.999999",")",")",";","}"]}]},e["postprocessing/dof.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"DOF_TYPE",TOKENS:["DOF_SIMPLE"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOF_TYPE","DOF_BOKEH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","highp","sampler2D","u_sharp",";","uniform","highp","sampler2D","u_blurred1",";","uniform","highp","sampler2D","u_blurred2",";","uniform","float","u_dof_dist",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sharp",";","uniform","sampler2D","u_blurred",";","uniform","sampler2D","u_depth",";","uniform","float","u_view_max_depth",";","uniform","float","u_dof_dist",";","uniform","float","u_dof_front_end",";","uniform","float","u_dof_rear_end",";","uniform","vec2","u_camera_range",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gH","=","GLSL_TEXTURE","(","u_sharp",",","A",")",";","if","(","u_dof_dist",">","0.0",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOF_TYPE","DOF_BOKEH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","gD",";","vec4","gI","=","GLSL_TEXTURE","(","u_blurred1",",","A",")",";","vec4","gJ","=","GLSL_TEXTURE","(","u_blurred2",",","A",")",";","vec4","gK","=","min","(","gI",".","rgba",",","gJ",".","rgba",")",";","gD","=","gK",".","a",";","if","(","gD",">","0.0",")","{","gK","=","vec4","(","gK",".","rgb","/","gD",",","gH",".","a",")",";","GLSL_OUT_FRAG_COLOR","=","mix","(","gH",",","gK",",","min","(","gD","*","5.0",",","1.0",")",")",";","}","else","GLSL_OUT_FRAG_COLOR","=","gH",";"]}]}},{TYPE:"elif",EXPRESSION:["DOF_TYPE","DOF_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","et","=","gC","(","u_depth",",","A",",","u_camera_range",")",";","et","*=","u_view_max_depth",";","float","gL",";","if","(","et","<","u_dof_dist",")","gL","=","(","u_dof_dist","-","et",")","/","u_dof_front_end",";","else","gL","=","(","et","-","u_dof_dist",")","/","u_dof_rear_end",";","gL","=","clamp","(","gL",",","0.0",",","1.0",")",";","vec4","gM","=","GLSL_TEXTURE","(","u_blurred",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","mix","(","gH",",","gM",",","gL",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","gH",";"]}]}}]},{TYPE:"txt",TOKENS:["}","else","GLSL_OUT_FRAG_COLOR","=","gH",";","}"]}]},e["postprocessing/glow.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_src_color",";","uniform","sampler2D","u_glow_mask_small",";","uniform","sampler2D","u_glow_mask_large",";","uniform","float","u_glow_mask_small_coeff",";","uniform","float","u_glow_mask_large_coeff",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gN","=","GLSL_TEXTURE","(","u_src_color",",","A",")",";","vec4","gO","=","GLSL_TEXTURE","(","u_glow_mask_small",",","A",")",";","vec4","gP","=","GLSL_TEXTURE","(","u_glow_mask_large",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","gN",";","if","(","gP",".","a","!=","0.0",")","{","float","gQ","=","u_glow_mask_large_coeff","*","gP",".","a",";","gQ","=","clamp","(","gQ",",","0.0",",","1.0",")",";","GLSL_OUT_FRAG_COLOR",".","rgb","=","mix","(","GLSL_OUT_FRAG_COLOR",".","rgb",",","gP",".","rgb","/","gP",".","a",",","gQ",")",";","GLSL_OUT_FRAG_COLOR",".","a","=","mix","(","GLSL_OUT_FRAG_COLOR",".","a",",","1.0",",","gQ",")",";","}","if","(","gO",".","a","!=","0.0",")","{","float","gR","=","u_glow_mask_small_coeff","*","gO",".","a",";","gR","=","clamp","(","gR",",","0.0",",","1.0",")",";","GLSL_OUT_FRAG_COLOR",".","rgb","=","mix","(","GLSL_OUT_FRAG_COLOR",".","rgb",",","gO",".","rgb","/","gO",".","a",",","gR",")",";","GLSL_OUT_FRAG_COLOR",".","a","=","mix","(","GLSL_OUT_FRAG_COLOR",".","a",",","1.0",",","gR",")",";","}","}"]}]},e["postprocessing/god_rays.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"DEPTH_RGBA",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"STEPS_PER_PASS",TOKENS:["10.0"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:["uniform","float","u_time",";","uniform","float","u_radial_blur_step",";","uniform","sampler2D","u_input",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec2","u_camera_range",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","float","gS",";","GLSL_IN","vec2","gT",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_IN","vec4","gU",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec2","cX","=","(","gU",".","xy","-","A",")",";","float","aM","=","length","(","cX",")",";","vec2","gV","=","u_radial_blur_step","*","cX","/","aM",";","float","gW","=","aM","/","u_radial_blur_step",";","gV","*=","min","(","gW",",","STEPS_PER_PASS",")","/","STEPS_PER_PASS",";","gW","=","max","(","gW",",","STEPS_PER_PASS",")",";","vec2","gX","=","A",";","float","gY","=","0.0",";","const","int","gZ","=","int","(","STEPS_PER_PASS",")",";","int","g_","=","int","(","gW","+","0.5",")",";","for","(","int","cq","=","0",";","cq","<","gZ",";","cq","+=","1",")","{","if","(","cq","<=","g_",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","et","=","gC","(","u_input",",","gX",",","u_camera_range",")",";","gY","+=","max","(","(","1.0","-","pow","(","aM",",","0.3",")",")","*","step","(","0.9",",","et",")",",","0.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","ha","=","GLSL_TEXTURE","(","u_input",",","gX",")",";","gY","+=","cV","(","ha",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","gX","+=","gV",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ce","=","A","+","gT",";","float","hb","=","fK","(","vec2","(","2.5","*","(","ce",".","x",")",",","2.5","*","(","ce",".","y",")","+","1.0","*","u_time",")",")",".","x","+","0.75","*","fK","(","vec2","(","5.0","*","(","ce",".","x",")","-","0.66","*","u_time",",","5.0","*","(","ce",".","y",")","+","0.66","*","u_time",")",")",".","x","+","0.5","*","fz","(","vec2","(","7.5","*","(","ce",".","x",")","+","0.33","*","u_time",",","7.5","*","(","ce",".","y",")","-","0.33","*","u_time",")",")",";","hb","*=","clamp","(","1.2","-","sqrt","(","0.2","*","aM",")",",","0.0",",","1.0",")","*","gS",";","gY","=","max","(","hb",",","gY",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","eu","(","gY","/","STEPS_PER_PASS",")",";","}"]}]},e["postprocessing/god_rays.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"DEPTH_RGBA",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["uniform","mat4","u_view_proj_matrix",";","uniform","vec3","u_sun_direction",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","vec4","u_camera_quat",";","uniform","float","u_cam_water_depth",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_bb_vertex",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","float","gS",";","GLSL_OUT","vec2","gT",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","A",";","GLSL_OUT","vec4","gU",";","void","main","(",")","{","A","=","a_bb_vertex",";","vec3","bH","=","normalize","(","u_sun_direction",")",";","gU","=","u_view_proj_matrix","*","vec4","(","bH",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DEPTH_RGBA","WATER_EFFECTS",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","u_cam_water_depth","<","0.0",")","{","gS","=","1.0",";","vec3","hc","=","vec3","(","0.0",",","1.0",",","0.0",")",";","vec3","hd","=","T","(","u_camera_quat",",","hc",")",";","hd","=","normalize","(","hd",")",";","float","he","=","dot","(","hd",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";","float","hf","=","atan","(","hd",".","x",",","hd",".","z",")",";","gT","=","vec2","(","-","hf",",","acos","(","he",")",")",";","}","else","{","gS","=","0.0",";","}"]}]}}]},{TYPE:"txt",TOKENS:["gU",".","xy","=","0.5","*","(","gU",".","xy","/","gU",".","w","+","1.0",")",";","gU","+=","99999.0","*","step","(","gU",".","z",",","0.0",")",";","gl_Position","=","vec4","(","2.0","*","a_bb_vertex",".","xy","-","1.0",",","0.0",",","1.0",")",";","}"]}]},e["postprocessing/god_rays_combine.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"SAFARI_CANVAS_ALPHA_HACK",TOKENS:["0"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_main",";","uniform","sampler2D","u_god_rays",";","uniform","float","u_god_rays_intensity",";","uniform","vec3","u_sun_intensity",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","hg","=","GLSL_TEXTURE","(","u_main",",","A",")",";","vec3","hh","=","clamp","(","u_sun_intensity",",","0.4",",","0.8",")",";","bG","(","hg",".","rgb",")",";","float","hi","=","cV","(","GLSL_TEXTURE","(","u_god_rays",",","A",")",")",";","vec3","hj","=","hg",".","rgb","+","u_god_rays_intensity","*","vec3","(","hi",")","*","hh",";","aW","(","hj",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SAFARI_CANVAS_ALPHA_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","hj",",","max","(","0.01",",","hg",".","a",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","hj",",","hg",".","a",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/luminance.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_input",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","gA","=","GLSL_TEXTURE","(","u_input",",","A",")",";","float","hk","=","dot","(","gA",".","rgb",",","vec3","(","0.2126",",","0.7152",",","0.0722",")",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","vec3","(","hk",")",",","1.0",")",";","}"]}]},e["postprocessing/luminance_av.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_input",";","uniform","float","u_mipmap_1x1",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","float","hl","=","max","(","GLSL_TEXTURE","(","u_input",",","A",",","u_mipmap_1x1",")",".","r",",","0.01",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","vec3","(","hl",")",",","1.0",")",";","}"]}]},e["postprocessing/luminance_truncated.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"ADAPTIVE_BLOOM",TOKENS:["0"]},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_main",";","uniform","sampler2D","u_luminance",";","uniform","sampler2D","u_average_lum",";","uniform","float","u_bloom_edge_lum",";","uniform","float","u_bloom_key",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ADAPTIVE_BLOOM",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_average_lum_val",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ADAPTIVE_BLOOM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","hl","=","GLSL_TEXTURE","(","u_average_lum",",","vec2","(","0.5",")",")",".","r",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","hl","=","u_average_lum_val",";"]}]}}]},{TYPE:"txt",TOKENS:["float","hm","=","GLSL_TEXTURE","(","u_luminance",",","A",")",".","r",";","vec4","aQ","=","GLSL_TEXTURE","(","u_main",",","A",")",";","float","hn","=","hm","/","hl",";","float","ho","=","u_bloom_edge_lum",";","GLSL_OUT_FRAG_COLOR","=","aQ","*","u_bloom_key","*","smoothstep","(","ho",",","ho","+","1.2",",","hn",")",";","}"]}]},e["postprocessing/motion_blur.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_mb_tex_curr",";","uniform","sampler2D","u_mb_tex_accum",";","uniform","float","u_motion_blur_exp",";","uniform","float","u_motion_blur_decay_threshold",";","float","hp","=","0.0042",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","hq","=","GLSL_TEXTURE","(","u_mb_tex_curr",",","A",")",";","vec4","hr","=","GLSL_TEXTURE","(","u_mb_tex_accum",",","A",")",";","if","(","length","(","hq","-","hr",")",">","u_motion_blur_decay_threshold",")","{","vec4","hs","=","(","1.0","-","u_motion_blur_exp",")","*","hq","+","u_motion_blur_exp","*","hr",";","vec4","ht","=","hs","-","hr",";","vec4","hu","=","hq","-","hr",";","vec4","cX","=","min","(","max","(","abs","(","ht",")",",","vec4","(","hp",")",")",",","abs","(","hu",")",")","*","sign","(","ht",")",";","GLSL_OUT_FRAG_COLOR","=","hr","+","cX",";","}","else","{","GLSL_OUT_FRAG_COLOR","=","hq",";","}","}"]}]},e["postprocessing/outline.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_outline_src",";","uniform","sampler2D","u_outline_mask",";","uniform","sampler2D","u_outline_mask_blurred",";","uniform","vec3","u_outline_color",";","uniform","float","u_draw_outline",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","hv","=","GLSL_TEXTURE","(","u_outline_src",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","hv",";","if","(","u_draw_outline","!=","0.0",")","{","vec4","hw","=","GLSL_TEXTURE","(","u_outline_mask",",","A",")",";","vec4","hx","=","GLSL_TEXTURE","(","u_outline_mask_blurred",",","A",")",";","float","hy","=","hx",".","a","-","hw",".","a",";","if","(","hy","!=","0.0",")","{","float","hz","=","smoothstep","(","0.0",",","1.0",",","hx",".","a",")",";","if","(","hw",".","a","==","0.0",")","{","vec3","hA","=","u_outline_color",";","aW","(","hA",")",";","vec4","hB","=","vec4","(","clamp","(","hA",",","0.0",",","1.0",")",",","1.0",")",";","GLSL_OUT_FRAG_COLOR","=","mix","(","hv",",","hB",",","hz",")",";","}","}","}","}"]}]},e["postprocessing/performance.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","vec4","aQ","=","vec4","(","0.0",")",";","for","(","int","cq","=","0",";","cq","<","10",";","cq","++",")","{","vec2","hC","=","vec2","(","fract","(","A","*","vec2","(","cq",")","*","vec2","(","1.431",",","3.921",")",")",")",";","aQ","+=","0.01","*","GLSL_TEXTURE","(","u_color",",","hC",")",";","}","GLSL_OUT_FRAG_COLOR","=","aQ",";","}"]}]},e["postprocessing/postprocessing.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"POST_EFFECT",TOKENS:["POST_EFFECT_NONE"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","vec2","u_texel_size",";","uniform","sampler2D","u_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","int","u_tex_number",";","uniform","vec2","u_delta",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POST_EFFECT","POST_EFFECT_NONE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","A",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","dx","=","GLSL_TEXTURE","(","u_color",",","A",")",";","GLSL_OUT_FRAG_COLOR",".","rgb","=","vec3","(","(","dx",".","r","+","dx",".","g","+","dx",".","b",")","/","3.0",")",";","GLSL_OUT_FRAG_COLOR",".","a","=","1.0",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fM","=","vec2","(","0.0",",","0.0",")",";","vec2","cX","=","u_texel_size",";","vec4","aQ",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","aQ","*","0.2270270270",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.1945945946",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.1945945946",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.1216216216",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.1216216216",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.0540540541",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.0540540541",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.0162162162",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","0.0162162162",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_GLOW_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fM","=","vec2","(","0.0",",","0.0",")",";","vec2","cX","=","u_texel_size",";","vec4","aQ",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.152507",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.141763",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.141763",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.113861",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.113861",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.079019",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.079019",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.047383",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.047383",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.024549",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.024549",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.01099",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.01099",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.00425",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.00425",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.00142",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","GLSL_OUT_FRAG_COLOR","+=","aQ","*","(","1.0","-","step","(","0.0",",","-","aQ",".","a",")",")","*","0.00142",";","GLSL_OUT_FRAG_COLOR","=","clamp","(","GLSL_OUT_FRAG_COLOR",",","0.0",",","1.0",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_DOF_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fM","=","vec2","(","0.0",",","0.0",")",";","vec2","cX","=","u_texel_size",";","vec4","aQ",";","vec4","hD",";","vec4","hE",";","float","gD",";","float","hF","=","u_dof_bokeh_intensity",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","hD","=","aQ",";","hE","=","aQ",";","gD","=","aQ",".","a",";","cX","=","gD","*","cX",";","for","(","int","cq","=","0",";","cq","<","12",";","cq","+=","2",")","{","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","hD","+=","aQ",";","hE","=","max","(","hE",",","aQ",")",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","hD","+=","aQ",";","hE","=","max","(","hE",",","aQ",")",";","}","hD","/=","13.0",";","GLSL_OUT_FRAG_COLOR","=","mix","(","hD",",","hE",",","hF",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_ALPHA_BLUR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","fM","=","vec2","(","0.0",",","0.0",")",";","vec2","cX","=","u_texel_size",";","vec4","aQ",";","vec4","hD",";","vec4","hE",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","hE","=","max","(","hE",",","aQ",")",";","hD","=","aQ",";","hD",".","a","=","aQ",".","a","*","0.2270270270",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.1945945946",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.1945945946",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.1216216216",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.1216216216",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.0540540541",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.0540540541",";","fM","+=","cX",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.0162162162",";","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","fM",")",";","hE",".","a","=","max","(","hE",".","a",",","aQ",".","a",")",";","hD",".","a","+=","aQ",".","a","*","0.0162162162",";","GLSL_OUT_FRAG_COLOR","=","mix","(","hD",",","hE",",","0.5",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","POST_EFFECT_EXTEND",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","cX","=","u_texel_size",";","vec4","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";","GLSL_OUT_FRAG_COLOR","=","aQ",";","if","(","aQ",".","a","==","0.0",")","{","aQ","=","GLSL_TEXTURE","(","u_color",",","A","+","cX",")",";","if","(","aQ",".","a",">","0.0",")","GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","1.0",",","1.0",",","aQ",".","a",")",";","else","{","aQ","=","GLSL_TEXTURE","(","u_color",",","A","-","cX",")",";","if","(","aQ",".","a",">","0.0",")","GLSL_OUT_FRAG_COLOR","=","vec4","(","1.0",",","1.0",",","1.0",",","aQ",".","a",")",";","}","}"]}]}},{TYPE:"elif",EXPRESSION:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","hG","=","u_delta","[","0","]",";","float","hH","=","u_delta","[","1","]",";","float","hI","=","1.0","/","3.0",";","float","hJ","=","0.5",";","vec2","hK","=","vec2","(","hI",",","hJ",")",";","if","(","u_tex_number","==","0",")","{","vec2","ce","=","mat2","(","0.0",",","-","1.0",",","1.0",",","0.0",")","*","A","*","hK","+","vec2","(","2.0","*","hI",",","hJ",")",";","ce","[","0","]","=","max","(","ce","[","0","]",",","2.0","*","hI","+","hG",")",";","ce","[","1","]","=","max","(","ce","[","1","]",",","hH",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","ce","[","0","]",",","hJ","-","ce","[","1","]",")",")",";","}","else","if","(","u_tex_number","==","1",")","{","vec2","ce","=","mat2","(","0.0",",","-","1.0",",","1.0",",","0.0",")","*","A","*","hK","+","vec2","(","0.0",",","hJ",")",";","ce","[","0","]","=","max","(","ce","[","0","]",",","hG",")",";","ce","[","1","]","=","min","(","ce","[","1","]",",","hJ","-","hH",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","hI","-","ce","[","0","]",",","ce","[","1","]",")",")",";","}","else","if","(","u_tex_number","==","2",")","{","vec2","ce","=","A","*","hK","+","vec2","(","2.0","*","hI",",","hJ",")",";","ce","[","0","]","=","max","(","ce","[","0","]",",","2.0","*","hI","+","hG",")",";","ce","[","1","]","=","min","(","ce","[","1","]",",","1.0","-","hH",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","ce","[","0","]",",","1.5","-","ce","[","1","]",")",")",";","}","else","if","(","u_tex_number","==","3",")","{","vec2","ce","=","A","*","hK","+","vec2","(","hI",",","0.0",")",";","ce","[","0","]","=","max","(","ce","[","0","]",",","hI","+","hG",")",";","ce","[","0","]","=","min","(","ce","[","0","]",",","2.0","*","hI","-","hG",")",";","ce","[","1","]","=","min","(","ce","[","1","]",",","hJ","-","hH",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","1.0","-","ce","[","0","]",",","ce","[","1","]",")",")",";","}","else","if","(","u_tex_number","==","4",")","{","vec2","ce","=","A","*","hK","+","vec2","(","hI",",","hJ",")",";","ce","[","0","]","=","max","(","ce","[","0","]",",","hI","+","hG",")",";","ce","[","0","]","=","min","(","ce","[","0","]",",","2.0","*","hI","-","hG",")",";","ce","[","1","]","=","min","(","ce","[","1","]",",","1.0","-","hH",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","ce","[","0","]",",","3.0","*","hJ","-","ce","[","1","]",")",")",";","}","else","{","vec2","ce","=","A","*","hK","+","vec2","(","0.0",",","hJ",")",";","ce","[","0","]","=","max","(","ce","[","0","]",",","hG",")",";","ce","[","1","]","=","min","(","ce","[","1","]",",","1.0","-","hH",")",";","ce","[","1","]","=","max","(","ce","[","1","]",",","hJ","+","hH",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_color",",","vec2","(","hI","-","ce","[","0","]",",","ce","[","1","]",")",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/postprocessing.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["GLSL_IN","vec2","a_position",";","GLSL_OUT","vec2","A",";","void","main","(",")","{","A","=","2.0","*","a_position",";","gl_Position","=","vec4","(","4.0","*","(","a_position",".","xy","-","0.25",")",",","0.0",",","1.0",")",";","}"]}]},e["postprocessing/precompute_brdf.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";","precision","PRECISION","float",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","float","eb","(","int","cw",",","int","dY",")","{","float","dZ","=","1.0","/","float","(","dY",")",";","float","d_","=","1.0",";","float","ea","=","0.0",";","for","(","int","cq","=","0",";","cq","<","32",";","++","cq",")","{","if","(","cw",">","0",")","{","d_","=","mod","(","float","(","cw",")",",","2.0",")",";","ea","+=","d_","*","dZ",";","dZ","=","dZ","/","2.0",";","cw","=","int","(","float","(","cw",")","/","2.0",")",";","}","}","return","ea",";","}","vec2","ed","(","int","cq",",","int","ec",")","{","return","vec2","(","float","(","cq",")","/","float","(","ec",")",",","eb","(","cq",",","2",")",")",";","}","vec3","ek","(","vec2","ee",",","vec3","ec",",","float","ef",")","{","float","a","=","ef","*","ef",";","float","bC","=","2.0","*","M_PI","*","ee",".","x",";","float","eg","=","sqrt","(","(","1.0","-","ee",".","y",")","/","(","1.0","+","(","a","*","a","-","1.0",")","*","ee",".","y",")",")",";","float","eh","=","sqrt","(","1.0","-","eg","*","eg",")",";","vec3","ei",";","ei",".","x","=","cos","(","bC",")","*","eh",";","ei",".","y","=","sin","(","bC",")","*","eh",";","ei",".","z","=","eg",";","vec3","by","=","abs","(","ec",".","z",")","<","0.999","?","vec3","(","0.0",",","0.0",",","1.0",")",":","vec3","(","1.0",",","0.0",",","0.0",")",";","vec3","V","=","normalize","(","cross","(","by",",","ec",")",")",";","vec3","ej","=","cross","(","ec",",","V",")",";","vec3","bF","=","V","*","ei",".","x","+","ej","*","ei",".","y","+","ec","*","ei",".","z",";","return","normalize","(","bF",")",";","}","float","hO","(","float","hL",",","float","ef",")","{","float","a","=","ef",";","float","hM","=","(","a","*","a",")","/","2.0",";","float","hN","=","hL",";","float","d_","=","hL","*","(","1.0","-","hM",")","+","hM",";","return","hN","/","d_",";","}","float","hR","(","vec3","ec",",","vec3","en",",","vec3","eq",",","float","ef",")","{","float","hL","=","max","(","dot","(","ec",",","en",")",",","0.0",")",";","float","er","=","max","(","dot","(","ec",",","eq",")",",","0.0",")",";","float","hP","=","hO","(","hL",",","ef",")",";","float","hQ","=","hO","(","er",",","ef",")",";","return","hQ","*","hP",";","}","vec2","hY","(","float","hL",",","float","ef",")","{","vec3","en",";","en",".","x","=","sqrt","(","1.0","-","hL","*","hL",")",";","en",".","y","=","0.0",";","en",".","z","=","hL",";","float","cG","=","0.0",";","float","hS","=","0.0",";","vec3","ec","=","vec3","(","0.0",",","0.0",",","1.0",")",";","const","int","eo","=","1024",";","for","(","int","cq","=","0",";","cq","<","eo",";","++","cq",")","{","vec2","ee","=","ed","(","cq",",","eo",")",";","vec3","ei","=","ek","(","ee",",","ec",",","ef",")",";","vec3","eq","=","normalize","(","2.0","*","dot","(","en",",","ei",")","*","ei","-","en",")",";","float","er","=","max","(","eq",".","z",",","0.0",")",";","float","hT","=","max","(","ei",".","z",",","0.0",")",";","float","hU","=","max","(","dot","(","en",",","ei",")",",","0.0",")",";","if","(","er",">","0.0",")","{","float","hV","=","hR","(","ec",",","en",",","eq",",","ef",")",";","float","hW","=","(","hV","*","hU",")","/","(","hT","*","hL",")",";","float","hX","=","pow","(","1.0","-","hU",",","5.0",")",";","cG","+=","(","1.0","-","hX",")","*","hW",";","hS","+=","hX","*","hW",";","}","}","cG","/=","float","(","eo",")",";","hS","/=","float","(","eo",")",";","return","vec2","(","cG",",","hS",")",";","}","void","main","(",")","{","vec2","hZ","=","hY","(","A",".","x",",","A",".","y",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","hZ",",","0.0",",","1.0",")",";","}"]}]},e["postprocessing/smaa.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"SMAA_PASS",TOKENS:["SMAA_RESOLVE"]},{TYPE:"var",NAME:"SMAA_REPROJECTION",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_PREDICATION",TOKENS:["0"]},{TYPE:"var",NAME:"SMAA_DISABLE_CORNER_DETECTION",TOKENS:["0"]},{TYPE:"var",NAME:"AA_METHOD",TOKENS:["AA_METHOD_SMAA_ULTRA"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_RESOLVE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color_prev",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_blend",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2},"SMAA_PREDICATION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_predication_tex",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_search_tex",";","uniform","sampler2D","u_area_tex",";","uniform","vec4","u_subsample_indices",";"]}]}}]},{TYPE:"txt",TOKENS:["uniform","vec2","u_texel_size",";","GLSL_IN","vec2","A",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","h_",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec4","ia",";","GLSL_IN","vec4","ib",";","GLSL_IN","vec4","ic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec2","id",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_LOW",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.15"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["1"]},{TYPE:"define",NAME:"SMAA_DISABLE_CORNER_DETECTION",TOKENS:["1"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.1"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["1"]},{TYPE:"define",NAME:"SMAA_DISABLE_CORNER_DETECTION",TOKENS:["1"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_HIGH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.1"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["0"]},{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",TOKENS:["8"]},{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING",TOKENS:["25"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.05"]},{TYPE:"define",NAME:"SMAA_DISABLE_DIAG_DETECTION",TOKENS:["0"]},{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",TOKENS:["16"]},{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING",TOKENS:["25"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_THRESHOLD",TOKENS:["0.1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_DEPTH_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_DEPTH_THRESHOLD",TOKENS:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS_DIAG",TOKENS:["8"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_CORNER_ROUNDING",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING",TOKENS:["25"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",TOKENS:["2.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION_THRESHOLD",TOKENS:["0.01"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION_SCALE",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION_SCALE",TOKENS:["2.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_PREDICATION_STRENGTH",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_PREDICATION_STRENGTH",TOKENS:["0.4"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_REPROJECTION",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_REPROJECTION",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_REPROJECTION_WEIGHT_SCALE",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_REPROJECTION_WEIGHT_SCALE",TOKENS:["30.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_MAX_SEARCH_STEPS",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["16"]}]}}]},{TYPE:"define",NAME:"SMAA_AREATEX_MAX_DISTANCE",TOKENS:["16"]},{TYPE:"define",NAME:"SMAA_AREATEX_MAX_DISTANCE_DIAG",TOKENS:["20"]},{TYPE:"define",NAME:"SMAA_AREATEX_PIXEL_SIZE",TOKENS:["(","1.0","/","vec2","(","160.0",",","560.0",")",")"]},{TYPE:"define",NAME:"SMAA_AREATEX_SUBTEX_SIZE",TOKENS:["(","1.0","/","7.0",")"]},{TYPE:"define",NAME:"SMAA_SEARCHTEX_SIZE",TOKENS:["vec2","(","66.0",",","33.0",")"]},{TYPE:"define",NAME:"SMAA_SEARCHTEX_PACKED_SIZE",TOKENS:["vec2","(","64.0",",","16.0",")"]},{TYPE:"define",NAME:"SMAA_CORNER_ROUNDING_NORM",TOKENS:["(","float","(","SMAA_CORNER_ROUNDING",")","/","100.0",")"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ii","(","vec2","ce",",","sampler2D","ie",")","{","float","p","=","GLSL_TEXTURE","(","ie",",","ce",")",".","r",";","float","ig","=","GLSL_TEXTURE","(","ie",",","ia",".","xy",")",".","r",";","float","ih","=","GLSL_TEXTURE","(","ie",",","ia",".","zw",")",".","r",";","return","vec3","(","p",",","ig",",","ih",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","im","(","vec2","ce",",","sampler2D","ij",")","{","vec3","ik","=","ii","(","ce",",","ij",")",";","vec2","cX","=","abs","(","ik",".","xx","-","ik",".","yz",")",";","vec2","il","=","step","(","SMAA_PREDICATION_THRESHOLD",",","cX",")",";","return","SMAA_PREDICATION_SCALE","*","SMAA_THRESHOLD","*","(","1.0","-","SMAA_PREDICATION_STRENGTH","*","il",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","ir","(","bvec2","io",",","inout","vec2","ip",",","vec2","iq",")","{","if","(","io",".","x",")","ip",".","x","=","iq",".","x",";","if","(","io",".","y",")","ip",".","y","=","iq",".","y",";","}","void","ir","(","bvec4","io",",","inout","vec4","ip",",","vec4","iq",")","{","ir","(","io",".","xy",",","ip",".","xy",",","iq",".","xy",")",";","ir","(","io",".","zw",",","ip",".","zw",",","iq",".","zw",")",";","}","vec2","is","(","vec2","x",")","{","return","sign","(","x",")","*","floor","(","abs","(","x",")","+",".5",")",";","}","vec4","is","(","vec4","x",")","{","return","sign","(","x",")","*","floor","(","abs","(","x",")","+",".5",")",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iE","(","vec2","ce",",","sampler2D","it"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PREDICATION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","sampler2D","ij"]}]}}]},{TYPE:"txt",TOKENS:[")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PREDICATION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iu","=","im","(","ce",",","ij",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iu","=","vec2","(","SMAA_THRESHOLD",",","SMAA_THRESHOLD",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","iv","=","vec3","(","0.2126",",","0.7152",",","0.0722",")",";","float","eq","=","dot","(","GLSL_TEXTURE","(","it",",","ce",")",".","rgb",",","iv",")",";","float","iw","=","dot","(","GLSL_TEXTURE","(","it",",","ia",".","xy",")",".","rgb",",","iv",")",";","float","ix","=","dot","(","GLSL_TEXTURE","(","it",",","ia",".","zw",")",".","rgb",",","iv",")",";","vec4","cX",";","cX",".","xy","=","abs","(","eq","-","vec2","(","iw",",","ix",")",")",";","vec2","il","=","step","(","iu",",","cX",".","xy",")",";","if","(","dot","(","il",",","vec2","(","1.0",",","1.0",")",")","==","0.0",")","discard",";","float","iy","=","dot","(","GLSL_TEXTURE","(","it",",","ib",".","xy",")",".","rgb",",","iv",")",";","float","iz","=","dot","(","GLSL_TEXTURE","(","it",",","ib",".","zw",")",".","rgb",",","iv",")",";","cX",".","zw","=","abs","(","eq","-","vec2","(","iy",",","iz",")",")",";","vec2","iA","=","max","(","cX",".","xy",",","cX",".","zw",")",";","float","iB","=","dot","(","GLSL_TEXTURE","(","it",",","ic",".","xy",")",".","rgb",",","iv",")",";","float","iC","=","dot","(","GLSL_TEXTURE","(","it",",","ic",".","zw",")",".","rgb",",","iv",")",";","cX",".","zw","=","abs","(","vec2","(","iw",",","ix",")","-","vec2","(","iB",",","iC",")",")",";","iA","=","max","(","iA",".","xy",",","cX",".","zw",")",";","float","iD","=","max","(","iA",".","x",",","iA",".","y",")",";","il",".","xy","*=","step","(","iD",",","SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR","*","cX",".","xy",")",";","return","il",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_DIAG_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iG","(","vec2","iF",")","{","iF",".","r","=","iF",".","r","*","abs","(","5.0","*","iF",".","r","-","5.0","*","0.75",")",";","return","is","(","iF",")",";","}","vec4","iG","(","vec4","iF",")","{","iF",".","rb","=","iF",".","rb","*","abs","(","5.0","*","iF",".","rb","-","5.0","*","0.75",")",";","return","is","(","iF",")",";","}","vec2","iI","(","sampler2D","iH",",","vec2","ce",",","vec2","bH",",","out","vec2","iF",")","{","vec4","f_","=","vec4","(","ce",",","-","1.0",",","1.0",")",";","vec3","t","=","vec3","(","u_texel_size",",","1.0",")",";","for","(","int","cq","=","0",";","cq","<","SMAA_MAX_SEARCH_STEPS_DIAG",";","cq","++",")","{","if","(","f_",".","z","<","float","(","SMAA_MAX_SEARCH_STEPS_DIAG","-","1",")","&&","f_",".","w",">","0.9",")","{","f_",".","xyz","+=","t","*","vec3","(","bH",",","1.0",")",";","iF","=","GLSL_TEXTURE","(","iH",",","f_",".","xy",",","0.0",")",".","rg",";","f_",".","w","=","dot","(","iF",",","vec2","(","0.5",",","0.5",")",")",";","}","}","return","f_",".","zw",";","}","vec2","iJ","(","sampler2D","iH",",","vec2","ce",",","vec2","bH",",","out","vec2","iF",")","{","vec4","f_","=","vec4","(","ce",",","-","1.0",",","1.0",")",";","f_",".","x","+=","0.25","*","u_texel_size",".","x",";","vec3","t","=","vec3","(","u_texel_size",",","1.0",")",";","for","(","int","cq","=","0",";","cq","<","SMAA_MAX_SEARCH_STEPS_DIAG",";","cq","++",")","{","if","(","f_",".","z","<","float","(","SMAA_MAX_SEARCH_STEPS_DIAG","-","1",")","&&","f_",".","w",">","0.9",")","{","f_",".","xyz","=","t","*","vec3","(","bH",",","1.0",")","+","f_",".","xyz",";","iF","=","GLSL_TEXTURE","(","iH",",","f_",".","xy",",","0.0",")",".","rg",";","iF","=","iG","(","iF",")",";","f_",".","w","=","dot","(","iF",",","vec2","(","0.5",",","0.5",")",")",";","}","}","return","f_",".","zw",";","}","vec2","iL","(","sampler2D","iK",",","vec2","aM",",","vec2","iF",",","float","fM",")","{","vec2","ce","=","vec2","(","SMAA_AREATEX_MAX_DISTANCE_DIAG",",","SMAA_AREATEX_MAX_DISTANCE_DIAG",")","*","iF","+","aM",";","ce","=","SMAA_AREATEX_PIXEL_SIZE","*","ce","+","0.5","*","SMAA_AREATEX_PIXEL_SIZE",";","ce",".","x","+=","0.5",";","ce",".","y","+=","SMAA_AREATEX_SUBTEX_SIZE","*","fM",";","return","GLSL_TEXTURE","(","iK",",","ce",",","0.0",")",".","rg",";","}","vec2","iQ","(","sampler2D","iH",",","sampler2D","iK",",","vec2","ce",",","vec2","iF",",","vec4","iM",")","{","vec2","iv","=","vec2","(","0.0",",","0.0",")",";","vec4","dC",";","vec2","iN",";","if","(","iF",".","r",">","0.0",")","{","dC",".","xz","=","iI","(","iH",",","ce",",","vec2","(","-","1.0",",","1.0",")",",","iN",")",";","dC",".","x","+=","float","(","iN",".","y",">","0.9",")",";","}","else","dC",".","xz","=","vec2","(","0.0",",","0.0",")",";","dC",".","yw","=","iI","(","iH",",","ce",",","vec2","(","1.0",",","-","1.0",")",",","iN",")",";","if","(","dC",".","x","+","dC",".","y",">","2.0",")","{","vec4","iO","=","vec4","(","-","dC",".","x","+","0.25",",","dC",".","x",",","dC",".","y",",","-","dC",".","y","-","0.25",")","*","u_texel_size",".","xyxy","+","ce",".","xyxy",";","vec4","dx",";","dx",".","xy","=","GLSL_TEXTURE","(","iH",",","iO",".","xy","+","u_texel_size","*","vec2","(","-","1",",","0",")",",","0.0",")",".","rg",";","dx",".","zw","=","GLSL_TEXTURE","(","iH",",","iO",".","zw","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","rg",";","dx",".","yxwz","=","iG","(","dx",".","xyzw",")",";","vec2","iP","=","vec2","(","2.0",",","2.0",")","*","dx",".","xz","+","dx",".","yw",";","ir","(","bvec2","(","step","(","0.9",",","dC",".","zw",")",")",",","iP",",","vec2","(","0.0",",","0.0",")",")",";","iv","+=","iL","(","iK",",","dC",".","xy",",","iP",",","iM",".","z",")",";","}","dC",".","xz","=","iJ","(","iH",",","ce",",","vec2","(","-","1",",","-","1",")",",","iN",")",";","if","(","GLSL_TEXTURE","(","iH",",","ce","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","r",">","0.0",")","{","dC",".","yw","=","iJ","(","iH",",","ce",",","vec2","(","1",",","1",")",",","iN",")",";","dC",".","y","+=","float","(","iN",".","y",">","0.9",")",";","}","else","dC",".","yw","=","vec2","(","0.0",",","0.0",")",";","if","(","dC",".","x","+","dC",".","y",">","2.0",")","{","vec4","iO","=","vec4","(","-","dC",".","x",",","-","dC",".","x",",","dC",".","y",",","dC",".","y",")","*","u_texel_size",".","xyxy","+","ce",".","xyxy",";","vec4","dx",";","dx",".","x","=","GLSL_TEXTURE","(","iH",",","iO",".","xy","+","u_texel_size","*","vec2","(","-","1",",","0",")",",","0.0",")",".","g",";","dx",".","y","=","GLSL_TEXTURE","(","iH",",","iO",".","xy","+","u_texel_size","*","vec2","(","0",",","-","1",")",",","0.0",")",".","r",";","dx",".","zw","=","GLSL_TEXTURE","(","iH",",","iO",".","zw","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","gr",";","vec2","iP","=","vec2","(","2.0",",","2.0",")","*","dx",".","xz","+","dx",".","yw",";","ir","(","bvec2","(","step","(","0.9",",","dC",".","zw",")",")",",","iP",",","vec2","(","0",",","0",")",")",";","iv","+=","iL","(","iK",",","dC",".","xy",",","iP",",","iM",".","w",")",".","gr",";","}","return","iv",";","}"]}]}}]},{TYPE:"txt",TOKENS:["float","iT","(","sampler2D","iR",",","vec2","iF",",","float","fM",")","{","vec2","hK","=","SMAA_SEARCHTEX_SIZE","*","vec2","(","0.5",",","-","1.0",")",";","vec2","iS","=","SMAA_SEARCHTEX_SIZE","*","vec2","(","fM",",","1.0",")",";","hK","+=","vec2","(","-","1.0",",","1.0",")",";","iS","+=","vec2","(","0.5",",","-","0.5",")",";","hK","*=","1.0","/","SMAA_SEARCHTEX_PACKED_SIZE",";","iS","*=","1.0","/","SMAA_SEARCHTEX_PACKED_SIZE",";","return","GLSL_TEXTURE","(","iR",",","hK","*","iF","+","iS",",","0.0",")",".","r",";","}","float","iU","(","sampler2D","iH",",","sampler2D","iR",",","vec2","ce",",","float","iN",")","{","vec2","iF","=","vec2","(","0.0",",","1.0",")",";","for","(","int","cq","=","0",";","cq","<","SMAA_MAX_SEARCH_STEPS",";","cq","++",")","{","if","(","ce",".","x",">","iN","&&","iF",".","g",">","0.8281","&&","iF",".","r","==","0.0",")","{","iF","=","GLSL_TEXTURE","(","iH",",","ce",",","0.0",")",".","rg",";","ce","=","-","vec2","(","2.0",",","0.0",")","*","u_texel_size","+","ce",";","}","}","float","fM","=","-","(","255.0","/","127.0",")","*","iT","(","iR",",","iF",",","0.0",")","+","3.25",";","return","u_texel_size",".","x","*","fM","+","ce",".","x",";","}","float","iV","(","sampler2D","iH",",","sampler2D","iR",",","vec2","ce",",","float","iN",")","{","vec2","iF","=","vec2","(","0.0",",","1.0",")",";","for","(","int","cq","=","0",";","cq","<","SMAA_MAX_SEARCH_STEPS",";","cq","++",")","{","if","(","ce",".","x","<","iN","&&","iF",".","g",">","0.8281","&&","iF",".","r","==","0.0",")","{","iF","=","GLSL_TEXTURE","(","iH",",","ce",",","0.0",")",".","rg",";","ce","=","vec2","(","2.0",",","0.0",")","*","u_texel_size","+","ce",";","}","}","float","fM","=","-","(","255.0","/","127.0",")","*","iT","(","iR",",","iF",",","0.5",")","+","3.25",";","return","-","u_texel_size",".","x","*","fM","+","ce",".","x",";","}","float","iW","(","sampler2D","iH",",","sampler2D","iR",",","vec2","ce",",","float","iN",")","{","vec2","iF","=","vec2","(","1.0",",","0.0",")",";","for","(","int","cq","=","0",";","cq","<","SMAA_MAX_SEARCH_STEPS",";","cq","++",")","{","if","(","ce",".","y",">","iN","&&","iF",".","r",">","0.8281","&&","iF",".","g","==","0.0",")","{","iF","=","GLSL_TEXTURE","(","iH",",","ce",",","0.0",")",".","rg",";","ce","=","-","vec2","(","0.0",",","2.0",")","*","u_texel_size","+","ce",";","}","}","float","fM","=","-","(","255.0","/","127.0",")","*","iT","(","iR",",","iF",".","gr",",","0.0",")","+","3.25",";","return","u_texel_size",".","y","*","fM","+","ce",".","y",";","}","float","iX","(","sampler2D","iH",",","sampler2D","iR",",","vec2","ce",",","float","iN",")","{","vec2","iF","=","vec2","(","1.0",",","0.0",")",";","for","(","int","cq","=","0",";","cq","<","SMAA_MAX_SEARCH_STEPS",";","cq","++",")","{","if","(","ce",".","y","<","iN","&&","iF",".","r",">","0.8281","&&","iF",".","g","==","0.0",")","{","iF","=","GLSL_TEXTURE","(","iH",",","ce",",","0.0",")",".","rg",";","ce","=","vec2","(","0.0",",","2.0",")","*","u_texel_size","+","ce",";","}","}","float","fM","=","-","(","255.0","/","127.0",")","*","iT","(","iR",",","iF",".","gr",",","0.5",")","+","3.25",";","return","-","u_texel_size",".","y","*","fM","+","ce",".","y",";","}","vec2","i_","(","sampler2D","iK",",","vec2","aM",",","float","iY",",","float","iZ",",","float","fM",")","{","vec2","ce","=","vec2","(","SMAA_AREATEX_MAX_DISTANCE",",","SMAA_AREATEX_MAX_DISTANCE",")","*","is","(","4.0","*","vec2","(","iY",",","iZ",")",")","+","aM",";","ce","=","SMAA_AREATEX_PIXEL_SIZE","*","ce","+","0.5","*","SMAA_AREATEX_PIXEL_SIZE",";","ce",".","y","=","SMAA_AREATEX_SUBTEX_SIZE","*","fM","+","ce",".","y",";","return","GLSL_TEXTURE","(","iK",",","ce",",","0.0",")",".","rg",";","}","void","jc","(","sampler2D","iH",",","inout","vec2","iv",",","vec4","ce",",","vec2","dC",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_CORNER_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ja","=","step","(","dC",".","xy",",","dC",".","yx",")",";","vec2","jb","=","(","1.0","-","SMAA_CORNER_ROUNDING_NORM",")","*","ja",";","jb","/=","ja",".","x","+","ja",".","y",";","vec2","aL","=","vec2","(","1.0",",","1.0",")",";","aL",".","x","-=","jb",".","x","*","GLSL_TEXTURE","(","iH",",","ce",".","xy","+","u_texel_size","*","vec2","(","0",",","1",")",",","0.0",")",".","r",";","aL",".","x","-=","jb",".","y","*","GLSL_TEXTURE","(","iH",",","ce",".","zw","+","u_texel_size","*","vec2","(","1",",","1",")",",","0.0",")",".","r",";","aL",".","y","-=","jb",".","x","*","GLSL_TEXTURE","(","iH",",","ce",".","xy","+","u_texel_size","*","vec2","(","0",",","-","2",")",",","0.0",")",".","r",";","aL",".","y","-=","jb",".","y","*","GLSL_TEXTURE","(","iH",",","ce",".","zw","+","u_texel_size","*","vec2","(","1",",","-","2",")",",","0.0",")",".","r",";","iv","*=","clamp","(","aL",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","jd","(","sampler2D","iH",",","inout","vec2","iv",",","vec4","ce",",","vec2","dC",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_CORNER_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","ja","=","step","(","dC",".","xy",",","dC",".","yx",")",";","vec2","jb","=","(","1.0","-","SMAA_CORNER_ROUNDING_NORM",")","*","ja",";","jb","/=","ja",".","x","+","ja",".","y",";","vec2","aL","=","vec2","(","1.0",",","1.0",")",";","aL",".","x","-=","jb",".","x","*","GLSL_TEXTURE","(","iH",",","ce",".","xy","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","g",";","aL",".","x","-=","jb",".","y","*","GLSL_TEXTURE","(","iH",",","ce",".","zw","+","u_texel_size","*","vec2","(","1",",","1",")",",","0.0",")",".","g",";","aL",".","y","-=","jb",".","x","*","GLSL_TEXTURE","(","iH",",","ce",".","xy","+","u_texel_size","*","vec2","(","-","2",",","0",")",",","0.0",")",".","g",";","aL",".","y","-=","jb",".","y","*","GLSL_TEXTURE","(","iH",",","ce",".","zw","+","u_texel_size","*","vec2","(","-","2",",","1",")",",","0.0",")",".","g",";","iv","*=","clamp","(","aL",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jg","(","vec2","ce",",","vec2","je",",","sampler2D","iH",",","sampler2D","iK",",","sampler2D","iR",",","vec4","iM",")","{","vec4","iv","=","vec4","(","0.0",",","0.0",",","0.0",",","0.0",")",";","vec2","iF","=","GLSL_TEXTURE","(","iH",",","ce",")",".","rg",";","if","(","iF",".","g",">","0.0",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_DIAG_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["iv",".","rg","=","iQ","(","iH",",","iK",",","ce",",","iF",",","iM",")",";","if","(","iv",".","r","==","-","iv",".","g",")","{"]}]}}]},{TYPE:"txt",TOKENS:["vec2","dC",";","vec3","iO",";","iO",".","x","=","iU","(","iH",",","iR",",","ia",".","xy",",","ic",".","x",")",";","iO",".","y","=","ib",".","y",";","dC",".","x","=","iO",".","x",";","float","iY","=","GLSL_TEXTURE","(","iH",",","iO",".","xy",",","0.0",")",".","r",";","iO",".","z","=","iV","(","iH",",","iR",",","ia",".","zw",",","ic",".","y",")",";","dC",".","y","=","iO",".","z",";","dC","=","abs","(","is","(","dC","/","u_texel_size",".","xx","-","je",".","xx",")",")",";","vec2","jf","=","sqrt","(","dC",")",";","float","iZ","=","GLSL_TEXTURE","(","iH",",","iO",".","zy","+","u_texel_size","*","vec2","(","1",",","0",")",",","0.0",")",".","r",";","iv",".","rg","=","i_","(","iK",",","jf",",","iY",",","iZ",",","iM",".","y",")",";","iO",".","y","=","ce",".","y",";","jc","(","iH",",","iv",".","rg",",","iO",".","xyzy",",","dC",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_DISABLE_DIAG_DETECTION",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["}","else","iF",".","r","=","0.0",";"]}]}}]},{TYPE:"txt",TOKENS:["}","if","(","iF",".","r",">","0.0",")","{","vec2","dC",";","vec3","iO",";","iO",".","y","=","iW","(","iH",",","iR",",","ib",".","xy",",","ic",".","z",")",";","iO",".","x","=","ia",".","x",";","dC",".","x","=","iO",".","y",";","float","iY","=","GLSL_TEXTURE","(","iH",",","iO",".","xy",",","0.0",")",".","g",";","iO",".","z","=","iX","(","iH",",","iR",",","ib",".","zw",",","ic",".","w",")",";","dC",".","y","=","iO",".","z",";","dC","=","abs","(","is","(","dC","/","u_texel_size",".","yy","-","je",".","yy",")",")",";","vec2","jf","=","sqrt","(","dC",")",";","float","iZ","=","GLSL_TEXTURE","(","iH",",","iO",".","xz","+","u_texel_size","*","vec2","(","0",",","1",")",",","0.0",")",".","g",";","iv",".","ba","=","i_","(","iK",",","jf",",","iY",",","iZ",",","iM",".","x",")",";","iO",".","x","=","ce",".","x",";","jd","(","iH",",","iv",".","ba",",","iO",".","xyxz",",","dC",")",";","}","return","iv",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jp","(","vec2","ce",",","sampler2D","it",",","sampler2D","jh"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","sampler2D","ji"]}]}}]},{TYPE:"txt",TOKENS:[")","{","vec4","a",";","a",".","x","=","GLSL_TEXTURE","(","jh",",","h_",".","xy",")",".","a",";","a",".","y","=","GLSL_TEXTURE","(","jh",",","h_",".","zw",")",".","g",";","a",".","wz","=","GLSL_TEXTURE","(","jh",",","ce",")",".","xz",";","if","(","dot","(","a",",","vec4","(","1.0",",","1.0",",","1.0",",","1.0",")",")","<","1e-5",")","{","vec4","aQ","=","GLSL_TEXTURE","(","it",",","ce",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jj","=","GLSL_TEXTURE","(","ji",",","A",")",";","vec2","dp","=","2.0","*","jk","(","jj",")","-","1.0",";","aQ",".","a","=","sqrt","(","2.0","*","length","(","dp",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","aQ",";","}","else","{","bool","co","=","max","(","a",".","x",",","a",".","z",")",">","max","(","a",".","y",",","a",".","w",")",";","vec4","jl","=","vec4","(","0.0",",","a",".","y",",","0.0",",","a",".","w",")",";","vec2","jm","=","a",".","yw",";","ir","(","bvec4","(","co",",","co",",","co",",","co",")",",","jl",",","vec4","(","a",".","x",",","0.0",",","a",".","z",",","0.0",")",")",";","ir","(","bvec2","(","co",",","co",")",",","jm",",","a",".","xz",")",";","jm","/=","dot","(","jm",",","vec2","(","1.0",",","1.0",")",")",";","vec4","jn","=","jl","*","vec4","(","u_texel_size",",","-","u_texel_size",")","+","ce",".","xyxy",";","vec4","aQ","=","jm",".","x","*","GLSL_TEXTURE","(","it",",","jn",".","xy",",","0.0",")",";","aQ","+=","jm",".","y","*","GLSL_TEXTURE","(","it",",","jn",".","zw",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jj","=","GLSL_TEXTURE","(","ji",",","jn",".","xy",")",";","vec2","jo","=","2.0","*","jk","(","jj",")","-","1.0",";","vec2","dp","=","jm",".","x","*","jo",";","jj","=","GLSL_TEXTURE","(","ji",",","jn",".","zw",")",";","jo","=","2.0","*","jk","(","jj",")","-","1.0",";","dp","+=","jm",".","y","*","jo",";","aQ",".","a","=","sqrt","(","2.0","*","length","(","dp",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","aQ",";","}","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_RESOLVE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","ju","(","vec2","ce",",","sampler2D","jq",",","sampler2D","jr"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","sampler2D","ji"]}]}}]},{TYPE:"txt",TOKENS:[")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","jj","=","GLSL_TEXTURE","(","ji",",","A",")",";","vec2","dp",";","dp","=","2.0","*","jk","(","jj",")","-","1.0",";","vec4","js","=","GLSL_TEXTURE","(","jq",",","ce",")",";","vec4","jt","=","GLSL_TEXTURE","(","jr",",","ce","-","dp",")",";","float","cX","=","abs","(","js",".","a","*","js",".","a","-","jt",".","a","*","jt",".","a",")","/","2.0",";","float","cu","=","0.5","*","clamp","(","1.0","-","sqrt","(","cX",")","*","SMAA_REPROJECTION_WEIGHT_SCALE",",","0.0",",","1.0",")",";","vec4","aQ","=","mix","(","js",",","jt",",","cu",")",";","aQ",".","a","=","1.0",";","return","aQ",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","js","=","GLSL_TEXTURE","(","jq",",","ce",")",";","vec4","jt","=","GLSL_TEXTURE","(","jr",",","ce",")",";","return","mix","(","js",",","jt",",","0.5",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","vec4","(","iE","(","A",",","u_color"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PREDICATION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","u_predication_tex"]}]}}]},{TYPE:"txt",TOKENS:[")",",","0.0",",","0.0",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","jg","(","A",",","id",",","u_color",",","u_area_tex",",","u_search_tex",",","u_subsample_indices",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","jp","(","A",",","u_color",",","u_blend"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","u_velocity_tex"]}]}}]},{TYPE:"txt",TOKENS:[")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_RESOLVE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","vec4","(","ju","(","A",",","u_color",",","u_color_prev"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_REPROJECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[",","u_velocity_tex"]}]}}]},{TYPE:"txt",TOKENS:[")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","aQ","=","GLSL_TEXTURE","(","u_color",",","A",")",";"]}]}}]},{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","aQ",";","}"]}]},e["postprocessing/smaa.glslv"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SMAA_PASS",TOKENS:["SMAA_RESOLVE"]},{TYPE:"var",NAME:"AA_METHOD",TOKENS:["AA_METHOD_SMAA_LOW"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["uniform","PRECISION","vec2","u_texel_size",";","GLSL_IN","vec2","a_position",";","GLSL_OUT","vec2","A",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","h_",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec4","ia",";","GLSL_OUT","vec4","ib",";","GLSL_OUT","vec4","ic",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT","vec2","id",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_LOW",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["4"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["8"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_HIGH",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["16"]}]}},{TYPE:"elif",EXPRESSION:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["32"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SMAA_MAX_SEARCH_STEPS",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SMAA_MAX_SEARCH_STEPS",TOKENS:["16"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","jv","(","vec2","ce",")","{","ia","=","u_texel_size",".","xyxy","*","vec4","(","-","1.0",",","0.0",",","0.0",",","-","1.0",")","+","ce",".","xyxy",";","ib","=","u_texel_size",".","xyxy","*","vec4","(","1.0",",","0.0",",","0.0",",","1.0",")","+","ce",".","xyxy",";","ic","=","u_texel_size",".","xyxy","*","vec4","(","-","2.0",",","0.0",",","0.0",",","-","2.0",")","+","ce",".","xyxy",";","}"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","jw","(","vec2","ce",",","out","vec2","je",")","{","je","=","ce","/","u_texel_size",";","ia","=","u_texel_size",".","xyxy","*","vec4","(","-","0.25",",","-","0.125",",","1.25",",","-","0.125",")","+","ce",".","xyxy",";","ib","=","u_texel_size",".","xyxy","*","vec4","(","-","0.125",",","-","0.25",",","-","0.125",",","1.25",")","+","ce",".","xyxy",";","ic","=","u_texel_size",".","xxyy","*","vec4","(","-","2.0",",","2.0",",","-","2.0",",","2.0",")","*","float","(","SMAA_MAX_SEARCH_STEPS",")","+","vec4","(","ia",".","xz",",","ib",".","yw",")",";","}"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","jx","(","vec2","ce",")","{","h_","=","u_texel_size",".","xyxy","*","vec4","(","1.0",",","0.0",",","0.0",",","1.0",")","+","ce",".","xyxy",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","A","=","2.0","*","a_position",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SMAA_PASS","SMAA_EDGE_DETECTION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jv","(","A",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jw","(","A",",","id",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jx","(","A",")",";"]}]}}]},{TYPE:"txt",TOKENS:["gl_Position","=","vec4","(","4.0","*","(","a_position",".","xy","-","0.25",")",",","0.0",",","1.0",")",";","}"]}]},e["postprocessing/ssao.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SSAO_WHITE",TOKENS:["0"]},{TYPE:"var",NAME:"SSAO_QUALITY",TOKENS:["SSAO_QUALITY_8"]},{TYPE:"var",NAME:"SSAO_HEMISPHERE",TOKENS:["0"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"depth_fetch.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_color",";","uniform","sampler2D","u_depth",";","uniform","sampler2D","u_ssao_special_tex",";","uniform","vec2","u_camera_range",";","uniform","vec2","u_texel_size",";","uniform","float","u_ssao_radius_increase",";","uniform","float","u_ssao_influence",";","uniform","float","u_ssao_dist_factor",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","float","jy","(","in","vec2","f_",")","{","return","gC","(","u_depth",",","f_",",","u_camera_range",")",";","}","void","main","(",")","{","vec3","gG","=","GLSL_TEXTURE","(","u_color",",","A",")",".","rgb",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_WHITE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","gG",",","1.0",")",";","return",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","jz","=","normalize","(","2.0","*","GLSL_TEXTURE","(","u_ssao_special_tex",",","A","*","0.25","/","u_texel_size",")",".","rgb","-","1.0",")",";","float","et","=","jy","(","A",")",";","float","jA","=","et","*","(","u_camera_range",".","y","-","u_camera_range",".","x",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_8",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","jB","=","8.0",";","const","int","jC","=","1",";"]}]}},{TYPE:"elif",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_16",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","jB","=","16.0",";","const","int","jC","=","2",";"]}]}},{TYPE:"elif",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_24",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","jB","=","24.0",";","const","int","jC","=","3",";"]}]}},{TYPE:"elif",EXPRESSION:["SSAO_QUALITY","SSAO_QUALITY_32",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","jB","=","32.0",";","const","int","jC","=","4",";"]}]}}]},{TYPE:"txt",TOKENS:["float","jD","=","u_ssao_radius_increase","*","0.001",";","const","float","jE","=","1.0","+","2.4","/","jB",";","float","jF","=","0.0",";","for","(","int","cq","=","0",";","cq","<","jC",";","cq","++",")","for","(","int","x","=","-","1",";","x","<=","1",";","x","+=","2",")","for","(","int","y","=","-","1",";","y","<=","1",";","y","+=","2",")","for","(","int","z","=","-","1",";","z","<=","1",";","z","+=","2",")","{","vec3","jG","=","reflect","(","normalize","(","vec3","(","x",",","y",",","z",")",")",",","jz",")","*","(","jD","*=","jE",")",";","vec3","jH","=","vec3","(","A",",","jA",")",";","jH","+=","vec3","(","jG",".","xy",",","jG",".","z","*","jA","*","2.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_HEMISPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jH",".","z","-=","1.4","*","(","jH",".","z","-","jA",")","*","step","(","jA",",","jH",".","z",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","jI","=","jy","(","jH",".","xy",")","*","(","u_camera_range",".","y","-","u_camera_range",".","x",")",";","float","jJ","=","clamp","(","(","jA","-","jI",")","/","jI",",","0.0",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_HEMISPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jF","+=","mix","(","1.0",",","jJ",",","step","(","jI",",","jH",".","z",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jF","+=","mix","(","step","(","jH",".","z",",","jI",")",",","0.5",",","jJ",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","jF","=","jF","/","jB",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_HEMISPHERE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jF","=","clamp","(","jF","*","jF","+","0.6","*","jF",",","0.0",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jF","=","clamp","(","jF","*","jF","+","jF",",","0.0",",","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","jK","=","u_ssao_influence","*","(","1.0","-","u_ssao_dist_factor","*","et",")",";","jF","=","mix","(","1.0",",","jF",",","jK",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","gG",",","jF",")",";","}"]}]},e["postprocessing/ssao_blur.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SSAO_BLUR_DEPTH",TOKENS:["0"]},{TYPE:"txt",TOKENS:["precision","PRECISION","sampler2D",";"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"depth_fetch.glslf"}]}}]},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_ssao_mask",";","uniform","vec2","u_texel_size",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","sampler2D","u_depth",";","uniform","vec2","u_camera_range",";","uniform","float","u_ssao_blur_discard_value",";","float","jy","(","in","vec2","f_",")","{","return","gC","(","u_depth",",","f_",",","u_camera_range",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{","float","jL","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","jM","=","jy","(","A",")",";","float","cu","=","0.0",";","float","jN","=","u_ssao_blur_discard_value","*","100.0",";"]}]}}]},{TYPE:"txt",TOKENS:["vec2","jO","=","vec2","(","-","2.0",")",";","for","(","int","cq","=","0",";","cq","<","4",";","++","cq",")","{","for","(","int","jP","=","0",";","jP","<","4",";","++","jP",")","{","vec2","fM","=","(","jO","+","vec2","(","float","(","cq",")",",","float","(","jP",")",")",")","*","u_texel_size",";","float","jQ","=","GLSL_TEXTURE","(","u_ssao_mask",",","A","+","fM",")",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","jR","=","jy","(","A","+","fM",")",";","float","jS","=","1.0","-","clamp","(","abs","(","jR","-","jM",")","*","jN",",","0.0",",","1.0",")",";","jL","+=","jQ","*","jS",";","cu","+=","jS",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jL","+=","jQ",";"]}]}}]},{TYPE:"txt",TOKENS:["}","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SSAO_BLUR_DEPTH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","GLSL_TEXTURE","(","u_ssao_mask",",","A",")",".","rgb",",","jL","/","cu",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_OUT_FRAG_COLOR","=","vec4","(","GLSL_TEXTURE","(","u_ssao_mask",",","A",")",".","rgb",",","jL","/","16.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/stereo.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"var",NAME:"ANAGLYPH",TOKENS:["0"]},{TYPE:"var",NAME:"SIDEBYSIDE",TOKENS:["0"]},{TYPE:"var",NAME:"EPSILON",TOKENS:["0.000001"]},{TYPE:"var",NAME:"DISTOR_SCALE",TOKENS:["0.8"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_sampler_left",";","uniform","sampler2D","u_sampler_right",";","uniform","vec2","u_texel_size",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ANAGLYPH",{TYPE:"logic_negative_expr",PLACES:1},"SIDEBYSIDE",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["uniform","int","u_enable_hmd_stereo",";","uniform","vec4","u_distortion_params",";","uniform","vec4","u_chromatic_aberration_coefs",";","void","ka","(","vec2","ce",",","vec2","ao",",","float","di",",","sampler2D","jT",")","{","vec2","bD","=","(","ce","-","ao",")","*","4.0","*","u_texel_size","[","0","]","/","u_texel_size","[","1","]","/","di",";","float","jU","=","bD",".","x","*","bD",".","x","+","bD",".","y","*","bD",".","y",";","vec2","jV","=","bD","*","(","1.0","+","u_distortion_params","[","0","]","*","jU","+","u_distortion_params","[","1","]","*","jU","*","jU",")",";","vec2","jW","=","jV","*","0.5","/","(","1.0","+","u_distortion_params","[","0","]","+","u_distortion_params","[","1","]",")",";","if","(","length","(","u_chromatic_aberration_coefs",")",">","0.0",")","{","vec2","jX","=","jW","*","(","1.0","+","u_chromatic_aberration_coefs","[","0","]","+","jU","*","u_chromatic_aberration_coefs","[","1","]",")","+","0.5",";","vec2","jY","=","jW","+","0.5",";","vec2","jZ","=","jW","*","(","1.0","+","u_chromatic_aberration_coefs","[","2","]","+","jU","*","u_chromatic_aberration_coefs","[","3","]",")","+","0.5",";","if","(","clamp","(","jZ",",","0.0",",","1.0",")","!=","jZ",")","{","GLSL_OUT_FRAG_COLOR","=","vec4","(","0.0",")",";","}","else","{","vec4","j_","=","GLSL_TEXTURE","(","jT",",","jY",")",";","GLSL_OUT_FRAG_COLOR","[","0","]","=","GLSL_TEXTURE","(","jT",",","jX",")",".","x",";","GLSL_OUT_FRAG_COLOR","[","1","]","=","j_",".","y",";","GLSL_OUT_FRAG_COLOR","[","2","]","=","GLSL_TEXTURE","(","jT",",","jZ",")",".","z",";","GLSL_OUT_FRAG_COLOR","[","3","]","=","j_",".","w",";","}","}","else","{","jW","+=","0.5",";","if","(","clamp","(","jW",",","0.0",",","1.0",")","!=","jW",")","{","GLSL_OUT_FRAG_COLOR","=","vec4","(","0.0",")",";","}","else","{","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","jT",",","jW",")",";","}","}","}"]}]}}]},{TYPE:"txt",TOKENS:["void","main","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["ANAGLYPH"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","kb","=","GLSL_TEXTURE","(","u_sampler_left",",","A",")",";","vec4","kc","=","GLSL_TEXTURE","(","u_sampler_right",",","A",")",";","vec3","kd","=","vec3","(","kb","[","0","]",",","kb","[","1","]",",","kb","[","2","]",")",";","bG","(","kd",")",";","vec3","ke","=","vec3","(","kc","[","0","]",",","kc","[","1","]",",","kc","[","2","]",")",";","bG","(","ke",")",";","mat3","kf","=","mat3","(","0.437",",","-","0.062",",","-","0.048",",","0.449",",","-","0.062",",","-","0.050",",","0.164",",","-","0.024",",","-","0.017",")",";","mat3","bz","=","mat3","(","-","0.011",",","0.377",",","-","0.026",",","-","0.032",",","0.761",",","-","0.093",",","-","0.007",",","0.009",",","1.234",")",";","vec3","aQ","=","clamp","(","kf","*","kd",",","0.0",",","1.0",")","+","clamp","(","bz","*","ke",",","0.0",",","1.0",")",";","aW","(","aQ",")",";","GLSL_OUT_FRAG_COLOR","=","vec4","(","aQ",",","kb","[","3","]","+","kc","[","3","]",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SIDEBYSIDE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","A","[","0","]","<","0.5",")","{","vec2","ce","=","vec2","(","2.0","*","A","[","0","]",",","A","[","1","]",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_left",",","ce",")",";","}","else","{","vec2","ce","=","vec2","(","2.0","*","(","A","[","0","]","-","0.5",")",",","A","[","1","]",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_right",",","ce",")",";","}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","u_enable_hmd_stereo","!=","0",")","{","if","(","abs","(","u_distortion_params","[","0","]",")",">","EPSILON","||","abs","(","u_distortion_params","[","1","]",")",">","EPSILON",")","if","(","A","[","0","]","<","0.5",")","{","vec2","ce","=","vec2","(","2.0","*","A","[","0","]",",","A","[","1","]",")",";","vec2","ao","=","vec2","(","0.5","-","(","u_distortion_params","[","3","]","-","0.5",")","/","2.0",",","u_distortion_params","[","2","]",")",";","float","di","=","2.0","*","u_distortion_params","[","3","]","*","DISTOR_SCALE",";","ka","(","ce",",","ao",",","di",",","u_sampler_left",")",";","}","else","{","vec2","ce","=","vec2","(","2.0","*","(","A","[","0","]","-","0.5",")",",","A","[","1","]",")",";","vec2","ao","=","vec2","(","0.5","+","(","u_distortion_params","[","3","]","-","0.5",")","/","2.0",",","u_distortion_params","[","2","]",")",";","float","di","=","2.0","*","u_distortion_params","[","3","]","*","DISTOR_SCALE",";","ka","(","ce",",","ao",",","di",",","u_sampler_right",")",";","}","else","if","(","A","[","0","]","<","0.5",")","{","vec2","ce","=","vec2","(","2.0","*","A","[","0","]",",","A","[","1","]",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_left",",","ce",")",";","}","else","{","vec2","ce","=","vec2","(","2.0","*","(","A","[","0","]","-","0.5",")",",","A","[","1","]",")",";","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_right",",","ce",")",";","}","}","else","{","GLSL_OUT_FRAG_COLOR","=","GLSL_TEXTURE","(","u_sampler_left",",","A",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]},e["postprocessing/velocity.glslf"]={TYPE:"grp",PARTS:[{TYPE:"version",TOKENS:["GLSL_VERSION"]},{TYPE:"include",FILE:"precision_statement.glslf"},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"pack.glslf"},{TYPE:"txt",TOKENS:["uniform","sampler2D","u_depth",";","uniform","mat4","u_view_proj_inverse",";","uniform","mat4","u_view_proj_prev",";","GLSL_IN","vec2","A",";","GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";","void","main","(",")","{","float","et","=","GLSL_TEXTURE","(","u_depth",",","A",")",".","x",";","vec4","kg","=","vec4","(","A","*","2.0","-","1.0",",","2.0","*","et","-","1.0",",","1.0",")",";","vec4","cD","=","u_view_proj_inverse","*","kg",";","vec4","kh","=","cD","/","cD",".","w",";","vec4","ki","=","u_view_proj_prev","*","kh",";","ki","/=","ki",".","w",";","vec2","dp","=","(","kg",".","xy","-","ki",".","xy",")","/","4.0","+","0.5",";","dp","=","clamp","(","dp",",","0.0",",","1.0",")",";","GLSL_OUT_FRAG_COLOR","=","eu","(","dp",")",";","}"]}]},e["include/blending.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"BLENDING_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"BLENDING_GLSLF",TOKENS:[""]},{TYPE:"txt",TOKENS:["vec3","kj","(","vec3","rgb",")","{","vec4","hM","=","vec4","(","_0_0",",","-","_1_0","/","3.0",",","2.0","/","3.0",",","-","_1_0",")",";","vec4","p","=","mix","(","vec4","(","rgb",".","bg",",","hM",".","wz",")",",","vec4","(","rgb",".","gb",",","hM",".","xy",")",",","step","(","rgb",".","b",",","rgb",".","g",")",")",";","vec4","q","=","mix","(","vec4","(","p",".","xyw",",","rgb",".","r",")",",","vec4","(","rgb",".","r",",","p",".","yzx",")",",","step","(","p",".","x",",","rgb",".","r",")",")",";","float","dC","=","q",".","x","-","min","(","q",".","w",",","q",".","y",")",";","float","iF","=","1.0e-10",";","return","vec3","(","abs","(","q",".","z","+","(","q",".","w","-","q",".","y",")","/","(","6.0","*","dC","+","iF",")",")",",","dC","/","(","q",".","x","+","iF",")",",","q",".","x",")",";","}","vec3","kl","(","vec3","kk",")","{","vec4","hM","=","vec4","(","_1_0",",","2.0","/","3.0",",","_1_0","/","3.0",",","3.0",")",";","vec3","p","=","abs","(","fract","(","vec3","(","kk",".","r",",","kk",".","r",",","kk",".","r",")","+","hM",".","xyz",")","*","6.0","-","hM",".","www",")",";","return","kk",".","b","*","mix","(","hM",".","xxx",",","clamp","(","p","-","hM",".","xxx",",","_0_0",",","_1_0",")",",","kk",".","g",")",";","}","vec3","kp","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","mix","(","km",",","kn",",","ko",")",";","}","vec3","kq","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","ko","*","km","+","kn",";","}","vec3","kr","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","kn","-","ko","*","km",";","}","vec3","kt","(","vec3","km",",","vec3","kn",",","float","ko",")","{","float","ks","=","_1_0","-","ko",";","return","(","vec3","(","ks",")","+","ko","*","km",")","*","kn",";","}","vec3","ku","(","vec3","km",",","vec3","kn",",","float","ko",")","{","vec3","ks","=","vec3","(","_1_0","-","ko",")",";","return","vec3","(","_1_0",")","-","(","ks","+","ko","*","(","vec3","(","_1_0",")","-","km",")",")","*","(","vec3","(","_1_0",")","-","kn",")",";","}","vec3","kv","(","vec3","km",",","vec3","kn",",","float","ko",")","{","vec3","ks","=","vec3","(","_1_0","-","ko",")",";","return","mix","(","kn","*","(","ks","+","2.0","*","ko","*","km",")",",","vec3","(","_1_0",")","-","(","ks","+","2.0","*","ko","*","(","vec3","(","_1_0",")","-","km",")",")","*","(","vec3","(","_1_0",")","-","kn",")",",","step","(","0.5",",","kn",")",")",";","}","vec3","kw","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","mix","(","kn",",","abs","(","km","-","kn",")",",","ko",")",";","}","vec3","kx","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","mix","(","kn",",","kn","/","(","km","+","step","(","km",",","vec3","(","_0_0",")",")",")",",","ko",")",";","}","vec3","ky","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","mix","(","kn",",","min","(","km",",","kn",")",",","ko",")",";","}","vec3","kz","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","max","(","ko","*","km",",","kn",")",";","}","vec3","kD","(","vec3","km",",","vec3","kn",",","float","ko",")","{","vec3","kA","=","kj","(","kn",")",";","if","(","kA",".","y","!=","_0_0",")","{","vec3","kB","=","kj","(","km",")",";","vec3","kC","=","kl","(","vec3","(","kA",".","x",",","kB",".","yz",")",")",";","return","mix","(","km",",","kC",",","ko",")",";","}","return","km",";","}","vec3","kE","(","vec3","km",",","vec3","kn",",","float","ko",")","{","vec3","kA","=","kj","(","km",")",";","if","(","kA",".","y","!=","_0_0",")","{","vec3","kB","=","kj","(","kn",")",";","return","kl","(","vec3","(","kA",".","x",",","mix","(","kA",".","y",",","kB",".","y",",","ko",")",",","kA",".","z",")",")",";","}","return","km",";","}","vec3","kF","(","vec3","km",",","vec3","kn",",","float","ko",")","{","vec3","kA","=","kj","(","km",")",";","vec3","kB","=","kj","(","kn",")",";","return","kl","(","vec3","(","kA",".","xy",",","mix","(","kA",".","z",",","kB",".","z",",","ko",")",")",")",";","}","vec3","kG","(","vec3","km",",","vec3","kn",",","float","ko",")","{","vec3","kA","=","kj","(","kn",")",";","if","(","kA",".","y","!=","_0_0",")","{","vec3","kB","=","kj","(","km",")",";","vec3","kC","=","kl","(","vec3","(","kA",".","xy",",","kB",".","z",")",")",";","return","mix","(","km",",","kC",",","ko",")",";","}","return","km",";","}","vec3","kI","(","vec3","km",",","vec3","kn",",","float","ko",")","{","vec3","kH","=","vec3","(","_1_0",")","-","(","vec3","(","_1_0",")","-","kn",")","*","(","vec3","(","_1_0",")","-","km",")",";","return","mix","(","km",",","(","(","vec3","(","_1_0",")","-","km",")","*","kn","*","km",")","+","km","*","kH",",","ko",")",";","}","vec3","kJ","(","vec3","km",",","vec3","kn",",","float","ko",")","{","return","km","+","ko","*","(","2.0","*","kn","-","_1_0",")",";","}","float","kN","(","float","kK",",","float","kL",",","float","ko",",","float","kM",")","{","float","ks","=","_1_0","-","kM",";","return","(","ks","+","ko","*","kK",")","*","kL",";","}","float","kO","(","float","kK",",","float","kL",",","float","ko",",","float","kM",")","{","float","ks","=","_1_0","-","kM",";","return","_1_0","-","(","ks","+","ko","*","(","_1_0","-","kK",")",")","*","(","_1_0","-","kL",")",";","}","float","kP","(","float","kK",",","float","kL",",","float","ko",",","float","kM",")","{","float","ks","=","_1_0","-","kM",";","return","mix","(","kL","*","(","ks","+","2.0","*","ko","*","kK",")",",","_1_0","-","(","ks","+","2.0","*","ko","*","(","_1_0","-","kK",")",")","*","(","_1_0","-","kL",")",",","step","(","0.5",",","kL",")",")",";","}"]}]}}]}]},e["include/caustics.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"CAUSTICS_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"CAUSTICS_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"SUN_NUM",TOKENS:["0"]},{TYPE:"var",NAME:"CAUST_SCALE",TOKENS:["0.25"]},{TYPE:"var",NAME:"CAUST_SPEED",TOKENS:["vec2","(","0.0",")"]},{TYPE:"var",NAME:"CAUST_BRIGHT",TOKENS:["0.5"]},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"CAUSTICS_VIEW_DISTANCE",TOKENS:["100.0"]},{TYPE:"txt",TOKENS:["void","bV","(","inout","vec3","aQ",",","float","kQ",",","float","fy",",","vec4","bU",",","vec3","U",",","vec3","kR",",","vec3","kS",",","vec4","kT",",","vec3","bt",",","float","bS",")","{","if","(","bS",">","CAUSTICS_VIEW_DISTANCE",")","return",";","vec3","kU","=","bt","+","U",";","kU",".","xz","=","10.0","*","sin","(","0.1","*","kU",".","xz",")",";","vec3","kW","=","T","(","kV","(","kT",")",",","kU",")",";","vec2","ce","=","kW",".","xz",";","vec3","kX","=","kR",";","float","kY","=","max","(","dot","(","U",",","kX",")",",","0.0",")",";","float","kZ","=","0.025",";","vec2","k_","=","CAUST_SPEED","*","fy",";","ce",".","s","+=","0.25","*","sin","(","dot","(","bt","+","fy",",","vec3","(","1.0",")",")",")",";","ce",".","t","+=","0.35","*","(","-","sin","(","dot","(","bt","-","fy",",","vec3","(","-","0.7",")",")",")",")",";","ce",".","st","+=","0.15","*","cos","(","4.0","*","kQ","-","k_",".","x",")","+","1.5","*","sin","(","kQ","-","0.3","*","k_",".","y",")",";","float","hK","=","CAUST_SCALE","*","(","1.0","+","max","(","0.1","*","kQ",",","0.0",")",")",";","vec3","lb","=","la","(","(","ce","/","hK",")",",","kZ",")",";","lb","*=","CAUST_BRIGHT",";","lb","*=","lb",";","float","lc","=","min","(","0.25","*","kQ",",","-","kQ",")","+","1.0",";","lc","=","max","(","lc",",","0.0",")",";","float","ld","=","bU","[","SUN_NUM","]","*","kY",";","float","le","=","max","(","sign","(","kQ",")",",","0.0",")",";","ld","=","ld","+","max","(","0.5","*","sign","(","-","U",".","y",")","*","le",",","0.0",")",";","ld","=","min","(","ld",",","1.0",")",";","aQ","+=","kS","*","lb","*","lc","*","ld",";","}"]}]}}]}]},e["include/color_util.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"COLOR_UTIL_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"COLOR_UTIL_GLSLF",TOKENS:[""]},{TYPE:"define",NAME:"PREMULTIPLY_ALPHA",TOKENS:["1"]},{TYPE:"var",NAME:"SRGB",TOKENS:["SRGB_NONE"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["void","bG","(","inout","float","aQ",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","pow","(","aQ",",","2.2",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","aQ","<","0.04045",")","aQ","=","aQ","/","12.92",";","else","aQ","=","pow","(","aQ","*","(","1.0","/","1.055",")","+","0.0521327",",","2.4",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","aW","(","inout","float","aQ",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","pow","(","aQ",",","1.0","/","2.2",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","aQ","<","0.0031308",")","aQ","=","aQ","*","12.92",";","else","aQ","=","1.055","*","pow","(","aQ",",","1.0","/","2.4",")","-","0.055",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","bG","(","inout","vec3","aQ",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","pow","(","aQ",",","vec3","(","2.2",")",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["bG","(","aQ",".","r",")",";","bG","(","aQ",".","g",")",";","bG","(","aQ",".","b",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","aW","(","inout","vec3","aQ",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SRGB","SRGB_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","pow","(","aQ",",","vec3","(","1.0","/","2.2",")",")",";"]}]}},{TYPE:"elif",EXPRESSION:["SRGB","SRGB_PROPER",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aW","(","aQ",".","r",")",";","aW","(","aQ",".","g",")",";","aW","(","aQ",".","b",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","void","aX","(","inout","vec3","aQ",",","in","float","L",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PREMULTIPLY_ALPHA"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aQ","=","aQ","*","L",";"]}]}}]},{TYPE:"txt",TOKENS:["}","float","gj","(","vec4","aQ",")","{","vec3","lf","=","vec3","(","0.299",",","0.587",",","0.114",")",";","float","lg","=","dot","(","aQ",".","rgb",",","lf",")",";","return","lg",";","}"]}]}}]}]},e["include/coverage.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"COVERAGE_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"COVERAGE_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"procedural.glslf"},{TYPE:"txt",TOKENS:["const","float","lh","=","1000.0",";","bool","C","(","float","L",",","float","li",")","{","if","(","li","<","0.0",")","L","=","1.0","-","L",";","float","lj","=","floor","(","L","*","lh",")",";","float","ll","=","floor","(","lk","(","gl_FragCoord",".","xy",")","*","lh",")",";","if","(","li",">","0.0",")","return","ll","<","lj",";","else","return","ll",">=","lj",";","}"]}]}}]}]},e["include/depth_fetch.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"DEPTH_FETCH_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"DEPTH_FETCH_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_CASTING",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","es","(","in","float","lm",",","in","vec2","ln",")","{","float","dG","=","ln",".","x",";","float","lo","=","ln",".","y",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CAMERA_TYPE","CAM_TYPE_PERSP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","lo","*","(","1.0","-","dG","/","lm",")","/","(","lo","-","dG",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","(","lm","-","dG",")","/","(","lo","-","dG",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","gC","(","in","sampler2D","lp",",","in","vec2","f_",",","in","vec2","ln",")","{","float","et","=","GLSL_TEXTURE","(","lp",",","f_",")",".","r",";","float","dG","=","ln",".","x",";","float","lo","=","ln",".","y",";","float","lm","=","2.0","*","dG","/","(","dG","+","lo","-","(","2.0","*","et","-","1.0",")","*","(","lo","-","dG",")",")",";","return","lm",";","}"]}]}}]}]}}]}]},e["include/dynamic_grass.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"DYNAMIC_GRASS_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"DYNAMIC_GRASS_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"DYNAMIC_GRASS",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"GRASS_TEXTURE_SIZE",TOKENS:["1024.0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DYNAMIC_GRASS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"},{TYPE:"include",FILE:"to_world.glslv"},{TYPE:"txt",TOKENS:["vec2","lt","(","vec3","O",",","float","lq",",","vec2","lr",")","{","vec2","ls","=","vec2","(","(","O",".","x","-","lr",".","x",")","/","lq",",","(","O",".","y","-","lr",".","y",")","/","lq",")",";","return","fract","(","ls",")",";","}","vec2","lu","(","vec2","gX",",","float","lq",",","vec2","lr",")","{","return","vec2","(","gX",".","x","*","lq",",","gX",".","y","*","lq",")","+","lr",";","}","au","lv","(",")","{","return","au","(","vec3","(","-","10000.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",",","vec3","(","0.0",")",")",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","lF","(","sampler2D","lw",",","vec2","lx",")","{","float","ly","=","1.0","/","GRASS_TEXTURE_SIZE",";","vec4","lz","=","GLSL_TEXTURE","(","lw",",","lx",")",";","vec4","lA","=","GLSL_TEXTURE","(","lw",",","lx","+","vec2","(","ly",",","0.0",")",")",";","vec4","lB","=","GLSL_TEXTURE","(","lw",",","lx","+","vec2","(","0.0",",","ly",")",")",";","vec4","lC","=","GLSL_TEXTURE","(","lw",",","lx","+","vec2","(","ly",",","ly",")",")",";","float","a","=","fract","(","lx",".","x","*","GRASS_TEXTURE_SIZE",")",";","vec4","lD","=","mix","(","lz",",","lA",",","a",")",";","vec4","lE","=","mix","(","lB",",","lC",",","a",")",";","float","b","=","fract","(","lx",".","y","*","GRASS_TEXTURE_SIZE",")",";","return","mix","(","lD",",","lE",",","b",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["au","be","(","vec3","O",",","vec3","V",",","vec3","lG",",","vec3","W",",","vec3","U",",","vec3","ao",",","PRECISION","sampler2D","lH",",","sampler2D","lI",",","vec3","lJ",",","float","lK",",","vec3","lL",",","vec4","lM",",","mat3","N",",","mat3","Z",")","{","vec3","lN","=","T","(","lM",",","vec3","(","0.0",",","0.0",",","-","1.0",")",")",";","float","lO","=","-","lN",".","x",";","float","lP","=","lN",".","y",";","vec2","lr","=","vec2","(","lL",".","x","-","lK","*","(","1.0","+","lO",")","/","2.0",",","lL",".","y","-","lK","*","(","1.0","-","lP",")","/","2.0",")",";","vec2","lQ","=","lt","(","ao",",","lK",",","lr",")",";","float","lR","=","lK","/","2.0",";","vec2","lS","=","abs","(","lu","(","lQ","-","vec2","(","0.5",")",",","lK",",","vec2","(","0.0",")",")",")",";","float","lT","=","lR","*","(","1.0","+","sqrt","(","2.0",")",")","/","2.0",";","if","(","length","(","lS",")",">","lT",")","return","lv","(",")",";","float","lU","=","lK","/","lJ",".","z",";","vec2","lV","=","(","lQ","-","vec2","(","0.5",")",")","*","lU","+","vec2","(","0.5",")",";","vec3","lW","=","lN","*","(","lK","/","lJ",".","z","-","1.0",")","/","2.0",";","lV",".","x","+=","lW",".","x",";","lV",".","y","+=","lW",".","y",";","vec4","lX","=","GLSL_TEXTURE","(","lI",",","lV",")",";","float","hK","=","lX",".","r",";","if","(","hK","<","u_scale_threshold",")","return","lv","(",")",";","float","lY","=","lJ",".","y","-","lJ",".","x",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","cn","=","lJ",".","y","-","(","lF","(","lH",",","lV",")",")",".","r","*","lY",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","cn","=","lJ",".","y","-","(","GLSL_TEXTURE","(","lH",",","lV",")",")",".","r","*","lY",";"]}]}}]},{TYPE:"txt",TOKENS:["vec2","lZ","=","O",".","xy","-","ao",".","xy",";","ao",".","xy","=","lu","(","lQ",",","lK",",","lr",")",";","ao",".","z","=","cn",";","O",".","xy","=","ao",".","xy","+","lZ",";","O",".","z","*=","hK",";","O",".","z","+=","cn",";","vec3","aQ","=","lX",".","gba",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","-=","ao",";","mat3","l_","=","as","(","lL",",","ao",",","N",",","Z",")",";","au","aw","=","av","(","O",",","ao",",","V",",","lG",",","W",",","U",",","l_",")",";","aw",".","ao","=","ao",";","aw",".","aQ","=","aQ",";","return","ma","(","aw",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","ma","(","au","(","O",",","ao",",","V",",","lG",",","W",",","U",",","aQ",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]},e["include/environment.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"ENVIRONMENT_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"ENVIRONMENT_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"USE_ENVIRONMENT_LIGHT",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_COLOR",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_TEXTURE",TOKENS:["0"]},{TYPE:"txt",TOKENS:["vec3","cE","(","vec3","U",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_ENVIRONMENT_LIGHT"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_TEXTURE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","GLSL_TEXTURE_CUBE","(","u_sky_texture",",","U",")",".","rgb",";"]}]}},{TYPE:"elif",EXPRESSION:["SKY_COLOR"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","mb","=","0.5","*","U",".","z","+","0.5",";","return","mix","(","u_horizon_color",",","u_zenith_color",",","mb",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","vec3","(","1.0",")",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","vec3","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/fog.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FOG_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FOG_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"USE_FOG",TOKENS:["0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"FOG_TYPE",TOKENS:["QUADRATIC"]},{TYPE:"var",NAME:"PROCEDURAL_FOG",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","mg","(","inout","vec3","aQ",",","in","float","mc",",","in","float","cn",",","in","vec4","md",")","{","float","me","=","clamp","(","(","mc","-","u_fog_params",".","z",")","/","u_fog_params",".","y",",","0.0",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FOG_TYPE","QUADRATIC",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["me","*=","me",";"]}]}},{TYPE:"elif",EXPRESSION:["FOG_TYPE","LINEAR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[]}},{TYPE:"elif",EXPRESSION:["FOG_TYPE","INVERSE_QUADRATIC",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["me","=","sqrt","(","me",")",";"]}]}}]},{TYPE:"txt",TOKENS:["if","(","u_fog_params",".","w",">","0.0",")","{","if","(","cn",">","u_fog_params",".","w",")","me","=","0.0",";","else","{","float","mf","=","(","u_fog_params",".","w","-","max","(","cn",",","0.0",")",")","/","u_fog_params",".","w",";","me","*=","mf","*","mf",";","}","}","md",".","a","=","1.0","-","(","1.0","-","me",")","*","(","1.0","-","u_fog_params",".","x",")",";","aQ","=","mix","(","aQ",",","md",".","rgb",",","md",".","a",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ml","(","in","mat4","mh",",","in","vec3","D",")","{","vec3","mi","=","mix","(","mh","[","0","]",".","rgb",",","mh","[","1","]",".","rgb",",","(","D",".","x","+","1.0",")","/","2.0",")",";","vec3","mj","=","mix","(","mh","[","2","]",".","rgb",",","mh","[","3","]",".","rgb",",","(","D",".","y","+","1.0",")","/","2.0",")",";","vec3","mk","=","vec3","(","mh","[","0","]",".","a",",","mh","[","1","]",".","a",",","mh","[","2","]",".","a",")",";","vec3","aQ","=","mix","(","mi",",","mj",",","abs","(","D",".","y",")",")",";","aQ","=","mix","(","aQ",",","mk",",","abs","(","D",".","z",")",")",";","bG","(","aQ",")",";","return","aQ",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","mn","(","inout","float","mm",")","{","mm","-=","0.5",";","mm","=","4.0","*","(","mm","*","mm","*","mm",")","+","0.5",";","}","void","mt","(","inout","vec3","aQ",",","in","float","mc",",","in","vec3","D",",","in","float","eG",",","in","vec4","mo",",","in","float","fp",")","{","float","mp","=","max","(","D",".","z",",","0.0",")",";","float","mq","=","max","(","mc","-","max","(","eG","/","mp",",","0.0",")",",","0.0",")",";","float","mr","=","mo",".","w","*","mq",";","vec3","eH","=","vec3","(","0.0",",","0.02",",","0.05",")",";","vec3","ms","=","mo",".","rgb",";","mr","=","min","(","mr",",","1.0",")",";","mn","(","mr",")",";","mr","*=","clamp","(","2.0","-","fp",",","0.0",",","1.0",")",";","vec3","eI","=","mix","(","ms",",","eH",",","min","(","mp",",","1.0",")",")",";","eG","=","clamp","(","-","eG","*","0.03",",","0.0",",","0.8",")",";","eI","*=","1.0","-","eG",";","aQ","=","mix","(","aQ",",","eI",",","mr",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","bW","(","inout","vec3","aQ",",","float","mc",",","vec3","D",",","float","bT",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["PROCEDURAL_FOG"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","mh","=","ml","(","u_cube_fog",",","D",")",";","vec4","eI","=","vec4","(","mh",",","u_fog_color_density",".","a",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","eI","=","u_fog_color_density",";"]}]}}]},{TYPE:"txt",TOKENS:["mg","(","aQ",",","mc",",","h",".","z",",","eI",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mt","(","aQ",",","mc",",","D",",","u_cam_water_depth",",","u_underwater_fog_color_density",",","bT",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/fxaa.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"FXAA_BLEND4WEB",TOKENS:["1"]},{TYPE:"var",NAME:"FXAA_QUALITY_P12",TOKENS:["0.0"]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_PS3",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_PS3",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_360",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_360",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_360_OPT",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_360_OPT",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_PC",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_PC",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_PC_CONSOLE",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_PC_CONSOLE",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GLSL_120",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GLSL_120",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GLSL_130",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GLSL_130",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_HLSL_3",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_HLSL_3",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_HLSL_4",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_HLSL_4",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_HLSL_5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_HLSL_5",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GREEN_AS_LUMA",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GREEN_AS_LUMA",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_EARLY_EXIT",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_EARLY_EXIT",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_DISCARD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_DISCARD",TOKENS:["0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_FAST_PIXEL_OFFSET",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_EXT_gpu_shader4",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_NV_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_ARB_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_FAST_PIXEL_OFFSET",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_FAST_PIXEL_OFFSET",TOKENS:["0"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GATHER4_ALPHA",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_HLSL_5",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_ARB_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifdef",NAME:"GL_NV_gpu_shader5",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["1"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_GATHER4_ALPHA",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_GATHER4_ALPHA",TOKENS:["0"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[1],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[0],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",TOKENS:["4.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[0],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",TOKENS:["2.0"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[1],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",TOKENS:["0.125"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",TOKENS:["0.25"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"FXAA_QUALITY_PRESET",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PRESET",TOKENS:["12"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",10,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["3"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["3.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",11,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["4"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["3.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",12,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",13,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["6"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",14,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["7"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",15,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["8"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["12.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",20,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["3"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",21,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["4"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",22,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",23,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["6"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",24,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["7"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["3.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",25,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["8"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",26,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["9"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",27,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["10"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",28,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["11"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P10",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",29,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["12"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P10",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P11",TOKENS:["8.0"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PRESET",39,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"FXAA_QUALITY_PS",TOKENS:["12"]},{TYPE:"define",NAME:"FXAA_QUALITY_P0",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P1",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P2",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P3",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P4",TOKENS:["1.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P5",TOKENS:["1.5"]},{TYPE:"define",NAME:"FXAA_QUALITY_P6",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P7",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P8",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P9",TOKENS:["2.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P10",TOKENS:["4.0"]},{TYPE:"define",NAME:"FXAA_QUALITY_P11",TOKENS:["8.0"]}]}}]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"txt",TOKENS:["float","mu","(","float","x",")","{","return","clamp","(","x",",","0.0",",","1.0",")",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_BLEND4WEB",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","mv","(","sampler2D","t",",","vec2","p",")","{","return","GLSL_TEXTURE","(","t",",","p",")",";","}","vec4","mx","(","sampler2D","t",",","vec2","p",",","vec2","mw",",","vec2","r",")","{","return","GLSL_TEXTURE","(","t",",","p","+","(","mw","*","r",")",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["vec4","gz","(","vec2","fr",",","sampler2D","ie",",","vec2","my",",","float","mz",",","float","mA",",","float","mB",")","{","vec2","mC",";","mC",".","x","=","fr",".","x",";","mC",".","y","=","fr",".","y",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_GATHER4_ALPHA",1,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","mD","=","mv","(","ie",",","mC",")",";","float","gk","=","gj","(","mD",")",";","float","mE","=","gj","(","mx","(","ie",",","mC",",","vec2","(","0",",","1",")",",","my",".","xy",")",")",";","float","mF","=","gj","(","mx","(","ie",",","mC",",","vec2","(","1",",","0",")",",","my",".","xy",")",")",";","float","mG","=","gj","(","mx","(","ie",",","mC",",","vec2","(","0",",","-","1",")",",","my",".","xy",")",")",";","float","mH","=","gj","(","mx","(","ie",",","mC",",","vec2","(","-","1",",","0",")",",","my",".","xy",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","mI","=","max","(","mE",",","gk",")",";","float","mJ","=","min","(","mE",",","gk",")",";","float","mK","=","max","(","mF",",","mI",")",";","float","mL","=","min","(","mF",",","mJ",")",";","float","mM","=","max","(","mG",",","mH",")",";","float","mN","=","min","(","mG",",","mH",")",";","float","mO","=","max","(","mM",",","mK",")",";","float","mP","=","min","(","mN",",","mL",")",";","float","mQ","=","mO","*","mA",";","float","mR","=","mO","-","mP",";","float","mS","=","max","(","mB",",","mQ",")",";","bool","mT","=","mR","<","mS",";","if","(","mT",")","return","mD",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_GATHER4_ALPHA",0,{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","gl","=","gj","(","mx","(","ie",",","mC",",","vec2","(","-","1",",","-","1",")",",","my",".","xy",")",")",";","float","go","=","gj","(","mx","(","ie",",","mC",",","vec2","(","1",",","1",")",",","my",".","xy",")",")",";","float","gm","=","gj","(","mx","(","ie",",","mC",",","vec2","(","1",",","-","1",")",",","my",".","xy",")",")",";","float","gn","=","gj","(","mx","(","ie",",","mC",",","vec2","(","-","1",",","1",")",",","my",".","xy",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[]}}]},{TYPE:"txt",TOKENS:["float","mU","=","mG","+","mE",";","float","mV","=","mH","+","mF",";","float","mW","=","1.0","/","mR",";","float","mX","=","mU","+","mV",";","float","mY","=","(","-","2.0","*","gk",")","+","mU",";","float","mZ","=","(","-","2.0","*","gk",")","+","mV",";","float","m_","=","gm","+","go",";","float","na","=","gl","+","gm",";","float","nb","=","(","-","2.0","*","mF",")","+","m_",";","float","nc","=","(","-","2.0","*","mG",")","+","na",";","float","nd","=","gl","+","gn",";","float","ne","=","gn","+","go",";","float","nf","=","(","abs","(","mY",")","*","2.0",")","+","abs","(","nb",")",";","float","ng","=","(","abs","(","mZ",")","*","2.0",")","+","abs","(","nc",")",";","float","nh","=","(","-","2.0","*","mH",")","+","nd",";","float","ni","=","(","-","2.0","*","mE",")","+","ne",";","float","nj","=","abs","(","nh",")","+","nf",";","float","nk","=","abs","(","ni",")","+","ng",";","float","nl","=","nd","+","m_",";","float","nm","=","my",".","x",";","bool","nn","=","nj",">=","nk",";","float","no","=","mX","*","2.0","+","nl",";","if","(","!","nn",")","mG","=","mH",";","if","(","!","nn",")","mE","=","mF",";","if","(","nn",")","nm","=","my",".","y",";","float","np","=","(","no","*","(","1.0","/","12.0",")",")","-","gk",";","float","nq","=","mG","-","gk",";","float","nr","=","mE","-","gk",";","float","ns","=","mG","+","gk",";","float","nt","=","mE","+","gk",";","bool","nu","=","abs","(","nq",")",">=","abs","(","nr",")",";","float","nv","=","max","(","abs","(","nq",")",",","abs","(","nr",")",")",";","if","(","nu",")","nm","=","-","nm",";","float","nw","=","mu","(","abs","(","np",")","*","mW",")",";","vec2","nx",";","nx",".","x","=","mC",".","x",";","nx",".","y","=","mC",".","y",";","vec2","ny",";","ny",".","x","=","(","!","nn",")","?","0.0",":","my",".","x",";","ny",".","y","=","(","nn",")","?","0.0",":","my",".","y",";","if","(","!","nn",")","nx",".","x","+=","nm","*","0.5",";","if","(","nn",")","nx",".","y","+=","nm","*","0.5",";","vec2","nz",";","nz",".","x","=","nx",".","x","-","ny",".","x","*","FXAA_QUALITY_P0",";","nz",".","y","=","nx",".","y","-","ny",".","y","*","FXAA_QUALITY_P0",";","vec2","nA",";","nA",".","x","=","nx",".","x","+","ny",".","x","*","FXAA_QUALITY_P0",";","nA",".","y","=","nx",".","y","+","ny",".","y","*","FXAA_QUALITY_P0",";","float","nB","=","(","(","-","2.0",")","*","nw",")","+","3.0",";","float","nC","=","gj","(","mv","(","ie",",","nz",")",")",";","float","nD","=","nw","*","nw",";","float","nE","=","gj","(","mv","(","ie",",","nA",")",")",";","if","(","!","nu",")","ns","=","nt",";","float","nF","=","nv","*","1.0","/","4.0",";","float","nG","=","gk","-","ns","*","0.5",";","float","nH","=","nB","*","nD",";","bool","nI","=","nG","<","0.0",";","nC","-=","ns","*","0.5",";","nE","-=","ns","*","0.5",";","bool","nJ","=","abs","(","nC",")",">=","nF",";","bool","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P1",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P1",";","bool","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P1",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P1",";","if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P2",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P2",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P2",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P2",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P3",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P3",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P3",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P3",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",4,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P4",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P4",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P4",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P4",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",5,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P5",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P5",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P5",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P5",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",6,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P6",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P6",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P6",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P6",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",7,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P7",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P7",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P7",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P7",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",8,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P8",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P8",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P8",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P8",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",9,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P9",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P9",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P9",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P9",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",10,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P10",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P10",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P10",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P10",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",11,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P11",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P11",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P11",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P11",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_QUALITY_PS",12,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","nL",")","{","if","(","!","nJ",")","nC","=","gj","(","mv","(","ie",",","nz",".","xy",")",")",";","if","(","!","nK",")","nE","=","gj","(","mv","(","ie",",","nA",".","xy",")",")",";","if","(","!","nJ",")","nC","=","nC","-","ns","*","0.5",";","if","(","!","nK",")","nE","=","nE","-","ns","*","0.5",";","nJ","=","abs","(","nC",")",">=","nF",";","nK","=","abs","(","nE",")",">=","nF",";","if","(","!","nJ",")","nz",".","x","-=","ny",".","x","*","FXAA_QUALITY_P12",";","if","(","!","nJ",")","nz",".","y","-=","ny",".","y","*","FXAA_QUALITY_P12",";","nL","=","(","!","nJ",")","||","(","!","nK",")",";","if","(","!","nK",")","nA",".","x","+=","ny",".","x","*","FXAA_QUALITY_P12",";","if","(","!","nK",")","nA",".","y","+=","ny",".","y","*","FXAA_QUALITY_P12",";","}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}","float","nM","=","mC",".","x","-","nz",".","x",";","float","nN","=","nA",".","x","-","mC",".","x",";","if","(","!","nn",")","nM","=","mC",".","y","-","nz",".","y",";","if","(","!","nn",")","nN","=","nA",".","y","-","mC",".","y",";","bool","nO","=","(","nC","<","0.0",")","!=","nI",";","float","nP","=","(","nN","+","nM",")",";","bool","nQ","=","(","nE","<","0.0",")","!=","nI",";","float","nR","=","1.0","/","nP",";","bool","nS","=","nM","<","nN",";","float","nT","=","min","(","nM",",","nN",")",";","bool","nU","=","nS","?","nO",":","nQ",";","float","nV","=","nH","*","nH",";","float","nW","=","(","nT","*","(","-","nR",")",")","+","0.5",";","float","nX","=","nV","*","mz",";","float","nY","=","nU","?","nW",":","0.0",";","float","nZ","=","max","(","nY",",","nX",")",";","if","(","!","nn",")","mC",".","x","+=","nZ","*","nm",";","if","(","nn",")","mC",".","y","+=","nZ","*","nm",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FXAA_DISCARD",1,{TYPE:"equal_expr",PLACES:2},"FXAA_BLEND4WEB",1,{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","mv","(","ie",",","mC",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","vec4","(","mv","(","ie",",","mC",")",".","xyz",",","gk",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/halo_color.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"HALO_COLOR_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"HALO_COLOR_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"NUM_RINGS",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LINES",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"SKY_STARS",TOKENS:["0"]},{TYPE:"var",NAME:"WAVES_HEIGHT",TOKENS:["1.0"]},{TYPE:"var",NAME:"WATER_EFFECTS",TOKENS:["0"]},{TYPE:"var",NAME:"DISABLE_FOG",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS","NUM_LINES",{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","int","n_","=","NUM_RINGS",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","int","n_","=","NUM_LINES",";"]}]}}]},{TYPE:"txt",TOKENS:["float","oa","(","float","x",")","{","return","x","-","floor","(","x","*","(","1.0","/","0.01",")",")","*","0.01",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","oh","(","inout","float","ob",",","in","float","oc","[","n_","]",",","in","float","od",")","{","for","(","int","a","=","0",";","a","<","NUM_RINGS",";","a","++",")","{","float","oe","=","40.0","*","oc","[","a","]",";","float","of","=","300.0","*","(","oa","(","oe",")","-","0.005",")",";","float","og","=","oe",";","float","me","=","abs","(","og","*","(","u_halo_size","*","of","-","od",")",")",";","ob","+=","1.0","-","min","(","me",",","1.0",")",";","}","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LINES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","om","(","inout","float","oi",",","in","float","oc","[","n_","]",",","in","float","aM",")","{","for","(","int","a","=","0",";","a","<","NUM_LINES",";","a","++",")","{","float","oj","=","oc","[","a","]",";","float","ok","=","oj",";","float","ol","=","1000.0","*","(","oa","(","oj",")","-","0.005",")",";","float","me","=","20.0","*","abs","(","ok","*","A",".","x","+","ol","*","A",".","y",")",";","oi","+=","1.0","-","min","(","me",",","1.0",")",";","}","oi","*=","aM",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","oq","(","inout","float","aM",",","in","vec2","ce",")","{","float","on",",","bP",";","bP","=","atan","(","ce",".","y",",","ce",".","x",")",";","bP","*=","(","1.0","+","0.25","*","float","(","NUM_STARS",")",")",";","float","oo","=","cos","(","bP",")",";","float","op","=","sin","(","bP",")",";","bP","=","(","oo","*","ce",".","x","+","op","*","ce",".","y",")","*","(","oo","*","ce",".","y","-","op","*","ce",".","x",")",";","on","=","abs","(","bP",")",";","if","(","on","<","1.0",")","{","on","=","(","0.01","*","u_halo_size",")","/","(","on",")",";","aM","*=","sqrt","(","min","(","on",",","1.0",")",")",";","}","}","vec4","bl","(",")","{","float","aM","=","(","A",".","x","*","A",".","x","+","A",".","y","*","A",".","y",")",";","float","od","=","sqrt","(","aM",")",";","aM","=","max","(","1.0","-","aM",",","0.0",")",";","aM","=","pow","(","aM",",","u_halo_hardness",")",";","float","L","=","u_diffuse_color",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS","NUM_LINES",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","oc","[","n_","]",";","for","(","int","cq","=","0",";","cq","<","n_",";","cq","++",")","{","oc","[","cq","]","=","fract","(","bk","/","float","(","cq","+","1",")",")","-","1.0",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","ob","=","0.0",";","oh","(","ob",",","oc",",","od",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LINES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","oi","=","0.0",";","om","(","oi",",","oc",",","aM",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["oq","(","aM",",","A",")",";"]}]}}]},{TYPE:"txt",TOKENS:["aM","*=","L",";","vec3","aQ","=","u_diffuse_color",".","rgb",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_RINGS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["ob","*=","aM",";","aQ","+=","u_halo_rings_color","*","ob",";","aM","+=","ob",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_LINES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["oi","*=","L",";","aQ","+=","u_halo_lines_color","*","oi",";","aM","+=","oi",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKY_STARS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["aM","*=","max","(","1.0","-","2.0","*","u_sun_intensity",".","x",",","0.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WATER_EFFECTS","DISABLE_FOG",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","lc","=","u_halo_stars_blend","*","(","bj",".","y","-","u_halo_stars_height",")",";","aM","*=","clamp","(","lc",",","0.0",",","1.0",")",";","aM","*=","min","(","u_cam_water_depth","+","2.0","*","WAVES_HEIGHT",",","1.0",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec4","or","=","vec4","(","aQ",",","aM",")",";","return","or",";","}"]}]}}]}]},e["include/lighting_nodes.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"LIGHTING_NODES_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"LIGHTING_NODES_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"node",NAME:"LIGHTING_BEGIN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"oF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oI",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oJ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oK",QUALIFIER:["vec2"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oL",QUALIFIER:["vec2"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oM",QUALIFIER:["vec4"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oN",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"oO",QUALIFIER:["vec4"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["oF","=","os",";","oG","=","ot",";","oH","=","ou",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oI"],STATEMENTS:[{TYPE:"txt",TOKENS:["oI","=","ov",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oJ"],STATEMENTS:[{TYPE:"txt",TOKENS:["oJ","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oL"],STATEMENTS:[{TYPE:"txt",TOKENS:["oL","=","oz",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oK"],STATEMENTS:[{TYPE:"txt",TOKENS:["oK","=","oA",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oM"],STATEMENTS:[{TYPE:"txt",TOKENS:["oM","=","oB",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oN"],STATEMENTS:[{TYPE:"txt",TOKENS:["oN","=","oC",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_oO"],STATEMENTS:[{TYPE:"txt",TOKENS:["oO","=","oD",";"]}]}]}]},{TYPE:"node",NAME:"LIGHTING_AMBIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"oP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oS",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oS","=","vec4","(","oP","+","oR","*","oQ",",","_0_0",")",";","oT","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LIGHTING_LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]},{TYPE:"node_var",NAME:"LAMP_SHADOW_MAP_IND",TOKENS:["-","1"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oW",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oW","=","vec2","(","u_light_positions","[","LAMP_IND","]",".","w",",","u_light_color_intensities","[","LAMP_IND","]",".","w",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","HEMI",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_5",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_0",";"]}]}]},{TYPE:"txt",TOKENS:["oX","=","u_light_color_intensities","[","LAMP_IND","]",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_SHADOW_MAP_IND",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oX","*=","oU","[","LAMP_SHADOW_MAP_IND","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","oZ","=","u_light_positions","[","LAMP_IND","]",".","xyz",";","oV","=","oZ","-","ow",";","float","aM","=","length","(","oV",")",";","float","o_","=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","aM","*","aM",")",";","oV","=","normalize","(","oV",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pa","=","u_light_directions","[","LAMP_IND","]",";","float","pb","=","dot","(","oV",",","pa",")",";","pb","*=","smoothstep","(","_0_0",",","_1_0",",","(","pb","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","o_","*=","pb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:["o_","*=","max","(","LAMP_LIGHT_DIST","-","aM",",","_0_0",")","/","LAMP_LIGHT_DIST",";"]}]}]},{TYPE:"txt",TOKENS:["oX","*=","o_",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oV","=","u_light_directions","[","LAMP_IND","]",";"]}]}]}]},{TYPE:"node",NAME:"DIFFUSE_FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pd",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pg",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ph",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pc",",","B",".","xyz",")",";","pe","=","cross","(","pi",",","B",".","xyz",")",";","pe","=","-","normalize","(","pe",")",";"]}]}]},{TYPE:"txt",TOKENS:["ph","=","_0_0",";","if","(","pd",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pf",")","*","dot","(","pe",",","pc",")","+","pf",";","if","(","pg","[","0","]","==","_0_0",")","{","ph","=","_1_0",";","}","else","{","float","t","=","_1_0","+","abs","(","pj",")",";","t","=","pg","[","1","]","+","(","_1_0","-","pg","[","1","]",")","*","pow","(","t",",","pg","[","0","]",")",";","ph","=","clamp","(","t",",","_0_0",",","_1_0",")",";","}","ph","=","max","(","ph",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_LAMBERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pl",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"po",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pk",",","B",".","xyz",")",";","pm","=","cross","(","pi",",","B",".","xyz",")",";","pm","=","-","normalize","(","pm",")",";"]}]}]},{TYPE:"txt",TOKENS:["po","=","_0_0",";","if","(","pl",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pn",")","*","dot","(","pm",",","pk",")","+","pn",";","po","=","max","(","pj",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_OREN_NAYAR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pu",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"px",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"py",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pr",",","B",".","xyz",")",";","pv","=","cross","(","pi",",","B",".","xyz",")",";","pv","=","-","normalize","(","pv",")",";"]}]}]},{TYPE:"txt",TOKENS:["py","=","_0_0",";","if","(","pu",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pw",")","*","dot","(","pv",",","pr",")","+","pw",";","if","(","px","[","0","]",">","_0_0",")","{","float","pz","=","max","(","dot","(","pv",",","oy",")",",","_0_0",")",";","float","pA","=","px","[","0","]","*","px","[","0","]",";","float","cG","=","_1_0","-","_0_5","*","(","pA","/","(","pA","+","0.33",")",")",";","vec3","pB","=","pr","-","pj","*","pv",";","vec3","pC","=","oy","-","pz","*","pv",";","if","(","length","(","pB",")","==","_0_0","||","length","(","pC",")","==","_0_0","||","abs","(","pj",")",">","_1_0","||","abs","(","pz",")",">","_1_0",")","py","=","pj","*","cG",";","else","{","float","pD","=","acos","(","pj",")",";","float","pE","=","acos","(","pz",")",";","vec3","pF","=","normalize","(","pB",")",";","vec3","pG","=","normalize","(","pC",")",";","float","a",",","b",";","a","=","max","(","pD",",","pE",")",";","b","=","min","(","pD",",","pE",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pF",",","pG",")",",","_0_0",")",";","float","hS","=","0.45","*","(","pA","/","(","pA","+","0.09",")",")",";","py","=","pj","*","(","cG","+","(","hS","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","else","py","=","pj",";","py","=","max","(","py",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_MINNAERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pI",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pL",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pH",",","B",".","xyz",")",";","pJ","=","cross","(","pi",",","B",".","xyz",")",";","pJ","=","-","normalize","(","pJ",")",";"]}]}]},{TYPE:"txt",TOKENS:["pM","=","_0_0",";","if","(","pI",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pK",")","*","dot","(","pJ",",","pH",")","+","pK",";","float","pz","=","max","(","dot","(","pJ",",","oy",")",",","_0_0",")",";","if","(","pL","[","0","]","<=","_1_0",")","pM","=","pj","*","pow","(","max","(","pz","*","pj",",","0.1",")",",","pL","[","0","]","-","_1_0",")",";","else","pM","=","pj","*","pow","(","1.0001","-","pz",",","pL","[","0","]","-","_1_0",")",";","pM","=","max","(","pM",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pO",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pR",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pN",",","B",".","xyz",")",";","pP","=","cross","(","pi",",","B",".","xyz",")",";","pP","=","-","normalize","(","pP",")",";"]}]}]},{TYPE:"txt",TOKENS:["pS","=","_0_0",";","if","(","pO",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pQ",")","*","dot","(","pP",",","pN",")","+","pQ",";","float","pT","=","acos","(","pj",")",";","if","(","pT","<","pR","[","0","]",")","pS","=","_1_0",";","else","if","(","pT",">","(","pR","[","0","]","+","pR","[","1","]",")","||","pR","[","1","]","==","_0_0",")","pS","=","_0_0",";","else","pS","=","_1_0","-","(","(","pT","-","pR","[","0","]",")","/","pR","[","1","]",")",";","pS","=","max","(","pS",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_PHONG",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pV",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pY",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pZ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["pZ","=","_0_0",";","if","(","pV",".","g","!=","_0_0",")","{","vec3","p_","=","normalize","(","pU","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","pX","==","_0_0",")","{","pZ","=","dot","(","B",".","xyz",",","p_",")",";","pZ","=","sqrt","(","_1_0","-","pZ","*","pZ",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["pZ","=","(","_1_0","-","pX",")","*","max","(","dot","(","pW",",","p_",")",",","_0_0",")","+","pX",";"]}]}]},{TYPE:"txt",TOKENS:["pZ","=","pow","(","pZ",",","pY","[","0","]",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_COOKTORR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qb",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qe",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qf",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qf","=","_0_0",";","if","(","qb",".","g","!=","_0_0",")","{","vec3","p_","=","normalize","(","qa","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","qd","==","_0_0",")","{","qf","=","dot","(","B",".","xyz",",","p_",")",";","qf","=","sqrt","(","_1_0","-","qf","*","qf",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qf","=","max","(","dot","(","qc",",","p_",")",",","_0_0",")",";","qf","=","(","_1_0","-","qd",")","*","qf","+","qd",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","pz","=","max","(","dot","(","B",".","xyz",",","oy",")",",","_0_0",")",";","pz","=","sqrt","(","_1_0","-","pz","*","pz",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","pz","=","max","(","dot","(","qc",",","oy",")",",","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["qf","=","pow","(","qf",",","qe","[","0","]",")",";","qf","=","qf","/","(","0.1","+","pz",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_WARDISO",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qh",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qk",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ql",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ql","=","_0_0",";","if","(","qh",".","g","!=","_0_0",")","{","vec3","p_","=","normalize","(","qg","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","_0_0",";","float","pz","=","_0_0",";","float","qn","=","_0_0",";","if","(","qj","==","_0_0",")","{","qm","=","dot","(","B",".","xyz",",","p_",")",";","pz","=","dot","(","B",".","xyz",",","oy",")",";","qn","=","dot","(","B",".","xyz",",","qg",")",";","qm","=","sqrt","(","_1_0","-","qm","*","qm",")",";","pz","=","sqrt","(","_1_0","-","pz","*","pz",")",";","qn","=","sqrt","(","_1_0","-","qn","*","qn",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","max","(","dot","(","qi",",","p_",")",",","0.01",")",";","float","pz","=","max","(","dot","(","qi",",","oy",")",",","0.01",")",";","float","qn","=","max","(","dot","(","qi",",","qg",")",",","0.01",")",";"]}]}]},{TYPE:"txt",TOKENS:["float","bP","=","tan","(","acos","(","qm",")",")",";","float","L","=","max","(","qk","[","0","]",",","0.01",")",";","ql","=","qn","*","(","_1_0","/","(","4.0","*","M_PI","*","L","*","L",")",")","*","(","exp","(","-","(","bP","*","bP",")","/","(","L","*","L",")",")","/","(","sqrt","(","pz","*","qn",")",")",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qr",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qw",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qx",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qx","=","_0_0",";","if","(","qr",".","g","!=","_0_0",")","{","vec3","co","=","normalize","(","qo","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qy","=","dot","(","co",",","B",".","xyz",")",";","float","bP","=","qw","[","0","]","+","qw","[","1","]",";","if","(","qv","==","_0_0",")","bP","=","acos","(","sqrt","(","_1_0","-","qy","*","qy",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","bP","=","acos","(","dot","(","co",",","qu",")",")",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","bP","<","qw","[","0","]",")","qx","=","_1_0",";","else","if","(","bP",">=","qw","[","0","]","+","qw","[","1","]","||","qw","[","1","]","==","_0_0",")","qx","=","_0_0",";","else","qx","=","_1_0","-","(","bP","-","qw","[","0","]",")","/","qw","[","1","]",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_BLINN",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qA",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qD",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qF","=","qD","[","0","]",";","float","qG","=","qD","[","1","]",";","qE","=","_0_0",";","if","(","qA",".","g","!=","_0_0",")","{","if","(","qF","<","1.0","||","qG","==","_0_0",")","qE","=","_0_0",";","else","{","if","(","qG","<","100.0",")","qG","=","sqrt","(","1.0","/","qG",")",";","else","qG","=","10.0","/","qG",";","vec3","p_","=","normalize","(","oy","+","qz",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","0.0",";","if","(","qC","==","_0_0",")","{","float","qH","=","dot","(","B",".","xyz",",","p_",")",";","qm","=","sqrt","(","_1_0","-","qH","*","qH",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","(","_1_0","-","qC",")","*","max","(","dot","(","qB",",","p_",")",",","_0_0",")","+","qC",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","qm","<","_0_0",")","qE","=","_0_0",";","else","{","float","pz","=","max","(","dot","(","qB",",","oy",")",",","0.01",")",";","float","qn","=","dot","(","qB",",","qz",")",";","if","(","qn","<=","0.01",")","qE","=","_0_0",";","else","{","float","qI","=","max","(","dot","(","oy",",","p_",")",",","0.01",")",";","float","a","=","_1_0",";","float","b","=","(","2.0","*","qm","*","pz",")","/","qI",";","float","dx","=","(","2.0","*","qm","*","qn",")","/","qI",";","float","g","=","min","(","min","(","a",",","b",")",",","dx",")",";","float","p","=","sqrt","(","pow","(","qF",",","2.0",")","+","pow","(","qI",",","2.0",")","-","_1_0",")",";","float","mm","=","pow","(","p","-","qI",",","2.0",")","/","pow","(","p","+","qI",",","2.0",")","*","(","_1_0","+","pow","(","qI","*","(","p","+","qI",")","-","_1_0",",","2.0",")","/","pow","(","qI","*","(","p","-","qI",")","+","_1_0",",","2.0",")",")",";","float","pT","=","acos","(","qm",")",";","qE","=","max","(","mm","*","g","*","exp","(","-","pow","(","pT",",","2.0",")","/","(","2.0","*","pow","(","qG",",","2.0",")",")",")",",","_0_0",")",";","}","}","}","}"]}]},{TYPE:"node",NAME:"LIGHTING_APPLY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qJ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qP",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qV","=","qK","+","qS","*","qR","*","qM",";","qU","=","qJ","+","vec4","(","qS","*","qQ","*","qL",",","qM",")",";"]}]},{TYPE:"node",NAME:"LIGHTING_END",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qW",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","qW",".","rgb",";","oE","=","qX",";"]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","cP","(","vec3","os",",","vec3","ot",",","vec3","ou",",","vec3","ov",",","vec3","ow",",","vec3","ox",",","vec3","oy",",","vec2","oz",",","vec2","oA",",","vec4","oB",",","float","oC",",","vec4","oD",",","out","vec3","E",",","out","vec3","oE",")","{"]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/math.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"MATH_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"MATH_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"EPSILON",TOKENS:["0.000001"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"USE_POSITION_CLIP",TOKENS:["0"]},{TYPE:"var",NAME:"SOFT_PARTICLES",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"txt",TOKENS:["struct","au","{","vec3","O",";","vec3","ao",";","vec3","V",";","vec3","aB",";","vec3","W",";","vec3","U",";","vec3","aQ",";","}",";","bool","qY","(","vec3","a",",","vec3","b",")","{","return","any","(","lessThan","(","abs","(","a","-","b",")",",","vec3","(","EPSILON",")",")",")",";","}","vec3","T","(","in","vec4","q",",","in","vec3","kU",")","{","return","kU","+","2.0","*","cross","(","q",".","xyz",",","cross","(","q",".","xyz",",","kU",")","+","q",".","w","*","kU",")",";","}","vec4","kV","(","in","vec4","qZ",")","{","return","vec4","(","-","qZ",".","xyz",",","qZ",".","w",")",";","}","vec4","rc","(","in","vec4","a",",","in","vec4","b",")","{","vec4","q_",";","q_",".","x","=","a",".","x","*","b",".","w","+","a",".","w","*","b",".","x","+","a",".","y","*","b",".","z","-","a",".","z","*","b",".","y",";","q_",".","y","=","a",".","y","*","b",".","w","+","a",".","w","*","b",".","y","+","a",".","z","*","b",".","x","-","a",".","x","*","b",".","z",";","q_",".","z","=","a",".","z","*","b",".","w","+","a",".","w","*","b",".","z","+","a",".","x","*","b",".","y","-","a",".","y","*","b",".","x",";","q_",".","w","=","a",".","w","*","b",".","w","-","a",".","x","*","b",".","x","-","a",".","y","*","b",".","y","-","a",".","z","*","b",".","z",";","return","q_",";","}","vec4","X","(","in","vec3","rd",",","in","float","re",")","{","vec4","q_",";","re","=","re","*","0.5",";","float","s","=","sin","(","re",")",";","q_",".","x","=","s","*","rd","[","0","]",";","q_",".","y","=","s","*","rd","[","1","]",";","q_",".","z","=","s","*","rd","[","2","]",";","q_",".","w","=","cos","(","re",")",";","return","q_",";","}","vec4","ri","(","in","vec3","bH",",","in","vec3","rf",")","{","vec4","q_",";","float","dC","=","dot","(","rf",",","bH",")",";","vec3","rh","=","cross","(","rf",",","bH",")",";","q_",".","xyz","=","rh",".","xyz",";","q_",".","w","=","1.0","+","dC",";","return","normalize","(","q_",")",";","}","vec3","rl","(","vec3","rj",",","vec3","hK",",","vec4","qZ",",","vec3","rk",")","{","vec3","q_","=","rk","*","hK",";","q_","=","T","(","qZ",",","q_",")",";","q_","+=","rj",";","return","q_",";","}","vec3","rm","(","vec3","rj",",","vec3","hK",",","vec4","qZ",",","vec3","bH",")","{","vec3","q_","=","bH","*","hK",";","q_","=","T","(","qZ",",","q_",")",";","return","q_",";","}","vec3","rn","(","vec3","rj",",","vec3","hK",",","vec4","qZ",",","vec3","rk",")","{","vec3","q_","=","rk","-","rj",";","q_","=","T","(","kV","(","qZ",")",",","q_",")",";","q_","/=","hK",";","return","q_",";","}","vec3","ro","(","vec3","rj",",","vec3","hK",",","vec4","qZ",",","vec3","bH",")","{","return","T","(","kV","(","qZ",")",",","bH",")","/","hK",";","}","mat4","rp","(",")","{","return","mat4","(","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",")",";","}","mat4","rq","(","float","bP",")","{","return","mat4","(","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","cos","(","bP",")",",","sin","(","bP",")",",","_0_0",",","_0_0",",","-","sin","(","bP",")",",","cos","(","bP",")",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",")",";","}","mat4","rs","(","float","bP",")","{","return","mat4","(","cos","(","bP",")",",","_0_0",",","-","sin","(","bP",")",",","_0_0",",","_0_0",",","_1_0",",","_0_0",",","_0_0",",","sin","(","bP",")",",","_0_0",",","cos","(","bP",")",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",")",";","}","mat4","rt","(","float","bP",")","{","return","mat4","(","cos","(","bP",")",",","sin","(","bP",")",",","_0_0",",","_0_0",",","-","sin","(","bP",")",",","cos","(","bP",")",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",",","_0_0",",","_0_0",",","_0_0",",","_0_0",",","_1_0",")",";","}","au","ma","(","in","au","kU",")","{","return","au","(","kU",".","O",",","kU",".","ao",",","normalize","(","kU",".","V",")",",","normalize","(","kU",".","aB",")",",","normalize","(","kU",".","W",")",",","normalize","(","kU",".","U",")",",","kU",".","aQ",")",";","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SOFT_PARTICLES","REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2},"REFRACTIVE","USE_POSITION_CLIP",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","aC","(","vec4","f",")","{","float","fX","=","f",".","x",";","float","fY","=","f",".","y",";","float","fZ","=","f",".","w",";","vec3","ru",";","ru",".","x","=","(","fX","+","fZ",")","/","2.0",";","ru",".","y","=","(","fY","+","fZ",")","/","2.0",";","ru",".","z","=","fZ",";","return","ru",";","}"]}]}}]},{TYPE:"txt",TOKENS:["mat3","aY","(",")","{","return","mat3","(","_0_0",",","_0_0",",","_0_0",",","_1_0",",","_1_0",",","_1_0",",","_0_0",",","_0_0",",","_0_0",")",";","}","mat4","bh","(","mat3","t",")","{","mat4","rv",";","float","rw","=","sqrt","(","abs","(","1.","-","t","[","2","]","[","0","]","*","t","[","2","]","[","0","]","-","t","[","2","]","[","1","]","*","t","[","2","]","[","1","]","-","t","[","2","]","[","2","]","*","t","[","2","]","[","2","]",")",")",";","rv","[","0","]","[","0","]","=","(","_1_0","-","(","t","[","2","]","[","1","]","*","(","t","[","2","]","[","1","]","+","t","[","2","]","[","1","]",")","+","t","[","2","]","[","2","]","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")",")",")","*","t","[","1","]","[","0","]",";","rv","[","0","]","[","1","]","=","(","t","[","2","]","[","0","]","*","(","t","[","2","]","[","1","]","+","t","[","2","]","[","1","]",")","+","rw","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")",")","*","t","[","1","]","[","0","]",";","rv","[","0","]","[","2","]","=","(","t","[","2","]","[","0","]","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")","-","rw","*","(","t","[","2","]","[","1","]","+","t","[","2","]","[","1","]",")",")","*","t","[","1","]","[","0","]",";","rv","[","0","]","[","3","]","=","_0_0",";","rv","[","1","]","[","0","]","=","(","t","[","2","]","[","0","]","*","(","t","[","2","]","[","1","]","+","t","[","2","]","[","1","]",")","-","rw","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")",")","*","t","[","1","]","[","0","]",";","rv","[","1","]","[","1","]","=","(","_1_0","-","(","t","[","2","]","[","0","]","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")","+","t","[","2","]","[","2","]","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")",")",")","*","t","[","1","]","[","0","]",";","rv","[","1","]","[","2","]","=","(","t","[","2","]","[","1","]","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")","+","rw","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")",")","*","t","[","1","]","[","0","]",";","rv","[","1","]","[","3","]","=","_0_0",";","rv","[","2","]","[","0","]","=","(","t","[","2","]","[","0","]","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")","+","rw","*","(","t","[","2","]","[","1","]","+","t","[","2","]","[","1","]",")",")","*","t","[","1","]","[","0","]",";","rv","[","2","]","[","1","]","=","(","t","[","2","]","[","1","]","*","(","t","[","2","]","[","2","]","+","t","[","2","]","[","2","]",")","-","rw","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")",")","*","t","[","1","]","[","0","]",";","rv","[","2","]","[","2","]","=","(","_1_0","-","(","t","[","2","]","[","0","]","*","(","t","[","2","]","[","0","]","+","t","[","2","]","[","0","]",")","+","t","[","2","]","[","1","]","*","(","t","[","2","]","[","1","]","+","t","[","2","]","[","1","]",")",")",")","*","t","[","1","]","[","0","]",";","rv","[","2","]","[","3","]","=","_0_0",";","rv","[","3","]","[","0","]","=","t","[","0","]","[","0","]",";","rv","[","3","]","[","1","]","=","t","[","0","]","[","1","]",";","rv","[","3","]","[","2","]","=","t","[","0","]","[","2","]",";","rv","[","3","]","[","3","]","=","1.0",";","return","rv",";","}","mat3","bc","(","in","vec4","qZ",",","in","mat3","rx",")","{","if","(","qZ",".","w","<","0.",")","qZ",".","xyz","*=","-","1.",";","rx","[","2","]","=","qZ",".","xyz",";","return","rx",";","}","vec4","ry","(","in","mat3","rx",")","{","return","vec4","(","rx","[","2","]",",","sqrt","(","abs","(","1.","-","rx","[","2","]","[","0","]","*","rx","[","2","]","[","0","]","-","rx","[","2","]","[","1","]","*","rx","[","2","]","[","1","]","-","rx","[","2","]","[","2","]","*","rx","[","2","]","[","2","]",")",")",")",";","}","vec3","ap","(","mat3","rx",",","vec3","rk",")","{","vec3","q_","=","rk","*","rx","[","1","]",";","vec4","qZ","=","ry","(","rx",")",";","q_","=","T","(","qZ",",","q_",")",";","q_","+=","rx","[","0","]",";","return","q_",";","}","vec3","_","(","mat3","rx",",","vec3","bH",")","{","vec3","q_","=","bH","*","rx","[","1","]",";","vec4","qZ","=","ry","(","rx",")",";","q_","=","T","(","qZ",",","q_",")",";","return","q_",";","}","vec3","bI","(","mat3","rx",",","vec3","rz",")","{","vec3","q_","=","rz","/","rx","[","1","]",";","vec4","qZ","=","ry","(","rx",")",";","q_","=","T","(","qZ",",","q_",")",";","return","q_",";","}","mat3","aZ","(","in","vec3","rj",",","in","mat3","rx",")","{","rx","[","0","]","=","rj",";","return","rx",";","}","vec3","ex","(","in","mat3","rx",")","{","return","rx","[","0","]",";","}","mat3","a_","(","in","vec3","hK",",","in","mat3","rx",")","{","rx","[","1","]","=","hK",";","return","rx",";","}","vec3","rA","(","in","mat3","rx",")","{","return","rx","[","1","]",";","}","mat3","bd","(","in","mat3","rx",",","in","mat3","rB",")","{","mat3","rC",";","vec3","rj","=","ex","(","rx",")",";","vec3","rD","=","ex","(","rB",")",";","vec3","hK","=","rA","(","rx",")",";","vec3","rE","=","rA","(","rB",")",";","vec4","qZ","=","ry","(","rx",")",";","vec4","rF","=","ry","(","rB",")",";","vec3","rG","=","rl","(","rj",",","hK",",","qZ",",","rD",")",";","rC","=","aZ","(","rG",",","rC",")",";","vec3","rH","=","hK","*","rE",";","rC","=","a_","(","rH",",","rC",")",";","vec4","rI","=","rc","(","qZ",",","rF",")",";","rC","=","bc","(","rI",",","rC",")",";","return","rC",";","}","mat3","bd","(","in","mat3","rx",",","in","mat3","rB",",","out","mat3","q_",")","{","q_","=","bd","(","rx",",","rB",")",";","return","q_",";","}","vec4","R","(","in","vec4","rJ",")","{","return","normalize","(","rJ",")",";","}","vec4","R","(","in","vec4","rJ",",","out","float","P",",","out","float","Q",")","{","vec4","qZ","=","R","(","rJ",")",";","P","=","length","(","rJ",")","*","M_PI",";","Q","=","sign","(","rJ","[","3","]",")",";","return","R","(","rJ",")",";","}"]}]}}]}]},e["include/mirror.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"MIRROR_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"MIRROR_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"USE_BSDF_SKY_DIM",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"REFL_BUMP",TOKENS:["0.1"]},{TYPE:"txt",TOKENS:["float","rK","(","in","vec3","D",",","vec3","eN",",","float","ec",",","float","fk",")","{","vec3","fi","=","normalize","(","eN","+","D",")",";","float","fj","=","1.0","-","dot","(","D",",","fi",")",";","float","r","=","fk","+","(","1.0","-","fk",")","*","pow","(","fj",",","ec",")",";","return","r",";","}","void","cQ","(","inout","vec3","rL",",","vec3","D",",","vec3","U",",","float","rM",",","mat3","N",")","{","vec3","eN","=","reflect","(","-","D",",","U",")",";","float","ec","=","u_fresnel_params","[","0","]",";","float","fk","=","u_fresnel_params","[","1","]",";","float","r","=","1.0",";","if","(","ec","!=","0.0",")","r","=","rK","(","D",",","eN",",","ec",",","fk",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_TYPE","REFL_CUBE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","eS","=","GLSL_TEXTURE_CUBE","(","u_cube_reflection",",","eN",")",".","xyz",";"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_NONE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","rN","=","u_refl_plane",".","xyz","*","dot","(","U",",","u_refl_plane",".","xyz",")",";","vec3","rO","=","U","-","rN",";","vec2","rP","=","bI","(","N",",","rO",")",".","xy",";","vec2","rQ","=","l",".","xy","/","l",".","z",";","rQ","+=","rP","*","REFL_BUMP",";","vec3","eS","=","GLSL_TEXTURE","(","u_plane_reflection",",","rQ",")",".","rgb",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","eS","=","vec3","(","1.0",")",";","rM","=","0.0",";"]}]}}]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_MIRRORMAP",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","eS","=","GLSL_TEXTURE_CUBE","(","u_mirrormap",",","eN",")",".","xyz",";"]}]}}]},{TYPE:"txt",TOKENS:["bG","(","eS",".","rgb",")",";","rL","=","mix","(","rL",",","eS",",","rM","*","r",")",";","}"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_STANDARD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","rU","(","float","eg",",","vec3","rR",",","float","ef",")","{","float","rS","=","1.0","-","eg",";","float","rT","=","rS","*","rS",";","rT","=","rT","*","rS","*","rT",";","return","rR","+","(","max","(","vec3","(","1.0","-","ef",")",",","rR",")","-","rR",")","*","rT",";","}","vec3","sf","(","vec3","rL",",","vec3","rV",",","vec3","D",",","vec3","U",",","float","rW",",","float","rX",",","mat3","N",")","{","float","rY","=","max","(","dot","(","normalize","(","U",")",",","D",")",",","_0_0",")",";","vec3","eN","=","reflect","(","-","D",",","U",")",";","float","ef","=","sqrt","(","rX",")",";","vec3","rR","=","vec3","(","0.04",")",";","rR","=","mix","(","rR",",","rV",",","rW",")",";","vec3","rZ","=","rU","(","rY",",","rR",",","ef",")",";","vec3","r_","=","rZ",";","vec3","sa","=","vec3","(","_1_0",")","-","r_",";","sa","*=","vec3","(","1.0","-","rW",")",";","vec3","bx","=","GLSL_TEXTURE_CUBE","(","u_cube_irradiance",",","U",")",".","xyz",";","vec3","sb","=","bx","*","rL",";","const","float","sc","=","5.0",";","vec3","el","=","GLSL_TEXTURE_CUBE_LOD","(","u_cube_r_convolution",",","eN",",","ef","*","sc",")",".","rgb",";","vec2","sd","=","GLSL_TEXTURE","(","u_brdf",",","vec2","(","rY",",","ef",")",")",".","rg",";","vec3","cO","=","el","*","(","rZ","*","sd",".","x","+","sd",".","y",")",";","vec3","se","=","(","sa","*","sb","+","cO",")",";","return","se",";","}"]}]}},{TYPE:"elif",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_SIMPLE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","rU","(","float","eg",",","vec3","rR",",","float","ef",")","{","float","rS","=","1.0","-","eg",";","float","rT","=","rS","*","rS",";","rT","=","rT","*","rS","*","rT",";","return","rR","+","(","max","(","vec3","(","1.0","-","ef",")",",","rR",")","-","rR",")","*","rT",";","}","vec3","sf","(","vec3","rL",",","vec3","rV",",","vec3","D",",","vec3","U",",","float","rW",",","float","rX",",","mat3","N",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_BSDF_SKY_DIM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ec","=","normalize","(","U",")",";","float","rY","=","max","(","dot","(","ec",",","D",")",",","_0_0",")",";","vec3","eN","=","reflect","(","-","D",",","U",")",";","float","sg","=","max","(","2.0","/","(","rX","*","rX",")","-","2.0",",","_0_0",")",";","vec3","rR","=","vec3","(","0.04",")",";","rR","=","mix","(","rR",",","rV",",","rW",")",";","vec3","rZ","=","rU","(","rY",",","rR",",","sqrt","(","rX",")",")",";","vec3","r_","=","rZ",";","vec3","sa","=","vec3","(","_1_0",")","-","r_",";","sa","*=","1.0","-","rW",";","vec3","sb","=","GLSL_TEXTURE_CUBE_LOD","(","u_sky_reflection",",","ec",",","100.0",")",".","xyz",";","bG","(","sb",")",";","sb","*=","rL",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["GLSL1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","sh","=","u_bsdf_cube_sky_dim",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","sh","=","float","(","textureSize","(","u_sky_reflection",",","0",")",".","x",")",";"]}]}}]},{TYPE:"txt",TOKENS:["float","si","=","log2","(","(","sh","*","sqrt","(","3.0",")",")","/","sqrt","(","sg","+","_1_0",")",")",";","vec3","cO","=","GLSL_TEXTURE_CUBE_LOD","(","u_sky_reflection",",","eN",",","si",")",".","xyz",";","bG","(","cO",")",";","vec3","se","=","sa","*","sb","+","r_","*","cO",";","return","se",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","rL",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]},e["include/nodes.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"NODES_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"NODES_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"DOUBLE_SIDED_LIGHTING",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"USE_REFRACTION",TOKENS:["0"]},{TYPE:"var",NAME:"HAS_REFRACT_TEXTURE",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_TYPE",TOKENS:["REFL_NONE"]},{TYPE:"var",NAME:"USE_DERIVATIVES_EXT",TOKENS:["0"]},{TYPE:"var",NAME:"CAMERA_TYPE",TOKENS:["CAM_TYPE_PERSP"]},{TYPE:"var",NAME:"IS_WORLD",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_PRINCIPLED_REFRACT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_TRANSPARENT_REFRACT",TOKENS:["0"]},{TYPE:"var",NAME:"USE_BSDF_TRANSPARENT_ALPHA",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"mirror.glslf"},{TYPE:"include",FILE:"shadow.glslf"},{TYPE:"include",FILE:"environment.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"refraction.glslf"}]}}]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","sj",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_B4W_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sm","(","in","vec3","sk",",","in","float","sl",")","{","vec3","fa","=","vec3","(","_0_0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["fa","=","cS","(","l",",","sk",".","xy","*","sl",")",";"]}]}},{TYPE:"elif",EXPRESSION:["HAS_REFRACT_TEXTURE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["fa","=","GLSL_TEXTURE","(","u_refractmap",",","l",".","xy","/","l",".","z",")",".","rgb",";","bG","(","fa",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","fa",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","kj","(","vec3","rgb",")","{","vec4","hM","=","vec4","(","_0_0",",","-","_1_0","/","3.0",",","2.0","/","3.0",",","-","_1_0",")",";","vec4","p","=","mix","(","vec4","(","rgb",".","bg",",","hM",".","wz",")",",","vec4","(","rgb",".","gb",",","hM",".","xy",")",",","step","(","rgb",".","b",",","rgb",".","g",")",")",";","vec4","q","=","mix","(","vec4","(","p",".","xyw",",","rgb",".","r",")",",","vec4","(","rgb",".","r",",","p",".","yzx",")",",","step","(","p",".","x",",","rgb",".","r",")",")",";","float","dC","=","q",".","x","-","min","(","q",".","w",",","q",".","y",")",";","float","iF","=","1.0e-10",";","return","vec3","(","abs","(","q",".","z","+","(","q",".","w","-","q",".","y",")","/","(","6.0","*","dC","+","iF",")",")",",","dC","/","(","q",".","x","+","iF",")",",","q",".","x",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","kl","(","vec3","kk",")","{","vec4","hM","=","vec4","(","_1_0",",","2.0","/","3.0",",","_1_0","/","3.0",",","3.0",")",";","vec3","p","=","abs","(","fract","(","vec3","(","kk",".","r",",","kk",".","r",",","kk",".","r",")","+","hM",".","xyz",")","*","6.0","-","hM",".","www",")",";","return","kk",".","b","*","mix","(","hM",".","xxx",",","clamp","(","p","-","hM",".","xxx",",","_0_0",",","_1_0",")",",","kk",".","g",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED","USE_NODE_TEX_COORD_UV","USE_NODE_UVMAP",{TYPE:"logical_or_expr",PLACES:5}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sn","(","vec2","gX",")","{","return","vec3","(","gX","*","2.0","-","vec2","(","_1_0",",","_1_0",")",",","_0_0",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","so","(","vec3","rk",")","{","return","vec2","(","rk",".","xy","*","_0_5","+","vec2","(","_0_5",",","_0_5",")",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_FRESNEL","USE_NODE_LAYER_WEIGHT",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","sv","(","vec3","sr",",","vec3","rz",",","float","su",")","{","float","dx","=","abs","(","dot","(","sr",",","rz",")",")",";","float","g","=","su","*","su","-","_1_0","+","dx","*","dx",";","float","ea",";","if","(","g",">","_0_0",")","{","g","=","sqrt","(","g",")",";","float","cG","=","(","g","-","dx",")","/","(","g","+","dx",")",";","float","hS","=","(","dx","*","(","g","+","dx",")","-","_1_0",")","/","(","dx","*","(","g","-","dx",")","+","_1_0",")",";","ea","=","_0_5","*","cG","*","cG","*","(","_1_0","+","hS","*","hS",")",";","}","else","{","ea","=","_1_0",";","}","return","ea",";","}"]}]}}]},{TYPE:"node",NAME:"CAMERA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sU",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sV",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sW",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sU"],STATEMENTS:[{TYPE:"txt",TOKENS:["sU","=","normalize","(","sR",".","xyz",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sV"],STATEMENTS:[{TYPE:"txt",TOKENS:["sV","=","abs","(","sR",".","z",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sW"],STATEMENTS:[{TYPE:"txt",TOKENS:["sW","=","length","(","sR",".","xyz",")",";"]}]}]}]},{TYPE:"node",NAME:"COMBRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"sX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"s_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["s_","=","vec3","(","sX",",","sY",",","sZ",")",";"]}]},{TYPE:"node",NAME:"COMBHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ta",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"td",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["td","=","kl","(","vec3","(","ta",",","tb",",","tc",")",")",";"]}]},{TYPE:"node",NAME:"EMPTY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"te",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["te","=","vec3","(","-","_1_0",",","-","_1_0",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"EMPTY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tf","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sw",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tg","=","sn","(","sw",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_OR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"th",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["th","=","2.0","*","sj","-","vec3","(","_1_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"ti",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sx",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ti","=","max","(","vec3","(","_0_0",")",",","sx",")",";","bG","(","ti",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC1",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sy",QUALIFIER:["GLSL_IN","float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tj","=","max","(","_0_0",",","sy",")",";","bG","(","tj",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC2",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sz",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tk","=","max","(","_0_0",",","sz","[","0","]",")",";","tl","=","max","(","_0_0",",","sz","[","1","]",")",";","bG","(","tk",")",";","bG","(","tl",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC3",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"to",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sA",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tm","=","max","(","_0_0",",","sA","[","0","]",")",";","tn","=","max","(","_0_0",",","sA","[","1","]",")",";","to","=","max","(","_0_0",",","sA","[","2","]",")",";","bG","(","tm",")",";","bG","(","tn",")",";","bG","(","to",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_NO",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"tr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tu",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["tu","=","tr",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["tu","=","sK",".","xyz",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_FB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tv",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tv","=","(","gl_FrontFacing",")","?","_0_0",":","_1_0",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["tv","=","(","gl_FrontFacing",")","?","_1_0",":","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_BF",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tw",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tw","=","(","gl_FrontFacing",")","?","_1_0",":","_0_0",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["tw","=","(","gl_FrontFacing",")","?","_0_0",":","_1_0",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_VW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tx",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tx","=","-","_","(","u_view_tsr_frag",",","oy",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_LO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"ty",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ty","=","sR",".","xyz",";"]}]},{TYPE:"node",NAME:"GEOMETRY_GL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tz","=","ow",";"]}]},{TYPE:"node",NAME:"GEOMETRY_IN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tA",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tA","=","oy",";"]}]},{TYPE:"node",NAME:"NEW_GEOMETRY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tB","=","vec3","(","_0_0",")",";","tC","=","vec3","(","_0_0",")",";","tD","=","vec3","(","_0_0",")",";","tE","=","vec3","(","_0_0",")",";","tF","=","vec3","(","_0_0",")",";","tG","=","vec3","(","_0_0",")",";","tH","=","_0_0",";","tI","=","_0_0",";"]}]},{TYPE:"node",NAME:"HUE_SAT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","kk","=","kj","(","tN",")",";","kk","[","0","]","+=","(","tJ","-","_0_5",")",";","if","(","kk","[","0","]",">","_1_0",")","kk","[","0","]","-=","_1_0",";","else","if","(","kk","[","0","]","<","_0_0",")","kk","[","0","]","+=","_1_0",";","kk","*=","vec3","(","_1_0",",","tK",",","tL",")",";","kk","=","mix","(","vec3","(","_1_0",")",",","mix","(","vec3","(","_0_0",")",",","kk",",","step","(","vec3","(","_0_0",")",",","kk",")",")",",","step","(","kk",",","vec3","(","_1_0",")",")",")",";","tO","=","mix","(","tN",",","kl","(","kk",")",",","tM",")",";"]}]},{TYPE:"node",NAME:"INVERT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tR","=","mix","(","tQ",",","vec3","(","_1_0",")","-","tQ",",","tP",")",";"]}]},{TYPE:"node",NAME:"LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_INDEX",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"tS",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"tT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tV",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_INDEX",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tS"],STATEMENTS:[{TYPE:"txt",TOKENS:["tS","=","u_lamp_light_color_intensities","[","LAMP_INDEX","]",";"]}]}]},{TYPE:"txt",TOKENS:["vec3","tW","=","u_lamp_light_directions","[","LAMP_INDEX","]",";","vec3","tX","=","u_lamp_light_positions","[","LAMP_INDEX","]",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tT","=","h","-","tX",";","tU","=","length","(","tT",")",";","tT","=","normalize","(","tT",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tV"],STATEMENTS:[{TYPE:"txt",TOKENS:["tV","=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","tU","*","tU",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","pb","=","dot","(","-","tT",",","tW",")",";","pb","*=","smoothstep","(","_0_0",",","_1_0",",","(","pb","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","tV","*=","pb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:["tV","*=","max","(","LAMP_LIGHT_DIST","-","tU",",","_0_0",")","/","LAMP_LIGHT_DIST",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tT"],STATEMENTS:[{TYPE:"txt",TOKENS:["tT","=","tW",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tU"],STATEMENTS:[{TYPE:"txt",TOKENS:["tU","=","length","(","tX","-","h",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tV"],STATEMENTS:[{TYPE:"txt",TOKENS:["tV","=","_1_0",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tS"],STATEMENTS:[{TYPE:"txt",TOKENS:["tS","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["tT","=","vec3","(","_0_0",")",";","tU","=","0.0",";"]}]}]}]},{TYPE:"node",NAME:"NORMAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tZ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"t_",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sB",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["tZ","=","sB",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_t_"],STATEMENTS:[{TYPE:"txt",TOKENS:["t_","=","-","dot","(","tY",",","sB",")",";"]}]}]}]},{TYPE:"node",NAME:"B4W_VECTOR_VIEW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ua",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ub",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ub","=","-","_","(","u_view_tsr_frag",",","ua",")",";"]}]},{TYPE:"node",NAME:"BSDF_BEGIN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"uc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ud",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ue",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ug",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ui",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ul",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"um",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"un",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"up",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ur",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"us",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ut",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uu",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uv",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uw",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ux",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uC",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ur","=","ud",";","us","=","uf",";","ut","=","ui",";","ux","=","ud",";","uy","=","uf",";","uz","=","ul",";","uA","=","um",";","uB","=","un",";","uC","=","uo",";","up","=","sS","*","ur",";","uq","=","sT","*","u_environment_energy","*","cE","(","ut",")",";","uw","=","cH","(","ur",")",";","H","=","uw",";","uu","[","0","]","=","ue",";","uu","[","1","]","=","ug",";","uu","[","2","]","=","uh",";","uv","[","0","]","=","uj",";","uv","[","1","]","=","uk",";"]}]},{TYPE:"node",NAME:"BSDF_END",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"uD",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uG",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uH",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uP",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","uQ","=","clamp","(","uG","[","1","]",",","_0_0",",","_1_0",")",";","float","rW","=","uG","[","2","]",";","uO","=","uD",".","rgb",";","uP","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_TYPE","REFL_PBR_STANDARD",{TYPE:"equal_expr",PLACES:2},"REFLECTION_TYPE","REFL_PBR_SIMPLE",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["uO","+=","sf","(","uI",",","uJ",",","oy",",","uF",",","rW",",","uQ",",","mat3","(","_0_0",")",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["uO","+=","sf","(","uI",",","uJ",",","oy",",","uF",",","rW",",","u_view_tsr_frag",")",";"]}]}]},{TYPE:"txt",TOKENS:["uO","+=","uE",";","uO","=","mix","(","uO",",","uK",",","uL",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_BSDF_TRANSPARENT"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_TRANSPARENT_REFRACT"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","uR","=","GLSL_TEXTURE","(","u_refractmap",",","l",".","xy","/","l",".","z",")",".","rgb",";","bG","(","uR",")",";","uM","=","uM","*","uR",";","uO","+=","uM",";","uP","=","_1_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_TRANSPARENT_ALPHA"],STATEMENTS:[{TYPE:"txt",TOKENS:["uO","=","mix","(","uM",",","uO",",","uN",")",";","uP","=","uN",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_PRINCIPLED_REFRACT"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","uS","=","uH","[","0","]",";","float","uT","=","uH","[","1","]",";","float","uU","=","clamp","(","uG","[","0","]",",","_0_0",",","_1_0",")",";","vec3","en","=","oy",";","vec3","ei","=","normalize","(","uF",")",";","vec3","uV","=","refract","(","-","en",",","ei",",","_1_0","/","uS",")",";","uV","*=","length","(","u_camera_eye_frag","-","h",")",";","vec3","uW","=","aC","(","u_proj_matrix_frag","*","vec4","(","ap","(","u_view_tsr_frag",",","ow","+","uV",")",",","_1_0",")",")",";","vec2","uX","=","uW",".","xy","/","uW",".","z",";","const","float","sc","=","10.0",";","vec3","fa","=","GLSL_TEXTURE_LOD","(","u_refractmap",",","uX",".","xy",",","uU","*","sc",")",".","rgb",";","bG","(","fa",")",";","float","e_","=","(","_1_0","-","rW",")","*","uT",";","uO","=","mix","(","uO",",","fa",",","e_",")",";"]}]}]},{TYPE:"txt",TOKENS:["uF",";"]}]},{TYPE:"node",NAME:"BSDF_COMPUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"uY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uZ",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"u_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"va",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vb",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vd",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","u_",";","float","uU","=","clamp","(","vb","[","0","]",",","_0_0",",","_1_0",")",";","float","uQ","=","clamp","(","vb","[","1","]",",","_0_0",",","_1_0",")",";","float","rW","=","vb","[","2","]",";","vec3","p_","=","normalize","(","oy","+","uY",")",";","vec3","ve","=","(","_1_0","-","va",")","*","vec3","(","dot","(","rz",",","uY",")",",","max","(","dot","(","uY",",","p_",")",",","_0_0",")",",","max","(","dot","(","u_",",","p_",")",",","_0_0",")",")","+","va",";","float","pj","=","ve",".","x",";","float","vf","=","ve",".","y",";","float","vg","=","ve",".","z",";","vc","=","_0_0",";","if","(","uZ",".","r","!=","_0_0",")","{","vc","=","pj",";","if","(","uU",">","_0_0",")","{","float","pz","=","max","(","dot","(","rz",",","oy",")",",","_0_0",")",";","float","pA","=","uU","*","uU",";","float","cG","=","_1_0","-","_0_5","*","(","pA","/","(","pA","+","0.33",")",")",";","vec3","pB","=","uY","-","pj","*","rz",";","vec3","pC","=","oy","-","pz","*","rz",";","if","(","length","(","pB",")","==","_0_0","||","length","(","pC",")","==","_0_0","||","abs","(","pj",")",">","_1_0","||","abs","(","pz",")",">","_1_0",")","vc","=","pj","*","cG",";","else","{","float","pD","=","acos","(","pj",")",";","float","pE","=","acos","(","pz",")",";","vec3","pF","=","normalize","(","pB",")",";","vec3","pG","=","normalize","(","pC",")",";","float","a",",","b",";","a","=","max","(","pD",",","pE",")",";","b","=","min","(","pD",",","pE",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pF",",","pG",")",",","_0_0",")",";","float","hS","=","0.45","*","(","pA","/","(","pA","+","0.09",")",")",";","vc","=","pj","*","(","cG","+","(","hS","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","vc","=","max","(","vc",",","_0_0",")","/","M_PI",";","}","float","L","=","uQ",";","float","vh","=","L","*","L",";","float","d_","=","(","vg","*","vh","-","vg",")","*","vg","+","_1_0",";","float","cD","=","vh","/","(","M_PI","*","d_","*","d_",")",";","float","vi",";","float","vj",";","float","vk","=","_1_0","-","vf",";","float","vl","=","vk","*","vk",";","vl","=","vl","*","vk","*","vl",";","vi","=","_1_0",";","vj","=","vl",";","float","hM","=","L","/","2.0",";","float","vm","=","hM","*","hM",";","float","vn","=","_1_0","-","vm",";","float","vo","=","_1_0","/","(","vf","*","vf","*","vn","+","vm",")",";","vi","*=","vo",";","vj","*=","vo",";","float","rR","=","mix","(","0.04",",","_1_0",",","rW",")",";","float","vp","=","mix","(","vj",",","vi",",","rR",")",";","vd","=","max","(","pj","*","cD","*","vp",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_PRINCIPLED",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"vq",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vy",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vz","=","vq",".","rgb",";","vA","=","vs","*","vs",";","vx","=","vq",".","rgb",";","vy","=","vs",";","vB","=","vr",";","vD","=","vt",";","vE","=","vu",";","vG","=","_0_0",";","vI","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vC","=","vv",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vC","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:["vw",";","vF","=","vec3","(","_0_0",")",";","vH","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_ANISOTROPIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"vJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vP","=","vJ",";","vK",";","vL",";","vM",";","vN",";","vO",";"]}]},{TYPE:"node",NAME:"BSDF_DIFFUSE",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"vQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"v_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wa",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wb",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"we",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vU","=","vQ",";","vV","=","vR",";","vX","=","_1_0",";","vY","=","_0_0",";","v_","=","1.45",";","wa","=","_0_0",";","wc","=","_0_0",";","we","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vZ","=","vS",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vZ","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:["vT",";","vW","=","vec3","(","_0_0",")",";","wb","=","vec3","(","_0_0",")",";","wd","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_GLASS",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wj",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wj","=","wf",";","wg",";","wh",";","wi",";"]}]},{TYPE:"node",NAME:"BSDF_GLOSSY",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"wk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wp",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ws",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wq","=","wk",";","wr","=","wl",";","ws","=","_1_0",";","wu","=","1.45",";","wv","=","_0_0",";","wB","=","_0_0",";","wD","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["wt","=","wm",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["wt","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:["wn",";","wo","=","vec3","(","_0_0",")",";","wp","=","_0_0",";","wA","=","vec3","(","_0_0",")",";","wC","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_HAIR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wI",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wI","=","wE",";","wF",";","wG",";","wH",";"]}]},{TYPE:"node",NAME:"BSDF_TRANSPARENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wV","=","wJ",";","wP","=","_0_0",";","wU","=","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_BSDF_TRANSPARENT_ALPHA"],STATEMENTS:[{TYPE:"txt",TOKENS:["wW","=","_0_0",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["wW","=","_1_0",";"]}]}]},{TYPE:"txt",TOKENS:["wQ","=","ox",";","wK",";","wL","=","vec3","(","_0_0",")",";","wM","=","_0_0",";","wN","=","vec3","(","_0_0",")",";","wO","=","_0_0",";","wT","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_TRANSLUCENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wZ","=","wX",";","wY",";"]}]},{TYPE:"node",NAME:"BSDF_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"w_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xa",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xd",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xd","[","0","]","=","xd","[","1","]","=","xd","[","2","]","=","_0_0",";","w_",";","xa",";","xb",";","xc",";"]}]},{TYPE:"node",NAME:"BSDF_TOON",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xi","=","xe",";","xf",";","xg",";","xh",";"]}]},{TYPE:"node",NAME:"BSDF_VELVET",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xj",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xm","=","xj",";","xk",";","xl",";"]}]},{TYPE:"node",NAME:"SUBSURFACE_SCATTERING",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xt",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xt","[","0","]","=","xt","[","1","]","=","xt","[","2","]","=","_0_0",";","xn",";","xp",";","xq",";","xr",";","xs",";","xo",";"]}]},{TYPE:"node",NAME:"EMISSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xJ","=","xv","*","xu",";","xF","=","_0_0",";","xK","=","_1_0",";","xM","=","_1_0",";","xG","=","ox",";","xH","=","1.45",";","xI","=","_0_0",";","xA",";","xB","=","vec3","(","_0_0",")",";","xC","=","_0_0",";","xD","=","vec3","(","_0_0",")",";","xE","=","_0_0",";"]}]},{TYPE:"node",NAME:"AMBIENT_OCCLUSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xO","[","0","]","=","xO","[","1","]","=","xO","[","2","]","=","_0_0",";","xN",";"]}]},{TYPE:"node",NAME:"HOLDOUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"xP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xP","[","0","]","=","xP","[","1","]","=","xP","[","2","]","=","_0_0",";"]}]},{TYPE:"node",NAME:"VOLUME_ABSORPTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xS","[","0","]","=","xS","[","1","]","=","xS","[","2","]","=","_0_0",";","xQ",";","xR",";"]}]},{TYPE:"node",NAME:"VOLUME_SCATTER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xW",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xW","[","0","]","=","xW","[","1","]","=","xW","[","2","]","=","_0_0",";","xT",";","xU",";","xV",";"]}]},{TYPE:"node",NAME:"BUMP",NODE_VARS:[{TYPE:"node_var",NAME:"INVERT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"xX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"x_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ya",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","aM","=","xY",";","float","gL","=","xX",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["INVERT"],STATEMENTS:[{TYPE:"txt",TOKENS:["aM","=","-","_1_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","U","=","x_",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","U","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_DERIVATIVES_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yb","=","dFdx","(","ow",")",";","vec3","yc","=","dFdy","(","ow",")",";","vec3","yd","=","cross","(","yc",",","U",")",";","vec3","ye","=","cross","(","U",",","yb",")",";","float","dy","=","dot","(","yb",",","yd",")",";","float","yf","=","abs","(","dy",")",";","vec3","yg","=","dFdx","(","xZ",")","*","yd","+","dFdy","(","xZ",")","*","ye",";","gL","=","max","(","gL",",","_0_0",")",";","ya","=","normalize","(","yf","*","U","-","aM","*","sign","(","dy",")","*","yg",")",";","ya","=","normalize","(","gL","*","ya","+","(","_1_0","-","gL",")","*","U",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["ya","=","U",";"]}]}]}]},{TYPE:"node",NAME:"DISPLACEMENT_BUMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","aM","=","0.1",";","vec3","U","=","ox",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_DERIVATIVES_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yb","=","dFdx","(","ow",")",";","vec3","yc","=","dFdy","(","ow",")",";","vec3","yd","=","cross","(","yc",",","U",")",";","vec3","ye","=","cross","(","U",",","yb",")",";","float","dy","=","dot","(","yb",",","yd",")",";","float","yf","=","abs","(","dy",")",";","vec3","yg","=","dFdx","(","yh",")","*","yd","+","dFdy","(","yh",")","*","ye",";","yi","=","normalize","(","yf","*","U","-","aM","*","sign","(","dy",")","*","yg",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["yi","=","U",";"]}]}]}]},{TYPE:"node",NAME:"NORMAL_MAP",NODE_VARS:[{TYPE:"node_var",NAME:"SPACE",TOKENS:["NM_TANGENT"]},{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"yj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yk",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ym",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yn","=","yl",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yn","=","sM",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["SPACE","NM_TANGENT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["ym","=","2.0","*","yk",".","xyz","-","_1_0",";","ym","=","sQ","*","ym",";"]}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_OBJECT",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_OBJECT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["ym","=","2.0","*","yk",".","xyz","-","_1_0",";","ym",".","yz","*=","-","_1_0",";","ym","=","bI","(","u_model_tsr",",","ym",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_WORLD",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_WORLD",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["ym","=","2.0","*","yk",".","xyz","-","_1_0",";","ym",".","yz","*=","-","_1_0",";"]}]}]},{TYPE:"txt",TOKENS:["float","me","=","max","(","yj",",","_0_0",")",";","ym","=","normalize","(","mix","(","yn",",","ym",",","me",")",")",";"]}]},{TYPE:"node",NAME:"VECT_TRANSFORM",NODE_VARS:[{TYPE:"node_var",NAME:"CONVERT_TYPE",TOKENS:["VT_WORLD_TO_OBJECT"]},{TYPE:"node_var",NAME:"VECTOR_TYPE",TOKENS:["VT_VECTOR"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"yo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yp",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","yo",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_POINT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_view_tsr_frag",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_model_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_model_tsr",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_model_tsr",",","yo",")",";","yp","=","ap","(","u_view_tsr_frag",",","yp",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_view_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_view_tsr_inverse",",","yo",")",";","yp","=","ap","(","u_model_tsr_inverse",",","yp",")",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_view_tsr_frag",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_model_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_model_tsr",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_model_tsr",",","yo",")",";","yp","=","_","(","u_view_tsr_frag",",","yp",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_view_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_view_tsr_inverse",",","yo",")",";","yp","=","_","(","u_model_tsr_inverse",",","yp",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_NORMAL",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","normalize","(","yp",")",";"]}]}]}]}]}]},{TYPE:"node",NAME:"BLACKBODY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yr",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yr","[","0","]","=","yr","[","1","]","=","yr","[","2","]","=","_0_0",";","yq",";"]}]},{TYPE:"node",NAME:"WAVELENGTH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ys",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yt",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yt","[","0","]","=","yt","[","1","]","=","yt","[","2","]","=","_0_0",";","ys",";"]}]},{TYPE:"node",NAME:"SEPXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yv","=","yu","[","0","]",";","yA","=","yu","[","1","]",";","yB","=","yu","[","2","]",";"]}]},{TYPE:"node",NAME:"COMBXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yF",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yF","[","0","]","=","yC",";","yF","[","1","]","=","yD",";","yF","[","2","]","=","yE",";"]}]},{TYPE:"node",NAME:"BRIGHTCONTRAST",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","b","=","yH","-","yI","*","_0_5",";","yJ","=","max","(","(","_1_0","+","yI",")","*","yG","+","b",",","vec3","(","_0_0",")",")",";"]}]},{TYPE:"node",NAME:"LIGHT_FALLOFF",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yO",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yM","=","yN","=","yO","=","_0_0",";","yK",";","yL",";"]}]},{TYPE:"node",NAME:"TEX_SKY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yQ","[","0","]","=","yQ","[","1","]","=","yQ","[","2","]","=","_0_0",";","yP",";"]}]},{TYPE:"node",NAME:"TEX_NOISE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yV","[","0","]","=","yV","[","1","]","=","yV","[","2","]","=","_0_0",";","yW","=","_1_0",";","yR",";","yS",";","yT",";","yU",";"]}]},{TYPE:"node",NAME:"TEX_WAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"y_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"za",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zb",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zc",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zb","[","0","]","=","zb","[","1","]","=","zb","[","2","]","=","_0_0",";","zc","=","_1_0",";","yX",";","yY",";","yZ",";","y_",";","za",";"]}]},{TYPE:"node",NAME:"TEX_VORONOI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ze",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zg",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zf","[","0","]","=","zf","[","1","]","=","zf","[","2","]","=","_0_0",";","zg","=","_1_0",";","zd",";","ze",";"]}]},{TYPE:"node",NAME:"TEX_MUSGRAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zp",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zo","[","0","]","=","zo","[","1","]","=","zo","[","2","]","=","_0_0",";","zp","=","_1_0",";","zh",";","zi",";","zj",";","zk",";","zl",";","zm",";","zn",";"]}]},{TYPE:"node",NAME:"TEX_GRADIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zs",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zr","[","0","]","=","zr","[","1","]","=","zr","[","2","]","=","_0_0",";","zs","=","_1_0",";","zq",";"]}]},{TYPE:"node",NAME:"TEX_MAGIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zA","[","0","]","=","zA","[","1","]","=","zA","[","2","]","=","_0_0",";","zB","=","_1_0",";","zt",";","zu",";","zv",";"]}]},{TYPE:"node",NAME:"TEX_CHECKER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zH",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zG","[","0","]","=","zG","[","1","]","=","zG","[","2","]","=","_0_0",";","zH","=","_1_0",";","zC",";","zD",";","zE",";","zF",";"]}]},{TYPE:"node",NAME:"TEX_BRICK",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zR","[","0","]","=","zR","[","1","]","=","zR","[","2","]","=","_0_0",";","zS","=","_1_0",";","zI",";","zJ",";","zK",";","zL",";","zM",";","zN",";","zO",";","zP",";","zQ",";"]}]},{TYPE:"node",NAME:"ADD_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zV","=","clamp","(","zT","+","zU",",","vec3","(","_0_0",")",",","vec3","(","_1_0",")",")",";"]}]},{TYPE:"node",NAME:"MIX_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"z_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ab",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ac",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ad",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ae",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Af",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ag",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ah",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ai",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ak",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Al",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Am",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"An",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ao",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ap",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ar",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"As",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"At",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Au",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Av",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Aw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ax",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ay",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Az",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","sqrt","(","clamp","(","zW",",","_0_0",",","_1_0",")",")",";","Ax","=","mix","(","zZ",",","Ak",",","AJ",")",";","Ay","=","mix","(","z_",",","Al",",","AJ",")",";","if","(","Ac",">","_0_0",")","{","if","(","Ao",">","_0_0",")","{","Az","=","mix","(","Aa",",","Am",",","AJ",")",";","AA","=","mix","(","Ab",",","An",",","AJ",")",";","}","else","{","Az","=","Aa",";","AA","=","Ab",";","}","}","else","{","Az","=","Am",";","AA","=","An",";","}","if","(","Ah",">","_0_0",")","{","if","(","At",">","_0_0",")","{","AF","=","mix","(","Ag",",","As",",","AJ",")",";","}","else","{","AF","=","Ag",";","}","}","else","{","AF","=","As",";","}","AB","=","mix","(","Ac",",","Ao",",","AJ",")",";","AC","=","mix","(","Ad",",","Ap",",","AJ",")",";","AG","=","mix","(","Ah",",","At",",","AJ",")",";","AH","=","mix","(","Ai",",","Au",",","AJ",")",";","AI","=","mix","(","Aj",",","Av",",","AJ",")",";"]}]},{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sC",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AK"],STATEMENTS:[{TYPE:"txt",TOKENS:["AK","=","sn","(","sC",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AL"],STATEMENTS:[{TYPE:"txt",TOKENS:["AL","=","vec3","(","sC",",","_0_0",")",";"]}]}]}]},{TYPE:"node",NAME:"TEX_COORD_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sD",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AM","=","vec3","(","sD",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"TEX_COORD_NO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AN",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AN","=","ox",";"]}]},{TYPE:"node",NAME:"TEX_COORD_GE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["IS_WORLD",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AO","=","sj",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AO","=","sJ",";"]}]}]}]},{TYPE:"node",NAME:"TEX_COORD_OB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["IS_WORLD",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AP","=","ap","(","u_model_tsr_inverse",",","ow",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AP","=","sJ",";"]}]}]}]},{TYPE:"node",NAME:"TEX_COORD_CA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AQ",".","xy","=","sR",".","xy",";","AQ",".","z","=","_1_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_WI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AR",".","xy","=","l",".","xy","/","l",".","z",";","AR",".","z","=","_0_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_RE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AS","=","reflect","(","-","oy",",","ox",")",";"]}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sE",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AT","=","vec3","(","sE",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"PARTICLE_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"A_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AU","=","_0_0",";","AV","=","_0_0",";","AW","=","_0_0",";","AX","=","vec3","(","_0_0",")",";","AY","=","_0_0",";","AZ","=","AX",";","A_","=","AX",";"]}]},{TYPE:"node",NAME:"HAIR_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Ba",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bd",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ba","=","_0_0",";","Bb","=","_0_0",";","Bc","=","_0_0",";","Bd","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"OBJECT_INFO",NODE_VARS:[{TYPE:"node_var",NAME:"USE_LOCATION_OUT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_OBJ_IND_OUT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MAT_IND_OUT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_RANDOM_OUT",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Be",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bh",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_LOCATION_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:["Be","=","ex","(","u_model_tsr",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OBJ_IND_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bf","=","u_obj_info",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MAT_IND_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bg","=","u_obj_info",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_RANDOM_OUT"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bh","=","u_obj_info",".","b",";"]}]}]}]},{TYPE:"node",NAME:"WIREFRAME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Bi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bj","=","Bi",";"]}]},{TYPE:"node",NAME:"TANGENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Bk",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bk","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LAYER_WEIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Bl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Bm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bo",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","cw","=","normalize","(","Bm",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","cw","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CAMERA_TYPE","CAM_TYPE_PERSP",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Bp","=","normalize","(","oy",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Bp","=","u_camera_direction",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Bn"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","su","=","max","(","_1_0","-","Bl",",","0.00001",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["su","=","gl_FrontFacing","==","false","?","su",":","_1_0","/","su",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["su","=","gl_FrontFacing","?","su",":","_1_0","/","su",";"]}]}]},{TYPE:"txt",TOKENS:["Bn","=","sv","(","Bp",",","cw",",","su",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["Bn","=","_0_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Bo"],STATEMENTS:[{TYPE:"txt",TOKENS:["Bo","=","abs","(","dot","(","Bp",",","cw",")",")",";","float","eA","=","Bl",";","if","(","eA","!=","_0_5",")","{","eA","=","clamp","(","eA",",","_0_0",",","0.99999",")",";","eA","=","(","eA","<","_0_5",")","?","2.0","*","eA",":","_0_5","/","(","_1_0","-","eA",")",";","Bo","=","pow","(","Bo",",","eA",")",";","}","Bo","=","_1_0","-","Bo",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["Bo","=","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"LIGHT_PATH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Bq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Br",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"By",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BA",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bq","=","Br","=","Bs","=","_0_0",";","Bt","=","Bu","=","Bv","=","_0_0",";","Bw","=","BA","=","By","=","Bz","=","_0_0",";","Bx","=","_0_0",";"]}]},{TYPE:"node",NAME:"ATTRIBUTE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"BB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BB","=","BC","=","vec3","(","_0_0",")",";","BD","=","_0_0",";"]}]},{TYPE:"node",NAME:"SCRIPT",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[]},{TYPE:"node",NAME:"CURVE_VEC",NODE_VARS:[{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BG",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BG","=","BF",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:["BG",".","r","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","BF",".","r","+","_0_5",",","NODE_TEX_ROW",")",")",".","r","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:["BG",".","g","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","BF",".","g","+","_0_5",",","NODE_TEX_ROW",")",")",".","g","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:["BG",".","b","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","BF",".","b","+","_0_5",",","NODE_TEX_ROW",")",")",".","b","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"txt",TOKENS:["BG","=","mix","(","BF",",","BG",",","BE",")",";"]}]},{TYPE:"node",NAME:"CURVE_RGB",NODE_VARS:[{TYPE:"node_var",NAME:"READ_A",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_A"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","r","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BI",".","r",",","NODE_TEX_ROW",")",")",".","a",";","float","g","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BI",".","g",",","NODE_TEX_ROW",")",")",".","a",";","float","b","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BI",".","b",",","NODE_TEX_ROW",")",")",".","a",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","r","=","BI",".","r",";","float","g","=","BI",".","g",";","float","b","=","BI",".","b",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","r","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","r",",","NODE_TEX_ROW",")",")",".","r",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","r","=","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","g","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","g",",","NODE_TEX_ROW",")",")",".","g",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","g","=","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","b","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","b",",","NODE_TEX_ROW",")",")",".","b",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","b","=","b",";"]}]}]},{TYPE:"txt",TOKENS:["BJ","=","mix","(","BI",",","BJ",",","BH",")",";"]}]},{TYPE:"node",NAME:"VALTORGB",NODE_VARS:[{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BK",",","NODE_TEX_ROW",")",")",";","BL","=","BN",".","rgb",";","BM","=","BN",".","a",";"]}]},{TYPE:"node",NAME:"MAPPING",NODE_VARS:[{TYPE:"node_var",NAME:"MAPPING_SCALE_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_SCALE",TOKENS:["vec3","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRANS_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRANS",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX",TOKENS:["mat4","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP",TOKENS:["vec3","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_IS_NORMAL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","BO",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_SCALE_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","BP","*","MAPPING_SCALE",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRANS_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","BP","+","MAPPING_TRANS",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRS_MATRIX_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","(","MAPPING_TRS_MATRIX","*","vec4","(","BP",",","_1_0",")",")",".","xyz",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MIN_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","max","(","BP",",","MAPPING_MIN_CLIP",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MAX_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","min","(","BP",",","MAPPING_MAX_CLIP",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_IS_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","normalize","(","BP",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ADD",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BS","=","BQ","+","BR",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BS","=","clamp","(","BS",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BV",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BV","=","BT","-","BU",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BV","=","clamp","(","BV",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BY","=","BW","*","BX",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BY","=","clamp","(","BY",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"B_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ca",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ca","=","(","B_","!=","_0_0",")","?","BZ","/","B_",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ca","=","clamp","(","Ca",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_SINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cd",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cd","=","sin","(","Cb",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cd","=","clamp","(","Cd",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cc",";"]}]},{TYPE:"node",NAME:"MATH_COSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ce",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cg",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cg","=","cos","(","Ce",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cg","=","clamp","(","Cg",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cf",";"]}]},{TYPE:"node",NAME:"MATH_TANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ch",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ci",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cj","=","tan","(","Ch",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cj","=","clamp","(","Cj",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Ci",";"]}]},{TYPE:"node",NAME:"MATH_ARCSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ck",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cm",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cm","=","(","Ck","<=","_1_0","&&","Ck",">=","-","_1_0",")","?","asin","(","Ck",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cm","=","clamp","(","Cm",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cl",";"]}]},{TYPE:"node",NAME:"MATH_ARCCOSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Co",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cp",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cp","=","(","Cn","<=","_1_0","&&","Cn",">=","-","_1_0",")","?","acos","(","Cn",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cp","=","clamp","(","Cp",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Co",";"]}]},{TYPE:"node",NAME:"MATH_ARCTANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cs",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cs","=","atan","(","Cq",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cs","=","clamp","(","Cs",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cr",";"]}]},{TYPE:"node",NAME:"MATH_POWER",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ct",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cv",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","Ct","<","_0_0","&&","Cu","!=","floor","(","Cu",")",")","Cv","=","_0_0",";","else","if","(","Cu","==","_0_0",")","Cv","=","_1_0",";","else","if","(","Ct","<","_0_0",")","Cv","=","mix","(","_1_0",",","-","_1_0",",","sign","(","mod","(","-","Cu",",","2.0",")",")",")","*","pow","(","-","Ct",",","Cu",")",";","else","if","(","Ct","==","_0_0",")","Cv","=","_0_0",";","else","Cv","=","pow","(","Ct",",","Cu",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cv","=","clamp","(","Cv",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_LOGARITHM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cy","=","(","Cw",">","_0_0","&&","Cx",">","_0_0",")","?","log2","(","Cw",")","/","log2","(","Cx",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cy","=","clamp","(","Cy",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MINIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CB","=","min","(","Cz",",","CA",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CB","=","clamp","(","CB",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MAXIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CE","=","max","(","CC",",","CD",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CE","=","clamp","(","CE",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ROUND",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CH",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CH","=","floor","(","CF","+","_0_5",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CH","=","clamp","(","CH",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["CG",";"]}]},{TYPE:"node",NAME:"MATH_LESS_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CK",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CK","=","(","CI","<","CJ",")","?","_1_0",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CK","=","clamp","(","CK",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_GREATER_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CN",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CN","=","(","CL",">","CM",")","?","_1_0",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CN","=","clamp","(","CN",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MODULO",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CQ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CQ","=","abs","(","CP",")",">","0.000001","?","mod","(","CO",",","CP",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CQ","=","clamp","(","CQ",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ABSOLUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CT",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CT","=","abs","(","CR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CT","=","clamp","(","CT",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["CS",";"]}]},{TYPE:"node",NAME:"MIX_RGB_MIX",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","CU",",","_0_0",",","_1_0",")",";","CX","=","mix","(","CV",",","CW",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CX","=","clamp","(","CX",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_ADD",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"C_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Da",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","CY",",","_0_0",",","_1_0",")",";","Da","=","mix","(","CZ",",","CZ","+","C_",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Da","=","clamp","(","Da",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Db",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"De",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Db",",","_0_0",",","_1_0",")",";","De","=","mix","(","Dc",",","Dc","*","Dd",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["De","=","clamp","(","De",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Df",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Di",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Df",",","_0_0",",","_1_0",")",";","Di","=","mix","(","Dg",",","Dg","-","Dh",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Di","=","clamp","(","Di",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SCREEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Dj",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","Dm","=","vec3","(","_1_0",")","-","(","vec3","(","Dn",")","+","AJ","*","(","vec3","(","_1_0",")","-","Dl",")",")","*","(","vec3","(","_1_0",")","-","Dk",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dm","=","clamp","(","Dm",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Do",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dr",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Do",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","Dq","+=","step","(","Dq",",","vec3","(","_0_0",")",")",";","Dr","=","Dn","*","Dp","+","AJ","*","Dp","/","Dq",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dr","=","clamp","(","Dr",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DIFFERENCE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ds",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Du",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dv",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Ds",",","_0_0",",","_1_0",")",";","Dv","=","mix","(","Dt",",","abs","(","Dt","-","Du",")",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dv","=","clamp","(","Dv",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DARKEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Dw",",","_0_0",",","_1_0",")",";","Dz","=","min","(","Dx",".","rgb",",","Dy",".","rgb","*","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dz","=","clamp","(","Dz",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LIGHTEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DA",",","_0_0",",","_1_0",")",";","DD","=","max","(","DB",".","rgb",",","DC",".","rgb","*","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DD","=","clamp","(","DD",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_OVERLAY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DH",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DE",",","_0_0",",","_1_0",")",";","vec3","DI","=","vec3","(","_1_0","-","AJ",")",";","DH","=","mix","(","DF","*","(","DI","+","2.0","*","AJ","*","DG",")",",","vec3","(","_1_0",")","-","(","DI","+","2.0","*","AJ","*","(","vec3","(","_1_0",")","-","DG",")",")","*","(","vec3","(","_1_0",")","-","DF",")",",","step","(","_0_5",",","DF",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DH","=","clamp","(","DH",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DODGE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DM",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DJ",",","_0_0",",","_1_0",")",";","vec3","DN","=","vec3","(","_1_0",")","-","AJ","*","DL",";","vec3","DO","=","clamp","(","DK","/","DN",",","_0_0",",","_1_0",")",";","DM","=","mix","(","mix","(","DO",",","vec3","(","_1_0",")",",","step","(","DN",",","vec3","(","_0_0",")",")",")",",","DK",",","step","(","DK",",","vec3","(","_0_0",")",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DM","=","clamp","(","DM",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_BURN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DP",",","_0_0",",","_1_0",")",";","vec3","ks","=","vec3","(","_1_0","-","AJ",")",";","vec3","DN","=","ks","+","AJ","*","DR",";","vec3","DO","=","clamp","(","vec3","(","_1_0",")","-","(","vec3","(","_1_0",")","-","DQ",")","/","DN",",","_0_0",",","_1_0",")",";","DS","=","mix","(","DO",",","vec3","(","_0_0",")",",","step","(","DN",",","vec3","(","_0_0",")",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DS","=","clamp","(","DS",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_HUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DW",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DT",",","_0_0",",","_1_0",")",";","vec3","kk",",","DX",",","DN",";","DW","=","DU",";","DX","=","kj","(","DV",")",";","if","(","DX",".","y","!=","_0_0",")","{","kk","=","kj","(","DW",")",";","kk",".","x","=","DX",".","x",";","DN","=","kl","(","kk",")",";","DW","=","mix","(","DW",",","DN",",","AJ",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DW","=","clamp","(","DW",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SATURATION",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"D_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ea",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DY",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","Ea","=","DZ",";","vec3","kk",",","DX",";","kk","=","kj","(","Ea",")",";","if","(","kk",".","y","!=","_0_0",")","{","DX","=","kj","(","D_",")",";","kk",".","y","=","Dn","*","kk",".","y","+","AJ","*","DX",".","y",";","Ea","=","kl","(","kk",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ea","=","clamp","(","Ea",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Eb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ec",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ed",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ee",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Eb",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","vec3","kk",",","DX",";","kk","=","kj","(","Ec",")",";","DX","=","kj","(","Ed",")",";","kk",".","z","=","Dn","*","kk",".","z","+","AJ","*","DX",".","z",";","Ee","=","kl","(","kk",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ee","=","clamp","(","Ee",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ef",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ei",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Ef",",","_0_0",",","_1_0",")",";","vec3","kk",",","DX",",","DN",";","Ei","=","Eg",";","DX","=","kj","(","Eh",")",";","if","(","DX",".","y","!=","_0_0",")","{","kk","=","kj","(","Ei",")",";","kk",".","x","=","DX",".","x",";","kk",".","y","=","DX",".","y",";","DN","=","kl","(","kk",")",";","Ei","=","mix","(","Ei",",","DN",",","AJ",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ei","=","clamp","(","Ei",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SOFT_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ej",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ek",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"El",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Em",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Ej",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","vec3","En","=","El","+","Ek","-","El","*","Ek",";","Em","=","Ek","*","(","vec3","(","Dn",")","+","vec3","(","AJ",")","*","(","(","vec3","(","_1_0",")","-","Ek",")","*","El","+","En",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Em","=","clamp","(","Em",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LINEAR_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Eo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ep",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Er",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Eo",",","_0_0",",","_1_0",")",";","Er","=","Ep","+","AJ","*","(","2.0","*","Eq","-","vec3","(","_1_0",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Er","=","clamp","(","Er",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_WORLD_RGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Es",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Et",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ev",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Es",",","_0_0",",","_1_0",")",";","Ev","=","mix","(","Et",",","Eu",",","AJ",")",";"]}]},{TYPE:"node",NAME:"ADD_WORLD_RGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ew",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ex",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ey",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ez",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Ew",",","_0_0",",","_1_0",")",";","Ez","=","mix","(","Ex",",","Ex","+","Ey",",","AJ",")",";"]}]},{TYPE:"node",NAME:"OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","EA",";","I","=","EB",";"]}]},{TYPE:"node",NAME:"OUTPUT_SURFACE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ED",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","EC",";","I","=","ED",";"]}]},{TYPE:"node",NAME:"OUTPUT_WORLD_SURFACE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EE",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","EE",";","I","=","_1_0",";"]}]},{TYPE:"node",NAME:"MATERIAL_BEGIN",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_NORMAL",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",TOKENS:["0"]},{TYPE:"node_var",NAME:"SHADELESS_MAT",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"EF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EI",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EJ",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EP",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EQ",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ER",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sF",QUALIFIER:["const","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sG",QUALIFIER:["const","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EM","=","EF",";","EN","=","sG","[","0","]","*","EG",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["EO","=","normalize","(","EI",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EO","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["SHADELESS_MAT",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:["EK","=","EJ","*","EM",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EK","=","sS","*","EM",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:["EM","*=","EH",";"]}]}]},{TYPE:"txt",TOKENS:["EL","=","sT","*","u_environment_energy","*","cE","(","EO",")",";","ER","=","cH","(","EM",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["EP","=","vec2","(","sF","[","0","]",",","sF","[","1","]",")",";","EQ","=","vec2","(","sG","[","1","]",",","sG","[","2","]",")",";"]}]}]},{TYPE:"txt",TOKENS:["H","=","ER",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EK","=","vec3","(","_0_0",")",";","EL","=","vec3","(","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATERIAL_END",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_SPECULAR",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"ES",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ET",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EV",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EW",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EX",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EY",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EZ",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"E_",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fa",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fb",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EY"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:["EY","=","ES",".","rgb",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EY","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{TYPE:"non_equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_TYPE","REFL_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["cQ","(","EY",",","oy",",","EU",",","EV",",","u_view_tsr_frag",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["cQ","(","EY",",","oy",",","EU",",","EV",",","mat3","(","_0_0",")",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["EY","+=","ET",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_E_"],STATEMENTS:[{TYPE:"txt",TOKENS:["E_","=","EU",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fa"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fa","=","ES",".","rgb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fb"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fb","=","ET",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["EZ","=","clamp","(","EX",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","ET",".","r",",","ET",".","g",")",",","ET",".","b",")","*","EW",";","EZ","=","clamp","(","EX","*","(","_1_0","-","t",")","+","t",",","_0_0",",","_1_0",")",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["EZ","=","clamp","(","sH",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","ET",".","r",",","ET",".","g",")",",","ET",".","b",")","*","sI",";","EZ","=","sH","*","(","_1_0","-","t",")","+","t",";"]}]}]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["F","=","ET",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["F","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["G","=","EU",";"]}]},{TYPE:"node",NAME:"LIGHTING_AMBIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"oP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oS",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oS","=","vec4","(","oP","+","oR","*","oQ",",","_0_0",")",";","oT","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LIGHTING_LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]},{TYPE:"node_var",NAME:"LAMP_SHADOW_MAP_IND",TOKENS:["-","1"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oW",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oW","=","vec2","(","u_light_positions","[","LAMP_IND","]",".","w",",","u_light_color_intensities","[","LAMP_IND","]",".","w",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","HEMI",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_5",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_0",";"]}]}]},{TYPE:"txt",TOKENS:["oX","=","u_light_color_intensities","[","LAMP_IND","]",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_SHADOW_MAP_IND",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oX","*=","oU","[","LAMP_SHADOW_MAP_IND","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","oZ","=","u_light_positions","[","LAMP_IND","]",".","xyz",";","oV","=","oZ","-","ow",";","float","aM","=","length","(","oV",")",";","oX","*=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","aM","*","aM",")",";","oV","=","normalize","(","oV",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pa","=","u_light_directions","[","LAMP_IND","]",";","float","pb","=","dot","(","oV",",","pa",")",";","pb","*=","smoothstep","(","_0_0",",","_1_0",",","(","pb","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","oX","*=","pb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:["oX","*=","max","(","LAMP_LIGHT_DIST","-","aM",",","_0_0",")","/","LAMP_LIGHT_DIST",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oV","=","u_light_directions","[","LAMP_IND","]",";"]}]}]}]},{TYPE:"node",NAME:"DIFFUSE_FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pd",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pg",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ph",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","pe",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pc",",","B",".","xyz",")",";","rz","=","cross","(","pi",",","B",".","xyz",")",";","rz","=","-","normalize","(","rz",")",";"]}]}]},{TYPE:"txt",TOKENS:["ph","=","_0_0",";","if","(","pd",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pf",")","*","dot","(","rz",",","pc",")","+","pf",";","if","(","pg","[","0","]","==","_0_0",")","{","ph","=","_1_0",";","}","else","{","float","t","=","_1_0","+","abs","(","pj",")",";","t","=","pg","[","1","]","+","(","_1_0","-","pg","[","1","]",")","*","pow","(","t",",","pg","[","0","]",")",";","ph","=","clamp","(","t",",","_0_0",",","_1_0",")",";","}","ph","=","max","(","ph",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_LAMBERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pl",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"po",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","pm",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pk",",","B",".","xyz",")",";","rz","=","cross","(","pi",",","B",".","xyz",")",";","rz","=","-","normalize","(","rz",")",";"]}]}]},{TYPE:"txt",TOKENS:["po","=","_0_0",";","if","(","pl",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pn",")","*","dot","(","rz",",","pk",")","+","pn",";","po","=","max","(","pj",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_OREN_NAYAR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pu",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"px",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"py",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","pv",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pr",",","B",".","xyz",")",";","rz","=","cross","(","pi",",","B",".","xyz",")",";","rz","=","-","normalize","(","rz",")",";"]}]}]},{TYPE:"txt",TOKENS:["py","=","_0_0",";","if","(","pu",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pw",")","*","dot","(","rz",",","pr",")","+","pw",";","if","(","px","[","0","]",">","_0_0",")","{","float","pz","=","max","(","dot","(","rz",",","oy",")",",","_0_0",")",";","float","pA","=","px","[","0","]","*","px","[","0","]",";","float","cG","=","_1_0","-","_0_5","*","(","pA","/","(","pA","+","0.33",")",")",";","vec3","pB","=","pr","-","pj","*","rz",";","vec3","pC","=","oy","-","pz","*","rz",";","if","(","length","(","pB",")","==","_0_0","||","length","(","pC",")","==","_0_0","||","abs","(","pj",")",">","_1_0","||","abs","(","pz",")",">","_1_0",")","py","=","pj","*","cG",";","else","{","float","pD","=","acos","(","pj",")",";","float","pE","=","acos","(","pz",")",";","vec3","pF","=","normalize","(","pB",")",";","vec3","pG","=","normalize","(","pC",")",";","float","a",",","b",";","a","=","max","(","pD",",","pE",")",";","b","=","min","(","pD",",","pE",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pF",",","pG",")",",","_0_0",")",";","float","hS","=","0.45","*","(","pA","/","(","pA","+","0.09",")",")",";","py","=","pj","*","(","cG","+","(","hS","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","else","py","=","pj",";","py","=","max","(","py",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_MINNAERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pI",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pL",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","pJ",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pH",",","B",".","xyz",")",";","rz","=","cross","(","pi",",","B",".","xyz",")",";","rz","=","-","normalize","(","rz",")",";"]}]}]},{TYPE:"txt",TOKENS:["pM","=","_0_0",";","if","(","pI",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pK",")","*","dot","(","rz",",","pH",")","+","pK",";","float","pz","=","max","(","dot","(","rz",",","oy",")",",","_0_0",")",";","if","(","pL","[","0","]","<=","_1_0",")","pM","=","pj","*","pow","(","max","(","pz","*","pj",",","0.1",")",",","pL","[","0","]","-","_1_0",")",";","else","pM","=","pj","*","pow","(","1.0001","-","pz",",","pL","[","0","]","-","_1_0",")",";","pM","=","max","(","pM",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pO",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pR",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","pP",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pN",",","B",".","xyz",")",";","rz","=","cross","(","pi",",","B",".","xyz",")",";","rz","=","-","normalize","(","rz",")",";"]}]}]},{TYPE:"txt",TOKENS:["pS","=","_0_0",";","if","(","pO",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pQ",")","*","dot","(","rz",",","pN",")","+","pQ",";","float","pT","=","acos","(","pj",")",";","if","(","pT","<","pR","[","0","]",")","pS","=","_1_0",";","else","if","(","pT",">","(","pR","[","0","]","+","pR","[","1","]",")","||","pR","[","1","]","==","_0_0",")","pS","=","_0_0",";","else","pS","=","_1_0","-","(","(","pT","-","pR","[","0","]",")","/","pR","[","1","]",")",";","pS","=","max","(","pS",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_PHONG",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pV",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pY",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pZ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["pZ","=","_0_0",";","if","(","pV",".","g","==","_1_0",")","{","vec3","p_","=","normalize","(","pU","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","pX","==","_0_0",")","{","pZ","=","dot","(","B",".","xyz",",","p_",")",";","pZ","=","sqrt","(","_1_0","-","pZ","*","pZ",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["pZ","=","(","_1_0","-","pX",")","*","max","(","dot","(","pW",",","p_",")",",","_0_0",")","+","pX",";"]}]}]},{TYPE:"txt",TOKENS:["pZ","=","pow","(","pZ",",","pY","[","0","]",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_COOKTORR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qb",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qe",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qf",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qf","=","_0_0",";","if","(","qb",".","g","!=","_0_0",")","{","vec3","p_","=","normalize","(","qa","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","qd","==","_0_0",")","{","qf","=","dot","(","B",".","xyz",",","p_",")",";","qf","=","sqrt","(","_1_0","-","qf","*","qf",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qf","=","max","(","dot","(","qc",",","p_",")",",","_0_0",")",";","qf","=","(","_1_0","-","qd",")","*","qf","+","qd",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","pz","=","max","(","dot","(","B",".","xyz",",","oy",")",",","_0_0",")",";","pz","=","sqrt","(","_1_0","-","pz","*","pz",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","pz","=","max","(","dot","(","qc",",","oy",")",",","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["qf","=","pow","(","qf",",","qe","[","0","]",")",";","qf","=","qf","/","(","0.1","+","pz",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_WARDISO",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qh",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qk",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ql",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ql","=","_0_0",";","if","(","qh",".","g","==","_1_0",")","{","vec3","p_","=","normalize","(","qg","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","_0_0",";","float","pz","=","_0_0",";","float","qn","=","_0_0",";","if","(","qj","==","_0_0",")","{","qm","=","dot","(","B",".","xyz",",","p_",")",";","pz","=","dot","(","B",".","xyz",",","oy",")",";","qn","=","dot","(","B",".","xyz",",","qg",")",";","qm","=","sqrt","(","_1_0","-","qm","*","qm",")",";","pz","=","sqrt","(","_1_0","-","pz","*","pz",")",";","qn","=","sqrt","(","_1_0","-","qn","*","qn",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","max","(","dot","(","qi",",","p_",")",",","0.01",")",";","float","pz","=","max","(","dot","(","qi",",","oy",")",",","0.01",")",";","float","qn","=","max","(","dot","(","qi",",","qg",")",",","0.01",")",";"]}]}]},{TYPE:"txt",TOKENS:["float","bP","=","tan","(","acos","(","qm",")",")",";","float","L","=","max","(","qk","[","0","]",",","0.01",")",";","ql","=","qn","*","(","_1_0","/","(","4.0","*","M_PI","*","L","*","L",")",")","*","(","exp","(","-","(","bP","*","bP",")","/","(","L","*","L",")",")","/","(","sqrt","(","pz","*","qn",")",")",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qr",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qw",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qx",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qx","=","_0_0",";","if","(","qr",".","g","==","_1_0",")","{","vec3","co","=","normalize","(","qo","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qy","=","dot","(","co",",","B",".","xyz",")",";","float","bP","=","qw","[","0","]","+","qw","[","1","]",";","if","(","qv","==","_0_0",")","bP","=","acos","(","sqrt","(","_1_0","-","qy","*","qy",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","bP","=","acos","(","dot","(","co",",","qu",")",")",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","bP","<","qw","[","0","]",")","qx","=","_1_0",";","else","if","(","bP",">=","qw","[","0","]","+","qw","[","1","]","||","qw","[","1","]","==","_0_0",")","qx","=","_0_0",";","else","qx","=","_1_0","-","(","bP","-","qw","[","0","]",")","/","qw","[","1","]",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_BLINN",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qA",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qD",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qF","=","qD","[","0","]",";","float","qG","=","qD","[","1","]",";","qE","=","_0_0",";","if","(","qA",".","g","==","_1_0",")","{","if","(","qF","<","_1_0","||","qG","==","_0_0",")","qE","=","_0_0",";","else","{","if","(","qG","<","100.0",")","qG","=","sqrt","(","_1_0","/","qG",")",";","else","qG","=","10.0","/","qG",";","vec3","p_","=","normalize","(","oy","+","qz",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","_0_0",";","if","(","qC","==","_0_0",")","{","float","qH","=","dot","(","B",".","xyz",",","p_",")",";","qm","=","sqrt","(","_1_0","-","qH","*","qH",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","(","_1_0","-","qC",")","*","max","(","dot","(","qB",",","p_",")",",","_0_0",")","+","qC",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","qm","<","_0_0",")","qE","=","_0_0",";","else","{","float","pz","=","max","(","dot","(","qB",",","oy",")",",","0.01",")",";","float","qn","=","dot","(","qB",",","qz",")",";","if","(","qn","<=","0.01",")","qE","=","_0_0",";","else","{","float","qI","=","max","(","dot","(","oy",",","p_",")",",","0.01",")",";","float","a","=","_1_0",";","float","b","=","(","2.0","*","qm","*","pz",")","/","qI",";","float","dx","=","(","2.0","*","qm","*","qn",")","/","qI",";","float","g","=","min","(","min","(","a",",","b",")",",","dx",")",";","float","p","=","sqrt","(","pow","(","qF",",","2.0",")","+","pow","(","qI",",","2.0",")","-","_1_0",")",";","float","mm","=","pow","(","p","-","qI",",","2.0",")","/","pow","(","p","+","qI",",","2.0",")","*","(","_1_0","+","pow","(","qI","*","(","p","+","qI",")","-","_1_0",",","2.0",")","/","pow","(","qI","*","(","p","-","qI",")","+","_1_0",",","2.0",")",")",";","float","pT","=","acos","(","qm",")",";","qE","=","max","(","mm","*","g","*","exp","(","-","pow","(","pT",",","2.0",")","/","(","2.0","*","pow","(","qG",",","2.0",")",")",")",",","_0_0",")",";","}","}","}","}"]}]},{TYPE:"node",NAME:"LIGHTING_APPLY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qJ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qP",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_B4W_TRANSLUCENCY"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","dot","(","qN",",","qO",")","*","dot","(","oy",",","qO",")","<","_0_0",")","{","float","Fc","=","qP",".","x",";","float","Fd","=","qP",".","y",";","float","Fe","=","qP",".","z",";","float","Ff","=","qP",".","w",";","float","Fg","=","clamp","(","abs","(","dot","(","qN",",","qO",")",")",",","_0_0",",","_1_0",")",";","float","Fh","=","clamp","(","dot","(","oy",",","-","qN",")",",","_0_0",",","_1_0",")",";","float","Fi","=","pow","(","Fh",",","Fd",")",";","qU","=","qJ","+","qT","*","vec4","(","qS","*","Fg","*","pow","(","qQ",",","vec3","(","Fc",")",")",",","_1_0",")",";","qU","+=","Fe","*","mix","(","vec4","(","qQ",",","_1_0",")",",","vec4","(","_1_0",")",",","Ff",")","*","qT","*","vec4","(","qS","*","Fg","*","vec3","(","Fi",")",",","_1_0",")",";","}","else","{","qU","=","qJ","+","vec4","(","qS","*","qQ","*","qL",",","qM",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qU","=","qJ","+","vec4","(","qS","*","qQ","*","qL",",","qM",")",";"]}]}]},{TYPE:"txt",TOKENS:["qV","=","qK","+","qS","*","qR","*","qM",";"]}]},{TYPE:"node",NAME:"RGB",NODE_VARS:[{TYPE:"node_var",NAME:"RGB_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Fj",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Fj","=","u_node_rgbs","[","RGB_IND","]",";"]}]},{TYPE:"node",NAME:"RGBTOBW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fl",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Fl","=","dot","(","Fk",",","vec3","(","0.35",",","0.45",",","0.2",")",")",";"]}]},{TYPE:"node",NAME:"SEPRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fn",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fo",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fp",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fn"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fn","=","Fm",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fo"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fo","=","Fm",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fp"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fp","=","Fm",".","b",";"]}]}]}]},{TYPE:"node",NAME:"SEPHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fr",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fs",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ft",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Fu","=","kj","(","Fq",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fr"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fr","=","Fu",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fs"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fs","=","Fu",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ft"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ft","=","Fu",".","b",";"]}]}]}]},{TYPE:"node",NAME:"SQUEEZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Fw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Fx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Fy","=","_1_0","/","(","_1_0","+","pow","(","2.71828183",",","-","(","Fv","-","Fx",")","*","Fw",")",")",";"]}]},{TYPE:"node",NAME:"GAMMA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FB",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["FB","=","Fz",";","if","(","FB",".","x",">","_0_0",")","FB",".","x","=","pow","(","Fz",".","x",",","FA",")",";","if","(","FB",".","y",">","_0_0",")","FB",".","y","=","pow","(","Fz",".","y",",","FA",")",";","if","(","FB",".","z",">","_0_0",")","FB",".","z","=","pow","(","Fz",".","z",",","FA",")",";"]}]},{TYPE:"node",NAME:"B4W_SRGB_TO_LINEAR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["FD","=","max","(","vec3","(","_0_0",")",",","FC",")",";","FD","=","pow","(","FD",",","vec3","(","2.2",")",")",";"]}]},{TYPE:"node",NAME:"B4W_LINEAR_TO_SRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FF",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["FF","=","max","(","vec3","(","_0_0",")",",","FE",")",";","FF","=","pow","(","FF",",","vec3","(","_1_0","/","2.2",")",")",";"]}]},{TYPE:"node",NAME:"TEXTURE_EMPTY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"FG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FG"],STATEMENTS:[{TYPE:"txt",TOKENS:["FG","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FH"],STATEMENTS:[{TYPE:"txt",TOKENS:["FH","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FI"],STATEMENTS:[{TYPE:"txt",TOKENS:["FI","=","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT_CUBE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FK",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FL",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_CUBE_var_texture",QUALIFIER:["uniform","samplerCube"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FM","=","vec3","(","FJ",".","x",",","FJ",".","y",",","FJ",".","z",")",";","vec4","BN","=","GLSL_TEXTURE_CUBE","(","node_TEXTURE_ENVIRONMENT_CUBE_var_texture",",","FM",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FK"],STATEMENTS:[{TYPE:"txt",TOKENS:["FK","=","BN",".","xyz",";","bG","(","FK",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FL"],STATEMENTS:[{TYPE:"txt",TOKENS:["FL","=","BN",".","w",";"]}]}]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR",NODE_VARS:[{TYPE:"node_var",NAME:"USE_VECTOR_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"FN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_VECTOR_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","normalize","(","FN",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["IS_WORLD"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","sJ",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:["float","dF","=","-","atan","(","FP",".","y",",","FP",".","x",")","/","(","2.0","*","M_PI",")","+","_0_5",";","float","kU","=","atan","(","FP",".","z",",","sqrt","(","FP",".","x","*","FP",".","x","+","FP",".","y","*","FP",".","y",")",")","/","M_PI","+","_0_5",";","vec4","BN","=","GLSL_TEXTURE","(","node_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR_var_texture",",","vec2","(","dF",",","kU",")",")",";","FO","=","BN",".","xyz",";","bG","(","FO",")",";"]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT_MIRROR_BALL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_VECTOR_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"FQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_MIRROR_BALL_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_VECTOR_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","normalize","(","FQ",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["IS_WORLD"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","sJ",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","FP","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:["FP",".","y","-=","_1_0",";","float","FS","=","2.0","*","sqrt","(","max","(","-","_0_5","*","FP",".","y",",","_0_0",")",")",";","if","(","FS",">","_0_0",")","FP","/=","FS",";","float","dF","=","_0_5","*","(","FP",".","x","+","_1_0",")",";","float","kU","=","_0_5","*","(","FP",".","z","+","_1_0",")",";","vec4","BN","=","GLSL_TEXTURE","(","node_TEXTURE_ENVIRONMENT_MIRROR_BALL_var_texture",",","vec2","(","dF",",","kU",")",")",";","FR","=","BN",".","xyz",";","bG","(","FR",")",";"]}]},{TYPE:"node",NAME:"TEXTURE_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"NON_COLOR",TOKENS:["0"]},{TYPE:"node_var",NAME:"CONVERT_UV",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"FT",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FU",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FV",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FW",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FX",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FY",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FZ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"F_",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ga",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gb",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gc",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gd",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_COLOR_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FT",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","FT",".","xy",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FX"],STATEMENTS:[{TYPE:"txt",TOKENS:["FX","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","FX",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FY"],STATEMENTS:[{TYPE:"txt",TOKENS:["FY","=","BN",".","w",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FU",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","FU",".","xy",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["FZ","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","FZ",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_F_"],STATEMENTS:[{TYPE:"txt",TOKENS:["F_","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FV",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","FV",".","xy",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ga"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ga","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","Ga",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gb"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gb","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_UV"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FW",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","FW",".","xy",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gc"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gc","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","Gc",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gd"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gd","=","BN",".","w",";"]}]}]}]}]}]},{TYPE:"node",NAME:"TEXTURE_NORMAL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ge",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gf",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gg",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gh",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gi",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gj",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gk",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gl",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gm",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gn",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Go",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gp",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_NORMAL_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Ge",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gi"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gi","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gj"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gj","=","BN",".","w",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Gf",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gk"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gk","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gl"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gl","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Gg",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gm"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gm","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gn"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gn","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Gh",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Go"],STATEMENTS:[{TYPE:"txt",TOKENS:["Go","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gp"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gp","=","BN",".","w",";"]}]}]}]}]}]},{TYPE:"node",NAME:"VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"VALUE_ROW_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"VALUE_COL_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Gq",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gq","=","u_node_values","[","VALUE_ROW_IND","]","[","VALUE_COL_IND","]",";"]}]},{TYPE:"node",NAME:"VECT_MATH_ADD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gu",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gt","=","Gr","+","Gs",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gu"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gu","=","(","abs","(","Gt","[","0","]",")","+","abs","(","Gt","[","1","]",")","+","abs","(","Gt","[","2","]",")",")","/","3.0",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_SUBTRACT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gy",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gx","=","Gv","-","Gw",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gy"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gy","=","(","abs","(","Gx","[","0","]",")","+","abs","(","Gx","[","1","]",")","+","abs","(","Gx","[","2","]",")",")","/","3.0",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_AVERAGE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GC",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GB","=","Gz","+","GA",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GC"],STATEMENTS:[{TYPE:"txt",TOKENS:["GC","=","length","(","GB",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GB"],STATEMENTS:[{TYPE:"txt",TOKENS:["GB","=","normalize","(","GB",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_DOT_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GG",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GF","=","vec3","(","_0_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GG"],STATEMENTS:[{TYPE:"txt",TOKENS:["GG","=","dot","(","GD",",","GE",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_CROSS_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GK",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GJ","=","cross","(","GH",",","GI",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GK"],STATEMENTS:[{TYPE:"txt",TOKENS:["GK","=","length","(","GJ",")",";","GJ","/=","GK",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["GJ","=","normalize","(","GJ",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_NORMALIZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GO",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GN","=","normalize","(","GL",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GO"],STATEMENTS:[{TYPE:"txt",TOKENS:["GO","=","length","(","GL",")",";"]}]}]},{TYPE:"txt",TOKENS:["GM",";"]}]},{TYPE:"node",NAME:"FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_FRESNEL_NORMAL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"GP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GR",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_FRESNEL_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","cw","=","normalize","(","GQ",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","cw","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CAMERA_TYPE","CAM_TYPE_PERSP",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Bp","=","normalize","(","oy",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Bp","=","u_camera_direction",";"]}]}]},{TYPE:"txt",TOKENS:["float","su","=","max","(","GP",",","0.00001",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["su","=","gl_FrontFacing","==","false","?","su",":","_1_0","/","su",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["su","=","gl_FrontFacing","?","su",":","_1_0","/","su",";"]}]}]},{TYPE:"txt",TOKENS:["GR","=","sv","(","Bp",",","cw",",","su",")",";"]}]},{TYPE:"node",NAME:"BACKGROUND",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GU",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GU","=","GS","*","GT",";"]}]},{TYPE:"node",NAME:"B4W_REFLECT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GX","=","reflect","(","_","(","u_view_tsr_inverse",",","GV",")",",","GW",")",";"]}]},{TYPE:"node",NAME:"B4W_REFLECT_WORLD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GZ","=","reflect","(","-","oy",".","xyz",",","GY",")",";"]}]},{TYPE:"node",NAME:"B4W_PARALLAX",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"G_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ha",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hb",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hc",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_B4W_PARALLAX_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","bS","=","length","(","sR",")",";","if","(","bS","<","Hc",")","{","vec2","ce","=","so","(","G_",")",";","float","ci","=","clamp","(","_0_5","*","(","Hc","-","bS",")",",","_0_0",",","_1_0",")",";","float","hK","=","Ha","*","ci",";","vec3","ck","=","normalize","(","oy","*","sO",")",";","float","cl","=","_1_0","/","Hb",";","vec2","cm","=","ck",".","xy","*","hK","/","(","Hb","*","ck",".","z",")",";","float","cn","=","_1_0",";","float","co","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","ce",")",".","a",";","for","(","float","cq","=","1.0",";","cq","<=","Hb",";","cq","++",")","{","if","(","co","<","cn",")","{","cn","-=","cl",";","ce","-=","cm",";","co","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","ce",")",".","a",";","}","}","vec2","cr","=","ce","+","cm",";","float","cs","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","cr",")",".","a","-","(","cn","+","cl",")",";","float","ct","=","co","-","cn",";","float","cu","=","ct","/","(","ct","-","cs",")",";","ce","=","cu","*","cr","+","(","_1_0","-","cu",")","*","ce",";","Hd","=","sn","(","ce",")",";","}","else","Hd","=","G_",";"]}]},{TYPE:"node",NAME:"B4W_CLAMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"He",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hf","=","clamp","(","He",",","_0_0",",","_1_0",")",";"]}]},{TYPE:"node",NAME:"B4W_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hi","=","sm","(","Hg",",","Hh",")",";"]}]},{TYPE:"node",NAME:"B4W_TRANSLUCENCY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ho",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Hp",QUALIFIER:["vec4"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ho"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ho","=","Hj",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Hp"],STATEMENTS:[{TYPE:"txt",TOKENS:["Hp","=","vec4","(","Hk",",","Hl",",","Hm",",","Hn",")",";"]}]}]}]},{TYPE:"node",NAME:"B4W_TIME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Hq",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hq","=","u_time",";"]}]},{TYPE:"node",NAME:"B4W_SMOOTHSTEP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ht",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hu",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hu","=","smoothstep","(","Hs",",","Ht",",","Hr",")",";"]}]},{TYPE:"node",NAME:"B4W_GLOW_OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hw",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","Hv",";","I","=","Hw",";"]}]},{TYPE:"node",NAME:"B4W_VECTOSCAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hy","=","(","Hx",".","r","+","Hx",".","g","+","Hx",".","b",")","/","3.0",";"]}]},{TYPE:"node",NAME:"B4W_SCALTOVEC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"HA",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HA","[","0","]","=","Hz",";","HA","[","1","]","=","Hz",";","HA","[","2","]","=","Hz",";"]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","J","(","in","vec3","oy",",","out","vec3","E",",","out","vec3","F",",","out","vec3","G",",","out","vec4","H",",","out","float","I",")","{","E","=","vec3","(","_0_0",")",";","F","=","vec3","(","_0_0",")",";","G","=","vec3","(","_0_0",")",";","H","=","vec4","(","_0_0",")",";","I","=","_0_0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["IS_WORLD"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","USE_NODE_TEXTURE_ENVIRONMENT_MIRROR_BALL","USE_NODE_TEX_COORD_GE","USE_NODE_TEX_COORD_OB",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sJ","=","-","oy",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_GL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ow","=","-","oy",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEX_COORD_NO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ox","=","oy",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_NO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sK","=","oy",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:11}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sL","=","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing","==","false",")"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing",")"]}]}}]},{TYPE:"txt",TOKENS:["sL","=","sL",";","else","sL","=","-","sL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sM","=","sL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sN","=","normalize","(","sL",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ox","=","sN",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ox","=","normalize","(","j",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_NO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sK","=","sN",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","W","=","cross","(","sN",",","k",".","xyz",")","*","k",".","w",";","mat3","sO","=","mat3","(","k",".","xyz",",","W",",","sN",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sP","=","cross","(","sL",",","k",".","xyz",")","*","k",".","w",";","mat3","sQ","=","mat3","(","k",".","xyz",",","sP",",","sL",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec3","ow","=","h",";","vec4","sR","=","i",";","float","sS","=","u_emit",";","float","sT","=","u_ambient",";"]}]}}]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/nodes.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"NODES_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"NODES_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"PARTICLE_BATCH",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2},"PARTICLE_BATCH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["GLSL_IN","vec3","a_orco_tex_coord",";","GLSL_OUT","vec3","sj",";"]}]}}]},{TYPE:"node",NAME:"TEX_COORD_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_TEX_COORD_UV_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sD",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sD","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_UV_MERGED_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sC",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sC","=","node_UV_MERGED_var_a_uv",";"]}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_UVMAP_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sE",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sE","=","node_UVMAP_var_a_uv",";"]}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_UV_var_a_uv",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sw",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["sw","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC_var_a_vertex_color",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"HB",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HB","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC1",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC1_var_a_vertex_color",QUALIFIER:["GLSL_IN","float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"HC",QUALIFIER:["GLSL_OUT","float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HC","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC2",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC2_var_a_vertex_color",QUALIFIER:["GLSL_IN","vec2"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"HD",QUALIFIER:["GLSL_OUT","vec2"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HD","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC3",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_param",NAME:"node_GEOMETRY_VC3_var_a_vertex_color",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"HE",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HE","=","node_GEOMETRY_VC3_var_a_vertex_color",";"]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","J","(",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sj","=","a_orco_tex_coord",";"]}]}}]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/pack.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PACK_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PACK_GLSLF",TOKENS:[""]},{TYPE:"txt",TOKENS:["vec4","eu","(","const","in","float","iq",")","{","vec4","fu","=","vec4","(","_255_0","*","_255_0","*","_255_0",",","_255_0","*","_255_0",",","_255_0",",","_1_0",")",";","vec4","HF","=","vec4","(","_0_0",",","_1_0","/","_255_0",",","_1_0","/","_255_0",",","_1_0","/","_255_0",")",";","vec4","jF","=","fract","(","iq","*","fu",")",";","jF","-=","jF",".","xxyz","*","HF",";","return","jF",";","}","float","cV","(","const","in","vec4","HG",")","{","float","et",";","vec4","fu","=","vec4","(","_1_0","/","(","_255_0","*","_255_0","*","_255_0",")",",","_1_0","/","(","_255_0","*","_255_0",")",",","_1_0","/","_255_0",",","_1_0",")",";","et","=","dot","(","HG",",","fu",")",";","return","et",";","}","vec4","eu","(","const","in","vec2","rk",")","{","vec2","fu","=","vec2","(","_255_0",",","_1_0",")",";","vec2","HF","=","vec2","(","_0_0",",","_1_0","/","_255_0",")",";","vec4","jF","=","fract","(","rk",".","xxyy","*","fu",".","xyxy",")",";","jF","-=","jF",".","xxzz","*","HF",".","xyxy",";","if","(","rk",".","r","==","_1_0",")","jF",".","rg","=","vec2","(","_0_0",",","_1_0",")",";","if","(","rk",".","g","==","_1_0",")","jF",".","ba","=","vec2","(","_0_0",",","_1_0",")",";","return","jF",";","}","vec2","jk","(","const","in","vec4","HH",")","{","vec2","rk",";","vec2","fu","=","vec2","(","_1_0","/","_255_0",",","_1_0",")",";","rk",".","r","=","dot","(","HH",".","rg",",","fu",")",";","rk",".","g","=","dot","(","HH",".","ba",",","fu",")",";","return","rk",";","}"]}]}}]}]},e["include/particles.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PARTICLES_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PARTICLES_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"EPSILON",TOKENS:["0.000001"]},{TYPE:"var",NAME:"COLOR_RAMP_LENGTH",TOKENS:["0"]},{TYPE:"var",NAME:"WORLD_SPACE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_COLOR_RAMP",TOKENS:["0"]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["struct","dc","{","float","di",";","vec3","O",";","float","L",";","vec3","aQ",";","float","bP",";","vec3","dp",";","vec3","dq",";","float","dr",";","}",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","HL","(","inout","vec3","aQ",",","float","HI",",","vec4","kf",",","vec4","bz",")","{","float","HJ","=","bz",".","x","-","kf",".","x",";","float","HK","=","(","HI","-","kf",".","x",")","/","HJ",";","aQ","=","mix","(","aQ",",","bz",".","yzw",",","clamp","(","HK",",","0.0",",","1.0",")",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","HO","(","float","t",",","float","HM",",","vec4","HN","[","COLOR_RAMP_LENGTH","]",")","{","float","HI","=","t","/","HM",";","vec3","aQ","=","HN","[","0","]",".","yzw",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["HL","(","aQ",",","HI",",","HN","[","0","]",",","HN","[","1","]",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["HL","(","aQ",",","HI",",","HN","[","1","]",",","HN","[","2","]",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["HL","(","aQ",",","HI",",","HN","[","2","]",",","HN","[","3","]",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","aQ",";","}"]}]}}]},{TYPE:"txt",TOKENS:["float","HU","(","float","t",",","float","HM",",","float","HP",",","float","HQ",")","{","float","HR","=","max","(","0.01",",","min","(","HM",",","HP",")",")",";","float","HS","=","max","(","0.01",",","min","(","HM",",","HQ",")",")",";","float","HT","=","HM","-","HS",";","float","L","=","clamp","(","t","/","HR",",","0.0",",","1.0",")","-","step","(","HT",",","t",")","*","(","t","-","HT",")","/","HS",";","return","L",";","}","dc","dd","(",")","{","dc","sp",";","float","t",";","float","HM","=","a_p_data","[","0","]",";","float","HV","=","a_p_data","[","1","]",";","if","(","u_p_cyclic","==","1",")","{","t","=","mod","(","u_p_time",",","u_p_length",")","-","HV",";","if","(","t","<","0.0",")","t","+=","u_p_length",";","}","if","(","u_p_cyclic","!=","1",")","{","t","=","u_p_time","-","HV",";","}","if","(","t","<","0.0","||","t",">=","HM",")","{","sp",".","di","=","0.0001",";","sp",".","O","=","vec3","(","99999.0",",","0.0",",","0.0",")",";","}","if","(","!","(","t","<","0.0","||","t",">=","HM",")",")","{","vec4","S","=","R","(","a_tbn",")",";","vec3","ca","=","T","(","S",",","vec3","(","0.0",",","1.0",",","0.0",")",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WORLD_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fr","=","a_position",";","vec3","rz","=","ca",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","fr","=","ap","(","u_model_tsr",",","a_position",")",";","vec3","rz","=","bI","(","u_model_tsr",",","ca",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","HW","=","u_p_nfactor","*","rz",";","HW","+=","a_p_vels",".","xyz",";","HW",".","z","-=","u_p_gravity","*","t","/","2.0",";","float","HX","=","max","(","u_p_mass",",","EPSILON",")",";","HW","+=","(","u_p_wind_fac","*","u_wind","/","HX",")","*","t","/","2.0",";","sp",".","dr","=","t",";","sp",".","dp","=","HW",";","sp",".","dq","=","ca","*","a_p_vels",".","w",";","sp",".","O","=","fr","+","HW","*","t",";","sp",".","bP","=","a_p_vels",".","w","*","t",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_COLOR_RAMP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sp",".","di","=","GLSL_TEXTURE","(","u_color_ramp_tex",",","vec2","(","t","/","u_p_max_lifetime",",","0.5",")",")",".","g",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sp",".","di","=","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["COLOR_RAMP_LENGTH",0,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sp",".","aQ","=","HO","(","t",",","u_p_max_lifetime",",","u_p_color_ramp",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["sp",".","aQ","=","vec3","(","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["sp",".","L","=","HU","(","t",",","a_p_data","[","0","]",",","u_p_fade_in",",","u_p_fade_out",")",";","}","return","sp",";","}"]}]}}]}]},e["include/particles_nodes.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PARTICLES_NODES_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PARTICLES_NODES_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"CAUSTICS",TOKENS:["0"]},{TYPE:"var",NAME:"DOUBLE_SIDED_LIGHTING",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"PARTICLE_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"NUM_LIGHTS",TOKENS:["0"]},{TYPE:"var",NAME:"CALC_TBN_SPACE",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_BSDF_BEGIN",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"environment.glslf"}]}}]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"include",FILE:"math.glslv"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","kj","(","vec3","rgb",")","{","vec4","hM","=","vec4","(","_0_0",",","-","_1_0","/","3.0",",","2.0","/","3.0",",","-","_1_0",")",";","vec4","p","=","mix","(","vec4","(","rgb",".","bg",",","hM",".","wz",")",",","vec4","(","rgb",".","gb",",","hM",".","xy",")",",","step","(","rgb",".","b",",","rgb",".","g",")",")",";","vec4","q","=","mix","(","vec4","(","p",".","xyw",",","rgb",".","r",")",",","vec4","(","rgb",".","r",",","p",".","yzx",")",",","step","(","p",".","x",",","rgb",".","r",")",")",";","float","dC","=","q",".","x","-","min","(","q",".","w",",","q",".","y",")",";","float","iF","=","1.0e-10",";","return","vec3","(","abs","(","q",".","z","+","(","q",".","w","-","q",".","y",")","/","(","6.0","*","dC","+","iF",")",")",",","dC","/","(","q",".","x","+","iF",")",",","q",".","x",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{TYPE:"logical_or_expr",PLACES:6}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","kl","(","vec3","kk",")","{","vec4","hM","=","vec4","(","_1_0",",","2.0","/","3.0",",","_1_0","/","3.0",",","3.0",")",";","vec3","p","=","abs","(","fract","(","vec3","(","kk",".","r",",","kk",".","r",",","kk",".","r",")","+","hM",".","xyz",")","*","6.0","-","hM",".","www",")",";","return","kk",".","b","*","mix","(","hM",".","xxx",",","clamp","(","p","-","hM",".","xxx",",","_0_0",",","_1_0",")",",","kk",".","g",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sn","(","vec2","gX",")","{","return","vec3","(","gX","*","2.0","-","vec2","(","_1_0",",","_1_0",")",",","_0_0",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","so","(","vec3","rk",")","{","return","vec2","(","rk",".","xy","*","_0_5","+","vec2","(","_0_5",",","_0_5",")",")",";","}"]}]}}]},{TYPE:"node",NAME:"CAMERA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"sU",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sV",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"sW",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sU"],STATEMENTS:[{TYPE:"txt",TOKENS:["sU","=","normalize","(","sR",".","xyz",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sV"],STATEMENTS:[{TYPE:"txt",TOKENS:["sV","=","abs","(","sR",".","z",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_sW"],STATEMENTS:[{TYPE:"txt",TOKENS:["sW","=","length","(","sR",".","xyz",")",";"]}]}]}]},{TYPE:"node",NAME:"COMBRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"sX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"sZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"s_",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["s_","=","vec3","(","sX",",","sY",",","sZ",")",";"]}]},{TYPE:"node",NAME:"COMBHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ta",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"td",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["td","=","kl","(","vec3","(","ta",",","tb",",","tc",")",")",";"]}]},{TYPE:"node",NAME:"EMPTY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"te",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["te","=","vec3","(","-","_1_0",",","-","_1_0",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"EMPTY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tf","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tg",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tg","=","sn","(","A",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_OR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"th",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["th","=","2.0","*","vec3","(","A",",","_0_0",")","-","vec3","(","_1_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"ti",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ti","=","vec3","(","_1_0",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC1",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tj","=","_1_0",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC2",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tl",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tk","=","_1_0",";","tl","=","_1_0",";"]}]},{TYPE:"node",NAME:"GEOMETRY_VC3",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"to",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tm","=","_1_0",";","tn","=","_1_0",";","to","=","_1_0",";"]}]},{TYPE:"node",NAME:"GEOMETRY_NO",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"tr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tu",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["tu","=","tr",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["tu","=","sK",".","xyz",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_FB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tv",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tv","=","(","gl_FrontFacing",")","?","_0_0",":","_1_0",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["tv","=","(","gl_FrontFacing",")","?","_1_0",":","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"GEOMETRY_VW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tx",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tx","=","-","_","(","u_view_tsr_frag",",","oy",")",";"]}]},{TYPE:"node",NAME:"GEOMETRY_LO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"ty",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ty","[","0","]","=","sR","[","0","]",";","ty","[","1","]","=","sR","[","1","]",";","ty","[","2","]","=","sR","[","2","]",";"]}]},{TYPE:"node",NAME:"GEOMETRY_GL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tz","=","vec3","(","ow",".","r",",","ow",".","g",",","ow",".","b",")",";"]}]},{TYPE:"node",NAME:"NEW_GEOMETRY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"tB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tB","=","vec3","(","_0_0",")",";","tC","=","vec3","(","_0_0",")",";","tD","=","vec3","(","_0_0",")",";","tE","=","vec3","(","_0_0",")",";","tF","=","vec3","(","_0_0",")",";","tG","=","vec3","(","_0_0",")",";","tH","=","_0_0",";","tI","=","_0_0",";"]}]},{TYPE:"node",NAME:"HUE_SAT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","kk","=","kj","(","tN",")",";","kk","[","0","]","+=","(","tJ","-","_0_5",")",";","if","(","kk","[","0","]",">","_1_0",")","kk","[","0","]","-=","_1_0",";","else","if","(","kk","[","0","]","<","_0_0",")","kk","[","0","]","+=","_1_0",";","kk","*=","vec3","(","_1_0",",","tK",",","tL",")",";","kk","=","mix","(","vec3","(","_1_0",")",",","mix","(","vec3","(","_0_0",")",",","kk",",","step","(","vec3","(","_0_0",")",",","kk",")",")",",","step","(","kk",",","vec3","(","_1_0",")",")",")",";","tO","=","mix","(","tN",",","kl","(","kk",")",",","tM",")",";"]}]},{TYPE:"node",NAME:"INVERT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"tQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["tR","=","mix","(","tQ",",","vec3","(","_1_0",")","-","tQ",",","tP",")",";"]}]},{TYPE:"node",NAME:"LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_INDEX",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_USE_SPHERE",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"tS",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"tT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tV",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tS"],STATEMENTS:[{TYPE:"txt",TOKENS:["tS","=","u_lamp_light_color_intensities","[","LAMP_INDEX","]",";"]}]}]},{TYPE:"txt",TOKENS:["vec3","tW","=","u_lamp_light_directions","[","LAMP_INDEX","]",";","vec3","tX","=","u_lamp_light_positions","[","LAMP_INDEX","]",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["tT","=","-","h","+","tX",";","tU","=","length","(","tT",")",";","tT","=","normalize","(","tT",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tV"],STATEMENTS:[{TYPE:"txt",TOKENS:["tV","=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","tU","*","tU",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","pb","=","dot","(","tT",",","tW",")",";","pb","*=","smoothstep","(","_0_0",",","_1_0",",","(","pb","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","tV","*=","pb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_USE_SPHERE"],STATEMENTS:[{TYPE:"txt",TOKENS:["tV","*=","max","(","LAMP_LIGHT_DIST","-","tU",",","_0_0",")","/","LAMP_LIGHT_DIST",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tT"],STATEMENTS:[{TYPE:"txt",TOKENS:["tT","=","tW",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tU"],STATEMENTS:[{TYPE:"txt",TOKENS:["tU","=","length","(","tX","-","h",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tV"],STATEMENTS:[{TYPE:"txt",TOKENS:["tV","=","_1_0",";"]}]}]}]}]}]},{TYPE:"node",NAME:"NORMAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"tY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"tZ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"t_",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sB",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_tZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["tZ","=","sB",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_t_"],STATEMENTS:[{TYPE:"txt",TOKENS:["t_","=","-","dot","(","tY",",","sB",")",";"]}]}]}]},{TYPE:"node",NAME:"B4W_VECTOR_VIEW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ua",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ub",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ub","=","-","_","(","u_view_tsr_frag",",","ua",")",";"]}]},{TYPE:"node",NAME:"BSDF_BEGIN",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"uc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ud",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ue",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ug",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ui",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ul",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"um",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"un",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"up",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ur",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"us",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ut",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uu",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uw",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ux",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uC",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ur","=","ud",";","us","=","uf",";","ut","=","ui",";","ux","=","ud",";","uy","=","uf",";","metalness_out","=","uh",";","uz","=","ul",";","uA","=","um",";","uB","=","un",";","uC","=","uo",";","up","=","sS","*","ur",";","uq","=","sT","*","u_environment_energy","*","cE","(","ut",")",";","uw","=","cH","(","ur",")",";","H","=","uw",";","uu","[","0","]","=","ue",";","uu","[","1","]","=","ug",";","uu","[","2","]","=","uh",";"]}]},{TYPE:"node",NAME:"BSDF_END",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"uD",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uG",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"uO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["uO","=","uD",".","rgb","+","uE",";","uO","=","mix","(","uO",",","uK",",","uL",")",";","I","=","_1_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_BSDF_TRANSPARENT"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","uR","=","GLSL_TEXTURE","(","u_refractmap",",","l",".","xy","/","l",".","z",")",".","rgb",";","bG","(","uR",")",";","uM","=","uM","*","uR",";","uO","+=","uM",";"]}]}]},{TYPE:"txt",TOKENS:["uF",";"]}]},{TYPE:"node",NAME:"BSDF_COMPUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"uY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"uZ",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"u_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"va",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vb",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vd",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","rz","=","u_",";","float","uU","=","clamp","(","vb","[","0","]",",","_0_0",",","_1_0",")",";","float","uQ","=","clamp","(","vb","[","1","]",",","_0_0",",","_1_0",")",";","float","rW","=","vb","[","2","]",";","vec3","p_","=","normalize","(","oy","+","uY",")",";","float","pj","=","(","_1_0","-","va",")","*","dot","(","rz",",","uY",")","+","va",";","float","vf","=","(","_1_0","-","va",")","*","max","(","dot","(","uY",",","p_",")",",","_0_0",")","+","va",";","float","vg","=","(","_1_0","-","va",")","*","max","(","dot","(","u_",",","p_",")",",","_0_0",")","+","va",";","vc","=","_0_0",";","if","(","uZ",".","r","!=","_0_0",")","{","if","(","uU",">","_0_0",")","{","float","pz","=","max","(","dot","(","rz",",","oy",")",",","_0_0",")",";","float","pA","=","uU","*","uU",";","float","cG","=","_1_0","-","_0_5","*","(","pA","/","(","pA","+","0.33",")",")",";","vec3","pB","=","uY","-","pj","*","rz",";","vec3","pC","=","oy","-","pz","*","rz",";","if","(","length","(","pB",")","==","_0_0","||","length","(","pC",")","==","_0_0","||","abs","(","pj",")",">","_1_0","||","abs","(","pz",")",">","_1_0",")","vc","=","pj","*","cG",";","else","{","float","pD","=","acos","(","pj",")",";","float","pE","=","acos","(","pz",")",";","vec3","pF","=","normalize","(","pB",")",";","vec3","pG","=","normalize","(","pC",")",";","float","a",",","b",";","a","=","max","(","pD",",","pE",")",";","b","=","min","(","pD",",","pE",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pF",",","pG",")",",","_0_0",")",";","float","hS","=","0.45","*","(","pA","/","(","pA","+","0.09",")",")",";","vc","=","pj","*","(","cG","+","(","hS","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","else","vc","=","pj",";","vc","=","max","(","vc",",","_0_0",")",";","}","float","L","=","uQ",";","float","vh","=","L","*","L",";","float","d_","=","(","vg","*","vh","-","vg",")","*","vg","+","_1_0",";","float","cD","=","vh","/","(","M_PI","*","d_","*","d_",")",";","float","vi",";","float","vj",";","float","vl","=","pow","(","_1_0","-","vf",",","5.0",")",";","vi","=","_1_0",";","vj","=","vl",";","float","hM","=","L","/","2.0",";","float","vm","=","hM","*","hM",";","float","vn","=","_1_0","-","vm",";","float","vo","=","_1_0","/","(","vf","*","vf","*","vn","+","vm",")",";","vi","*=","vo",";","vj","*=","vo",";","float","rR","=","mix","(","0.04",",","_1_0",",","rW",")",";","float","vp","=","mix","(","vj",",","vi",",","rR",")",";","vd","=","max","(","pj","*","cD","*","vp",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"BSDF_ANISOTROPIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"vJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vP","=","vJ",";","vK",";","vL",";","vM",";","vN",";","vO",";"]}]},{TYPE:"node",NAME:"BSDF_DIFFUSE",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"vQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"vS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"vZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wb",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"we",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vU","=","vQ",";","vV","=","vR",";","vY","=","_0_0",";","wc","=","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vZ","=","vS",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vZ","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:["vT",";","vW",";","vX",";","wb",";","wd",";","we",";"]}]},{TYPE:"node",NAME:"BSDF_GLASS",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wj",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wj","=","wf",";","wg",";","wh",";","wi",";"]}]},{TYPE:"node",NAME:"BSDF_GLOSSY",NODE_VARS:[{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"wk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wp",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ws",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wq","=","wk",";","wr","=","wl",";","ws","=","_1_0",";","wB","=","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["wt","=","wm",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["wt","=","ox",";"]}]}]},{TYPE:"txt",TOKENS:["wn",";","wo",";","wp",";","wA",";","wC",";","wD",";"]}]},{TYPE:"node",NAME:"BSDF_HAIR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wI",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wI","=","wE",";","wF",";","wG",";","wH",";"]}]},{TYPE:"node",NAME:"BSDF_TRANSPARENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wV","=","wJ",";","wP","=","_0_0",";","wU","=","_0_0",";","wW","=","_0_0",";","wQ","=","ox",";","wK",";","wL",";","wM",";","wN",";","wO",";","wT",";"]}]},{TYPE:"node",NAME:"BSDF_TRANSLUCENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"wX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"wY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"wZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["wZ","=","wX",";","wY",";"]}]},{TYPE:"node",NAME:"BSDF_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"w_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xa",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xd",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xd","[","0","]","=","xd","[","1","]","=","xd","[","2","]","=","_0_0",";","w_",";","xa",";","xb",";","xc",";"]}]},{TYPE:"node",NAME:"BSDF_TOON",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xi","=","xe",";","xf",";","xg",";","xh",";"]}]},{TYPE:"node",NAME:"BSDF_VELVET",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xj",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xm","=","xj",";","xk",";","xl",";"]}]},{TYPE:"node",NAME:"SUBSURFACE_SCATTERING",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xn",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xt",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xt","[","0","]","=","xt","[","1","]","=","xt","[","2","]","=","_0_0",";","xn",";","xp",";","xq",";","xr",";","xs",";","xo",";"]}]},{TYPE:"node",NAME:"EMISSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xJ","=","xv","*","xu",";","xF","=","_0_0",";","xK","=","_1_0",";","xG","=","ox",";","xA",";","xB",";","xC",";","xD",";","xE",";","xL",";","xM",";"]}]},{TYPE:"node",NAME:"AMBIENT_OCCLUSION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xO","[","0","]","=","xO","[","1","]","=","xO","[","2","]","=","_0_0",";","xN",";"]}]},{TYPE:"node",NAME:"HOLDOUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"xP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xP","[","0","]","=","xP","[","1","]","=","xP","[","2","]","=","_0_0",";"]}]},{TYPE:"node",NAME:"VOLUME_ABSORPTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xS","[","0","]","=","xS","[","1","]","=","xS","[","2","]","=","_0_0",";","xQ",";","xR",";"]}]},{TYPE:"node",NAME:"VOLUME_SCATTER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"xT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"xW",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["xW","[","0","]","=","xW","[","1","]","=","xW","[","2","]","=","_0_0",";","xT",";","xU",";","xV",";"]}]},{TYPE:"node",NAME:"BUMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ib",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ic",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"xZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Id",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ya",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ya","=","Id",";","Ib",";","Ic",";","xZ",";"]}]},{TYPE:"node",NAME:"DISPLACEMENT_BUMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yi","=","ox",";","yh",";"]}]},{TYPE:"node",NAME:"NORMAL_MAP",NODE_VARS:[{TYPE:"node_var",NAME:"SPACE",TOKENS:["NM_TANGENT"]},{TYPE:"node_var",NAME:"USE_NORMAL_IN",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"yj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yk",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ym",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NORMAL_IN"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yn","=","yl",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","yn","=","sM",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["SPACE","NM_TANGENT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["ym","=","2.0","*","yk",".","xyz","-","_1_0",";","ym","=","sQ","*","ym",";"]}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_OBJECT",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_OBJECT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["ym","=","2.0","*","yk",".","xyz","-","_1_0",";","ym",".","yz","*=","-","_1_0",";","ym","=","bI","(","u_model_tsr",",","ym",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["SPACE","NM_WORLD",{TYPE:"equal_expr",PLACES:2},"SPACE","NM_BLENDER_WORLD",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["ym","=","2.0","*","yk",".","xyz","-","_1_0",";","ym",".","yz","*=","-","_1_0",";"]}]}]},{TYPE:"txt",TOKENS:["float","me","=","max","(","yj",",","_0_0",")",";","ym","=","normalize","(","mix","(","yn",",","ym",",","me",")",")",";"]}]},{TYPE:"node",NAME:"VECT_TRANSFORM",NODE_VARS:[{TYPE:"node_var",NAME:"CONVERT_TYPE",TOKENS:["VT_WORLD_TO_OBJECT"]},{TYPE:"node_var",NAME:"VECTOR_TYPE",TOKENS:["VT_VECTOR"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"yo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yp",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{TYPE:"equal_expr",PLACES:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:3}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","yo",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_POINT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_view_tsr_frag",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_model_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_model_tsr",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_model_tsr",",","yo",")",";","yp","=","ap","(","u_view_tsr_frag",",","yp",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_view_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","ap","(","u_view_tsr_inverse",",","yo",")",";","yp","=","ap","(","u_model_tsr_inverse",",","yp",")",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_view_tsr_frag",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_model_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_model_tsr",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_model_tsr",",","yo",")",";","yp","=","_","(","u_view_tsr_frag",",","yp",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_view_tsr_inverse",",","yo",")",";"]}]},{TYPE:"node_elif",EXPRESSION:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","_","(","u_view_tsr_inverse",",","yo",")",";","yp","=","_","(","u_model_tsr_inverse",",","yp",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["VECTOR_TYPE","VT_NORMAL",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["yp","=","normalize","(","yp",")",";"]}]}]}]}]}]},{TYPE:"node",NAME:"BLACKBODY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yr",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yr","[","0","]","=","yr","[","1","]","=","yr","[","2","]","=","_0_0",";","yq",";"]}]},{TYPE:"node",NAME:"WAVELENGTH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"ys",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yt",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yt","[","0","]","=","yt","[","1","]","=","yt","[","2","]","=","_0_0",";","ys",";"]}]},{TYPE:"node",NAME:"SEPXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yv","=","yu","[","0","]",";","yA","=","yu","[","1","]",";","yB","=","yu","[","2","]",";"]}]},{TYPE:"node",NAME:"COMBXYZ",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yF",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yF","[","0","]","=","yC",";","yF","[","1","]","=","yD",";","yF","[","2","]","=","yE",";"]}]},{TYPE:"node",NAME:"BRIGHTCONTRAST",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","b","=","yH","-","yI","*","_0_5",";","yJ","=","max","(","(","_1_0","+","yI",")","*","yG","+","b",",","vec3","(","_0_0",")",")",";"]}]},{TYPE:"node",NAME:"LIGHT_FALLOFF",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yO",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yM","=","yN","=","yO","=","_0_0",";","yK",";","yL",";"]}]},{TYPE:"node",NAME:"TEX_IMAGE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ie",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"If",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ig",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["If","[","0","]","=","If","[","1","]","=","If","[","2","]","=","_0_0",";","Ig","=","_1_0",";","Ie",";"]}]},{TYPE:"node",NAME:"TEX_ENVIRONMENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ih",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ii",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ii","[","0","]","=","Ii","[","1","]","=","Ii","[","2","]","=","_0_0",";","Ih",";"]}]},{TYPE:"node",NAME:"TEX_SKY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yQ","[","0","]","=","yQ","[","1","]","=","yQ","[","2","]","=","_0_0",";","yP",";"]}]},{TYPE:"node",NAME:"TEX_NOISE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"yW",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["yV","[","0","]","=","yV","[","1","]","=","yV","[","2","]","=","_0_0",";","yW","=","_1_0",";","yR",";","yS",";","yT",";","yU",";"]}]},{TYPE:"node",NAME:"TEX_WAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"yX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"yZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"y_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"za",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zb",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zc",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zb","[","0","]","=","zb","[","1","]","=","zb","[","2","]","=","_0_0",";","zc","=","_1_0",";","yX",";","yY",";","yZ",";","y_",";","za",";"]}]},{TYPE:"node",NAME:"TEX_VORONOI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ze",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zf",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zg",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zf","[","0","]","=","zf","[","1","]","=","zf","[","2","]","=","_0_0",";","zg","=","_1_0",";","zd",";","ze",";"]}]},{TYPE:"node",NAME:"TEX_MUSGRAVE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zp",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zo","[","0","]","=","zo","[","1","]","=","zo","[","2","]","=","_0_0",";","zp","=","_1_0",";","zh",";","zi",";","zj",";","zk",";","zl",";","zm",";","zn",";"]}]},{TYPE:"node",NAME:"TEX_GRADIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zs",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zr","[","0","]","=","zr","[","1","]","=","zr","[","2","]","=","_0_0",";","zs","=","_1_0",";","zq",";"]}]},{TYPE:"node",NAME:"TEX_MAGIC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zA","[","0","]","=","zA","[","1","]","=","zA","[","2","]","=","_0_0",";","zB","=","_1_0",";","zt",";","zu",";","zv",";"]}]},{TYPE:"node",NAME:"TEX_CHECKER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zH",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zG","[","0","]","=","zG","[","1","]","=","zG","[","2","]","=","_0_0",";","zH","=","_1_0",";","zC",";","zD",";","zE",";","zF",";"]}]},{TYPE:"node",NAME:"TEX_BRICK",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zN",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zR","[","0","]","=","zR","[","1","]","=","zR","[","2","]","=","_0_0",";","zS","=","_1_0",";","zI",";","zJ",";","zK",";","zL",";","zM",";","zN",";","zO",";","zP",";","zQ",";"]}]},{TYPE:"node",NAME:"ADD_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zT",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"zV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["zV","=","clamp","(","zT","+","zU",",","vec3","(","_0_0",")",",","vec3","(","_1_0",")",")",";"]}]},{TYPE:"node",NAME:"MIX_SHADER",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"zW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"zZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"z_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ab",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ac",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ad",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ag",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ah",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ai",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Aj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ak",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Al",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Am",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"An",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ao",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ap",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"As",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"At",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Au",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Av",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Aw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ax",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ay",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Az",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AB",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","zW",",","_0_0",",","_1_0",")",";","Ax","=","mix","(","zZ",",","Ak",",","AJ",")",";","Ay","=","mix","(","z_",",","Al",",","AJ",")",";","if","(","Ac",">","_0_0",")","{","if","(","Ao",">","_0_0",")","{","Az","=","mix","(","Aa",",","Am",",","AJ",")",";","AA","=","mix","(","Ab",",","An",",","AJ",")",";","}","else","{","Az","=","Aa",";","AA","=","Ab",";","}","}","else","{","Az","=","Am",";","AA","=","An",";","}","if","(","Ah",">","_0_0",")","{","if","(","At",">","_0_0",")","{","AF","=","mix","(","Ag",",","As",",","AJ",")",";","}","else","{","AF","=","Ag",";","}","}","else","{","AF","=","As",";","}","AB","=","mix","(","Ac",",","Ao",",","AJ",")",";","AC","=","mix","(","Ad",",","Ap",",","AJ",")",";","AG","=","mix","(","Ah",",","At",",","AJ",")",";","AH","=","mix","(","Ai",",","Au",",","AJ",")",";","AI","=","mix","(","Aj",",","Av",",","AJ",")",";"]}]},{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AL",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AK"],STATEMENTS:[{TYPE:"txt",TOKENS:["AK","=","sn","(","A",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AL"],STATEMENTS:[{TYPE:"txt",TOKENS:["AL","=","vec3","(","A",",","_0_0",")",";"]}]}]}]},{TYPE:"node",NAME:"TEX_COORD_UV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AM",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AM","=","vec3","(","A",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"TEX_COORD_NO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AN",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AN","=","ox",";"]}]},{TYPE:"node",NAME:"TEX_COORD_GE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AO",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AO","=","vec3","(","A",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"TEX_COORD_OB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AP","[","0","]","=","AP","[","1","]","=","AP","[","2","]","=","_1_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_CA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AQ","[","0","]","=","sR","[","0","]",";","AQ","[","1","]","=","sR","[","1","]",";","AQ","[","2","]","=","_1_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_WI",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AR",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AR","[","0","]","=","AR","[","1","]","=","AR","[","2","]","=","_1_0",";"]}]},{TYPE:"node",NAME:"TEX_COORD_RE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AS","[","0","]","=","AS","[","1","]","=","AS","[","2","]","=","_1_0",";"]}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["AT","=","vec3","(","A",",","_0_0",")",";"]}]},{TYPE:"node",NAME:"PARTICLE_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"AU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AV",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"AZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"A_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"HY",QUALIFIER:["GLSL_IN","vec4"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"HZ",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"H_",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"Ia",QUALIFIER:["GLSL_IN","vec3"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PARTICLE_BATCH"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AU"],STATEMENTS:[{TYPE:"txt",TOKENS:["AU","=","HY","[","0","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AV"],STATEMENTS:[{TYPE:"txt",TOKENS:["AV","=","HY","[","1","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AW"],STATEMENTS:[{TYPE:"txt",TOKENS:["AW","=","HY","[","2","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AX"],STATEMENTS:[{TYPE:"txt",TOKENS:["AX","=","HZ",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AY"],STATEMENTS:[{TYPE:"txt",TOKENS:["AY","=","HY","[","3","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_AZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["AZ","=","H_",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_A_"],STATEMENTS:[{TYPE:"txt",TOKENS:["A_","=","Ia",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["AU","=","_0_0",";","AV","=","_0_0",";","AW","=","_0_0",";","AX","=","vec3","(","_0_0",")",";","AY","=","_0_0",";","AZ","=","AX",";","A_","=","AX",";"]}]}]}]},{TYPE:"node",NAME:"HAIR_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Ba",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bd",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ba","=","_0_0",";","Bb","=","_0_0",";","Bc","=","_0_0",";","Bd","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"OBJECT_INFO",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Be",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bg",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bh",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bf","=","_0_0",";","Bg","=","_0_0",";","Bh","=","_0_0",";","Be","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"WIREFRAME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Bi",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bj","=","Bi",";"]}]},{TYPE:"node",NAME:"TANGENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Bk",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bk","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LAYER_WEIGHT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Ij",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ik",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bo",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bn","=","Bo","=","_0_0",";","Ik",";","Ij",";"]}]},{TYPE:"node",NAME:"LIGHT_PATH",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Bq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Br",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bt",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"By",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Bz",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Bq","=","Br","=","Bs","=","_0_0",";","Bt","=","Bu","=","Bv","=","_0_0",";","Bw","=","Bw","=","By","=","Bz","=","_0_0",";","Bx","=","_0_0",";"]}]},{TYPE:"node",NAME:"ATTRIBUTE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"BB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BD",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BB","=","BC","=","vec3","(","_0_0",")",";","BD","=","_0_0",";"]}]},{TYPE:"node",NAME:"SCRIPT",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[]},{TYPE:"node",NAME:"CURVE_VEC",NODE_VARS:[{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["0.0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BG",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BG","=","BF",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:["BG",".","r","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","BF",".","r","+","_0_5",",","NODE_TEX_ROW",")",")",".","r","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:["BG",".","g","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","BF",".","g","+","_0_5",",","NODE_TEX_ROW",")",")",".","g","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:["BG",".","b","=","(","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","_0_5","*","BF",".","b","+","_0_5",",","NODE_TEX_ROW",")",")",".","b","-","_0_5",")","*","2.0",";"]}]}]},{TYPE:"txt",TOKENS:["BG","=","mix","(","BF",",","BG",",","BE",")",";"]}]},{TYPE:"node",NAME:"CURVE_RGB",NODE_VARS:[{TYPE:"node_var",NAME:"READ_A",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_R",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_G",TOKENS:["0"]},{TYPE:"node_var",NAME:"READ_B",TOKENS:["0"]},{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_A"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","r","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BI",".","r",",","NODE_TEX_ROW",")",")",".","a",";","float","g","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BI",".","g",",","NODE_TEX_ROW",")",")",".","a",";","float","b","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BI",".","b",",","NODE_TEX_ROW",")",")",".","a",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","r","=","BI",".","r",";","float","g","=","BI",".","g",";","float","b","=","BI",".","b",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_R"],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","r","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","r",",","NODE_TEX_ROW",")",")",".","r",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","r","=","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_G"],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","g","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","g",",","NODE_TEX_ROW",")",")",".","g",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","g","=","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["READ_B"],STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","b","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","b",",","NODE_TEX_ROW",")",")",".","b",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["BJ",".","b","=","b",";"]}]}]},{TYPE:"txt",TOKENS:["BJ","=","mix","(","BI",",","BJ",",","BH",")",";"]}]},{TYPE:"node",NAME:"VALTORGB",NODE_VARS:[{TYPE:"node_var",NAME:"NODE_TEX_ROW",TOKENS:["_0_0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE","(","u_nodes_texture",",","vec2","(","BK",",","NODE_TEX_ROW",")",")",";","BL","=","BN",".","rgb",";","BM","=","BN",".","a",";"]}]},{TYPE:"node",NAME:"MAPPING",NODE_VARS:[{TYPE:"node_var",NAME:"MAPPING_SCALE_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_SCALE",TOKENS:["vec3","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRANS_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRANS",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_TRS_MATRIX",TOKENS:["mat4","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MIN_CLIP",TOKENS:["vec3","(","_0_0",")"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP_DEF",TOKENS:["0"]},{TYPE:"node_var",NAME:"MAPPING_MAX_CLIP",TOKENS:["vec3","(","_1_0",")"]},{TYPE:"node_var",NAME:"MAPPING_IS_NORMAL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BP",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","BO",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_SCALE_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","BP","*","MAPPING_SCALE",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRANS_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","BP","+","MAPPING_TRANS",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_TRS_MATRIX_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","(","MAPPING_TRS_MATRIX","*","vec4","(","BP",",","_1_0",")",")",".","xyz",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MIN_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","max","(","BP",",","MAPPING_MIN_CLIP",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_MAX_CLIP_DEF"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","min","(","BP",",","MAPPING_MAX_CLIP",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAPPING_IS_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["BP","=","normalize","(","BP",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ADD",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BS","=","BQ","+","BR",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BS","=","clamp","(","BS",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BV",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BV","=","BT","-","BU",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BV","=","clamp","(","BV",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BW",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"BX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"BY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["BY","=","BW","*","BX",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["BY","=","clamp","(","BY",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"BZ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"B_",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ca",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Ca","=","(","B_","!=","_0_0",")","?","BZ","/","B_",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ca","=","clamp","(","Ca",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_SINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cc",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cd",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cd","=","sin","(","Cb",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cd","=","clamp","(","Cd",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cc",";"]}]},{TYPE:"node",NAME:"MATH_COSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ce",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cg",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cg","=","cos","(","Ce",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cg","=","clamp","(","Cg",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cf",";"]}]},{TYPE:"node",NAME:"MATH_TANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ch",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ci",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cj",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cj","=","tan","(","Ch",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cj","=","clamp","(","Cj",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Ci",";"]}]},{TYPE:"node",NAME:"MATH_ARCSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ck",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cm",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cm","=","(","Ck","<=","_1_0","&&","Ck",">=","-","_1_0",")","?","asin","(","Ck",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cm","=","clamp","(","Cm",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cl",";"]}]},{TYPE:"node",NAME:"MATH_ARCCOSINE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Co",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cp",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cp","=","(","Cn","<=","_1_0","&&","Cn",">=","-","_1_0",")","?","acos","(","Cn",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cp","=","clamp","(","Cp",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Co",";"]}]},{TYPE:"node",NAME:"MATH_ARCTANGENT",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cq",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cs",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cs","=","atan","(","Cq",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cs","=","clamp","(","Cs",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["Cr",";"]}]},{TYPE:"node",NAME:"MATH_POWER",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ct",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cu",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cv",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","Ct","<","_0_0","&&","Cu","!=","floor","(","Cu",")",")","Cv","=","_0_0",";","else","if","(","Cu","==","_0_0",")","Cv","=","_1_0",";","else","if","(","Ct","<","_0_0",")","Cv","=","mix","(","_1_0",",","-","_1_0",",","sign","(","mod","(","-","Cu",",","2.0",")",")",")","*","pow","(","-","Ct",",","Cu",")",";","else","if","(","Ct","==","_0_0",")","Cv","=","_0_0",";","else","Cv","=","pow","(","Ct",",","Cu",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cv","=","clamp","(","Cv",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_LOGARITHM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Cx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Cy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Cy","=","(","Cw",">","_0_0","&&","Cx",">","_0_0",")","?","log2","(","Cw",")","/","log2","(","Cx",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Cy","=","clamp","(","Cy",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MINIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Cz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CB","=","min","(","Cz",",","CA",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CB","=","clamp","(","CB",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MAXIMUM",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CD",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CE","=","max","(","CC",",","CD",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CE","=","clamp","(","CE",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ROUND",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CF",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CG",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CH",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CH","=","floor","(","CF","+","_0_5",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CH","=","clamp","(","CH",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["CG",";"]}]},{TYPE:"node",NAME:"MATH_LESS_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CI",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CK",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CK","=","(","CI","<","CJ",")","?","_1_0",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CK","=","clamp","(","CK",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_GREATER_THAN",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CN",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CN","=","(","CL",">","CM",")","?","_1_0",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CN","=","clamp","(","CN",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_MODULO",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CO",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CQ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CQ","=","abs","(","CP",")",">","0.000001","?","mod","(","CO",",","CP",")",":","_0_0",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CQ","=","clamp","(","CQ",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATH_ABSOLUTE",NODE_VARS:[{TYPE:"node_var",NAME:"MATH_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CR",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CS",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CT",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["CT","=","abs","(","CR",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATH_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CT","=","clamp","(","CT",",","_0_0",",","_1_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["CS",";"]}]},{TYPE:"node",NAME:"MIX_RGB_MIX",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CU",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"CX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","CU",",","_0_0",",","_1_0",")",";","CX","=","mix","(","CV",",","CW",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["CX","=","clamp","(","CX",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_ADD",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"CY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"CZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"C_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Da",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","CY",",","_0_0",",","_1_0",")",";","Da","=","mix","(","CZ",",","CZ","+","C_",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Da","=","clamp","(","Da",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_MULTIPLY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Db",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"De",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Db",",","_0_0",",","_1_0",")",";","De","=","mix","(","Dc",",","Dc","*","Dd",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["De","=","clamp","(","De",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SUBTRACT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Df",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Di",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Df",",","_0_0",",","_1_0",")",";","Di","=","mix","(","Dg",",","Dg","-","Dh",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Di","=","clamp","(","Di",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SCREEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dl",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dm",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Dj",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","Dm","=","vec3","(","_1_0",")","-","(","vec3","(","Dn",")","+","AJ","*","(","vec3","(","_1_0",")","-","Dl",")",")","*","(","vec3","(","_1_0",")","-","Dk",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dm","=","clamp","(","Dm",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DIVIDE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Do",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dp",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dr",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Do",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","Dq","+=","step","(","Dq",",","vec3","(","_0_0",")",")",";","Dr","=","Dn","*","Dp","+","AJ","*","Dp","/","Dq",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dr","=","clamp","(","Dr",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DIFFERENCE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ds",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Du",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dv",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Ds",",","_0_0",",","_1_0",")",";","Dv","=","mix","(","Dt",",","abs","(","Dt","-","Du",")",",","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dv","=","clamp","(","Dv",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DARKEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Dw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Dy",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Dz",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Dw",",","_0_0",",","_1_0",")",";","Dz","=","min","(","Dx",".","rgb",",","Dy",".","rgb","*","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Dz","=","clamp","(","Dz",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LIGHTEN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DA",",","_0_0",",","_1_0",")",";","DD","=","max","(","DB",".","rgb",",","DC",".","rgb","*","AJ",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DD","=","clamp","(","DD",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_OVERLAY",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DE",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DH",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DE",",","_0_0",",","_1_0",")",";","vec3","DI","=","vec3","(","_1_0","-","AJ",")",";","DH","=","mix","(","DF","*","(","DI","+","2.0","*","AJ","*","DG",")",",","vec3","(","_1_0",")","-","(","DI","+","2.0","*","AJ","*","(","vec3","(","_1_0",")","-","DG",")",")","*","(","vec3","(","_1_0",")","-","DF",")",",","step","(","_0_5",",","DF",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DH","=","clamp","(","DH",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_DODGE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DJ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DM",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DJ",",","_0_0",",","_1_0",")",";","vec3","DN","=","vec3","(","_1_0",")","-","AJ","*","DL",";","vec3","DO","=","clamp","(","DK","/","DN",",","_0_0",",","_1_0",")",";","DM","=","mix","(","mix","(","DO",",","vec3","(","_1_0",")",",","step","(","DN",",","vec3","(","_0_0",")",")",")",",","DK",",","step","(","DK",",","vec3","(","_0_0",")",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DM","=","clamp","(","DM",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_BURN",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DP",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DS",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DP",",","_0_0",",","_1_0",")",";","vec3","ks","=","vec3","(","_1_0","-","AJ",")",";","vec3","DN","=","ks","+","AJ","*","DR",";","vec3","DO","=","clamp","(","vec3","(","_1_0",")","-","(","vec3","(","_1_0",")","-","DQ",")","/","DN",",","_0_0",",","_1_0",")",";","DS","=","mix","(","DO",",","vec3","(","_0_0",")",",","step","(","DN",",","vec3","(","_0_0",")",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DS","=","clamp","(","DS",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_HUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"DW",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DT",",","_0_0",",","_1_0",")",";","vec3","kk",",","DX",",","DN",";","DW","=","DU",";","DX","=","kj","(","DV",")",";","if","(","DX",".","y","!=","_0_0",")","{","kk","=","kj","(","DW",")",";","kk",".","x","=","DX",".","x",";","DN","=","kl","(","kk",")",";","DW","=","mix","(","DW",",","DN",",","AJ",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["DW","=","clamp","(","DW",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SATURATION",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"DY",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"DZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"D_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ea",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","DY",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","Ea","=","DZ",";","vec3","kk",",","DX",";","kk","=","kj","(","Ea",")",";","if","(","kk",".","y","!=","_0_0",")","{","DX","=","kj","(","D_",")",";","kk",".","y","=","Dn","*","kk",".","y","+","AJ","*","DX",".","y",";","Ea","=","kl","(","kk",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ea","=","clamp","(","Ea",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Eb",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ec",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ed",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ee",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Eb",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","vec3","kk",",","DX",";","kk","=","kj","(","Ec",")",";","DX","=","kj","(","Ed",")",";","kk",".","z","=","Dn","*","kk",".","z","+","AJ","*","DX",".","z",";","Ee","=","kl","(","kk",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ee","=","clamp","(","Ee",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ef",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eh",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ei",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Ef",",","_0_0",",","_1_0",")",";","vec3","kk",",","DX",",","DN",";","Ei","=","Eg",";","DX","=","kj","(","Eh",")",";","if","(","DX",".","y","!=","_0_0",")","{","kk","=","kj","(","Ei",")",";","kk",".","x","=","DX",".","x",";","kk",".","y","=","DX",".","y",";","DN","=","kl","(","kk",")",";","Ei","=","mix","(","Ei",",","DN",",","AJ",")",";","}"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ei","=","clamp","(","Ei",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_SOFT_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ej",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ek",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"El",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Em",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Ej",",","_0_0",",","_1_0",")",";","float","Dn","=","_1_0","-","AJ",";","vec3","En","=","El","+","Ek","-","El","*","Ek",";","Em","=","Ek","*","(","vec3","(","Dn",")","+","vec3","(","AJ",")","*","(","(","vec3","(","_1_0",")","-","Ek",")","*","El","+","En",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Em","=","clamp","(","Em",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MIX_RGB_LINEAR_LIGHT",NODE_VARS:[{TYPE:"node_var",NAME:"MIX_RGB_USE_CLAMP",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Eo",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ep",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Eq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Er",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","AJ","=","clamp","(","Eo",",","_0_0",",","_1_0",")",";","Er","=","Ep","+","AJ","*","(","2.0","*","Eq","-","vec3","(","_1_0",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MIX_RGB_USE_CLAMP"],STATEMENTS:[{TYPE:"txt",TOKENS:["Er","=","clamp","(","Er",",","_0_0",",","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EB",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","EA",";","I","=","EB",";"]}]},{TYPE:"node",NAME:"OUTPUT_SURFACE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"EC",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","EC",";","I","=","_1_0",";"]}]},{TYPE:"node",NAME:"MATERIAL_BEGIN",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_NORMAL",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",TOKENS:["0"]},{TYPE:"node_var",NAME:"SHADELESS_MAT",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"EF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EI",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EJ",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EP",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"EQ",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ER",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sF",QUALIFIER:["const","vec2"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sG",QUALIFIER:["const","vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EM","=","clamp","(","EF",",","_0_0",",","_1_0",")",";","EN","=","sG","[","0","]","*","clamp","(","EG",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_NORMAL"],STATEMENTS:[{TYPE:"txt",TOKENS:["EO","=","normalize","(","EI",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EO","=","ox",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["SHADELESS_MAT",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"txt",TOKENS:["EK","=","EJ","*","EM",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EK","=","sS","*","EM",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:["EM","*=","EH",";"]}]}]},{TYPE:"txt",TOKENS:["EL","=","sT","*","u_environment_energy","*","cE","(","EO",")",";","ER","=","vec4","(","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NUM_LIGHTS",0,{TYPE:"g_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["EP","=","vec2","(","sF","[","0","]",",","sF","[","1","]",")",";","EQ","=","vec2","(","sG","[","1","]",",","sG","[","2","]",")",";"]}]}]},{TYPE:"txt",TOKENS:["H","=","ER",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EK","=","vec3","(","_0_0",")",";","EL","=","vec3","(","_1_0",")",";"]}]}]}]},{TYPE:"node",NAME:"MATERIAL_END",NODE_VARS:[{TYPE:"node_var",NAME:"MATERIAL_EXT",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_DIFFUSE",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_MATERIAL_SPECULAR",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"ES",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"ET",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"EV",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EW",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"EX",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EY",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"EZ",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"E_",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fa",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fb",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"sH",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"sI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["EV",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EY"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_DIFFUSE"],STATEMENTS:[{TYPE:"txt",TOKENS:["EY","=","ES",".","rgb",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["EY","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["EY","+=","ET",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_E_"],STATEMENTS:[{TYPE:"txt",TOKENS:["E_","=","EU",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MATERIAL_EXT"],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fa"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fa","=","ES",".","rgb",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fb"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fb","=","ET",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["EZ","=","clamp","(","EX",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","ET",".","r",",","ET",".","g",")",",","ET",".","b",")","*","EW",";","EZ","=","clamp","(","EX","*","(","_1_0","-","t",")","+","t",",","_0_0",",","_1_0",")",";"]}]}]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_EZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["EZ","=","clamp","(","sH",",","_0_0",",","_1_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","t","=","max","(","max","(","ET",".","r",",","ET",".","g",")",",","ET",".","b",")","*","sI",";","EZ","=","sH","*","(","_1_0","-","t",")","+","t",";"]}]}]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_MATERIAL_SPECULAR"],STATEMENTS:[{TYPE:"txt",TOKENS:["F","=","ET",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["F","=","vec3","(","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["G","=","EU",";"]}]},{TYPE:"node",NAME:"LIGHTING_AMBIENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"oP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"oR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oS",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oT",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oS","=","vec4","(","oP","+","oR","*","oQ",",","_0_0",")",";","oT","=","vec3","(","_0_0",")",";"]}]},{TYPE:"node",NAME:"LIGHTING_LAMP",NODE_VARS:[{TYPE:"node_var",NAME:"LAMP_TYPE",TOKENS:["HEMI"]},{TYPE:"node_var",NAME:"LAMP_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"LAMP_SPOT_SIZE",TOKENS:["0.8"]},{TYPE:"node_var",NAME:"LAMP_SPOT_BLEND",TOKENS:["0.03"]},{TYPE:"node_var",NAME:"LAMP_LIGHT_DIST",TOKENS:["30.0"]},{TYPE:"node_var",NAME:"LAMP_SHADOW_MAP_IND",TOKENS:["-","1"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"oU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oW",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oX",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"oY",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["oW","=","vec2","(","u_light_positions","[","LAMP_IND","]",".","w",",","u_light_color_intensities","[","LAMP_IND","]",".","w",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","HEMI",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_5",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oY","=","_0_0",";"]}]}]},{TYPE:"txt",TOKENS:["oX","=","u_light_color_intensities","[","LAMP_IND","]",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_SHADOW_MAP_IND",1,{TYPE:"negative_expr",PLACES:1},{TYPE:"non_equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["oX","*=","oU","[","LAMP_SHADOW_MAP_IND","]",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2},"LAMP_TYPE","POINT",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","oZ","=","u_light_positions","[","LAMP_IND","]",".","xyz",";","oV","=","oZ","-","ow",";","float","aM","=","length","(","oV",")",";","oX","*=","LAMP_LIGHT_DIST","/","(","LAMP_LIGHT_DIST","+","aM","*","aM",")",";","oV","=","normalize","(","oV",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["LAMP_TYPE","SPOT",{TYPE:"equal_expr",PLACES:2}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pa","=","u_light_directions","[","LAMP_IND","]",";","float","pb","=","dot","(","oV",",","pa",")",";","pb","*=","smoothstep","(","_0_0",",","_1_0",",","(","pb","-","LAMP_SPOT_SIZE",")","/","LAMP_SPOT_BLEND",")",";","oX","*=","pb",";"]}]}]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["oV","=","u_light_directions","[","LAMP_IND","]",";"]}]}]}]},{TYPE:"node",NAME:"DIFFUSE_FRESNEL",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pd",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pe",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pf",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pg",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ph",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pc",",","k",".","xyz",")",";","pe","=","cross","(","pi",",","k",".","xyz",")",";","pe","=","-","normalize","(","pe",")",";"]}]}]},{TYPE:"txt",TOKENS:["ph","=","_0_0",";","if","(","pd",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pf",")","*","dot","(","pe",",","pc",")","+","pf",";","if","(","pg","[","0","]","==","_0_0",")","{","ph","=","_1_0",";","}","else","{","float","t","=","_1_0","+","abs","(","pj",")",";","t","=","pg","[","1","]","+","(","_1_0","-","pg","[","1","]",")","*","pow","(","t",",","pg","[","0","]",")",";","ph","=","clamp","(","t",",","_0_0",",","_1_0",")",";","}","ph","=","max","(","ph",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_LAMBERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pl",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"po",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pk",",","k",".","xyz",")",";","pm","=","cross","(","pi",",","k",".","xyz",")",";","pm","=","-","normalize","(","pm",")",";"]}]}]},{TYPE:"txt",TOKENS:["po","=","_0_0",";","if","(","pl",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pn",")","*","dot","(","pm",",","pk",")","+","pn",";","po","=","max","(","pj",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_OREN_NAYAR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pu",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"px",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"py",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pr",",","k",".","xyz",")",";","pv","=","cross","(","pi",",","k",".","xyz",")",";","pv","=","-","normalize","(","pv",")",";"]}]}]},{TYPE:"txt",TOKENS:["py","=","_0_0",";","if","(","pu",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pw",")","*","dot","(","pv",",","pr",")","+","pw",";","if","(","px","[","0","]",">","_0_0",")","{","float","pz","=","max","(","dot","(","pv",",","oy",")",",","_0_0",")",";","float","pA","=","px","[","0","]","*","px","[","0","]",";","float","cG","=","_1_0","-","_0_5","*","(","pA","/","(","pA","+","0.33",")",")",";","vec3","pB","=","pr","-","pj","*","pv",";","vec3","pC","=","oy","-","pz","*","pv",";","if","(","length","(","pB",")","==","_0_0","||","length","(","pC",")","==","_0_0","||","abs","(","pj",")",">","_1_0","||","abs","(","pz",")",">","_1_0",")","py","=","pj","*","cG",";","else","{","float","pD","=","acos","(","pj",")",";","float","pE","=","acos","(","pz",")",";","vec3","pF","=","normalize","(","pB",")",";","vec3","pG","=","normalize","(","pC",")",";","float","a",",","b",";","a","=","max","(","pD",",","pE",")",";","b","=","min","(","pD",",","pE",")",";","b","*=","0.95",";","float","t","=","max","(","dot","(","pF",",","pG",")",",","_0_0",")",";","float","hS","=","0.45","*","(","pA","/","(","pA","+","0.09",")",")",";","py","=","pj","*","(","cG","+","(","hS","*","t","*","sin","(","a",")","*","tan","(","b",")",")",")",";","}","}","else","py","=","pj",";","py","=","max","(","py",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_MINNAERT",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pI",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pK",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pL",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pM",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pH",",","k",".","xyz",")",";","pJ","=","cross","(","pi",",","k",".","xyz",")",";","pJ","=","-","normalize","(","pJ",")",";"]}]}]},{TYPE:"txt",TOKENS:["pM","=","_0_0",";","if","(","pI",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pK",")","*","dot","(","pJ",",","pH",")","+","pK",";","float","pz","=","max","(","dot","(","pJ",",","oy",")",",","_0_0",")",";","if","(","pL","[","0","]","<=","_1_0",")","pM","=","pj","*","pow","(","max","(","pz","*","pj",",","0.1",")",",","pL","[","0","]","-","_1_0",")",";","else","pM","=","pj","*","pow","(","1.0001","-","pz",",","pL","[","0","]","-","_1_0",")",";","pM","=","max","(","pM",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"DIFFUSE_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pO",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pP",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pQ",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pR",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pS",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","pi","=","cross","(","pN",",","k",".","xyz",")",";","pP","=","cross","(","pi",",","k",".","xyz",")",";","pP","=","-","normalize","(","pP",")",";"]}]}]},{TYPE:"txt",TOKENS:["pS","=","_0_0",";","if","(","pO",".","r","!=","_0_0",")","{","float","pj","=","(","_1_0","-","pQ",")","*","dot","(","pP",",","pN",")","+","pQ",";","float","pT","=","acos","(","pj",")",";","if","(","pT","<","pR","[","0","]",")","pS","=","_1_0",";","else","if","(","pT",">","(","pR","[","0","]","+","pR","[","1","]",")","||","pR","[","1","]","==","_0_0",")","pS","=","_0_0",";","else","pS","=","_1_0","-","(","(","pT","-","pR","[","0","]",")","/","pR","[","1","]",")",";","pS","=","max","(","pS",",","_0_0",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_PHONG",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"pU",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pV",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pX",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"pY",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"pZ",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["pZ","=","_0_0",";","if","(","pV",".","g","==","_1_0",")","{","vec3","p_","=","normalize","(","pU","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","pX","==","_0_0",")","{","pZ","=","dot","(","k",".","xyz",",","p_",")",";","pZ","=","sqrt","(","_1_0","-","pZ","*","pZ",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["pZ","=","(","_1_0","-","pX",")","*","max","(","dot","(","pW",",","p_",")",",","_0_0",")","+","pX",";"]}]}]},{TYPE:"txt",TOKENS:["pZ","=","pow","(","pZ",",","pY","[","0","]",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_COOKTORR",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qa",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qb",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qc",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qd",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qe",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qf",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qf","=","_0_0",";","if","(","qb",".","g","!=","_0_0",")","{","vec3","p_","=","normalize","(","qa","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","qd","==","_0_0",")","{","qf","=","dot","(","B",".","xyz",",","p_",")",";","qf","=","sqrt","(","_1_0","-","qf","*","qf",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qf","=","max","(","dot","(","qc",",","p_",")",",","_0_0",")",";","qf","=","(","_1_0","-","qd",")","*","qf","+","qd",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","pz","=","max","(","dot","(","B",".","xyz",",","oy",")",",","_0_0",")",";","pz","=","sqrt","(","_1_0","-","pz","*","pz",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","pz","=","max","(","dot","(","qc",",","oy",")",",","_0_0",")",";"]}]}]},{TYPE:"txt",TOKENS:["qf","=","pow","(","qf",",","qe","[","0","]",")",";","qf","=","qf","/","(","0.1","+","pz",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_WARDISO",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qh",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qi",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qk",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"ql",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["ql","=","_0_0",";","if","(","qh",".","g","==","_1_0",")","{","vec3","p_","=","normalize","(","qg","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","_0_0",";","float","pz","=","_0_0",";","float","qn","=","_0_0",";","if","(","qj","==","_0_0",")","{","qm","=","dot","(","k",".","xyz",",","p_",")",";","pz","=","dot","(","k",".","xyz",",","oy",")",";","qn","=","dot","(","k",".","xyz",",","qg",")",";","qm","=","sqrt","(","_1_0","-","qm","*","qm",")",";","pz","=","sqrt","(","_1_0","-","pz","*","pz",")",";","qn","=","sqrt","(","_1_0","-","qn","*","qn",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","max","(","dot","(","qi",",","p_",")",",","0.01",")",";","float","pz","=","max","(","dot","(","qi",",","oy",")",",","0.01",")",";","float","qn","=","max","(","dot","(","qi",",","qg",")",",","0.01",")",";"]}]}]},{TYPE:"txt",TOKENS:["float","bP","=","tan","(","acos","(","qm",")",")",";","float","L","=","max","(","qk","[","0","]",",","0.01",")",";","ql","=","qn","*","(","_1_0","/","(","4.0","*","M_PI","*","L","*","L",")",")","*","(","exp","(","-","(","bP","*","bP",")","/","(","L","*","L",")",")","/","(","sqrt","(","pz","*","qn",")",")",")",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_TOON",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qo",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qr",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qu",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qw",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qx",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qx","=","_0_0",";","if","(","qr",".","g","==","_1_0",")","{","vec3","co","=","normalize","(","qo","+","oy",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qy","=","dot","(","co",",","k",".","xyz",")",";","float","bP","=","qw","[","0","]","+","qw","[","1","]",";","if","(","qv","==","_0_0",")","bP","=","acos","(","sqrt","(","_1_0","-","qy","*","qy",")",")",";"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","bP","=","acos","(","dot","(","co",",","qu",")",")",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","bP","<","qw","[","0","]",")","qx","=","_1_0",";","else","if","(","bP",">=","qw","[","0","]","+","qw","[","1","]","||","qw","[","1","]","==","_0_0",")","qx","=","_0_0",";","else","qx","=","_1_0","-","(","bP","-","qw","[","0","]",")","/","qw","[","1","]",";","}"]}]},{TYPE:"node",NAME:"SPECULAR_BLINN",NODE_VARS:[{TYPE:"node_var",NAME:"MAT_USE_TBN_SHADING",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"qz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qA",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qC",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qD",QUALIFIER:["vec2"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qE",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["qE","=","_0_0",";","if","(","qA",".","g","==","_1_0",")","{","if","(","qD","[","0","]","<","_1_0","||","qD","[","1","]","==","_0_0",")","qE","=","_0_0",";","else","{","if","(","qD","[","1","]","<","100.0",")","qD","[","1","]","=","sqrt","(","_1_0","/","qD","[","1","]",")",";","else","qD","[","1","]","=","10.0","/","qD","[","1","]",";","vec3","p_","=","normalize","(","oy","+","qz",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["MAT_USE_TBN_SHADING"],STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","_0_0",";","if","(","qC","==","_0_0",")","{","float","qH","=","dot","(","k",".","xyz",",","p_",")",";","qm","=","sqrt","(","_1_0","-","qH","*","qH",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["float","qm","=","(","_1_0","-","qC",")","*","max","(","dot","(","qB",",","p_",")",",","_0_0",")","+","qC",";"]}]}]},{TYPE:"txt",TOKENS:["if","(","qm","<","_0_0",")","qE","=","_0_0",";","else","{","float","pz","=","max","(","dot","(","qB",",","oy",")",",","0.01",")",";","float","qn","=","dot","(","qB",",","qz",")",";","if","(","qn","<=","0.01",")","qE","=","_0_0",";","else","{","float","qI","=","max","(","dot","(","oy",",","p_",")",",","0.01",")",";","float","a","=","_1_0",";","float","b","=","(","2.0","*","qm","*","pz",")","/","qI",";","float","dx","=","(","2.0","*","qm","*","qn",")","/","qI",";","float","g","=","min","(","min","(","a",",","b",")",",","dx",")",";","float","p","=","sqrt","(","pow","(","qD","[","0","]",",","2.0",")","+","pow","(","qI",",","2.0",")","-","_1_0",")",";","float","mm","=","pow","(","p","-","qI",",","2.0",")","/","pow","(","p","+","qI",",","2.0",")","*","(","_1_0","+","pow","(","qI","*","(","p","+","qI",")","-","_1_0",",","2.0",")","/","pow","(","qI","*","(","p","-","qI",")","+","_1_0",",","2.0",")",")",";","float","pT","=","acos","(","qm",")",";","qE","=","max","(","mm","*","g","*","exp","(","-","pow","(","pT",",","2.0",")","/","(","2.0","*","pow","(","qD","[","1","]",",","2.0",")",")",")",",","_0_0",")",";","}","}","}","}"]}]},{TYPE:"node",NAME:"LIGHTING_APPLY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"qJ",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qK",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qL",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qM",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qO",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qP",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qQ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qR",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qS",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"qT",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qU",QUALIFIER:["vec4"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"qV",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_NODE_B4W_TRANSLUCENCY"],STATEMENTS:[{TYPE:"txt",TOKENS:["if","(","dot","(","qN",",","qO",")","*","dot","(","oy",",","qO",")","<","_0_0",")","{","float","Fc","=","qP",".","x",";","float","Fd","=","qP",".","y",";","float","Fe","=","qP",".","z",";","float","Ff","=","qP",".","w",";","float","Fg","=","clamp","(","abs","(","dot","(","qN",",","qO",")",")",",","_0_0",",","_1_0",")",";","float","Fh","=","clamp","(","dot","(","oy",",","-","qN",")",",","_0_0",",","_1_0",")",";","float","Fi","=","pow","(","Fh",",","Fd",")",";","qU","=","qJ","+","qT","*","vec4","(","qS","*","Fg","*","pow","(","qQ",",","vec3","(","Fc",")",")",",","_1_0",")",";","qU","+=","Fe","*","mix","(","vec4","(","qQ",",","_1_0",")",",","vec4","(","_1_0",")",",","Ff",")","*","qT","*","vec4","(","qS","*","Fg","*","vec3","(","Fi",")",",","_1_0",")",";","}","else","{","qU","=","qJ","+","vec4","(","qS","*","qQ","*","qL",",","qM",")",";","}"]}]},{TYPE:"node_else",STATEMENTS:[{TYPE:"txt",TOKENS:["qU","=","qJ","+","vec4","(","qS","*","qQ","*","qL",",","qM",")",";"]}]}]},{TYPE:"txt",TOKENS:["qV","=","qK","+","qS","*","qR","*","qM",";"]}]},{TYPE:"node",NAME:"RGB",NODE_VARS:[{TYPE:"node_var",NAME:"RGB_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Fj",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Fj","=","u_node_rgbs","[","RGB_IND","]",";"]}]},{TYPE:"node",NAME:"RGBTOBW",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fk",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fl",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Fl","=","dot","(","Fk",",","vec3","(","0.35",",","0.45",",","0.2",")",")",";"]}]},{TYPE:"node",NAME:"SEPRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fm",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fn",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fo",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fp",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fn"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fn","=","Fm",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fo"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fo","=","Fm",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fp"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fp","=","Fm",".","b",";"]}]}]}]},{TYPE:"node",NAME:"SEPHSV",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fq",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fr",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Fs",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ft",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Fu","=","kj","(","Fq",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fr"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fr","=","Fu",".","r",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Fs"],STATEMENTS:[{TYPE:"txt",TOKENS:["Fs","=","Fu",".","g",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ft"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ft","=","Fu",".","b",";"]}]}]}]},{TYPE:"node",NAME:"SQUEEZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fv",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Fw",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Fx",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Fy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Fy","=","_1_0","/","(","_1_0","+","pow","(","2.71828183",",","-","(","Fv","-","Fx",")","*","Fw",")",")",";"]}]},{TYPE:"node",NAME:"GAMMA",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Fz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"FA",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FB",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["FB","=","Fz",";","if","(","FB",".","x",">","_0_0",")","FB",".","x","=","pow","(","Fz",".","x",",","FA",")",";","if","(","FB",".","y",">","_0_0",")","FB",".","y","=","pow","(","Fz",".","y",",","FA",")",";","if","(","FB",".","z",">","_0_0",")","FB",".","z","=","pow","(","Fz",".","z",",","FA",")",";"]}]},{TYPE:"node",NAME:"B4W_SRGB_TO_LINEAR",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FC",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FD",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["FD","=","max","(","vec3","(","_0_0",")",",","FC",")",";","FD","=","pow","(","FD",",","vec3","(","2.2",")",")",";"]}]},{TYPE:"node",NAME:"B4W_LINEAR_TO_SRGB",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"FE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FF",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["FF","=","max","(","vec3","(","_0_0",")",",","FE",")",";","FF","=","pow","(","FF",",","vec3","(","_1_0","/","2.2",")",")",";"]}]},{TYPE:"node",NAME:"TEXTURE_EMPTY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"FG",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"FI",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FG"],STATEMENTS:[{TYPE:"txt",TOKENS:["FG","[","2","]","=","FG","[","1","]","=","FG","[","0","]","=","_0_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FH"],STATEMENTS:[{TYPE:"txt",TOKENS:["FH","[","2","]","=","FH","[","1","]","=","FH","[","0","]","=","_0_0",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FI"],STATEMENTS:[{TYPE:"txt",TOKENS:["FI","=","_0_0",";"]}]}]}]},{TYPE:"node",NAME:"TEXTURE_ENVIRONMENT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Il",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Im",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"In",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_ENVIRONMENT_var_texture",QUALIFIER:["uniform","samplerCube"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE_CUBE","(","node_TEXTURE_ENVIRONMENT_var_texture",",","Il",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Im"],STATEMENTS:[{TYPE:"txt",TOKENS:["Im","=","BN",".","xyz",";","bG","(","Im",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_In"],STATEMENTS:[{TYPE:"txt",TOKENS:["In","=","BN",".","w",";"]}]}]}]},{TYPE:"node",NAME:"TEXTURE_COLOR",NODE_VARS:[{TYPE:"node_var",NAME:"NON_COLOR",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"FT",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FU",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FV",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"FW",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FX",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FY",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"FZ",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"F_",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Ga",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gb",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gc",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gd",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_COLOR_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FT",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FX"],STATEMENTS:[{TYPE:"txt",TOKENS:["FX","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","FX",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FY"],STATEMENTS:[{TYPE:"txt",TOKENS:["FY","=","BN",".","w",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FU",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_FZ"],STATEMENTS:[{TYPE:"txt",TOKENS:["FZ","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","FZ",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_F_"],STATEMENTS:[{TYPE:"txt",TOKENS:["F_","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FV",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ga"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ga","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","Ga",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gb"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gb","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_COLOR_var_texture",",","so","(","FW",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gc"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gc","=","BN",".","xyz",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["NON_COLOR",{TYPE:"logic_negative_expr",PLACES:1}],STATEMENTS:[{TYPE:"txt",TOKENS:["bG","(","Gc",")",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gd"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gd","=","BN",".","w",";"]}]}]}]}]}]},{TYPE:"node",NAME:"TEXTURE_NORMAL",NODE_VARS:[{TYPE:"node_var",NAME:"USE_uv2",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv3",TOKENS:["0"]},{TYPE:"node_var",NAME:"USE_uv4",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_in",NAME:"Ge",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gf",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gg",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_in",NAME:"Gh",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gi",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gj",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gk",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gl",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gm",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gn",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Go",QUALIFIER:["vec3"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Gp",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_TEXTURE_NORMAL_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec4","BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Ge",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gi"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gi","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gj"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gj","=","BN",".","w",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv2"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Gf",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gk"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gk","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gl"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gl","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv3"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Gg",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gm"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gm","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gn"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gn","=","BN",".","w",";"]}]}]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_uv4"],STATEMENTS:[{TYPE:"txt",TOKENS:["BN","=","GLSL_TEXTURE","(","node_TEXTURE_NORMAL_var_texture",",","so","(","Gh",")",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Go"],STATEMENTS:[{TYPE:"txt",TOKENS:["Go","=","normalize","(","sO","*","(","BN",".","xyz","-","_0_5",")",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gp"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gp","=","BN",".","w",";"]}]}]}]}]}]},{TYPE:"node",NAME:"VALUE",NODE_VARS:[{TYPE:"node_var",NAME:"VALUE_ROW_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"VALUE_COL_IND",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_out",NAME:"Gq",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gq","=","u_node_values","[","VALUE_ROW_IND","]","[","VALUE_COL_IND","]",";"]}]},{TYPE:"node",NAME:"VECT_MATH_ADD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gr",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gs",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gt",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gu",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gt","=","Gr","+","Gs",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gu"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gu","=","(","abs","(","Gt","[","0","]",")","+","abs","(","Gt","[","1","]",")","+","abs","(","Gt","[","2","]",")",")","/","3.0",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_SUBTRACT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Gw",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Gy",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["Gx","=","Gv","-","Gw",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Gy"],STATEMENTS:[{TYPE:"txt",TOKENS:["Gy","=","(","abs","(","Gx","[","0","]",")","+","abs","(","Gx","[","1","]",")","+","abs","(","Gx","[","2","]",")",")","/","3.0",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_AVERAGE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Gz",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GA",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GB",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GC",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GB","=","Gz","+","GA",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GC"],STATEMENTS:[{TYPE:"txt",TOKENS:["GC","=","length","(","GB",")",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GB"],STATEMENTS:[{TYPE:"txt",TOKENS:["GB","=","normalize","(","GB",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_DOT_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GD",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GE",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GF",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GG",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GF","=","vec3","(","_0_0",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GG"],STATEMENTS:[{TYPE:"txt",TOKENS:["GG","=","dot","(","GD",",","GE",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_CROSS_PRODUCT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GH",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GI",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GJ",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GK",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GJ","=","cross","(","GH",",","GI",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GK"],STATEMENTS:[{TYPE:"txt",TOKENS:["GK","=","length","(","GJ",")",";"]}]}]}]},{TYPE:"node",NAME:"VECT_MATH_NORMALIZE",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GL",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GM",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GN",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GO",QUALIFIER:["float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"txt",TOKENS:["GN","=","normalize","(","GL",")",";"]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_GO"],STATEMENTS:[{TYPE:"txt",TOKENS:["GO","=","length","(","GL",")",";"]}]}]},{TYPE:"txt",TOKENS:["GM",";"]}]},{TYPE:"node",NAME:"B4W_REFLECT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GV",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"GW",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GX",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["GX","=","reflect","(","_","(","u_view_tsr_inverse",",","GV",")",",","GW",")",";"]}]},{TYPE:"node",NAME:"B4W_REFLECT_WORLD",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"GY",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"GZ",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["vec3","Io","=","-","oy",".","xyz",";","GZ","=","reflect","(","Io",",","GY",")",";"]}]},{TYPE:"node",NAME:"B4W_PARALLAX",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"G_",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ha",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hb",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hc",QUALIFIER:["const","float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hd",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_param",NAME:"node_B4W_PARALLAX_var_texture",QUALIFIER:["uniform","sampler2D"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["float","bS","=","length","(","sR",")",";","if","(","bS","<","Hc",")","{","vec2","ce","=","so","(","G_",")",";","float","ci","=","clamp","(","_0_5","*","(","Hc","-","bS",")",",","_0_0",",","_1_0",")",";","float","hK","=","Ha","*","ci",";","vec3","ck","=","normalize","(","oy","*","sO",")",";","float","cl","=","_1_0","/","Hb",";","vec2","cm","=","ck",".","xy","*","hK","/","(","Hb","*","ck",".","z",")",";","float","cn","=","_1_0",";","float","co","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","ce",")",".","a",";","for","(","float","cq","=","1.0",";","cq","<=","Hb",";","cq","++",")","{","if","(","co","<","cn",")","{","cn","-=","cl",";","ce","-=","cm",";","co","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","ce",")",".","a",";","}","}","vec2","cr","=","ce","+","cm",";","float","cs","=","GLSL_TEXTURE","(","node_B4W_PARALLAX_var_texture",",","cr",")",".","a","-","(","cn","+","cl",")",";","float","ct","=","co","-","cn",";","float","cu","=","ct","/","(","ct","-","cs",")",";","ce","=","cu","*","cr","+","(","_1_0","-","cu",")","*","ce",";","Hd","=","sn","(","ce",")",";","}","else","Hd","=","G_",";"]}]},{TYPE:"node",NAME:"B4W_CLAMP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"He",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hf",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hf","=","clamp","(","He",",","_0_0",",","_1_0",")",";"]}]},{TYPE:"node",NAME:"B4W_REFRACTION",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hg",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hh",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hi",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hi","=","Hg",";"]}]},{TYPE:"node",NAME:"B4W_TRANSLUCENCY",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hj",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hk",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hl",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hm",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hn",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Ho",QUALIFIER:["float"],IS_OPTIONAL:!0},{TYPE:"node_out",NAME:"Hp",QUALIFIER:["vec4"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Ho"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ho","=","Hj",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["USE_OUT_Hp"],STATEMENTS:[{TYPE:"txt",TOKENS:["Hp","=","vec4","(","Hk",",","Hl",",","Hm",",","Hn",")",";"]}]}]}]},{TYPE:"node",NAME:"B4W_TIME",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_out",NAME:"Hq",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hq","=","u_time",";"]}]},{TYPE:"node",NAME:"B4W_SMOOTHSTEP",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hr",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hs",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Ht",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hu",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hu","=","smoothstep","(","Hs",",","Ht",",","Hr",")",";"]}]},{TYPE:"node",NAME:"B4W_GLOW_OUTPUT",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hv",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_in",NAME:"Hw",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["E","=","Hv",";","I","=","Hw",";"]}]},{TYPE:"node",NAME:"B4W_VECTOSCAL",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hx",QUALIFIER:["vec3"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"Hy",QUALIFIER:["float"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["Hy","=","(","Hx",".","r","+","Hx",".","g","+","Hx",".","b",")","/","3.0",";"]}]},{TYPE:"node",NAME:"B4W_SCALTOVEC",NODE_VARS:[],DECLARATIONS:[{TYPE:"node_in",NAME:"Hz",QUALIFIER:["float"],IS_OPTIONAL:!1},{TYPE:"node_out",NAME:"HA",QUALIFIER:["vec3"],IS_OPTIONAL:!1}],STATEMENTS:[{TYPE:"txt",TOKENS:["HA","[","0","]","=","Hz",";","HA","[","1","]","=","Hz",";","HA","[","2","]","=","Hz",";"]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","J","(","in","vec3","oy",",","out","vec3","E",",","out","vec3","F",",","out","vec3","G",",","out","vec4","H",",","out","float","I",")","{","E","=","vec3","(","_0_0",")",";","F","=","vec3","(","_0_0",")",";","G","=","vec3","(","_0_0",")",";","H","=","vec4","(","_0_0",")",";","I","=","_0_0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP","USE_NODE_BSDF_BEGIN","USE_NODE_FRESNEL","USE_NODE_TEX_COORD_RE","USE_NODE_LAYER_WEIGHT","USE_NODE_BUMP",{TYPE:"logical_or_expr",PLACES:11}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sL","=","j",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing","==","false",")"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","gl_FrontFacing",")"]}]}}]},{TYPE:"txt",TOKENS:["sL","=","sL",";","else","sL","=","-","sL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sM","=","sL",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:4}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sN","=","normalize","(","sL",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DOUBLE_SIDED_LIGHTING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ox","=","sN",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","ox","=","normalize","(","j",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_NO"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","sK","=","sN",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CALC_TBN_SPACE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","W","=","cross","(","sN",",","k",".","xyz",")","*","k",".","w",";","mat3","sO","=","mat3","(","k",".","xyz",",","W",",","sN",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_NORMAL_MAP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","W","=","cross","(","sL",",","k",".","xyz",")","*","k",".","w",";","mat3","sQ","=","mat3","(","k",".","xyz",",","W",",","sL",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["vec3","ow","=","h",";","vec4","sR","=","i",";","float","sS","=","u_emit",";","float","sT","=","u_ambient",";"]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/particles_nodes.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PARTICLES_NODES_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PARTICLES_NODES_GLSLV",TOKENS:[""]},{TYPE:"node",NAME:"TEX_COORD_UV",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","Iu",";"]}]},{TYPE:"node",NAME:"UV_MERGED",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","Iu",";"]}]},{TYPE:"node",NAME:"UVMAP",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","Iu",";"]}]},{TYPE:"node",NAME:"GEOMETRY_UV",NODE_VARS:[],DECLARATIONS:[],STATEMENTS:[{TYPE:"txt",TOKENS:["A","=","Iu",";"]}]},{TYPE:"node",NAME:"PARTICLE_INFO",NODE_VARS:[{TYPE:"node_var",NAME:"PART_INFO_SIZE",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_AGE",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_LT",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_LOC",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_IND",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_VEL",TOKENS:["0"]},{TYPE:"node_var",NAME:"PART_INFO_A_VEL",TOKENS:["0"]}],DECLARATIONS:[{TYPE:"node_param",NAME:"HY",QUALIFIER:["GLSL_OUT","vec4"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"HZ",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"H_",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"Ia",QUALIFIER:["GLSL_OUT","vec3"],IS_OPTIONAL:!0},{TYPE:"node_param",NAME:"node_PARTICLE_INFO_var_a_p_indices",QUALIFIER:["GLSL_IN","float"],IS_OPTIONAL:!0}],STATEMENTS:[{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_SIZE"],STATEMENTS:[{TYPE:"txt",TOKENS:["HY","[","3","]","=","It",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_AGE"],STATEMENTS:[{TYPE:"txt",TOKENS:["HY","[","1","]","=","Is",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_LT"],STATEMENTS:[{TYPE:"txt",TOKENS:["HY","[","2","]","=","Iv",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_LOC"],STATEMENTS:[{TYPE:"txt",TOKENS:["HZ","=","Ip",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_IND"],STATEMENTS:[{TYPE:"txt",TOKENS:["HY","[","0","]","=","node_PARTICLE_INFO_var_a_p_indices",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_VEL"],STATEMENTS:[{TYPE:"txt",TOKENS:["H_","=","Iq",";"]}]}]},{TYPE:"node_cond",PARTS:[{TYPE:"node_if",EXPRESSION:["PART_INFO_A_VEL"],STATEMENTS:[{TYPE:"txt",TOKENS:["Ia","=","Ir",";"]}]}]}]},{TYPE:"nodes_global"},{TYPE:"txt",TOKENS:["void","J","(","in","vec3","Ip",",","in","vec3","Iq",",","in","vec3","Ir",",","in","float","Is",",","in","float","It",",","in","vec2","Iu",",","in","float","Iv",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["A","=","Iu",";"]}]}}]},{TYPE:"nodes_main"},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/precision_statement.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PRECISION_STATEMENT_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PRECISION_STATEMENT_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"txt",TOKENS:["precision","PRECISION","float",";"]}]}}]}]},e["include/procedural.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"PROCEDURAL_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"PROCEDURAL_GLSLF",TOKENS:[""]},{TYPE:"txt",TOKENS:["vec4","Iw","(","vec4","x",")","{","return","x","-","floor","(","x","*","(","_1_0","/","289.0",")",")","*","289.0",";","}","vec3","Iw","(","vec3","x",")","{","return","x","-","floor","(","x","*","(","_1_0","/","289.0",")",")","*","289.0",";","}","vec2","Iw","(","vec2","x",")","{","return","x","-","floor","(","x","*","(","_1_0","/","289.0",")",")","*","289.0",";","}","vec4","Ix","(","vec4","x",")","{","return","x","-","floor","(","x","*","(","_1_0","/","7.0",")",")","*","7.0",";","}","vec4","Iy","(","vec4","x",")","{","return","Iw","(","(","34.0","*","x","+","5.0",")","*","x",")",";","}"]},{TYPE:"define",NAME:"K",TOKENS:["0.142857142857"]},{TYPE:"define",NAME:"K2",TOKENS:["0.0714285714285"]},{TYPE:"define",NAME:"JITTER",TOKENS:["0.7"]},{TYPE:"txt",TOKENS:["vec2","fK","(","vec2","Iz",")","{","vec2","IA","=","Iw","(","floor","(","Iz",")",")",";","vec2","IB","=","fract","(","Iz",")",";","vec4","IC","=","IB",".","x","+","vec4","(","-","0.5",",","-","1.5",",","-","0.5",",","-","1.5",")",";","vec4","ID","=","IB",".","y","+","vec4","(","-","0.5",",","-","0.5",",","-","1.5",",","-","1.5",")",";","vec4","p","=","Iy","(","IA",".","x","+","vec4","(","_0_0",",","_1_0",",","_0_0",",","_1_0",")",")",";","p","=","Iy","(","p","+","IA",".","y","+","vec4","(","_0_0",",","_0_0",",","_1_0",",","_1_0",")",")",";","vec4","IE","=","Ix","(","p",")","*","K","+","K2",";","vec4","IF","=","Ix","(","floor","(","p","*","K",")",")","*","K","+","K2",";","vec4","IG","=","IC","+","JITTER","*","IE",";","vec4","IH","=","ID","+","JITTER","*","IF",";","vec4","dC","=","IG","*","IG","+","IH","*","IH",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:[1],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["dC",".","xy","=","min","(","dC",".","xy",",","dC",".","zw",")",";","dC",".","x","=","min","(","dC",".","x",",","dC",".","y",")",";","return","dC",".","xx",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["dC",".","xy","=","(","dC",".","x","<","dC",".","y",")","?","dC",".","xy",":","dC",".","yx",";","dC",".","xz","=","(","dC",".","x","<","dC",".","z",")","?","dC",".","xz",":","dC",".","zx",";","dC",".","xw","=","(","dC",".","x","<","dC",".","w",")","?","dC",".","xw",":","dC",".","wx",";","dC",".","y","=","min","(","dC",".","y",",","dC",".","z",")",";","dC",".","y","=","min","(","dC",".","y",",","dC",".","w",")",";","return","sqrt","(","dC",".","xy",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","vec3","la","(","vec2","Iz",",","float","II",")","{","vec2","IA","=","Iw","(","floor","(","Iz",")",")",";","vec2","IB","=","fract","(","Iz",")",";","vec4","IC","=","IB",".","x","+","vec4","(","-","0.5",",","-","1.5",",","-","0.5",",","-","1.5",")",";","vec4","ID","=","IB",".","y","+","vec4","(","-","0.5",",","-","0.5",",","-","1.5",",","-","1.5",")",";","vec4","p","=","Iy","(","IA",".","x","+","vec4","(","_0_0",",","_1_0",",","_0_0",",","_1_0",")",")",";","p","=","Iy","(","p","+","IA",".","y","+","vec4","(","_0_0",",","_0_0",",","_1_0",",","_1_0",")",")",";","vec4","IE","=","Ix","(","p",")","*","K","+","K2",";","vec4","IF","=","Ix","(","floor","(","p","*","K",")",")","*","K","+","K2",";","vec4","IG","=","IC","+","JITTER","*","IE",";","vec4","IH","=","ID","+","JITTER","*","IF",";","vec4","IJ","=","IG","*","IG","+","IH","*","IH",";","IG","+=","II",";","IH","+=","II",";","vec4","IK","=","IG","*","IG","+","IH","*","IH",";","IG","+=","II",";","IH","+=","II",";","vec4","IL","=","IG","*","IG","+","IH","*","IH",";","IJ",".","xy","=","min","(","IJ",".","xy",",","IJ",".","zw",")",";","IJ",".","x","=","min","(","IJ",".","x",",","IJ",".","y",")",";","IK",".","xy","=","min","(","IK",".","xy",",","IK",".","zw",")",";","IK",".","x","=","min","(","IK",".","x",",","IK",".","y",")",";","IL",".","xy","=","min","(","IL",".","xy",",","IL",".","zw",")",";","IL",".","x","=","min","(","IL",".","x",",","IL",".","y",")",";","return","vec3","(","IJ",".","x",",","IK",".","x",",","IL",".","x",")",";","}","vec3","IM","(","vec3","x",")","{","return","Iw","(","(","(","x","*","34.0",")","+","_1_0",")","*","x",")",";","}","float","fz","(","vec2","kU",")","{","const","vec4","IN","=","vec4","(","0.211324865405187",",","0.366025403784439",",","-","0.577350269189626",",","0.024390243902439",")",";","vec2","cq","=","floor","(","kU","+","dot","(","kU",",","IN",".","yy",")",")",";","vec2","IO","=","kU","-","cq","+","dot","(","cq",",","IN",".","xx",")",";","vec2","IP",";","IP","=","(","IO",".","x",">","IO",".","y",")","?","vec2","(","_1_0",",","_0_0",")",":","vec2","(","_0_0",",","_1_0",")",";","vec4","IQ","=","IO",".","xyxy","+","IN",".","xxzz",";","IQ",".","xy","-=","IP",";","cq","=","Iw","(","cq",")",";","vec3","p","=","IM","(","IM","(","cq",".","y","+","vec3","(","_0_0",",","IP",".","y",",","_1_0",")",")","+","cq",".","x","+","vec3","(","_0_0",",","IP",".","x",",","_1_0",")",")",";","vec3","aA","=","max","(","0.5","-","vec3","(","dot","(","IO",",","IO",")",",","dot","(","IQ",".","xy",",","IQ",".","xy",")",",","dot","(","IQ",".","zw",",","IQ",".","zw",")",")",",","_0_0",")",";","aA","=","aA","*","aA",";","aA","=","aA","*","aA",";","vec3","x","=","2.0","*","fract","(","p","*","IN",".","www",")","-","_1_0",";","vec3","co","=","abs","(","x",")","-","0.5",";","vec3","IE","=","floor","(","x","+","0.5",")",";","vec3","IR","=","x","-","IE",";","aA","*=","1.79284291400159","-","0.85373472095314","*","(","IR","*","IR","+","co","*","co",")",";","vec3","g",";","g",".","x","=","IR",".","x","*","IO",".","x","+","co",".","x","*","IO",".","y",";","g",".","yz","=","IR",".","yz","*","IQ",".","xz","+","co",".","yz","*","IQ",".","yw",";","return","130.0","*","dot","(","aA",",","g",")",";","}","vec2","IU","(","vec2","f_",")","{","float","IJ","=","dot","(","f_",",","vec2","(","12.9898",",","78.233",")",")",";","float","IK","=","dot","(","f_",",","vec2","(","12.9898",",","78.233",")","*","2.0",")",";","float","IS","=","fract","(","sin","(","IJ",")","*","43758.5453",")","*","2.0","-","_1_0",";","float","IT","=","fract","(","sin","(","IK",")","*","43758.5453",")","*","2.0","-","_1_0",";","return","vec2","(","IS",",","IT",")",";","}","float","lk","(","vec2","IV",")","{","return","fract","(","sin","(","dot","(","IV",",","vec2","(","12.9898",",","78.233",")",")",")","*","43758.5453",")",";","}"]}]}}]}]},e["include/refraction.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"REFRACTION_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"REFRACTION_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"REFRACTIVE",TOKENS:["0"]},{TYPE:"var",NAME:"USE_REFRACTION_CORRECTION",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFRACTIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION_CORRECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"pack.glslf"}]}}]},{TYPE:"include",FILE:"color_util.glslf"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION_CORRECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","eW","(","in","float","cW",",","inout","vec2","eV",",","in","vec2","eM",")","{","vec4","IW","=","GLSL_TEXTURE","(","u_scene_depth",",","eV",")",";","float","eX","=","cV","(","IW",")",";","if","(","eX","<","m",")","{","eV","=","eM",";","return","cW",";","}","else","{","return","eX",";","}","return","cW",";","}"]}]}}]},{TYPE:"txt",TOKENS:["vec3","cS","(","in","vec3","ru",",","in","vec2","IX",")","{","vec2","eM","=","ru",".","xy","/","ru",".","z",";","vec2","eV","=","eM","+","IX",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["USE_REFRACTION_CORRECTION"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","cU","=","GLSL_TEXTURE_PROJ","(","u_scene_depth",",","ru",")",";","float","cW","=","cV","(","cU",")",";","eW","(","cW",",","eV",",","eM",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","fa","=","GLSL_TEXTURE","(","u_refractmap",",","eV",")",".","rgb",";","bG","(","fa",")",";","return","fa",";","}"]}]}}]}]}}]}]},e["include/scale_texcoord.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SCALE_TEXCOORD_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SCALE_TEXCOORD_GLSLV",TOKENS:[""]},{TYPE:"txt",TOKENS:["vec2","az","(","vec2","ce",",","vec3","IY",")","{","return","(","ce","+","0.5",")","*","IY",".","xy","-","0.5",";","}"]}]}}]}]},e["include/shadow.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SHADOW_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SHADOW_GLSLF",TOKENS:[""]},{TYPE:"var",NAME:"PRECISION",TOKENS:["highp"]},{TYPE:"var",NAME:"SHADOW_TEX_RES",TOKENS:["2048.0"]},{TYPE:"var",NAME:"CSM_FADE_LAST_CASCADE",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_BLEND_BETWEEN_CASCADES",TOKENS:["0"]},{TYPE:"var",NAME:"RGBA_SHADOWS",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"var",NAME:"COMPARED_MODE",TOKENS:["0"]},{TYPE:"var",NAME:"POISSON_DISK_NUM",TOKENS:["NO_SOFT_SHADOWS"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"procedural.glslf"}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["const","float","IZ","=","0.1",";","const","float","I_","=","0.1",";","const","float","Ja","=","-","0.01",";","const","float","Jb","=","0.05",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","POISSON_X_16",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","Jc","=","vec4","(","0.14383161",",","0.34495938",",","-","0.38277543",",","-","0.26496911",")",";","vec4","Jd","=","vec4","(","0.53742981",",","0.19984126",",","0.79197514",",","-","0.094184101",")",";","vec4","Je","=","vec4","(","-","0.94201624",",","-","0.91588581",",","-","0.2418884",",","0.44323325",")",";","vec4","Jf","=","vec4","(","-","0.81544232",",","0.94558609",",","-","0.81409955",",","0.97484398",")",";","vec4","Jg","=","vec4","(","-","0.1410079",",","0.2938776",",","0.27676845",",","-","0.41893023",")",";","vec4","Jh","=","vec4","(","-","0.4737342",",","0.78641367",",","0.19090188",",","-","0.9293887",")",";","vec4","Ji","=","vec4","(","-","0.39906216",",","0.45771432",",","0.99706507",",","-","0.97511554",")",";","vec4","Jj","=","vec4","(","-","0.87912464",",","-","0.76890725",",","0.9143759",",","0.7564837",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POISSON_DISK_NUM","POISSON_X_8",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","Jc","=","vec2","(","-","0.37192261",",","0.47109537",")",";","vec2","Jd","=","vec2","(","-","0.6807477",",","0.69048062",")",";","vec2","Je","=","vec2","(","0.11615683",",","-","0.91318524",")",";","vec2","Jf","=","vec2","(","0.93688596",",","-","0.16948928",")",";","vec2","Jg","=","vec2","(","-","0.89699117",",","0.74092316",")",";","vec2","Jh","=","vec2","(","0.38263656",",","-","0.66119884",")",";","vec2","Ji","=","vec2","(","-","0.08193062",",","-","0.21275223",")",";","vec2","Jj","=","vec2","(","0.05578877",",","0.84225623",")",";"]}]}},{TYPE:"elif",EXPRESSION:["POISSON_DISK_NUM","POISSON_X_4",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","Jc","=","vec2","(","-","0.51808083",",","0.0",")",";","vec2","Jd","=","vec2","(","0.5741194",",","0.0",")",";","vec2","Je","=","vec2","(","-","0.68048857",",","0.0",")",";","vec2","Jf","=","vec2","(","0.82934988",",","0.0",")",";","vec2","Jg","=","vec2","(","0.70009436",",","0.0",")",";","vec2","Jh","=","vec2","(","-","0.78790467",",","0.0",")",";","vec2","Ji","=","vec2","(","-","0.58619489",",","0.0",")",";","vec2","Jj","=","vec2","(","0.41902178",",","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["bool","Jl","(","vec2","iO",",","float","Jk",")","{","return","all","(","lessThanEqual","(","iO",",","vec2","(","1.0","+","Jk",")",")",")","&&","all","(","greaterThanEqual","(","iO",",","vec2","(","0.0","-","Jk",")",")",")",";","}","float","Js","(","float","Jm",",","float","Jn",",","mat2","Jo",",","vec3","Jp",",","float","Jq",",","PRECISION","GLSL_SMPLR2D_SHDW","Jr",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iO",",","fM",";","fM",".","x","=","Jm",";","fM",".","y","=","Jn",";","fM","=","Jo","*","fM",";","iO","=","Jp",".","xy","+","fM","*","Jq","/","SHADOW_TEX_RES",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec2","iO","=","Jp",".","xy",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","!","Jl","(","iO",",","Ja",")",")","return","1.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["RGBA_SHADOWS"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","et","=","cV","(","GLSL_TEXTURE","(","Jr",",","iO",")",")",";","return","step","(","Jp",".","z",",","et",")",";"]}]}},{TYPE:"elif",EXPRESSION:["COMPARED_MODE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","GLSL_TEXTURE","(","Jr",",","vec3","(","iO",",","Jp",".","z",")",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","step","(","Jp",".","z",",","GLSL_TEXTURE","(","Jr",",","iO",")",".","r",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","float","Jx","(","vec3","Jp",",","PRECISION","GLSL_SMPLR2D_SHDW","Jr",",","float","Jq",")","{","float","Jt","=","0.0",";","Jp",".","z","=","clamp","(","Jp",".","z",",","0.0",",","1.0",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","Ju","=","IU","(","Jp",".","xy",")",".","x","*","M_PI",";","float","Jv","=","cos","(","Ju",")",";","float","Jw","=","sin","(","Ju",")",";","mat2","Jo","=","mat2","(","Jv",",","Jw",",","-","Jw",",","Jv",")",";","for","(","int","cq","=","0",";","cq","<","POISSON_DISK_NUM",";","cq","++",")","{","Jt","+=","Js","(","Jc","[","cq","]",",","Jg","[","cq","]",",","Jo",",","Jp",",","Jq",",","Jr",")",";","Jt","+=","Js","(","Jd","[","cq","]",",","Jh","[","cq","]",",","Jo",",","Jp",",","Jq",",","Jr",")",";","Jt","+=","Js","(","Je","[","cq","]",",","Ji","[","cq","]",",","Jo",",","Jp",",","Jq",",","Jr",")",";","Jt","+=","Js","(","Jf","[","cq","]",",","Jj","[","cq","]",",","Jo",",","Jp",",","Jq",",","Jr",")",";","}","return","clamp","(","Jt","/","(","float","(","POISSON_DISK_NUM",")","*","4.0",")",",","0.0",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","Js","(","0.0",",","0.0",",","mat2","(","0.0",")",",","Jp",",","Jq",",","Jr",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}","float","JG","(","vec3","Jy",",","PRECISION","GLSL_SMPLR2D_SHDW","Jz",",","vec3","JA",",","PRECISION","GLSL_SMPLR2D_SHDW","JB",",","float","JC",",","float","JD",",","float","aL",")","{","float","JE",",","JF",";","Jy",".","z","=","clamp","(","Jy",".","z",",","0.0",",","1.0",")",";","JA",".","z","=","clamp","(","JA",".","z",",","0.0",",","1.0",")",";","JE","=","0.0",";","JF","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","Ju","=","IU","(","Jy",".","xy",")",".","x","*","M_PI",";","float","Jv","=","cos","(","Ju",")",";","float","Jw","=","sin","(","Ju",")",";","mat2","Jo","=","mat2","(","Jv",",","Jw",",","-","Jw",",","Jv",")",";","for","(","int","cq","=","0",";","cq","<","POISSON_DISK_NUM",";","cq","++",")","{","JE","+=","Js","(","Jc","[","cq","]",",","Jg","[","cq","]",",","Jo",",","Jy",",","JC",",","Jz",")",";","JE","+=","Js","(","Jd","[","cq","]",",","Jh","[","cq","]",",","Jo",",","Jy",",","JC",",","Jz",")",";","JE","+=","Js","(","Je","[","cq","]",",","Ji","[","cq","]",",","Jo",",","Jy",",","JC",",","Jz",")",";","JE","+=","Js","(","Jf","[","cq","]",",","Jj","[","cq","]",",","Jo",",","Jy",",","JC",",","Jz",")",";","}","for","(","int","cq","=","0",";","cq","<","POISSON_DISK_NUM",";","cq","++",")","{","JF","+=","Js","(","Jc","[","cq","]",",","Jg","[","cq","]",",","Jo",",","JA",",","JD",",","JB",")",";","JF","+=","Js","(","Jd","[","cq","]",",","Jh","[","cq","]",",","Jo",",","JA",",","JD",",","JB",")",";","JF","+=","Js","(","Je","[","cq","]",",","Ji","[","cq","]",",","Jo",",","JA",",","JD",",","JB",")",";","JF","+=","Js","(","Jf","[","cq","]",",","Jj","[","cq","]",",","Jo",",","JA",",","JD",",","JB",")",";","}","JE","=","mix","(","JE",",","JF",",","aL",")",";","JE","/=","(","float","(","POISSON_DISK_NUM",")","*","4.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JE","+=","Js","(","0.0",",","0.0",",","mat2","(","0.0",")",",","Jy",",","JC",",","Jz",")",";","JF","+=","Js","(","0.0",",","0.0",",","mat2","(","0.0",")",",","JA",",","JD",",","JB",")",";","JE","=","mix","(","JE",",","JF",",","aL",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","clamp","(","JE",",","0.0",",","1.0",")",";","}","float","JH","(","vec2","iO",")","{","float","a","=","min","(","iO",".","x",",","iO",".","y",")",";","float","b","=","min","(","1.0","-","iO",".","x",",","1.0","-","iO",".","y",")",";","return","min","(","a",",","b",")",";","}","float","JJ","(","float","vo",",","float","JI",")","{","if","(","JI",">=","0.0","&&","JI","<=","I_",")","vo","=","(","vo","-","1.0",")","/","I_","*","JI","+","1.0",";","return","vo",";","}","float","JO","(","vec3","JK",",","vec3","JL",",","PRECISION","GLSL_SMPLR2D_SHDW","Jz",",","PRECISION","GLSL_SMPLR2D_SHDW","JB",",","float","JC",",","float","JD",",","float","JM",",","float","et",")","{","float","vo",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_BLEND_BETWEEN_CASCADES"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JI","=","JH","(","JK",".","xy",")",";","if","(","-","et",">","JM","&&","JI",">=","0.0","&&","JI","<=","IZ","&&","Jl","(","JL",".","xy",",","0.0",")",")","{","float","JN","=","1.0","-","JI","/","IZ",";","vo","=","JG","(","JK",",","Jz",",","JL",",","JB",",","JC",",","JD",",","JN",")",";","}","else"]}]}}]},{TYPE:"txt",TOKENS:["vo","=","Jx","(","JK",",","Jz",",","JC",")",";","return","vo",";","}","float","JQ","(","vec3","JP",",","PRECISION","GLSL_SMPLR2D_SHDW","Jr",",","float","Jq",",","float","JM",",","float","et",")","{","float","vo","=","Jx","(","JP",",","Jr",",","Jq",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_FADE_LAST_CASCADE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","-","et",">","JM",")","{","float","JI","=","JH","(","JP",".","xy",")",";","vo","=","JJ","(","vo",",","JI",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["return","vo",";","}","vec4","ev","(","float","et",")","{","float","vo","=","1.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["POISSON_DISK_NUM","NO_SOFT_SHADOWS",{TYPE:"non_equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","JR","=","u_pcf_blur_radii",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","JR","=","vec4","(","0.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec3","Jy","=","n",".","xyz","/","n",".","w",";","if","(","n",".","w","<","0.0",")","Jy",".","z","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1","NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","JA","=","o",".","xyz","/","o",".","w",";","if","(","o",".","w","<","0.0",")","JA",".","z","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2","NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","JS","=","u",".","xyz","/","u",".","w",";","if","(","u",".","w","<","0.0",")","JS",".","z","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3","NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","JT","=","v",".","xyz","/","v",".","w",";","if","(","v",".","w","<","0.0",")","JT",".","z","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","Jl","(","Jy",".","xy",",","0.0",")",")","{","vo","=","JO","(","Jy",",","JA",",","u_shadow_map0",",","u_shadow_map1",",","JR","[","0","]",",","JR","[","1","]",",","u_csm_center_dists","[","0","]",",","et",")",";","}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","Jl","(","Jy",".","xy",",","Jb",")",")","{","vo","=","JQ","(","Jy",",","u_shadow_map0",",","JR","[","0","]",",","u_csm_center_dists","[","0","]",",","et",")",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","{","if","(","Jl","(","JA",".","xy",",","0.0",")",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vo","=","JO","(","JA",",","JS",",","u_shadow_map1",",","u_shadow_map2",",","JR","[","1","]",",","JR","[","2","]",",","u_csm_center_dists","[","1","]",",","et",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vo","=","JQ","(","JA",",","u_shadow_map1",",","JR","[","1","]",",","u_csm_center_dists","[","1","]",",","et",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","{","if","(","Jl","(","JS",".","xy",",","0.0",")",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vo","=","JO","(","JS",",","JT",",","u_shadow_map2",",","u_shadow_map3",",","JR","[","2","]",",","JR","[","3","]",",","u_csm_center_dists","[","2","]",",","et",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vo","=","JQ","(","JS",",","u_shadow_map2",",","JR","[","2","]",",","u_csm_center_dists","[","2","]",",","et",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","{","if","(","Jl","(","JT",".","xy",",","0.0",")",")","vo","=","JQ","(","JT",",","u_shadow_map3",",","JR","[","3","]",",","u_csm_center_dists","[","3","]",",","et",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JU","=","Jx","(","JA",",","u_shadow_map1",",","JR","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JU","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JV","=","Jx","(","JS",",","u_shadow_map2",",","JR","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JV","=","0.0",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JW","=","Jx","(","JT",",","u_shadow_map3",",","JR","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","JW","=","1.0",";"]}]}}]},{TYPE:"txt",TOKENS:["return","vec4","(","vo",",","JU",",","JV",",","JW",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["vec4","cH","(","inout","vec3","cD",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","Jt","=","GLSL_TEXTURE","(","u_shadow_mask",",","l",".","xy","/","l",".","z",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",3,{TYPE:"l_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["cD","*=","Jt",".","a",";"]}]}}]},{TYPE:"txt",TOKENS:["return","Jt",";"]}]}},{TYPE:"elif",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","Jt","=","ev","(","i",".","z",")",";","return","Jt",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","vec4","(","1.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]},e["include/shadow.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SHADOW_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SHADOW_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"MAC_OS_SHADOW_HACK",TOKENS:["0"]},{TYPE:"var",NAME:"SHADOW_TEX_RES",TOKENS:["2048.0"]},{TYPE:"var",NAME:"SHADOW_USAGE",TOKENS:["NO_SHADOWS"]},{TYPE:"var",NAME:"NUM_CAST_LAMPS",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION1",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION2",TOKENS:["0"]},{TYPE:"var",NAME:"CSM_SECTION3",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{TYPE:"equal_expr",PLACES:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"},{TYPE:"txt",TOKENS:["vec4","J_","(","mat4","JX",",","vec4","JY",",","mat4","JZ",")","{","vec2","ey","=","(","JX","*","JZ","[","3","]",")",".","xy",";","float","ez","=","SHADOW_TEX_RES","/","2.0",";","ey","=","floor","(","ey","*","ez","+","0.5",")","/","ez","-","ey",";","vec4","Jp","=","JX","*","JY",";","Jp",".","xy","+=","ey",";","Jp",".","xyz","=","0.5","*","(","Jp",".","xyz","+","Jp",".","w",")",";","return","Jp",";","}","void","cd","(","vec3","fr",",","vec3","Ka",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","JZ","=","bh","(","u_v_light_tsr","[","0","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat4","JZ","=","bh","(","mat3","(","u_v_light_ts","[","0","]",".","xyz",",","vec3","(","u_v_light_ts","[","0","]",".","w",")",",","u_v_light_r","[","0","]",".","xyz","*","(","2.","*","float","(","u_v_light_r","[","0","]",".","w",">=","0.",")","-","1.",")",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["vec4","Kb","=","JZ","*","vec4","(","fr","+","u_normal_offset","*","Ka",",","1.0",")",";","n","=","J_","(","u_p_light_matrix0",",","Kb",",","JZ",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",1,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JZ","=","bh","(","u_v_light_tsr","[","1","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JZ","=","bh","(","mat3","(","u_v_light_ts","[","1","]",".","xyz",",","vec3","(","u_v_light_ts","[","1","]",".","w",")",",","u_v_light_r","[","1","]",".","xyz","*","(","2.","*","float","(","u_v_light_r","[","1","]",".","w",">=","0.",")","-","1.",")",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["Kb","=","JZ","*","vec4","(","fr","+","u_normal_offset","*","Ka",",","1.0",")",";","o","=","J_","(","u_p_light_matrix1",",","Kb",",","JZ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",2,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JZ","=","bh","(","u_v_light_tsr","[","2","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JZ","=","bh","(","mat3","(","u_v_light_ts","[","2","]",".","xyz",",","vec3","(","u_v_light_ts","[","2","]",".","w",")",",","u_v_light_r","[","2","]",".","xyz","*","(","2.","*","float","(","u_v_light_r","[","2","]",".","w",">=","0.",")","-","1.",")",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["Kb","=","JZ","*","vec4","(","fr","+","u_normal_offset","*","Ka",",","1.0",")",";","u","=","J_","(","u_p_light_matrix2",",","Kb",",","JZ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["NUM_CAST_LAMPS",3,{TYPE:"g_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAC_OS_SHADOW_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JZ","=","bh","(","u_v_light_tsr","[","3","]",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["JZ","=","bh","(","mat3","(","u_v_light_ts","[","3","]",".","xyz",",","vec3","(","u_v_light_ts","[","3","]",".","w",")",",","u_v_light_r","[","3","]",".","xyz","*","(","2.","*","float","(","u_v_light_r","[","3","]",".","w",">=","0.",")","-","1.",")",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["Kb","=","JZ","*","vec4","(","fr","+","u_normal_offset","*","Ka",",","1.0",")",";","v","=","J_","(","u_p_light_matrix3",",","Kb",",","JZ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION1"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["o","=","J_","(","u_p_light_matrix1",",","Kb",",","JZ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION2"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["u","=","J_","(","u_p_light_matrix2",",","Kb",",","JZ",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CSM_SECTION3"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["v","=","J_","(","u_p_light_matrix3",",","Kb",",","JZ",")",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]},e["include/skin.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SKIN_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SKIN_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"DISABLE_TANGENT_SKINNING",TOKENS:["0"]},{TYPE:"var",NAME:"SKINNED",TOKENS:["0"]},{TYPE:"var",NAME:"FRAMES_BLENDING",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKINNED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"include",FILE:"math.glslv"},{TYPE:"define",NAME:"SKIN_SLERP",TOKENS:["0"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKIN_SLERP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","Ki","(","in","vec4","qZ",",","in","vec4","rF",",","in","float","Kc",")","{","float","Kd","=","qZ","[","0","]","*","rF","[","0","]","+","qZ","[","1","]","*","rF","[","1","]","+","qZ","[","2","]","*","rF","[","2","]","+","qZ","[","3","]","*","rF","[","3","]",";","if","(","Kd","<","0.0",")","{","rF","*=","-","1.0",";","Kd","=","-","Kd",";","}","if","(","abs","(","Kd",")",">=","1.0",")","return","qZ",";","float","Ke","=","acos","(","Kd",")",";","float","Kf","=","sqrt","(","1.0","-","Kd","*","Kd",")",";","if","(","abs","(","Kf",")","<","0.001",")","return","vec4","(","qZ","*","0.5","+","rF","*","0.5",")",";","float","Kg","=","sin","(","(","1.0","-","Kc",")","*","Ke",")","/","Kf",";","float","Kh","=","sin","(","Kc","*","Ke",")","/","Kf",";","return","qZ","*","Kg","+","rF","*","Kh",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Kw","(","in","vec3","O",",","in","vec4","Kj",",","in","vec4","Kk",",","in","vec4","Kl",",","in","vec4","Km",",","in","float","Kn",")","{","vec3","Ko","=","rl","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","O",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKIN_SLERP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","qZ","=","Ki","(","Kj",",","Kk",",","Kn",")",";","vec4","Kp","=","mix","(","Kl",",","Km",",","Kn",")",";","vec3","Kq","=","T","(","qZ",",","Ko",")",";","vec3","Kr","=","Kq","*","Kp",".","w","+","Kp",".","xyz",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Ks","=","T","(","Kj",",","Ko",")",";","vec3","Kt","=","T","(","Kk",",","Ko",")",";","vec3","Ku","=","Ks","*","Kl",".","w","+","Kl",".","xyz",";","vec3","Kv","=","Kt","*","Km",".","w","+","Km",".","xyz",";","vec3","Kr","=","mix","(","Ku",",","Kv",",","Kn",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","rn","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","Kr",")",";","}","vec3","KC","(","in","vec3","Kx",",","in","vec4","Kj",",","in","vec4","Kk",",","in","float","Kn",")","{","vec3","Ky","=","rm","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","Kx",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["SKIN_SLERP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","qZ","=","Ki","(","Kj",",","Kk",",","Kn",")",";","vec3","Kz","=","T","(","qZ",",","Ky",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","KA","=","T","(","Kj",",","Ky",")",";","vec3","KB","=","T","(","Kk",",","Ky",")",";","vec3","Kz","=","mix","(","KA",",","KB",",","Kn",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","ro","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","Kz",")",";","}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Kw","(","in","vec3","O",",","in","vec4","Kj",",","in","vec4","Kl",")","{","vec3","Ko","=","rl","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","O",")",";","vec3","Kq","=","T","(","Kj",",","Ko",")",";","vec3","Kr","=","Kq","*","Kl",".","w","+","Kl",".","xyz",";","return","rn","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","Kr",")",";","}","vec3","KC","(","in","vec3","Kx",",","in","vec4","Kj",")","{","vec3","Ky","=","rm","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","Kx",")",";","vec3","Kz","=","T","(","Kj",",","Ky",")",";","return","ro","(","u_arm_rel_trans",".","xyz",",","vec3","(","u_arm_rel_trans",".","w",")",",","u_arm_rel_quat",",","Kz",")",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","an","(","inout","vec3","O",",","inout","vec3","V",",","inout","vec3","W",",","inout","vec3","U",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","KD","=","u_frame_factor",";"]}]}}]},{TYPE:"txt",TOKENS:["if","(","a_influence",".","y",">","0.0",")","{","vec3","jH","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec3","KE","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec3","KF","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec3","KG","=","vec3","(","0.0",",","0.0",",","0.0",")",";","vec4","KH","=","a_influence",";","for","(","int","cq","=","0",";","cq","<","4",";","cq","++",")","{","int","KI","=","int","(","KH","[","cq","]",")",";","float","KJ","=","fract","(","KH","[","cq","]",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KE","+=","KJ","*","KC","(","V",",","u_quatsb","[","KI","]",",","u_quatsa","[","KI","]",",","KD",")",";","KF","+=","KJ","*","KC","(","W",",","u_quatsb","[","KI","]",",","u_quatsa","[","KI","]",",","KD",")",";","KG","+=","KJ","*","KC","(","U",",","u_quatsb","[","KI","]",",","u_quatsa","[","KI","]",",","KD",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["jH","+=","KJ","*","Kw","(","O",",","u_quatsb","[","KI","]",",","u_transb","[","KI","]",")",";","KG","+=","KJ","*","KC","(","U",",","u_quatsb","[","KI","]",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_TANGENT_SKINNING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KE","+=","KJ","*","KC","(","V",",","u_quatsb","[","KI","]",")",";","KF","+=","KJ","*","KC","(","W",",","u_quatsb","[","KI","]",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["int","KI","=","int","(","KH","[","0","]",")",";","float","KJ","=","fract","(","KH","[","0","]",")",";","jH","+=","KJ","*","Kw","(","O",",","u_quatsb","[","KI","]",",","u_quatsa","[","KI","]",",","u_transb","[","KI","]",",","u_transa","[","KI","]",",","KD",")",";","KI","=","int","(","KH","[","1","]",")",";","KJ","=","fract","(","KH","[","1","]",")",";","jH","+=","KJ","*","Kw","(","O",",","u_quatsb","[","KI","]",",","u_quatsa","[","KI","]",",","u_transb","[","KI","]",",","u_transa","[","KI","]",",","KD",")",";","KI","=","int","(","KH","[","2","]",")",";","KJ","=","fract","(","KH","[","2","]",")",";","jH","+=","KJ","*","Kw","(","O",",","u_quatsb","[","KI","]",",","u_quatsa","[","KI","]",",","u_transb","[","KI","]",",","u_transa","[","KI","]",",","KD",")",";","KI","=","int","(","KH","[","3","]",")",";","KJ","=","fract","(","KH","[","3","]",")",";","jH","+=","KJ","*","Kw","(","O",",","u_quatsb","[","KI","]",",","u_quatsa","[","KI","]",",","u_transb","[","KI","]",",","u_transa","[","KI","]",",","KD",")",";"]}]}}]},{TYPE:"txt",TOKENS:["O","=","jH",";","U","=","KG",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_TANGENT_SKINNING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["V","=","KE",";","W","=","KF",";"]}]}}]},{TYPE:"txt",TOKENS:["}","if","(","!","(","a_influence",".","y",">","0.0",")",")","{","int","KK","=","int","(","a_influence","[","0","]","-","1.0",")",";","if","(","KK",">","-","1",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["FRAMES_BLENDING"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","Kw","(","O",",","u_quatsb","[","KK","]",",","u_quatsa","[","KK","]",",","u_transb","[","KK","]",",","u_transa","[","KK","]",",","KD",")",";","V","=","KC","(","V",",","u_quatsb","[","KK","]",",","u_quatsa","[","KK","]",",","KD",")",";","W","=","KC","(","W",",","u_quatsb","[","KK","]",",","u_quatsa","[","KK","]",",","KD",")",";","U","=","KC","(","U",",","u_quatsb","[","KK","]",",","u_quatsa","[","KK","]",",","KD",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","Kw","(","O",",","u_quatsb","[","KK","]",",","u_transb","[","KK","]",")",";","U","=","KC","(","U",",","u_quatsb","[","KK","]",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DISABLE_TANGENT_SKINNING",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["V","=","KC","(","V",",","u_quatsb","[","KK","]",")",";","W","=","KC","(","W",",","u_quatsb","[","KK","]",")",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["}","}","}"]}]}}]}]}}]}]},e["include/sky_blending.glslf"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"SKY_BLENDING_GLSLF",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"SKY_BLENDING_GLSLF",TOKENS:[""]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"include",FILE:"blending.glslf"},{TYPE:"var",NAME:"WO_SKYREAL",TOKENS:["0"]},{TYPE:"var",NAME:"WO_SKYBLEND",TOKENS:["0"]},{TYPE:"var",NAME:"BLENDTYPE",TOKENS:["MIX"]},{TYPE:"var",NAME:"MTEX_RGBTOINT",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_HORIZ",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_ZENUP",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_ZENDOWN",TOKENS:["0"]},{TYPE:"var",NAME:"WOMAP_BLEND",TOKENS:["0"]},{TYPE:"var",NAME:"MTEX_NEGATIVE",TOKENS:["0"]},{TYPE:"txt",TOKENS:["vec3","KL","(","vec3","km",",","vec3","kn",",","float","aL",",","float","kM",")","{","float","ko","=","aL","*","kM",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLENDTYPE","MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kp","(","kn",",","km",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","ADD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kq","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SUBTRACT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kr","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kt","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SCREEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","ku","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","OVERLAY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kv","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIFFERENCE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kw","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIVIDE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kx","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DARKEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","ky","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LIGHTEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kz","(","km",",","kn",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","HUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kD","(","kn",",","km",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SATURATION",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kE","(","kn",",","km",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","VALUE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kF","(","kn",",","km",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","COLOR",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kG","(","kn",",","km",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SOFT_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kI","(","kn",",","km",",","ko",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LINEAR_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kJ","(","kn",",","km",",","ko",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","vec3","(","1.0",",","0.0",",","1.0",")",";","}","float","KM","(","float","kK",",","float","kL",",","float","aL",",","float","kM",")","{","vec3","km","=","vec3","(","kK",")",",","kn","=","vec3","(","kL",")",";","float","ko","=","aL","*","kM",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BLENDTYPE","MIX",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kp","(","kn",",","km",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","ADD",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kq","(","km",",","kn",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SUBTRACT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kr","(","km",",","kn",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","MULTIPLY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kN","(","kK",",","kL",",","ko",",","kM",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SCREEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kO","(","kK",",","kL",",","ko",",","kM",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","OVERLAY",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kP","(","kK",",","kL",",","ko",",","kM",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIFFERENCE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kw","(","km",",","kn",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DIVIDE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kx","(","km",",","kn",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","DARKEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","ky","(","km",",","kn",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LIGHTEN",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kz","(","km",",","kn",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","SOFT_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kI","(","kn",",","km",",","ko",")",".","x",";"]}]}},{TYPE:"elif",EXPRESSION:["BLENDTYPE","LINEAR_LIGHT",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["return","kJ","(","kn",",","km",",","ko",")",".","x",";"]}]}}]},{TYPE:"txt",TOKENS:["return","0.0",";","}","vec3","eF","(","vec3","eB",",","vec3","eC",",","vec4","eE",",","float","eA",",","vec3","eD",")","{","float","KN","=","1.0",";","KN","=","eE",".","a",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KN","=","gj","(","eE",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_NEGATIVE"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eE","=","vec4","(","vec3","(","1.0",")","-","eE",".","rgb",",","eE",".","a",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KN","=","1.0","-","KN",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{TYPE:"logical_or_expr",PLACES:3}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eE","=","vec4","(","u_sky_tex_color",",","1.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KN","=","eE",".","a",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_HORIZ"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["eB","=","KL","(","eE",".","rgb",",","eB",",","KN",",","u_sky_tex_fac","[","1","]",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENUP","WOMAP_ZENDOWN",{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","KO","=","0.0",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYREAL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["if","(","dot","(","eD",",","vec3","(","0.0",",","0.0",",","1.0",")",")",">=","0.0",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENUP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KO","=","u_sky_tex_fac","[","2","]",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:[";"]}]}}]},{TYPE:"txt",TOKENS:["}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENDOWN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["else","KO","=","u_sky_tex_fac","[","3","]",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_ZENUP"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KO","=","u_sky_tex_fac","[","2","]",";"]}]}},{TYPE:"elif",EXPRESSION:["WOMAP_ZENDOWN"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KO","=","u_sky_tex_fac","[","3","]",";"]}]}}]}]}}]},{TYPE:"txt",TOKENS:["if","(","KO","!=","0.0",")","eC","=","KL","(","eE",".","rgb",",","eC",",","KN",",","KO",")",";"]}]}}]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WOMAP_BLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MTEX_RGBTOINT",{TYPE:"logic_negative_expr",PLACES:1}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["KN","=","dot","(","eE",".","rgb",",","vec3","(","0.2126",",","0.7152",",","0.0722",")",")",";"]}]}}]},{TYPE:"txt",TOKENS:["eA","=","KM","(","u_sky_tex_dvar",",","eA",",","KN",",","u_sky_tex_fac","[","0","]",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WO_SKYBLEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","bw","=","mix","(","eB",",","eC",",","eA",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","bw","=","eB",";"]}]}}]},{TYPE:"txt",TOKENS:["return","bw",";","}"]}]}}]}]},e["include/std.glsl"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"STD_ENUMS_GLSL",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"STD_ENUMS_GLSL",TOKENS:[""]},{TYPE:"var",NAME:"CONSTANTS_HACK",TOKENS:["0"]},{TYPE:"define",NAME:"TEXTURE_COORDS_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"TEXTURE_COORDS_UV_ORCO",TOKENS:["1"]},{TYPE:"define",NAME:"TEXTURE_COORDS_NORMAL",TOKENS:["2"]},{TYPE:"define",NAME:"TEXTURE_BLEND_TYPE_MIX",TOKENS:["1"]},{TYPE:"define",NAME:"TEXTURE_BLEND_TYPE_MULTIPLY",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_SRC_NONE",TOKENS:["1"]},{TYPE:"define",NAME:"SHADOW_SRC_DEPTH",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_SRC_MASK",TOKENS:["3"]},{TYPE:"define",NAME:"SHADOW_DST_NONE",TOKENS:["1"]},{TYPE:"define",NAME:"SHADOW_DST_DEPTH",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_DST_MASK",TOKENS:["3"]},{TYPE:"define",NAME:"NO_SHADOWS",TOKENS:["1"]},{TYPE:"define",NAME:"SHADOW_CASTING",TOKENS:["2"]},{TYPE:"define",NAME:"SHADOW_MASK_GENERATION",TOKENS:["3"]},{TYPE:"define",NAME:"SHADOW_MAPPING_OPAQUE",TOKENS:["4"]},{TYPE:"define",NAME:"SHADOW_MAPPING_BLEND",TOKENS:["5"]},{TYPE:"define",NAME:"POISSON_X_16",TOKENS:["4"]},{TYPE:"define",NAME:"POISSON_X_8",TOKENS:["2"]},{TYPE:"define",NAME:"POISSON_X_4",TOKENS:["1"]},{TYPE:"define",NAME:"NO_SOFT_SHADOWS",TOKENS:["0"]},{TYPE:"define",NAME:"SPECULAR_PHONG",TOKENS:["1"]},{TYPE:"define",NAME:"SPECULAR_COOKTORR",TOKENS:["2"]},{TYPE:"define",NAME:"SPECULAR_WARDISO",TOKENS:["3"]},{TYPE:"define",NAME:"SPECULAR_BLINN",TOKENS:["4"]},{TYPE:"define",NAME:"SPECULAR_TOON",TOKENS:["5"]},{TYPE:"define",NAME:"DIFFUSE_LAMBERT",TOKENS:["1"]},{TYPE:"define",NAME:"DIFFUSE_OREN_NAYAR",TOKENS:["2"]},{TYPE:"define",NAME:"DIFFUSE_FRESNEL",TOKENS:["3"]},{TYPE:"define",NAME:"DIFFUSE_MINNAERT",TOKENS:["4"]},{TYPE:"define",NAME:"DIFFUSE_TOON",TOKENS:["5"]},{TYPE:"define",NAME:"MIX",TOKENS:["0"]},{TYPE:"define",NAME:"ADD",TOKENS:["1"]},{TYPE:"define",NAME:"SUBTRACT",TOKENS:["2"]},{TYPE:"define",NAME:"MULTIPLY",TOKENS:["3"]},{TYPE:"define",NAME:"SCREEN",TOKENS:["4"]},{TYPE:"define",NAME:"OVERLAY",TOKENS:["5"]},{TYPE:"define",NAME:"DIFFERENCE",TOKENS:["6"]},{TYPE:"define",NAME:"DIVIDE",TOKENS:["7"]},{TYPE:"define",NAME:"DARKEN",TOKENS:["8"]},{TYPE:"define",NAME:"LIGHTEN",TOKENS:["9"]},{TYPE:"define",NAME:"HUE",TOKENS:["10"]},{TYPE:"define",NAME:"SATURATION",TOKENS:["11"]},{TYPE:"define",NAME:"VALUE",TOKENS:["12"]},{TYPE:"define",NAME:"COLOR",TOKENS:["13"]},{TYPE:"define",NAME:"SOFT_LIGHT",TOKENS:["14"]},{TYPE:"define",NAME:"LINEAR_LIGHT",TOKENS:["15"]},{TYPE:"define",NAME:"REFL_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"REFL_MIRRORMAP",TOKENS:["1"]},{TYPE:"define",NAME:"REFL_PLANE",TOKENS:["2"]},{TYPE:"define",NAME:"REFL_CUBE",TOKENS:["3"]},{TYPE:"define",NAME:"REFL_PBR_SIMPLE",TOKENS:["4"]},{TYPE:"define",NAME:"REFL_PBR_STANDARD",TOKENS:["5"]},{TYPE:"define",NAME:"INVERSE_QUADRATIC",TOKENS:["0"]},{TYPE:"define",NAME:"LINEAR",TOKENS:["1"]},{TYPE:"define",NAME:"QUADRATIC",TOKENS:["2"]},{TYPE:"define",NAME:"HEMI",TOKENS:["1"]},{TYPE:"define",NAME:"SPOT",TOKENS:["2"]},{TYPE:"define",NAME:"POINT",TOKENS:["3"]},{TYPE:"define",NAME:"SUN",TOKENS:["4"]},{TYPE:"define",NAME:"DOF_SIMPLE",TOKENS:["0"]},{TYPE:"define",NAME:"DOF_BOKEH",TOKENS:["1"]},{TYPE:"define",NAME:"COC_ALL",TOKENS:["0"]},{TYPE:"define",NAME:"COC_FOREGROUND",TOKENS:["1"]},{TYPE:"define",NAME:"COC_COMBINE",TOKENS:["2"]},{TYPE:"define",NAME:"VT_WORLD_TO_WORLD",TOKENS:["0"]},{TYPE:"define",NAME:"VT_WORLD_TO_OBJECT",TOKENS:["1"]},{TYPE:"define",NAME:"VT_WORLD_TO_CAMERA",TOKENS:["2"]},{TYPE:"define",NAME:"VT_OBJECT_TO_WORLD",TOKENS:["3"]},{TYPE:"define",NAME:"VT_OBJECT_TO_OBJECT",TOKENS:["4"]},{TYPE:"define",NAME:"VT_OBJECT_TO_CAMERA",TOKENS:["5"]},{TYPE:"define",NAME:"VT_CAMERA_TO_WORLD",TOKENS:["6"]},{TYPE:"define",NAME:"VT_CAMERA_TO_OBJECT",TOKENS:["7"]},{TYPE:"define",NAME:"VT_CAMERA_TO_CAMERA",TOKENS:["8"]},{TYPE:"define",NAME:"VT_POINT",TOKENS:["0"]},{TYPE:"define",NAME:"VT_VECTOR",TOKENS:["1"]},{TYPE:"define",NAME:"VT_NORMAL",TOKENS:["2"]},{TYPE:"define",NAME:"NM_TANGENT",TOKENS:["0"]},{TYPE:"define",NAME:"NM_OBJECT",TOKENS:["1"]},{TYPE:"define",NAME:"NM_WORLD",TOKENS:["2"]},{TYPE:"define",NAME:"NM_BLENDER_OBJECT",TOKENS:["3"]},{TYPE:"define",NAME:"NM_BLENDER_WORLD",TOKENS:["4"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_VIEW",TOKENS:["1"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_XY",TOKENS:["2"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_YZ",TOKENS:["3"]},{TYPE:"define",NAME:"BILLBOARD_ALIGN_ZX",TOKENS:["4"]},{TYPE:"define",NAME:"POST_EFFECT_NONE",TOKENS:["1"]},{TYPE:"define",NAME:"POST_EFFECT_GRAYSCALE",TOKENS:["2"]},{TYPE:"define",NAME:"POST_EFFECT_BLUR",TOKENS:["3"]},{TYPE:"define",NAME:"POST_EFFECT_GLOW_BLUR",TOKENS:["4"]},{TYPE:"define",NAME:"POST_EFFECT_DOF_BLUR",TOKENS:["5"]},{TYPE:"define",NAME:"POST_EFFECT_ALPHA_BLUR",TOKENS:["6"]},{TYPE:"define",NAME:"POST_EFFECT_EXTEND",TOKENS:["7"]},{TYPE:"define",NAME:"FLIP_CUBEMAP_COORDS",TOKENS:["8"]},{TYPE:"define",NAME:"BLUR_PASS_1",TOKENS:["1"]},{TYPE:"define",NAME:"BLUR_PASS_2",TOKENS:["2"]},{TYPE:"define",NAME:"BLUR_PASS_3",TOKENS:["3"]},{TYPE:"define",NAME:"BLUR_PASS_4",TOKENS:["4"]},{TYPE:"define",NAME:"BLUR_PASS_5",TOKENS:["5"]},{TYPE:"define",NAME:"DV_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"DV_OPAQUE_WIREFRAME",TOKENS:["1"]},{TYPE:"define",NAME:"DV_TRANSPARENT_WIREFRAME",TOKENS:["2"]},{TYPE:"define",NAME:"DV_FRONT_BACK_VIEW",TOKENS:["3"]},{TYPE:"define",NAME:"DV_BOUNDINGS",TOKENS:["4"]},{TYPE:"define",NAME:"DV_CLUSTERS_VIEW",TOKENS:["5"]},{TYPE:"define",NAME:"DV_BATCHES_VIEW",TOKENS:["6"]},{TYPE:"define",NAME:"DV_RENDER_TIME",TOKENS:["7"]},{TYPE:"define",NAME:"SSAO_QUALITY_8",TOKENS:["1"]},{TYPE:"define",NAME:"SSAO_QUALITY_16",TOKENS:["2"]},{TYPE:"define",NAME:"SSAO_QUALITY_24",TOKENS:["3"]},{TYPE:"define",NAME:"SSAO_QUALITY_32",TOKENS:["4"]},{TYPE:"define",NAME:"AA_METHOD_FXAA_LIGHT",TOKENS:["1"]},{TYPE:"define",NAME:"AA_METHOD_FXAA_QUALITY",TOKENS:["2"]},{TYPE:"define",NAME:"AA_QUALITY_LOW",TOKENS:["0"]},{TYPE:"define",NAME:"AA_QUALITY_MEDIUM",TOKENS:["1"]},{TYPE:"define",NAME:"AA_QUALITY_HIGH",TOKENS:["2"]},{TYPE:"define",NAME:"SMAA_RESOLVE",TOKENS:["25"]},{TYPE:"define",NAME:"SMAA_EDGE_DETECTION",TOKENS:["24"]},{TYPE:"define",NAME:"SMAA_BLENDING_WEIGHT_CALCULATION",TOKENS:["23"]},{TYPE:"define",NAME:"SMAA_NEIGHBORHOOD_BLENDING",TOKENS:["26"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_LOW",TOKENS:["1"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_MEDIUM",TOKENS:["2"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_HIGH",TOKENS:["3"]},{TYPE:"define",NAME:"AA_METHOD_SMAA_ULTRA",TOKENS:["4"]},{TYPE:"define",NAME:"REFL_PASS_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"REFL_PASS_PLANE",TOKENS:["1"]},{TYPE:"define",NAME:"REFL_PASS_CUBE",TOKENS:["2"]},{TYPE:"define",NAME:"SRGB_NONE",TOKENS:["0"]},{TYPE:"define",NAME:"SRGB_SIMPLE",TOKENS:["1"]},{TYPE:"define",NAME:"SRGB_PROPER",TOKENS:["2"]},{TYPE:"define",NAME:"CAM_TYPE_ORTHO",TOKENS:["0"]},{TYPE:"define",NAME:"CAM_TYPE_PERSP",TOKENS:["1"]},{TYPE:"define",NAME:"M_PI",TOKENS:["3.14159265359"]},{TYPE:"define",NAME:"M_PI_4",TOKENS:["0.785398163"]},{TYPE:"define",NAME:"INV_PI",TOKENS:["0.318309886"]},{TYPE:"define",NAME:"UP_VECTOR",TOKENS:["vec3","(","0.0",",","0.0",",","1.0",")"]},{TYPE:"define",NAME:"RIGHT_VECTOR",TOKENS:["vec3","(","1.0",",","0.0",",","0.0",")"]},{TYPE:"define",NAME:"TOWARD_VECTOR",TOKENS:["vec3","(","0.0",",","-","1.0",",","0.0",")"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["CONSTANTS_HACK"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","_0_0","=","0.0",";","float","_0_5","=","0.5",";","float","_1_0","=","1.0",";","float","_255_0","=","255.0",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"_0_0",TOKENS:["0.0"]},{TYPE:"define",NAME:"_0_5",TOKENS:["0.5"]},{TYPE:"define",NAME:"_1_0",TOKENS:["1.0"]},{TYPE:"define",NAME:"_255_0",TOKENS:["255.0"]}]}}]}]}}]}]},e["include/to_world.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"TO_WORLD_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"TO_WORLD_GLSLV",TOKENS:[""]},{TYPE:"include",FILE:"math.glslv"},{TYPE:"var",NAME:"BILLBOARD_ALIGN",TOKENS:["BILLBOARD_ALIGN_VIEW"]},{TYPE:"var",NAME:"BILLBOARD_SPHERICAL",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_RANDOM",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_JITTERED",TOKENS:["0"]},{TYPE:"var",NAME:"BILLBOARD_PRES_GLOB_ORIENTATION",TOKENS:["0"]},{TYPE:"var",NAME:"STATIC_BATCH",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"define",NAME:"MAX_BILLBOARD_ANGLE",TOKENS:["M_PI_4"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_SPHERICAL","BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","bn","(","vec3","KP",",","mat3","N",")","{","vec4","KQ","=","ry","(","N",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","KR","=","X","(","RIGHT_VECTOR",",","-","M_PI","/","2.0",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","KR","=","X","(","RIGHT_VECTOR",",","M_PI","/","2.0",")",";"]}]}}]},{TYPE:"txt",TOKENS:["KQ","=","rc","(","KR",",","KQ",")",";","KQ","=","kV","(","KQ",")",";","mat3","bo","=","aY","(",")",";","bo","=","aZ","(","KP",",","bo",")",";","bo","=","bc","(","KQ",",","bo",")",";","return","bo",";","}"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","KT","(","vec3","lL",",","vec3","KP",")","{","vec3","KS","=","lL","-","KP",";","KS",".","z","=","0.0",";","KS","=","normalize","(","KS",")",";","vec4","KQ","=","ri","(","KS",",","TOWARD_VECTOR",")",";","mat3","bo","=","aY","(",")",";","bo","=","aZ","(","KP",",","bo",")",";","bo","=","bc","(","KQ",",","bo",")",";","return","bo",";","}"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_JITTERED"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","at","(","in","vec3","KU",",","float","KV",",","float","KW",",","float","KX",",","vec3","bf",",","mat3","Z",")","{","float","IV","=","fract","(","length","(","bf",")","/","0.17",")",";","float","KY","=","KX","+","IV","/","10.0",";","float","KZ","=","IV",";","if","(","KX","!=","0.0",")","KZ","/=","KX",";","KU","*=","1.0","+","0.5","*","sin","(","KV",")",";","float","K_","=","length","(","KU",")","*","KW","*","sin","(","2.0","*","3.14","*","KV","*","KY","+","KZ",")",";","vec4","La","=","X","(","TOWARD_VECTOR",",","K_",")",";","vec4","Lb","=","ry","(","Z",")",";","Lb","=","rc","(","Lb",",","La",")",";","Z","=","bc","(","Lb",",","Z",")",";","return","Z",";","}"]}]}}]},{TYPE:"txt",TOKENS:["mat3","as","(","in","vec3","lL",",","in","vec3","aq",",","in","mat3","N",",","in","mat3","Z",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_SPHERICAL","BILLBOARD",{TYPE:"logic_negative_expr",PLACES:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{TYPE:"equal_expr",PLACES:2},{TYPE:"logical_and_expr",PLACES:2},{TYPE:"logical_or_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","l_","=","bn","(","aq",",","N",")",";"]}]}},{TYPE:"elif",EXPRESSION:["BILLBOARD_RANDOM"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["float","IV","=","fract","(","(","aq",".","x","*","1.43","-","aq",".","z","*","0.123","+","aq",".","y","*","6.1",")",")",";","float","Lc","=","2.0","*","M_PI","*","IV",";","vec4","Ld","=","ry","(","N",")",";","float","Le","=","asin","(","2.0","*","(","Ld",".","x","*","Ld",".","y","-","Ld",".","z","*","Ld",".","w",")",")",";","float","hy","=","Le","-","Lc",";","if","(","hy","<","0.0",")","hy","=","2.0","*","M_PI","+","hy",";","float","Lf","=","Lc",";","if","(","hy","<=","MAX_BILLBOARD_ANGLE",")","Lf","+=","hy",";","else","if","(","hy","<=","M_PI","-","MAX_BILLBOARD_ANGLE",")","Lf","+=","MAX_BILLBOARD_ANGLE","*","(","2.0","*","hy","-","M_PI",")","/","(","2.0","*","MAX_BILLBOARD_ANGLE","-","M_PI",")",";","else","if","(","hy","<=","M_PI","+","MAX_BILLBOARD_ANGLE",")","Lf","+=","hy","-","M_PI",";","else","if","(","hy","<=","2.0","*","M_PI","-","MAX_BILLBOARD_ANGLE",")","Lf","+=","MAX_BILLBOARD_ANGLE","*","(","2.0","*","hy","-","M_PI",")","/","(","2.0","*","MAX_BILLBOARD_ANGLE","-","M_PI",")","+","M_PI",";","else","Lf","+=","hy","-","2.0","*","M_PI",";","vec4","Lg","=","X","(","UP_VECTOR",",","Lf",")",";","mat3","l_","=","aY","(",")",";","l_","=","aZ","(","aq",",","l_",")",";","l_","=","bc","(","Lg",",","l_",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["mat3","l_","=","KT","(","lL",",","aq",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{TYPE:"logic_negative_expr",PLACES:1},{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Z","=","aZ","(","vec3","(","0.0",")",",","Z",")",";","l_","=","bd","(","l_",",","Z",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Lh","=","rA","(","l_",")",";","vec3","Li","=","rA","(","Z",")",";","l_","=","a_","(","Lh","*","Li",",","l_",")",";"]}]}}]},{TYPE:"txt",TOKENS:["return","l_",";","}","au","av","(","in","vec3","fr",",","in","vec3","Lj",",","in","vec3","Lk",",","in","vec3","Ll",",","in","vec3","Lm",",","in","vec3","Ln",",","in","mat3","Z",")","{","fr","=","ap","(","Z",",","fr",")",";","Lj","=","ap","(","Z",",","Lj",")",";","Lk","=","_","(","Z",",","Lk",")",";","Ll","=","_","(","Z",",","Ll",")",";","Lm","=","_","(","Z",",","Lm",")",";","Ln","=","bI","(","Z",",","Ln",")",";","return","ma","(","au","(","fr",",","Lj",",","Lk",",","Ll",",","Lm",",","Ln",",","vec3","(","0.0",")",")",")",";","}"]}]}}]}]},e["include/wind_bending.glslv"]={TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"ifndef",NAME:"WIND_BENDING_GLSLV",GROUP:{TYPE:"grp",PARTS:[{TYPE:"define",NAME:"WIND_BENDING_GLSLV",TOKENS:[""]},{TYPE:"var",NAME:"WIND_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"MAIN_BEND_COL",TOKENS:["0"]},{TYPE:"var",NAME:"DETAIL_BEND",TOKENS:["0"]},{TYPE:"var",NAME:"BEND_CENTER_ONLY",TOKENS:["0"]},{TYPE:"var",NAME:"REFLECTION_PASS",TOKENS:["REFL_PASS_NONE"]},{TYPE:"var",NAME:"BILLBOARD",TOKENS:["0"]},{TYPE:"include",FILE:"std.glsl"},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["WIND_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["void","LA","(","inout","vec3","bt",",","in","vec3","Lo",",","in","float","Lp",",","in","float","Lq",",","in","float","fy",",","in","vec3","KU",",","in","float","Lr",",","in","mat4","b_",")","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Ls","=","(","b_","*","vec4","(","bt",",","1.0",")",")",".","xyz",";","vec3","Lt","=","(","b_","*","vec4","(","Lo",",","1.0",")",")",".","xyz",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Ls","=","bt",";","vec3","Lt","=","Lo",";"]}]}}]},{TYPE:"txt",TOKENS:["float","dD","=","length","(","Lt",")",";","float","Lu","=","Lq","*","(","1.0","+","0.1","*","fract","(","dD",")",")",";","float","Lv","=","Lp","*","Lr","*","(","1.0","+","sin","(","2.0","*","3.14","*","fy","*","Lu","+","dD",")",")",";","float","Lw","=","(","Ls",".","z","-","Lt",".","z",")","*","abs","(","Lv",")",";","Lw","+=","1.0",";","Lw","*=","Lw",";","Lw","=","Lw","*","Lw","-","Lw",";","vec3","Lx","=","Ls",";","Lx",".","xy","+=","KU",".","xy","*","Lw","*","sign","(","Lv",")",";","vec3","Ly","=","Lx","-","Lt",";","if","(","all","(","equal","(","Ly",",","vec3","(","0.0",")",")",")",")","bt","=","Lo",";","else","{"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["Ly","=","(","b_","*","vec4","(","Ly",",","0.0",")",")",".","xyz",";"]}]}}]},{TYPE:"txt",TOKENS:["float","Lz","=","length","(","Ls","-","Lt",")",";","bt","=","Lo","+","normalize","(","Ly",")","*","Lz",";","}","}"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec4","LB","(","vec4","x",")","{","return","x","*","x","*","(","3.0","-","2.0","*","x",")",";","}","vec4","LC","(","vec4","x",")","{","return","abs","(","fract","(","x","+","0.5",")","*","2.0","-","1.0",")",";","}","vec4","LD","(","vec4","x",")","{","return","LB","(","LC","(","x",")",")",";","}","void","LP","(","inout","vec3","bt",",","in","float","fy",",","in","vec3","U",",","in","vec3","KU",",","in","vec3","Lo",",","in","float","LE",",","in","float","LF",",","in","float","LG",",","in","vec3","LH",",","in","mat4","b_",")","{","float","LI",";","float","LJ",";","float","LK",";","vec2","LL",";","vec4","LM",";","vec2","LN",";","vec3","LO",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Ls","=","(","b_","*","vec4","(","bt",",","1.0",")",")",".","xyz",";","vec3","Lt","=","(","b_","*","vec4","(","Lo",",","1.0",")",")",".","xyz",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","Ls","=","bt",";","vec3","Lt","=","Lo",";"]}]}}]},{TYPE:"txt",TOKENS:["LI","=","dot","(","Lt",",","vec3","(","1.0",")",")",";","LJ","=","LI","+","LH",".","g",";","LK","=","dot","(","Ls",",","vec3","(","LH",".","g",")",")",";","LL","=","(","fy","+","vec2","(","LK",",","LJ",")",")",";","LM","=","(","(","fract","(","(","LL",".","xxyy","*","vec4","(","1.975",",","0.793",",","0.375",",","0.193",")",")",")","*","2.0",")","-","1.0",")","*","length","(","KU",")","*","LE",";","LM","=","LD","(","LM",")",";","LN","=","LM",".","xz","+","LM",".","yw",";","LN",".","y","=","0.5","-","LN",".","y",";","LO","=","LN",".","xxy","*","LH",".","rrb","*","vec3","(","LF","*","U",".","x",",","LF","*","U",".","y",",","LG",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["LO","=","(","b_","*","vec4","(","LO",",","0.0",")",")",".","xyz",";"]}]}}]},{TYPE:"txt",TOKENS:["bt","+=","LO",";","}"]}]}}]},{TYPE:"txt",TOKENS:["void","ax","(","inout","vec3","O",",","inout","vec3","ao",",","in","vec3","U",",","in","mat4","b_",")","{","vec3","LQ","=","u_wind","*","1.0","+","0.7","*","sin","(","u_time",")",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","LR","=","ao",";","vec3","LS","=","a_emitter_center",";"]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["REFLECTION_PASS","REFL_PASS_PLANE",{TYPE:"equal_expr",PLACES:2},"BILLBOARD",{TYPE:"logical_and_expr",PLACES:2}],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["LS","=","(","b_","*","vec4","(","LS",",","1.0",")",")",".","xyz",";"]}]}}]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["vec3","LR","=","O",";","vec3","LS","=","ao",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["MAIN_BEND_COL"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["DETAIL_BEND"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["LP","(","LR",",","u_time",",","U",",","LQ",",","LS",",","au_detail_bending_freq",",","au_detail_bending_amp",",","au_branch_bending_amp",",","a_bending_col_detail",",","b_",")",";"]}]}}]},{TYPE:"txt",TOKENS:["LA","(","LR",",","LS",",","au_wind_bending_amp",",","au_wind_bending_freq",",","u_time",",","LQ",",","a_bending_col_main",",","b_",")",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["LA","(","LR",",","LS",",","au_wind_bending_amp",",","au_wind_bending_freq",",","u_time",",","LQ",",","1.0",",","b_",")",";"]}]}}]},{TYPE:"cond",PARTS:[{TYPE:"if",EXPRESSION:["BEND_CENTER_ONLY"],GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","+=","LR","-","ao",";","ao","=","LR",";"]}]}},{TYPE:"else",GROUP:{TYPE:"grp",PARTS:[{TYPE:"txt",TOKENS:["O","=","LR",";","ao","=","LS",";"]}]}}]},{TYPE:"txt",TOKENS:["}"]}]}}]}]}}]}]}};var VI=function(){function e(e,t,r,n,a,o){this.message=e,this.expected=t,this.found=r,this.offset=n,this.line=a,this.column=o,this.name="SyntaxError"}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),{SyntaxError:e,parse:function(t){var r,n=arguments.length>1?arguments[1]:{},a={},o={start:io},_=io,i=function(e){return e},s=function(e){return{TYPE:"grp",PARTS:null!==e?e:[]}},l=function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n][1]);return r},c=function(e,t,r){for(var n=[e],a=0;a<t.length;a++)n.push(t[a]);return null!==r&&n.push(r),{TYPE:"cond",PARTS:n}},E="#",u={type:"literal",value:"#",description:'"#"'},d="if",T={type:"literal",value:"if",description:'"if"'},f=function(e,t){return{TYPE:"if",EXPRESSION:e,GROUP:t}},p="ifdef",P={type:"literal",value:"ifdef",description:'"ifdef"'},S=function(e,t){return{TYPE:"ifdef",NAME:e,GROUP:t}},A="ifndef",h={type:"literal",value:"ifndef",description:'"ifndef"'},v=function(e,t){return{TYPE:"ifndef",NAME:e,GROUP:t}},m="elif",g={type:"literal",value:"elif",description:'"elif"'},O=function(e,t){return{TYPE:"elif",EXPRESSION:e,GROUP:t}},N="else",R={type:"literal",value:"else",description:'"else"'},I=function(e){return{TYPE:"else",GROUP:e}},b="endif",y={type:"literal",value:"endif",description:'"endif"'},L="include",Y={type:"literal",value:"include",description:'"include"'},M=function(e){return{TYPE:"include",FILE:e}},x="define",C={type:"literal",value:"define",description:'"define"'},w="var",U={type:"literal",value:"var",description:'"var"'},k=function(e,t,r){var n=[];if(null===r)n.push("");else for(var a=0;a<r[1].length;a++)n.push(r[1][a]);return{TYPE:e,NAME:t,TOKENS:n}},D="error",F={type:"literal",value:"error",description:'"error"'},G=function(e){var t=[];if(null!==e)for(var r=0;r<e[1].length;r++)t.push(e[1][r]);return{TYPE:"error",TOKENS:t}},K="line",B={type:"literal",value:"line",description:'"line"'},X=function(e){return{TYPE:"line",TOKENS:e}},H="pragma",j={type:"literal",value:"pragma",description:'"pragma"'},z=function(e,t){return{TYPE:"pragma",NAME:e,TOKENS:t}},Q="undef",V={type:"literal",value:"undef",description:'"undef"'},q=function(e){return{TYPE:"undef",NAME:e}},W="warning",J={type:"literal",value:"warning",description:'"warning"'},Z=function(e){var t=[];if(null!==e)for(var r=0;r<e[1].length;r++)t.push(e[1][r]);return{TYPE:"warning",TOKENS:t}},$="extension",ee={type:"literal",value:"extension",description:'"extension"'},te=function(e){var t=[];if(null!==e)for(var r=0;r<e[1].length;r++)t.push(e[1][r]);return{TYPE:"extension",TOKENS:t}},re="version",ne={type:"literal",value:"version",description:'"version"'},ae=function(e){var t=[];return null!==e&&t.push(e),{TYPE:"version",TOKENS:t}},oe=function(){return{TYPE:"#"}},_e=function(e){return e},ie="node",se={type:"literal",value:"node",description:'"node"'},le=function(e,t,r,n){for(var a=[],o=0;o<t.length;o++)a.push(t[o][0]);var _=[];for(o=0;o<r.length;o++)_.push(r[o][0]);var i=[];for(o=0;o<n.length;o++)i.push(n[o][0]);return{TYPE:"node",NAME:e,NODE_VARS:a,DECLARATIONS:_,STATEMENTS:i}},ce="endnode",Ee={type:"literal",value:"endnode",description:'"endnode"'},ue="node_var",de={type:"literal",value:"node_var",description:'"node_var"'},Te=function(e,t){var r=[];if(null===t)r.push("");else for(var n=0;n<t[1].length;n++)r.push(t[1][n]);return{TYPE:"node_var",NAME:e,TOKENS:r}},fe=function(e,t,r){for(var n=[e],a=0;a<t.length;a++)n.push(t[a]);return null!==r&&n.push(r),{TYPE:"node_cond",PARTS:n}},pe="node_if",Pe={type:"literal",value:"node_if",description:'"node_if"'},Se=function(e,t){for(var r=[],n=0;n<t.length;n++)r.push(t[n][0]);return{TYPE:"node_if",EXPRESSION:e,STATEMENTS:r}},Ae="node_ifdef",he={type:"literal",value:"node_ifdef",description:'"node_ifdef"'},ve=function(e,t){for(var r=[],n=0;n<t.length;n++)r.push(t[n][0]);return{TYPE:"node_ifdef",NAME:e,STATEMENTS:r}},me="node_ifndef",ge={type:"literal",value:"node_ifndef",description:'"node_ifndef"'},Oe=function(e,t){for(var r=[],n=0;n<t.length;n++)r.push(t[n][0]);return{TYPE:"node_ifndef",NAME:e,STATEMENTS:r}},Ne="node_elif",Re={type:"literal",value:"node_elif",description:'"node_elif"'},Ie=function(e,t){for(var r=[],n=0;n<t.length;n++)r.push(t[n][0]);return{TYPE:"node_elif",EXPRESSION:e,STATEMENTS:r}},be="node_else",ye={type:"literal",value:"node_else",description:'"node_else"'},Le=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r][0]);return{TYPE:"node_else",STATEMENTS:t}},Ye="node_endif",Me={type:"literal",value:"node_endif",description:'"node_endif"'},xe="node_in",Ce={type:"literal",value:"node_in",description:'"node_in"'},we="optional",Ue={type:"literal",value:"optional",description:'"optional"'},ke=function(e,t){var r=[];if(null!==t)for(var n=0;n<t[1].length;n++)r.push(t[1][n]);return{TYPE:"node_in",NAME:r.pop(),QUALIFIER:r,IS_OPTIONAL:Boolean(e)}},De="node_out",Fe={type:"literal",value:"node_out",description:'"node_out"'},Ge=function(e,t){var r=[];if(null!==t)for(var n=0;n<t[1].length;n++)r.push(t[1][n]);return{TYPE:"node_out",NAME:r.pop(),QUALIFIER:r,IS_OPTIONAL:Boolean(e)}},Ke="node_param",Be={type:"literal",value:"node_param",description:'"node_param"'},Xe=function(e,t){var r=[];if(null!==t)for(var n=0;n<t[1].length;n++)r.push(t[1][n]);return{TYPE:"node_param",NAME:r.pop(),QUALIFIER:r,IS_OPTIONAL:Boolean(e)}},He="nodes_global",je={type:"literal",value:"nodes_global",description:'"nodes_global"'},ze=function(){return{TYPE:"nodes_global"}},Qe="nodes_main",Ve={type:"literal",value:"nodes_main",description:'"nodes_main"'},qe=function(){return{TYPE:"nodes_main"}},We=function(e){return{TYPE:"txt",TOKENS:e}},Je=",",Ze={type:"literal",value:",",description:'","'},$e=function(e,t){return 0==t.length?e:t[t.length-1]},et="?",tt={type:"literal",value:"?",description:'"?"'},rt=":",nt={type:"literal",value:":",description:'":"'},at=function(e,t,r){var n=e;return n.push.apply(n,t),n.push.apply(n,r),n.push({TYPE:"conditional_expr",PLACES:3}),n},ot=function(e,t){var r=e;if(t.length){for(var n={TYPE:"logical_or_expr",PLACES:t.length+1},a=0;a<t.length;a++)r.push.apply(r,t[a][3]);r.push(n)}return r},_t=function(e,t){var r=e;if(t.length){for(var n={TYPE:"logical_and_expr",PLACES:t.length+1},a=0;a<t.length;a++)r.push.apply(r,t[a][3]);r.push(n)}return r},it=function(e,t){var r=e;if(t.length){for(var n={TYPE:"logical_bitor_expr",PLACES:t.length+1},a=0;a<t.length;a++)r.push.apply(r,t[a][3]);r.push(n)}return r},st=function(e,t){var r=e;if(t.length){for(var n={TYPE:"logical_bitxor_expr",PLACES:t.length+1},a=0;a<t.length;a++)r.push.apply(r,t[a][3]);r.push(n)}return r},lt=function(e,t){var r=e;if(t.length){for(var n={TYPE:"logical_bitand_expr",PLACES:t.length+1},a=0;a<t.length;a++)r.push.apply(r,t[a][3]);r.push(n)}return r},ct=function(e,t){for(var r=e,n=0;n<t.length;n++)switch(t[n][1]){case"==":var a={TYPE:"equal_expr",PLACES:2};r.push.apply(r,t[n][3]),r.push(a);break;case"!=":a={TYPE:"non_equal_expr",PLACES:2},r.push.apply(r,t[n][3]),r.push(a)}return r},Et=function(e,t){for(var r=e,n=0;n<t.length;n++)switch(t[n][1]){case"<=":var a={TYPE:"le_expr",PLACES:2};r.push.apply(r,t[n][3]),r.push(a);break;case">=":a={TYPE:"ge_expr",PLACES:2},r.push.apply(r,t[n][3]),r.push(a);break;case"<":a={TYPE:"l_expr",PLACES:2},r.push.apply(r,t[n][3]),r.push(a);break;case">":a={TYPE:"g_expr",PLACES:2},r.push.apply(r,t[n][3]),r.push(a)}return r},ut=function(e,t){for(var r=e,n=0;n<t.length;n++)switch(t[n][1]){case"<<":var a={TYPE:"left_shift_expr",PLACES:2};r.push.apply(r,t[n][3]),r.push(a);break;case">>":a={TYPE:"right_shift_expr",PLACES:2},r.push.apply(r,t[n][3]),r.push(a)}return r},dt=function(e,t){for(var r=e,n=0;n<t.length;n++)switch(t[n][1]){case"+":var a={TYPE:"add_expr",PLACES:2};r.push.apply(r,t[n][3]),r.push(a);break;case"-":a={TYPE:"sub_expr",PLACES:2},r.push.apply(r,t[n][3]),r.push(a)}return r},Tt=function(e,t){for(var r=e,n=0;n<t.length;n++)switch(t[n][1]){case"*":var a={TYPE:"mul_expr",PLACES:2};r.push.apply(r,t[n][3]),r.push(a);break;case"/":a={TYPE:"div_expr",PLACES:2},r.push.apply(r,t[n][3]),r.push(a);break;case"%":a={TYPE:"mod_expr",PLACES:2},r.push.apply(r,t[n][3]),r.push(a)}return r},ft="defined",pt={type:"literal",value:"defined",description:'"defined"'},Pt=function(e){return e},St=function(e,t){var r=t;switch(e){case"++":r.push({TYPE:"pre_inc_expr",PLACES:1});break;case"--":r.push({TYPE:"pre_dec_expr",PLACES:1});break;case"+":r.push({TYPE:"positive_expr",PLACES:1});break;case"-":r.push({TYPE:"negative_expr",PLACES:1});break;case"~":r.push({TYPE:"one_compl_expr",PLACES:1});break;case"!":r.push({TYPE:"logic_negative_expr",PLACES:1})}return r},At=function(e,t){var r=e;switch(t){case"++":r.push({TYPE:"post_inc_expr",PLACES:1});break;case"--":r.push({TYPE:"post_dec_expr",PLACES:1})}return r},ht=function(e){return[e]},vt=function(e){return[e]},mt="(",gt={type:"literal",value:"(",description:'"("'},Ot=")",Nt={type:"literal",value:")",description:'")"'},Rt=function(e){return e},It=function(){return 1},bt={type:"other",description:"number"},yt=function(e){return e},Lt=function(e){return parseInt(e)},Yt={type:"other",description:"identifier"},Mt=function(e){return e},xt="++",Ct={type:"literal",value:"++",description:'"++"'},wt="--",Ut={type:"literal",value:"--",description:'"--"'},kt="+",Dt={type:"literal",value:"+",description:'"+"'},Ft="-",Gt={type:"literal",value:"-",description:'"-"'},Kt="~",Bt={type:"literal",value:"~",description:'"~"'},Xt="!",Ht={type:"literal",value:"!",description:'"!"'},jt="*",zt={type:"literal",value:"*",description:'"*"'},Qt="/",Vt={type:"literal",value:"/",description:'"/"'},qt="%",Wt={type:"literal",value:"%",description:'"%"'},Jt="=",Zt={type:"literal",value:"=",description:'"="'},$t=function(e){return e},er=function(){return"+"},tr=function(){return"-"},rr="<<",nr={type:"literal",value:"<<",description:'"<<"'},ar=">>",or={type:"literal",value:">>",description:'">>"'},_r="<=",ir={type:"literal",value:"<=",description:'"<="'},sr=">=",lr={type:"literal",value:">=",description:'">="'},cr="<",Er={type:"literal",value:"<",description:'"<"'},ur=">",dr={type:"literal",value:">",description:'">"'},Tr="==",fr={type:"literal",value:"==",description:'"=="'},pr="!=",Pr={type:"literal",value:"!=",description:'"!="'},Sr="&",Ar={type:"literal",value:"&",description:'"&"'},hr=function(){return"&"},vr="^",mr={type:"literal",value:"^",description:'"^"'},gr=function(){return"^"},Or="|",Nr={type:"literal",value:"|",description:'"|"'},Rr=function(){return"|"},Ir="&&",br={type:"literal",value:"&&",description:'"&&"'},yr=function(){return"&&"},Lr="||",Yr={type:"literal",value:"||",description:'"||"'},Mr=function(){return"||"},xr='"',Cr={type:"literal",value:'"',description:'"\\""'},wr=function(e){for(var t="",r=0;r<e.length;r++)t+=e[r][1];return t},Ur=function(e,t){return e+t.join("")},kr="$",Dr={type:"literal",value:"$",description:'"$"'},Fr="_",Gr={type:"literal",value:"_",description:'"_"'},Kr=/^[a-zA-Z]/,Br={type:"class",value:"[a-zA-Z]",description:"[a-zA-Z]"},Xr="#define",Hr={type:"literal",value:"#define",description:'"#define"'},jr="#elif",zr={type:"literal",value:"#elif",description:'"#elif"'},Qr="#else",Vr={type:"literal",value:"#else",description:'"#else"'},qr="#endif",Wr={type:"literal",value:"#endif",description:'"#endif"'},Jr="#error",Zr={type:"literal",value:"#error",description:'"#error"'},$r="#if",en={type:"literal",value:"#if",description:'"#if"'},tn="#ifdef",rn={type:"literal",value:"#ifdef",description:'"#ifdef"'},nn="#ifndef",an={type:"literal",value:"#ifndef",description:'"#ifndef"'},on="#include",_n={type:"literal",value:"#include",description:'"#include"'},sn="#line",ln={type:"literal",value:"#line",description:'"#line"'},cn="#pragma",En={type:"literal",value:"#pragma",description:'"#pragma"'},un="#warning",dn={type:"literal",value:"#warning",description:'"#warning"'},Tn="#version",fn={type:"literal",value:"#version",description:'"#version"'},pn=".",Pn={type:"literal",value:".",description:'"."'},Sn="0",An={type:"literal",value:"0",description:'"0"'},hn=/^[xX]/,vn={type:"class",value:"[xX]",description:"[xX]"},mn=function(e){return e},gn=function(e){return e},On=function(e){return String(parseInt("0x"+e))},Nn=/^[0-9]/,Rn={type:"class",value:"[0-9]",description:"[0-9]"},In=/^[1-9]/,bn={type:"class",value:"[1-9]",description:"[1-9]"},yn=/^[eE]/,Ln={type:"class",value:"[eE]",description:"[eE]"},Yn=/^[\-+]/,Mn={type:"class",value:"[-+]",description:"[-+]"},xn=/^[0-9a-fA-F]/,Cn={type:"class",value:"[0-9a-fA-F]",description:"[0-9a-fA-F]"},wn={type:"other",description:"string"},Un="'",kn={type:"literal",value:"'",description:'"\'"'},Dn=function(e){return'"'+e[1]+'"'},Fn=function(e){return e.join("")},Gn="\\",Kn={type:"literal",value:"\\",description:'"\\\\"'},Bn=function(e){return e},Xn=function(e){return e},Hn=function(e){return e},jn=function(){return"\0"},zn=/^['"\\bfnrtv]/,Qn={type:"class",value:"['\"\\\\bfnrtv]",description:"['\"\\\\bfnrtv]"},Vn=function(e){return e.replace("b","\b").replace("f","\f").replace("n","\n").replace("r","\r").replace("t","\t").replace("v","\v")},qn=function(e){return e},Wn="x",Jn={type:"literal",value:"x",description:'"x"'},Zn="u",$n={type:"literal",value:"u",description:'"u"'},ea=function(e){return String.fromCharCode(parseInt("0x"+e))},ta={type:"other",description:"punctuation"},ra="+=",na={type:"literal",value:"+=",description:'"+="'},aa="-=",oa={type:"literal",value:"-=",description:'"-="'},_a="*=",ia={type:"literal",value:"*=",description:'"*="'},sa="/=",la={type:"literal",value:"/=",description:'"/="'},ca="%=",Ea={type:"literal",value:"%=",description:'"%="'},ua="^=",da={type:"literal",value:"^=",description:'"^="'},Ta="&=",fa={type:"literal",value:"&=",description:'"&="'},pa="|=",Pa={type:"literal",value:"|=",description:'"|="'},Sa="<<=",Aa={type:"literal",value:"<<=",description:'"<<="'},ha=">>=",va={type:"literal",value:">>=",description:'">>="'},ma="{",ga={type:"literal",value:"{",description:'"{"'},Oa="}",Na={type:"literal",value:"}",description:'"}"'},Ra="[",Ia={type:"literal",value:"[",description:'"["'},ba="]",ya={type:"literal",value:"]",description:'"]"'},La=";",Ya={type:"literal",value:";",description:'";"'},Ma={type:"other",description:"whitespace"},xa=/^[\t\x0B\f ]/,Ca={type:"class",value:"[\\t\\v\\f ]",description:"[\\t\\v\\f ]"},wa=/^[\n\r]/,Ua={type:"class",value:"[\\n\\r]",description:"[\\n\\r]"},ka={type:"other",description:"end of line"},Da="\n",Fa={type:"literal",value:"\n",description:'"\\n"'},Ga="\r\n",Ka={type:"literal",value:"\r\n",description:'"\\r\\n"'},Ba="\r",Xa={type:"literal",value:"\r",description:'"\\r"'},Ha={type:"other",description:"comment"},ja="/*",za={type:"literal",value:"/*",description:'"/*"'},Qa="*/",Va={type:"literal",value:"*/",description:'"*/"'},qa="//",Wa={type:"literal",value:"//",description:'"//"'},Ja={type:"any",description:"any character"},Za=0,$a=0,eo={line:1,column:1,seenCR:!1},to=0,ro=[],no=0;if("startRule"in n){if(!(n.startRule in o))throw new Error("Can't start parsing from rule \""+n.startRule+'".');_=o[n.startRule]}function ao(e){return $a!==e&&($a>e&&($a=0,eo={line:1,column:1,seenCR:!1}),function(e,r,n){var a,o;for(a=r;a<n;a++)"\n"===(o=t.charAt(a))?(e.seenCR||e.line++,e.column=1,e.seenCR=!1):"\r"===o||"\u2028"===o||"\u2029"===o?(e.line++,e.column=1,e.seenCR=!0):(e.column++,e.seenCR=!1)}(eo,$a,e),$a=e),eo}function oo(e){Za<to||(Za>to&&(to=Za,ro=[]),ro.push(e))}function _o(r,n,a){var o=ao(a),_=a<t.length?t.charAt(a):null;return null!==n&&function(e){var t=1;for(e.sort((function(e,t){return e.description<t.description?-1:e.description>t.description?1:0}));t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}(n),new e(null!==r?r:function(e,t){var r,n=new Array(e.length);for(r=0;r<e.length;r++)n[r]=e[r].description;return"Expected "+(e.length>1?n.slice(0,-1).join(", ")+" or "+n[e.length-1]:n[0])+" but "+(t?'"'+function(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,(function(e){return"\\x0"+t(e)})).replace(/[\x10-\x1F\x80-\xFF]/g,(function(e){return"\\x"+t(e)})).replace(/[\u0100-\u0FFF]/g,(function(e){return"\\u0"+t(e)})).replace(/[\u1000-\uFFFF]/g,(function(e){return"\\u"+t(e)}))}(t)+'"':"end of input")+" found."}(n,_),n,_,a,o.line,o.column)}function io(){var e,t;return e=Za,q_()!==a&&(t=so())!==a&&q_()!==a?e=i(t):(Za=e,e=a),e}function so(){var e;return(e=lo())===a&&(e=null),e!==a&&(e=s(e)),e}function lo(){var e,t,r,n,o,_;if(e=Za,(t=co())!==a){for(r=[],n=Za,(o=q_())!==a&&(_=co())!==a?n=o=[o,_]:(Za=n,n=a);n!==a;)r.push(n),n=Za,(o=q_())!==a&&(_=co())!==a?n=o=[o,_]:(Za=n,n=a);r!==a?e=t=l(t,r):(Za=e,e=a)}else Za=e,e=a;return e}function co(){var e;return(e=Eo())===a&&(e=Po())===a&&(e=So())===a&&(e=Co()),e}function Eo(){var e,t,r,n,o;if(e=Za,(t=uo())!==a)if(q_()!==a){for(r=[],n=To();n!==a;)r.push(n),n=To();r!==a&&(n=q_())!==a?((o=fo())===a&&(o=null),o!==a&&q_()!==a&&po()!==a?e=t=c(t,r,o):(Za=e,e=a)):(Za=e,e=a)}else Za=e,e=a;else Za=e,e=a;return e}function uo(){var e,r,n,o,_;return e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,2)===d?(n=d,Za+=2):(n=a,0===no&&oo(T)),n!==a&&V_()!==a&&(o=Uo())!==a&&Q_()!==a&&Z_()!==a&&q_()!==a&&(_=so())!==a?e=r=f(o,_):(Za=e,e=a)):(Za=e,e=a),e===a&&(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,5)===p?(n=p,Za+=5):(n=a,0===no&&oo(P)),n!==a&&V_()!==a&&(o=e_())!==a&&Q_()!==a&&Z_()!==a&&q_()!==a&&(_=so())!==a?e=r=S(o,_):(Za=e,e=a)):(Za=e,e=a),e===a&&(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,6)===A?(n=A,Za+=6):(n=a,0===no&&oo(h)),n!==a&&V_()!==a&&(o=e_())!==a&&Q_()!==a&&Z_()!==a&&q_()!==a&&(_=so())!==a?e=r=v(o,_):(Za=e,e=a)):(Za=e,e=a))),e}function To(){var e,r,n,o,_;return e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,4)===m?(n=m,Za+=4):(n=a,0===no&&oo(g)),n!==a&&V_()!==a&&(o=Uo())!==a&&Q_()!==a&&Z_()!==a&&q_()!==a&&(_=so())!==a&&q_()!==a?e=r=O(o,_):(Za=e,e=a)):(Za=e,e=a),e}function fo(){var e,r,n,o;return e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,4)===N?(n=N,Za+=4):(n=a,0===no&&oo(R)),n!==a&&Q_()!==a&&Z_()!==a&&q_()!==a&&(o=so())!==a?e=r=I(o):(Za=e,e=a)):(Za=e,e=a),e}function po(){var e,r,n,o,_,i;return e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&(n=Q_())!==a?(t.substr(Za,5)===b?(o=b,Za+=5):(o=a,0===no&&oo(y)),o!==a&&(_=Q_())!==a&&(i=$_())!==a?e=r=[r,n,o,_,i]:(Za=e,e=a)):(Za=e,e=a),e}function Po(){var e,r,n,o,_,i,s,l;return e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,7)===L?(n=L,Za+=7):(n=a,0===no&&oo(Y)),n!==a&&(o=Q_())!==a&&(_=T_())!==a&&(i=Q_())!==a&&(s=$_())!==a?e=r=M(_):(Za=e,e=a)):(Za=e,e=a),e===a&&(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,6)===x?(n=x,Za+=6):(n=a,0===no&&oo(C)),n===a&&(t.substr(Za,3)===w?(n=w,Za+=3):(n=a,0===no&&oo(U))),n!==a&&(o=V_())!==a&&(_=e_())!==a?(i=Za,(s=V_())!==a&&(l=wo())!==a?i=s=[s,l]:(Za=i,i=a),i===a&&(i=null),i!==a&&(s=Q_())!==a&&(l=$_())!==a?e=r=k(n,_,i):(Za=e,e=a)):(Za=e,e=a)):(Za=e,e=a),e===a&&(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,5)===D?(n=D,Za+=5):(n=a,0===no&&oo(F)),n!==a?(o=Za,(_=V_())!==a&&(i=wo())!==a?o=_=[_,i]:(Za=o,o=a),o===a&&(o=null),o!==a&&(_=Q_())!==a&&(i=$_())!==a?e=r=G(o):(Za=e,e=a)):(Za=e,e=a)):(Za=e,e=a),e===a&&(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,4)===K?(n=K,Za+=4):(n=a,0===no&&oo(B)),n!==a&&(o=V_())!==a&&(_=wo())!==a&&(i=Q_())!==a&&(s=$_())!==a?e=r=X(_):(Za=e,e=a)):(Za=e,e=a),e===a&&(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,6)===H?(n=H,Za+=6):(n=a,0===no&&oo(j)),n!==a&&(o=V_())!==a&&(_=e_())!==a&&(i=V_())!==a&&(s=wo())!==a&&(l=Q_())!==a&&$_()!==a?e=r=z(_,s):(Za=e,e=a)):(Za=e,e=a),e===a&&(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,5)===Q?(n=Q,Za+=5):(n=a,0===no&&oo(V)),n!==a&&(o=V_())!==a&&(_=e_())!==a&&(i=Q_())!==a&&(s=$_())!==a?e=r=q(_):(Za=e,e=a)):(Za=e,e=a),e===a&&(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,7)===W?(n=W,Za+=7):(n=a,0===no&&oo(J)),n!==a?(o=Za,(_=V_())!==a&&(i=wo())!==a?o=_=[_,i]:(Za=o,o=a),o===a&&(o=null),o!==a&&(_=Q_())!==a&&(i=$_())!==a?e=r=Z(o):(Za=e,e=a)):(Za=e,e=a)):(Za=e,e=a),e===a&&(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,9)===$?(n=$,Za+=9):(n=a,0===no&&oo(ee)),n!==a?(o=Za,(_=V_())!==a&&(i=wo())!==a?o=_=[_,i]:(Za=o,o=a),o===a&&(o=null),o!==a&&(_=Q_())!==a&&(i=$_())!==a?e=r=te(o):(Za=e,e=a)):(Za=e,e=a)):(Za=e,e=a),e===a&&(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,7)===re?(n=re,Za+=7):(n=a,0===no&&oo(ne)),n!==a&&(o=V_())!==a&&(_=P_())!==a&&(i=Q_())!==a&&(s=$_())!==a?e=r=ae(_):(Za=e,e=a)):(Za=e,e=a),e===a&&(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a&&(n=$_())!==a?e=r=oe():(Za=e,e=a)))))))))),e}function So(){var e,t;return e=Za,(t=Ao())!==a&&q_()!==a&&ho()!==a?e=t=_e(t):(Za=e,e=a),e===a&&(e=Mo())===a&&(e=xo()),e}function Ao(){var e,r,n,o,_,i,s,l,c,d;if(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a)if(Q_()!==a)if(t.substr(Za,4)===ie?(n=ie,Za+=4):(n=a,0===no&&oo(se)),n!==a)if(V_()!==a)if((o=e_())!==a)if(Q_()!==a)if(Z_()!==a)if(q_()!==a){for(_=[],i=Za,(s=vo())!==a&&(l=q_())!==a?i=s=[s,l]:(Za=i,i=a);i!==a;)_.push(i),i=Za,(s=vo())!==a&&(l=q_())!==a?i=s=[s,l]:(Za=i,i=a);if(_!==a){for(i=[],s=Za,(l=mo())!==a&&(c=q_())!==a?s=l=[l,c]:(Za=s,s=a);s!==a;)i.push(s),s=Za,(l=mo())!==a&&(c=q_())!==a?s=l=[l,c]:(Za=s,s=a);if(i!==a){for(s=[],l=Za,(c=go())!==a&&(d=q_())!==a?l=c=[c,d]:(Za=l,l=a);l!==a;)s.push(l),l=Za,(c=go())!==a&&(d=q_())!==a?l=c=[c,d]:(Za=l,l=a);s!==a?e=r=le(o,_,i,s):(Za=e,e=a)}else Za=e,e=a}else Za=e,e=a}else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;return e}function ho(){var e,r,n,o,_,i;return e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&(n=Q_())!==a?(t.substr(Za,7)===ce?(o=ce,Za+=7):(o=a,0===no&&oo(Ee)),o!==a&&(_=Q_())!==a?((i=$_())===a&&(i=null),i!==a?e=r=[r,n,o,_,i]:(Za=e,e=a)):(Za=e,e=a)):(Za=e,e=a),e}function vo(){var e,r,n,o,_,i,s;return e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,8)===ue?(n=ue,Za+=8):(n=a,0===no&&oo(de)),n!==a&&V_()!==a&&(o=e_())!==a?(_=Za,(i=V_())!==a&&(s=wo())!==a?_=i=[i,s]:(Za=_,_=a),_===a&&(_=null),_!==a&&(i=Q_())!==a&&(s=Z_())!==a?e=r=Te(o,_):(Za=e,e=a)):(Za=e,e=a)):(Za=e,e=a),e}function mo(){var e;return(e=yo())===a&&(e=Lo())===a&&(e=Yo()),e}function go(){var e;return(e=Oo())===a&&(e=Co()),e}function Oo(){var e,t,r,n,o;if(e=Za,(t=No())!==a)if(q_()!==a){for(r=[],n=Ro();n!==a;)r.push(n),n=Ro();r!==a&&(n=q_())!==a?((o=Io())===a&&(o=null),o!==a&&q_()!==a&&bo()!==a?e=t=fe(t,r,o):(Za=e,e=a)):(Za=e,e=a)}else Za=e,e=a;else Za=e,e=a;return e}function No(){var e,r,n,o,_,i,s,l;if(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a)if(Q_()!==a)if(t.substr(Za,7)===pe?(n=pe,Za+=7):(n=a,0===no&&oo(Pe)),n!==a)if(V_()!==a)if((o=Uo())!==a)if(Q_()!==a)if(Z_()!==a)if(q_()!==a){for(_=[],i=Za,(s=go())!==a&&(l=q_())!==a?i=s=[s,l]:(Za=i,i=a);i!==a;)_.push(i),i=Za,(s=go())!==a&&(l=q_())!==a?i=s=[s,l]:(Za=i,i=a);_!==a?e=r=Se(o,_):(Za=e,e=a)}else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;if(e===a){if(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a)if(Q_()!==a)if(t.substr(Za,10)===Ae?(n=Ae,Za+=10):(n=a,0===no&&oo(he)),n!==a)if(V_()!==a)if((o=e_())!==a)if(Q_()!==a)if(Z_()!==a)if(q_()!==a){for(_=[],i=Za,(s=go())!==a&&(l=q_())!==a?i=s=[s,l]:(Za=i,i=a);i!==a;)_.push(i),i=Za,(s=go())!==a&&(l=q_())!==a?i=s=[s,l]:(Za=i,i=a);_!==a?e=r=ve(o,_):(Za=e,e=a)}else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;if(e===a)if(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a)if(Q_()!==a)if(t.substr(Za,11)===me?(n=me,Za+=11):(n=a,0===no&&oo(ge)),n!==a)if(V_()!==a)if((o=e_())!==a)if(Q_()!==a)if(Z_()!==a)if(q_()!==a){for(_=[],i=Za,(s=go())!==a&&(l=q_())!==a?i=s=[s,l]:(Za=i,i=a);i!==a;)_.push(i),i=Za,(s=go())!==a&&(l=q_())!==a?i=s=[s,l]:(Za=i,i=a);_!==a?e=r=Oe(o,_):(Za=e,e=a)}else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a}return e}function Ro(){var e,r,n,o,_,i,s,l;if(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a)if(Q_()!==a)if(t.substr(Za,9)===Ne?(n=Ne,Za+=9):(n=a,0===no&&oo(Re)),n!==a)if(V_()!==a)if((o=Uo())!==a)if(Q_()!==a)if(Z_()!==a)if(q_()!==a){for(_=[],i=Za,(s=go())!==a&&(l=q_())!==a?i=s=[s,l]:(Za=i,i=a);i!==a;)_.push(i),i=Za,(s=go())!==a&&(l=q_())!==a?i=s=[s,l]:(Za=i,i=a);_!==a&&(i=q_())!==a?e=r=Ie(o,_):(Za=e,e=a)}else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;return e}function Io(){var e,r,n,o,_,i,s;if(e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a)if(Q_()!==a)if(t.substr(Za,9)===be?(n=be,Za+=9):(n=a,0===no&&oo(ye)),n!==a)if(Q_()!==a)if(Z_()!==a)if(q_()!==a){for(o=[],_=Za,(i=go())!==a&&(s=q_())!==a?_=i=[i,s]:(Za=_,_=a);_!==a;)o.push(_),_=Za,(i=go())!==a&&(s=q_())!==a?_=i=[i,s]:(Za=_,_=a);o!==a?e=r=Le(o):(Za=e,e=a)}else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;else Za=e,e=a;return e}function bo(){var e,r,n,o,_,i;return e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&(n=Q_())!==a?(t.substr(Za,10)===Ye?(o=Ye,Za+=10):(o=a,0===no&&oo(Me)),o!==a&&(_=Q_())!==a&&(i=$_())!==a?e=r=[r,n,o,_,i]:(Za=e,e=a)):(Za=e,e=a),e}function yo(){var e,r,n,o,_,i,s;return e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,7)===xe?(n=xe,Za+=7):(n=a,0===no&&oo(Ce)),n!==a?(o=Za,(_=V_())!==a?(t.substr(Za,8)===we?(i=we,Za+=8):(i=a,0===no&&oo(Ue)),i!==a?o=_=[_,i]:(Za=o,o=a)):(Za=o,o=a),o===a&&(o=null),o!==a?(_=Za,(i=V_())!==a&&(s=wo())!==a?_=i=[i,s]:(Za=_,_=a),_===a&&(_=null),_!==a&&(i=Q_())!==a&&(s=Z_())!==a?e=r=ke(o,_):(Za=e,e=a)):(Za=e,e=a)):(Za=e,e=a)):(Za=e,e=a),e}function Lo(){var e,r,n,o,_,i,s;return e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,8)===De?(n=De,Za+=8):(n=a,0===no&&oo(Fe)),n!==a?(o=Za,(_=V_())!==a?(t.substr(Za,8)===we?(i=we,Za+=8):(i=a,0===no&&oo(Ue)),i!==a?o=_=[_,i]:(Za=o,o=a)):(Za=o,o=a),o===a&&(o=null),o!==a?(_=Za,(i=V_())!==a&&(s=wo())!==a?_=i=[i,s]:(Za=_,_=a),_===a&&(_=null),_!==a&&(i=Q_())!==a&&(s=Z_())!==a?e=r=Ge(o,_):(Za=e,e=a)):(Za=e,e=a)):(Za=e,e=a)):(Za=e,e=a),e}function Yo(){var e,r,n,o,_,i,s;return e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,10)===Ke?(n=Ke,Za+=10):(n=a,0===no&&oo(Be)),n!==a?(o=Za,(_=V_())!==a?(t.substr(Za,8)===we?(i=we,Za+=8):(i=a,0===no&&oo(Ue)),i!==a?o=_=[_,i]:(Za=o,o=a)):(Za=o,o=a),o===a&&(o=null),o!==a?(_=Za,(i=V_())!==a&&(s=wo())!==a?_=i=[i,s]:(Za=_,_=a),_===a&&(_=null),_!==a&&(i=Q_())!==a&&(s=Z_())!==a?e=r=Xe(o,_):(Za=e,e=a)):(Za=e,e=a)):(Za=e,e=a)):(Za=e,e=a),e}function Mo(){var e,r,n;return e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,12)===He?(n=He,Za+=12):(n=a,0===no&&oo(je)),n!==a&&Q_()!==a&&$_()!==a?e=r=ze():(Za=e,e=a)):(Za=e,e=a),e}function xo(){var e,r,n;return e=Za,35===t.charCodeAt(Za)?(r=E,Za++):(r=a,0===no&&oo(u)),r!==a&&Q_()!==a?(t.substr(Za,10)===Qe?(n=Qe,Za+=10):(n=a,0===no&&oo(Ve)),n!==a&&Q_()!==a&&$_()!==a?e=r=qe():(Za=e,e=a)):(Za=e,e=a),e}function Co(){var e;return(e=wo())!==a&&(e=We(e)),e}function wo(){var e,t,r,n,o,_;if(e=Za,(t=P_())!==a){for(r=[],n=Za,(o=Q_())!==a&&(_=P_())!==a?n=o=[o,_]:(Za=n,n=a);n!==a;)r.push(n),n=Za,(o=Q_())!==a&&(_=P_())!==a?n=o=[o,_]:(Za=n,n=a);r!==a?e=t=l(t,r):(Za=e,e=a)}else Za=e,e=a;return e}function Uo(){var e,r,n,o,_,i,s,l;if(e=Za,(r=ko())!==a){for(n=[],o=Za,(_=Q_())!==a?(44===t.charCodeAt(Za)?(i=Je,Za++):(i=a,0===no&&oo(Ze)),i!==a&&(s=Q_())!==a&&(l=ko())!==a?o=_=[_,i,s,l]:(Za=o,o=a)):(Za=o,o=a);o!==a;)n.push(o),o=Za,(_=Q_())!==a?(44===t.charCodeAt(Za)?(i=Je,Za++):(i=a,0===no&&oo(Ze)),i!==a&&(s=Q_())!==a&&(l=ko())!==a?o=_=[_,i,s,l]:(Za=o,o=a)):(Za=o,o=a);n!==a?e=r=$e(r,n):(Za=e,e=a)}else Za=e,e=a;return e}function ko(){var e,r,n,o,_,i;return e=Za,(r=Do())!==a&&Q_()!==a?(63===t.charCodeAt(Za)?(n=et,Za++):(n=a,0===no&&oo(tt)),n!==a&&Q_()!==a&&(o=Uo())!==a&&Q_()!==a?(58===t.charCodeAt(Za)?(_=rt,Za++):(_=a,0===no&&oo(nt)),_!==a&&Q_()!==a&&(i=Uo())!==a?e=r=at(r,o,i):(Za=e,e=a)):(Za=e,e=a)):(Za=e,e=a),e===a&&(e=Do()),e}function Do(){var e,t,r,n,o,_,i,s;if(e=Za,(t=Fo())!==a){for(r=[],n=Za,(o=Q_())!==a&&(_=d_())!==a&&(i=Q_())!==a&&(s=Fo())!==a?n=o=[o,_,i,s]:(Za=n,n=a);n!==a;)r.push(n),n=Za,(o=Q_())!==a&&(_=d_())!==a&&(i=Q_())!==a&&(s=Fo())!==a?n=o=[o,_,i,s]:(Za=n,n=a);r!==a?e=t=ot(t,r):(Za=e,e=a)}else Za=e,e=a;return e}function Fo(){var e,t,r,n,o,_,i,s;if(e=Za,(t=Go())!==a){for(r=[],n=Za,(o=Q_())!==a&&(_=u_())!==a&&(i=Q_())!==a&&(s=Go())!==a?n=o=[o,_,i,s]:(Za=n,n=a);n!==a;)r.push(n),n=Za,(o=Q_())!==a&&(_=u_())!==a&&(i=Q_())!==a&&(s=Go())!==a?n=o=[o,_,i,s]:(Za=n,n=a);r!==a?e=t=_t(t,r):(Za=e,e=a)}else Za=e,e=a;return e}function Go(){var e,t,r,n,o,_,i,s;if(e=Za,(t=Ko())!==a){for(r=[],n=Za,(o=Q_())!==a&&(_=E_())!==a&&(i=Q_())!==a&&(s=Ko())!==a?n=o=[o,_,i,s]:(Za=n,n=a);n!==a;)r.push(n),n=Za,(o=Q_())!==a&&(_=E_())!==a&&(i=Q_())!==a&&(s=Ko())!==a?n=o=[o,_,i,s]:(Za=n,n=a);r!==a?e=t=it(t,r):(Za=e,e=a)}else Za=e,e=a;return e}function Ko(){var e,t,r,n,o,_,i,s;if(e=Za,(t=Bo())!==a){for(r=[],n=Za,(o=Q_())!==a&&(_=c_())!==a&&(i=Q_())!==a&&(s=Bo())!==a?n=o=[o,_,i,s]:(Za=n,n=a);n!==a;)r.push(n),n=Za,(o=Q_())!==a&&(_=c_())!==a&&(i=Q_())!==a&&(s=Bo())!==a?n=o=[o,_,i,s]:(Za=n,n=a);r!==a?e=t=st(t,r):(Za=e,e=a)}else Za=e,e=a;return e}function Bo(){var e,t,r,n,o,_,i,s;if(e=Za,(t=Xo())!==a){for(r=[],n=Za,(o=Q_())!==a&&(_=l_())!==a&&(i=Q_())!==a&&(s=Xo())!==a?n=o=[o,_,i,s]:(Za=n,n=a);n!==a;)r.push(n),n=Za,(o=Q_())!==a&&(_=l_())!==a&&(i=Q_())!==a&&(s=Xo())!==a?n=o=[o,_,i,s]:(Za=n,n=a);r!==a?e=t=lt(t,r):(Za=e,e=a)}else Za=e,e=a;return e}function Xo(){var e,t,r,n,o,_,i,s;if(e=Za,(t=Ho())!==a){for(r=[],n=Za,(o=Q_())!==a&&(_=s_())!==a&&(i=Q_())!==a&&(s=Ho())!==a?n=o=[o,_,i,s]:(Za=n,n=a);n!==a;)r.push(n),n=Za,(o=Q_())!==a&&(_=s_())!==a&&(i=Q_())!==a&&(s=Ho())!==a?n=o=[o,_,i,s]:(Za=n,n=a);r!==a?e=t=ct(t,r):(Za=e,e=a)}else Za=e,e=a;return e}function Ho(){var e,t,r,n,o,_,i,s;if(e=Za,(t=jo())!==a){for(r=[],n=Za,(o=Q_())!==a&&(_=i_())!==a&&(i=Q_())!==a&&(s=jo())!==a?n=o=[o,_,i,s]:(Za=n,n=a);n!==a;)r.push(n),n=Za,(o=Q_())!==a&&(_=i_())!==a&&(i=Q_())!==a&&(s=jo())!==a?n=o=[o,_,i,s]:(Za=n,n=a);r!==a?e=t=Et(t,r):(Za=e,e=a)}else Za=e,e=a;return e}function jo(){var e,t,r,n,o,_,i,s;if(e=Za,(t=zo())!==a){for(r=[],n=Za,(o=Q_())!==a&&(_=__())!==a&&(i=Q_())!==a&&(s=zo())!==a?n=o=[o,_,i,s]:(Za=n,n=a);n!==a;)r.push(n),n=Za,(o=Q_())!==a&&(_=__())!==a&&(i=Q_())!==a&&(s=zo())!==a?n=o=[o,_,i,s]:(Za=n,n=a);r!==a?e=t=ut(t,r):(Za=e,e=a)}else Za=e,e=a;return e}function zo(){var e,t,r,n,o,_,i,s;if(e=Za,(t=Qo())!==a){for(r=[],n=Za,(o=Q_())!==a&&(_=o_())!==a&&(i=Q_())!==a&&(s=Qo())!==a?n=o=[o,_,i,s]:(Za=n,n=a);n!==a;)r.push(n),n=Za,(o=Q_())!==a&&(_=o_())!==a&&(i=Q_())!==a&&(s=Qo())!==a?n=o=[o,_,i,s]:(Za=n,n=a);r!==a?e=t=dt(t,r):(Za=e,e=a)}else Za=e,e=a;return e}function Qo(){var e,t,r,n,o,_,i,s;if(e=Za,(t=Vo())!==a){for(r=[],n=Za,(o=Q_())!==a&&(_=a_())!==a&&(i=Q_())!==a&&(s=Vo())!==a?n=o=[o,_,i,s]:(Za=n,n=a);n!==a;)r.push(n),n=Za,(o=Q_())!==a&&(_=a_())!==a&&(i=Q_())!==a&&(s=Vo())!==a?n=o=[o,_,i,s]:(Za=n,n=a);r!==a?e=t=Tt(t,r):(Za=e,e=a)}else Za=e,e=a;return e}function Vo(){var e,r,n;return e=Za,t.substr(Za,7)===ft?(r=ft,Za+=7):(r=a,0===no&&oo(pt)),r!==a&&Q_()!==a&&(n=Jo())!==a?e=r=Pt(n):(Za=e,e=a),e===a&&(e=qo())===a&&(e=Za,(r=n_())!==a&&Q_()!==a&&(n=Vo())!==a?e=r=St(r,n):(Za=e,e=a)),e}function qo(){var e,t,r;return e=Za,(t=Wo())!==a&&Q_()!==a&&(r=r_())!==a?e=t=At(t,r):(Za=e,e=a),e===a&&(e=Wo()),e}function Wo(){var e,r,n,o;return e=Za,(r=Zo())!==a&&(r=ht(r)),(e=r)===a&&(e=Za,(r=e_())!==a&&(r=vt(r)),(e=r)===a&&(e=Za,40===t.charCodeAt(Za)?(r=mt,Za++):(r=a,0===no&&oo(gt)),r!==a&&Q_()!==a&&(n=Uo())!==a&&Q_()!==a?(41===t.charCodeAt(Za)?(o=Ot,Za++):(o=a,0===no&&oo(Nt)),o!==a?e=r=Rt(n):(Za=e,e=a)):(Za=e,e=a))),e}function Jo(){var e,r,n,o,_,i;if(e=Za,(r=e_())!==a&&(r=vt(r)),(e=r)===a){if(e=Za,r=[],n=Za,o=Za,no++,40===t.charCodeAt(Za)?(_=mt,Za++):(_=a,0===no&&oo(gt)),_===a&&(41===t.charCodeAt(Za)?(_=Ot,Za++):(_=a,0===no&&oo(Nt))),no--,_===a?o=void 0:(Za=o,o=a),o!==a&&(_=ai())!==a?n=o=[o,_]:(Za=n,n=a),n!==a)for(;n!==a;)r.push(n),n=Za,o=Za,no++,40===t.charCodeAt(Za)?(_=mt,Za++):(_=a,0===no&&oo(gt)),_===a&&(41===t.charCodeAt(Za)?(_=Ot,Za++):(_=a,0===no&&oo(Nt))),no--,_===a?o=void 0:(Za=o,o=a),o!==a&&(_=ai())!==a?n=o=[o,_]:(Za=n,n=a);else r=a;r!==a&&(r=It()),(e=r)===a&&(e=Za,40===t.charCodeAt(Za)?(r=mt,Za++):(r=a,0===no&&oo(gt)),r!==a&&(n=Q_())!==a&&(o=Jo())!==a&&(_=Q_())!==a?(41===t.charCodeAt(Za)?(i=Ot,Za++):(i=a,0===no&&oo(Nt)),i!==a?e=r=Rt(o):(Za=e,e=a)):(Za=e,e=a))}return e}function Zo(){var e,t;return no++,(t=N_())===a&&(t=$o()),t!==a&&(t=yt(t)),no--,(e=t)===a&&(t=a,0===no&&oo(bt)),e}function $o(){var e,r;return e=Za,(e=(r=R_())!==a?t.substring(e,Za):r)!==a&&(e=Lt(e)),e}var e_=function(){var e,t,r;return no++,e=Za,t=Za,no++,r=t_(),no--,r===a?t=void 0:(Za=t,t=a),t!==a&&(r=S_())!==a?e=t=Mt(r):(Za=e,e=a),no--,e===a&&(t=a,0===no&&oo(Yt)),e};function t_(){var e,r,n,o;return e=Za,t.substr(Za,7)===ft?(r=ft,Za+=7):(r=a,0===no&&oo(pt)),r!==a?(n=Za,no++,o=h_(),no--,o===a?n=void 0:(Za=n,n=a),n!==a?e=r=[r,n]:(Za=e,e=a)):(Za=e,e=a),e}function r_(){var e;return t.substr(Za,2)===xt?(e=xt,Za+=2):(e=a,0===no&&oo(Ct)),e===a&&(t.substr(Za,2)===wt?(e=wt,Za+=2):(e=a,0===no&&oo(Ut))),e}function n_(){var e;return t.substr(Za,2)===xt?(e=xt,Za+=2):(e=a,0===no&&oo(Ct)),e===a&&(t.substr(Za,2)===wt?(e=wt,Za+=2):(e=a,0===no&&oo(Ut)),e===a&&(43===t.charCodeAt(Za)?(e=kt,Za++):(e=a,0===no&&oo(Dt)),e===a&&(45===t.charCodeAt(Za)?(e=Ft,Za++):(e=a,0===no&&oo(Gt)),e===a&&(126===t.charCodeAt(Za)?(e=Kt,Za++):(e=a,0===no&&oo(Bt)),e===a&&(33===t.charCodeAt(Za)?(e=Xt,Za++):(e=a,0===no&&oo(Ht))))))),e}function a_(){var e,r,n,o;return e=Za,42===t.charCodeAt(Za)?(r=jt,Za++):(r=a,0===no&&oo(zt)),r===a&&(47===t.charCodeAt(Za)?(r=Qt,Za++):(r=a,0===no&&oo(Vt)),r===a&&(37===t.charCodeAt(Za)?(r=qt,Za++):(r=a,0===no&&oo(Wt)))),r!==a?(n=Za,no++,61===t.charCodeAt(Za)?(o=Jt,Za++):(o=a,0===no&&oo(Zt)),no--,o===a?n=void 0:(Za=n,n=a),n!==a?e=r=$t(r):(Za=e,e=a)):(Za=e,e=a),e}function o_(){var e,r,n,o;return e=Za,43===t.charCodeAt(Za)?(r=kt,Za++):(r=a,0===no&&oo(Dt)),r!==a?(n=Za,no++,43===t.charCodeAt(Za)?(o=kt,Za++):(o=a,0===no&&oo(Dt)),o===a&&(61===t.charCodeAt(Za)?(o=Jt,Za++):(o=a,0===no&&oo(Zt))),no--,o===a?n=void 0:(Za=n,n=a),n!==a?e=r=er():(Za=e,e=a)):(Za=e,e=a),e===a&&(e=Za,45===t.charCodeAt(Za)?(r=Ft,Za++):(r=a,0===no&&oo(Gt)),r!==a?(n=Za,no++,45===t.charCodeAt(Za)?(o=Ft,Za++):(o=a,0===no&&oo(Gt)),o===a&&(61===t.charCodeAt(Za)?(o=Jt,Za++):(o=a,0===no&&oo(Zt))),no--,o===a?n=void 0:(Za=n,n=a),n!==a?e=r=tr():(Za=e,e=a)):(Za=e,e=a)),e}function __(){var e;return t.substr(Za,2)===rr?(e=rr,Za+=2):(e=a,0===no&&oo(nr)),e===a&&(t.substr(Za,2)===ar?(e=ar,Za+=2):(e=a,0===no&&oo(or))),e}function i_(){var e;return t.substr(Za,2)===_r?(e=_r,Za+=2):(e=a,0===no&&oo(ir)),e===a&&(t.substr(Za,2)===sr?(e=sr,Za+=2):(e=a,0===no&&oo(lr)),e===a&&(60===t.charCodeAt(Za)?(e=cr,Za++):(e=a,0===no&&oo(Er)),e===a&&(62===t.charCodeAt(Za)?(e=ur,Za++):(e=a,0===no&&oo(dr))))),e}function s_(){var e;return t.substr(Za,2)===Tr?(e=Tr,Za+=2):(e=a,0===no&&oo(fr)),e===a&&(t.substr(Za,2)===pr?(e=pr,Za+=2):(e=a,0===no&&oo(Pr))),e}function l_(){var e,r,n,o;return e=Za,38===t.charCodeAt(Za)?(r=Sr,Za++):(r=a,0===no&&oo(Ar)),r!==a?(n=Za,no++,38===t.charCodeAt(Za)?(o=Sr,Za++):(o=a,0===no&&oo(Ar)),no--,o===a?n=void 0:(Za=n,n=a),n!==a?e=r=hr():(Za=e,e=a)):(Za=e,e=a),e}function c_(){var e,r,n,o;return e=Za,94===t.charCodeAt(Za)?(r=vr,Za++):(r=a,0===no&&oo(mr)),r!==a?(n=Za,no++,94===t.charCodeAt(Za)?(o=vr,Za++):(o=a,0===no&&oo(mr)),no--,o===a?n=void 0:(Za=n,n=a),n!==a?e=r=gr():(Za=e,e=a)):(Za=e,e=a),e}function E_(){var e,r,n,o;return e=Za,124===t.charCodeAt(Za)?(r=Or,Za++):(r=a,0===no&&oo(Nr)),r!==a?(n=Za,no++,124===t.charCodeAt(Za)?(o=Or,Za++):(o=a,0===no&&oo(Nr)),no--,o===a?n=void 0:(Za=n,n=a),n!==a?e=r=Rr():(Za=e,e=a)):(Za=e,e=a),e}function u_(){var e;return t.substr(Za,2)===Ir?(e=Ir,Za+=2):(e=a,0===no&&oo(br)),e!==a&&(e=yr()),e}function d_(){var e;return t.substr(Za,2)===Lr?(e=Lr,Za+=2):(e=a,0===no&&oo(Yr)),e!==a&&(e=Mr()),e}function T_(){var e,r,n,o;return e=Za,60===t.charCodeAt(Za)?(r=cr,Za++):(r=a,0===no&&oo(Er)),r!==a&&Q_()!==a&&(n=f_())!==a&&Q_()!==a?(62===t.charCodeAt(Za)?(o=ur,Za++):(o=a,0===no&&oo(dr)),o!==a?e=r=Mt(n):(Za=e,e=a)):(Za=e,e=a),e===a&&(e=Za,34===t.charCodeAt(Za)?(r=xr,Za++):(r=a,0===no&&oo(Cr)),r!==a&&Q_()!==a&&(n=p_())!==a&&Q_()!==a?(34===t.charCodeAt(Za)?(o=xr,Za++):(o=a,0===no&&oo(Cr)),o!==a?e=r=Mt(n):(Za=e,e=a)):(Za=e,e=a)),e}function f_(){var e,r,n,o;for(e=[],r=Za,n=Za,no++,(o=$_())===a&&(62===t.charCodeAt(Za)?(o=ur,Za++):(o=a,0===no&&oo(dr))),no--,o===a?n=void 0:(Za=n,n=a),n!==a&&(o=ai())!==a?r=n=[n,o]:(Za=r,r=a);r!==a;)e.push(r),r=Za,n=Za,no++,(o=$_())===a&&(62===t.charCodeAt(Za)?(o=ur,Za++):(o=a,0===no&&oo(dr))),no--,o===a?n=void 0:(Za=n,n=a),n!==a&&(o=ai())!==a?r=n=[n,o]:(Za=r,r=a);return e!==a&&(e=wr(e)),e}function p_(){var e,r,n,o;for(e=[],r=Za,n=Za,no++,(o=$_())===a&&(34===t.charCodeAt(Za)?(o=xr,Za++):(o=a,0===no&&oo(Cr))),no--,o===a?n=void 0:(Za=n,n=a),n!==a&&(o=ai())!==a?r=n=[n,o]:(Za=r,r=a);r!==a;)e.push(r),r=Za,n=Za,no++,(o=$_())===a&&(34===t.charCodeAt(Za)?(o=xr,Za++):(o=a,0===no&&oo(Cr))),no--,o===a?n=void 0:(Za=n,n=a),n!==a&&(o=ai())!==a?r=n=[n,o]:(Za=r,r=a);return e!==a&&(e=wr(e)),e}function P_(){var e;return(e=e_())===a&&(e=g_())===a&&(e=C_())===a&&(e=z_()),e}function S_(){var e,t,r,n;if(no++,e=Za,(t=A_())!==a){for(r=[],n=h_();n!==a;)r.push(n),n=h_();r!==a?e=t=Ur(t,r):(Za=e,e=a)}else Za=e,e=a;return no--,e===a&&(t=a,0===no&&oo(Yt)),e}function A_(){var e;return(e=v_())===a&&(36===t.charCodeAt(Za)?(e=kr,Za++):(e=a,0===no&&oo(Dr)),e===a&&(95===t.charCodeAt(Za)?(e=Fr,Za++):(e=a,0===no&&oo(Gr)))),e}function h_(){var e;return(e=A_())===a&&(e=b_()),e}function v_(){var e;return Kr.test(t.charAt(Za))?(e=t.charAt(Za),Za++):(e=a,0===no&&oo(Br)),e}function m_(){var e,r,n,o;return e=Za,t.substr(Za,7)===Xr?(r=Xr,Za+=7):(r=a,0===no&&oo(Hr)),r===a&&(t.substr(Za,5)===jr?(r=jr,Za+=5):(r=a,0===no&&oo(zr)),r===a&&(t.substr(Za,5)===Qr?(r=Qr,Za+=5):(r=a,0===no&&oo(Vr)),r===a&&(t.substr(Za,6)===qr?(r=qr,Za+=6):(r=a,0===no&&oo(Wr)),r===a&&(t.substr(Za,6)===Jr?(r=Jr,Za+=6):(r=a,0===no&&oo(Zr)),r===a&&(t.substr(Za,3)===$r?(r=$r,Za+=3):(r=a,0===no&&oo(en)),r===a&&(t.substr(Za,6)===tn?(r=tn,Za+=6):(r=a,0===no&&oo(rn)),r===a&&(t.substr(Za,7)===nn?(r=nn,Za+=7):(r=a,0===no&&oo(an)),r===a&&(t.substr(Za,8)===on?(r=on,Za+=8):(r=a,0===no&&oo(_n)),r===a&&(t.substr(Za,5)===sn?(r=sn,Za+=5):(r=a,0===no&&oo(ln)),r===a&&(t.substr(Za,7)===cn?(r=cn,Za+=7):(r=a,0===no&&oo(En)),r===a&&(t.substr(Za,8)===un?(r=un,Za+=8):(r=a,0===no&&oo(dn)),r===a&&(t.substr(Za,8)===Tn?(r=Tn,Za+=8):(r=a,0===no&&oo(fn)),r===a&&(t.substr(Za,3)===w?(r=w,Za+=3):(r=a,0===no&&oo(U))))))))))))))),r!==a?(n=Za,no++,o=h_(),no--,o===a?n=void 0:(Za=n,n=a),n!==a?e=r=[r,n]:(Za=e,e=a)):(Za=e,e=a),e}function g_(){var e,t,r,n;return no++,e=Za,(t=N_())===a&&(t=O_()),t!==a?(r=Za,no++,n=A_(),no--,n===a?r=void 0:(Za=r,r=a),r!==a?e=t=yt(t):(Za=e,e=a)):(Za=e,e=a),no--,e===a&&(t=a,0===no&&oo(bt)),e}function O_(){var e,r,n,o,_,i,s;return e=Za,r=Za,n=Za,(o=R_())!==a?(46===t.charCodeAt(Za)?(_=pn,Za++):(_=a,0===no&&oo(Pn)),_!==a?((i=I_())===a&&(i=null),i!==a?((s=L_())===a&&(s=null),s!==a?n=o=[o,_,i,s]:(Za=n,n=a)):(Za=n,n=a)):(Za=n,n=a)):(Za=n,n=a),(r=n!==a?t.substring(r,Za):n)!==a&&(r=mn(r)),(e=r)===a&&(e=Za,r=Za,n=Za,46===t.charCodeAt(Za)?(o=pn,Za++):(o=a,0===no&&oo(Pn)),o!==a&&(_=I_())!==a?((i=L_())===a&&(i=null),i!==a?n=o=[o,_,i]:(Za=n,n=a)):(Za=n,n=a),(r=n!==a?t.substring(r,Za):n)!==a&&(r=gn(r)),(e=r)===a&&(e=Za,r=Za,n=Za,(o=R_())!==a?((_=L_())===a&&(_=null),_!==a?n=o=[o,_]:(Za=n,n=a)):(Za=n,n=a),(r=n!==a?t.substring(r,Za):n)!==a&&(r=gn(r)),e=r)),e}function N_(){var e,r,n,o,_,i;if(e=Za,48===t.charCodeAt(Za)?(r=Sn,Za++):(r=a,0===no&&oo(An)),r!==a)if(hn.test(t.charAt(Za))?(n=t.charAt(Za),Za++):(n=a,0===no&&oo(vn)),n!==a){if(o=Za,_=[],(i=x_())!==a)for(;i!==a;)_.push(i),i=x_();else _=a;(o=_!==a?t.substring(o,Za):_)!==a?e=r=On(o):(Za=e,e=a)}else Za=e,e=a;else Za=e,e=a;return e}function R_(){var e,r,n;return 48===t.charCodeAt(Za)?(e=Sn,Za++):(e=a,0===no&&oo(An)),e===a&&(e=Za,(r=y_())!==a?((n=I_())===a&&(n=null),n!==a?e=r=[r,n]:(Za=e,e=a)):(Za=e,e=a)),e}function I_(){var e,t;if(e=[],(t=b_())!==a)for(;t!==a;)e.push(t),t=b_();else e=a;return e}function b_(){var e;return Nn.test(t.charAt(Za))?(e=t.charAt(Za),Za++):(e=a,0===no&&oo(Rn)),e}function y_(){var e;return In.test(t.charAt(Za))?(e=t.charAt(Za),Za++):(e=a,0===no&&oo(bn)),e}function L_(){var e,t,r;return e=Za,(t=Y_())!==a&&(r=M_())!==a?e=t=[t,r]:(Za=e,e=a),e}function Y_(){var e;return yn.test(t.charAt(Za))?(e=t.charAt(Za),Za++):(e=a,0===no&&oo(Ln)),e}function M_(){var e,r,n;return e=Za,Yn.test(t.charAt(Za))?(r=t.charAt(Za),Za++):(r=a,0===no&&oo(Mn)),r===a&&(r=null),r!==a&&(n=I_())!==a?e=r=[r,n]:(Za=e,e=a),e}function x_(){var e;return xn.test(t.charAt(Za))?(e=t.charAt(Za),Za++):(e=a,0===no&&oo(Cn)),e}function C_(){var e,r,n,o,_;return no++,r=Za,34===t.charCodeAt(Za)?(n=xr,Za++):(n=a,0===no&&oo(Cr)),n!==a?((o=w_())===a&&(o=null),o!==a?(34===t.charCodeAt(Za)?(_=xr,Za++):(_=a,0===no&&oo(Cr)),_!==a?r=n=[n,o,_]:(Za=r,r=a)):(Za=r,r=a)):(Za=r,r=a),r===a&&(r=Za,39===t.charCodeAt(Za)?(n=Un,Za++):(n=a,0===no&&oo(kn)),n!==a?((o=U_())===a&&(o=null),o!==a?(39===t.charCodeAt(Za)?(_=Un,Za++):(_=a,0===no&&oo(kn)),_!==a?r=n=[n,o,_]:(Za=r,r=a)):(Za=r,r=a)):(Za=r,r=a)),r!==a&&(r=Dn(r)),no--,(e=r)===a&&(r=a,0===no&&oo(wn)),e}function w_(){var e,t;if(e=[],(t=k_())!==a)for(;t!==a;)e.push(t),t=k_();else e=a;return e!==a&&(e=Fn(e)),e}function U_(){var e,t;if(e=[],(t=D_())!==a)for(;t!==a;)e.push(t),t=D_();else e=a;return e!==a&&(e=Fn(e)),e}function k_(){var e,r,n;return e=Za,r=Za,no++,34===t.charCodeAt(Za)?(n=xr,Za++):(n=a,0===no&&oo(Cr)),n===a&&(92===t.charCodeAt(Za)?(n=Gn,Za++):(n=a,0===no&&oo(Kn)),n===a&&(n=J_())),no--,n===a?r=void 0:(Za=r,r=a),r!==a&&(n=ai())!==a?e=r=Bn(n):(Za=e,e=a),e===a&&(e=Za,92===t.charCodeAt(Za)?(r=Gn,Za++):(r=a,0===no&&oo(Kn)),r!==a&&(n=G_())!==a?e=r=Xn(n):(Za=e,e=a),e===a&&(e=F_())),e}function D_(){var e,r,n;return e=Za,r=Za,no++,39===t.charCodeAt(Za)?(n=Un,Za++):(n=a,0===no&&oo(kn)),n===a&&(92===t.charCodeAt(Za)?(n=Gn,Za++):(n=a,0===no&&oo(Kn)),n===a&&(n=J_())),no--,n===a?r=void 0:(Za=r,r=a),r!==a&&(n=ai())!==a?e=r=Bn(n):(Za=e,e=a),e===a&&(e=Za,92===t.charCodeAt(Za)?(r=Gn,Za++):(r=a,0===no&&oo(Kn)),r!==a&&(n=G_())!==a?e=r=Xn(n):(Za=e,e=a),e===a&&(e=F_())),e}function F_(){var e,r,n;return e=Za,92===t.charCodeAt(Za)?(r=Gn,Za++):(r=a,0===no&&oo(Kn)),r!==a&&(n=$_())!==a?e=r=Hn(n):(Za=e,e=a),e}function G_(){var e,r,n,o;return(e=K_())===a&&(e=Za,48===t.charCodeAt(Za)?(r=Sn,Za++):(r=a,0===no&&oo(An)),r!==a?(n=Za,no++,o=b_(),no--,o===a?n=void 0:(Za=n,n=a),n!==a?e=r=jn():(Za=e,e=a)):(Za=e,e=a),e===a&&(e=j_())),e}function K_(){var e;return(e=B_())===a&&(e=X_()),e}function B_(){var e;return zn.test(t.charAt(Za))?(e=t.charAt(Za),Za++):(e=a,0===no&&oo(Qn)),e!==a&&(e=Vn(e)),e}function X_(){var e,t,r;return e=Za,t=Za,no++,r=H_(),no--,r===a?t=void 0:(Za=t,t=a),t===a&&(t=J_()),t!==a&&(r=ai())!==a?e=t=qn(r):(Za=e,e=a),e}function H_(){var e;return(e=B_())===a&&(e=b_())===a&&(120===t.charCodeAt(Za)?(e=Wn,Za++):(e=a,0===no&&oo(Jn)),e===a&&(117===t.charCodeAt(Za)?(e=Zn,Za++):(e=a,0===no&&oo($n)))),e}function j_(){var e,r,n,o,_,i;return e=Za,120===t.charCodeAt(Za)?(r=Wn,Za++):(r=a,0===no&&oo(Jn)),r!==a?(n=Za,o=Za,(_=x_())!==a&&(i=x_())!==a?o=_=[_,i]:(Za=o,o=a),(n=o!==a?t.substring(n,Za):o)!==a?e=r=ea(n):(Za=e,e=a)):(Za=e,e=a),e}function z_(){var e;return no++,t.substr(Za,2)===ra?(e=ra,Za+=2):(e=a,0===no&&oo(na)),e===a&&(t.substr(Za,2)===aa?(e=aa,Za+=2):(e=a,0===no&&oo(oa)),e===a&&(t.substr(Za,2)===_a?(e=_a,Za+=2):(e=a,0===no&&oo(ia)),e===a&&(t.substr(Za,2)===sa?(e=sa,Za+=2):(e=a,0===no&&oo(la)),e===a&&(t.substr(Za,2)===ca?(e=ca,Za+=2):(e=a,0===no&&oo(Ea)),e===a&&(t.substr(Za,2)===ua?(e=ua,Za+=2):(e=a,0===no&&oo(da)),e===a&&(t.substr(Za,2)===Ta?(e=Ta,Za+=2):(e=a,0===no&&oo(fa)),e===a&&(t.substr(Za,2)===pa?(e=pa,Za+=2):(e=a,0===no&&oo(Pa)),e===a&&(t.substr(Za,2)===rr?(e=rr,Za+=2):(e=a,0===no&&oo(nr)),e===a&&(t.substr(Za,2)===ar?(e=ar,Za+=2):(e=a,0===no&&oo(or)),e===a&&(t.substr(Za,3)===Sa?(e=Sa,Za+=3):(e=a,0===no&&oo(Aa)),e===a&&(t.substr(Za,3)===ha?(e=ha,Za+=3):(e=a,0===no&&oo(va)),e===a&&(t.substr(Za,2)===Tr?(e=Tr,Za+=2):(e=a,0===no&&oo(fr)),e===a&&(t.substr(Za,2)===pr?(e=pr,Za+=2):(e=a,0===no&&oo(Pr)),e===a&&(t.substr(Za,2)===_r?(e=_r,Za+=2):(e=a,0===no&&oo(ir)),e===a&&(t.substr(Za,2)===sr?(e=sr,Za+=2):(e=a,0===no&&oo(lr)),e===a&&(t.substr(Za,2)===Ir?(e=Ir,Za+=2):(e=a,0===no&&oo(br)),e===a&&(t.substr(Za,2)===Lr?(e=Lr,Za+=2):(e=a,0===no&&oo(Yr)),e===a&&(t.substr(Za,2)===xt?(e=xt,Za+=2):(e=a,0===no&&oo(Ct)),e===a&&(t.substr(Za,2)===wt?(e=wt,Za+=2):(e=a,0===no&&oo(Ut)),e===a&&(123===t.charCodeAt(Za)?(e=ma,Za++):(e=a,0===no&&oo(ga)),e===a&&(125===t.charCodeAt(Za)?(e=Oa,Za++):(e=a,0===no&&oo(Na)),e===a&&(91===t.charCodeAt(Za)?(e=Ra,Za++):(e=a,0===no&&oo(Ia)),e===a&&(93===t.charCodeAt(Za)?(e=ba,Za++):(e=a,0===no&&oo(ya)),e===a&&(40===t.charCodeAt(Za)?(e=mt,Za++):(e=a,0===no&&oo(gt)),e===a&&(41===t.charCodeAt(Za)?(e=Ot,Za++):(e=a,0===no&&oo(Nt)),e===a&&(59===t.charCodeAt(Za)?(e=La,Za++):(e=a,0===no&&oo(Ya)),e===a&&(58===t.charCodeAt(Za)?(e=rt,Za++):(e=a,0===no&&oo(nt)),e===a&&(63===t.charCodeAt(Za)?(e=et,Za++):(e=a,0===no&&oo(tt)),e===a&&(46===t.charCodeAt(Za)?(e=pn,Za++):(e=a,0===no&&oo(Pn)),e===a&&(43===t.charCodeAt(Za)?(e=kt,Za++):(e=a,0===no&&oo(Dt)),e===a&&(45===t.charCodeAt(Za)?(e=Ft,Za++):(e=a,0===no&&oo(Gt)),e===a&&(42===t.charCodeAt(Za)?(e=jt,Za++):(e=a,0===no&&oo(zt)),e===a&&(47===t.charCodeAt(Za)?(e=Qt,Za++):(e=a,0===no&&oo(Vt)),e===a&&(37===t.charCodeAt(Za)?(e=qt,Za++):(e=a,0===no&&oo(Wt)),e===a&&(94===t.charCodeAt(Za)?(e=vr,Za++):(e=a,0===no&&oo(mr)),e===a&&(38===t.charCodeAt(Za)?(e=Sr,Za++):(e=a,0===no&&oo(Ar)),e===a&&(124===t.charCodeAt(Za)?(e=Or,Za++):(e=a,0===no&&oo(Nr)),e===a&&(126===t.charCodeAt(Za)?(e=Kt,Za++):(e=a,0===no&&oo(Bt)),e===a&&(33===t.charCodeAt(Za)?(e=Xt,Za++):(e=a,0===no&&oo(Ht)),e===a&&(61===t.charCodeAt(Za)?(e=Jt,Za++):(e=a,0===no&&oo(Zt)),e===a&&(60===t.charCodeAt(Za)?(e=cr,Za++):(e=a,0===no&&oo(Er)),e===a&&(62===t.charCodeAt(Za)?(e=ur,Za++):(e=a,0===no&&oo(dr)),e===a&&(44===t.charCodeAt(Za)?(e=Je,Za++):(e=a,0===no&&oo(Ze))))))))))))))))))))))))))))))))))))))))))))),no--,e===a&&0===no&&oo(ta),e}function Q_(){var e,t;for(e=[],(t=W_())===a&&(t=F_())===a&&(t=ri())===a&&(t=ni());t!==a;)e.push(t),(t=W_())===a&&(t=F_())===a&&(t=ri())===a&&(t=ni());return e}function V_(){var e,t;if(e=[],(t=W_())===a&&(t=F_())===a&&(t=ri())===a&&(t=ni()),t!==a)for(;t!==a;)e.push(t),(t=W_())===a&&(t=F_())===a&&(t=ri())===a&&(t=ni());else e=a;return e}function q_(){var e,t;for(e=[],(t=W_())===a&&(t=F_())===a&&(t=Z_())===a&&(t=ei());t!==a;)e.push(t),(t=W_())===a&&(t=F_())===a&&(t=Z_())===a&&(t=ei());return e}function W_(){var e;return no++,xa.test(t.charAt(Za))?(e=t.charAt(Za),Za++):(e=a,0===no&&oo(Ca)),no--,e===a&&0===no&&oo(Ma),e}function J_(){var e;return wa.test(t.charAt(Za))?(e=t.charAt(Za),Za++):(e=a,0===no&&oo(Ua)),e}function Z_(){var e;return no++,10===t.charCodeAt(Za)?(e=Da,Za++):(e=a,0===no&&oo(Fa)),e===a&&(t.substr(Za,2)===Ga?(e=Ga,Za+=2):(e=a,0===no&&oo(Ka)),e===a&&(13===t.charCodeAt(Za)?(e=Ba,Za++):(e=a,0===no&&oo(Xa)))),no--,e===a&&0===no&&oo(ka),e}function $_(){var e;return(e=Z_())===a&&(e=oi()),e}function ei(){var e;return no++,(e=ti())===a&&(e=ni()),no--,e===a&&0===no&&oo(Ha),e}function ti(){var e,r,n,o,_,i;if(e=Za,t.substr(Za,2)===ja?(r=ja,Za+=2):(r=a,0===no&&oo(za)),r!==a){for(n=[],o=Za,_=Za,no++,t.substr(Za,2)===Qa?(i=Qa,Za+=2):(i=a,0===no&&oo(Va)),no--,i===a?_=void 0:(Za=_,_=a),_!==a&&(i=ai())!==a?o=_=[_,i]:(Za=o,o=a);o!==a;)n.push(o),o=Za,_=Za,no++,t.substr(Za,2)===Qa?(i=Qa,Za+=2):(i=a,0===no&&oo(Va)),no--,i===a?_=void 0:(Za=_,_=a),_!==a&&(i=ai())!==a?o=_=[_,i]:(Za=o,o=a);n!==a?(t.substr(Za,2)===Qa?(o=Qa,Za+=2):(o=a,0===no&&oo(Va)),o!==a?e=r=[r,n,o]:(Za=e,e=a)):(Za=e,e=a)}else Za=e,e=a;return e}function ri(){var e,r,n,o,_,i;if(e=Za,t.substr(Za,2)===ja?(r=ja,Za+=2):(r=a,0===no&&oo(za)),r!==a){for(n=[],o=Za,_=Za,no++,t.substr(Za,2)===Qa?(i=Qa,Za+=2):(i=a,0===no&&oo(Va)),i===a&&(i=J_()),no--,i===a?_=void 0:(Za=_,_=a),_!==a&&(i=ai())!==a?o=_=[_,i]:(Za=o,o=a);o!==a;)n.push(o),o=Za,_=Za,no++,t.substr(Za,2)===Qa?(i=Qa,Za+=2):(i=a,0===no&&oo(Va)),i===a&&(i=J_()),no--,i===a?_=void 0:(Za=_,_=a),_!==a&&(i=ai())!==a?o=_=[_,i]:(Za=o,o=a);n!==a?(t.substr(Za,2)===Qa?(o=Qa,Za+=2):(o=a,0===no&&oo(Va)),o!==a?e=r=[r,n,o]:(Za=e,e=a)):(Za=e,e=a)}else Za=e,e=a;return e}function ni(){var e,r,n,o,_,i;if(e=Za,t.substr(Za,2)===qa?(r=qa,Za+=2):(r=a,0===no&&oo(Wa)),r!==a){for(n=[],o=Za,_=Za,no++,i=J_(),no--,i===a?_=void 0:(Za=_,_=a),_!==a&&(i=ai())!==a?o=_=[_,i]:(Za=o,o=a);o!==a;)n.push(o),o=Za,_=Za,no++,i=J_(),no--,i===a?_=void 0:(Za=_,_=a),_!==a&&(i=ai())!==a?o=_=[_,i]:(Za=o,o=a);n!==a?e=r=[r,n]:(Za=e,e=a)}else Za=e,e=a;return e}function ai(){var e;return t.length>Za?(e=t.charAt(Za),Za++):(e=a,0===no&&oo(Ja)),e}function oi(){var e,r;return e=Za,no++,t.length>Za?(r=t.charAt(Za),Za++):(r=a,0===no&&oo(Ja)),no--,r===a?e=void 0:(Za=e,e=a),e}if(e_=function(){var e,t,r;return no++,e=Za,t=Za,no++,r=m_(),no--,r===a?t=void 0:(Za=t,t=a),t!==a&&(r=S_())!==a?e=t=Mt(r):(Za=e,e=a),no--,e===a&&(t=a,0===no&&oo(Yt)),e},(r=_())!==a&&Za===t.length)return r;throw r!==a&&Za<t.length&&oo({type:"end",description:"end of input"}),_o(null,ro,to)}}}(),qI=nA("__shaders",(function(e,t){var r=gN(e),n=(QI(e),dR(e)),a=mN(e),o=n.defaults,_=n.context_limits,i=n.paths,s={},l={},c={};t.VALID=0,t.INVALID_TEX_IMAGE_UNITS=1,t.INVALID_F_UNIFORM_VECTORS=2,t.INVALID_V_UNIFORM_VECTORS=4,t.INVALID_VERTEX_ATTRIBS=8,t.INVALID_VARYING_VECTORS=16,t.COMPILATION_ERROR=32;var E=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,u=/(?:^|[^a-zA-Z_])(uniform)(?=\s)\s*(float|vec2|vec3|vec4|ivec2|ivec3|ivec4|bvec2|bvec3|bvec4|mat2|mat3|mat4|sampler2D|samplerCube)\s*(.*?\[\s*([0-9]*)\s*\])?/,d=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,T=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,f=/(?:\W|^)discard(\W|$)/,p=new Int16Array(2),P=null,S=null,A=null,h=0,v=0,m=[],g=null,O=!1;function N(e){var t={vert:"",frag:"",directives:[],node_elements:[],status:0,attribute_count:0,texture_count:0};return t.vert=e.vert,t.frag=e.frag,t.directives=lO(e.directives),t.node_elements=lO(e.node_elements),t.status=e.status,t.attribute_count=e.attribute_count,t.texture_count=e.texture_count,t}function R(e,t,r){var n=e.directives;if("string"==typeof r){var a=I(e,r);a&&(r=a[1])}else r=String(r);for(var o=0;o<n.length;o++)if(n[o][0]==t)return void(n[o][1]=r)}function I(e,t){for(var r=e.directives,n=0;n<r.length;n++)if(r[n][0]==t)return r[n];return!1}function b(e,t,r){o.gl_debug&&(r=y(r),a.error("shader compilation failed:\n"+r+"\n"+g.getShaderInfoLog(e)+" ("+t+")"))}function y(e){for(var t=e.split("\n"),r=0;r<t.length;r++)t[r]=r+1+" "+t[r];return t.join("\n")}function L(e,t){return e+t}function Y(e,t){var r=k(e.type),n=k(t.type),a=e.array_size,o=t.array_size;return r>n?-1:r<n?1:a>o?-1:a<o?1:0}function M(e,t,r){for(var n=e.split(";"),a=[],o=0;o<n.length;o++){var _=n[o].match(u);_&&a.push({type:_[2],array_size:_[4]?parseInt(_[4],10):1})}return x(a,t,r)}function x(e,t,r){if(!e.length)return!0;for(var n=0;n<r;n++)t[n]=0;v=r,e.sort(Y);var a=0,o=0,_=0;return function(){for(;_<e.length;){var r=e[_];if(4!=k(r.type))break;o+=U(r.type)*r.array_size,_++}return!(o>v||(h=o,w(t,0,o,0,4),0))}()&&function(){for(var r=0;_<e.length;){var n=e[_];if(3!=k(n.type))break;r+=U(n.type)*n.array_size,_++}return!((a=o+r)>v||(w(t,o,r,0,3),0))}()&&function(){for(var r=v-a,n=r,o=r;_<e.length;){var i=e[_];if(2!=k(i.type))break;var s=U(i.type)*i.array_size;if(s<=n)n-=s;else{if(!(s<=o))return!1;o-=s}_++}var l=r-o;return w(t,a,r-n,0,2),w(t,v-l,l,2,2),!0}()&&function(){for(;_<e.length;){for(var n=e[_],a=U(n.type)*n.array_size,o=-1,i=r+1,s=-1,l=0;l<4;l++){var c=p;c[0]=0,c[1]=1,C(t,l,a,c)&&c[1]<i&&(s=c[0],i=c[1],o=l)}if(o<0)return!1;w(t,s,a,o,1),_++}return!0}()}function C(e,t,r,n){for(;h<e.length&&15===e[h];)h++;for(;v>0&&15===e[v];)v--;if(v-h<r)return!1;for(var a=1<<t,o=0,_=-1,i=e.length+1,s=!1,l=h;l<=v;l++)if(l<v&&!(e[l]&a))s||(o=l,s=!0);else{if(s){var c=l-o;c>=r&&c<i&&(i=c,_=o)}s=!1}return!(_<0||(n[0]=_,n[1]=i,0))}function w(e,t,r,n,a){for(var o=0,_=0;_<a;_++)o|=1<<n+_;for(_=0;_<r;_++)e[t+_]|=o}function U(e){var t=0;switch(e){case"mat4":t=4;break;case"mat3":t=3;break;case"mat2":t=2;break;default:t=1}return t}function k(e){var t=0;switch(e){case"mat4":case"vec4":case"ivec4":case"bvec4":case"mat2":t=4;break;case"mat3":case"vec3":case"ivec3":case"bvec3":t=3;break;case"vec2":case"ivec2":case"bvec2":t=2;break;default:t=1}return t}function D(e,t){var r=e+t;if(l[r])return l[r];var n=tA.require("shader_texts")[t];return n?(l[r]=n,n):null}function F(e){var t={};function r(e,t,n){e instanceof Array?function(e,t,n){for(var a=0;a<e.length;a++)r(e[a],t,n)}(e,t,n):e instanceof Object&&e&&function(e,t,n){for(var a in t&&t(e),e)r(e[a],t,n);n&&n(e)}(e,t,n)}return r(e,(function e(n){"var"==n.TYPE?t[n.NAME]=n.TOKENS.join(""):"include"==n.TYPE&&r(D(i.shaders_path,i.shaders_include_dir+n.FILE),e)})),t}function G(e,t,n){var _=n.node_elements,s=[],l=function(e,t){for(var r={},n=t.directives||[],_=0;_<n.length;_++)r[n[_][0]]=[n[_][1]];for(_=0;_<t.node_elements.length;_++)r["USE_NODE_"+t.node_elements[_].id]=["1"];for(var i in o.webgl2?(r.GLSL1=["0"],r.GLSL3=["1"],r.GLSL_VERSION=["300 es"],r.GLSL_IN=["in"],r.GLSL_OUT=["out"],r.GLSL_OUT_FRAG_COLOR=["glsl_out_frag_color"],r.GLSL_TEXTURE=["texture"],r.GLSL_TEXTURE_CUBE=["texture"],r.GLSL_TEXTURE_PROJ=["textureProj"],r.GLSL_TEXTURE_LOD=["textureLod"],r.GLSL_TEXTURE_CUBE_LOD=["textureLod"]):(r.GLSL1=["1"],r.GLSL3=["0"],r.GLSL_VERSION=["100"],r.GLSL_IN="vert"==e?["attribute"]:["varying"],r.GLSL_OUT="vert"==e?["varying"]:[""],r.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],r.GLSL_TEXTURE=["texture2D"],r.GLSL_TEXTURE_CUBE=["textureCube"],r.GLSL_TEXTURE_PROJ=["texture2DProj"],r.GLSL_TEXTURE_LOD=["textureLod"],o.texture_lod_available?(r.GLSL_TEXTURE_LOD=["texture2DLodEXT"],r.GLSL_TEXTURE_CUBE_LOD=["textureCubeLodEXT"]):(r.GLSL_TEXTURE_LOD=["texture2D"],r.GLSL_TEXTURE_CUBE_LOD=["textureCube"])),r.GLSL_SMPLR2D_SHDW=o.compared_mode_depth&&!o.rgba_fallback_shadows?["sampler2DShadow"]:["sampler2D"],r)r[i][0].constructor!=String&&a.warn("Warning! The value of a directive '"+i+"' is not of type string.");return r}(e,n),c={},E=[n[e]],u={},d={},T=[];for(var f in _)for(var p in _[f].inputs)T.push(_[f].inputs[p]);var P=!1;m(t);var S=s.join("\n"),A=0,h=0,v=0;return S;function m(e){for(var t=e.PARTS,n=0;n<t.length;n++){var a=t[n];switch(a.TYPE){case"cond":g(a);break;case"include":N(a);break;case"var":break;case"define":R(a);break;case"error":I(a);break;case"line":break;case"pragma":b(a);break;case"undef":y(a);break;case"warning":L(a);break;case"extension":Y(a);break;case"version":M(a);case"#":break;case"node":x(a);break;case"nodes_global":w(_);break;case"nodes_main":k(_);break;case"txt":X(a.TOKENS);break;default:r.panic("Unknown element type: "+a.TYPE)}}}function g(e){for(var t=e.PARTS,r=0;r<t.length;r++){var n=t[r];switch(n.TYPE){case"if":case"elif":if(O(n.EXPRESSION))return void m(n.GROUP);break;case"else":return void m(n.GROUP);case"ifdef":n.NAME in l&&m(n.GROUP);break;case"ifndef":n.NAME in l||m(n.GROUP)}}}function O(e,t){return function(e){for(var t=[],n=0;n<e.length;n++){var o;if(e[n]instanceof Object)switch(e[n].TYPE){case"conditional_expr":var _=t.pop(),i=t.pop(),s=t.pop();t.push(s?i:_);break;case"logical_or_expr":for(var l=t.pop(),c=0;c<e[n].PLACES-1;c++)o=t.pop(),l=l||o;t.push(l);break;case"logical_and_expr":for(l=t.pop(),c=0;c<e[n].PLACES-1;c++)o=t.pop(),l=l&&o;t.push(l);break;case"logical_bitor_expr":for(l=t.pop(),c=0;c<e[n].PLACES-1;c++)l|=t.pop();t.push(l);break;case"logical_bitxor_expr":for(l=t.pop(),c=0;c<e[n].PLACES-1;c++)l^=t.pop();t.push(l);break;case"logical_bitand_expr":for(l=t.pop(),c=0;c<e[n].PLACES-1;c++)l&=t.pop();t.push(l);break;case"equal_expr":var d=t.pop(),T=t.pop();t.push(T==d);break;case"non_equal_expr":d=t.pop(),T=t.pop(),t.push(T!=d);break;case"le_expr":d=t.pop(),T=t.pop(),t.push(T<=d);break;case"ge_expr":d=t.pop(),T=t.pop(),t.push(T>=d);break;case"l_expr":d=t.pop(),T=t.pop(),t.push(T<d);break;case"g_expr":d=t.pop(),T=t.pop(),t.push(T>d);break;case"left_shift_expr":T=t.pop(),d=t.pop(),t.push(T<<d);break;case"right_shift_expr":T=t.pop(),d=t.pop(),t.push(T>>d);break;case"add_expr":T=t.pop(),d=t.pop(),t.push(T+d);break;case"sub_expr":T=t.pop(),d=t.pop(),t.push(T-d);break;case"mul_expr":T=t.pop(),d=t.pop(),t.push(T*d);break;case"div_expr":T=t.pop(),d=t.pop(),t.push(T/d);break;case"mod_expr":T=t.pop(),d=t.pop(),t.push(T%d);break;case"pre_inc_expr":case"post_inc_expr":o=t.pop(),t.push(++o);break;case"pre_dec_expr":case"post_dec_expr":o=t.pop(),t.push(--o);break;case"positive_expr":o=t.pop(),t.push(+o);break;case"negative_expr":o=t.pop(),t.push(-o);break;case"one_compl_expr":o=t.pop(),t.push(~o);break;case"logic_negative_expr":o=t.pop(),t.push(!o);break;default:r.panic("Unknown operation type: "+e[n].TYPE)}else if(/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(o=e[n])){if(t.push(0),0!=o.indexOf("USE_NODE_")){var f=E[E.length-1];f in u||(u[f]=[]),-1==u[f].indexOf(o)&&(u[f].push(o),a.error("Undefined directive '"+o+"' in shader '"+f+"'. Should it be defined with #var/#node_var or #define?"))}}else t.push(parseFloat(e[n]))}if(1==t.length)return t[0];r.panic("Incorrect expression: "+e.join(" "))}(H(e,l,c,!0,t))}function N(e){var t=e.FILE,r=D(i.shaders_path,i.shaders_include_dir+t);E.push("include/"+t),m(r),E.pop()}function R(e){l[e.NAME]=e.TOKENS}function I(e){r.panic("Shader error: #error "+e.TOKENS.join(" "))}function b(e){s.push("#pragma "+e.NAME+" "+e.TOKENS.join(" "))}function y(e){delete l[e.NAME]}function L(e){a.warn("Shader warning: #warning "+e.TOKENS.join(" "))}function Y(e){var t=H(e.TOKENS,l,c,!1);s.push("#extension "+t.join(" "))}function M(e){var t=H(e.TOKENS,l,c,!1);s.push("#version "+t.join(" "))}function x(e){d[e.NAME]=e}function C(e,t,r){if("PARTICLE_INFO"==e.id&&t.IS_OPTIONAL){if(1==l.PARTICLE_BATCH){var n=!1;switch(r){case 0:n=z(e.dirs,"PART_INFO_IND")||z(e.dirs,"PART_INFO_AGE")||z(e.dirs,"PART_INFO_LT")||z(e.dirs,"PART_INFO_SIZE");break;case 1:n=z(e.dirs,"PART_INFO_LOC");break;case 2:n=z(e.dirs,"PART_INFO_VEL");break;case 3:n=z(e.dirs,"PART_INFO_A_VEL");break;case 4:n=z(e.dirs,"PART_INFO_IND")}return n}return!1}return!0}function w(t){for(var r=0;r<t.length;r++){var n=t[r],a=d[n.id];if(a)for(var o=0,_=0;_<a.DECLARATIONS.length;_++){var i=a.DECLARATIONS[_];if("node_param"==i.TYPE){if(C(n,i,o)){var s=i.QUALIFIER.join(" ")+" ";"vert"==e?s+=n.vparams[o]:"frag"==e&&(s+=n.params[o],null!==n.param_values[o]&&(s+="="+n.param_values[o])),X(B(s+=";"))}o++}}}}function U(e,t){for(var r=function(e){for(var t={},r=0;r<e.NODE_VARS.length;r++){var n=e.NODE_VARS[r];t[n.NAME]=[n.TOKENS.join("")]}return t}(e),n=0;n<t.dirs.length;n++){var a=t.dirs[n][0];a in r&&(r[a]=[t.dirs[n][1]])}var o=0;for(n=0;n<e.DECLARATIONS.length;n++){var _=e.DECLARATIONS[n];if("node_out"==_.TYPE){var i=T.indexOf(t.outputs[o])>-1|0;r["USE_OUT_"+_.NAME]=[i],o++}}return r}function k(e){for(var t=0;t<e.length;t++){var r=e[t],n=d[r.id];if(n){var a={};A=0,h=0,v=0;var o=U(n,r);F(r,n.DECLARATIONS,a,o),s.push("{"),G(r,n.STATEMENTS,a,o),s.push("}")}}}function F(t,r,n,a){for(var o=0;o<r.length;o++){var _=r[o];switch(_.TYPE){case"node_in":var i=t.inputs[A];if(null!==t.input_values[A]){if(("MATERIAL_BEGIN"==t.id&&3===A||!a.MATERIAL_EXT&&("MATERIAL_BEGIN"==t.id&&4===A||"MATERIAL_END"==t.id&&3===A||"MATERIAL_END"==t.id&&4===A||"MATERIAL_END"==t.id&&5===A)||"TEXTURE_COLOR"==t.id||"TEXTURE_NORMAL"==t.id)&&_.IS_OPTIONAL){n[_.NAME]=t.input_values[A],A++;continue}var s=_.QUALIFIER.join(" ")+" ";X(B(s+=i+"="+t.input_values[A]+";"))}n[_.NAME]=i,A++;break;case"node_out":i=t.outputs[h],(!_.IS_OPTIONAL||T.indexOf(i)>-1)&&(s=_.QUALIFIER.join(" ")+" ",X(B(s+=i+";")),n[_.NAME]=i),h++;break;case"node_param":"vert"==e?i=t.vparams[v]:"frag"==e&&(i=t.params[v]),n[_.NAME]=i,v++}}return n}function G(e,t,r,n){for(var a=0;a<t.length;a++){var o=t[a];switch(o.TYPE){case"node_cond":K(e,o.PARTS,r,n);break;case"txt":for(var _=[],i=0;i<o.TOKENS.length;i++){var s=o.TOKENS[i];_.push(s in r?r[s]:s)}X(_,n)}}}function K(e,t,r,n){for(var a=0;a<t.length;a++){var o=t[a];switch(o.TYPE){case"node_if":case"node_elif":if(O(o.EXPRESSION,n))return void G(e,o.STATEMENTS,r,n);break;case"node_else":return void G(e,o.STATEMENTS,r,n);case"node_ifdef":(o.NAME in l||o.NAME in n)&&G(e,o.STATEMENTS,r,n);break;case"node_ifndef":o.NAME in l||o.NAME in n||G(e,o.STATEMENTS,r,n)}}}function B(e){return e.match(/([\d]+\.[\d]+|[\w]+|[^\s])/g)}function X(t,r){if((t=function(e,t){if(!o.webgl2&&"frag"==t){var r=e.join(" ");P&&(r.match(/[^;]*;/)?(r=r.replace(/[^;]*;/,""),P=!1):r=""),(r=r.replace(/GLSL_OUT [^;]*;/g,"")).match(/GLSL_OUT(?:$| [^;]*)/)&&(r=r.replace(/GLSL_OUT(?:$| [^;]*)/,""),P=!0),e=(r=(r=r.replace(/ {2,}/g," ")).trim())?r.split(" "):[]}return e}(t,e)).length){var n=H(t,l,c,!1,r);s.push(n.join(" "))}}function H(e,t,r,n,a){var o=[];return function e(t,r,n,a,o,_){for(var i=0;i<t.length;i++){var s=t[i];if(_&&s in _)var l=_[s];else{if(!(s in r)){o.push(s);continue}l=r[s]}0==l.length&&a?o.push(0):e(l,r,n,a,o,_)}}(e,t,r,n,o,a),o}}function K(e){return Boolean(e.match(f))}function B(e,t,r,n,a){var o=e.createShader(n);return e.shaderSource(o,r),e.compileShader(o),o}function X(e){g.deleteProgram(e.program),g.deleteShader(e.vshader),g.deleteShader(e.fshader),delete s[e.shader_id]}function H(e,t){switch(!t&&e.length?t=e.length:t||(t=1),t){case 1:return j(e);case 2:return"vec2("+j(e[0])+","+j(e[1])+")";case 3:return"vec3("+j(e[0])+","+j(e[1])+","+j(e[2])+")";case 4:return"vec4("+j(e[0])+","+j(e[1])+","+j(e[2])+","+j(e[3])+")";case 9:return"mat3("+j(e[0])+","+j(e[1])+","+j(e[2])+","+j(e[3])+","+j(e[4])+","+j(e[5])+","+j(e[6])+","+j(e[7])+","+j(e[8])+")";case 16:return"mat4("+j(e[0])+","+j(e[1])+","+j(e[2])+","+j(e[3])+","+j(e[4])+","+j(e[5])+","+j(e[6])+","+j(e[7])+","+j(e[8])+","+j(e[9])+","+j(e[10])+","+j(e[11])+","+j(e[12])+","+j(e[13])+","+j(e[14])+","+j(e[15])+")";default:r.panic("Wrong glsl value dimension")}}function j(e){return e%1?String(e):String(e)+".0"}function z(e,t){for(var r=0;r<e.length;r++)if(e[r][0]==t)return!0;return!1}t.setup_context=function(e){g=e},t.init_shaders_info=function(){return{vert:"",frag:"",directives:[],node_elements:[],status:0,attribute_count:0,texture_count:0}},t.clone_shaders_info=N,t.set_directive=R,t.get_directive=I,t.set_default_directives=function(e){e.directives=lO(function(e,t){var r=e+t;if(!(r in c)){var n=D(i.shaders_path,e),a=D(i.shaders_path,t),o=F(n),_=F(a);for(var s in _)o[s]=_[s];var l=[];for(var s in o)l.push([s,o[s]]);c[r]=l}return c[r]}(e.vert,e.frag)),R(e,"PRECISION",n.defaults.precision),R(e,"EPSILON",H("highp"==n.defaults.precision?1e-6:1e-4)),R(e,"CONSTANTS_HACK",0|o.shader_constants_hack),R(e,"SRGB",o.srgb_type),R(e,"COMPARED_MODE",0|o.compared_mode_depth)},t.get_vname=function(e){return e.vert},t.get_fname=function(e){return e.frag},t.get_compiled_shader=function(e){var t=JSON.stringify(e.vert)+JSON.stringify(e.frag)+JSON.stringify(e.directives)+JSON.stringify(e.node_elements),r=s[t];if(r)return r;var n=e.frag,l=D(i.shaders_path,e.vert),c=D(i.shaders_path,n);if(!l||!c)return null;var u=G("vert",l,e),f=G("frag",c,e);if(function(e,t,r){var n,a=0,i=(n=E,(e.split(";").map((function(e){var t=e.match(n);return t&&(t[3]?parseInt(t[3],10):1)})).filter((function(e){return e}))||[]).reduce(L,0));r.texture_count=i,i>_.max_texture_image_units&&(a|=1),P||(P=new Uint32Array(_.max_varying_vectors)),S||(S=new Uint32Array(_.max_fragment_uniform_vectors)),A||(A=new Uint32Array(_.max_vertex_uniform_vectors)),M(e,S,_.max_fragment_uniform_vectors)||(a|=2),M(t,A,_.max_vertex_uniform_vectors)||(a|=4);var s=function(e){return o.webgl2?(e.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(e.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length}(t);r.attribute_count=s,s>_.max_vertex_attribs&&(a|=8),function(e){if(o.webgl2){e=e.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var t=d}else t=T;return x(e.split(";").map((function(e){var r=e.match(t);return r&&{type:r[2],array_size:r[4]?parseInt(r[4],10):1}})).filter((function(e){return e})),P,_.max_varying_vectors)}(e)||(a|=16),r.status=a}(f,u,e),0===e.status){s[t]=r=function(e,t,r,n,a){var o=B(e,0,t,e.VERTEX_SHADER),_=B(e,0,r,e.FRAGMENT_SHADER),i=e.createProgram();e.attachShader(i,o),e.attachShader(i,_),e.linkProgram(i);for(var s={vshader:o,fshader:_,program:i,attributes:{},uniforms:{},permanent_uniform_setters:EN(),permanent_sc_uniform_setters:EN(),permanent_uniform_setters_table:{},need_uniforms_update:!0,no_permanent_uniforms:!1,transient_uniform_setters:EN(),transient_sc_uniform_setters:EN(),shaders_info:N(a),shader_id:n,has_discard:K(r),cleanup_gl_data_on_unload:!0},l=e.getProgramParameter(i,e.ACTIVE_ATTRIBUTES),c=0;c<l;c++){var E=e.getActiveAttrib(i,c).name,u=e.getAttribLocation(i,E);s.attributes[E]=u}var d=e.getProgramParameter(i,e.ACTIVE_UNIFORMS);for(c=0;c<d;c++){var T=e.getActiveUniform(i,c).name.split("[0]").join(""),f=e.getUniformLocation(i,T);s.uniforms[T]=f}return s}(g,u,f,t,e);var p=!g.getShaderParameter(r.fshader,g.COMPILE_STATUS),h=!g.getShaderParameter(r.vshader,g.COMPILE_STATUS),v=!g.getProgramParameter(r.program,g.LINK_STATUS);p?b(r.fshader,t,f):h?b(r.vshader,t,u):v&&function(e,t,r,n){o.gl_debug&&(r=y(r),n=y(n),a.error("shader linking failed:\n"+r+"\n\n\n"+n+"\n"+g.getProgramInfoLog(e)+" ("+t+")"))}(r.program,t,u,f),(p||h||v)&&(e.status|=32,r=null)}else r=null;return r},t.load_shaders=function(){O=!0},t.check_shaders_loaded=function(){return O},t.debug_get_compilation_stats=function(){return m},t.get_compiled_shaders=function(){return s},t.cleanup=function(){for(var e in s)X(s[e]);for(var t in l)delete l[t];for(var r in m)delete m[r];P=null,S=null,A=null,c={}},t.cleanup_shader=X,t.debug_shaders_info=function(e){var t=e.directives;a.log("Shader: "+e.vert+" "+e.frag+", "+String(t.length)+" directives: ");for(var r=0;r<t.length;r++)a.log("  "+t[r][0],t[r][1])},t.glsl_value=H,t.check_uniform=function(e,t){return t in e.uniforms},t.reset=function(){g=null}})),WI=nA("__nodemat",(function(e,t){var r=gN(e),n=dR(e),a=PR(e),o=pR(e),_=mN(e),i=qI(e),s=XI(e),l={},c={},E={},u={},d=0,T=n.defaults;function f(e,t,r,n,a,_){if(t in c)return c[t];var l={graph:null,id:t,cleanup_on_unload:!0};if(r||(u={},d=0),"SHADOW"!=n&&"COLOR_ID"!=n){for(var E=o.create(),T=e.nodes,P=0;P<T.length;P++)if(null==x(E,T[P],0,n,a,_))return c[t]=null,l;if(r&&-1==L(e,E,"GROUP_OUTPUT","group"))return l;var A=function(e){var t=[];return o.traverse(e,(function(e,r){"GROUP"==r.type&&t.push(r)})),t}(E),v=r?e.links:e.links.slice();if(!function(e,t,r){for(var n=0;n<r.length;n++){var a=r[n].data.node_group_graph,_=r[n].data.node_group_links;if(!a)return!1;o.traverse(a,(function(t,r){o.append_node(e,o.gen_node_id(e),r)}));for(var i=0;i<_.length;i++)t.push(_[i]);ae(r[n],t,e)}return!0}(E,v,A))return l;if(r)return l.graph=E,l;for(P=0;P<v.length;P++)for(var g=v[P],M=O(g.from_node,E),C=O(g.to_node,E),w=0;w<M.length;w++)for(var U=0;U<C.length;U++){var k=M[w],D=C[U];if(!q(E,k,D,o.get_node_attr(E,k),o.get_node_attr(E,D),g))return c[t]=null,l}!function(e){var t=[];o.traverse(e,(function(r,n){switch(n.type){case"B4W_TRANSLUCENCY":o.traverse_edges(e,(function(a,_,i){var s=o.get_node_attr(e,_);a==r&&"MATERIAL_EXT"==s.type&&"Translucency"==n.outputs[i[0]].name&&t.push(a,_,[i[0]+1,i[1]+1])}))}}));for(var r=0;r<t.length;r+=3)o.append_edge(e,t[r],t[r+1],t[r+2])}(E);var F=!1,G=-1;"GLOW"==n?G=L(e,E,"B4W_GLOW_OUTPUT","material",!0):(-1==(G=L(e,E,"OUTPUT","material",!1,!0))&&(G=L(e,E,"OUTPUT_MATERIAL","material",!1,!0)),-1==G&&(G=L(e,E,"OUTPUT_WORLD","material",!1,!0),F=!0)),-1==G&&(E=function(){var e=o.create(),t={default_value:new Float32Array([0,0,0]),identifier:"Color",is_linked:!1,name:"Color"};return o.append_node(e,0,{data:null,dirs:[],params:[],inputs:[t,{default_value:1,identifier:"Alpha",is_linked:!1,name:"Alpha"}],outputs:[],type:"OUTPUT",vparams:[]}),e}(),G=0),function(e){var t=[];o.traverse(e,(function(e,r){"B4W_PARALLAX"!=r.type&&"REROUTE"!=r.type||t.push(e,r)}));for(var r=0;r<t.length;r+=2){var n=t[r],a=t[r+1];if("B4W_PARALLAX"==a.type)N(e,n,a);else if("REROUTE"==a.type){for(var _=o.get_in_edge(e,n,0),i=o.out_edge_count(e,n),s=[],l=[],c=[],E=0;E<i;E++){var u=o.get_out_edge(e,n,E),d=l.indexOf(u),T=o.get_edge_attr(e,n,u,d>=0?c[d]:0);if(T){var f=T[1],p=a.inputs[0].default_value,P=o.get_node_attr(e,u).inputs[f];switch(typeof p){case"number":if("object"==typeof P.default_value)for(var S=P.default_value,A=0;A<S.length;A++)S[A]=p;else"number"==typeof P.default_value&&(P.default_value=p);break;case"object":if("object"==typeof P.default_value)for(S=P.default_value,A=0;A<S.length;A++)S[A]=p[A];else"number"==typeof P.default_value&&(P.default_value=.35*p[0]+.45*p[1]+.2*p[2])}}var h=a.outputs;for(A=0;A<h.length;A++)h[A].default_value=a.inputs[0].default_value;-1!=d?c[d]+=1:(l.push(u),c.push(1),s.push(n,u))}if(-1!=_){var v=o.get_edge_attr(e,_,n,0)[0];for(E=0;E<l.length;E++)for(A=0;A<c[E];A++){var m=o.get_edge_attr(e,n,l[E],A)[1];o.append_edge(e,_,l[E],[v,m])}}for(E=0;E<s.length;E+=2)o.remove_edge(e,s[E],s[E+1],-1)}}}(E);var K=o.subgraph_node_conn(E,G,o.BACKWARD_DIR);F?(function(e,t){var r=[];o.traverse(e,(function(e,t){"OUTPUT_WORLD"==t.type&&r.push({node_id:e,node:t})}));for(var n=0;n<r.length;++n){var a=r[n].node_id,_=r[n].node,i=o.gen_node_id(e);o.append_node(e,i,_.data.output_world_surface);for(var s=o.in_edge_count(e,a),l=[],c=[],E={},u=0;u<s;u++){var d=o.get_in_edge(e,a,u);d in E||(E[d]=0);var T=o.get_edge_attr(e,d,a,E[d]++);switch(l.push([d,a,T]),T[1]){case 0:c.push([d,i,T])}}for(u=0;u<l.length;u++)o.remove_edge_by_attr(e,l[u][0],l[u][1],l[u][2]);for(u=0;u<c.length;u++)o.append_edge(e,c[u][0],c[u][1],c[u][2]);o.remove_node(e,a)}}(K),function(e,t){var r=[];if(o.traverse(e,(function(e,t){"MIX_SHADER"!=t.type&&"ADD_SHADER"!=t.type||r.push({node_id:e,node:t})})),r.length)for(var n={name:"RGB_WORLD_NODE",type:"RGB_WORLD_NODE",factor:.5},a=0;a<r.length;a++){var _=r[a].node_id,i=r[a].node;switch(n.name=i.name,n.fac=i.inputs[0].default_value,n.fac_is_linked=i.inputs[0].is_linked,n.color1_is_linked=i.inputs[1].is_linked,n.color2_is_linked=i.inputs[2].is_linked,i.type){case"ADD_SHADER":n.type="ADD_WORLD_RGB";break;case"MIX_SHADER":n.type="MIX_WORLD_RGB"}for(var s=x(e,n,0,t,null,[]),l=o.in_edge_count(e,_),c=[],E=[],u={},d=0;d<l;d++){var T=o.get_in_edge(e,_,d);T in u||(u[T]=0);var f=o.get_edge_attr(e,T,_,u[T]++);c.push([T,_,f]),E.push([T,s,f])}for(d=0;d<c.length;d++)o.remove_edge_by_attr(e,c[d][0],c[d][1],c[d][2]);for(d=0;d<E.length;d++)o.append_edge(e,E[d][0],E[d][1],E[d][2]);var p=o.out_edge_count(e,_),P=[],S=[],A={};for(d=0;d<p;d++){var h=o.get_out_edge(e,_,d);h in A||(A[h]=0),f=o.get_edge_attr(e,_,h,A[h]++),P.push([_,h,f]),S.push([s,h,f])}for(d=0;d<P.length;d++)o.remove_edge_by_attr(e,P[d][0],P[d][1],P[d][2]);for(d=0;d<S.length;d++)o.append_edge(e,S[d][0],S[d][1],S[d][2]);o.remove_node(e,_)}}(K,n),function(e){var t=-1,r=[],n=[],a=["OUTPUT_WORLD_SURFACE","BACKGROUND","RGB","VALUE","ADD_WORLD_RGB","MIX_WORLD_RGB","TEXTURE_ENVIRONMENT_EQUIRECTANGULAR","TEXTURE_ENVIRONMENT_MIRROR_BALL","GEOMETRY_NO","GEOMETRY_TRN","GEOMETRY_GL","GEOMETRY_IN","TEXTURE_COLOR","TEX_COORD_GE","TEX_COORD_OB","TEX_COORD_NO","COMBRGB","COMBHSV","CURVE_RGB","CURVE_VEC","B4W_LINEAR_TO_SRGB","B4W_NORMAL_VIEW","B4W_VECTOR_VIEW","B4W_SRGB_TO_LINEAR","B4W_REFLECT","B4W_CLAMP","B4W_TIME","B4W_SMOOTHSTEP","NORMAL","MAPPING","MATH_ADD","MATH_SUBTRACT","MATH_MULTIPLY","MATH_DIVIDE","MATH_SINE","MATH_COSINE","MATH_TANGENT","MATH_ARCSINE","MATH_ARCCOSINE","MATH_ARCTANGENT","MATH_POWER","MATH_LOGARITHM","MATH_MINIMUM","MATH_MAXIMUM","MATH_ROUND","MATH_LESS_THAN","MATH_GREATER_THAN","MATH_MODULO","MATH_ABSOLUTE","MIX_RGB_MIX","MIX_RGB_ADD","MIX_RGB_MULTIPLY","MIX_RGB_SUBTRACT","MIX_RGB_SCREEN","MIX_RGB_DIVIDE","MIX_RGB_DIFFERENCE","MIX_RGB_DARKEN","MIX_RGB_LIGHTEN","MIX_RGB_OVERLAY","MIX_RGB_DODGE","MIX_RGB_BURN","MIX_RGB_HUE","MIX_RGB_SATURATION","MIX_RGB_VALUE","MIX_RGB_COLOR","MIX_RGB_SOFT_LIGHT","MIX_RGB_LINEAR_LIGHT","SEPRGB","SEPHSV","VALTORGB","VECT_TRANSFORM","VECT_MATH_ADD","VECT_MATH_SUBTRACT","VECT_MATH_AVERAGE","VECT_MATH_DOT_PRODUCT","VECT_MATH_CROSS_PRODUCT","VECT_MATH_NORMALIZE"];o.traverse(e,(function(e,n){switch(a.indexOf(n.type)){case-1:r.push({node_id:e,node:n});break;case 0:t=e}}));for(var _=0;_<r.length;_++)for(var i=r[_].node_id,s=o.out_edge_count(e,i),l={},c=0;c<s;c++){var E=o.get_out_edge(e,i,c);E in l||(l[E]=0);var u=o.get_edge_attr(e,i,E,l[E]++);n.push([i,E,u])}for(_=0;_<n.length;_++)o.remove_edge_by_attr(e,n[_][0],n[_][1],n[_][2]);if(n.length){var d=o.subgraph_node_conn(e,t,o.BACKWARD_DIR);e.nodes=d.nodes,e.edges=d.edges}}(K),function(e){var t=-1,r=[],n=[];o.traverse(e,(function(e,n){switch(n.type){case"ADD_WORLD_RGB":case"MIX_WORLD_RGB":r.push({node_id:e,node:n});break;case"OUTPUT_WORLD_SURFACE":t=e,r.push({node_id:e,node:n})}}));for(var a=0;a<r.length;a++)for(var _=r[a].node_id,i=r[a].node,s=o.in_edge_count(e,_),l={},c=0;c<s;c++){var E=o.get_in_edge(e,_,c),u=o.get_node_attr(e,E);E in l||(l[E]=0);var d=o.get_edge_attr(e,E,_,l[E]++);"OUTPUT_WORLD_SURFACE"!=i.type&&0==d[1]||"ADD_WORLD_RGB"==u.type||"MIX_WORLD_RGB"==u.type||"BACKGROUND"==u.type||n.push([E,_,d])}for(a=0;a<n.length;a++)o.remove_edge_by_attr(e,n[a][0],n[a][1],n[a][2]);if(n.length){var T=o.subgraph_node_conn(e,t,o.BACKWARD_DIR);e.nodes=T.nodes,e.edges=T.edges}}(K)):(function(e,t,r){var n=[];o.traverse(e,(function(e,t){"MATERIAL"!=t.type&&"MATERIAL_EXT"!=t.type||n.push({node_id:e,node:t})}));for(var a=0;a<n.length;++a){var _=n[a].node_id,i=n[a].node,s=o.gen_node_id(e);o.append_node(e,s,i.data.material_begin);var l=o.gen_node_id(e);o.append_node(e,l,i.data.material_end),o.append_edge(e,s,l,[4,2]);for(var c={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},E=o.in_edge_count(e,_),u=[],d=[],T=[],f={},P=0;P<E;P++){var S=o.get_in_edge(e,_,P);S in f||(f[S]=0);var A=o.get_edge_attr(e,S,_,f[S]++);u.push([S,_,A]);var h=c[A[1]];if(h)switch(h[0]){case"MATERIAL_END":d.push([S,l,[A[0],h[1]]]);break;case"LIGHTING_APPLY":T.push([S,[A[0],h[1]]])}else d.push([S,s,A])}for(p(e,i.data.value,s,l,T,r),P=0;P<u.length;P++)o.remove_edge_by_attr(e,u[P][0],u[P][1],u[P][2]);for(P=0;P<d.length;P++)o.append_edge(e,d[P][0],d[P][1],d[P][2]);var v=o.out_edge_count(e,_),m=[],g=[],O={};for(P=0;P<v;P++){var N=o.get_out_edge(e,_,P);N in O||(O[N]=0),A=o.get_edge_attr(e,_,N,O[N]++),m.push([_,N,A]),g.push([l,N,A])}for(P=0;P<m.length;P++)o.remove_edge_by_attr(e,m[P][0],m[P][1],m[P][2]);for(P=0;P<g.length;P++)o.append_edge(e,g[P][0],g[P][1],g[P][2]);o.remove_node(e,_)}}(K,0,_),function(e,t,r){var n=[];o.traverse(e,(function(e,t){"OUTPUT_MATERIAL"==t.type&&n.push({node_id:e,node:t})}));for(var a=0;a<n.length;++a){var _=n[a].node_id,i=n[a].node,s=!1,l=!1,c=o.gen_node_id(e);o.append_node(e,c,i.data.output_surface);for(var E=o.in_edge_count(e,_),u=[],d=[],T={},f=0;f<E;f++){var p=o.get_in_edge(e,_,f);p in T||(T[p]=0);var P=o.get_edge_attr(e,p,_,T[p]++);switch(u.push([p,_,P]),P[1]){case 0:s=!0,d.push([p,c,P]);break;case 2:l=!0;var A=o.gen_node_id(e);o.append_node(e,A,i.data.displacement_bump),d.push([p,A,[P[0],0]])}}for(f=0;f<u.length;f++)o.remove_edge_by_attr(e,u[f][0],u[f][1],u[f][2]);for(f=0;f<d.length;f++)o.append_edge(e,d[f][0],d[f][1],d[f][2]);if(o.remove_node(e,_),s)l&&S(e,c,A),h(e,0,r);else{var v=o.get_node_attr(e,c);e.nodes=[0,v],e.edges=[]}}}(K,0,_)),m(K),function(e){(function(e){var t=[];o.traverse(e,(function(e,r){"GEOMETRY_VC"!=r.type&&"GEOMETRY_NO"!=r.type&&"GEOMETRY_FB"!=r.type&&"GEOMETRY_VW"!=r.type&&"GEOMETRY_GL"!=r.type&&"GEOMETRY_LO"!=r.type&&"GEOMETRY_OR"!=r.type&&"GEOMETRY_BF"!=r.type&&"GEOMETRY_IN"!=r.type||t.push(e,r)}));for(var r=[],n=0;n<t.length;n+=2){for(var a=t[n],_=t[n+1],i=!0,s=0;s<r.length;s++){var l;if(b(_,(l=r[s]).attr)){for(var c=[],E=o.out_edge_count(e,a),u=0;u<E;u++){var d=o.get_out_edge(e,a,u),T=o.get_edge_attr(e,a,d,0);c.push(a,d,T),o.append_edge(e,l.id,d,T)}for(u=0;u<c.length;u+=3)o.remove_edge(e,c[u],c[u+1],0);o.remove_node(e,a),i=!1;break}}i&&r.push(l={id:a,attr:_})}})(e),function(e){var t=[];if(o.traverse(e,(function(e,r){"TEXTURE_COLOR"!=r.type&&"TEXTURE_NORMAL"!=r.type||t.push(e,r)})),t.length){for(var r=function(e){for(var t={},r=0;r<e.nodes.length;r+=2)t[n=e.nodes[r]]={ascs_ids:{},is_completed:!1};for(r=0;r<e.edges.length;r+=3)t[e.edges[r+1]].ascs_ids[e.edges[r]]=!0;for(var n in t)I(n,t);for(var n in t)t[n]=Object.keys(t[n].ascs_ids).map((function(e){return parseInt(e,10)}));return t}(e),n=[],a=0;a<t.length;a+=2){for(var _=t[a],i=t[a+1],s=!0,l=0;l<n.length;l++)if(!((v=n[l]).merged_nodes.length>=3)&&b(i,v.attr)&&!(r[_].indexOf(v.id)>-1||r[v.id].indexOf(_)>-1)){for(var c=!1,E=0;E<v.merged_nodes.length;E++){var u=v.merged_nodes[E].id;if(r[_].indexOf(u)>-1||r[u].indexOf(_)>-1){c=!0;break}}if(!c){var d=[],T=o.in_edge_count(e,_),f={};for(E=0;E<T;E++){(y=o.get_in_edge(e,_,E))in f||(f[y]=0);var p=o.get_edge_attr(e,y,_,f[y]++);d.push(y,_,p)}var P=[],S=o.out_edge_count(e,_),A={};for(E=0;E<S;E++)(L=o.get_out_edge(e,_,E))in A||(A[L]=0),p=o.get_edge_attr(e,_,L,A[L]++),P.push(_,L,p);var h=d.concat(P);for(E=0;E<h.length;E+=3)o.remove_edge(e,h[E],h[E+1],0);o.remove_node(e,_),v.merged_nodes.push(g={id:_,attr:i,edges_in:d,edges_out:P}),s=!1;break}}s&&n.push(v={id:_,attr:i,merged_nodes:[]})}for(a=0;a<n.length;a++){var v,m=(v=n[a]).merged_nodes.length;for(l=0;l<m;l++){var g,O=v.merged_nodes[l],N=O.edges_in,R=O.edges_out;for(v.attr.inputs[l+1].is_linked=(g=O.attr).inputs[0].is_linked,v.attr.inputs[l+1].default_value=g.inputs[0].default_value,v.attr.outputs[2*(l+1)].is_linked=g.outputs[0].is_linked,v.attr.outputs[2*(l+1)].default_value=g.outputs[0].default_value,v.attr.outputs[2*(l+1)+1].is_linked=g.outputs[1].is_linked,v.attr.outputs[2*(l+1)+1].default_value=g.outputs[1].default_value,E=0;E<N.length;E+=3){var y=N[E];(p=N[E+2])[1]+=l+1,o.append_edge(e,y,v.id,p)}for(E=0;E<R.length;E+=3){var L=R[E+1];(p=R[E+2])[0]+=2*(l+1),o.append_edge(e,v.id,L,p)}v.attr.dirs.push(["USE_uv"+(l+2),1])}o.remove_node(e,v.id),o.append_node(e,v.id,v.attr)}}}(e),function(e,t){var r={};for(var n in o.traverse(e,(function(e,t){if("GEOMETRY_UV"==t.type||"UVMAP"==t.type||"TEX_COORD_UV"==t.type){var n=t.data.value;n in r||(r[n]=[]),r[n].push(e,t)}})),r){var a=r[n];if(a.length>2)for(var _=x(e,R(n),0,void 0,null,[]),i=o.get_node_attr(e,_),s=0;s<a.length;s+=2){for(var l=a[s],c=a[s+1],E=[],u={},d=o.out_edge_count(e,l),T=0;T<d;T++){var f=o.get_out_edge(e,l,T);f in u||(u[f]=0);var p=o.get_edge_attr(e,l,f,u[f]);u[f]++,E.push(l,f,p);var P=p.splice(0,p.length);switch(c.type){case"GEOMETRY_UV":P[0]=0,i.outputs[0].is_linked=!0;break;case"UVMAP":case"TEX_COORD_UV":P[0]=1,i.outputs[1].is_linked=!0}o.append_edge(e,_,f,P)}for(T=0;T<E.length;T+=3)o.remove_edge(e,E[T],E[T+1],0);o.remove_node(e,l)}}}(e)}(K),function(e){var t=[],r=[];o.traverse(e,(function(e,n){"GEOMETRY_VC"==n.type&&t.push(e,n),"GEOMETRY_VW"==n.type&&r.push(e,n)})),function(e,t){for(var r=0;r<t.length;r+=2){for(var n=t[r],a=t[r+1],_=!1,i=[],s=[],l=[[],[],[]],c=o.out_edge_count(e,n),E=0;E<c;E++){var u=o.get_out_edge(e,n,E);if("SEPRGB"!=o.get_node_attr(e,u).type){_=!1;break}i.push(n,u);for(var d={},T=o.out_edge_count(e,u),f=0;f<T;f++){var p=o.get_out_edge(e,u,f);p in d||(d[p]=0);var P=o.get_edge_attr(e,u,p,d[p]++);i.push(u,p),l[P[0]].push(n,p,P)}s.push(u),_=!0}if(_){var S=0,A=0;for(E=0;E<l.length;E++)l[E].length&&(S++,A|=1<<2-E);if(S){for(a.type+=S,a.outputs=[],E=0;E<l.length;E++)if(l[E].length)for(a.outputs.push({default_value:0,identifier:"RGB"[E],is_linked:!0,name:"RGB"[E]}),f=0;f<l[E].length;f+=3)l[E][f+2][0]=XO(A,E);for(E=0;E<i.length;E+=2)o.remove_edge(e,i[E],i[E+1],0);for(E=0;E<s.length;E++)o.remove_node(e,s[E]);for(E=0;E<l.length;E++)for(f=0;f<l[E].length;f+=3)o.append_edge(e,l[E][f],l[E][f+1],l[E][f+2])}}}}(e,t),function(e,t){for(var r=0;r<t.length;r+=2){for(var n=t[r],a=!0,_=[],i=o.out_edge_count(e,n),s=0;s<i;s++){var l=o.get_out_edge(e,n,s);if("B4W_REFLECT"==o.get_node_attr(e,l).type){var c=o.get_edge_attr(e,n,l,0),E=o.get_edge_attr(e,n,l,1);c&&1==c[1]||E&&1==E[1]?a=!1:_.push(n,l)}else a=!1}for(s=0;s<_.length;s+=2)y(e,_[s],_[s+1]);a&&o.remove_node(e,n)}}(e,r)}(K),function(e,t){var r=[];o.traverse_edges(e,(function(n,a,_){var i=o.get_node_attr(e,n),s=o.get_node_attr(e,a),l=DO(i.outputs[_[0]].default_value),c=DO(s.inputs[_[1]].default_value);if(l!=c){var E,u={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},d={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};l&&!c?E=Y("vector_to_scalar","B4W_VECTOSCAL",[u],[d]):!l&&c&&(E=Y("scalar_to_vector","B4W_SCALTOVEC",[d],[u])),x(e,E,0,t,null,[]),r.push([n,a,e.nodes[e.nodes.length-2],_])}}));for(var n=0;n<r.length;++n)o.remove_edge_by_attr(e,r[n][0],r[n][1],r[n][3]),o.append_edge(e,r[n][0],r[n][2],[r[n][3][0],0]),o.append_edge(e,r[n][2],r[n][1],[0,r[n][3][1]])}(K,n),function(e){var t=[],r=[];o.traverse(e,(function(e,n){switch(n.type){case"VALTORGB":t.push(n);break;case"CURVE_VEC":case"CURVE_RGB":r.push(n)}}));var n=0,a=null,_=null,l=t.length+r.length;if(t.length){a=s.extract_col_ramps_data(t,s.COLORRAMP_TEXT_SIZE);for(var c=0;c<t.length;c++)t[c].dirs.push(["NODE_TEX_ROW",i.glsl_value((n+.5)/l)]),n++}if(r.length)for(_=s.extract_vec_curves_data(r,s.CURVE_NODES_TEXT_SIZE),c=0;c<r.length;c++)r[c].dirs.push(["NODE_TEX_ROW",i.glsl_value((n+.5)/l)]),n++;var E=null;if(a&&_?((E=new Uint8Array(a.length+_.length)).set(a),E.set(_,a.length)):E=a||_,E)var u=s.create_color_ramp_texture(E,s.CURVE_NODES_TEXT_SIZE);else u=null;for(c=0;c<t.length;c++)t[c].data.texture=u;for(c=0;c<r.length;c++)r[c].data.texture=u}(K)}else{var B=f(e,t,r,"MAIN",a,_),X=o.clone(B.graph,(function(e){var t=cO(e);return t.inputs=lO(e.inputs),t.outputs=lO(e.outputs),t}));-1==(G=L(e,X,"OUTPUT","material",!1,!0))&&(G=L(e,X,"OUTPUT_MATERIAL","material",!1,!0)),function(e,t){o.traverse_edges(e,(function(r,n,a){var _=o.get_node_attr(e,n);n==t&&"Color"==_.inputs[a[1]].identifier&&o.remove_edge_by_attr(e,r,n,a)}))}(X,G),m(K=o.subgraph_node_conn(X,G,o.BACKWARD_DIR))}return l.graph=K,c[t]=l,l}function p(e,t,r,n,a,_){var i={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},s=x(e,i,0,null,null,[]),l=s;if(P(e,r,s,"E"),P(e,r,s,"A"),P(e,r,s,"D"),!t.use_shadeless)for(var c,E,u,d,T=0;T<_.length;T++){var f=_[T];c=x(e,i={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"},0,null,null,[]),P(e,l,E=x(e,i={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"},0,null,null,[]),"color"),P(e,l,E,"specular"),P(e,c,E,"ldir"),P(e,r,E,"normal"),P(e,r,E,"D"),P(e,r,E,"S"),P(e,c,E,"lcolorint"),P(e,r,c,"shadow_factor");var p="SPECULAR_"+t.specular_shader;if(P(e,c,u=x(e,i={name:p,type:p,use_tangent_shading:t.use_tangent_shading},0,null,null,[]),"ldir"),P(e,c,u,"lfac"),P(e,r,u,"normal"),P(e,u,E,"sfactor"),P(e,c,u,"norm_fac"),P(e,r,u,"sp_params"),"HEMI"==f.type)var S="DIFFUSE_LAMBERT";else S="DIFFUSE_"+t.diffuse_shader;P(e,c,d=x(e,i={name:S,type:S,use_tangent_shading:t.use_tangent_shading},0,null,null,[]),"ldir"),P(e,c,d,"lfac"),P(e,r,d,"normal"),P(e,c,d,"norm_fac"),P(e,d,E,"lfactor"),"DIFFUSE_LAMBERT"!=S&&P(e,r,d,"dif_params");for(var A=0;A<a.length;A++)o.append_edge(e,a[A][0],E,a[A][1]);l=E}P(e,l,n,"color"),P(e,l,n,"specular")}function P(e,t,r,n){for(var a=o.get_node_attr(e,t),_=-1,i=o.get_node_attr(e,r).inputs,s=0;s<i.length;s++)if(n==i[s].identifier){_=s;break}if(-1!=_){var l=-1,c=a.outputs;for(s=0;s<c.length;s++)if(n==c[s].identifier){l=s;break}-1!=l&&(o.append_edge(e,t,r,[l,_]),c[l].is_linked=!0,i[_].is_linked=!0)}}function S(e,t,r){var n=o.subgraph_node_conn(e,t,o.BACKWARD_DIR),a=function(e){var t=[];return o.traverse(e,(function(e,r){for(var n=!1,a=r.inputs,o=0;o<a.length;o++)if("Normal"==a[o].identifier){n=!a[o].is_linked;break}n&&t.push(e)})),t}(n);if(a.length){var _=function(e){return o.clone(e,M,V)}(o.subgraph_node_conn(e,r,o.BACKWARD_DIR));o.traverse(_,(function(e,t){t.name="displacement%join%"+t.name})),o.append_subgraph(_,n,[],[]);var i=-1;o.traverse(n,(function(e,t){if("DISPLACEMENT_BUMP"==t.type)return i=e,1}));for(var s=0;s<a.length;s++){var l=a[s],c=o.get_node_attr(n,l);P(n,i,l,"Normal"),A(c,"USE_NORMAL_IN",1)}}e.nodes=n.nodes,e.edges=n.edges}function A(e,t,r){for(var n=e.dirs,a=0;a<n.length;a++){var o=n[a];o[0]==t&&(o[1]=r)}}function h(e,t,r){var n=[];o.traverse(e,(function(e,t){"OUTPUT_SURFACE"==t.type&&n.push({node_id:e,node:t})}));var a=[];n.length&&o.traverse(e,(function(e,t){"MIX_SHADER"==t.type&&a.push({node_id:e,node:t})}));for(var _=0;_<n.length;++_){var i=n[_].node_id,s=n[_].node,l=o.gen_node_id(e);o.append_node(e,l,s.data.bsdf_begin);var c=o.gen_node_id(e);o.append_node(e,c,s.data.bsdf_end),o.append_edge(e,l,c,[4,2]);for(var E=o.in_edge_count(e,i),u=[],d=[],T={},f=0;f<E;f++){var p=o.get_in_edge(e,i,f),P=o.get_node_attr(e,p);p in T||(T[p]=0);var S=o.get_edge_attr(e,p,i,T[p]++);if(u.push([p,i,S]),d.push([p,l,S]),"BSDF_GLOSSY"==P.type||"BSDF_DIFFUSE"==P.type||"MIX_SHADER"==P.type||"EMISSION"==P.type||"BSDF_TRANSPARENT"==P.type||"BSDF_PRINCIPLED"==P.type){d.push([p,l,[1,1]]),d.push([p,l,[2,2]]),d.push([p,l,[3,3]]),d.push([p,l,[4,4]]),d.push([p,l,[5,5]]),d.push([p,l,[6,6]]),d.push([p,l,[7,7]]),d.push([p,l,[8,8]]),d.push([p,l,[9,9]]),d.push([p,l,[10,10]]),d.push([p,l,[11,11]]),d.push([p,l,[12,12]]);for(var A=0;A<a.length;++A)for(var h=a[A].node_id,m=o.in_edge_count(e,h),g=0;g<m;g++){var O=o.get_in_edge(e,h,g),N=o.get_node_attr(e,O),R=o.get_edge_attr(e,O,h,0);if(0!=R[1]&&("BSDF_GLOSSY"==N.type||"BSDF_DIFFUSE"==N.type||"MIX_SHADER"==N.type||"EMISSION"==N.type||"BSDF_TRANSPARENT"==N.type||"BSDF_PRINCIPLED"==N.type)){var I=1==R[1]?3:15;d.push([O,h,[1,I]]),d.push([O,h,[2,I+1]]),d.push([O,h,[3,I+2]]),d.push([O,h,[4,I+3]]),d.push([O,h,[5,I+4]]),d.push([O,h,[6,I+5]]),d.push([O,h,[7,I+6]]),d.push([O,h,[8,I+7]]),d.push([O,h,[9,I+8]]),d.push([O,h,[10,I+9]]),d.push([O,h,[11,I+10]]),d.push([O,h,[12,I+11]])}}}}for(v(e,s.data.value,l,c,[],r),d.push([c,i,[0,0]]),d.push([c,i,[1,1]]),f=0;f<u.length;f++)o.remove_edge_by_attr(e,u[f][0],u[f][1],u[f][2]);for(f=0;f<d.length;f++)o.append_edge(e,d[f][0],d[f][1],d[f][2])}}function v(e,t,r,n,a,_){var i,s,l,c={name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},E=x(e,c,0,null,null,[]),u=E;P(e,r,E,"E"),P(e,r,E,"A"),P(e,r,E,"D");for(var d=0;d<_.length;d++){i=x(e,c={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"},0,null,null,[]),P(e,u,s=x(e,c={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"},0,null,null,[]),"color"),P(e,u,s,"specular"),P(e,i,s,"ldir"),P(e,r,s,"normal"),P(e,r,s,"D"),P(e,r,s,"S"),P(e,i,s,"lcolorint"),P(e,r,i,"shadow_factor");var T=t.bsdf_shader;P(e,i,l=x(e,c={name:T,type:T},0,null,null,[]),"ldir"),P(e,i,l,"lfac"),P(e,r,l,"normal"),P(e,i,l,"norm_fac"),P(e,r,l,"bsdf_params"),P(e,l,s,"lfactor"),P(e,l,s,"sfactor");for(var f=0;f<a.length;f++)o.append_edge(e,a[f][0],s,a[f][1]);u=s}P(e,r,n,"bsdf_params"),P(e,r,n,"refract_params"),P(e,r,n,"d_color"),P(e,r,n,"s_color"),P(e,r,n,"e_color"),P(e,r,n,"emission"),P(e,r,n,"a_color"),P(e,r,n,"alpha"),P(e,u,n,"color"),P(e,u,n,"specular")}function m(e){o.traverse(e,(function(t,r){for(var n=r.inputs,a=r.outputs,o=0;o<n.length;o++)g(e,n[o],t,o,1);for(o=0;o<a.length;o++)g(e,a[o],t,o,0)}))}function g(e,t,r,n,a){if(t.is_linked){var _=!0;o.traverse_edges(e,(function(e,t,o){(!a&&e==r&&o[0]==n||a&&t==r&&o[1]==n)&&(_=!1)})),_&&(t.is_linked=!1)}}function O(e,t){var n=[];if(o.traverse(t,(function(t,r){r.name==e.name&&n.push(t)})),n.length)return n;r.panic("Node not found")}function N(e,t,r){var n=function(e,t,r){for(var n=e.edges,a=0;a<n.length;a+=3)if(n[a+1]==t&&1==n[a+2][1])return n[a];return-1}(e,t);if(-1!=n){var a=o.get_node_attr(e,n);if(r.data=a.data,o.remove_edge(e,n,t,-1),0==o.out_edge_count(e,n)){var _=o.get_in_edge(e,n,0);-1!=_&&o.remove_edge(e,_,n,-1),o.remove_node(e,n)}}r.inputs.splice(1,1)}function R(e){var t=Y("merged_uv","UV_MERGED",[],[{default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},{default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"}]);return t.uv_layer=e,t}function I(e,t){var r=t[e];if(!r.is_completed){var n=lO(r);for(var a in r.ascs_ids){I(a,t);var o=t[a];for(var _ in o.ascs_ids)n.ascs_ids[_]=!0}n.is_completed=!0,t[e]=n}}function b(e,t){if(e.type!==t.type)return!1;switch(e.type){case"GEOMETRY_VC":return e.data.value==t.data.value;case"GEOMETRY_NO":return function(e,t,r){for(var n=e.dirs,a=-1,o=0;o<n.length;o++){var _=n[o];if("USE_NORMAL_IN"==_[0]){a=_[1];break}}var i=t.dirs,s=-1;for(o=0;o<i.length;o++){var l=i[o];if("USE_NORMAL_IN"==l[0]){s=l[1];break}}return a===s}(e,t);case"GEOMETRY_FB":case"GEOMETRY_VW":case"GEOMETRY_GL":case"GEOMETRY_LO":case"GEOMETRY_OR":case"GEOMETRY_BF":case"GEOMETRY_IN":return!0;case"TEXTURE_COLOR":case"TEXTURE_NORMAL":return e.data.bpy_uuid==t.data.bpy_uuid&&e.data.value.img_uuid==t.data.value.img_uuid;case"VALUE":case"RGB":return e.origin_name==t.origin_name;default:return!1}}function y(e,t,r){var n=o.get_node_attr(e,r);n.type+="_WORLD",o.remove_edge(e,t,r,0),n.inputs.splice(0,1);var a=o.get_in_edge(e,r,0);a!=o.NULL_NODE&&(o.get_edge_attr(e,a,r,0)[1]=0)}function L(e,t,r,n,a,o){for(var i=e.nodes,s=null,l=0;l<i.length;l++){var c=i[l];a?"GROUP"==c.type&&c.node_tree_name==r&&(s=c):c.type==r&&(s=c)}return s?O(s,t)[0]:(o||_.error('No "'+r+'" node in node '+n),-1)}function Y(e,t,r,n){return{name:e,type:t,inputs:r,outputs:n}}function M(e){var t={name:"",origin_name:"",type:"",vparams:[],inputs:[],outputs:[],params:[],data:null,dirs:[]};t.name=e.name,t.origin_name=e.origin_name,t.type=e.type;for(var r=t.vparams,n=e.vparams,a=0;a<n.length;a++)r.push(Q(n[a]));var o=t.params,_=e.params;for(a=0;a<_.length;a++)o.push(Q(_[a]));var i=t.inputs,s=e.inputs;for(a=0;a<s.length;a++)i.push(X(s[a]));var l=t.outputs,c=e.outputs;for(a=0;a<c.length;a++)l.push(X(c[a]));var E=t.dirs,u=e.dirs;for(a=0;a<u.length;a++)E.push(u[a].slice());return t.data=e.data,t}function x(e,t,n,a,l,c){var E,f,p=t.name,P=t.name,S=t.type,A=[],h=[],v=[],m=[],g=null,O="uv_layer"in t&&(t.uv_layer||l&&l.uv_name)||"",N="color_layer"in t&&(t.color_layer||l&&l.vc_name)||"",R=[];switch(S){case"BSDF_ANISOTROPIC":case"BSDF_GLASS":case"BSDF_HAIR":case"BSDF_TRANSLUCENT":case"BSDF_REFRACTION":case"BSDF_TOON":case"BSDF_VELVET":case"SUBSURFACE_SCATTERING":case"AMBIENT_OCCLUSION":case"VOLUME_ABSORPTION":case"VOLUME_SCATTER":case"BLACKBODY":case"WAVELENGTH":case"SEPXYZ":case"COMBXYZ":case"LIGHT_FALLOFF":case"TEX_SKY":case"TEX_NOISE":case"TEX_WAVE":case"TEX_MUSGRAVE":case"TEX_GRADIENT":case"TEX_MAGIC":case"TEX_CHECKER":case"TEX_BRICK":case"WIREFRAME":case"TANGENT":case"LIGHT_PATH":case"HOLDOUT":case"HAIR_INFO":case"SCRIPT":h=H(t),v=j(t),_.warn(S+" node is not fully supported.");break;case"BRIGHTCONTRAST":case"ADD_SHADER":h=H(t),v=j(t);break;case"MIX_SHADER":h.push(F(t,"Fac"));var I=F(t,"Shader"),b=I.is_linked;h.push(I);var y=F(t,"Shader_001");y||(y=F(t,"Shader.001"));var L=y.is_linked;h.push(y),h.push(B("d_color1","d_color1",[0,0,0],b)),h.push(B("d_roughness1","d_roughness1",0,b)),h.push(B("s_color1","s_color1",[0,0,0],b)),h.push(B("s_roughness1","s_roughness1",0,b)),h.push(B("metalness1","metalness1",0,b)),h.push(B("normal1","normal1",[0,0,0],b)),h.push(B("ior1","ior1",0,b)),h.push(B("transmission1","transmission1",0,b)),h.push(B("e_color1","e_color1",[0,0,0],b)),h.push(B("emission1","emission1",0,b)),h.push(B("a_color1","a_color1",[0,0,0],b)),h.push(B("alpha1","alpha1",1,b)),h.push(B("d_color2","d_color2",[0,0,0],L)),h.push(B("d_roughness2","d_roughness2",0,L)),h.push(B("s_color2","s_color2",[0,0,0],L)),h.push(B("s_roughness2","s_roughness2",0,L)),h.push(B("metalness2","metalness2",0,L)),h.push(B("normal2","normal2",[0,0,0],L)),h.push(B("ior2","ior2",0,L)),h.push(B("transmission2","transmission2",0,L)),h.push(B("e_color2","e_color2",[0,0,0],L)),h.push(B("emission2","emission2",0,L)),h.push(B("a_color2","a_color2",[0,0,0],L)),h.push(B("alpha2","alpha2",1,L));var Y=G(t,"Shader"),M=Y.is_linked;v=[Y,B("d_color","d_color",[0,0,0],M),B("d_roughness","d_roughness",0,M),B("s_color","s_color",[0,0,0],M),B("s_roughness","s_roughness",0,M),B("metalness","metalness",0,M),B("normal","normal",[0,0,0],M),B("ior","ior",0,M),B("transmission","transmission",0,M),B("e_color","e_color",[0,0,0],M),B("emission","emission",0,M),B("a_color","a_color",[0,0,0],M),B("alpha","alpha",1,M)];break;case"OBJECT_INFO":h=H(t),v=[];var U=G(t,"Location"),K=G(t,"Object Index"),X=G(t,"Material Index"),Q=G(t,"Random");v.push(U),v.push(K),v.push(X),v.push(Q),R.push(["USE_LOCATION_OUT",0|U.is_linked]),R.push(["USE_OBJ_IND_OUT",0|K.is_linked]),R.push(["USE_MAT_IND_OUT",0|X.is_linked]),R.push(["USE_RANDOM_OUT",0|Q.is_linked]);break;case"UVMAP":if(O||(S="EMPTY_UV"),"EMPTY_UV"!=S){var V=k("param_"+S+"_a"),q=k("param_"+S+"_v");A.push(z(V)),A.push(z(q)),m.push(z(q)),g={name:V,value:O}}v=j(t);break;case"UV_MERGED":V=k("param_UV_MERGED_a"),q=k("param_UV_MERGED_v"),A.push(z(V)),A.push(z(q)),v.push(G(t,"UV_geom")),v.push(G(t,"UV_cycles")),m.push(z(q)),g={name:V,value:O};break;case"CAMERA":h=[],v=j(t);break;case"COMBRGB":case"COMBHSV":h=H(t),v=j(t);break;case"CURVE_RGB":case"CURVE_VEC":"CURVE_RGB"==S?(oe(t,0,0,1)&&R.push(["READ_R",1]),oe(t,1,0,1)&&R.push(["READ_G",1]),oe(t,2,0,1)&&R.push(["READ_B",1]),oe(t,3,0,1)&&R.push(["READ_A",1])):(oe(t,0,-1,1)&&R.push(["READ_R",1]),oe(t,1,-1,1)&&R.push(["READ_G",1]),oe(t,2,-1,1)&&R.push(["READ_B",1])),h=H(t),v=j(t),g={value:t};break;case"PARTICLE_INFO":h=H(t),v=j(t);for(var W=0;W<t.outputs.length;W++){var J=t.outputs[W],Z=J.identifier,$=z("v_param_PART_INFO_"+Z.replace(" ",""));if(J.is_linked)switch(Z){case"Size":R.push(["PART_INFO_SIZE",i.glsl_value(1)]);break;case"Age":R.push(["PART_INFO_AGE",i.glsl_value(1)]);break;case"Lifetime":R.push(["PART_INFO_LT",i.glsl_value(1)]);break;case"Location":R.push(["PART_INFO_LOC",i.glsl_value(1)]);break;case"Index":var ee=z("a_param_PART_INFO_"+J.identifier.replace(" ",""));g=ee,R.push(["PART_INFO_IND",i.glsl_value(1)]);break;case"Velocity":R.push(["PART_INFO_VEL",i.glsl_value(1)]);break;case"Angular Velocity":R.push(["PART_INFO_A_VEL",i.glsl_value(1)])}"Age"!=Z&&"Lifetime"!=Z&&"Size"!=Z&&(A.push($),m.push($))}ee&&A.push(ee);break;case"NEW_GEOMETRY":case"GEOMETRY":if(!D(t))return!0;if(!(S=function(e,t){for(var r=e.outputs,n=0,a=0;a<r.length;a++){var o=r[a];if(o.is_linked&&!(n++<t))switch(o.identifier){case"UV":return"GEOMETRY_UV";case"Vertex Color":return"GEOMETRY_VC";case"Normal":return"GEOMETRY_NO";case"True Normal":return"GEOMETRY_TRN";case"Front/Back":return"GEOMETRY_FB";case"View":return"GEOMETRY_VW";case"Global":case"Position":return"GEOMETRY_GL";case"Local":return"GEOMETRY_LO";case"Orco":return"GEOMETRY_OR";case"Incoming":return"GEOMETRY_IN";case"Backfacing":return"GEOMETRY_BF";default:return null}}}(t,n)))return _.error("Geometry output is not supported"),null;switch(S){case"GEOMETRY_UV":O||(S="EMPTY_UV"),"EMPTY_UV"!=S&&(V=k("param_GEOMETRY_UV_a"),q=k("param_GEOMETRY_UV_v"),A.push(z(V)),A.push(z(q)),m.push(z(q)),g={name:V,value:O}),v.push(G(t,"UV"));break;case"GEOMETRY_VC":if(N||(S="EMPTY_VC"),"EMPTY_VC"!=S){var te=k("param_GEOMETRY_VC_a"),re=k("param_GEOMETRY_VC_v");A.push(z(te)),A.push(z(re)),m.push(z(re)),g={name:te,value:N}}v.push(G(t,"Vertex Color"));break;case"GEOMETRY_NO":h.push(B("Normal","Normal",[0,0,0],!1)),R.push(["USE_NORMAL_IN",0]),v.push(G(t,"Normal"));break;case"GEOMETRY_TRN":S="GEOMETRY_NO",h.push(B("Normal","Normal",[0,0,0],!1)),v.push(G(t,"True Normal")),R.push(["USE_NORMAL_IN",0]),_.warn("Geometry True Normal output is not fully supported.");break;case"GEOMETRY_FB":v.push(G(t,"Front/Back"));break;case"GEOMETRY_VW":v.push(G(t,"View"));break;case"GEOMETRY_GL":v.push(G(t,"Global")||G(t,"Position"));break;case"GEOMETRY_LO":v.push(G(t,"Local"));break;case"GEOMETRY_OR":var ne=k("param_GEOMETRY_OR_v");A.push(z(ne)),v.push(G(t,"Orco")),m.push(z(ne));break;case"GEOMETRY_IN":v.push(G(t,"Incoming"));break;case"GEOMETRY_BF":v.push(G(t,"Backfacing"))}break;case"ATTRIBUTE":if(!D(t))return!0;"EMPTY_VC"!=(S=N?"GEOMETRY_VC":"EMPTY_VC")&&(te=k("param_GEOMETRY_VC_a"),re=k("param_GEOMETRY_VC_v"),A.push(z(te)),A.push(z(re)),m.push(z(re)),g={name:te,value:N}),v.push(G(t,"Color"));break;case"TEX_COORD":if(!D(t))return!0;switch(S=function(e,t){for(var r=e.outputs,n=0,a=0;a<r.length;a++){var o=r[a];if(o.is_linked&&!(n++<t))switch(o.identifier){case"Camera":return"TEX_COORD_CA";case"Generated":return"TEX_COORD_GE";case"Normal":return"TEX_COORD_NO";case"Object":return"TEX_COORD_OB";case"Reflection":return"TEX_COORD_RE";case"UV":return"TEX_COORD_UV";case"Window":return"TEX_COORD_WI";default:return null}}}(t,n)){case"TEX_COORD_UV":O||(S="EMPTY_UV"),"EMPTY_UV"!=S&&(V=k("param_TEX_COORD_UV_a"),q=k("param_TEX_COORD_UV_v"),A.push(z(V)),A.push(z(q)),m.push(z(q)),g={name:V,value:O}),v.push(G(t,"UV"));break;case"TEX_COORD_NO":v.push(G(t,"Normal"));break;case"TEX_COORD_GE":var ae=k("param_TEX_COORD_GE_v");A.push(z(ae)),v.push(G(t,"Generated")),m.push(z(ae));break;case"TEX_COORD_OB":v.push(G(t,"Object"));break;case"TEX_COORD_CA":v.push(G(t,"Camera"));break;case"TEX_COORD_WI":v.push(G(t,"Window"));break;case"TEX_COORD_RE":v.push(G(t,"Reflection"))}break;case"GROUP":var _e=t.node_tree_name;switch(_e){case"B4W_LINEAR_TO_SRGB":if(!C(t,[1],[1])){g=w(t,a,l,[]);break}S="B4W_LINEAR_TO_SRGB";break;case"B4W_NORMAL_VIEW":case"B4W_VECTOR_VIEW":if(!C(t,[1],[1])){g=w(t,a,l,[]);break}S="B4W_VECTOR_VIEW";break;case"B4W_SRGB_TO_LINEAR":if(!C(t,[1],[1])){g=w(t,a,l,[]);break}S="B4W_SRGB_TO_LINEAR";break;case"B4W_REFLECT":if(!C(t,[1,1],[1])){g=w(t,a,l,[]);break}S="B4W_REFLECT";break;case"B4W_REFRACTION":if(!C(t,[1,0],[1])){g=w(t,a,l,[]);break}S="B4W_REFRACTION";break;case"B4W_PARALLAX":if(!C(t,[1,1,0,0,0],[1])){g=w(t,a,l,[]);break}var ie=k("param_B4W_PARALLAX_texture");m.push(z(ie)),S="B4W_PARALLAX";break;case"B4W_CLAMP":if(!C(t,[1],[1])){g=w(t,a,l,[]);break}S="B4W_CLAMP";break;case"B4W_TRANSLUCENCY":if(!C(t,[0,0,0,0,0],[0])){g=w(t,a,l,[]);break}S="B4W_TRANSLUCENCY";break;case"B4W_TIME":if(!C(t,[],[0])){g=w(t,a,l,[]);break}S="B4W_TIME";break;case"B4W_SMOOTHSTEP":if(!C(t,[0,0,0],[0])){g=w(t,a,l,[]);break}S="B4W_SMOOTHSTEP";break;case"B4W_GLOW_OUTPUT":S="B4W_GLOW_OUTPUT";break;default:g=w(t,a,l,c)}if(h=H(t),v=j(t),"B4W_TRANSLUCENCY"==_e){var se=B("TranslucencyParams","TranslucencyParams",[0,0,0,0]);se.is_linked=v[0].is_linked,v.push(se)}break;case"LAMP":var le=t.lamp;le?(le.uuid in u?R.push(["LAMP_INDEX",String(u[le.uuid])]):(u[le.uuid]=d,R.push(["LAMP_INDEX",String(d++)])),g=u):(_.error("There is no lamp in node: "+t.name),R.push(["LAMP_INDEX",-1])),v.push(G(t,"Color")),v.push(G(t,"Light Vector")),v.push(G(t,"Distance")),v.push(G(t,"Visibility Factor"));break;case"LIGHTING_AMBIENT":h=[B("E","E",[0,0,0],!0),B("A","A",[0,0,0],!0),B("D","D",[0,0,0],!0)],v=[B("color","color",[0,0,0],!0),B("specular","specular",[0,0,0],!0)];break;case"LIGHTING_BEGIN":v=[B("E","E",[0,0,0],!0),B("A","A",[0,0,0],!0),B("D","D",[0,0,0],!0),B("S","S",[0,0,0],!0),B("normal","normal",[0,0,0],!0),B("dif_params","dif_params",[0,0],!0),B("sp_params","sp_params",[0,0],!0),B("shadow_factor","shadow_factor",0,!0),B("translucency_color","translucency_color",0,!0),B("translucency_params","translucency_params",[0,0,0,0],!0)];break;case"LIGHTING_END":h=[B("color","color",[0,0,0],!0),B("specular","specular",[0,0,0],!0)];break;case"LIGHTING_LAMP":h=[B("shadow_factor","shadow_factor",0,!0)],v=[B("ldir","ldir",[0,0,0],!0),B("lfac","lfac",[0,0],!0),B("lcolorint","lcolorint",[0,0,0],!0),B("norm_fac","norm_fac",0,!0)];break;case"DIFFUSE_LAMBERT":h=[B("ldir","ldir",[0,0,0],!0),B("lfac","lfac",[0,0],!0),B("normal","normal",[0,0,0],!0),B("norm_fac","norm_fac",0,!0)],v=[B("lfactor","lfactor",0,!0)],R.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"DIFFUSE_FRESNEL":case"DIFFUSE_MINNAERT":case"DIFFUSE_OREN_NAYAR":case"DIFFUSE_TOON":h=[B("ldir","ldir",[0,0,0],!0),B("lfac","lfac",[0,0],!0),B("normal","normal",[0,0,0],!0),B("norm_fac","norm_fac",0,!0),B("dif_params","dif_params",[0,0],!0)],v=[B("lfactor","lfactor",0,!0)],R.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"SPECULAR_BLINN":case"SPECULAR_PHONG":case"SPECULAR_COOKTORR":h=[B("ldir","ldir",[0,0,0],!0),B("lfac","lfac",[0,0],!0),B("normal","normal",[0,0,0],!0),B("norm_fac","norm_fac",0,!0),B("sp_params","sp_params",[0,0],!0)],v=[B("sfactor","sfactor",0,!0)],R.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"SPECULAR_TOON":case"SPECULAR_WARDISO":h=[B("ldir","ldir",[0,0,0],!0),B("lfac","lfac",[0,0],!0),B("normal","normal",[0,0,0],!0),B("norm_fac","norm_fac",0,!0),B("sp_params","sp_params",[0,0],!0)],v=[B("sfactor","sfactor",0,!0)],R.push(["MAT_USE_TBN_SHADING",0|t.use_tangent_shading]);break;case"BSDF_COMPUTE":h=[B("ldir","ldir",[0,0,0],!0),B("lfac","lfac",[0,0],!0),B("normal","normal",[0,0,0],!0),B("norm_fac","norm_fac",0,!0),B("bsdf_params","bsdf_params",[0,0,0,0],!0)],v=[B("lfactor","lfactor",0,!0),B("sfactor","sfactor",0,!0)];break;case"LIGHTING_APPLY":h=[B("color","color",[0,0,0,0],!0),B("specular","specular",[0,0,0],!0),B("lfactor","lfactor",0,!0),B("sfactor","sfactor",0,!0),B("ldir","ldir",[0,0,0],!0),B("normal","normal",[0,0,0],!0),B("translucency_params","translucency_params",[0,0,0,0],!0),B("D","D",[0,0,0],!0),B("S","S",[0,0,0],!0),B("lcolorint","lcolorint",[0,0,0],!0),B("translucency_color","translucency_color",0,!0)],v=[B("color","color",[0,0,0,0],!0),B("specular","specular",[0,0,0],!0)];break;case"NORMAL":h=H(t),v=j(t);var ce=G(t,"Normal");m.push(z(k("param_NORMAL_Normal"),ce.default_value,3));break;case"MAPPING":var Ee=t.vector_type;S="MAPPING",h.push(F(t,"Vector")),v.push(G(t,"Vector"));var ue=Qg(t.rotation),de=Qg(t.scale),Te=Qg(t.translation),fe=oA(),pe=aO(ue,oA());switch("TEXTURE"!=Ee&&"NORMAL"!=Ee||(de[0]=de[0]||1,de[1]=de[1]||1,de[2]=de[2]||1),TA(pe,new Float32Array([de[0],0,0,0,de[1],0,0,0,de[2]]),fe),E=fe,(f=IA())[15]=1,f[14]=0,f[13]=0,f[12]=0,f[11]=0,f[10]=E[8],f[9]=E[7],f[8]=E[6],f[7]=0,f[6]=E[5],f[5]=E[4],f[4]=E[3],f[3]=0,f[2]=E[2],f[1]=E[1],f[0]=E[0],fe=f,Ee){case"POINT":fe[12]=Te[0],fe[13]=Te[1],fe[14]=Te[2];break;case"TEXTURE":fe[12]=Te[0],fe[13]=Te[1],fe[14]=Te[2],fe=MA(fe,fe);break;case"NORMAL":MA(fe,fe),YA(fe,fe)}switch(Ee){case"NORMAL":R.push(["MAPPING_IS_NORMAL",1]);case"TEXTURE":R.push(["MAPPING_TRS_MATRIX_DEF",1]),R.push(["MAPPING_TRS_MATRIX",i.glsl_value(fe,16)]);break;case"POINT":0!==mh(ue)?(R.push(["MAPPING_TRS_MATRIX_DEF",1]),R.push(["MAPPING_TRS_MATRIX",i.glsl_value(fe,16)])):(0!==vh(de,xg)&&(R.push(["MAPPING_SCALE_DEF",1]),R.push(["MAPPING_SCALE",i.glsl_value(de,3)])),0!==mh(Te)&&(R.push(["MAPPING_TRANS_DEF",1]),R.push(["MAPPING_TRANS",i.glsl_value(Te,3)])));break;case"VECTOR":0!==mh(ue)?(R.push(["MAPPING_TRS_MATRIX_DEF",1]),R.push(["MAPPING_TRS_MATRIX",i.glsl_value(fe,16)])):0!==vh(de,xg)&&(R.push(["MAPPING_SCALE_DEF",1]),R.push(["MAPPING_SCALE",i.glsl_value(de,3)]))}t.use_min&&(R.push(["MAPPING_MIN_CLIP_DEF",1]),R.push(["MAPPING_MIN_CLIP",i.glsl_value(t.min,3)])),t.use_max&&(R.push(["MAPPING_MAX_CLIP_DEF",1]),R.push(["MAPPING_MAX_CLIP",i.glsl_value(t.max,3)]));break;case"MATERIAL":case"MATERIAL_EXT":var Pe=[],Se=[],Ae=[],he=[B("E","E",[0,0,0],!0),B("A","A",[0,0,0],!0),B("D","D",[0,0,0],!0),B("S","S",[0,0,0],!0),B("normal","normal",[0,0,0],!0),B("dif_params","dif_params",[0,0],!0),B("sp_params","sp_params",[0,0],!0),B("shadow_factor","shadow_factor",0,!0)],ve=[B("color","color",[0,0,0],!0),B("specular","specular",[0,0,0],!0),B("normal","normal",[0,0,0],!0)],me=[G(t,"Color"),G(t,"Alpha"),G(t,"Normal")],ge=[];if((tt=F(t,"Color")).default_value.splice(3),Ae.push(tt),h.push(tt),(tt=F(t,"Spec")).default_value.splice(3),Ae.push(tt),h.push(tt),(tt=F(t,"DiffuseIntensity"))||(tt=F(t,"Refl")),tt.default_value=t.diffuse_intensity,Ae.push(tt),h.push(tt),(Et=F(t,"Normal")).default_value.splice(3),Ae.push(Et),h.push(Et),"MATERIAL_EXT"==S){(tt=F(t,"Emit"))||(tt=B("Emit","Emit",0)),Ae.push(tt),h.push(tt),(tt=F(t,"Translucency"))?(tt.default_value=0,tt.name="Translucency",tt.identifier="Translucency"):tt=B("Translucency","Translucency",0),h.push(tt),(tt=F(t,"Translucency"))?(tt.default_value=[0,0,0,0],tt.name="TranslucencyParams",tt.identifier="TranslucencyParams"):tt=B("TranslucencyParams","TranslucencyParams",[0,0,0,0]),h.push(tt);var Oe=F(t,"Reflectivity"),Ne=F(t,"Ray Mirror");if(Oe){tt=Oe;var Re="Reflectivity"}else Ne?(tt=Ne,Re="Ray Mirror"):(tt=Oe,Re="Reflectivity");tt||(tt=B(Re,Re,0)),h.push(tt),ve.push(tt),(tt=F(t,"SpecTra"))||(tt=B("SpecTra","SpecTra",0)),h.push(tt),ve.push(tt),(tt=F(t,"Alpha"))||(tt=B("Alpha","Alpha",t.alpha)),h.push(tt),ve.push(tt),me.push(G(t,"Diffuse")),me.push(G(t,"Spec")),Pe.push(["MATERIAL_EXT",1]),Se.push(["MATERIAL_EXT",1])}else Ae.push(B("emit_intensity","emit_intensity",0)),ve.push(B("reflect_factor","reflect_factor",0)),ve.push(B("specular_alpha","specular_alpha",0)),ve.push(B("alpha_in","alpha_in",0)),me.push(B("diffuse_out","diffuse_out",0)),me.push(B("spec_out","spec_out",0)),Pe.push(["MATERIAL_EXT",0]),Se.push(["MATERIAL_EXT",0]);ge.push(z(k("param_MATERIAL_alpha"),t.alpha)),ge.push(z(k("param_MATERIAL_spec_alpha"),t.specular_alpha)),v=me,Pe.push(["USE_MATERIAL_NORMAL",0|Et.is_linked]),t.use_diffuse&&(Pe.push(["USE_MATERIAL_DIFFUSE",1]),Se.push(["USE_MATERIAL_DIFFUSE",1])),t.use_specular&&Se.push(["USE_MATERIAL_SPECULAR",1]);var Ie,be,ye,Le=[],Ye=0;switch(t.specular_shader){case"COOKTORR":case"PHONG":Ie=t.specular_hardness;break;case"WARDISO":Ie=t.specular_slope;break;case"TOON":Ie=t.specular_toon_size,Ye=t.specular_toon_smooth;break;case"BLINN":Ie=t.specular_ior,Ye=t.specular_hardness;break;default:_.error("unsupported specular shader: "+t.specular_shader+' (material "'+t.material_name+'")'),Ie=t.specular_hardness}switch(t.diffuse_shader){case"LAMBERT":be=0,ye=0;break;case"OREN_NAYAR":be=t.roughness,ye=0;break;case"FRESNEL":be=t.diffuse_fresnel,ye=t.diffuse_fresnel_factor;break;case"MINNAERT":be=t.darkness,ye=0;break;case"TOON":be=t.diffuse_toon_size,ye=t.diffuse_toon_smooth;break;default:_.error("unsupported diffuse shader: "+t.diffuse_shader+' (material "'+t.material_name+'")'),be=0,ye=0}Le.push(z(k("param_MATERIAL_diffuse"),[be,ye],2)),Le.push(z(k("param_MATERIAL_spec"),[t.specular_intensity,Ie,Ye],3)),Pe.push(["SHADELESS_MAT",t.use_shadeless?1:0]);var Me={name:t.name,value:{specular_shader:t.specular_shader,diffuse_shader:t.diffuse_shader,use_shadeless:t.use_shadeless,use_tangent_shading:t.use_tangent_shading}};g={name:t.name,value:{specular_shader:t.specular_shader,diffuse_shader:t.diffuse_shader,use_shadeless:t.use_shadeless,use_tangent_shading:t.use_tangent_shading},material_begin:{name:"material_begin",type:"MATERIAL_BEGIN",inputs:Ae,outputs:he,params:Le,data:Me,dirs:Pe,vparams:[]},material_end:{name:"material_end",type:"MATERIAL_END",inputs:ve,outputs:me,params:ge,data:Me,dirs:Se,vparams:[]}};break;case"BSDF_PRINCIPLED":h=H(t);var xe=F(t,"Base Color"),Ce=F(t,"Metallic"),we=F(t,"Roughness"),Ue=F(t,"IOR"),ke=F(t,"Transmission"),De=F(t,"Normal");h=[xe,Ce,we,Ue,ke,De],R.push(["USE_NORMAL_IN",0|De.is_linked]),v=[Fe=G(t,"BSDF"),B("d_color","d_color",[0,0,0],Ge=Fe.is_linked),B("d_roughness","d_roughness",0,Ge),B("s_color","s_color",[0,0,0],Ge),B("s_roughness","s_roughness",0,Ge),B("metalness","metalness",1,Ge),B("normal","normal",[0,0,0],Ge),B("ior","ior",0,Ge),B("transmission","transmission",0,Ge),B("e_color","e_color",[0,0,0],Ge),B("emisson","emisson",0,Ge),B("a_color","a_color",[0,0,0],Ge),B("alpha","alpha",1,Ge)],g={value:{use_refract:ke.is_linked||ke.default_value}};break;case"BSDF_DIFFUSE":h=H(t),R.push(["USE_NORMAL_IN",0|h[2].is_linked]),v=[Fe=G(t,"BSDF"),B("d_color","d_color",[0,0,0],Ge=Fe.is_linked),B("d_roughness","d_roughness",0,Ge),B("s_color","s_color",[0,0,0],Ge),B("s_roughness","s_roughness",0,Ge),B("metalness","metalness",0,Ge),B("normal","normal",[0,0,0],Ge),B("ior","ior",0,Ge),B("transmission","transmission",0,Ge),B("e_color","e_color",[0,0,0],Ge),B("emisson","emisson",0,Ge),B("a_color","a_color",[0,0,0],Ge),B("alpha","alpha",1,Ge)];break;case"BSDF_GLOSSY":h=H(t),R.push(["USE_NORMAL_IN",0|h[2].is_linked]),v=[Fe=G(t,"BSDF"),B("d_color","d_color",[0,0,0],Ge=Fe.is_linked),B("d_roughness","d_roughness",0,Ge),B("s_color","s_color",[0,0,0],Ge),B("s_roughness","s_roughness",0,Ge),B("metalness","metalness",1,Ge),B("normal","normal",[0,0,0],Ge),B("ior","ior",0,Ge),B("transmission","transmission",0,Ge),B("e_color","e_color",[0,0,0],Ge),B("emisson","emisson",0,Ge),B("a_color","a_color",[0,0,0],Ge),B("alpha","alpha",1,Ge)];break;case"BSDF_TRANSPARENT":var Fe,Ge,Ke=t.b4w_use_alpha;h=H(t),v=[Fe=G(t,"BSDF"),B("d_color","d_color",[0,0,0],Ge=Fe.is_linked),B("d_roughness","d_roughness",0,Ge),B("s_color","s_color",[0,0,0],Ge),B("s_roughness","s_roughness",0,Ge),B("metalness","metalness",0,Ge),B("normal","normal",[0,0,0],Ge),B("ior","ior",0,Ge),B("transmission","transmission",0,Ge),B("e_color","e_color",[0,0,0],Ge),B("emisson","emisson",0,Ge),B("a_color","a_color",[0,0,0],Ge),B("alpha","alpha",Ke?0:1,Ge)],g={value:{use_alpha:Ke}},R.push(["USE_ALPHA",0|Ke]);break;case"EMISSION":h=H(t);var Be=G(t,"Emission"),Xe=Be.is_linked;v=[Be,B("d_color","d_color",[0,0,0],Xe),B("d_roughness","d_roughness",0,Xe),B("s_color","s_color",[0,0,0],Xe),B("s_roughness","s_roughness",0,Xe),B("metalness","metalness",1,Xe),B("normal","normal",[0,0,0],Xe),B("ior","ior",0,Ge),B("transmission","transmission",0,Ge),B("e_color","e_color",[0,0,0],Xe),B("emisson","emisson",1,Xe),B("a_color","a_color",[0,0,0],Ge),B("alpha","alpha",1,Ge)];break;case"MATH":switch(t.operation){case"ADD":S="MATH_ADD";break;case"SUBTRACT":S="MATH_SUBTRACT";break;case"MULTIPLY":S="MATH_MULTIPLY";break;case"DIVIDE":S="MATH_DIVIDE";break;case"SINE":S="MATH_SINE";break;case"COSINE":S="MATH_COSINE";break;case"TANGENT":S="MATH_TANGENT";break;case"ARCSINE":S="MATH_ARCSINE";break;case"ARCCOSINE":S="MATH_ARCCOSINE";break;case"ARCTANGENT":S="MATH_ARCTANGENT";break;case"POWER":S="MATH_POWER";break;case"LOGARITHM":S="MATH_LOGARITHM";break;case"MINIMUM":S="MATH_MINIMUM";break;case"MAXIMUM":S="MATH_MAXIMUM";break;case"ROUND":S="MATH_ROUND";break;case"LESS_THAN":S="MATH_LESS_THAN";break;case"GREATER_THAN":S="MATH_GREATER_THAN";break;case"MODULO":S="MATH_MODULO";break;case"ABSOLUTE":S="MATH_ABSOLUTE";break;default:return _.error("Unsupported MATH operation: "+t.operation),null}R.push(["MATH_USE_CLAMP",Number(t.use_clamp)]),h=H(t),v=j(t);break;case"MIX_RGB":switch(t.blend_type){case"MIX":S="MIX_RGB_MIX";break;case"ADD":S="MIX_RGB_ADD";break;case"MULTIPLY":S="MIX_RGB_MULTIPLY";break;case"SUBTRACT":S="MIX_RGB_SUBTRACT";break;case"SCREEN":S="MIX_RGB_SCREEN";break;case"DIVIDE":S="MIX_RGB_DIVIDE";break;case"DIFFERENCE":S="MIX_RGB_DIFFERENCE";break;case"DARKEN":S="MIX_RGB_DARKEN";break;case"LIGHTEN":S="MIX_RGB_LIGHTEN";break;case"OVERLAY":S="MIX_RGB_OVERLAY";break;case"DODGE":S="MIX_RGB_DODGE";break;case"BURN":S="MIX_RGB_BURN";break;case"HUE":S="MIX_RGB_HUE";break;case"SATURATION":S="MIX_RGB_SATURATION";break;case"VALUE":S="MIX_RGB_VALUE";break;case"COLOR":S="MIX_RGB_COLOR";break;case"SOFT_LIGHT":S="MIX_RGB_SOFT_LIGHT";break;case"LINEAR_LIGHT":S="MIX_RGB_LINEAR_LIGHT";break;default:return _.error("Unsupported MIX_RGB blend type: "+t.blend_type),null}R.push(["MIX_RGB_USE_CLAMP",Number(t.use_clamp)]),h=H(t),v=j(t);break;case"MIX_WORLD_RGB":case"ADD_WORLD_RGB":h=[B("Factor","Factor",t.fac,t.fac_is_linked),B("Color1","Color1",[0,0,0],t.color1_is_linked),B("Color2","Color1",[0,0,0],t.color2_is_linked)],v=[B("Color","Color",[0,0,0],!0)];break;case"OUTPUT":h=H(t),v=[];break;case"OUTPUT_MATERIAL":h=H(t),v=[];var He=(We=F(t,"Surface")).is_linked,je={name:"bsdf_begin",type:"BSDF_BEGIN",inputs:[We,B("d_color","d_color",[0,0,0],He),B("d_roughness","d_roughness",0,He),B("s_color","s_color",[0,0,0],He),B("s_roughness","s_roughness",0,He),B("metalness","metalness",0,He),B("normal","normal",[0,0,0],He),B("ior","ior",0,He),B("transmission","transmission",0,He),B("e_color","e_color",[0,0,0],He),B("emission","emission",0,He),B("a_color","a_color",[0,0,0],He),B("alpha","alpha",0,He)],outputs:[B("E","E",[0,0,0],!0),B("A","A",[0,0,0],!0),B("D","D",[0,0,0],!0),B("S","S",[0,0,0],!0),B("normal","normal",[0,0,0],!0),B("bsdf_params","bsdf_params",[0,0,0,0],!0),B("refract_params","refract_params",[0,0,0,0],!0),B("shadow_factor","shadow_factor",0,!0),B("d_color","d_color",[0,0,0],!0),B("s_color","s_color",[0,0,0],!0),B("e_color","e_color",[0,0,0],!0),B("emission","emission",0,!0),B("a_color","a_color",[0,0,0],!0),B("alpha","alpha",0,!0)],params:[],data:null,dirs:[],vparams:[]},ze={name:"bsdf_end",type:"BSDF_END",inputs:[B("color","color",[0,0,0],!0),B("specular","specular",[0,0,0],!0),B("normal","normal",[0,0,0],!0),B("bsdf_params","bsdf_params",[0,0,0,0],!0),B("refract_params","refract_params",[0,0,0,0],!0),B("d_color","d_color",[0,0,0],!0),B("s_color","s_color",[0,0,0],!0),B("e_color","e_color",[0,0,0],!0),B("emission","emission",0,!0),B("a_color","a_color",[0,0,0],!0),B("alpha","alpha",0,!0)],outputs:[B("color","color",[0,0,0],He),B("alpha","alpha",1,He)],params:[],data:null,dirs:[],vparams:[]},Qe={name:"output_surface",type:"OUTPUT_SURFACE",inputs:[We,B("alpha","alpha",1,He)],outputs:[],params:[],data:{value:{bsdf_shader:"BSDF_COMPUTE"},bsdf_begin:je,bsdf_end:ze},dirs:[],vparams:[]},Ve=[B("Height","Height",0,!0)],qe=[B("Normal","Normal",[0,0,0],!1)];g={name:t.name,output_surface:Qe,displacement_bump:{name:"displacement_bump",type:"DISPLACEMENT_BUMP",inputs:Ve,outputs:qe,params:[],data:null,dirs:[],vparams:[]}};break;case"OUTPUT_WORLD":h=H(t),v=j(t);var We=F(t,"Surface");g={name:t.name,output_world_surface:Qe={name:"output_world_surface",type:"OUTPUT_WORLD_SURFACE",inputs:[We],outputs:[],params:[],data:null,dirs:[],vparams:[]}};break;case"RGB":m.push({name:"-1",value:t.name}),v.push(G(t,"Color"));break;case"SEPRGB":case"SEPHSV":h=H(t),v=j(t);break;case"TEX_ENVIRONMENT":(Je=t.image)?(S="TEXTURE_ENVIRONMENT_"+t.projection,R.push("NONE"==t.color_space?["NON_COLOR",1]:["NON_COLOR",0]),h.push(F(t,"Vector")),R.push(["USE_VECTOR_IN",0|h[0].is_linked]),v.push(G(t,"Color")),ie=k("param_TEXTURE_texture"),m.push(z(ie)),(ot=s.create_texture(s.TT_RGBA_INT,!1)).repeat=!0,ot.source="IMAGE",T.anisotropic_available&&(ot.anisotropic_filtering=16),s.append_img_info(ot,Je),g={bpy_name:t.name,bpy_uuid:"",name:ie,value:ot}):S="TEXTURE_EMPTY";break;case"TEX_IMAGE":var Je;if(Je=t.image){S="TEXTURE_COLOR",R.push("NONE"==t.color_space?["NON_COLOR",1]:["NON_COLOR",0]),R.push(["CONVERT_UV",0]);for(var Ze=0;Ze<4;++Ze)Ze?(tt=B("Vector"+Ze,"Vector"+Ze,[0,0,0],!1),rt=B("Color"+Ze,"Color"+Ze,[0,0,0],!1),nt=B("Alpha"+Ze,"Alpha"+Ze,0,!1)):(tt=F(t,"Vector"),rt=G(t,"Color"),nt=G(t,"Alpha")),h.push(tt),v.push(rt),v.push(nt);ie=k("param_TEXTURE_texture"),m.push(z(ie)),(ot=s.create_texture(s.TT_RGBA_INT,!1)).repeat="REPEAT"==t.extension,ot.source="IMAGE",s.append_img_info(ot,Je),g={bpy_name:t.name,bpy_uuid:"",name:ie,value:ot}}else S="TEXTURE_EMPTY";break;case"TEXTURE":if("TEXTURE_EMPTY"==(S=function(e){if(!e.texture||!e.texture._render)return"TEXTURE_EMPTY";for(var t=e.outputs,n=!1,a=!1,o=!1,i=0;i<t.length;i++){var s=t[i];if(s.is_linked)switch(s.identifier){case"Color":n=!0;break;case"Normal":a=!0;break;case"Value":o=!0;break;default:r.panic("Unknown texture output")}}return n?(a&&_.warn('Node "'+e.name+'" has both Color and Normal outputs. Normal will be omitted.'),"ENVIRONMENT_MAP"==e.texture.type?"TEXTURE_ENVIRONMENT_CUBE":"TEXTURE_COLOR"):a?"TEXTURE_NORMAL":o?"ENVIRONMENT_MAP"==e.texture.type?"TEXTURE_ENVIRONMENT_CUBE":"TEXTURE_COLOR":void 0}(t)))v.push(G(t,"Color")),v.push(G(t,"Normal")),v.push(G(t,"Value"));else if("TEXTURE_ENVIRONMENT_CUBE"==S)h.push(F(t,"Vector")),v.push(G(t,"Color")),v.push(G(t,"Value"));else{if("TEXTURE_NORMAL"==S&&"ENVIRONMENT_MAP"==t.texture.type)return _.error("Wrong output for ENVIRONMENT_MAP texture: "+t.name),null;if("TEXTURE_COLOR"==S){var $e=!1,et=t.texture.image;!et||"Non-Color"!=et.colorspace_settings_name&&"Non-Colour Data"!=et.colorspace_settings_name||($e=!0),R.push(["NON_COLOR",Number($e)]),R.push(["CONVERT_UV",1])}for(Ze=0;Ze<4;++Ze){var tt,rt,nt,at="TEXTURE_COLOR"==S?"Color":"Normal";Ze?(tt=B("Vector"+Ze,"Vector"+Ze,[0,0,0],!1),rt=B(at+Ze,at+Ze,[0,0,0],!1),nt=B("Value"+Ze,"Value"+Ze,0,!1)):(tt=F(t,"Vector"),rt=G(t,at),nt=G(t,"Value")),h.push(tt),v.push(rt),v.push(nt)}}var ot;"TEXTURE_EMPTY"!=S&&(ie=k("param_TEXTURE_texture"),m.push(z(ie)),g={bpy_name:t.texture.name,bpy_uuid:t.texture.uuid,name:ie,value:ot=t.texture._render});break;case"VALTORGB":h=H(t),v=j(t),g={value:t};var _t=t.color_ramp.interpolation;"CONSTANT"!=_t&&"LINEAR"!=_t&&_.warn("Color Ramp node is not fully supported.");break;case"VALUE":S="VALUE",m.push({name:"-1",value:t.name}),v.push(G(t,"Value"));break;case"VECT_MATH":switch(t.operation){case"ADD":S="VECT_MATH_ADD";break;case"SUBTRACT":S="VECT_MATH_SUBTRACT";break;case"AVERAGE":S="VECT_MATH_AVERAGE";break;case"DOT_PRODUCT":S="VECT_MATH_DOT_PRODUCT";break;case"CROSS_PRODUCT":S="VECT_MATH_CROSS_PRODUCT";break;case"NORMALIZE":S="VECT_MATH_NORMALIZE";break;default:return _.error("Unsupported VECT_MATH operation: "+t.operation),null}h=H(t),v=j(t);break;case"VECT_TRANSFORM":switch(t.vector_type){case"POINT":R.push(["VECTOR_TYPE",i.glsl_value(0)]);break;case"VECTOR":R.push(["VECTOR_TYPE",i.glsl_value(1)]);break;case"NORMAL":R.push(["VECTOR_TYPE",i.glsl_value(2)]);break;default:return _.error("Unsupported VECT_TRANSFORM vector_type: "+t.vector_type),null}var it=t.convert_from,st=t.convert_to,lt=0;if("WORLD"==it)if("WORLD"==st)lt=0;else if("OBJECT"==st)lt=1;else{if("CAMERA"!=st)return _.error("Unsupported VECT_TRANSFORM convert_to: "+t.convert_to),null;lt=2}else if("OBJECT"==it)if("WORLD"==st)lt=3;else if("OBJECT"==st)lt=4;else{if("CAMERA"!=st)return _.error("Unsupported VECT_TRANSFORM convert_to: "+t.convert_to),null;lt=5}else{if("CAMERA"!=it)return _.error("Unsupported VECT_TRANSFORM convert_from: "+t.convert_from),null;if("WORLD"==st)lt=6;else if("OBJECT"==st)lt=7;else{if("CAMERA"!=st)return _.error("Unsupported VECT_TRANSFORM convert_to: "+t.convert_to),null;lt=8}}R.push(["CONVERT_TYPE",i.glsl_value(lt)]),h=H(t),v=j(t);break;case"NORMAL_MAP":var ct=0;switch(t.space){case"TANGENT":ct=0;break;case"OBJECT":ct=1;break;case"WORLD":ct=2;break;case"BLENDER_OBJECT":ct=3;break;case"BLENDER_WORLD":ct=4;break;default:return _.error("Unsupported NORMAL_MAP space: "+t.space),null}R.push(["SPACE",i.glsl_value(ct)]),h.push(F(t,"Strength")),h.push(F(t,"Color")),h.push(B("Normal","Normal",[0,0,0],!1)),R.push(["USE_NORMAL_IN",0]),v.push(G(t,"Normal"));break;case"FRESNEL":var Et=F(t,"Normal");h.push(F(t,"IOR")),h.push(Et),v.push(G(t,"Fac")),R.push(["USE_FRESNEL_NORMAL",0|Et.is_linked]);break;case"LAYER_WEIGHT":Et=F(t,"Normal"),h.push(F(t,"Blend")),h.push(Et),v=j(t),R.push(["USE_NORMAL_IN",0|Et.is_linked]);break;case"BUMP":Et=F(t,"Normal"),R.push(["INVERT",t.invert?1:0]),R.push(["USE_NORMAL_IN",0|Et.is_linked]),h=H(t),v=j(t);break;case"BACKGROUND":default:h=H(t),v=j(t)}var ut={name:p,origin_name:P,type:S,vparams:A,inputs:h,outputs:v,params:m,data:g,dirs:R},dt=o.gen_node_id(e);return o.append_node(e,dt,ut),"GEOMETRY"!=t.type&&"TEX_COORD"!=t.type&&"NEW_GEOMETRY"!=t.type||!function(e,t){for(var r=e.outputs,n=0,a=0;a<r.length;a++)if(r[a].is_linked&&n++>t)return!0;return!1}(t,n)||null!=x(e,t,++n,a,l,c)?dt:null}function C(e,t,r){for(var n=e.inputs,a=e.outputs,o=e.node_tree_name,i=0;i<t.length;i++){var s=n[i];if(!s||s.default_value instanceof Array!=t[i])return _.warn('Wrong inputs for custom node group "'+e.name+'" of type: "',o,'".Processing as general node group.'),!1}for(i=0;i<r.length;i++){var l=a[i];if(!l||l.default_value instanceof Array!=r[i])return _.warn('Wrong outputs for custom node group "'+e.name+'" of type: "',o,'".Processing as general node group.'),!1}return!0}function w(e,t,r,a){var o=function(e){var t={};for(var r in e)if("links"==r||"nodes"==r){t[r]=[];for(var n=0;n<e[r].length;n++)for(var a in t[r][n]={},e[r][n])if("links"==r)for(var o in t[r][n][a]={},e[r][n][a])t[r][n][a][o]=U(e[r][n][a][o]);else t[r][n][a]=U(e[r][n][a])}else t[r]=U(e[r]);return t}(e.node_group.node_tree),_=e.node_tree_name;if("B4W_REPLACE"==_||"B4W_LEVELS_OF_QUALITY"==_){var i,s=Y("Group input","GROUP_INPUT",[],e.inputs),l=Y("Group output","GROUP_OUTPUT",e.outputs,[]);i={from_node:s,from_socket:"B4W_REPLACE"==_||"B4W_LEVELS_OF_QUALITY"==_&&(T.quality==n.P_LOW||T.force_low_quality_nodes)?s.outputs[1]:s.outputs[0],to_node:l,to_socket:l.inputs[0]},o.nodes=[s,l],o.links=[i]}return function(e,t){for(var r=t.nodes,n=t.links,a=0;a<r.length;a++)r[a].name=J(r[a].type,e,r[a].name);for(a=0;a<n.length;a++)n[a].from_node.name=J(n[a].from_node.type,e,n[a].from_node.name),n[a].to_node.name=J(n[a].to_node.type,e,n[a].to_node.name)}(e.name,o),{node_group_graph:f(o,e.node_group.uuid,!0,t,r,a).graph,node_group_links:o.links}}function U(e){var t=typeof e;return"string"!=t&&"number"!=t&&"boolean"!=t&&e?cO(e):e}function k(e){l[e]||(l[e]=0);var t=e+"_"+l[e];return t=t.replace(/ /g,"_").replace(/\//g,"_"),l[e]++,t}function D(e){for(var t=e.outputs,r=0;r<t.length;r++)if(t[r].is_linked)return!0;return!1}function F(e,t){for(var r=e.inputs,n=0;n<r.length;n++){var a=r[n];if(a.identifier==t)return K(a)}return null}function G(e,t){for(var r=e.outputs,n=0;n<r.length;n++){var a=r[n];if(a.identifier==t)return K(a)}return null}function K(e){return{name:e.name,identifier:e.identifier,is_linked:e.is_linked,default_value:(t=e.default_value,DO(t)?t.slice(0):t)};var t}function B(e,t,r,n){return{name:e,identifier:t,is_linked:n,default_value:r}}function X(e){return B(e.name,e.identifier,e.default_value,e.is_linked)}function H(e){for(var t=[],r=0;r<e.inputs.length;r++){var n=K(e.inputs[r]);n.default_value.length&&n.default_value.splice(3),t.push(n)}return t}function j(e){for(var t=[],r=0;r<e.outputs.length;r++){var n=K(e.outputs[r]);t.push(n)}return t}function z(e,t,r){if(null==t)var n=null;else n=i.glsl_value(t,r);return{name:e,value:n}}function Q(e){return{name:e.name,value:e.value}}function V(e){return e.slice()}function q(e,t,r,n,a,_){for(var i=[],s=_.from_socket.identifier,l=_.to_socket.identifier,c=n.outputs,E=0;E<c.length;E++)if(c[E].identifier==s){i.push(E);break}var u=a.inputs;for(E=0;E<u.length;E++)if(u[E].identifier==l){i.push(E);break}return 2==i.length&&o.append_edge(e,t,r,i),!0}function W(e){return e.replace(/\./g,"")}function J(e,t,r){return"GROUP_INPUT"==e?t+"*GI*"+r:"GROUP_OUTPUT"==e?t+"*GO*"+r:t+"%join%"+r}function Z(e,t,r,n,a,o){switch(e.type){case"GROUP":e.name==t&&n.push(r);break;case"GROUP_INPUT":e.name.indexOf(t+"*GI*")||a.push(r);break;case"GROUP_OUTPUT":e.name.indexOf(t+"*GO*")||o.push(r)}}function $(e,t,r){for(var n=[],a=0;a<r.length;a++){for(var o=r[a],_=null,i=0;i<t.length;i++)if(o.from_socket.identifier==t[i].to_socket.identifier){_=t[i];break}_?(o.from_node=_.from_node,o.from_socket=_.from_socket):n.push(o)}for(a=0;a<t.length;a++)e.splice(e.indexOf(t[a]),1);return n}function ee(e,t,r){for(var n,a=O(e.to_node,t),_=0;_<a.length;_++)for(var i=o.get_node_attr(t,a[_]),s=0;s<i.inputs.length;s++){var l=i.inputs[s];if(l.identifier==e.to_socket.identifier){var c=re(l.default_value);if(re(r)==c)l.default_value=r;else switch(c){case 0:ne(r,l.default_value);break;case 1:l.default_value=((n=r)[0]+n[1]+n[2])/3}break}}}function te(e,t,r,n){for(var a=0;a<n.length;a++){for(var o,_=n[a],i=0;i<r.inputs.length;i++)if(_.from_socket.identifier==r.inputs[i].identifier){o=r.inputs[i].default_value;break}ee(_,t,o);var s=e.indexOf(_);-1!=s&&e.splice(s,1)}}function re(e){return e instanceof Object?0:1}function ne(e,t){return t[0]=t[1]=t[2]=e,t}function ae(e,t,r){for(var n=e.name,a=[],_=[],i=[],s=[],l=0;l<t.length;l++){var c=t[l];Z(c.from_node,n,c,a,i,s),Z(c.to_node,n,c,_,i,s)}var E,u=$(t,_,i),d=$(t,s,a);(function(e,t){if(t.length)for(var r=t[0].from_node.name,n=0;n<e.length;n++)e[n].from_node.name==r&&t.push(e[n])})(t,u),te(t,r,e,u),d.length&&(o.traverse(r,(function(e,t){"GROUP_OUTPUT"!=t.type||t.name.indexOf(n+"*GO*")||(E=t)})),te(t,r,E,d))}function oe(e,t,r,n){var a=e.curve_mapping.curves_data[t];return!(2==a.length&&a[0][0]<r+.01&&a[0][1]<r+.01&&a[1][0]>n-.01&&a[1][1]>n-.01)}t.VT_WORLD_TO_WORLD=0,t.VT_WORLD_TO_OBJECT=1,t.VT_WORLD_TO_CAMERA=2,t.VT_OBJECT_TO_WORLD=3,t.VT_OBJECT_TO_OBJECT=4,t.VT_OBJECT_TO_CAMERA=5,t.VT_CAMERA_TO_WORLD=6,t.VT_CAMERA_TO_OBJECT=7,t.VT_CAMERA_TO_CAMERA=8,t.NM_TANGENT=0,t.NM_OBJECT=1,t.NM_WORLD=2,t.NM_BLENDER_OBJECT=3,t.NM_BLENDER_WORLD=4,t.get_ngraph_proxy_cached=function(e){return c[e]},t.cleanup_ngraph_proxy=function(e){delete c[e]},t.compose_ngraph_proxy=function(e,t,r,n,a,o,_,i){return f(e,t,r,o,_,i)},t.create_lighting_graph=function(e,t,r){if(e in E)return E[e];var n=o.create(),a={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},_=x(n,a,0,null,null,r);return p(n,t,_,x(n,a={name:"LIGHTING_END",type:"LIGHTING_END"},0,null,null,r),[[_,[8,10]],[_,[9,6]]],r),m(n),E[e]=n,n},t.generate_graph_id=function(e,t,r,n){switch(e+=r,t){case"GLOW":e+="11";case"COLOR_ID":case"SHADOW":e+="00";default:e+="10"}return n&&n.vc_name&&(e+=n.vc_name),n&&n.uv_name&&(e+=n.uv_name),e},t.compose_node_elements=function(e){var t=[],r={};l={};var n=o.topsort(e);return o.traverse(n,(function(e,n){var a=function(e){for(var t=[],r=[],n=[],a=[],o=[],_=[],s=0;s<e.inputs.length;s++){var l=e.inputs[s];if(l.is_linked)t.push(null),r.push(null);else{t.push(k("in_"+e.type+"_"+W(l.identifier)));var c=i.glsl_value(l.default_value,0);T.shader_constants_hack&&(e.type.indexOf("MIX_RGB_")>=0&&("Color1"==l.identifier||"Color2"==l.identifier||"Fac"==l.identifier)||e.type.indexOf("MATH_")>=0&&("Value"==l.identifier||"Value_001"==l.identifier||"Value.001"==l.identifier)||e.type.indexOf("VECT_MATH_")>=0&&("Vector_001"==l.identifier||"Vector.001"==l.identifier)||e.type.indexOf("LIGHTING_APPLY")>=0||e.type.indexOf("MATERIAL_END")>=0||e.type.indexOf("MATERIAL_BEGIN")>=0)&&(c=c.replace(/(,)/g,"$1 ").replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,"$1_0_0$3").replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1_1_0$3").replace(/\s+/g,"")),r.push(c)}}for(s=0;s<e.outputs.length;s++){var E=e.outputs[s];n.push(E.is_linked?null:k("out_"+e.type+"_"+W(E.identifier)))}for(s=0;s<e.params.length;s++){var u=e.params[s];a.push(u.name),o.push(u.value)}for(s=0;s<e.vparams.length;s++)_.push(e.vparams[s].name);return{id:e.type,inputs:t,input_values:r,outputs:n,params:a,param_values:o,vparams:_,dirs:JSON.parse(JSON.stringify(e.dirs))}}(n);t.push(a),r[e]=a})),o.traverse_edges(n,(function(e,t,a){var _=o.get_node_attr(n,e),i=r[e].outputs,s=r[t].inputs,l=i[a[0]]||k("out_"+_.type+"_"+W(_.outputs[a[0]].identifier));i[a[0]]=l,s[a[1]]=l})),t},t.check_material_glow_output=function(e){if(e.node_tree)for(var t=0;t<e.node_tree.nodes.length;t++){var r=e.node_tree.nodes[t];if("GROUP"==r.type&&"B4W_GLOW_OUTPUT"==r.node_tree_name)return!0}return!1},t.print_node_graph=function(e,t,r){_.log("\n====== USER: "+t+", MATERIAL: "+r+" ======\n"+a.nodegraph_to_dot(e,!0)+"\n=============================================================")},t.cleanup=function(){for(var e in c)delete c[e];for(var e in E)delete E[e];for(var t in u)delete u[t];d=0},t.get_max_env_texture_height=function(e){var t=-1;return o.traverse(e,(function(e,r){"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR"!=r.type&&"TEXTURE_ENVIRONMENT_MIRROR_BALL"!=r.type||(t=Math.max(t,r.data.value.height))})),t}})),JI=nA("__batch",(function(e,t){var r=gN(e),n=dR(e),a=TR(e),o=mN(e),_=fR(e),i=pR(e),s=WI(e),l=PI(e),c=SI(e),E=II(e),u=tI(e),d=bI(e),T=LI(e),f=qI(e),p=mR(e),P=XI(e),S=VR(e),A=n.defaults,h=n.context_limits,v=n.scenes,m=n.hmd_params,g=new Float32Array([0,0,-Math.sqrt(.5),Math.sqrt(.5)]),O=new Float32Array(3),N=new Float32Array(3),R=new Float32Array(3),I=new Float32Array(4),b=dm(),y=wm(),L=oA(),Y={},M=new Float32Array(24),x=[5,4];function C(e){var t={type:e,subtype:"",id:0,data_id:0,cluster_id:-1,odd_id_prop:"",debug_id_color:-1,debug_main_batch_id:-1,debug_main_batch_render_time:0,debug_render_time:0,debug_render_time_queries:[],textures:[],texture_names:[],bpy_tex_names:[],material_names:[],common_attributes:[],uv_maps_usage:null,vertex_colors_usage:{},shader:null,shaders_info:f.init_shaders_info(),ngraph_proxy_id:"",attribute_setters:[],bufs_data:null,vaos:EN(),use_shape_keys:!1,debug_sphere:!1,debug_sphere_dynamic:!1,num_vertices:0,num_triangles:0,jitter_amp:0,jitter_freq:0,dynamic_grass:!1,grass_scale_threshold:0,grass_size:0,grass_map_dim:new Float32Array(3),cube_fog:new Float32Array(16),alpha_clip:!1,alpha_antialiasing:!1,blend:!1,depth_mask:!1,xray:!1,use_backface_culling:!1,use_shadeless:!1,dynamic_geometry:!1,shadow_cast:!1,shadow_cast_only:!1,shadow_receive:!1,reflexible:!1,reflexible_only:!1,reflective:!1,draw_mode:S.DM_DEFAULT,z_sort:!1,forked_batch:!1,do_not_cull:!1,caustics:!1,lod_dist_max:l.LOD_DIST_MAX_INFINITY,lod_dist_min:0,lod_lower_border_range:0,lod_upper_border_range:0,lod_settings:U(),cube_reflection_id:-1,plane_reflection_id:-1,halo:!1,halo_size:0,halo_hardness:0,halo_stars_blend:0,halo_stars_height:0,halo_rings_color:new Float32Array(3),halo_lines_color:new Float32Array(3),halo_particles:!1,ambient:0,emit:0,diffuse_intensity:1,reflect_factor:0,specular_color_factor:0,specular_alpha:1,parallax_scale:0,diffuse_color_factor:0,alpha_factor:1,normal_factor:0,mirror_factor:0,offset_z:0,refr_bump:0,diffuse_params:new Float32Array(2),specular_params:new Float32Array(3),texture_scale:new Float32Array(3),specular_color:new Float32Array(3),diffuse_color:new Float32Array(4),fresnel_params:new Float32Array(2),lamp_uuid_indexes:null,lamp_light_positions:null,lamp_light_directions:null,lamp_light_color_intensities:null,has_nodes:!1,wireframe_edge_color:ih(),water:!1,water_dynamic:!1,water_shore_smoothing:!1,water_generated_mesh:!1,water_num_cascads:0,water_subdivs:0,water_detailed_dist:0,water_norm_uv_velocity:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,foam_uv_freq:new Float32Array(2),foam_mag:new Float32Array(2),foam_scale:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),normalmap_scales:null,refractive:!1,is_sky:!1,draw_proc_sky:!1,particles_data:null,line_width:0,anchor_positions:null,part_node_data:null,node_values:[],node_value_inds:[],node_rgbs:[],node_rgb_inds:[],bounds_local:MN(),use_be:!1,submesh:null,cleanup_gl_data_on_unload:!0,inst_array_state:0,obj_info_params:new Float32Array(3),lights:[]};return t.diffuse_color[3]=1,t.depth_mask=!0,t.line_width=1,t.lod_settings.hyst_prev_state=-1,t}function w(e){var t,r,n=C(e.type);return n.subtype=e.subtype,n.id=e.id,n.cluster_id=e.cluster_id,n.odd_id_prop=e.odd_id_prop,n.debug_id_color=e.debug_id_color,n.debug_main_batch_id=e.debug_main_batch_id,n.debug_main_batch_render_time=e.debug_main_batch_render_time,n.debug_render_time=e.debug_render_time,n.debug_render_time_queries=[],n.textures=e.textures.slice(),n.texture_names=e.texture_names.slice(),n.bpy_tex_names=e.bpy_tex_names.slice(),n.material_names=e.material_names.slice(),n.common_attributes=e.common_attributes.slice(),n.uv_maps_usage=lO(e.uv_maps_usage),n.vertex_colors_usage=lO(e.vertex_colors_usage),n.shader=e.shader,n.shaders_info=f.clone_shaders_info(e.shaders_info),n.ngraph_proxy_id=e.ngraph_proxy_id,n.attribute_setters=u.clone_attribute_setters(e.attribute_setters),n.bufs_data=e.bufs_data,n.use_shape_keys=e.use_shape_keys,n.debug_sphere=e.debug_sphere,n.debug_sphere_dynamic=e.debug_sphere_dynamic,n.num_vertices=e.num_vertices,n.num_triangles=e.num_triangles,n.jitter_amp=e.jitter_amp,n.jitter_freq=e.jitter_freq,n.grass_scale_threshold=e.grass_scale_threshold,n.grass_size=e.grass_size,n.grass_map_dim=e.grass_map_dim,n.cube_fog=e.cube_fog,n.alpha_clip=e.alpha_clip,n.alpha_antialiasing=e.alpha_antialiasing,n.blend=e.blend,n.depth_mask=e.depth_mask,n.xray=e.xray,n.use_backface_culling=e.use_backface_culling,n.use_shadeless=e.use_shadeless,n.dynamic_geometry=e.dynamic_geometry,n.shadow_cast=e.shadow_cast,n.shadow_cast_only=e.shadow_cast_only,n.shadow_receive=e.shadow_receive,n.reflexible=e.reflexible,n.reflexible_only=e.reflexible_only,n.reflective=e.reflective,n.dynamic_grass=e.dynamic_grass,n.draw_mode=e.draw_mode,n.z_sort=e.z_sort,n.forked_batch=e.forked_batch,n.do_not_cull=e.do_not_cull,n.caustics=e.caustics,n.lod_dist_max=e.lod_dist_max,n.lod_dist_min=e.lod_dist_min,n.lod_lower_border_range=e.lod_lower_border_range,n.lod_upper_border_range=e.lod_upper_border_range,n.lod_settings=(t=e.lod_settings,(r=U()).use_smoothing=t.use_smoothing,r.coverage=t.coverage,r.cmp_logic=t.cmp_logic,r.dest_coverage=t.dest_coverage,r.hyst_prev_state=t.hyst_prev_state,r.hyst_interval_min=t.hyst_interval_min,r.hyst_interval_max=t.hyst_interval_max,r.prev_dist=t.prev_dist,r),n.cube_reflection_id=e.cube_reflection_id,n.plane_reflection_id=e.plane_reflection_id,n.halo=e.halo,n.halo_size=e.halo_size,n.halo_hardness=e.halo_hardness,n.halo_stars_blend=e.halo_stars_blend,n.halo_stars_height=e.halo_stars_height,ch(e.halo_rings_color,n.halo_rings_color),ch(e.halo_lines_color,n.halo_lines_color),n.halo_particles=e.halo_particles,n.ambient=e.ambient,n.emit=e.emit,n.diffuse_intensity=e.diffuse_intensity,n.reflect_factor=e.reflect_factor,n.specular_color_factor=e.specular_color_factor,n.specular_alpha=e.specular_alpha,n.parallax_scale=e.parallax_scale,n.diffuse_color_factor=e.diffuse_color_factor,n.alpha_factor=e.alpha_factor,n.normal_factor=e.normal_factor,n.mirror_factor=e.mirror_factor,n.offset_z=e.offset_z,n.refr_bump=e.refr_bump,n.diffuse_params[0]=e.diffuse_params[0],n.diffuse_params[1]=e.diffuse_params[1],ch(e.specular_params,n.specular_params),ch(e.texture_scale,n.texture_scale),ch(e.specular_color,n.specular_color),Bv(e.diffuse_color,n.diffuse_color),n.fresnel_params.set(e.fresnel_params),n.lamp_uuid_indexes=lO(e.lamp_uuid_indexes),e.lamp_light_positions&&(n.lamp_light_positions=new Float32Array(e.lamp_light_positions),n.lamp_light_directions=new Float32Array(e.lamp_light_directions),n.lamp_light_color_intensities=new Float32Array(e.lamp_light_color_intensities)),n.has_nodes=e.has_nodes,ch(e.wireframe_edge_color,n.wireframe_edge_color),n.water=e.water,n.water_dynamic=e.water_dynamic,n.water_shore_smoothing=e.water_shore_smoothing,n.water_generated_mesh=e.water_generated_mesh,n.water_num_cascads=e.water_num_cascads,n.water_subdivs=e.water_subdivs,n.water_detailed_dist=e.water_detailed_dist,n.water_norm_uv_velocity=e.water_norm_uv_velocity,n.shallow_water_col_fac=e.shallow_water_col_fac,n.shore_water_col_fac=e.shore_water_col_fac,n.foam_factor=e.foam_factor,n.foam_uv_freq.set(e.foam_uv_freq),n.foam_mag.set(e.foam_mag),n.foam_scale.set(e.foam_scale),ch(e.shallow_water_col,n.shallow_water_col),ch(e.shore_water_col,n.shore_water_col),n.normalmap_scales=lO(e.normalmap_scales),n.refractive=e.refractive,n.is_sky=e.is_sky,n.draw_proc_sky=e.draw_proc_sky,e.particles_data&&(n.particles_data=c.clone_particles_data(e.particles_data)),n.line_width=e.line_width,e.anchor_positions&&(n.anchor_positions=new Float32Array(e.anchor_positions)),n.part_node_data=lO(e.part_node_data),n.node_values=e.node_values.slice(),n.node_value_inds=e.node_value_inds.slice(),n.node_rgbs=e.node_rgbs.slice(),n.node_rgb_inds=e.node_rgb_inds.slice(),xN(e.bounds_local,n.bounds_local),n.use_be=e.use_be,n.cleanup_gl_data_on_unload=e.cleanup_gl_data_on_unload,n.obj_info_params=e.obj_info_params,n.lights=e.lights,n}function U(){var e={use_smoothing:!1,coverage:0,cmp_logic:0,dest_coverage:0,hyst_prev_state:0,hyst_interval_min:0,hyst_interval_max:0,prev_dist:0};return e.cmp_logic=1,e}function k(e){switch(e.type){case"MAIN":case"PARTICLES":case"LINE":e.subtype=e.blend?e.xray?"XRAY":"BLEND":"OPAQUE";break;case"SHADOW":e.subtype=e.shadow_cast_only?"CAST":"RECEIVE";break;case"COLOR_ID":e.subtype=e.xray?"COLOR_ID_XRAY":"COLOR_ID"}}function D(e,t,n,a){var _=[],i=e._object,s=B(n,t,!t.do_not_render,!1),l=e.data,E=i.materials,u=new Array(E.length),T=new Array(E.length),f=[],P=d.find_subs(n,p.MAIN_OPAQUE),h=!1;P&&(h=!!P.light_positions.length);for(var v=0;v<s.length;v++)for(var m=s[v],g=0;g<E.length;g++){var O=E[g];if(!Ie(i,g)&&!S.has_empty_submesh(l,g))if("PHYSICS"==m&&e.b4w_collision&&"NAVMESH"==e.game.physics_type)f.push(S.extract_submesh(l,g,[],t.bone_skinning_info,{},null));else if((!O.is_lens_flares||h)&&((R=C(m)).lights=lO(a),"MAIN"==m?u[g]=R:"DEBUG_VIEW"==m&&(T[g]=R),R.cluster_id=e.b4w_cluster_data.cluster_id,ue(R,O)&&X(R,O,l))){"SHADOW"==m&&u[g]&&(R.use_shadeless=u[g].use_shadeless),R.draw_mode=t.use_shape_keys||t.dynamic_geometry?S.DM_DYNAMIC_TRIANGLES:S.DM_DEFAULT,ne(R,t),_e(R,e.particle_systems),"DYNAMIC"!=t.type&&"COLOR_ID"!=R.type||(R.odd_id_prop=Re(R,t,e.uuid)),R.do_not_cull=e.b4w_do_not_cull,"MAIN"==R.type&&(R.caustics=e.b4w_caustics),se(R,"DISABLE_FOG",0|("COLOR_ID"!=m&&"SHADOW"!=m&&e.b4w_disable_fogging));var N=S.extract_submesh(l,g,R.common_attributes,t.bone_skinning_info,R.vertex_colors_usage,R.uv_maps_usage);O.use_tangent_shading&&!("a_shade_tangs"in N.va_frames[0])&&(se(R,"CALC_TBN",1),ie(R,"a_tbn")),O.is_lens_flares&&(N=F(N)),he(R),_.push({batch:R,obj_render:t,batch_render:t,submesh:N,mat_names:[O.name],rel_bpy_objects:[e]})}}if(f.length){var R;(R=C("PHYSICS")).subtype="NAVMESH",R.odd_id_prop=Re(R,t,e.uuid),N=S.submesh_list_join(f);var I=[];for(v=0;v<E.length;v++)I.push(E[v].name);he(R),_.push({batch:R,obj_render:t,batch_render:t,submesh:N,mat_names:I,rel_bpy_objects:[e]})}for(v=0;v<T.length;v++)T[v]&&(T[v].debug_main_batch_id=u[v].id,he(T[v]));var b=e.particle_systems;if(b.length>0){var y=!1,L=!1;for(v=0;v<b.length;v++){var Y=b[v],M=Y.settings;if(M.use_render_emitter&&_.length&&(y=!0),"HAIR"!=M.type||"OBJECT"!=M.render_type&&"GROUP"!=M.render_type&&Y.transforms.length||(L=!0),y&&L)break}if(_.length)var w=_[0];else w=function(e,t,r){var n=C("TMP");return _e(n,r),{batch:n,submesh:S.extract_submesh(e,0,n.common_attributes,t.bone_skinning_info,n.vertex_colors_usage,n.uv_maps_usage)}}(l,t,b);var U=w.batch.vertex_colors_usage;if(L)if(E.length>1)var k=function(e,t,r,n){for(var a={},o=0;o<t.length;o++){var _=t[o].settings;if("HAIR"==_.type&&("OBJECT"==_.render_type||"GROUP"==_.render_type)){var i=_.b4w_vcol_from_name;""!==i&&""!==_.b4w_vcol_to_name&&(a[i]=lO(r[i]))}}return"a_bending_col_main"in r&&(a.a_bending_col_main=lO(r.a_bending_col_main)),"a_bending_col_detail"in r&&(a.a_bending_col_detail=lO(r.a_bending_col_detail)),S.extract_submesh_all_mats(e,[],a)}(l,b,U);else k=w.submesh;else k=null;var D=function(e,t,n,a,_,i){for(var s=e._object,l=[],E=e.particle_systems,u=e.data,T=0;T<E.length;T++){var f=E[T],P=f.settings;if(P.count)if("EMITTER"==P.type){if("DYNAMIC"==t.type){var h=C("PARTICLES");h.bounds_local.bb=t.bb_local,h.bounds_local.be=t.be_local,h.bounds_local.bs=t.bs_local,h.lights=lO(i);var v=G(f,s.materials),m=s.materials[v];if(Ie(s,v))continue;if("HALO"===f.settings.render_type&&"HALO"==m.type&&(h.halo_particles=!0),!X(h,m,u))continue;ce(h,f,s),h.dynamic_geometry=!0,h.do_not_cull=e.b4w_do_not_cull,h.odd_id_prop=Re(h,t,s.name+"_"+P.uuid),c.create_particles_data(h,f,m);var g=c.generate_emitter_particles_submesh(h,u,f,s.render);c.update_particles_submesh(g,h,P.count),c.update_particles_objs_cache(s),ne(h,s.render),he(h),l.push({batch:h,obj_render:t,batch_render:t,submesh:g,mat_names:[m.name],rel_bpy_objects:[e]})}}else if("HAIR"==P.type){var O=eO(f.seed),N=-1!=_N(A.loaded_data_version,x)&&!P.b4w_initial_rand_rotation&&!P.b4w_hair_billboard,R=4;if(N&&(R=8),f.transforms.length)var I=f.transforms;else for(var b=S.geometry_random_points(_,P.count,!1,O),y=(I=new Float32Array(b.length*R),0);y<b.length;y++){var L=.75+.5*$g(O);I[y*R]=b[y][0],I[y*R+1]=b[y][1],I[y*R+2]=b[y][2],I[y*R+3]=L,N&&(I[y*R+4]=1,I[y*R+5]=0,I[y*R+6]=0,I[y*R+7]=0)}var Y=!!d.find_subs(n,p.GRASS_MAP);if("OBJECT"==P.render_type){var M=[B(n,P.dupli_object._object.render,!t.do_not_render,!0)],w=Ee(e,t,a,_,[P.dupli_object],M,[I],P,f,Y,O,!1,i);l.push.apply(l,w)}else if("GROUP"==P.render_type){var U=P.dupli_group.objects;for(M=[],y=0;y<U.length;y++){var k=B(n,U[y]._object.render,!t.do_not_render,!0);M.push(k)}var D=!1,F=[];for(y=0;y<U.length;y++)F.push(U[y]._object);if(P.use_whole_group){var K=Se(I,F,N,R);D=!0}else K=P.use_group_count?Ae(I,F,P.dupli_weights,O,N,R):Pe(I,F,O,N,R);w=Ee(e,t,a,_,U,M,K,P,f,Y,O,D,i),l.push.apply(l,w)}"INSTANCE"==P.b4w_wind_bend_inheritance&&s.render.wind_bending&&o.warn('Emitter object "'+s.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else r.panic("Unknown particle settings type")}return l}(e,t,n,U,k,a);y?_.push.apply(_,D):_=D}return _}function F(e){for(var t=e.base_length,r=e.va_frames[0].a_position,n=[],a=[],o=0;o<t;o++)a.push(r[3*o]),n.push(r[3*o+1]),a.push(r[3*o+2]);return n=new Float32Array(n),a=new Float32Array(a),e.va_common.a_lf_dist=n,e.va_common.a_lf_bb_vertex=a,e}function G(e,t){var r=e.settings.material-1;return r>=t.length&&(o.warn('Wrong material used for rendering particle system "'+e.name+'"'),r=0),r}function K(e,t){return"DYNAMIC"==e[0].type||"COLOR_ID"==t.type?e[0]:l.clone_render(e[0])}function B(e,t,r,n){var a=[];if(n||(t.selectable&&d.find_subs(e,p.COLOR_PICKING)||t.outlining&&d.find_subs(e,p.OUTLINE_MASK))&&a.push("COLOR_ID"),r&&(a.push("MAIN"),a.push("NODES_GLOW"),d.find_subs(e,p.DEBUG_VIEW)&&a.push("DEBUG_VIEW"),d.find_subs(e,p.SHADOW_RECEIVE)&&a.push("SHADOW"),d.find_subs(e,p.GRASS_MAP)&&a.push("GRASS_MAP")),a.push("PHYSICS"),t.shadow_cast_only||t.reflexible_only){var o=null;if(t.shadow_cast_only&&(o=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","DEBUG_VIEW"]),t.reflexible_only){var _=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"];o=null!==o?function(e,t){var r,n,a=[],o={},_=t.length;for(r=0;r<_;r++)o[t[r]]=!0;for(_=e.length,r=0;r<_;r++)(n=e[r])in o&&a.push(n);return a}(o,_):_}a=function(e,t){for(var r=0;r<t.length;r++){var n=e.indexOf(t[r]);-1!==n&&e.splice(n,1)}return e}(a,o)}return a}function X(e,t,n){var a;switch(e.type){case"MAIN":a=function(e,t,r){if(t.do_not_render)return!1;if(t.use_nodes&&"HALO"!=t.type)return Z(e,t,r,"MAIN"),!0;Q(e,t),e.use_backface_culling=t.use_backface_culling,e.xray=t.render_above_all&&"OPAQUE"!=t.blend_mode&&"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode,e.offset_z=t.offset_z,e.texture_scale.set([1,1,1]);var n=t.texture_slots;if(e.diffuse_color.set(t.diffuse_color),e.diffuse_color[3]=t.alpha,t.is_lens_flares){ge(e,"lens_flares.glslv","lens_flares.glslf"),ie(e,"a_position"),ie(e,"a_texcoord");var a=P.get_batch_texture(n[0]);Oe(e,a,"u_sampler",(N=n[0].texture).name)}else{if(ge(e,"main.glslv","main_stack.glslf"),!t.use_shadeless){var i={use_shadeless:t.use_shadeless,diffuse_shader:t.diffuse_shader,specular_shader:t.specular_shader,use_tangent_shading:t.use_tangent_shading},l=H(t.uuid,"MAIN"),c=s.create_lighting_graph(l,i,e.lights);e.shaders_info.node_elements=s.compose_node_elements(c)}var E=V("use_map_color_diffuse",!0,n),u=V("use_map_color_spec",!0,n),d=V("use_map_normal",!0,n),T=V("use_map_mirror",!0,n),p=V("use_stencil",!0,n),S=E[0],h=u[0],v=d[0],m=T[0],g=E[1],O=p[0]&&V("use_rgb_to_intensity",!0,n)[0];if(S){var N=S.texture;switch(S.blend_type){case"MIX":se(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":se(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}Oe(e,a=P.get_batch_texture(S),"u_colormap0",N.name),e.diffuse_color_factor=S.diffuse_color_factor,e.alpha_factor=S.use_map_alpha?S.alpha_factor:0,e.texture_scale.set(S.scale)}var R=S&&S==h;if(h&&(R||(N=h.texture,Oe(e,a=P.get_batch_texture(h),"u_specmap0",N.name)),e.specular_color_factor=h.specular_color_factor),v&&(N=v.texture,ie(e,"a_tbn"),Oe(e,a=P.get_batch_texture(v),"u_normalmap0",N.name),e.normal_factor=v.normal_factor,N.b4w_use_map_parallax&&A.parallax)){var I=f.glsl_value(N.b4w_parallax_steps),b=f.glsl_value(N.b4w_parallax_lod_dist);se(e,"PARALLAX",1),se(e,"PARALLAX_STEPS",I),se(e,"PARALLAX_LOD_DIST",b),e.parallax_scale=N.b4w_parallax_scale}m&&(N=m.texture,Oe(e,a=P.get_batch_texture(m),"u_mirrormap",N.name),e.mirror_factor=m.mirror_factor);var y=S&&g&&O?1:0;y&&(Oe(e,a=P.get_batch_texture(g),"u_colormap1",(N=g.texture).name),Oe(e,a=P.get_batch_texture(O),"u_stencil0",(N=O.texture).name));var L=S||h||v;L&&e.texture_scale.set(L.scale),se(e,"TEXTURE_SPEC",null==h?0:1),se(e,"ALPHA_AS_SPEC",R?1:0),se(e,"TEXTURE_STENCIL_ALPHA_MASK",y),ie(e,"a_position"),ie(e,"a_tbn"),(S||h||v)&&ie(e,"a_texcoord"),t.water_settings.is_water&&function(e,t){t.water=!0,t.water_dynamic=e.water_settings.is_dynamic,e.water_settings.shore_smoothing&&!t.blend?(o.warn('Material: "'+e.name+'" is opaque.',"Disabling water shore smoothing."),t.water_shore_smoothing=!1):t.water_shore_smoothing="REFLECT"!=t.subtype&&e.water_settings.shore_smoothing,ge(t,"water.glslv","water.glslf");var r={use_shadeless:!1,diffuse_shader:e.diffuse_shader,specular_shader:e.specular_shader,use_tangent_shading:e.use_tangent_shading},n=H(e.uuid),a=s.create_lighting_graph(n,r,t.lights);t.shaders_info.node_elements=s.compose_node_elements(a),ie(t,"a_position"),A.water_wireframe_debug?(ie(t,"a_polyindex"),t.depth_mask=!0,Eh(0,0,0,t.wireframe_edge_color),_.get_standard_derivatives()?se(t,"DEBUG_WIREFRAME",1):se(t,"DEBUG_WIREFRAME",2)):se(t,"DEBUG_WIREFRAME",0);var i=e.texture_slots,l=V("use_map_normal",!0,i),c=V("use_map_mirror",!0,i)[0];l.length&&(Oe(t,P.get_batch_texture(l[0]),"u_normalmap0",(p=l[0].texture).name),t.water_norm_uv_velocity=e.water_settings.norm_uv_velocity),se(t,"NUM_NORMALMAPS",l.length),t.normalmap_scales=new Array(l.length);for(var E=0;E<l.length;E++)t.normalmap_scales[E]=new Float32Array(2),t.normalmap_scales[E].set([l[E].scale[0],l[E].scale[1]]);c&&(Oe(t,P.get_batch_texture(c),"u_mirrormap",(p=c.texture).name),t.mirror_factor=c.mirror_factor);var u=null;if(A.foam)for(E=0;E<i.length;E++)if(!0===(d=i[E]).texture.b4w_water_foam){u=d;break}for(u&&(se(t,"FOAM",1),Oe(t,P.get_batch_texture(u),"u_foam",(p=u.texture).name),t.foam_factor=e.water_settings.foam_factor,t.foam_uv_freq.set(p.b4w_foam_uv_freq),t.foam_mag.set(p.b4w_foam_uv_magnitude),t.foam_scale[0]=u.scale[0],t.foam_scale[1]=u.scale[1]),E=0;E<i.length;E++){var d;if(!0===(d=i[E]).texture.b4w_shore_dist_map){var T=d;break}}if(T&&A.allow_vertex_textures){var p;Oe(t,P.get_batch_texture(T),"u_shore_dist_map",(p=T.texture).name),se(t,"SHORE_PARAMS",1);var S=d.texture.b4w_shore_boundings;se(t,"MAX_SHORE_DIST",f.glsl_value(d.texture.b4w_max_shore_dist)),se(t,"SHORE_MAP_SIZE_X",f.glsl_value(S[0]-S[1])),se(t,"SHORE_MAP_SIZE_Y",f.glsl_value(S[2]-S[3])),se(t,"SHORE_MAP_CENTER_X",f.glsl_value((S[0]+S[1])/2)),se(t,"SHORE_MAP_CENTER_Y",f.glsl_value((S[2]+S[3])/2))}if(e.water_settings.is_generated_mesh?(se(t,"GENERATED_MESH",1),t.water_generated_mesh=!0,t.water_num_cascads=e.water_settings.num_cascads,t.water_subdivs=e.water_settings.num_subdivs,t.water_detailed_dist=e.water_settings.detailed_dist):(ie(t,"a_tbn"),(u||l.length)&&ie(t,"a_texcoord"),se(t,"GENERATED_MESH",0)),e.water_settings.is_dynamic){var h=f.glsl_value(e.water_settings.dst_noise_scale0),v=f.glsl_value(e.water_settings.dst_noise_scale1),m=f.glsl_value(e.water_settings.dst_noise_freq0),g=f.glsl_value(e.water_settings.dst_noise_freq1),O=f.glsl_value(e.water_settings.dir_min_shore_fac),N=f.glsl_value(e.water_settings.dir_freq),R=f.glsl_value(e.water_settings.dir_noise_scale),I=f.glsl_value(e.water_settings.dir_noise_freq),b=f.glsl_value(e.water_settings.dir_min_noise_fac),y=f.glsl_value(e.water_settings.dst_min_fac),L=f.glsl_value(e.water_settings.waves_hor_fac);se(t,"DST_NOISE_SCALE_0",h),se(t,"DST_NOISE_SCALE_1",v),se(t,"DST_NOISE_FREQ_0",m),se(t,"DST_NOISE_FREQ_1",g),se(t,"DIR_MIN_SHR_FAC",O),se(t,"DIR_FREQ",N),se(t,"DIR_NOISE_SCALE",R),se(t,"DIR_NOISE_FREQ",I),se(t,"DIR_MIN_NOISE_FAC",b),se(t,"DST_MIN_FAC",y),se(t,"WAVES_HOR_FAC",L)}W(t,e),J(t,e),t.shallow_water_col.set(e.water_settings.shallow_col),t.shore_water_col.set(e.water_settings.shore_col),t.shallow_water_col_fac=e.water_settings.shallow_col_fac,t.shore_water_col_fac=e.water_settings.shore_col_fac,se(t,"ABSORB",f.glsl_value(e.water_settings.absorb_factor)),se(t,"SSS_STRENGTH",f.glsl_value(e.water_settings.sss_strength)),se(t,"SSS_WIDTH",f.glsl_value(e.water_settings.sss_width))}(t,e),"HALO"===t.type&&(ge(e,"halo.glslv","halo.glslf"),j(e,t),e.common_attributes=["a_position"]),t.use_tangent_shading&&(se(e,"USE_TBN_SHADING",1),ie(e,"a_shade_tangs")),se(e,"TEXCOORD",0),se(e,"NORMAL_TEXCOORD",0),S&&z(e,S,"TEXTURE_COLOR0_CO"),g&&z(e,g,"TEXTURE_COLOR1_CO"),O&&z(e,O,"TEXTURE_STENCIL_ALPHA_MASK_CO"),h&&z(e,h,"TEXTURE_SPEC_CO"),v&&z(e,v,"TEXTURE_NORM_CO"),se(e,"SHADELESS",t.use_shadeless?1:0),e.use_shadeless=t.use_shadeless}return se(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),se(e,"ALPHA_CLIP","CLIP"===t.blend_mode?1:0),se(e,"DOUBLE_SIDED_LIGHTING",t.use_double_sided_lighting?1:0),t.use_vertex_color_paint?(se(e,"VERTEX_COLOR",1),ie(e,"a_color")):se(e,"VERTEX_COLOR",0),e.ambient=t.ambient,e.diffuse_intensity=t.diffuse_intensity,e.emit=t.emit,e.specular_color.set(t.specular_color),e.specular_alpha=t.specular_alpha,W(e,t),J(e,t),se(e,"WETTABLE",t.is_wettable?1:0),q(e,t),t.is_refractive&&!e.blend?(o.warn('Material "'+t.name+'" is not blend. Disabling refractions.'),e.refractive=!1):e.refractive=t.is_refractive,e.refr_bump=t.refr_bump,!0}(e,t,n);break;case"NODES_GLOW":a=Z(e,t,n,"GLOW");break;case"SHADOW":a=function(e,t,r){if(t.is_lens_flares||t.water_settings.is_water||t.do_not_render||"HALO"==t.type)return!1;if(Q(e,t),e.use_backface_culling=t.use_backface_culling,e.blend)return!1;!t.use_nodes||"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode?ge(e,"shadow.glslv","shadow.glslf"):Z(e,t,r,"SHADOW"),e.depth_mask=e.depth_mask&&!(A.reuse_depth_optimization&&"ALPHA_ANTIALIASING"==t.blend_mode),Xv(0,0,0,t.alpha,e.diffuse_color),ie(e,"a_position"),ie(e,"a_tbn"),se(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),e.texture_scale.set([1,1,1]);var n=V("use_map_color_diffuse",!0,t.texture_slots)[0];if(!n||"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode)se(e,"TEXTURE_COLOR",0);else{switch(n.blend_type){case"MIX":se(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":se(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e.texture_scale.set(n.scale),se(e,"TEXTURE_COLOR",1),ie(e,"a_texcoord");var a=P.get_batch_texture(n);"IMAGE"!=a.source&&"ENVIRONMENT_MAP"!=a.source&&"CANVAS"!=a.source&&"NONE"!=a.source||Oe(e,a,"u_colormap0",n.texture.name)}return!0}(e,t,n);break;case"PHYSICS":a=function(e,t){var r=t.physics_settings,n=t.water_settings;return r.use_coll_physics?(e.use_ghost=r.use_ghost,e.collision_id=r.collision_id,e.collision_margin=r.collision_margin,e.collision_group=r.collision_group,e.collision_mask=r.collision_mask,e.friction=r.friction,e.elasticity=r.elasticity,!0):!!n.is_water&&(e.water=!0,e.water_dynamics=n.is_dynamic,e.dst_noise_scale0=n.dst_noise_scale0,e.dst_noise_scale1=n.dst_noise_scale1,e.dst_noise_freq0=n.dst_noise_freq0,e.dst_noise_freq1=n.dst_noise_freq1,e.dir_min_shore_fac=n.dir_min_shore_fac,e.dir_freq=n.dir_freq,e.dir_noise_scale=n.dir_noise_scale,e.dir_noise_freq=n.dir_noise_freq,e.dir_min_noise_fac=n.dir_min_noise_fac,e.dst_min_fac=n.dst_min_fac,e.waves_hor_fac=n.waves_hor_fac,!0)}(e,t);break;case"COLOR_ID":a=function(e,t,r){if(t.is_lens_flares||"HALO"==t.type)return!1;var n=t.blend_mode,a=n;"ALPHA_ANTIALIASING"==a&&(a="CLIP",t.blend_mode="CLIP"),Q(e,t),e.use_backface_culling=t.use_backface_culling,e.z_sort=!1,e.depth_mask=!0,e.blend=!1,e.xray=t.render_above_all&&"OPAQUE"!=a&&"CLIP"!=a,t.use_nodes&&"CLIP"==a?Z(e,t,r,"COLOR_ID"):ge(e,"color_id.glslv","color_id.glslf"),Xv(0,0,0,t.alpha,e.diffuse_color),ie(e,"a_position"),se(e,"ALPHA","OPAQUE"===a?0:1),e.texture_scale.set([1,1,1]);var o=V("use_map_color_diffuse",!0,t.texture_slots)[0];if(se(e,"ALPHA_CLIP","CLIP"===a?1:0),o&&"CLIP"==a){switch(o.blend_type){case"MIX":se(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":se(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e.texture_scale.set(o.scale),se(e,"TEXTURE_COLOR",1),ie(e,"a_texcoord");var _=P.get_batch_texture(o);"IMAGE"!=_.source&&"ENVIRONMENT_MAP"!=_.source&&"CANVAS"!=_.source&&"NONE"!=_.source||Oe(e,_,"u_colormap0",o.texture.name)}else se(e,"TEXTURE_COLOR",0);return t.blend_mode=n,!0}(e,t,n);break;case"GRASS_MAP":a=function(e,t){if(!t.terrain_settings.is_terrain||t.do_not_render)return!1;if(Q(e,t),e.use_backface_culling=t.use_backface_culling,e.blend=!1,e.z_sort=!1,e.depth_mask=!0,ge(e,"grass_map.glslv","grass_map.glslf"),ie(e,"a_position"),t.terrain_settings.dynamic_grass_size)var r=t.terrain_settings.dynamic_grass_size;else r=null;if(t.terrain_settings.dynamic_grass_color)var n=t.terrain_settings.dynamic_grass_color;else n=null;return e.vertex_colors_usage.a_grass_size={generate_buffer:!0,src:[]},r?(e.vertex_colors_usage.a_grass_size.src.push({name:r,mask:4}),se(e,"DYNAMIC_GRASS_SIZE",1)):se(e,"DYNAMIC_GRASS_SIZE",0),e.vertex_colors_usage.a_grass_color={generate_buffer:!0,src:[]},n?(e.vertex_colors_usage.a_grass_color.src.push({name:n,mask:7}),se(e,"DYNAMIC_GRASS_COLOR",1)):se(e,"DYNAMIC_GRASS_COLOR",0),se(e,"GRASS_TEXTURE_SIZE",f.glsl_value(v.grass_tex_size)),!0}(e,t);break;case"DEBUG_VIEW":a=re(e,t);break;case"PARTICLES":a=function(e,t,r){if(t.do_not_render)return!1;var n=t.texture_slots;if(e.halo_particles)ge(e,"particle_system.glslv","particle_system_stack.glslf"),se(e,"HALO_PARTICLES",1),j(e,t);else{var a={use_shadeless:!1,diffuse_shader:t.diffuse_shader,specular_shader:t.specular_shader,use_tangent_shading:t.use_tangent_shading};if(t.use_nodes)return ge(e,"particle_system.glslv","particle_system.glslf"),Z(e,t,r,"PARTICLES"),!0;ge(e,"particle_system.glslv","particle_system_stack.glslf");var o=H(t.uuid),_=s.create_lighting_graph(o,a,e.lights);e.shaders_info.node_elements=s.compose_node_elements(_);var i=V("use_map_color_diffuse",!0,n)[0];if(i){switch(se(e,"TEXTURE_COLOR",1),i.blend_type){case"MIX":se(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case"MULTIPLY":se(e,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}e.diffuse_color_factor=i.diffuse_color_factor,e.alpha_factor=i.use_map_alpha?i.alpha_factor:0,Oe(e,P.get_batch_texture(i),"default"+String(e.textures.length),i.texture.name)}}return e.diffuse_color.set(t.diffuse_color),e.diffuse_color[3]=t.alpha,e.ambient=t.ambient,e.diffuse_intensity=t.diffuse_intensity,e.emit=t.emit,e.specular_color.set(t.specular_color),e.specular_alpha=t.specular_alpha,ie(e,"a_position"),ie(e,"a_tbn"),se(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),se(e,"ALPHA_CLIP","CLIP"===t.blend_mode?1:0),se(e,"PARTICLES_SHADELESS",t.use_shadeless?1:0),W(e,t),J(e,t),Q(e,t),e.use_backface_culling=t.use_backface_culling,e.xray=t.render_above_all&&"OPAQUE"!=t.blend_mode&&"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode,e.offset_z=t.offset_z,!0}(e,t,n);break;default:r.panic("Wrong batch type: "+e.type)}return a}function H(e,t,r){var n="";return T.check_active()&&(n=T.get_active().uuid),s.generate_graph_id(e,t,n,r)}function j(e,t){var r=t.halo_settings;se(e,"NUM_RINGS",r.ring_count),se(e,"NUM_LINES",r.line_count),se(e,"NUM_STARS",r.star_tip_count),se(e,"SKY_STARS",r.is_sky_stars?1:0),e.halo_size=r.size,e.halo_hardness=r.hardness/20,e.halo_rings_color.set(r.rings_color),e.halo_lines_color.set(r.lines_color),e.halo_stars_blend=1/r.stars_blend_height,e.halo_stars_height=r.stars_min_height,e.halo=!0}function z(e,t,r){switch(t.texture_coords){case"UV":case"ORCO":se(e,r,"TEXTURE_COORDS_UV_ORCO"),se(e,"TEXCOORD",1);break;case"NORMAL":se(e,r,"TEXTURE_COORDS_NORMAL"),se(e,"NORMAL_TEXCOORD",1);break;default:se(e,r,"TEXTURE_COORDS_NONE")}}function Q(e,t){switch(t.blend_mode){case"ALPHA_ANTIALIASING":e.blend=!1,e.z_sort=!1,e.depth_mask=!0,e.alpha_clip=!1,e.alpha_antialiasing=!0;break;case"ALPHA_SORT":e.blend=!0,e.z_sort=!0,e.depth_mask=!0,e.alpha_clip=!1,e.alpha_antialiasing=!1;break;case"ALPHA":e.blend=!0,e.z_sort=!1,e.depth_mask=!0,e.alpha_clip=!1,e.alpha_antialiasing=!1;break;case"CLIP":e.blend=!1,e.z_sort=!1,e.depth_mask=!0,e.alpha_clip=!0,e.alpha_antialiasing=!1;break;case"ADD":e.blend=!0,e.z_sort=!1,e.depth_mask=!1,e.alpha_clip=!1,e.alpha_antialiasing=!1;break;case"OPAQUE":e.blend=!1,e.z_sort=!1,e.depth_mask=!0,e.alpha_clip=!1,e.alpha_antialiasing=!1;break;default:r.panic("Unknown alpha blend mode: "+t.blend_mode)}}function V(e,t,r){for(var n=[],a=r.length,o=0;o<a;o++){var _=r[o];_[e]==t&&_.texture&&_.texture._render&&n.push(_)}return n}function q(e,t){var r=t.raytrace_mirror;e.reflect_factor=r.reflect_factor,e.fresnel_params[0]=r.fresnel,e.fresnel_params[1]=1-r.fresnel_factor/5}function W(e,t){var r,n=0;switch(t.specular_shader){case"PHONG":case"COOKTORR":r=t.specular_hardness;break;case"WARDISO":r=t.specular_slope;break;case"TOON":r=t.specular_toon_size,n=t.specular_toon_smooth;break;case"BLINN":r=t.specular_ior,n=t.specular_hardness;break;default:o.error("unsupported specular shader: "+t.specular_shader+' (material "'+t.name+'")'),r=t.specular_hardness}e.specular_params[0]=t.specular_intensity,e.specular_params[1]=r,e.specular_params[2]=n}function J(e,t){switch(t.diffuse_shader){case"LAMBERT":e.diffuse_params[0]=0,e.diffuse_params[1]=0;break;case"OREN_NAYAR":e.diffuse_params[0]=t.roughness,e.diffuse_params[1]=0;break;case"FRESNEL":e.diffuse_params[0]=t.diffuse_fresnel,e.diffuse_params[1]=t.diffuse_fresnel_factor;break;case"MINNAERT":e.diffuse_params[0]=t.darkness,e.diffuse_params[1]=0;break;case"TOON":e.diffuse_params[0]=t.diffuse_toon_size,e.diffuse_params[1]=t.diffuse_toon_smooth;break;default:o.error("unsupported diffuse shader: "+t.diffuse_shader+' (material "'+t.name+'")'),e.diffuse_params[0]=0,e.diffuse_params[1]=0}}function Z(e,t,r,n){if(!t.use_nodes||t.do_not_render)return!1;var a;switch(n){case"MAIN":ge(e,"main.glslv","main.glslf"),a=!1;break;case"GLOW":ge(e,"main.glslv","main.glslf"),a=!0;break;case"SHADOW":ge(e,"shadow.glslv","shadow.glslf"),a=!1;break;case"COLOR_ID":ge(e,"color_id.glslv","color_id.glslf"),a=!1}var l=t.node_tree,c={vc_name:r.active_vcol_name,uv_name:r.active_uv_name},E=H(t.uuid,n,c),u=s.compose_ngraph_proxy(l,E,!1,r.name,t.name,n,c,e.lights);if(!u.graph)return o.error('Failed to create node graph for material "'+t.name+'", disable nodes'),te(e,t),!0;e.ngraph_proxy_id=u.id,e.has_nodes=!0,se(e,"NODES",1),se(e,"DOUBLE_SIDED_LIGHTING",t.use_double_sided_lighting?1:0),ie(e,"a_position"),t.use_orco_tex_coord&&ie(e,"a_orco_tex_coord"),Q(e,t),e.use_backface_culling=t.use_backface_culling,e.offset_z=t.offset_z,a?(se(e,"ALPHA",1),se(e,"ALPHA_CLIP",0)):(se(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),se(e,"ALPHA_CLIP","CLIP"===t.blend_mode?1:0)),e.xray=t.render_above_all&&"OPAQUE"!=t.blend_mode&&"CLIP"!=t.blend_mode&&"ALPHA_ANTIALIASING"!=t.blend_mode,e.emit=t.emit,e.ambient=t.ambient,q(e,t),se(e,"WETTABLE",t.is_wettable?1:0);var d=null,T=!1;i.traverse(u.graph,(function(r,n){switch(n.type){case"UVMAP":case"TEX_COORD_UV":case"GEOMETRY_UV":case"UV_MERGED":var a=n.data.name,i=n.data.value;e.uv_maps_usage||(e.uv_maps_usage={}),e.uv_maps_usage[i]=a;break;case"GEOMETRY_VC":case"GEOMETRY_VC1":case"GEOMETRY_VC2":case"GEOMETRY_VC3":e.vertex_colors_usage[a=n.data.name]={generate_buffer:!0,src:[{name:n.data.value}]};var l=0;if("GEOMETRY_VC"==n.type)l=7;else for(var c=0;c<n.outputs.length;c++){var E="RGB".indexOf(n.outputs[c].identifier);E>-1&&(l|=1<<2-E)}e.vertex_colors_usage[a].src[0].mask=l;break;case"TEX_COORD_NO":case"TEX_COORD_RE":case"GEOMETRY_NO":case"FRESNEL":case"LAYER_WEIGHT":ie(e,"a_tbn");break;case"TEX_COORD_OB":se(e,"USE_MODEL_TSR_INVERSE",1);break;case"TEX_COORD_WI":se(e,"USE_POSITION_CLIP",1);break;case"MATERIAL_BEGIN":n.data.value.use_tangent_shading&&(se(e,"USE_TBN_SHADING",1),"PARTICLES"!=e.type&&ie(e,"a_shade_tangs")),ie(e,"a_tbn"),T=!0;break;case"BSDF_BEGIN":T=!0,ie(e,"a_tbn");break;case"TEXTURE_COLOR":case"TEXTURE_ENVIRONMENT_CUBE":case"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR":case"TEXTURE_ENVIRONMENT_MIRROR_BALL":Oe(e,n.data.value,a=n.data.name,n.data.bpy_name);break;case"TEXTURE_NORMAL":case"B4W_PARALLAX":se(e,"CALC_TBN_SPACE",1),ie(e,"a_tbn"),n.data&&Oe(e,n.data.value,a=n.data.name,n.data.bpy_name);break;case"NORMAL_MAP":switch(ie(e,"a_tbn"),Number(n.dirs[0][1])){case s.NM_TANGENT:se(e,"CALC_TBN_SPACE",1);break;case s.NM_OBJECT:case s.NM_BLENDER_OBJECT:se(e,"USE_MODEL_TSR",1)}break;case"LAMP":n.data&&(e.lamp_uuid_indexes=n.data);break;case"B4W_REFRACTION":e.blend?e.refractive=!0:(e.refractive=!1,o.warn('Material "'+t.name+'" is not blend. Disabling refractions.')),se(e,"USE_POSITION_CLIP",1);break;case"VALTORGB":case"CURVE_VEC":case"CURVE_RGB":d||(d=n.data.texture);break;case"PARTICLE_INFO":"PARTICLES"==e.type&&n.data&&(e.part_node_data=n.data);break;case"VECT_TRANSFORM":switch(Number(n.dirs[1][1])){case s.VT_WORLD_TO_OBJECT:se(e,"USE_MODEL_TSR_INVERSE",1);break;case s.VT_WORLD_TO_CAMERA:se(e,"USE_VIEW_TSR",1);break;case s.VT_OBJECT_TO_WORLD:se(e,"USE_MODEL_TSR",1);break;case s.VT_OBJECT_TO_CAMERA:se(e,"USE_MODEL_TSR",1),se(e,"USE_VIEW_TSR",1);break;case s.VT_CAMERA_TO_WORLD:se(e,"USE_VIEW_TSR_INVERSE",1);break;case s.VT_CAMERA_TO_OBJECT:se(e,"USE_MODEL_TSR_INVERSE",1),se(e,"USE_VIEW_TSR_INVERSE",1)}break;case"OBJECT_INFO":se(e,"USE_MODEL_TSR",1),e.obj_info_params[1]=t.pass_index,e.obj_info_params[2]=Math.random();break;case"B4W_VECTOR_VIEW":case"GEOMETRY_VW":se(e,"USE_VIEW_TSR",1);break;case"B4W_REFLECT":se(e,"USE_VIEW_TSR_INVERSE",1);break;case"BUMP":case"DISPLACEMENT_BUMP":ie(e,"a_tbn"),_.get_standard_derivatives()?se(e,"USE_DERIVATIVES_EXT",1):o.warn('"OES_standard_derivatives" extension is not available. Disabling the BUMP node in the "'+t.name+'" material.');break;case"BSDF_TRANSPARENT":n.data.value.use_alpha?se(e,"USE_BSDF_TRANSPARENT_ALPHA",1):(e.blend=!0,e.refractive=!0,se(e,"USE_BSDF_TRANSPARENT_REFRACT",1));break;case"BSDF_GLOSSY":case"BSDF_DIFFUSE":se(e,"USE_BSDF_SKY_DIM",1),_.get_texture_lod()&&se(e,"USE_TEXTURE_LOD_EXT",1);break;case"BSDF_PRINCIPLED":se(e,"USE_BSDF_SKY_DIM",1),_.get_texture_lod()&&se(e,"USE_TEXTURE_LOD_EXT",1),n.data.value.use_refract&&(e.blend=!0,e.refractive=!0,se(e,"USE_BSDF_PRINCIPLED_REFRACT",1),se(e,"USE_VIEW_TSR",1),se(e,"USE_PROJ_MATRIX_FRAG",1))}})),d&&Oe(e,d,"u_nodes_texture"),T||(e.use_shadeless=!0);var f=e.shaders_info.node_elements=s.compose_node_elements(u.graph);$(u.graph,e);for(var p=e.node_value_inds,P=e.node_rgb_inds,S=0;S<f.length;S++){var A=f[S];switch(A.id){case"VALUE":if(v=A.param_values[0])for(var h=0;h<p.length;h+=3)if(p[h]==v){A.dirs.push(["VALUE_ROW_IND",p[h+1]]),A.dirs.push(["VALUE_COL_IND",p[h+2]]);break}break;case"RGB":var v;if(v=A.param_values[0])for(h=0;h<P.length;h+=2)if(P[h]==v){A.dirs.push(["RGB_IND",P[h+1]]);break}}}return se(e,"NUM_VALUES",e.node_values.length/4),se(e,"NUM_RGBS",e.node_rgbs.length),!0}function $(e,t,r){var n=[],a=[],o=[],_=[];!function(e,t,r,n,a,o){i.traverse(e,(function(e,t){if("VALUE"==t.type){var _=ee("",t.name);r.push(t.outputs[0].default_value);var i=n.length/3,s=parseInt(i/4),l=parseInt(i%4);n.push(_,s,l)}else if("RGB"==t.type){_=ee("",t.name);var c=t.outputs[0].default_value.slice(0,3);a.push(c[0],c[1],c[2]),o.push(_,o.length/2)}}));for(var _=r.length+4-r.length%4,s=r.length;s<_;s++)r.push(0)}(e,0,n,a,o,_),t.node_values=n,t.node_value_inds=a,t.node_rgbs=o,t.node_rgb_inds=_}function ee(e,t){return(e?e+"%join%":"")+t}function te(e,t){switch(e.type){case"SHADOW":ge(e,"shadow.glslv","shadow.glslf");break;case"COLOR_ID":ge(e,"color_id.glslv","color_id.glslf");break;default:ge(e,"main.glslv","main_stack.glslf")}return se(e,"SHADELESS",1),ie(e,"a_position"),ie(e,"a_tbn"),Xv(1,0,1,1,e.diffuse_color),t&&(se(e,"ALPHA","OPAQUE"===t.blend_mode?0:1),se(e,"ALPHA_CLIP","CLIP"===t.blend_mode?1:0),se(e,"VERTEX_COLOR",0),e.offset_z=t.offset_z,Q(e,t),e.use_backface_culling=t.use_backface_culling),!0}function re(e,t){return!(t&&(t.is_lens_flares||t.do_not_render)||(ge(e,"debug_view.glslv","debug_view.glslf"),ie(e,"a_position"),ie(e,"a_tbn"),ie(e,"a_polyindex"),e.depth_mask=!0,Eh(0,0,0,e.wireframe_edge_color),0))}function ne(e,t){if(e.data_id=t.data_id,"PHYSICS"!==e.type){switch("DYNAMIC"==t.type||"COLOR_ID"==e.type?(se(e,"AU_QUALIFIER",t.is_hair_particles?"GLSL_IN":"uniform"),se(e,"STATIC_BATCH",0)):(se(e,"AU_QUALIFIER","GLSL_IN"),se(e,"STATIC_BATCH",1)),"DEBUG_VIEW"==e.type&&(_.get_standard_derivatives()?se(e,"WIREFRAME_QUALITY",1):se(e,"WIREFRAME_QUALITY",0),e.debug_sphere?(se(e,"DEBUG_SPHERE",1),se(e,"DEBUG_SPHERE_DYNAMIC",e.debug_sphere_dynamic?1:0)):se(e,"DEBUG_SPHERE",0),se(e,"ALPHA",1)),t.use_shape_keys&&"PARTICLES"!=e.type&&!t.is_hair_particles&&(e.use_shape_keys=t.use_shape_keys),t.wind_bending?(""!==t.main_bend_col?(e.vertex_colors_usage.a_bending_col_main={generate_buffer:!0,src:[{name:t.main_bend_col,mask:4}]},ie(e,"a_bending_col_main"),""!==t.detail_bend_col.leaves_stiffness&&""!==t.detail_bend_col.leaves_phase&&""!==t.detail_bend_col.overall_stiffness?(e.vertex_colors_usage.a_bending_col_detail={generate_buffer:!0,src:[{name:t.detail_bend_col.leaves_stiffness,mask:4},{name:t.detail_bend_col.leaves_phase,mask:2},{name:t.detail_bend_col.overall_stiffness,mask:1}]},ie(e,"a_bending_col_detail"),ie(e,"a_tbn"),se(e,"DETAIL_BEND",1)):se(e,"DETAIL_BEND",0),se(e,"MAIN_BEND_COL",1)):se(e,"MAIN_BEND_COL",0),se(e,"BEND_CENTER_ONLY",t.bend_center_only?1:0),se(e,"WIND_BEND",1)):se(e,"WIND_BEND",0),se(e,"BILLBOARD_PRES_GLOB_ORIENTATION",0|t.billboard_pres_glob_orientation),se(e,"BILLBOARD",t.billboard?1:0),se(e,"HAIR_BILLBOARD",t.billboard&&t.is_hair_particles?1:0),se(e,"BILLBOARD_SPHERICAL",t.billboard_spherical?1:0),t.billboard_type){case"RANDOM":se(e,"BILLBOARD_RANDOM",1),se(e,"BILLBOARD_JITTERED",0);break;case"JITTERED":se(e,"BILLBOARD_RANDOM",0),se(e,"BILLBOARD_JITTERED",1);break;default:se(e,"BILLBOARD_RANDOM",0),se(e,"BILLBOARD_JITTERED",0)}se(e,"DYNAMIC_GRASS",t.dynamic_grass&&A.allow_vertex_textures?1:0),e.dynamic_grass=t.dynamic_grass,"PARTICLES"!=e.type&&(e.dynamic_geometry=t.dynamic_geometry),e.shadow_cast=t.shadow_cast,e.shadow_cast_only=t.shadow_cast_only,e.shadow_receive=t.shadow_receive&&!e.use_shadeless&&!(e.blend&&A.disable_blend_shadows_hack),A.rgba_fallback_shadows?("MAIN"==e.type&&e.shadow_receive||"SHADOW"==e.type)&&se(e,"RGBA_SHADOWS",1):se(e,"RGBA_SHADOWS",0),e.reflexible=t.reflexible,e.reflexible_only=t.reflexible_only,e.reflective=t.reflective,e.obj_info_params[0]=t.pass_index,e.lod_dist_max=t.lod_dist_max,e.lod_dist_min=t.lod_dist_min,e.lod_lower_border_range=t.lod_lower_border_range,e.lod_upper_border_range=t.lod_upper_border_range,e.cube_reflection_id=t.cube_reflection_id,e.plane_reflection_id=t.plane_reflection_id,t.is_skinning?(ie(e,"a_influence"),se(e,"SKINNED",1),A.skinning_hack?(se(e,"DISABLE_TANGENT_SKINNING",1),se(e,"FRAMES_BLENDING",0)):(se(e,"DISABLE_TANGENT_SKINNING",0),se(e,"FRAMES_BLENDING",t.frames_blending?1:0)),se(e,"MAX_BONES",t.max_bones)):(se(e,"SKINNED",0),se(e,"FRAMES_BLENDING",0),se(e,"DISABLE_TANGENT_SKINNING",0)),t.vertex_anim?(se(e,"VERTEX_ANIM",1),se(e,"VERTEX_ANIM_MIX_NORMALS_FACTOR",A.vert_anim_mix_normals_hack?.5:"u_va_frame_factor")):se(e,"VERTEX_ANIM",0),t.is_skinning&&t.vertex_anim&&r.panic("Skinning and vertex animation are mutually exlusive")}}function ae(e,t,r){if(t.length){for(var n=l.get_shadow_lamps(t,A.ssao&&r.b4w_enable_ssao),a=e.shaders_info,o=e.lamp_uuid_indexes,_=0,i=0;i<e.shaders_info.node_elements.length;i++){var s=e.shaders_info.node_elements[i];if("LIGHTING_LAMP"==s.id){var c=(h=t[_++%t.length]).light,E=l.get_scene_data(h,r);if("SPOT"==c.type||"POINT"==c.type)var u=Math.cos(c.spot_size/2);if("SPOT"==c.type)var d=c.spot_blend*(1-u);var T=E.light_index,p=n.indexOf(h);s.dirs=[["LAMP_TYPE",c.type],["LAMP_IND",T],["LAMP_SPOT_SIZE",f.glsl_value(u||.01)],["LAMP_SPOT_BLEND",f.glsl_value(d||.01)],["LAMP_LIGHT_DIST",f.glsl_value(c.distance)],["LAMP_USE_SPHERE",c.use_sphere?1:0],["LAMP_SHADOW_MAP_IND",p]]}else if("LAMP"==s.id&&o)for(var P=s.dirs[0][1],S=0;S<t.length;S++){var h;o[(h=t[S]).uuid]==P&&("SPOT"!=(c=h.light).type&&"POINT"!=c.type||(u=Math.cos(c.spot_size/2)),"SPOT"==c.type&&(d=c.spot_blend*(1-u)),s.dirs.push(["LAMP_TYPE",c.type],["LAMP_SPOT_SIZE",f.glsl_value(u||.01)],["LAMP_SPOT_BLEND",f.glsl_value(d||.01)],["LAMP_LIGHT_DIST",f.glsl_value(c.distance)],["LAMP_USE_SPHERE",c.use_sphere?1:0]))}}if(o){var v=0;for(var m in o)v++;for(e.lamp_light_positions=new Float32Array(3*v),e.lamp_light_directions=new Float32Array(3*v),e.lamp_light_color_intensities=new Float32Array(3*v),f.set_directive(a,"NUM_LAMP_LIGHTS",v),i=0;i<t.length;i++)oe(e,t[i])}}}t.batch_get_debug_storage=function(e){return Y[e]||null},t.batch_set_debug_storage=function(e,t){Y[e]=t},t.clone_batch=w,t.generate_main_batches=function(e,t,r,n){var o=(r||[]).map((function(e){return e.light})),_=function(e,t,r){for(var n=[],a=0;a<e.length;a++){var o=e[a],_=o._object;_.is_hair_dupli||n.push.apply(n,D(o,_.render,t,r))}return n}(t,e._render.graph,o);_=function(e){for(var t=[],r=[],n={},o=0;o<e.length;o++){var _=null;if((u=e[o].batch).id in n){var i=n[u.id],s=r[i].batch;if(ve(u,(function(e){ve(s,(function(t){WO(e,t)&&1!=e.inst_array_state&&(_=r[i])}))})),!_)do{u.id++}while(n[u.id])}if(_||(_={batch:u,obj_renders_ordered:[],batch_renders_ordered:[],submeshes_ordered:[],rel_bpy_objects:[],rel_bpy_objects_uuids:[],mat_names:[]},n[u.id]=r.length,r.push(_)),e[o].submesh&&e[o].submesh.base_length){_.obj_renders_ordered.push(e[o].obj_render),_.batch_renders_ordered.push(e[o].batch_render),_.submeshes_ordered.push(e[o].submesh);for(var l=0;l<e[o].rel_bpy_objects.length;l++){var c=e[o].rel_bpy_objects[l];-1==_.rel_bpy_objects_uuids.indexOf(c.uuid)&&(_.rel_bpy_objects.push(c),_.rel_bpy_objects_uuids.push(c.uuid))}for(l=0;l<e[o].mat_names.length;l++){var E=e[o].mat_names[l];-1==_.mat_names.indexOf(E)&&_.mat_names.push(E)}}_.mat_names.sort()}for(o=0;o<r.length;o++){var u,d=r[o].obj_renders_ordered,T=r[o].batch_renders_ordered,f=r[o].submeshes_ordered,p=K(T,u=r[o].batch);if("STATIC"==p.type&&"COLOR_ID"!=u.type)for(l=0;l<d.length;l++){var P=d[l],A=T[l],h=f[l],v=Fm(y);if(P.billboard&&!P.billboard_pres_glob_orientation?(Km(jm(P.world_tsr,O),v),Bm(zm(P.world_tsr,O),v)):Dm(P.world_tsr,v),A.is_hair_particles?h.instanced_array_data||(A.billboard?S.submesh_apply_particle_transform(h,v):S.submesh_apply_transform(h,v)):S.submesh_apply_transform(h,v),A.is_hair_particles)se(u,"AU_QUALIFIER","GLSL_IN");else if(r[o].rel_bpy_objects.length>1){var m={};(A.wind_bending||A.billboard)&&(m.au_center_pos=jm(v,ih())),A.wind_bending&&(m.au_wind_bending_amp=[A.wind_bending_amp],m.au_wind_bending_freq=[A.wind_bending_freq],m.au_detail_bending_amp=[A.detail_bending_amp],m.au_detail_bending_freq=[A.detail_bending_freq],m.au_branch_bending_amp=[A.branch_bending_amp]),S.submesh_apply_params(h,m),se(u,"AU_QUALIFIER","GLSL_IN")}else p.center_pos.set(v.subarray(0,3)),se(u,"AU_QUALIFIER","uniform")}if(0==f.length)h=S.init_submesh(a.unique_name("%empty"));else if(1==f.length)h=f[0];else{var g=[];for(l=0;l<f.length;l++)S.is_long_submesh(f[l])||g.push(l);if(g.length<f.length)for(l=0;l<g.length;l++)S.submesh_drop_indices(f[g[l]]);h=S.submesh_list_join(f)}if("STATIC"==p.type){if("COLOR_ID"!=u.type){var N=[];for(l=0;l<r[o].rel_bpy_objects.length;l++)ZN(r[o].rel_bpy_objects[l]._object.render.bbr_world,N);FN(N,0,N.length,p.bb_world),CN(p.bb_world,p.bb_local),p.be_world=$N(Qg(N),!0),qN(p.be_world,p.be_local),p.bs_world=eR(p.be_world),QN(p.bs_world,p.bs_local)}if(p.is_lod){var R=r[o].rel_bpy_objects[0].b4w_cluster_data;p.lod_center.set(R.cluster_center?R.cluster_center:p.bs_world.center)}}if("PARTICLES"!=u.type){var I=h.submesh_bd;p.billboard?(CN(p.bb_local,u.bounds_local.bb),qN(p.be_local,u.bounds_local.be),QN(p.bs_local,u.bounds_local.bs),u.use_be=!1):(CN(I.bb_local,u.bounds_local.bb),qN(I.be_local,u.bounds_local.be),QN(p.bs_local.radius<I.bs_local.radius?"STATIC"==p.type&&"COLOR_ID"!=u.type?p.bs_world:p.bs_local:I.bs_local,u.bounds_local.bs),u.use_be=tR(u.bounds_local.be,u.bounds_local.bs))}t.push({batch:u,render:p,submesh:h,mat_names:r[o].mat_names,rel_bpy_objects:r[o].rel_bpy_objects})}return t}(_);for(var i=0;i<_.length;i++)if((P=_[i].batch).material_names=_[i].mat_names,le(P,_[i].submesh),ae(P,r,e),"STATIC"==_[i].render.type&&"COLOR_ID"!=P.type){var s=a.unique_name("%meta%"+P.type+"%"+P.material_names.join("%")+"%"),c=l.create_object(s,"MESH");if(l.meta_obj_append_render(c,_[i].render),l.append_scene_data(c,e),l.append_batch(c,e,P),n.push(c),"MAIN"==P.type)for(var E=0;E<_[i].rel_bpy_objects.length;E++)(u=_[i].rel_bpy_objects[E]._object).meta_objects.push(c)}else l.append_batch(u=_[i].rel_bpy_objects[0]._object,e,P);if(A.debug_view){for(i=0;i<_.length;i++)if("DYNAMIC"==(p=_[i].render).type){var u=_[i].rel_bpy_objects[0]._object;if("MAIN"==(P=_[i].batch).type){var d=l.get_scene_data(u,e).batches,T=!1;for(E=0;E<d.length;E++)d[E].debug_sphere&&(T=!0);if(T)continue;var f=me(p,u.name,!0,P);l.append_batch(u,e,f)}}for(i=0;i<n.length;i++){var p=(u=n[i]).render;"MAIN"==(P=l.get_scene_data(u,e).batches[0]).type&&(f=me(p,u.name,!1,P),l.append_batch(u,e,f))}for(i=0;i<_.length;i++){var P;"DEBUG_VIEW"==(P=_[i].batch).type&&(P.debug_id_color=i)}}for(i=0;i<t.length;i++)for(d=l.get_scene_data(t[i]._object,e).batches,E=0;E<d.length;E++)k(d[E]);for(i=0;i<n.length;i++)for(d=l.get_scene_data(n[i],e).batches,E=0;E<d.length;E++)k(d[E])},t.append_sky_batch_to_world=function(e,t,r){var n=e._render.world_light_set,a=C("MAIN");if(ge(a,"sky.glslv","sky.glslf"),a.is_sky=!0,a.depth_mask=!1,t.procedural_skydome)se(a,"PROCEDURAL_SKYDOME",1),a.draw_proc_sky=!0;else{var o=n.sky_texture_param;Oe(a,d.find_subs(e._render.graph,p.SKY).camera.color_attachment,"u_sky"),o&&(se(a,"WO_SKYTEX",1),o.invert&&se(a,"MTEX_NEGATIVE",1),o.use_rgb_to_intensity&&se(a,"MTEX_RGBTOINT",1),se(a,"BLENDTYPE",o.blend_type),o.use_map_blend&&se(a,"WOMAP_BLEND",1),o.use_map_horizon&&se(a,"WOMAP_HORIZ",1),o.use_map_zenith_up&&se(a,"WOMAP_ZENUP",1),o.use_map_zenith_down&&se(a,"WOMAP_ZENDOWN",1)),n.use_sky_blend&&se(a,"WO_SKYBLEND",1),n.use_sky_paper&&se(a,"WO_SKYPAPER",1),n.use_sky_real&&se(a,"WO_SKYREAL",1)}t.reflexible&&(a.reflexible=!0,t.reflexible_only&&(a.reflexible_only=!0)),ie(a,"a_position");var _=E.generate_fullscreen_quad();if(le(a,_),k(a),a.do_not_cull=!0,he(a),l.append_batch(r,e,a),d.find_subs(e._render.graph,p.DEBUG_VIEW)){var i=w(a);i.type="DEBUG_VIEW",i.subtype="",re(i),se(i,"DEBUG_VIEW_SPECIAL_SKYDOME",1),_.va_common.a_polyindex=S.extract_polyindices(_),le(i,_),i.debug_main_batch_id=a.id,he(i),l.append_batch(r,e,i)}},t.create_forked_batches=function(e,t,r){for(var n=l.get_scene_data(e,r).batches,a=[],o=d.find_subs(t,p.MAIN_PLANE_REFLECT),_=d.find_subs(t,p.MAIN_CUBE_REFLECT),i=d.find_subs(t,p.OUTLINE_MASK),s=d.find_subs(t,p.COLOR_PICKING),c=0;c<n.length;c++){var E=n[c],u=null;"SHADOW"==E.type&&"RECEIVE"==E.subtype&&E.shadow_cast&&((u=w(E)).subtype="CAST"),"MAIN"!=E.type&&"PARTICLES"!=E.type||!o&&!_||!E.reflexible||((u=w(E)).subtype="REFLECT",u.refractive=!1,u.z_sort&&(u.z_sort=!1,u.depth_mask=!1),u.particles_data=E.particles_data),"COLOR_ID"==E.type&&i&&e.render.outlining&&(s&&e.render.selectable?(u=w(E)).subtype="OUTLINE":E.subtype="OUTLINE"),u&&(u.forked_batch=!0,he(u),a.push(u))}for(var T=0;T<a.length;T++)l.append_batch(e,r,a[T])},t.wb_angle_to_amp=function(e,t,r){var n=r*(t.max_z-t.min_z);if(0==n)return 0;var a=n*Math.tan(e);return.5*(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/n},t.wb_amp_to_angle=function(e,t,r){var n=r*(t.max_z-t.min_z);if(0==n)return 0;e*=2*n;var a=Math.pow(e+1,4)-Math.pow(e+1,2);return Math.atan(a/n)},t.bb_bpy_to_b4w=function(e){var t={max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0};return t.max_x=e.max_x,t.min_x=e.min_x,t.max_y=e.max_y,t.min_y=e.min_y,t.max_z=e.max_z,t.min_z=e.min_z,t},t.name_list_to_node_name=function(e,t){for(var r=e[t],n=t+1;n<e.length;n++)r=ee(r,e[n]);return r},t.update_batch_material_error=te,t.update_batch_lights=ae;var oe=function(){var e=ih();return function(t,r){if(r.uuid in t.lamp_uuid_indexes){var n=t.lamp_uuid_indexes[r.uuid],a=jm(r.render.world_tsr,e);t.lamp_light_positions.set(a,3*n),t.lamp_light_directions.set(r.light.direction,3*n),t.lamp_light_color_intensities.set(r.light.color_intensity,3*n)}}}();function _e(e,t){for(var r=0;r<t.length;r++){var n=t[r].settings.b4w_vcol_from_name;""!==n&&""!==t[r].settings.b4w_vcol_to_name&&(e.vertex_colors_usage[n]={generate_buffer:!1,src:[{name:n,mask:7}]})}}function ie(e,t){var r=e.common_attributes;-1==r.indexOf(t)&&r.push(t),e.common_attributes=r.sort()}function se(e,t,r){f.set_directive(e.shaders_info,t,r)}function le(e,t,r){if("PHYSICS"!=e.type){var n=e.draw_mode;e.halo&&"PARTICLES"!=e.type&&(t=S.extract_halo_submesh(t)),e.water_generated_mesh&&(t=E.generate_cascaded_grid(e.water_num_cascads,e.water_subdivs,e.water_detailed_dist));var a=S.submesh_to_bufs_data(t,n,e.vertex_colors_usage);e.bufs_data=a,e.dynamic_geometry||e.z_sort||e.use_shape_keys||(a.ibo_array=null,a.vbo_source_data.length=0);var o=t.va_frames.length;e.num_vertices=t.base_length*o,e.num_triangles=function(e){switch(e.draw_mode){case S.DM_DEFAULT:case S.DM_TRIANGLES:case S.DM_DYNAMIC_TRIANGLES:return!0;default:return!1}}(e)?S.is_indexed(t)?t.indices.length/3*o:t.base_length/3*o:0}else"NAVMESH"==e.subtype?e.bufs_data=S.submesh_to_bufs_data(t,S.DM_DEFAULT,[]):(t.shape_keys.length>0&&S.submesh_init_shape_keys(t,t.va_frames[0],r),e.submesh=t)}function ce(e,t,n){var a=t.settings;switch(a.b4w_billboard_align){case"VIEW":se(e,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case"XY":se(e,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case"YZ":se(e,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case"ZX":se(e,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:r.panic("Wrong billboard align value")}se(e,"BILLBOARD",0);var o=a.b4w_enable_soft_particles&&l.check_obj_soft_particles_accessibility(n,a);se(e,"SOFT_PARTICLES",a.b4w_particles_softness>0&&o&&A.depth_tex_available?1:0),se(e,"SOFT_STRENGTH",f.glsl_value(a.b4w_particles_softness)),f.set_directive(e.shaders_info,"WORLD_SPACE","WORLD"==a.b4w_coordinate_system?1:0)}function Ee(e,t,n,a,o,_,i,s,c,E,u,d,T){var f=e._object,p=[],P=s.b4w_dynamic_grass;if(!E&&P)return p;for(var h="INSTANCE"==s.b4w_wind_bend_inheritance,v="INSTANCE"==s.b4w_shadow_inheritance,m="INSTANCE"==s.b4w_reflection_inheritance,O=[],N=[],R=0;R<o.length;R++){var I=o[R]._object.render;(z=l.clone_render(t)).billboard=s.b4w_hair_billboard,z.billboard_type=s.b4w_hair_billboard_type,z.billboard_spherical="SPHERICAL"==s.b4w_hair_billboard_geometry,z.dynamic_grass=P,z.is_hair_particles=!0,h?(z.wind_bending=I.wind_bending,z.wind_bending_angle=I.wind_bending_angle,z.wind_bending_freq=I.wind_bending_freq,z.detail_bending_freq=I.detail_bending_freq,z.main_bend_col=I.main_bend_col,z.detail_bending_amp=I.detail_bending_amp,z.branch_bending_amp=I.branch_bending_amp,z.wind_bending_amp=I.wind_bending_amp,z.detail_bend_col=I.detail_bend_col,z.bend_center_only=!1):(z.wind_bending=f.render.wind_bending,z.wind_bending_angle=f.render.wind_bending_angle,z.wind_bending_freq=f.render.wind_bending_freq,z.detail_bending_freq=f.render.detail_bending_freq,z.main_bend_col=f.render.main_bend_col,z.detail_bending_amp=f.render.detail_bending_amp,z.branch_bending_amp=f.render.branch_bending_amp,z.wind_bending_amp=f.render.wind_bending_amp,z.detail_bend_col=f.render.detail_bend_col,z.bend_center_only=!0),v?(z.shadow_cast=I.shadow_cast,z.shadow_cast_only=I.shadow_cast_only,z.shadow_receive=I.shadow_receive):(z.shadow_cast=f.render.shadow_cast,z.shadow_cast_only=f.render.shadow_cast_only,z.shadow_receive=f.render.shadow_receive),m?(z.reflexible=I.reflexible,z.reflexible_only=I.reflexible_only,z.reflective=I.reflective,z.cube_reflection_id=I.cube_reflection_id,z.plane_reflection_id=I.plane_reflection_id,z.reflection_type=I.reflection_type):(z.reflexible=f.render.reflexible,z.reflexible_only=f.render.reflexible_only,z.reflective=f.render.reflective,z.cube_reflection_id=f.render.cube_reflection_id,z.plane_reflection_id=f.render.plane_reflection_id,z.reflection_type=f.render.reflection_type),O.push(z);var y=i[R];y||(y=new Float32Array),d&&eO(c.seed,u);var L=new Float32Array(3),Y=new Float32Array([0,0,0,1]),M=[],w=-1!=_N(A.loaded_data_version,x)&&!s.b4w_initial_rand_rotation&&!s.b4w_hair_billboard,U=4;w&&(U=8);for(var k=0;k<y.length;k+=U){L[0]=y[k],L[1]=y[k+1],L[2]=y[k+2];var D=y[k+3]*zm(I.world_tsr);if(s.b4w_initial_rand_rotation){switch(s.b4w_rotation_type){case"XYZ":Rh(F=new Float32Array([$g(u),$g(u),$g(u)]),F);break;case"Z":var F=new Float32Array([0,0,1]);break;default:r.panic("Unsupported random rotation type: "+s.b4w_rotation_type)}vm(F,s.b4w_rand_rotation_strength*(2*Math.PI*$g(u)-Math.PI),Y)}else w&&(Y.set(y.subarray(k+4,k+8)),$O(Y,Y),!s.use_whole_group)&&mm(Y,s.use_rotation_dupli?Vm(I.world_tsr,b):g,Y);var G=Gm(L,D,Y,wm());M.push(G)}N.push(M)}var K={},B=0;for(R=0;R<o.length;R++){var H=o[R]._object.materials;for(k=0;k<H.length;k++)H[k].name in K?K[H[k].name]++:(K[H[k].name]=1,B++)}B=B||1;var j={};for(R=0;R<o.length;R++){var z,Q=o[R],V=_[R],q={};if((z=O[R]).wind_bending&&(q.au_wind_bending_amp=[z.wind_bending_amp],q.au_wind_bending_freq=[z.wind_bending_freq],q.au_detail_bending_freq=[z.detail_bending_freq],q.au_detail_bending_amp=[z.detail_bending_amp],q.au_branch_bending_amp=[z.branch_bending_amp],z.wind_bending_amp=0,z.wind_bending_freq=0,z.detail_bending_freq=0,z.detail_bending_amp=0,z.branch_bending_amp=0),(M=N[R]).length){var W=Q.data,J=(H=Q._object.materials,new Array(H.length)),Z=new Array(H.length);for(k=0;k<H.length;k++)if(!Ie(f,k)&&!S.has_empty_submesh(W,k))for(var $=0;$<V.length;$++){var ee=V[$],te=C(ee),re=H[k];if("MAIN"==ee?J[k]=te:"DEBUG_VIEW"==ee&&(Z[k]=te),te.cluster_id=e.b4w_cluster_data.cluster_id,ue(te,re)&&(te.lights=lO(T),X(te,re,W))){"SHADOW"==ee&&J[k]&&(te.use_shadeless=J[k].use_shadeless),te.draw_mode=S.DM_DEFAULT,ne(te,z),te.odd_id_prop=Re(te,z,s.uuid),te.do_not_cull=e.b4w_do_not_cull||s.b4w_dynamic_grass,"MAIN"==te.type&&(te.caustics=e.b4w_caustics),se(te,"DISABLE_FOG",0|("COLOR_ID"!=ee&&"SHADOW"!=ee&&e.b4w_disable_fogging)),"JITTERED"==s.b4w_hair_billboard_type&&(te.jitter_amp=s.b4w_hair_billboard_jitter_amp,te.jitter_freq=s.b4w_hair_billboard_jitter_freq),P&&(te.grass_scale_threshold=s.b4w_dynamic_grass_scale_threshold),h||(delete te.vertex_colors_usage.a_bending_col_main,delete te.vertex_colors_usage.a_bending_col_detail);var ae=S.extract_submesh(W,k,te.common_attributes,t.bone_skinning_info,te.vertex_colors_usage,te.uv_maps_usage),oe=f.render.world_tsr,_e=!0;if(K[re.name]>1){var ie=0;for(var le in ae.va_frames)ie++;_e=ae.indices.length*M.length*ie*K[re.name]>2e5*B}var ce=A.allow_instanced_arrays_ext&&_e&&"PHYSICS"!=te.type;if(ce){te.inst_array_state=s.use_whole_group?2:1;var Ee=S.clone_submesh(ae);if(S.calc_unit_boundings(ae,Ee,M),Ee.instanced_array_data={tsr_array:M,stat_part_em_tsr:oe,static_hair:"STATIC"==t.type,submesh_params:q,part_inh_attrs:{},dyn_grass:P},z.wind_bending&&z.bend_center_only){var Pe=lh(0,0,0);rg(Pe,f.render.world_tsr,Pe);for(var Se=[],Ae=0;Ae<M.length;Ae++)Se.push(Pe[0],Pe[1],Pe[2]);Ee.instanced_array_data.part_inh_attrs.a_emitter_center={num_comp:3,data:Se}}S.calc_unit_boundings(ae,ae,M),"STATIC"==t.type&&S.bounding_data_apply_transform(Ee.submesh_bd,oe)}else Ee=Te(Ee=S.make_propagated_submesh(ae,q,M),M),z.wind_bending&&z.bend_center_only&&(Ee=fe(Ee,f.render.world_tsr));var ve=de(s.b4w_vcol_from_name,s.b4w_vcol_to_name,te,n,!h,W);se(te,"USE_INSTANCED_PARTCLS",(Ee=pe(Ee,M,f.render.bb_local,a,ve,te.vertex_colors_usage,j,ce)).instanced_array_data?1:0),he(te),p.push({batch:te,obj_render:t,batch_render:z,submesh:Ee,mat_names:[re.name],rel_bpy_objects:[e]})}}for(k=0;k<Z.length;k++)Z[k]&&(Z[k].debug_main_batch_id=J[k].id,he(Z[k]))}}return p}function ue(e,t){var r=!0;return"NODES_GLOW"==e.type&&(r=s.check_material_glow_output(t)),r}function de(e,t,r,n,a,o){var _=[];if(""!==e&&""!==t){var i=function(e,t){var r=[];for(var n in t)for(var a=t[n].src,o=0,_=0;_<a.length;_++){var i=a[_].mask;e==a[_].name&&r.push(n,i,o),o+=KO(i)}return r}(t,r.vertex_colors_usage);if(i.length>0)for(var s=0;s<i.length;s+=3)_.push({emitter_attr:e,emitter_mask:7,particle_attr:i[s],particle_mask:i[s+1],dst_channel_offset:i[s+2]});else S.has_attr(r.common_attributes,"a_color")&&t==o.active_vcol_name&&_.push({emitter_attr:e,emitter_mask:7,particle_attr:"a_color",particle_mask:7,dst_channel_offset:0})}return a&&("a_bending_col_main"in n&&_.push({emitter_attr:"a_bending_col_main",emitter_mask:4,particle_attr:"a_bending_col_main",particle_mask:4,dst_channel_offset:0}),"a_bending_col_detail"in n&&_.push({emitter_attr:"a_bending_col_detail",emitter_mask:7,particle_attr:"a_bending_col_detail",particle_mask:7,dst_channel_offset:0})),_}function Te(e,t){e.va_common.au_center_pos=new Float32Array(3*e.base_length);for(var r=t.length,n=e.base_length/r,a=0;a<r;a++)for(var o=t[a],_=3*n*a,i=0;i<n;i++)e.va_common.au_center_pos[_+3*i]=o[0],e.va_common.au_center_pos[_+3*i+1]=o[1],e.va_common.au_center_pos[_+3*i+2]=o[2];return e}function fe(e,t){e.va_common.a_emitter_center=new Float32Array(3*e.base_length);var r=lh(0,0,0);rg(r,t,r);for(var n=0;n<e.base_length;n++)e.va_common.a_emitter_center[3*n]=r[0],e.va_common.a_emitter_center[3*n+1]=r[1],e.va_common.a_emitter_center[3*n+2]=r[2];return e}function pe(e,t,r,n,a,_,i,s){for(var l=!1,c=0;c<a.length;c++)if((A=n.va_common[T=a[c].emitter_attr])&&A.length>0){l=!0;break}if(s)var E=e.instanced_array_data.part_inh_attrs;if(l){var u=function(e,t,r,n){var a=new Float32Array(3),o=new Float32Array(3),_=new Uint32Array(r.length);"verts_indices"in n||function(e,t,r){e.cell_size=new Float32Array(3),e.base_point=new Float32Array(3),e.verts_indices=new Uint32Array(r.length/3),e.octs_indices=new Uint32Array(r.length/3),e.cell_size[0]=(t.max_x-t.min_x)/20,e.cell_size[1]=(t.max_y-t.min_y)/20,e.cell_size[2]=(t.max_z-t.min_z)/20,e.base_point[0]=t.min_x,e.base_point[1]=t.min_y,e.base_point[2]=t.min_z;for(var n=0;n<r.length/3;n++){var a=r[3*n+1],o=r[3*n+2],_=OO((r[3*n]-e.base_point[0])/e.cell_size[0]),i=OO((a-e.base_point[1])/e.cell_size[1]),s=OO((o-e.base_point[2])/e.cell_size[2]);_=xO(_,0,19),i=xO(i,0,19),s=xO(s,0,19),e.verts_indices[n]=n,e.octs_indices[n]=s*Math.pow(20,2)+20*i+_}for(S.sort_two_arrays(e.octs_indices,e.verts_indices,S.SORT_NUMERIC,!0),e.verts_offsets=new Uint32Array(Math.pow(20,3)),n=0;n<e.octs_indices.length;n++)e.verts_offsets[e.octs_indices[n]]++;for(delete e.octs_indices,n=1;n<e.verts_offsets.length;n++)e.verts_offsets[n]+=e.verts_offsets[n-1]}(n,e,t);for(var i=0;i<r.length;i++){a[0]=r[i][0],a[1]=r[i][1],a[2]=r[i][2];var s=1e10,l=-1,c=OO((a[0]-n.base_point[0])/n.cell_size[0]),E=OO((a[1]-n.base_point[1])/n.cell_size[1]),u=OO((a[2]-n.base_point[2])/n.cell_size[2]);c=xO(c,0,19),E=xO(E,0,19);for(var d=(u=xO(u,0,19))*Math.pow(20,2)+20*E+c,T=n.verts_offsets[d],f=0==d?0:n.verts_offsets[d-1];f<T;f++){var p=n.verts_indices[f];o[0]=t[3*p],o[1]=t[3*p+1],o[2]=t[3*p+2],dh(o,a,o),(P=gh(o))<=s&&(s=P,l=p)}if(-1==l)for(f=0;f<t.length/3;f++){var P;o[0]=t[3*f],o[1]=t[3*f+1],o[2]=t[3*f+2],dh(o,a,o),(P=gh(o))<=s&&(s=P,l=f)}_[i]=l}return _}(r,n.va_frames[0].a_position,t,i),d=e.base_length/t.length;for(c=0;c<a.length;c++){var T,f=a[c].particle_attr,p=a[c].particle_mask,P=a[c].emitter_mask,A=n.va_common[T=a[c].emitter_attr];switch(f){case"a_bending_col_main":var h=1;break;case"a_bending_col_detail":case"a_color":h=3;break;default:h=0;for(var v=0;v<_[f].src.length;v++)h+=KO(_[f].src[v].mask)}if(A&&A.length>0){var m=KO(P),g=KO(p),O=P&p,N=BO(O);if(O!=p&&o.error("Wrong color extraction from "+T+" to "+f+"."),s)for(E[f]={num_comp:h,data:[]},v=0;v<t.length;v++)for(I=(R=u[v])*m,Y=0;Y<N.length;Y++)N[Y]&&(M=XO(P,Y),E[f].data.push(A[I+M]));else for("a_bending_col_main"!=f&&"a_bending_col_detail"!=f||(e.va_common[f]=new Float32Array(e.base_length*g)),v=0;v<t.length;v++){var R,I=(R=u[v])*m,b=v*d*h;if(-1!=R)for(var y=0;y<d;y++)for(var L=y*h,Y=0;Y<N.length;Y++)if(N[Y]){var M=XO(P,Y),x=a[c].dst_channel_offset+XO(p,Y);e.va_common[f][b+L+x]=A[I+M]}}}else e.va_common[f]=new Float32Array(0)}}return e}function Pe(e,t,r,n,a){for(var o=t.length,_={},i=0;i<e.length;i+=a)_[s=Math.floor(o*$g(r))]=_[s]||[],_[s].push(e[i],e[i+1],e[i+2],e[i+3]),n&&_[s].push(e[i+4],e[i+5],e[i+6],e[i+7]);for(var s in _)_[s]=new Float32Array(_[s]);return _}t.set_lamp_data=oe,t.assign_shadow_receive_dirs=function(e,t,r){if(se(e,"CSM_SECTION1",0),se(e,"CSM_SECTION2",0),se(e,"CSM_SECTION3",0),se(e,"NUM_CAST_LAMPS",0),t){se(e,"NUM_CAST_LAMPS",t.lamp_types.length),A.mac_os_shadow_hack&&se(e,"MAC_OS_SHADOW_HACK",1);for(var n=1;n<t.csm_num;n++)se(e,"CSM_SECTION"+String(n),1);se(e,"SHADOW_TEX_RES",f.glsl_value(t.csm_resolution)),se(e,"CSM_FADE_LAST_CASCADE",t.fade_last_cascade?1:0),se(e,"CSM_BLEND_BETWEEN_CASCADES",t.blend_between_cascades&&!A.chrome_csm_blend_hack?1:0)}else se(e,"SHADOW_TEX_RES",0),se(e,"CSM_FADE_LAST_CASCADE",0),se(e,"CSM_BLEND_BETWEEN_CASCADES",0)},t.set_batch_directive=se,t.get_batch_directive=function(e,t){return f.get_directive(e.shaders_info,t)},t.update_batch_geometry=le;var Se=function(){var e=ih();return function(t,r,n,a){for(var o,_,i,s,l,c,E,u,d,T,f,p,P,S,A,h,v={},m=new Float32Array([0,0,0,1]),g=0;g<t.length;g+=a)for(var O=0;O<r.length;O++){var N=ih(),R=zm(r[O].render.world_tsr);Sh(jm(r[O].render.world_tsr,e),R,N);var I=sh([t[g],t[g+1],t[g+2]]);v[O]||(v[O]=new Float32Array(t.length)),n&&(v[O][g+4]=m[0]=t[g+4],v[O][g+5]=m[1]=t[g+5],v[O][g+6]=m[2]=t[g+6],v[O][g+7]=m[3]=t[g+7],$O(m,m),f=void 0,p=void 0,P=void 0,S=void 0,A=void 0,h=void 0,S=(u=(_=m)[1])*(P=(E=_[0])*(l=(o=N)[1])-u*(s=o[0]))-(d=_[2])*(p=d*s-E*(c=o[2])),A=d*(f=u*c-d*l)-E*P,h=E*p-u*f,p*=2*(T=_[3]),P*=2*T,A*=2,h*=2,(i=N)[0]=s+(f*=2*T)+(S*=2),i[1]=l+p+A,i[2]=c+P+h),uh(I,N,I),v[O][g]=I[0],v[O][g+1]=I[1],v[O][g+2]=I[2],v[O][g+3]=t[g+3]}return v}}();function Ae(e,t,r,n,a,_){var i={};function s(e){for(var t=[0],r=0;r<e.length;r++)t[r+1]=t[r]+e[r].count;var a=t[t.length-1]*$g(n),o=0;for(r=0;r<t.length;r++)if(a>=t[r]&&a<t[r+1]){o=r;break}return o}for(var l=[],c=0;c<t.length;c++)for(var E=t[c],u=E.origin_name||E.name,d=0;d<r.length;d++){var T=r[d];u==T.name&&l.push(T)}for(r.length!=l.length&&o.error("dupli weights match failed"),c=0;c<e.length;c+=_)i[f=s(l)]=i[f]||[],i[f].push(e[c],e[c+1],e[c+2],e[c+3]),a&&i[f].push(e[c+4],e[c+5],e[c+6],e[c+7]);for(var f in i)i[f]=new Float32Array(i[f]);return i}function he(e){ve(e,(function(e){e.id=0,e.id=a.calc_variable_id(e,0)}))}function ve(e,t){for(var r=null,n=null,a=[],o=0;o<e.textures.length;o++){var _=e.textures[o],i=_.canvas_context;i&&(r||(r={}),r[o]=i,_.canvas_context=null);var s=_.video_file;s&&(n||(n={}),n[o]=s,_.video_file=null),a.push(_.num_users),_.num_users=0}var l=e.bounds_local;e.bounds_local=null;var c=e.vaos;e.vaos=null;var E=e.bufs_data;e.bufs_data=null;var u=e.submesh;if(e.submesh=null,t(e),e.bufs_data=E,e.submesh=u,e.vaos=c,e.bounds_local=l,r)for(var o in r)e.textures[o].canvas_context=r[o];if(n)for(var o in n)e.textures[o].video_file=n[o];for(o=0;o<e.textures.length;o++)e.textures[o].num_users=a[o]}function me(e,t,r,n){var a=C("DEBUG_VIEW");if(ge(a,"debug_view.glslv","debug_view.glslf"),a.debug_sphere=!0,a.depth_mask=!0,a.odd_id_prop=Re(a,e,t),a.debug_sphere_dynamic=r,ne(a,e),he(a),n.use_be){var o=n.bounds_local.be,_=ih(),i=E.generate_uv_sphere(16,8,1,_,!1,!1),s=lh(mh(o.axis_x),mh(o.axis_y),mh(o.axis_z));S.scale_submesh_xyz(i,s,_);var l=Rh(o.axis_x,O),c=Rh(o.axis_y,N),u=Rh(o.axis_z,R);!s[0]&&s[1]&&s[2]?bh(c,u,l):!s[1]&&s[0]&&s[2]?bh(u,l,c):!s[2]&&s[0]&&s[1]&&bh(l,c,u);var d=function(e,t,r,n){return n[0]=e[0],n[1]=t[0],n[2]=r[0],n[3]=e[1],n[4]=t[1],n[5]=r[1],n[6]=e[2],n[7]=t[2],n[8]=r[2],n}(l,c,u,L);EA(d,d),Hm(xm(d,I),y),Bm(1,y),Km(o.center,y),S.submesh_apply_transform(i,y)}else{var T=n.bounds_local.bs;i=E.generate_uv_sphere(16,8,T.radius,T.center,!1,!1)}return xN(n.bounds_local,a.bounds_local),S.submesh_drop_indices(i,1,!0),i.va_common.a_polyindex=S.extract_polyindices(i),le(a,i),a}function ge(e,t,r){e.shaders_info.vert=t,e.shaders_info.frag=r,f.set_default_directives(e.shaders_info)}function Oe(e,t,r,n){n=n||"",-1==e.texture_names.indexOf(r)&&(e.textures.push(t),e.texture_names.push(r),e.bpy_tex_names.push(n)),e.shader&&u.assign_texture_uniforms(e)}function Ne(e){return e.shaders_info||r.panic("No shaders info for batch "+e.name),e.shader=f.get_compiled_shader(e.shaders_info),function(e){var t=e.shaders_info;if(t.status===f.VALID){var n=e.shader.attributes,a=e.bufs_data.pointers;for(var _ in n)a[_]||r.panic('missing data for "'+_+'" attribute')}t.status&f.INVALID_TEX_IMAGE_UNITS&&o.error("Texture limit exceeded for shader - "+t.frag+', materials: "'+e.material_names.join(", ")+'". Maximum texture count: '+h.max_texture_image_units+", actual texture count: "+t.texture_count),t.status&f.INVALID_F_UNIFORM_VECTORS&&o.error("Fragment uniform limit exceeded for shader - "+t.frag+', materials: "'+e.material_names.join(", ")+'". '),t.status&f.INVALID_V_UNIFORM_VECTORS&&o.error("Vertex uniform limit exceeded for shader - "+t.vert+', materials: "'+e.material_names.join(", ")+'". '),t.status&f.INVALID_VERTEX_ATTRIBS&&o.error("Vertex attribute limit exceeded for shader - "+t.vert+', materials: "'+e.material_names.join(", ")+'". Maximum attribute count: '+h.max_vertex_attribs+", actual attribute count: "+t.attribute_count),t.status&f.INVALID_VARYING_VECTORS&&function(e){if("MAIN"!=e.type||e.has_nodes||o.error("Varying limit exceeded for shader - "+e.shaders_info.frag+', materials: "'+e.material_names.join(", ")+'"'),"MAIN"==e.type&&e.has_nodes||"NODES_GLOW"==e.type){var t=0,r=0;e.uv_maps_usage&&(t=jO(e.uv_maps_usage)),e.vertex_colors_usage&&(r=jO(e.vertex_colors_usage)),o.error("Varying limit exceeded for node shader - "+e.shaders_info.frag+", uv: "+t+", vc: "+r+', materials: "'+e.material_names.join(", ")+'"')}}(e),t.status&f.COMPILATION_ERROR&&o.error("Shader compilation/linking error: "+t.vert+", "+t.frag+', materials: "'+e.material_names.join(", ")+'"')}(e),e.shaders_info.status===f.VALID&&(u.assign_uniform_setters(e.shader),u.assign_attribute_setters(e),u.assign_texture_uniforms(e),!0)}function Re(e,t,r){var n=r;return"NAVMESH"==e.subtype?n:t.dynamic_geometry?"_odd_id_"+a.unique_id():n}function Ie(e,t){return t>=0&&t<e.mat_inheritance_data.is_disabled.length&&e.mat_inheritance_data.is_disabled[t]}t.update_batch_id=he,t.update_local_bounds_from_pos=function(e,t){e.bounds_local.bb=FN(t,0,t.length,e.bounds_local.bb);var r=KN(e.bounds_local.bb,M);e.bounds_local.be=$N(r,!0),e.bounds_local.bs=eR(e.bounds_local.be),e.use_be=tR(e.bounds_local.be,e.bounds_local.bs)},t.apply_shader=ge,t.append_texture=Oe,t.replace_texture=function(e,t,r){var n=e.texture_names.indexOf(r);n>-1&&(e.textures[n]=t)},t.create_shadeless_batch=function(e,t,r){var n=C("MAIN");return r<1&&(n.blend=!0),Xv(t[0],t[1],t[2],r,n.diffuse_color),n.draw_mode=S.DM_TRIANGLES,le(n,e),ge(n,"main.glslv","main_stack.glslf"),se(n,"SHADELESS",1),Ne(n),n},t.update_shader=Ne,t.generate_line_batches=function(e,t){for(var r=0;r<t.length;r++){var n=t[r],a=C("LINE");ge(a,"line.glslv","line.glslf"),a.blend=!0,a.do_not_cull=!0,le(a,E.generate_line()),k(a),l.append_scene_data(n,e),l.append_batch(n,e,a),Ne(a)}},t.check_batch_perm_uniform=function(e,t){return!!e.shader.permanent_uniform_setters.length&&!!e.shader.permanent_uniform_setters_table[t]},t.create_depth_pack_batch=function(e){var t=C("DEPTH_PACK");return t.use_backface_culling=!0,t.depth_mask=!1,le(t,E.generate_fullscreen_tri()),ge(t,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf"),Ne(t),t},t.create_postprocessing_batch=function(e){var t=C("POSTPROCESSING");switch(ge(t,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf"),e){case"NONE":se(t,"POST_EFFECT","POST_EFFECT_NONE");break;case"GRAYSCALE":se(t,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case"X_BLUR":case"Y_BLUR":se(t,"POST_EFFECT","POST_EFFECT_BLUR");break;case"X_GLOW_BLUR":case"Y_GLOW_BLUR":case"X_BLOOM_BLUR":case"Y_BLOOM_BLUR":se(t,"POST_EFFECT","POST_EFFECT_GLOW_BLUR");break;case"X_DOF_BLUR":case"Y_DOF_BLUR":se(t,"POST_EFFECT","POST_EFFECT_DOF_BLUR");break;case"X_ALPHA_BLUR":case"Y_ALPHA_BLUR":se(t,"POST_EFFECT","POST_EFFECT_ALPHA_BLUR");break;case"X_EXTEND":case"Y_EXTEND":se(t,"POST_EFFECT","POST_EFFECT_EXTEND");break;case"FLIP_CUBEMAP_COORDS":se(t,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:r.panic("Wrong postprocessing effect: "+e)}return se(t,"SHADOW_USAGE","NO_SHADOWS"),t.use_backface_culling=!0,t.depth_mask=!1,le(t,E.generate_fullscreen_tri()),Ne(t),t},t.create_ssao_batch=function(e){var t=C("SSAO");t.depth_mask=!1,t.use_backface_culling=!0,le(t,E.generate_fullscreen_tri()),ge(t,"postprocessing/postprocessing.glslv","postprocessing/ssao.glslf"),se(t,"SSAO_QUALITY","SSAO_QUALITY_"+e.ssao_samples),se(t,"SSAO_HEMISPHERE",e.ssao_hemisphere?1:0),se(t,"SHADOW_USAGE","NO_SHADOWS");var r={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])},n=P.create_texture(P.TT_RGBA_INT,!1);return n.source="NODE_TEX",P.update_texture(n,r,0),Oe(t,n,"u_ssao_special_tex"),Ne(t),t},t.create_ssao_blur_batch=function(e){var t=C("SSAO_BLUR");return t.depth_mask=!1,t.use_backface_culling=!0,le(t,E.generate_fullscreen_tri()),ge(t,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf"),se(t,"SSAO_BLUR_DEPTH",e.ssao_blur_depth?1:0),se(t,"SHADOW_USAGE","NO_SHADOWS"),Ne(t),t},t.create_coc_batch=function(e){var t=C("COC");switch(t.depth_mask=!1,t.use_backface_culling=!0,le(t,E.generate_fullscreen_tri()),ge(t,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf"),se(t,"DEPTH_RGBA",1),e){case"COC_ALL":se(t,"COC_TYPE","COC_ALL");break;case"COC_FOREGROUND":se(t,"COC_TYPE","COC_FOREGROUND");break;case"COC_COMBINE":se(t,"COC_TYPE","COC_COMBINE")}return se(t,"SHADOW_USAGE","NO_SHADOWS"),Ne(t),t},t.create_dof_batch=function(e){var t=C("DOF");return t.depth_mask=!1,t.use_backface_culling=!0,le(t,E.generate_fullscreen_tri()),ge(t,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf"),e.dof_bokeh?se(t,"DOF_TYPE","DOF_BOKEH"):(se(t,"DOF_TYPE","DOF_SIMPLE"),se(t,"DEPTH_RGBA",1)),se(t,"SHADOW_USAGE","NO_SHADOWS"),Ne(t),t},t.create_outline_batch=function(){var e=C("OUTLINE");return e.depth_mask=!1,e.use_backface_culling=!0,le(e,E.generate_fullscreen_tri()),ge(e,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf"),Ne(e),e},t.create_glow_combine_batch=function(){var e=C("GLOW_COMBINE");return e.depth_mask=!1,e.use_backface_culling=!0,le(e,E.generate_fullscreen_tri()),ge(e,"postprocessing/postprocessing.glslv","postprocessing/glow.glslf"),Ne(e),e},t.create_god_rays_batch=function(e,t,r){var n=C("GOD_RAYS");return n.depth_mask=!1,n.use_backface_culling=!0,le(n,E.generate_billboard()),ge(n,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf"),se(n,"DEPTH_RGBA",e?1:0),se(n,"WATER_EFFECTS",t?1:0),se(n,"STEPS_PER_PASS",f.glsl_value(r,1)),se(n,"SHADOW_USAGE","NO_SHADOWS"),Ne(n),n},t.create_god_rays_combine_batch=function(){var e=C("GOD_RAYS_COM");return e.depth_mask=!1,e.use_backface_culling=!0,le(e,E.generate_fullscreen_tri()),ge(e,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf"),se(e,"SAFARI_CANVAS_ALPHA_HACK",A.safari_canvas_alpha_hack?1:0),Ne(e),e},t.create_cube_sky_batch=function(e,t){var r=C("SKY");if(r.depth_mask=!1,r.use_backface_culling=!1,le(r,E.generate_plane(1,1)),""!=t.sky_ngraph_proxy_id)ge(r,"skybox.glslv","node_skybox.glslf"),se(r,"IS_WORLD",1),function(e,t){var r=t._render.world_light_set;if(""!=r.ngraph_proxy_id){e.has_nodes=!0,e.ngraph_proxy_id=r.ngraph_proxy_id;var n=s.get_ngraph_proxy_cached(r.ngraph_proxy_id).graph;if(!n)return o.error('Failed to create node graph for world "'+t.world.name+'", disable nodes'),te(e,t.world.name),!0;var a=null;i.traverse(n,(function(t,r){switch(r.type){case"TEXTURE_COLOR":case"TEXTURE_ENVIRONMENT_EQUIRECTANGULAR":case"TEXTURE_ENVIRONMENT_MIRROR_BALL":Oe(e,r.data.value,r.data.name,r.data.bpy_name);break;case"VALTORGB":case"CURVE_VEC":case"CURVE_RGB":a||(a=r.data.texture);break;case"VECT_TRANSFORM":switch(Number(r.dirs[1][1])){case s.VT_WORLD_TO_OBJECT:se(e,"USE_MODEL_TSR_INVERSE",1);break;case s.VT_WORLD_TO_CAMERA:se(e,"USE_VIEW_TSR",1);break;case s.VT_OBJECT_TO_WORLD:se(e,"USE_MODEL_TSR",1);break;case s.VT_OBJECT_TO_CAMERA:se(e,"USE_MODEL_TSR",1),se(e,"USE_VIEW_TSR",1);break;case s.VT_CAMERA_TO_WORLD:se(e,"USE_VIEW_TSR_INVERSE",1);break;case s.VT_CAMERA_TO_OBJECT:se(e,"USE_MODEL_TSR_INVERSE",1),se(e,"USE_VIEW_TSR_INVERSE",1)}break;case"B4W_VECTOR_VIEW":se(e,"USE_VIEW_TSR",1);break;case"B4W_REFLECT":se(e,"USE_VIEW_TSR_INVERSE",1)}})),a&&Oe(e,a,"u_nodes_texture");var _=e.shaders_info.node_elements=s.compose_node_elements(n);$(n,e);for(var l=e.node_value_inds,c=e.node_rgb_inds,E=0;E<_.length;E++){var u=_[E];switch(u.id){case"VALUE":if(T=u.param_values[0])for(var d=0;d<l.length;d+=3)if(l[d]==T){u.dirs.push(["VALUE_ROW_IND",l[d+1]]),u.dirs.push(["VALUE_COL_IND",l[d+2]]);break}break;case"RGB":var T;if(T=u.param_values[0])for(d=0;d<c.length;d+=2)if(c[d]==T){u.dirs.push(["RGB_IND",c[d+1]]);break}}}se(e,"NUM_VALUES",e.node_values.length/4),se(e,"NUM_RGBS",e.node_rgbs.length)}}(r,e);else if(t.procedural_skydome)ge(r,"skybox.glslv","proc_skybox.glslf"),se(r,"WATER_EFFECTS",1);else{if(ge(r,"skybox.glslv","tex_skybox.glslf"),e){var n=e._render.world_light_set;if(n.sky_texture_slot){var a=n.sky_texture_slot.texture;Oe(r,P.get_batch_texture(n.sky_texture_slot,null),"u_sky_texture",a.name)}n.sky_texture_param&&se(r,"WO_SKYTEX",1)}t.sky_invert&&se(r,"MTEX_NEGATIVE",1),t.sky_use_rgb_to_intensity&&se(r,"MTEX_RGBTOINT",1),se(r,"BLENDTYPE",t.sky_blend_type),t.sky_use_map_blend&&se(r,"WOMAP_BLEND",1),t.sky_use_map_horizon&&se(r,"WOMAP_HORIZ",1),t.sky_use_map_zenith_up&&se(r,"WOMAP_ZENUP",1),t.sky_use_map_zenith_down&&se(r,"WOMAP_ZENDOWN",1),t.use_sky_blend&&se(r,"WO_SKYBLEND",1),t.use_sky_paper&&se(r,"WO_SKYPAPER",1),t.use_sky_real&&se(r,"WO_SKYREAL",1)}return Ne(r),r},t.append_cube_sky_batch_to_world=function(e,t){var r=d.find_subs(e._render.graph,p.SKY);r&&l.append_batch(t,e,r.draw_data[0].bundles[0].batch)},t.create_cube_irradiance_batch=function(e,t){var r=C("IRRADIANCE");return r.depth_mask=!1,r.use_backface_culling=!1,le(r,E.generate_plane(1,1)),ge(r,"skybox.glslv","irradiance_skybox.glslf"),Ne(r),r},t.create_cube_roughness_convolution_batch=function(e,t){var r=C("R_CONVOLUTION");return r.depth_mask=!1,r.use_backface_culling=!1,le(r,E.generate_plane(1,1)),ge(r,"skybox.glslv","r_convolution_skybox.glslf"),Ne(r),r},t.create_brdf_batch=function(e,t){var r=C("BRDF");return r.depth_mask=!1,r.use_backface_culling=!1,le(r,E.generate_plane(1,1)),ge(r,"postprocessing/postprocessing.glslv","postprocessing/precompute_brdf.glslf"),Ne(r),r},t.create_antialiasing_batch=function(e){var t=C("ANTIALIASING");return t.depth_mask=!1,t.use_backface_culling=!0,le(t,E.generate_fullscreen_tri()),ge(t,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf"),A.quality_aa_method?(se(t,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),se(t,"AA_QUALITY",e.fxaa_quality)):se(t,"AA_METHOD","AA_METHOD_FXAA_LIGHT"),Ne(t),t},t.create_smaa_batch=function(e){var t=C("SMAA");return le(t,E.generate_fullscreen_tri()),ge(t,"postprocessing/smaa.glslv","postprocessing/smaa.glslf"),se(t,"AA_METHOD","AA_METHOD_SMAA_HIGH"),se(t,"SMAA_PASS",e),se(t,"SMAA_PREDICATION",0),se(t,"SMAA_REPROJECTION",0),Ne(t),t.depth_mask=!1,t.use_backface_culling=!0,t},t.create_compositing_batch=function(){var e=C("COMPOSITING");return e.depth_mask=!1,e.use_backface_culling=!0,le(e,E.generate_fullscreen_tri()),ge(e,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf"),Ne(e),e},t.create_motion_blur_batch=function(e){var t=C("MOTION_BLUR");return t.use_backface_culling=!0,t.depth_mask=!1,le(t,E.generate_fullscreen_tri()),ge(t,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf"),Ne(t),t},t.create_stereo_batch=function(e){var t=C("STEREO");return t.use_backface_culling=!0,t.depth_mask=!1,le(t,E.generate_fullscreen_tri()),ge(t,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf"),se(t,"ANAGLYPH","ANAGLYPH"===e?1:0),se(t,"SIDEBYSIDE","SIDEBYSIDE"===e?1:0),se(t,"DISTOR_SCALE",m.nonwebvr.distor_scale),Ne(t),t},t.create_luminance_batch=function(){var e=C("LUMINANCE");return e.depth_mask=!1,e.use_backface_culling=!0,le(e,E.generate_fullscreen_tri()),ge(e,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf"),Ne(e),e},t.create_average_luminance_batch=function(){var e=C("LUMINANCE");return e.depth_mask=!1,e.use_backface_culling=!0,le(e,E.generate_fullscreen_tri()),ge(e,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf"),Ne(e),e},t.create_luminance_truncated_batch=function(e){var t=C("LUMINANCE_X_BLUR");return t.depth_mask=!1,t.use_backface_culling=!0,le(t,E.generate_fullscreen_tri()),ge(t,"postprocessing/postprocessing.glslv","postprocessing/luminance_truncated.glslf"),e&&f.set_directive(t.shaders_info,"ADAPTIVE_BLOOM",1),Ne(t),t},t.create_bloom_combine_batch=function(e){var t=C("BLOOM");if(t.depth_mask=!1,t.use_backface_culling=!0,le(t,E.generate_fullscreen_tri()),ge(t,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf"),1==e)var r="BLUR_PASS_1";else 2==e?r="BLUR_PASS_2":3==e?r="BLUR_PASS_3":4==e?r="BLUR_PASS_4":5==e&&(r="BLUR_PASS_5");return f.set_directive(t.shaders_info,"BLUR_PASS_NUM",r),Ne(t),t},t.create_velocity_batch=function(){var e=C("VELOCITY");return e.depth_mask=!1,e.use_backface_culling=!0,le(e,E.generate_fullscreen_tri()),ge(e,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf"),Ne(e),e},t.create_anchor_visibility_batch=function(){var e=C("ANCHOR_VISIBILITY");return e.depth_mask=!0,e.use_backface_culling=!0,e.draw_mode=S.DM_TRIANGLES,ge(e,"anchors.glslv","anchors.glslf"),le(e,E.generate_index(1)),se(e,"ANCHOR_NUM",1),Ne(e),e.anchor_positions=new Float32Array(3),e},t.create_performance_batch=function(){var e=C("PERFORMANCE");return e.depth_mask=!1,e.use_backface_culling=!0,le(e,E.generate_fullscreen_tri()),ge(e,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf"),Ne(e),e},t.update_anchor_visibility_batch=function(e,t){var r=t.length/3;r!=e.anchor_positions.length/3&&(le(e,E.generate_index(r)),se(e,"ANCHOR_NUM",r),Ne(e)),e.anchor_positions=t},t.get_first_batch=function(e){if(!e.scenes_data.length)return null;var t=e.scenes_data[0];return t.batches.length?t.batches[0]:null},t.find_batch_material_any=function(e,t,r){for(var n=e.scenes_data[0].batches,a=0;a<n.length;a++)if(n[a].type==r&&-1!=n[a].material_names.indexOf(t))return n[a];return null},t.find_batch_material=function(e,t,r){for(var n=e.scenes_data[0].batches,a=0;a<n.length;a++)if(n[a].type==r&&!n[a].forked_batch&&-1!=n[a].material_names.indexOf(t))return n[a];return null},t.find_batch_material_forked=function(e,t,r){for(var n=e.scenes_data[0].batches,a=0;a<n.length;a++)if(n[a].type==r&&n[a].forked_batch&&-1!=n[a].material_names.indexOf(t))return n[a];return null},t.iterate_batches_by_mat=function(e,t,r,n){for(var a=e.scenes_data[0].batches,o=0;o<a.length;o++){var _=a[o];if(-1!=_.material_names.indexOf(t)&&(!n||_.type==n)&&r(_))return}},t.check_batch_type=function(e,t){for(var r=e.scenes_data[0].batches,n=0;n<r.length;n++)if(r[n].type==t)return!0;return!1},t.get_batch_by_type=function(e,t,r){for(var n=(r?l.get_scene_data(e,r):e.scenes_data[0]).batches,a=0;a<n.length;a++)if(n[a].type==t)return n[a];return null},t.clear_batch=function(e){var t=e.textures;e.textures=[];for(var r=0;r<t.length;r++)P.cleanup_unused(t[r]);if(e.textures=t,e.bufs_data&&e.bufs_data.cleanup_gl_data_on_unload&&S.cleanup_bufs_data(e.bufs_data),e.cleanup_gl_data_on_unload&&e.vaos.length&&u.cleanup_vao(e),e.shader&&e.shader.cleanup_gl_data_on_unload&&f.cleanup_shader(e.shader),e.ngraph_proxy_id){var n=s.get_ngraph_proxy_cached(e.ngraph_proxy_id);n&&n.cleanup_on_unload&&s.cleanup_ngraph_proxy(e.ngraph_proxy_id)}},t.set_cleanup_nodemat=function(e,t){if(""!==e.ngraph_proxy_id){var r=s.get_ngraph_proxy_cached(e.ngraph_proxy_id);r&&(r.cleanup_on_unload=t)}},t.generate_odd_id=Re,t.cleanup=function(){Y={}},t.set_nodemat_value=function(e,t,r){for(var n=e.node_value_inds,a=0;a<n.length;a+=3)if(n[a]==t)return e.node_values[4*n[a+1]+n[a+2]]=r,!0;return!1},t.set_nodemat_rgb=function(e,t,r,n,a){for(var o=e.node_rgb_inds,_=0;_<o.length;_+=2)if(o[_]==t){var i=o[_+1];return e.node_rgbs[3*i]=r,e.node_rgbs[3*i+1]=n,e.node_rgbs[3*i+2]=a,!0}return!1},t.get_nodemat_value=function(e,t){for(var r=e.node_value_inds,n=0;n<r.length;n+=3)if(r[n]==t)return e.node_values[4*r[n+1]+r[n+2]];return null},t.get_nodemat_rgb=function(e,t,r){for(var n=e.node_rgb_inds,a=0;a<n.length;a+=2)if(n[a]==t){var o=n[a+1];return r[0]=e.node_rgbs[3*o],r[1]=e.node_rgbs[3*o+1],r[2]=e.node_rgbs[3*o+2],r}return null}})),ZI=nA("__anchors",(function(e,t){var r=JI(e),n=pb(e),a=dR(e),o=fb(e),_=NI(e),i=KI(e),s=PI(e),l=mN(e),c=tI(e),E=LI(e),u=mR(e),d=AR(e),T=MI(e),f=a.defaults,p=[],P=!1,S=null,A=!1,h=!1,v=new Float32Array(0),m=new Uint8Array(16),g=new Float32Array(2),O=new Float32Array(3),N=new Float32Array(3);function R(e){if(!h&&!P){var t=S;if(t){if("visible"==t.lastElementChild.style.visibility)return I(),void(S=null);if(1==t.style.opacity){var r=t.lastElementChild,n=t.firstElementChild,a=r.firstElementChild,o=Math.ceil(r.getBoundingClientRect().width),_=Math.ceil(r.getBoundingClientRect().height),i=Math.ceil(n.getBoundingClientRect().width),s=Math.ceil(n.getBoundingClientRect().height);r.style.position="absolute",r.style.visibility="visible";var l=!0,c=!0;n.style.display="none",h=!0,i!=o?d.animate(i,o,200,(function(e){e==o&&(l=!1,c||E()),r.style.width=e+"px"})):(l=!1,c||(h=!1)),s!=_?d.animate(s,_,200,(function(e){e==_&&(c=!1,l||E()),r.style.height=e+"px"})):(c=!1,l||(h=!1))}}}function E(){h=!1,a.style.visibility="visible"}}function I(){var e=S.lastElementChild;S.firstElementChild.style.display="",e.style.visibility="hidden",e.style.position="relative",e.firstElementChild.style.visibility="hidden"}function b(e){e.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 1.25;"}function y(){for(var e=0,t=0;t<p.length;t++)p[t].detect_visibility&&e++;v=new Float32Array(3*e)}function L(e,t){return t.depth-e.depth}function Y(e,t,r){var n=e.element;f.ie_edge_anchors_floor_hack&&(t=Math.floor(t),r=Math.floor(r)),"transform"in n.style?n.style.transform="translate3d("+t+"px, "+r+"px, 0px)":"webkitTransform"in n.style?n.style.webkitTransform="translate3d("+t+"px, "+r+"px, 0px)":(n.style.left=t+"px",n.style.top=r+"px")}t.append=function(e){if(!w(e)){var t=e.anchor.detect_visibility&&Boolean(E.get_subs(E.get_main(),u.ANCHOR_VISIBILITY)),r={type:e.anchor.type,obj:e,x:0,y:0,depth:0,appearance:"out",detect_visibility:t,element:null,move_cb:null,annotation_max_width:e.anchor.max_width,element_id:e.anchor.element_id};switch(r.type){case"ANNOTATION":r.element=function(e){var t=e.obj,r=o.get_container(),n=i.get_meta_tags(t),a=t.name,s="",l=document.createElement("div"),c=l.cloneNode(!1),E=document.createElement("span");return l.style.cssText+="position:        absolute;height:          0;top:             0;left:            0;transform-style: preserve-3d;",c.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);opacity:            1.0;box-sizing:         border-box;bottom:             0;left:               0;padding:            6px 12px 6px 12px;position:           absolute;",l.style.visibility="hidden",n&&(s=n.description||s,a=n.title||a),E.innerHTML=a,function(e){e.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;"}(E),b(E),E.style.whiteSpace="nowrap",c.appendChild(E),l.appendChild(c),s&&function(e,t,r){var n=document.createElement("div"),a=document.createElement("span");r&&(n.style.maxWidth=r+"px"),n.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);left:               0;box-sizing:         border-box;opacity:            1.0;padding:            6px 12px 6px 12px;position:           relative;z-index:            2;",b(a),a.innerHTML=e,n.style.visibility="hidden",a.style.visibility="hidden",n.appendChild(a),t.appendChild(n),_.add_click_listener(t,(function(e){h||t!=S&&1==t.style.opacity&&(P||(S&&"visible"==S.lastElementChild.style.visibility&&I(),S=t))}))}(s,l,e.annotation_max_width),r.appendChild(l),l}(r);break;case"ELEMENT":if(r.element=document.getElementById(e.anchor.element_id),r.element)for(var n=0;n<p.length;n++)"ELEMENT"==p[n].type&&p[n].element_id==e.anchor.element_id&&(l.warn("Anchor with the id '"+e.anchor.element_id+"' already exists, making the new anchor generic."),r.type="GENERIC");else l.warn("Anchor HTML element with the id '"+e.anchor.element_id+"' was not found, making it generic."),r.type="GENERIC"}p.push(r),y(),A||(A=!0,o.get_container().addEventListener("mouseup",R))}},t.remove=function(e){for(var t=0;t<p.length;t++){var r=p[t];if(r.obj==e){"ANNOTATION"==r.type&&C(r),p.splice(t,1),y(),t--;break}}},t.update=function(e){for(var t=0,n=p.length;n--;){if((c=p[n]).detect_visibility){var a=jm(c.obj.render.world_tsr,O);v.set(a,3*t++)}var o=M(c,O),_=o[0],i=o[1],s=o[2];if(e||_!=c.x||i!=c.y||s!=c.depth){switch(c.type){case"ANNOTATION":Y(c,_,i);break;case"ELEMENT":var l=c.element.getBoundingClientRect();Y(c,_-l.width/2,i-l.height/2)}c.x=_,c.y=i,c.depth=s,c.move_cb&&c.move_cb(_,i,c.appearance,c.obj,c.element)}}for(p.sort(L),n=0;n<p.length;n++){var c;"GENERIC"!=(c=p[n]).type&&(c.element.style.zIndex=S==c.element?p.length:n)}if(t>0){var d=E.get_subs(E.get_main(),u.ANCHOR_VISIBILITY),T=d.draw_data[0].bundles[0];r.update_anchor_visibility_batch(T.batch,v),u.append_draw_data(d,T)}};var M=function(){var e=ih();return function(t,r){var a=E.get_camera(E.get_main()),o=jm(t.obj.render.world_tsr,e);return n.project_point(a,o,r),Km(o,t.obj.render.world_tsr),r}}();function x(e){var t=E.get_subs(E.get_main(),u.ANCHOR_VISIBILITY).camera,r=o.canvas_to_viewport_coords(e.x,e.y,g,t);return c.read_pixels(t.framebuffer,r[0],t.height-r[1],2,2,m),m[0]+m[4]+m[8]+m[12]>=255?"visible":"out"==e.appearance||m[0]+m[4]+m[8]+m[12]==0?"covered":e.appearance}function C(e){o.get_container().removeChild(e.element)}function w(e){for(var t=0;t<p.length;t++)if(p[t].obj==e)return!0;return!1}function U(e,t,r){if(e.element)var n=Math.round(e.element.offsetWidth)||0,a=Math.round(e.element.offsetHeight)||0;else n=0,a=0;var o=e.x,_=e.y;return t>=o&&t<=o+n&&r<_&&r>=_-a}function k(e,t){if(!e.is_lod)return!0;var r=e.lod_dist_max;return!(t<e.lod_dist_min)&&(r==s.LOD_DIST_MAX_INFINITY||t<r)}t.update_visibility=function(){for(var e=o.get_container(),t=E.get_active(),r=E.get_subs(t,u.STEREO),n=Boolean(r&&r.enable_hmd_stereo),a=p.length;a--;){var _=p[a],i=_.obj,s=i.render,l=_.x,c=_.y,d=_.depth,f=E.get_camera(E.get_main()),P=hh(T.get_translation(i,O),T.get_translation(f,N));if(l<0||c<0||d<0||d>1||E.is_hidden(i)||l>=e.clientWidth||c>=e.clientHeight||!k(s,P))var A="out";else A="visible";if(_.detect_visibility&&"out"!=A&&(A=x(_)),n&&(A="out"),A!=_.appearance){switch(_.type){case"ANNOTATION":case"ELEMENT":var h=_.element;if(!h)break;"out"==A?(h.style.visibility="hidden",h.children.length&&(h.children[0].style.visibility="hidden")):"visible"==A?(h.style.visibility="visible",h.children.length&&(h.children[0].style.visibility="visible"),h.style.opacity=1):(h.style.visibility="visible",h.style.opacity=.1,h.children.length&&(h.children[0].style.visibility="visible"),"ANNOTATION"==_.type&&h.children.length>1&&"visible"==h.lastElementChild.style.visibility&&(I(),h==S&&(S=null)))}_.appearance=A,_.move_cb&&_.move_cb(l,c,_.appearance,i,h)}}},t.attach_move_cb=function(e,t){for(var r=0;r<p.length;r++)p[r].obj==e&&(p[r].move_cb=t)},t.detach_move_cb=function(e){for(var t=0;t<p.length;t++)p[t].obj==e&&(p[t].move_cb=null)},t.cleanup=function(){for(var e=0;e<p.length;e++){var t=p[e];"ANNOTATION"==t.type&&C(t)}p.length=0},t.is_anchor=w,t.get_element_id=function(e){for(var t=0;t<p.length;t++)if(p[t].obj==e)return p[t].element_id;return!1},t.pause=function(){P=!0},t.resume=function(){P=!1},t.pick_anchor=function(e,t){for(var r=-1,n=0;n<p.length;n++)if("visible"==p[n].appearance&&U(p[n],e,t))if(r<0){var a=p[n].depth;r=n}else p[n].depth<a&&(r=n,a=p[n].depth);return r<0?null:p[r].obj}})),$I=nA("__controls",(function(e,t){var r=gN(e),n=dR(e),a=fb(e),o=NI(e),_=KI(e),i=mN(e),s=CI(e),l=AR(e),c=n.controls,E=n.defaults,u=[],d={},T=[],f=[],p=[],P=new Float32Array(2),S=new Float32Array(2),A=ih(),h=dm(),v=!1,m=0;t.CT_POSITIVE=10,t.CT_CONTINUOUS=20,t.CT_TRIGGER=30,t.CT_SHOT=40,t.CT_LEVEL=50,t.CT_CHANGE=60,t.PL_SINGLE_TOUCH_MOVE=0,t.PL_MULTITOUCH_MOVE_ZOOM=1,t.PL_MULTITOUCH_MOVE_PAN=2,t.PL_MULTITOUCH_MOVE_ROTATE=3;var g=1;function O(e,t){return t||(t=a.get_container()),{type:e,value:0,payload:null,element:t,do_activation:!1,key:0,collision_id:"",calc_pos_norm:!1,collision_obj:null,collision_cb:function(){},col_imp_obj:null,col_imp_cb:function(){},source_object:null,from:new Float32Array(3),to:new Float32Array(3),is_binary_value:!1,ign_src_rot:!1,ray_test_id:0,ray_test_cb:function(){},axis:"",time_last:0,trans_last:new Float32Array(3),quat_last:new Float32Array(4),threshold:0,quat_temp:new Float32Array(4),avg_linear_vel:0,avg_angular_vel:0,rotation_threshold:0,avg_vertical_vel:0,period:0,repeat:!1,enable_toggle_switch:!1,gamepad_id:0,position:ih(),orientation:dm(),callback:function(){}}}function N(e){e.mouse_select_data.is_updated||(e.mouse_select_data.obj=_.pick_object(e.mouse_select_data.coord[0],e.mouse_select_data.coord[1]),e.mouse_select_data.is_updated=!0,e.global_selected_obj=e.mouse_select_data.obj);for(var t=0;t<10;++t){var r=e.touch_select_dlist[t];r.is_updated||(r.obj=_.pick_object(r.coord[0],r.coord[1]),r.is_updated=!0,e.global_selected_obj=r.obj)}}function R(e){if(!e.is_updated_keyboard){for(var t=0;t<e.downed_keys.length;t++)1==e.downed_keys[t]?e.downed_keys[t]=2:3==e.downed_keys[t]&&(e.downed_keys[t]=0);e.is_updated_keyboard=!0}1==e.mouse_state?e.mouse_state=2:3==e.mouse_state&&(e.mouse_state=0);for(var r=0;r<e.touch_select_dlist.length;r++){var n=e.touch_select_dlist[r];1==n.touch_state?n.touch_state=2:3==n.touch_state&&(n.touch_state=0)}e.wheel_delta=0,e.mouse_last_x=e.mouse_curr_x,e.mouse_last_y=e.mouse_curr_y,e.downed_keys[0]=0,e.touches_last_x.set(e.touches_curr_x),e.touches_last_y.set(e.touches_curr_y),e.touch_zoom_last_dist=e.touch_zoom_curr_dist,e.gyro_gamma_last=e.gyro_gamma_new,e.gyro_beta_last=e.gyro_beta_new,e.gyro_alpha_last=e.gyro_alpha_new,e.is_updated_gyro_quat=!1}function I(e){e||(e=a.get_container());for(var t=0;t<p.length;t++)if(e==(r=p[t]).element)return r;var r={element:e,is_updated_keyboard:!0,mouse_state:0,is_touch_ended:!0,mouse_last_x:0,mouse_last_y:0,mouse_curr_x:0,mouse_curr_y:0,pointerlock_dx:0,pointerlock_dy:0,touches_last_x:new Float32Array(2),touches_curr_x:new Float32Array(2),touches_last_y:new Float32Array(2),touches_curr_y:new Float32Array(2),touch_zoom_curr_dist:0,touch_zoom_last_dist:0,touch_start_rot:0,downed_keys:new Uint8Array(256),wheel_delta:0,global_selected_obj:null,mouse_select_data:n(),touch_select_dlist:new Array(10),is_updated_gyro_quat:!1,gyro_quat:dm(),gyro_gamma_new:0,gyro_beta_new:0,gyro_alpha_new:0,gyro_gamma_last:0,gyro_beta_last:0,gyro_alpha_last:1/0,orientation_quat_cb:null,orientation_angles_cb:null,mouse_wheel_cb:null,mouse_down_which_cb:null,mouse_select_cb:null,touch_select_start_cb:null,touch_select_end_cb:null,mouse_up_which_cb:null,mouse_location_cb:null,pointerlock_cb:null,keyboard_downed_keys_cb:null,touch_start_cb:null,touch_move_cb:null,touch_end_cb:null,registered_accum_values:{}};for(t=0;t<10;++t)r.touch_select_dlist[t]=n();function n(){return{coord:new Float32Array(2),is_updated:!0,obj:null,identifier:-1,touch_state:0}}return r.orientation_quat_cb=function(e){r.is_updated_gyro_quat||(o.gyro_angles_to_quat(e,r.gyro_quat),r.is_updated_gyro_quat=!0)},r.orientation_angles_cb=function(e){var t=ch(e,A);r.gyro_alpha_new=t[0],r.gyro_beta_new=t[1],r.gyro_gamma_new=t[2],r.gyro_alpha_last==1/0&&(r.gyro_alpha_last=t[0],r.gyro_beta_last=t[1],r.gyro_gamma_last=t[2])},r.mouse_wheel_cb=function(e){r.wheel_delta+=e*c.mouse_wheel_notch_multiplier},r.mouse_down_which_cb=function(e){var t=o.get_device_by_type_element(o.DEVICE_MOUSE,r.element),n=o.get_vector_param(t,o.MOUSE_LOCATION,P);r.mouse_last_x=n[0],r.mouse_last_y=n[1],r.mouse_curr_x=n[0],r.mouse_curr_y=n[1],3!=r.mouse_state&&0!=r.mouse_state||(r.mouse_state=1),r.which=e},r.mouse_select_cb=function(e){var t=o.get_device_by_type_element(o.DEVICE_MOUSE,r.element),n=o.get_vector_param(t,o.MOUSE_LOCATION,P),_=a.client_to_canvas_coords(n[0],n[1],P);r.mouse_select_data.is_updated=!1,r.mouse_select_data.coord[0]=_[0],r.mouse_select_data.coord[1]=_[1]},r.touch_select_start_cb=function(e){for(var t=0;t<e.length;++t){for(var n=e[t],o=null,_=null,i=0;i<r.touch_select_dlist.length;i++){var s=r.touch_select_dlist[i],l=3==s.touch_state||0==s.touch_state;if(s.identifier==n.identifier){l&&(_=s);break}!o&&l&&((o=s).identifier=n.identifier)}var c=_||o;if(c){var E=a.client_to_canvas_coords(e[t].clientX,e[t].clientY,P);c.is_updated=!1,c.touch_state=1,c.coord[0]=E[0],c.coord[1]=E[1]}}},r.touch_select_end_cb=function(e){for(var t=0;t<r.touch_select_dlist.length;++t){for(var n=r.touch_select_dlist[t],a=!1,o=0;o<e.length;++o)if(e[o].identifier==n.identifier){a=!0;break}a||(0!=n.touch_state&&(n.touch_state=3),n.obj=null)}},r.mouse_up_which_cb=function(e){var t=o.get_device_by_type_element(o.DEVICE_MOUSE,r.element),n=o.get_vector_param(t,o.MOUSE_LOCATION,P);r.mouse_last_x=n[0],r.mouse_last_y=n[1],r.mouse_curr_x=n[0],r.mouse_curr_y=n[1],0!=r.mouse_state&&(r.mouse_state=3),r.which=e},r.mouse_location_cb=function(e){E.ie11_edge_touchscreen_hack&&0==r.mouse_state||(r.mouse_curr_x=e[0],r.mouse_curr_y=e[1])},r.pointerlock_cb=function(e){r.pointerlock_dx+=e[0],r.pointerlock_dy+=e[1]},r.keyboard_down_keys_cb=function(e){2!=r.downed_keys[e]&&(r.downed_keys[e]=1,r.is_updated_keyboard=!1)},r.keyboard_down_mod_keys_cb=function(e){for(var t=0;t<r.downed_keys.length;t++)0!=r.downed_keys[t]&&(r.downed_keys[t]=3,r.is_updated_keyboard=!1)},r.keyboard_up_keys_cb=function(e){r.is_updated_keyboard=!1,r.downed_keys[e]=3},r.touch_start_cb=function(e){if(r.is_touch_ended=!1,1==e.length)r.touches_last_x[0]=e[0].clientX,r.touches_last_x[1]=-1,r.touches_last_y[0]=e[0].clientY,r.touches_last_y[1]=-1;else if(e.length>1){var t=F(e);r.touch_zoom_curr_dist=r.touch_zoom_last_dist=t,r.touches_last_x[0]=e[0].clientX,r.touches_last_x[1]=e[1].clientX,r.touches_last_y[0]=e[0].clientY,r.touches_last_y[1]=e[1].clientY,r.touch_start_rot=function(e){var t=e[0],r=e[1];return Math.atan2(t.clientY-r.clientY,t.clientX-r.clientX)}(e)}r.touches_curr_x.set(r.touches_last_x),r.touches_curr_y.set(r.touches_last_y)},r.touch_move_cb=function(e){if(1===e.length)r.touches_curr_x[0]=e[0].clientX,r.touches_curr_x[1]=-1,r.touches_curr_y[0]=e[0].clientY,r.touches_curr_y[1]=-1;else if(e.length>1){r.touches_curr_x[0]=e[0].clientX,r.touches_curr_x[1]=e[1].clientX,r.touches_curr_y[0]=e[0].clientY,r.touches_curr_y[1]=e[1].clientY;var t=F(e);r.touch_zoom_curr_dist=t}},r.touch_end_cb=function(e){0==e.length&&(r.is_touch_ended=!0)},p.push(r),r}function b(e,t){if(t in e.registered_accum_values&&e.registered_accum_values[t]>0)e.registered_accum_values[t]+=1;else switch(e.registered_accum_values[t]=1,t){case"orientation_quat":(r=o.get_device_by_type_element(o.DEVICE_GYRO))&&o.attach_param_cb(r,o.GYRO_ORIENTATION_ANGLES,e.orientation_quat_cb);break;case"orientation_angles":(r=o.get_device_by_type_element(o.DEVICE_GYRO))&&o.attach_param_cb(r,o.GYRO_ORIENTATION_ANGLES,e.orientation_angles_cb);break;case"mouse_wheel":(r=o.get_device_by_type_element(o.DEVICE_MOUSE,e.element))&&o.attach_param_cb(r,o.MOUSE_WHEEL,e.mouse_wheel_cb);break;case"mouse_down_which":(r=o.get_device_by_type_element(o.DEVICE_MOUSE,e.element))&&o.attach_param_cb(r,o.MOUSE_DOWN_WHICH,e.mouse_down_which_cb);break;case"mouse_select":(r=o.get_device_by_type_element(o.DEVICE_MOUSE,e.element))&&o.attach_param_cb(r,o.MOUSE_DOWN_WHICH,e.mouse_select_cb);break;case"touch_select":(r=o.get_device_by_type_element(o.DEVICE_TOUCH,e.element))&&(o.attach_param_cb(r,o.TOUCH_START,e.touch_select_start_cb),o.attach_param_cb(r,o.TOUCH_END,e.touch_select_end_cb));break;case"mouse_up_which":(r=o.get_device_by_type_element(o.DEVICE_MOUSE,e.element))&&o.attach_param_cb(r,o.MOUSE_UP_WHICH,e.mouse_up_which_cb);break;case"mouse_location":(r=o.get_device_by_type_element(o.DEVICE_MOUSE,e.element))&&o.attach_param_cb(r,o.MOUSE_LOCATION,e.mouse_location_cb);break;case"mouse_pointerlock":(r=o.get_device_by_type_element(o.DEVICE_MOUSE,e.element))&&o.attach_param_cb(r,o.MOUSE_LOCATION_PL,e.pointerlock_cb);break;case"keyboard_downed_keys":(r=o.get_device_by_type_element(o.DEVICE_KEYBOARD,e.element))&&(o.attach_param_cb(r,o.KEYBOARD_DOWN,e.keyboard_down_keys_cb),o.attach_param_cb(r,o.KEYBOARD_DOWN_MODIFIED,e.keyboard_down_mod_keys_cb),o.attach_param_cb(r,o.KEYBOARD_UP,e.keyboard_up_keys_cb));break;case"touch_start":(r=o.get_device_by_type_element(o.DEVICE_TOUCH,e.element))&&o.attach_param_cb(r,o.TOUCH_START,e.touch_start_cb);break;case"touch_move":(r=o.get_device_by_type_element(o.DEVICE_TOUCH,e.element))&&o.attach_param_cb(r,o.TOUCH_MOVE,e.touch_move_cb);break;case"touch_end":var r;(r=o.get_device_by_type_element(o.DEVICE_TOUCH,e.element))&&o.attach_param_cb(r,o.TOUCH_END,e.touch_end_cb)}}function y(e,t){if(t in e.registered_accum_values&&e.registered_accum_values[t]>0&&(e.registered_accum_values[t]-=1,!e.registered_accum_values[t]))switch(t){case"orientation_quat":(r=o.get_device_by_type_element(o.DEVICE_GYRO))&&o.detach_param_cb(r,o.GYRO_ORIENTATION_QUAT,e.orientation_quat_cb);break;case"orientation_angles":(r=o.get_device_by_type_element(o.DEVICE_GYRO))&&o.detach_param_cb(r,o.GYRO_ORIENTATION_ANGLES,e.orientation_angles_cb);break;case"mouse_wheel":(r=o.get_device_by_type_element(o.DEVICE_MOUSE,e.element))&&o.detach_param_cb(r,o.MOUSE_WHEEL,e.mouse_wheel_cb);break;case"mouse_down_which":(r=o.get_device_by_type_element(o.DEVICE_MOUSE,e.element))&&o.detach_param_cb(r,o.MOUSE_DOWN_WHICH,e.mouse_down_which_cb);break;case"mouse_select":(r=o.get_device_by_type_element(o.DEVICE_MOUSE,e.element))&&o.detach_param_cb(r,o.MOUSE_DOWN_WHICH,e.mouse_select_cb);break;case"touch_select":(r=o.get_device_by_type_element(o.DEVICE_TOUCH,e.element))&&(o.detach_param_cb(r,o.TOUCH_START,e.touch_select_start_cb),o.detach_param_cb(r,o.TOUCH_END,e.touch_select_end_cb));break;case"mouse_up_which":(r=o.get_device_by_type_element(o.DEVICE_MOUSE,e.element))&&o.detach_param_cb(r,o.MOUSE_UP_WHICH,e.mouse_up_which_cb);break;case"mouse_location":(r=o.get_device_by_type_element(o.DEVICE_MOUSE,e.element))&&o.detach_param_cb(r,o.MOUSE_LOCATION,e.mouse_location_cb);break;case"mouse_pointerlock":(r=o.get_device_by_type_element(o.DEVICE_MOUSE,e.element))&&o.detach_param_cb(r,o.MOUSE_LOCATION_PL,e.pointerlock_cb);break;case"keyboard_downed_keys":(r=o.get_device_by_type_element(o.DEVICE_KEYBOARD,e.element))&&(o.detach_param_cb(r,o.KEYBOARD_DOWN,e.keyboard_down_keys_cb),o.detach_param_cb(r,o.KEYBOARD_DOWN_MODIFIED,e.keyboard_down_mod_keys_cb),o.detach_param_cb(r,o.KEYBOARD_UP,e.keyboard_up_keys_cb));break;case"touch_start":(r=o.get_device_by_type_element(o.DEVICE_TOUCH,e.element))&&o.detach_param_cb(r,o.TOUCH_START,e.touch_start_cb);break;case"touch_move":(r=o.get_device_by_type_element(o.DEVICE_TOUCH,e.element))&&o.detach_param_cb(r,o.TOUCH_MOVE,e.touch_move_cb);break;case"touch_end":var r;(r=o.get_device_by_type_element(o.DEVICE_TOUCH,e.element))&&o.detach_param_cb(r,o.TOUCH_END,e.touch_end_cb)}}function L(e,t){e.value=Number(t)}function Y(e){for(var t=e.sensors,r=e.sensor_values,n=0;n<t.length;n++)r[n]=t[n].value;return e.logic_fun(r)}function M(e,r,n){if(n)switch(e.type){case 120:var a=jm((d=e.source_object).render.world_tsr,A),_=Vm(d.render.world_tsr,h),i=hh(e.trans_last,a),s=e.quat_temp;Ym(e.quat_last,s),mm(_,s,s),am(s,s);var l=Math.abs(2*Math.acos(s[3])),c=i/n;e.avg_linear_vel=CO(c,e.avg_linear_vel,n,.3),e.payload[0]=c;var u=l/n;e.avg_angular_vel=CO(u,e.avg_angular_vel,n,.3),e.payload[1]=u,L(e,e.avg_linear_vel>=e.threshold||e.avg_angular_vel>=e.rotation_threshold?1:0),ch(a,e.trans_last),Bv(_,e.quat_last),e.time_last=r;break;case 130:a=jm((d=e.source_object).render.world_tsr,A);var d,T=Math.abs(a[1]-e.trans_last[1])/n;e.avg_vertical_vel=CO(T,e.avg_vertical_vel,n,.3),e.payload=T,L(e,e.avg_vertical_vel>=e.threshold?1:0),ch(a,e.trans_last),e.time_last=r;break;case 140:!e.do_activation&&e.period>=0&&r-e.time_last>=e.period&&(L(e,1),e.repeat?e.time_last=r:e.period=-e.period);break;case 150:e.time_last||(e.time_last=r),L(e,r-e.time_last),e.time_last=r;break;case 160:L(e,r);break;case 180:var f=I(e.element);e.payload[0]=f.gyro_gamma_new-f.gyro_gamma_last,e.payload[1]=f.gyro_beta_new-f.gyro_beta_last,e.payload[2]=f.gyro_alpha_new-f.gyro_alpha_last;break;case 190:f=I(e.element),e.payload[0]=f.gyro_gamma_new,e.payload[1]=f.gyro_beta_new,e.payload[2]=f.gyro_alpha_new;break;case 200:Bv((f=I(e.element)).gyro_quat,e.payload);break;case 210:var p=o.get_device_by_type_element(o.DEVICE_HMD);o.get_vector_param(p,o.HMD_ORIENTATION_QUAT,e.payload);break;case 220:p=o.get_device_by_type_element(o.DEVICE_HMD),o.get_vector_param(p,o.HMD_POSITION,e.payload);break;case 240:p=G(e.gamepad_id),e.value=o.get_gamepad_btn_value(p,e.key);break;case 250:p=G(e.gamepad_id),e.value=o.get_gamepad_axis_value(p,e.key);break;case 260:p=G(e.gamepad_id),o.get_gamepad_position(p,e.payload),L(e,1);break;case 270:p=G(e.gamepad_id),o.get_gamepad_orientation(p,e.payload),L(e,1);break;case 230:L(e,e.callback());break;case 30:L(e,(f=I(e.element)).wheel_delta);break;case 40:if(f=I(e.element),!E.ie11_edge_touchscreen_hack||1==f.mouse_state||2==f.mouse_state){var v=f.mouse_curr_x-f.mouse_last_x,m=f.mouse_curr_y-f.mouse_last_y;switch(e.payload.coords[0]=f.mouse_curr_x,e.payload.coords[1]=f.mouse_curr_y,e.axis){case"X":L(e,v);break;case"Y":L(e,m);break;case"XY":L(e,b=Math.sqrt(v*v+m*m))}}break;case 280:m=(f=I(e.element)).pointerlock_dy;var g=CO(v=f.pointerlock_dx,0,n,K()),O=CO(m,0,n,K());Math.abs(v)>.01||Math.abs(m)>.01?(f.pointerlock_dx-=g,f.pointerlock_dy-=O,e.payload.coords[0]=g,e.payload.coords[1]=O):(e.payload.coords[0]=0,e.payload.coords[1]=0),L(e,Math.sqrt(v*v+m*m));break;case 50:L(e,0!=(f=I(e.element)).mouse_state|0),e.payload.which=f.which,e.payload.coords[0]=f.mouse_curr_x,e.payload.coords[1]=f.mouse_curr_y;break;case 170:if(f=I(e.element),L(e,0),e.enable_toggle_switch)f.global_selected_obj==e.source_object&&L(e,1);else if(0!=f.mouse_state&&f.mouse_select_data.obj==e.source_object)L(e,1);else for(var N=0;N<10;++N){var R=f.touch_select_dlist[N];if(0!=R.touch_state&&R.obj==e.source_object){L(e,1);break}}break;case 20:f=I(e.element),e.payload=f.downed_keys[e.key],1==e.payload||f.downed_keys[0]&&16==e.key?L(e,1):e.payload||L(e,0);break;case 60:if(-1==(f=I(e.element)).touches_curr_x[1]&&-1==f.touches_curr_y[1]){v=f.touches_curr_x[0]-f.touches_last_x[0],m=f.touches_curr_y[0]-f.touches_last_y[0];var b=Math.sqrt(v*v+m*m);if(-1!=f.touches_last_x[1]&&-1!=f.touches_last_y[1]){var y=f.touches_curr_x[0]-f.touches_last_x[1],Y=f.touches_curr_y[0]-f.touches_last_y[1],M=Math.sqrt(y*y+Y*Y);M<b&&(v=y,m=Y,b=M)}e.payload.gesture=t.PL_SINGLE_TOUCH_MOVE}else{var x=P;x[0]=(f.touches_curr_x[0]+f.touches_curr_x[1])/2,x[1]=(f.touches_curr_y[0]+f.touches_curr_y[1])/2;var C=S;C[0]=(f.touches_last_x[0]+f.touches_last_x[1])/2,C[1]=(f.touches_last_y[0]+f.touches_last_y[1])/2,v=x[0]-C[0],m=x[1]-C[1],b=Math.sqrt(v*v+m*m),e.payload.gesture=t.PL_MULTITOUCH_MOVE_PAN}switch(e.payload.coords[0]=f.touches_curr_x[0],e.payload.coords[1]=f.touches_curr_y[0],e.axis){case"X":L(e,v);break;case"Y":L(e,m);break;case"XY":L(e,b)}break;case 70:var w=(f=I(e.element)).touch_zoom_curr_dist-f.touch_zoom_last_dist;e.payload=t.PL_MULTITOUCH_MOVE_ZOOM,L(e,w);break;case 75:if(-1!=(f=I(e.element)).touches_curr_x[1]){var U=Math.atan2(f.touches_curr_y[0]-f.touches_curr_y[1],f.touches_curr_x[0]-f.touches_curr_x[1]);e.payload=t.PL_MULTITOUCH_MOVE_ROTATE,L(e,U-f.touch_start_rot)}break;case 80:f=I(e.element),e.payload.coords[0]=f.touches_curr_x[0],e.payload.coords[1]=f.touches_curr_y[0],L(e,f.is_touch_ended?0:1)}}function x(e){var n=0;switch(e.type){case t.CT_POSITIVE:n=(o=Y(e))?1:0;break;case t.CT_CONTINUOUS:var a=e.last_pulse;(o=Y(e))?(n=1,e.last_pulse=1):1==a?(n=-1,e.last_pulse=-1):n=0;break;case t.CT_TRIGGER:a=e.last_pulse,(o=Y(e))&&-1==a?(n=1,e.last_pulse=1):o||1!=a?n=0:(n=-1,e.last_pulse=-1);break;case t.CT_SHOT:a=e.last_pulse,(o=Y(e))&&-1==a?(n=1,e.last_pulse=1):o||1!=a?n=0:(n=0,e.last_pulse=-1);break;case t.CT_LEVEL:var o=Y(e);e.last_logic_result!=o?(n=1,e.last_logic_result=o):n=0;break;case t.CT_CHANGE:for(var _=e.sensors,i=e.last_sensor_values,s=0;s<_.length;s++){var l=_[s].value;n||l==i[s]||(n=1),i[s]=l}break;default:r.panic("Wrong sensor manifold type: "+e.type)}return n}function C(e){for(var t=0;t<e.length;t++){var r=e[t];switch(r.type){case 30:case 40:case 60:case 70:case 75:case 80:case 140:L(r,0)}}}function w(e){if(e.do_activation){switch(e.type){case 90:s.append_collision_test(e.collision_obj,e.collision_id,e.collision_cb,e.calc_pos_norm);break;case 100:s.apply_collision_impulse_test(e.col_imp_obj,e.col_imp_cb);break;case 110:e.ray_test_id=s.append_ray_test(e.source_object,e.from,e.to,e.collision_id,e.ray_test_cb,!1,!1,e.calc_pos_norm,e.ign_src_rot),e.payload.ray_test_id=e.ray_test_id;break;case 140:e.time_last=l.get_timeline(),e.period<0&&(e.period=-e.period);break;case 20:b(t=I(e.element),"keyboard_downed_keys");break;case 30:b(t=I(e.element),"mouse_wheel");break;case 40:b(t=I(e.element),"mouse_down_which"),b(t,"mouse_up_which"),b(t,"mouse_location");break;case 280:b(t=I(e.element),"mouse_pointerlock");break;case 290:o.activate_pointerlock(e);break;case 50:b(t=I(e.element),"mouse_down_which"),b(t,"mouse_up_which");break;case 60:b(t=I(e.element),"touch_start"),b(t,"touch_move"),b(t,"touch_end");break;case 70:case 75:b(t=I(e.element),"touch_start"),b(t,"touch_move");break;case 80:b(t=I(e.element),"touch_start"),b(t,"touch_end");break;case 170:b(t=I(e.element),"mouse_select"),b(t,"touch_select"),b(t,"touch_start"),b(t,"touch_end"),b(t,"mouse_down_which"),b(t,"mouse_up_which");break;case 180:case 190:b(t=I(e.element),"orientation_angles");break;case 200:var t;b(t=I(e.element),"orientation_quat");break;case 240:case 260:case 270:o.get_device_by_type_element(0==e.gamepad_id?o.DEVICE_GAMEPAD0:1==e.gamepad_id?o.DEVICE_GAMEPAD1:2==e.gamepad_id?o.DEVICE_GAMEPAD2:o.DEVICE_GAMEPAD3)}e.do_activation=!1}}function U(e,t){var n=(e=e||d).sensor_manifolds;if(n){var a=e.sensor_manifolds_arr;if(t){var o=n[t];if(o){for(var _=o.sensors,s=0;s<_.length;s++){var l=_[s],c=k(l,T,f);if(1==c.length){D(l);var E=T.indexOf(l);E>-1?(T.splice(E,1),f.splice(E,1)):r.panic("Sensors cache is corrupted")}else c.length>1&&c.splice(c.indexOf(o),1)}delete n[t];var p=a.indexOf(o);p>-1?a.splice(p,1):r.panic("Incorrect manifolds array"),Object.getOwnPropertyNames(n).length||function(e){var t=u.indexOf(e);t>-1?u.splice(t,1):i.error("Wrong object")}(e)}}else{var P=[];for(var S in n)P.push(S);for(s=0;s<P.length;s++)U(e,P[s])}v=!0}}function k(e,t,r){var n=t.indexOf(e);return n>-1?r[n]:[]}function D(e){switch(e.type){case 90:s.remove_collision_test(e.collision_obj,e.collision_id,e.collision_cb),e.do_activation=!0;break;case 100:s.clear_collision_impulse_test(e.col_imp_obj),e.do_activation=!0;break;case 110:s.remove_ray_test(e.ray_test_id),e.do_activation=!0;break;case 140:e.do_activation=!0;break;case 20:y(t=I(e.element),"keyboard_downed_keys"),e.do_activation=!0;break;case 30:y(t=I(e.element),"mouse_wheel"),e.do_activation=!0;break;case 40:y(t=I(e.element),"mouse_down_which"),y(t,"mouse_up_which"),y(t,"mouse_location"),e.do_activation=!0;break;case 280:y(t=I(e.element),"mouse_pointerlock"),e.do_activation=!0;break;case 50:y(t=I(e.element),"mouse_down_which"),y(t,"mouse_up_which"),e.do_activation=!0;break;case 60:y(t=I(e.element),"touch_start"),y(t,"touch_move"),y(t,"touch_end"),e.do_activation=!0;break;case 70:case 75:y(t=I(e.element),"touch_start"),y(t,"touch_move"),e.do_activation=!0;break;case 80:y(t=I(e.element),"touch_start"),y(t,"touch_end"),e.do_activation=!0;break;case 170:y(t=I(e.element),"mouse_select"),y(t,"touch_select"),y(t,"touch_start"),y(t,"touch_end"),y(t,"mouse_down_which"),y(t,"mouse_up_which"),e.do_activation=!0;break;case 180:case 190:y(t=I(e.element),"orientation_angles"),e.do_activation=!0;break;case 200:var t;y(t=I(e.element),"orientation_quat"),e.do_activation=!0;break;case 210:case 220:e.do_activation=!0}}function F(e){var t=e[0],r=e[1],n=t.clientX-r.clientX,a=t.clientY-r.clientY;return Math.sqrt(n*n+a*a)}function G(e){if(0==e)var t=o.get_device_by_type_element(o.DEVICE_GAMEPAD0);else t=o.get_device_by_type_element(1==e?o.DEVICE_GAMEPAD1:2==e?o.DEVICE_GAMEPAD2:o.DEVICE_GAMEPAD3);return t}function K(){return.1*g}t.update=function(e,t){for(var r=0;r<p.length;r++)N(p[r]);for(r=0;r<T.length;r++)M(T[r],e,t);for(r=0;r<u.length;r++)for(var n=(_=u[r]).sensor_manifolds_arr,a=0;a<n.length;a++)if((i=n[a]).update_counter!=m){i.update_counter=m;var o=x(i);if(o&&(v=!1,i.callback(_==d?null:_,i.id,o,i.callback_param),v)){r=-1;break}}for(r=0;r<u.length;r++){var _;for(n=(_=u[r]).sensor_manifolds_arr,a=0;a<n.length;a++){var i;C((i=n[a]).sensors)}}for(r=0;r<p.length;r++)R(p[r]);m++},t.create_custom_sensor=function(e){var t=O(10);return L(t,e),t},t.create_keyboard_sensor=function(e){var t=O(20,document);return t.key=e,t.do_activation=!0,t},t.create_gamepad_btn_sensor=function(e,t){var r=O(240,document);return t=t||o.get_first_gmpd_id(),r.gamepad_id=t,r.key=e,r.do_activation=!0,r},t.create_gamepad_axis_sensor=function(e,t){var r=O(250,document);return t=null==t?o.get_first_gmpd_id():t,r.gamepad_id=t,r.key=e,r.do_activation=!0,r},t.create_gamepad_position_sensor=function(e){var t=O(260,document);return e=void 0===e?o.get_first_gmpd_id():e,t.gamepad_id=e,t.do_activation=!0,t.payload=ih(),t},t.create_gamepad_orientation_sensor=function(e){var t=O(270,document);return e=void 0===e?o.get_first_gmpd_id():e,t.gamepad_id=e,t.do_activation=!0,t.payload=dm(),t},t.create_collision_sensor=function(e,t,r){if(!e||!s.obj_has_physics(e))return i.error("Wrong collision object"),null;var n=O(90);return n.collision_obj=e,n.collision_id=t,n.calc_pos_norm=r,n.payload={coll_obj:null,coll_pos:r?new Float32Array(3):null,coll_norm:r?new Float32Array(3):null,coll_dist:0},n.collision_cb=function(e,t,r,a,o){L(n,e);var _=n.payload;_.coll_obj=t,n.calc_pos_norm&&(_.coll_pos.set(r),_.coll_norm.set(a),_.coll_dist=o)},n.do_activation=!0,n},t.create_collision_impulse_sensor=function(e){if(!e||!e.physics)return i.error("Wrong collision impulse object"),null;var t=O(100);return t.col_imp_obj=e,t.col_imp_cb=function(e){L(t,e)},t.do_activation=!0,t},t.create_ray_sensor=function(e,t,r,n,a,o,_){var i=O(110);return i.source_object=e,i.from=t,i.to=r,i.collision_id=n,i.is_binary_value=a,i.calc_pos_norm=o,i.ign_src_rot=_,i.payload={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),ray_test_id:0},i.ray_test_cb=function(e,t,r,n,a,o){L(i,i.is_binary_value?-1==t?0:1:t),i.payload.hit_fract=t,i.payload.obj_hit=r,i.payload.hit_time=n,i.calc_pos_norm&&(i.payload.hit_pos.set(a),i.payload.hit_norm.set(o))},i.do_activation=!0,i},t.create_mouse_click_sensor=function(e){var t=O(50,e);return t.do_activation=!0,t.payload={coords:new Float32Array(2),which:null},t},t.create_mouse_wheel_sensor=function(e){var t=O(30,e);return t.do_activation=!0,t},t.create_mouse_move_sensor=function(e,t){var r=O(40,t);return r.axis=e||"XY",r.payload={coords:new Float32Array(2)},r.do_activation=!0,r},t.create_touch_move_sensor=function(e,t){var r=O(60,t);return r.axis=e||"XY",r.payload={coords:new Float32Array(2),gesture:0},r.do_activation=!0,r},t.create_touch_zoom_sensor=function(e){var t=O(70,e);return t.payload=0,t.do_activation=!0,t},t.create_touch_rotate_sensor=function(e){var t=O(75,e);return t.payload=0,t.do_activation=!0,t},t.create_touch_click_sensor=function(e){var t=O(80,e);return t.payload={coords:new Float32Array(2)},t.do_activation=!0,t},t.create_motion_sensor=function(){var e=dm(),t=ih();return function(r,n,a){if(!r)return i.error("Wrong collision object"),null;var o=O(120);o.source_object=r;var _=jm(r.render.world_tsr,t),s=Vm(r.render.world_tsr,e);return o.quat_temp=new Float32Array(4),o.trans_last=new Float32Array(_),o.quat_last=new Float32Array(s),o.avg_linear_vel=0,o.avg_angular_vel=0,o.threshold=n||.1,o.rotation_threshold=a||.1,o.time_last=0,o.payload=new Float32Array([0,0]),o}}(),t.create_vertical_velocity_sensor=function(){var e=dm(),t=ih();return function(r,n){if(!r)return i.error("Wrong collision object"),null;var a=O(130);a.source_object=r;var o=jm(r.render.world_tsr,t),_=Vm(r.render.world_tsr,e);return a.trans_last=new Float32Array(o),a.quat_last=new Float32Array(_),a.avg_vertical_vel=0,a.threshold=n||1,a.time_last=0,a.payload=0,a}}(),t.create_timer_sensor=function(e,t){var r=O(140);return r.period=e,r.repeat=t,r.do_activation=!0,r},t.reset_timer_sensor=function(e,t,r,n){var a=(e=e||d).sensor_manifolds;if(!a||!a[t])return i.error("reset_timer_sensor(): wrong object"),null;var o=a[t].sensors[r];if(!o)return i.error("reset_timer_sensor(): sensor not found"),null;o.time_last=l.get_timeline(),o.period=n},t.create_elapsed_sensor=function(){var e=O(150);return e.time_last=0,e},t.create_gyro_delta_sensor=function(){var e=O(180,window);return e.payload=new Float32Array(3),L(e,o.get_device_by_type_element(o.DEVICE_GYRO)?1:0),e.do_activation=!0,e},t.create_gyro_angles_sensor=function(){var e=O(190,window);return e.payload=new Float32Array(3),L(e,o.get_device_by_type_element(o.DEVICE_GYRO)?1:0),e.do_activation=!0,e},t.create_gyro_quat_sensor=function(){var e=O(200,window);return e.payload=dm(),L(e,o.get_device_by_type_element(o.DEVICE_GYRO)?1:0),e.do_activation=!0,e},t.create_hmd_quat_sensor=function(){var e=O(210,window);return e.payload=dm(),L(e,o.get_device_by_type_element(o.DEVICE_HMD)?1:0),e.do_activation=!0,e},t.create_hmd_position_sensor=function(){var e=O(220,window);return e.payload=ih(),L(e,o.get_device_by_type_element(o.DEVICE_HMD)?1:0),e.do_activation=!0,e},t.create_timeline_sensor=function(){return O(160)},t.create_selection_sensor=function(e,t){var r=O(170);return r.source_object=e,r.enable_toggle_switch=t,r.do_activation=!0,r},t.create_callback_sensor=function(e,t){var r=O(230);return r.callback=e,L(r,t),r},t.create_plock_mouse_sensor=function(e){var t=O(280,e);return t.payload={coords:new Float32Array(2)},t.do_activation=!0,t},t.create_plock_sensor=function(e){var t=O(290,e);return t.do_activation=!0,t},t.sensor_set_value=L,t.get_sensor_value=function(e,t,r){var n=(e=e||d).sensor_manifolds;if(!n||!n[t])return i.error("get_sensor_value(): wrong object"),null;var a=n[t].sensors[r];return a?a.value:(i.error("get_sensor_value(): sensor not found"),null)},t.get_sensor_payload=function(e,t,r){var n=(e=e||d).sensor_manifolds;if(!n||!n[t])return i.error("get_sensor_payload(): wrong object"),null;var a=n[t].sensors[r];return a?a.payload:(i.error("get_sensor_payload(): sensor not found"),null)},t.cleanup=function(){u=[],d={};for(var e=0;e<T.length;e++)D(T[e]);T.length=0,f.length=0},t.check_sensor_manifold=function(e,t){if(!(e=e||d).sensor_manifolds)return!1;if(t&&e.sensor_manifolds[t])return!0;if(t)return!1;for(var r in e.sensor_manifolds)return!0;return!1},t.create_sensor_manifold=function(e,t,r,n,a,o,_){(e=e||d).sensor_manifolds_arr=e.sensor_manifolds_arr||[],e.sensor_manifolds=e.sensor_manifolds||{};var i=e.sensor_manifolds,s=e.sensor_manifolds_arr;i[t]&&U(e,t);var l={id:t,type:r,sensors:n.slice(0),logic_fun:a,sensor_values:new Array(n.length),callback:o,callback_param:_,last_pulse:-1,last_logic_result:0,last_sensor_values:new Array(n.length),update_counter:-1};i[t]=l,s.push(l),-1==u.indexOf(e)&&u.push(e);for(var c=0;c<l.sensors.length;c++){var E=l.sensors[c];w(E);var p=T.indexOf(E);-1==p?(T.push(E),f.push([l])):f[p].push(l)}v=!0},t.default_AND_logic_fun=function(e){for(var t=0;t<e.length;t++)if(!e[t])return e[t];return e[e.length-1]},t.default_OR_logic_fun=function(e){for(var t=0;t<e.length;t++)if(e[t])return e[t];return e[e.length-1]},t.remove_sensor_manifold=U,t.reset=function(){for(var e=0;e<u.length;e++){var t=u[e],r=t.sensor_manifolds,n=t.sensor_manifolds_arr;for(var a in r)delete r[a];n.length=0}for(e=0;e<T.length;e++)D(T[e]);u.length=0,T.length=0,f.length=0},t.debug=function(){i.log(String(u.length)+" objects with manifolds",u),i.log(String(T.length)+" sensors",T);for(var e=[],t=[],r=0;r<T.length;r++){var n=T[r];90==n.type&&e.push(n),110==n.type&&t.push(n)}i.log(String(e.length)+" collision sensors",e),i.log(String(t.length)+" ray sensors",t)},t.set_plock_smooth_factor=function(e){g=e}})),eb=nA("__loader",(function(e,t){var r=pR(e),n=mN(e),a=dR(e).defaults;t.SYNC_PRIORITY=0,t.ASYNC_PRIORITY=1,t.FINISH_PRIORITY=2;var o=null;function _(){return o}function i(e){o=e}function s(e){return e.background_loading=e.background_loading||!1,e.priority||0===e.priority||(e.priority=e.SYNC_PRIORITY),e.inputs=e.inputs||[],e.is_finished=e.is_finished||!1,e.skip=e.skip||!1,e.relative_size=e.relative_size||0,e.is_resource=e.is_resource||!1,e.primary_only=e.primary_only||!1,e.status=0,e.loop_index=0,e.load_rate=0,e.cb_param=e.cb_param||null,e}function l(e,t,r){if(t.complete_load_cb(r,t),t.status=3,e.active_threads--,a.debug_loading){var o=Math.round(performance.now()-t.time_load_start);n.log("%cTHREAD "+t.id+": 100% LOADING END "+o+"ms","color: #f0f;")}!function(e){e.stageload_cb=null,e.complete_load_cb=null,a.debug_loading||(e.stage_graph=null),e.stages_queue=null}(t)}function c(e,n){var a=e.stages_queue.length;do{var o=r.get_node_attr(e.stage_graph,e.stages_queue[0]),_=d(e,o,n);o.priority==t.ASYNC_PRIORITY&&(e.reset_time_cycle=!0);var i=e.stages_queue.shift();e.stages_queue.push(i),a--}while(!_&&0!=a)}function E(e,t){for(var n=[],a=[],o=0;o<t.length;o++){var _=t[o];r.get_node_attr(e.stage_graph,_).is_finished&&(r.traverse_outputs(e.stage_graph,_,(function(a,o,_){var i=!0;r.traverse_inputs(e.stage_graph,a,(function(e,t,r){if(!t.is_finished)return i=!1,1})),i&&-1==n.indexOf(a)&&-1==t.indexOf(a)&&n.push(a)})),a.push(o))}for(o=a.length-1;o>=0;o--)t.splice(a[o],1);return n}function u(e){var t=[],n=e.stages_queue,a=!1;do{var o=E(e,n);t.push.apply(t,n),o.length>0&&(a=!0),n=o}while(o.length>0);return a&&t.sort((function(t,n){var a=r.get_node_attr(e.stage_graph,t),o=r.get_node_attr(e.stage_graph,n),_=o.priority-a.priority;return 0==_&&(_=a.background_loading-o.background_loading),_})),e.stages_queue=t,e.stages_queue.length}function d(e,t,r){if(t.skip)return t.is_finished=!0,a.debug_loading&&n.log("%cTHREAD "+e.id+": SKIP STAGE "+t.name,"color: #f0f;"),p(e,t),!1;if(a.debug_loading&&0==t.status){var o=T(e),_="LOADING START "+t.name,i=Math.round(performance.now()-e.time_load_start);n.log("%cTHREAD "+e.id+": "+o+"% "+_+" "+i+"ms ","color: #f0f;")}if(!t.cb_before&&!t.cb_loop&&!t.cb_after)return p(e,t),!1;if(0==t.status&&(t.status++,t.cb_before))return t.cb_before(r,e,t,t.cb_param,p,P),!0;if(1==t.status){if(t.cb_loop)return t.cb_loop(r,e,t,t.cb_param,p,P),!0;t.status++}return!(2!=t.status||(t.status++,!t.cb_after)||(t.cb_after(r,e,t,t.cb_param,p,P),0))}function T(e){if(0==e.stages_size_total)return 100;var t=0;return r.traverse(e.stage_graph,(function(r,n){f(e,n)&&(t+=n.load_rate*n.relative_size)})),OO(100*t/e.stages_size_total)}function f(e,t){return!(e.do_not_load_resources&&t.is_resource)}function p(e,t){if(t.is_finished=!0,t.status=3,S(e,t,1),a.debug_loading){var r=T(e),o="LOADING END "+t.name,_=Math.round(performance.now()-e.time_load_start);n.log("%cTHREAD "+e.id+": "+r+"% "+o+" "+_+"ms ","color: #f0f;")}}function P(e,t,r){r<1?S(e,t,r):t.status++}function S(e,t,r){var n=_();if(t.cb_before||t.cb_loop||t.cb_after){t.load_rate=r;var a=T(e);e.curr_percents==a&&1!=r||(e.stageload_cb(a,performance.now()-e.time_load_start,e.id),e.curr_percents=a,n.make_idle_iteration=!0)}}function A(e){e.skip=!0}function h(){return 0==_().active_threads}function v(e){return e&&(3==e.status||4==e.status)}t.get_scheduler=_,t.create_scheduler=function(){var e={threads:[],current_thread_index:0,active_threads:0,start_secondary_threads:!1,make_idle_iteration:!1};return i(e),e},t.create_thread=function(e,a,o,i,l,c,E,u,d){var T=_(),p=T.threads.length,P={id:p,is_primary:0==p,status:0,filepath:a,binary_name:"",loaded_cb:o||function(){},load_hidden:u||!1,wait_complete_loading:c,time_load_start:0,curr_percents:0,stages_size_total:0,reset_time_cycle:!1,stageload_cb:i||function(){},complete_load_cb:l||function(){},stage_graph:null,stages_queue:null,has_video_textures:!1,has_background_music:!1,init_wa_context:!1,is_preloading:d},S=function(e,a,o,i){var l=_(),c=r.create();for(var E in a){var u=s(a[E]);(i&&u.is_resource||!e&&u.primary_only)&&A(u),r.append_node_attr(c,u)}for(var E in a){(u=a[E]).name=E;for(var d=0;d<u.inputs.length;d++)r.append_edge_attr(c,a[u.inputs[d]],u,null)}var T=s({name:"out",priority:t.FINISH_PRIORITY,cb_before:function(e,t,r,a,o,_){t.is_primary&&(l.start_secondary_threads=!0),v(t)||(t.status=2),t.loaded_cb(t.id,!0),o(t,r),n.log("%cTHREAD "+t.id+": LOADED CALLBACK","color: #f0f;")},relative_size:5});if(o)var f=r.get_sink_nodes(c);else{var p,P=r.clone(c);do{for(f=r.get_sink_nodes(P),p=[],d=0;d<f.length;d++)(h=r.get_node_attr(P,S=f[d])).background_loading&&p.push(S);for(d=0;d<p.length;d++)r.remove_node(P,p[d]);p.length&&r.cleanup_loose_edges(P)}while(p.length)}for(r.append_node_attr(c,T),d=0;d<f.length;d++){var S,h=r.get_node_attr(c,S=f[d]);T.inputs.push(h.name),r.append_edge_attr(c,h,T,null)}return c}(P.is_primary,e,c,E);P.stage_graph=S;for(var h=[],m=r.get_source_nodes(S),g=0;g<m.length;g++)h.push(m[g]);return P.stages_queue=h,r.traverse(S,(function(e,t){(t.cb_before||t.cb_loop||t.cb_after)&&f(P,t)&&(P.stages_size_total+=t.relative_size)})),T.threads.push(P),T.active_threads++,P.id},t.update_scheduler=function(e){var t=_();if(t&&!h())if(t.make_idle_iteration)t.make_idle_iteration=!1;else{var r=performance.now();do{var o=t.threads[t.current_thread_index],i=e[o.id];if(v(o)||(0==o.status&&(o.status=1,o.time_load_start=performance.now(),o.stageload_cb(0,0,o.id),a.debug_loading&&n.log("%cTHREAD "+o.id+": 0% LOADING START 0ms","color: #f0f;")),u(o)?c(o,i):l(t,o,i)),t.start_secondary_threads&&(t.current_thread_index=(t.current_thread_index+1)%t.threads.length),o.reset_time_cycle)return void(o.reset_time_cycle=!1)}while(performance.now()-r<16)}},t.abort_thread=function(e){var t=_();l(t,e,null),e.status=4,e.is_primary&&(t.start_secondary_threads=!0),e.loaded_cb(e.id,!1)},t.stage_part_finish_cb=P,t.skip_stage_by_name=function(e,t){var n=function(e,t){var n=null;return r.traverse(e.stage_graph,(function(e,r){if(r.name==t)return n=r,1})),n}(e,t);null!==n&&A(n)},t.is_finished=h,t.thread_is_finished=v,t.is_primary_loaded=function(e){var t=_();return!!t&&t.threads[e|=0]&&(3==t.threads[e].status||2==t.threads[e].status)},t.graph_to_dot=function(e){if(a.debug_loading){var o=_();return o&&o.threads[e]&&o.threads[e].stage_graph?r.debug_dot(o.threads[e].stage_graph,(function(e,r){if(r.skip)return"SKIPPED\n("+r.name+")";var n=r.name+"\n",a=[];return a.push(r.priority==t.ASYNC_PRIORITY?"ASYNC":"SYNC"),r.background_loading&&a.push("BKG"),r.is_resource&&a.push("RES"),n+a.join(" | ")}),null):null}n.error("Debug mode isn't enabled. Can not retrieve the graph.")},t.cleanup=function(){i(null)}}));function tb(e,t){var r=e[0],n=e[1],a=e[2],o=e[3];r=nb(r,n,a,o,t[0],7,-680876936),o=nb(o,r,n,a,t[1],12,-389564586),a=nb(a,o,r,n,t[2],17,606105819),n=nb(n,a,o,r,t[3],22,-1044525330),r=nb(r,n,a,o,t[4],7,-176418897),o=nb(o,r,n,a,t[5],12,1200080426),a=nb(a,o,r,n,t[6],17,-1473231341),n=nb(n,a,o,r,t[7],22,-45705983),r=nb(r,n,a,o,t[8],7,1770035416),o=nb(o,r,n,a,t[9],12,-1958414417),a=nb(a,o,r,n,t[10],17,-42063),n=nb(n,a,o,r,t[11],22,-1990404162),r=nb(r,n,a,o,t[12],7,1804603682),o=nb(o,r,n,a,t[13],12,-40341101),a=nb(a,o,r,n,t[14],17,-1502002290),r=ab(r,n=nb(n,a,o,r,t[15],22,1236535329),a,o,t[1],5,-165796510),o=ab(o,r,n,a,t[6],9,-1069501632),a=ab(a,o,r,n,t[11],14,643717713),n=ab(n,a,o,r,t[0],20,-373897302),r=ab(r,n,a,o,t[5],5,-701558691),o=ab(o,r,n,a,t[10],9,38016083),a=ab(a,o,r,n,t[15],14,-660478335),n=ab(n,a,o,r,t[4],20,-405537848),r=ab(r,n,a,o,t[9],5,568446438),o=ab(o,r,n,a,t[14],9,-1019803690),a=ab(a,o,r,n,t[3],14,-187363961),n=ab(n,a,o,r,t[8],20,1163531501),r=ab(r,n,a,o,t[13],5,-1444681467),o=ab(o,r,n,a,t[2],9,-51403784),a=ab(a,o,r,n,t[7],14,1735328473),r=ob(r,n=ab(n,a,o,r,t[12],20,-1926607734),a,o,t[5],4,-378558),o=ob(o,r,n,a,t[8],11,-2022574463),a=ob(a,o,r,n,t[11],16,1839030562),n=ob(n,a,o,r,t[14],23,-35309556),r=ob(r,n,a,o,t[1],4,-1530992060),o=ob(o,r,n,a,t[4],11,1272893353),a=ob(a,o,r,n,t[7],16,-155497632),n=ob(n,a,o,r,t[10],23,-1094730640),r=ob(r,n,a,o,t[13],4,681279174),o=ob(o,r,n,a,t[0],11,-358537222),a=ob(a,o,r,n,t[3],16,-722521979),n=ob(n,a,o,r,t[6],23,76029189),r=ob(r,n,a,o,t[9],4,-640364487),o=ob(o,r,n,a,t[12],11,-421815835),a=ob(a,o,r,n,t[15],16,530742520),r=_b(r,n=ob(n,a,o,r,t[2],23,-995338651),a,o,t[0],6,-198630844),o=_b(o,r,n,a,t[7],10,1126891415),a=_b(a,o,r,n,t[14],15,-1416354905),n=_b(n,a,o,r,t[5],21,-57434055),r=_b(r,n,a,o,t[12],6,1700485571),o=_b(o,r,n,a,t[3],10,-1894986606),a=_b(a,o,r,n,t[10],15,-1051523),n=_b(n,a,o,r,t[1],21,-2054922799),r=_b(r,n,a,o,t[8],6,1873313359),o=_b(o,r,n,a,t[15],10,-30611744),a=_b(a,o,r,n,t[6],15,-1560198380),n=_b(n,a,o,r,t[13],21,1309151649),r=_b(r,n,a,o,t[4],6,-145523070),o=_b(o,r,n,a,t[11],10,-1120210379),a=_b(a,o,r,n,t[2],15,718787259),n=_b(n,a,o,r,t[9],21,-343485551),e[0]=cb(r,e[0]),e[1]=cb(n,e[1]),e[2]=cb(a,e[2]),e[3]=cb(o,e[3])}function rb(e,t,r,n,a,o){return t=cb(cb(t,e),cb(n,o)),cb(t<<a|t>>>32-a,r)}function nb(e,t,r,n,a,o,_){return rb(t&r|~t&n,e,t,a,o,_)}function ab(e,t,r,n,a,o,_){return rb(t&n|r&~n,e,t,a,o,_)}function ob(e,t,r,n,a,o,_){return rb(t^r^n,e,t,a,o,_)}function _b(e,t,r,n,a,o,_){return rb(r^(t|~n),e,t,a,o,_)}function ib(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var sb="0123456789abcdef".split("");function lb(e){for(var t="",r=0;r<4;r++)t+=sb[e>>8*r+4&15]+sb[e>>8*r&15];return t}function cb(e,t){return e+t&4294967295}function Eb(e){return function(e){for(var t=0;t<e.length;t++)e[t]=lb(e[t]);return e.join("")}(function(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)tb(n,ib(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(tb(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,tb(n,a),n}(e))}var ub=nA("__logic_nodes",(function(e,t){var r=wI(e),n=gN(e),a=QI(e),o=pb(e),_=GI(e),i=KI(e),s=mN(e),l=LI(e),c=dR(e),E=$I(e),u=JI(e),d=VR(e),T=CI(e),f=yI(e),p=AR(e),P=MI(e),S=PI(e),A=new Float32Array(4),h=new Float32Array(3),v=new Float32Array(3),m=ih(),g=ih(),O=new Float32Array(2),N=new Float32Array(9),R=new Float32Array(16);t.NT_NUMBER=0,t.NT_STRING=1,t.NT_OBJECT=2,t.NMO_DIV=0,t.NMO_SUB=1,t.NMO_MUL=2,t.NMO_ADD=3,t.NMO_RAND=4,t.NMO_SIN=5,t.NMO_COS=6,t.NMO_TAN=7,t.NMO_ARCSIN=8,t.NMO_ARCCOS=9,t.NMO_ARCTAN=10,t.NMO_LOG=11,t.NMO_MIN=12,t.NMO_MAX=13,t.NMO_ROUND=14,t.NMO_MOD=15,t.NMO_ABS=16,t.NSO_JOIN=0,t.NSO_FIND=1,t.NSO_REPLACE=2,t.NSO_SPLIT=3,t.NSO_COMPARE=4,t.NC_GEQUAL=0,t.NC_LEQUAL=1,t.NC_GREATER=2,t.NC_LESS=3,t.NC_NOTEQUAL=4,t.NC_EQUAL=5,t.NST_WORLD=0,t.NST_PARENT=1,t.NST_LOCAL=2,t.NCMS_STATIC=0,t.NCMS_TARGET=1,t.NCMS_EYE=2,t.NCMS_HOVER=3,t.NCPT_OBJECT=0,t.NCPT_VARIABLE=1;var I={ENTRYPOINT:function(e,t,r,n,a,o){switch(t.state){case 2:0==r.callstack.length&&r.callstack.push({caller_node:null,variables:r.variables,logic_func:null}),r.curr_node=e.slot_idx_order}},HIDE:function(e,t,r,n,a,o){var _=e.bools.id0;switch(t.state){case 1:break;case 2:var c=Y(e,r,(function(e,t,r){_||(t.obj=i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),t.obj||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0))})),E=_?M(e.vars.id0,t.variables,r.variables):c.obj;e.bools.ch?l.change_visibility_rec(E,!0):l.change_visibility(E,!0),r.curr_node=e.slot_idx_order}},SHOW:function(e,t,r,n,a,o){var _=e.bools.id0;switch(t.state){case 1:break;case 2:var c=Y(e,r,(function(e,t,r){_||(t.obj=i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),t.obj||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0))})),E=_?M(e.vars.id0,t.variables,r.variables):c.obj;e.bools.ch?l.change_visibility_rec(E,!1):l.change_visibility(E,!1),r.curr_node=e.slot_idx_order}},PAGEPARAM:function(e,t,r,n,a,o){switch(t.state){case 2:x(e.vars.id0,t.variables,r.variables,function(e,t,r){var n=c.get("url_params");if(n&&e in n)return Number(n[e]);var a=r?location.hash:location.search;if(!a)return 0;for(var o=a.slice(1).split("&"),_=0;_<o.length;_++){var i=o[_].split("=");if(i.length>1&&i[0]==e)return K(i[1],t)}return 0}(e.param_name,e.floats.ptp,e.bools.hsh)),r.curr_node=e.slot_idx_order}},SWITCH_SELECT:function(e,t,r,n,a,o){switch(t.state){case 1:break;case 2:var l=Y(e,r,(function(e,t,r){t.state=-3}));if(-3==l.state)l.state=-2,function(e,t){for(var r=e.nodes,n=0;n<r.length;n++){var a=r[n];"SWITCH_SELECT"==a.type&&a!=t&&(Y(a,e.thread_state).state=-3)}}(t.logic_threads[r.thread_index],e),function(e,t,r){var n=i.get_selectable_objects(),a=Y(e,r.thread_state);for(var o in a.sel_obj_idxs=[],a.links_idxs=[],e.objects_paths){var l=e.bools[o]?M(e.vars[o],t.variables,r.thread_state.variables):i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths[o],0),c=n.indexOf(l);if(-1==c)return s.error("logic script error: non-selectable object:",e.objects_paths[o][e.objects_paths[o].length-1]),-1;a.sel_obj_idxs.push(c),a.links_idxs.push(e.links_dict[o])}a.sel_objs_len=n.length;for(var u=[],d=0;d<n.length;d++)u.push(E.create_selection_sensor(n[d],!1));E.create_sensor_manifold(null,"LOGIC_NODES_SWITCH_SELECT_"+X(e.label),E.CT_SHOT,u,E.default_OR_logic_fun,(function(e,t,r,n){var a=n[1],o=n[2],i=Y(n[0],o.thread_state);if(-1==i.state){for(var s=0;s<i.sel_objs_len;s++)if(E.get_sensor_value(e,t,s)){for(var l=0;l<i.sel_obj_idxs.length;l++)if(i.sel_obj_idxs[l]==s)return a.nla_thread==i.thread?(_.is_play(a._nla)&&(i.state=-3),o.thread_state.in_progress||(i.state=1,i.slot_idx_jump=i.links_idxs[l])):(i.state=1,i.slot_idx_jump=i.links_idxs[l]),void(i.select_object_idx=s);i.select_object_idx=s}i.state=0}}),[e,t,r])}(e,t,t.logic_threads[r.thread_index]);else if(-2==l.state)l.state=-1;else if(0==l.state||1==l.state){if(e.vars.vd&&e.vars.vd[1]){var c=i.get_selectable_objects();x(e.vars.vd,t.variables,r.variables,c[l.select_object_idx])}r.curr_node=l.state?l.slot_idx_jump:e.slot_idx_order,l.state=-3,E.remove_sensor_manifold(null,"LOGIC_NODES_SWITCH_SELECT_"+X(e.label));break}}},SELECT:function(e,t,r,n,a,o){switch(t.state){case 1:s.error("Logic script error: node is deprecated. Node: ",e.name),e.mute=!0}},PLAY:function(e,t,r,a,o,i){switch(t.state){case 1:_.stop_nla(),e.bools.not_wait||(e.bools.not_wait=!1);break;case 2:var s=Y(e,r);switch(s.state){case-1:if(_.is_play(t._nla)){if(t.curr_thread==t.nla_thread&&r.in_progress)break;var l=t.nla_thread;if(l){var c=F(l);l.thread_state.curr_node=c[l.thread_state.curr_node].slot_idx_order,function(e){var t=e.thread_state.callstack,r=t.length,n=[];r<=1&&n.push(e.nodes);for(var a=1;a<r;a++)n.push(t[a].logic_func.func.nodes);for(a=0;a<n.length;a++)for(var o=0;o<n[a].length;o++){var _=n[a][o];"PLAY"==_.type&&(Y(_,e.thread_state).state=-1)}}(t.nla_thread)}}if(r.in_progress=!e.bools.not_wait,t.nla_thread=t.curr_thread,s.state=0,e.frame_start_mask&&(_.set_range_start(e.frame_start),_.set_offset_from_range_start(a)),e.frame_end_mask)_.set_range_end(e.frame_end);else{var E=_.get_frame(a),u=-1;for(var d in t.sorted_markers_values)if(E<t.sorted_markers_values[d]){u=d;break}_.set_range_end(u>=0?t.sorted_markers_values[u]:_.get_frame_end())}_.play_nla(null),e.bools.not_wait&&(r.curr_node=e.slot_idx_order,s.state=-1,r.in_progress=!1);break;case 0:_.is_play()||(r.curr_node=e.slot_idx_order,s.state=-1,r.in_progress=!1);break;case 1:r.curr_node=e.slot_idx_order,s.state=-1,t.nla_thread=null,r.in_progress=!1;break;default:n.panic("Unknown state of "+e.name),s.state=-1}}},REDIRECT:function(e,t,r,n,a,o){switch(t.state){case 2:var _=e.bools.url?K(M(e.vars.url,t.variables,r.variables),1):e.strings.url;window.location.href=_,t.state=3}},MATH:function(e,t,r,a,o,_){switch(t.state){case 2:var i=-1==e.vars.id0[1]?e.floats.inp1:K(M(e.vars.id0,t.variables,r.variables),0),s=-1==e.vars.id1[1]?e.floats.inp2:K(M(e.vars.id1,t.variables,r.variables),0),l=0;switch(e.op){case 3:l=i+s;break;case 2:l=i*s;break;case 1:l=i-s;break;case 0:0==s&&n.panic("Division by zero in Logic script"),l=i/s;break;case 4:l=Math.random()*(s-i)+i;break;case 5:l=Math.sin(i);break;case 6:l=Math.cos(i);break;case 7:l=Math.tan(i);break;case 8:l=Math.asin(i);break;case 9:l=Math.acos(i);break;case 10:l=Math.atan(i);break;case 11:l=Math.log(i);break;case 12:l=Math.min(i,s);break;case 13:l=Math.max(i,s);break;case 14:l=Math.round(i);break;case 15:l=i%s;break;case 16:l=Math.abs(i)}x(e.vars.vd,t.variables,r.variables,l),r.curr_node=e.slot_idx_order}},CONDJUMP:function(e,t,r,n,a,o){switch(t.state){case 2:var _=e.common_usage_names.variable_type,s=H(e,_),l=!1;if(2==_){var c=e.bools.id0?M(e.vars.id0,t.variables,r.variables):i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),E=e.bools.id1?M(e.vars.id1,t.variables,r.variables):i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id1,0);switch(e.common_usage_names.condition){case 5:c==E&&(l=!0);break;case 4:c!=E&&(l=!0)}}else switch(c=-1==e.vars.id0[1]?s.inp1:K(M(e.vars.id0,t.variables,r.variables),_),E=-1==e.vars.id1[1]?s.inp2:K(M(e.vars.id1,t.variables,r.variables),_),e.common_usage_names.condition){case 5:c==E&&(l=!0);break;case 4:c!=E&&(l=!0);break;case 3:c<E&&(l=!0);break;case 2:c>E&&(l=!0);break;case 1:c<=E&&(l=!0);break;case 0:c>=E&&(l=!0)}r.curr_node=l?e.slot_idx_jump:e.slot_idx_order}},REGSTORE:function(e,t,r,n,a,o){switch(t.state){case 2:if(e.bools.vs)var _=M(e.vars.vs,t.variables,r.variables);else{var s=e.common_usage_names.variable_type,l=H(e,s);_=2==s?i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,l.id0,0):l.inp1}x([e.bools.new&&e.bools.gl||e.vars.vd[0],e.vars.vd[1]],t.variables,r.variables,_),r.curr_node=e.slot_idx_order}},PLAY_ANIM:function(e,t,a,o,_,i){var l=e.bools.id0,c=e.bools.env;switch(t.state){case 1:break;case 2:var E=Y(e,a,(function(e,r,n){r.obj=c?k(e):D(e,"id0",l,t.variables,n.variables),r.obj||l||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}));switch(c||(E.obj=l?M(e.vars.id0,t.variables,a.variables):E.obj),0!=E.state||r.is_play(E.obj,E.anim_slot)||(E.state=1),E.state){case-1:for(var u in t.logic_threads){var d=t.logic_threads[u],T=F(d),f=d.thread_state.curr_node;if(-1!=f){var p=T[f],P=Y(p,d.thread_state);"PLAY_ANIM"==p.type&&p!=e&&0==P.state&&P.obj==E.obj&&(P.state=1)}}var S=e.common_usage_names.param_anim_behavior;if(""==e.anim_name)r.apply_def(E.obj),r.set_behavior(E.obj,S,r.SLOT_ALL);else{var A=function(e,t){for(var n=-1,a=0;a<8;a++){var o=e.anim_slots[a];if(o&&o.animation_name&&r.strip_baked_suffix(o.animation_name)==r.strip_baked_suffix(t)){if(-1==n)return-1;n=a}}return n}(E.obj,e.anim_name);-1==A?(E.anim_slot=r.slot_by_anim_type(E.obj,e.anim_name),r.apply(E.obj,null,e.anim_name,E.anim_slot)):E.anim_slot=A,r.set_behavior(E.obj,S,E.anim_slot)}e.bools.not_wait||(a.in_progress=!0),r.play(E.obj,null,E.anim_slot),E.state=0,e.bools.not_wait&&(a.curr_node=e.slot_idx_order,E.state=-1);break;case 0:break;case 1:e.bools.not_wait||(a.in_progress=!1),a.curr_node=e.slot_idx_order,E.state=-1;break;default:n.panic("Unknown state of "+e.name),E.state=-1}}},SELECT_PLAY:C,SEND_REQ:function(e,t,r,n,o,_){var i=Y(e,r);function s(e,r,n,a,o){var _=JSON.stringify(e),i=o[1],s=Y(o[0],i);x(o[0].vars.dst,t.variables,i.variables,_),s.state=1}switch(t.state){case 2:switch(i.state){case-1:i.state=0;var l=e.bools.url?K(M(e.vars.url,t.variables,r.variables),1):e.strings.url,c={};if(e.bools.ct&&(c["Content-Type"]=e.strings.ct),"GET"==e.common_usage_names.request_type)a.enqueue([{id:l,type:a.AT_JSON,url:l,overwrite_header:c,param:[e,r]}],s,null,null,null);else if("POST"==e.common_usage_names.request_type){var E=K(M(e.vars.dst1,t.variables,r.variables),1);a.enqueue([{id:l,type:a.AT_JSON,url:l,overwrite_header:c,request_method:"POST",post_data:E,param:[e,r]}],s,null,null,null)}break;case 0:break;case 1:i.state=-1,r.curr_node=e.slot_idx_order}}},INHERIT_MAT:function(e,t,r,n,a,o){switch(t.state){case 1:break;case 2:var _=Y(e,r,(function(e,t,r){for(var n=0;n<2;n++)t.objects["id"+n]=i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths["id"+n],0),t.objects["id"+n]||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}));i.inherit_material(_.objects.id0,e.materials_names.id0,_.objects.id1,e.materials_names.id1),r.curr_node=e.slot_idx_order}},SET_SHADER_NODE_PARAM:function(e,t,r,n,a,o){switch(t.state){case 1:break;case 2:var _=Y(e,r,(function(e,t,r){e.objects_paths.id0&&(t.objects.id0=i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),e.objects_paths.id0||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),e.nodes_paths.id0.unshift(e.materials_names.id0))})).objects.id0,l=e.nodes_paths.id0,c=l[0],E=u.name_list_to_node_name(l,1),d=u.find_batch_material(_,c,"MAIN");if(r.curr_node=e.slot_idx_order,null===d)return void s.error('Material "'+c+'" was not found in the object "'+_.name+'".');"ShaderNodeRGB"==e.shader_nd_type&&i.set_nodemat_rgb(_,c,E,e.bools.id0?K(M(e.vars.id0,t.variables,r.variables),0):e.floats.id0,e.bools.id1?K(M(e.vars.id1,t.variables,r.variables),0):e.floats.id1,e.bools.id2?K(M(e.vars.id2,t.variables,r.variables),0):e.floats.id2),"ShaderNodeValue"==e.shader_nd_type&&i.set_nodemat_value(_,c,E,e.bools.id0?K(M(e.vars.id0,t.variables,r.variables),0):e.floats.id0)}},DELAY:function(e,t,r,n,a,o){var _=Y(e,r);switch(t.state){case 1:break;case 2:if(-1==_.state)return _.state=0,_.timer=0,void(r.in_progress=!0);0==_.state&&(_.timer+=a,(e.bools.dl?K(M(e.vars.dl,t.variables,r.variables),0):e.floats.dl)<_.timer&&(_.state=-1,r.curr_node=e.slot_idx_order,r.in_progress=!1))}},APPLY_SHAPE_KEY:function(e,t,r,n,a,o){switch(t.state){case 1:break;case 2:var _=Y(e,r,(function(e,t,r){var n=t.objects.id0=i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0);n||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0);var a=e.common_usage_names.sk;d.check_shape_keys(n)?d.has_shape_key(n,a)||(s.error("Wrong key name:",a),e.mute=!0):(s.error("No shape keys in object:",n.name),e.mute=!0)}));d.apply_shape_key(_.objects.id0,e.common_usage_names.sk,e.bools.skv?K(M(e.vars.skv,t.variables,r.variables),0):e.floats.skv),r.curr_node=e.slot_idx_order}},OUTLINE:function(e,t,r,n,a,o){var _=e.bools.id0;switch(t.state){case 1:break;case 2:var l=Y(e,r,(function(e,t,r){_||(t.obj=i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0),t.obj||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),t.obj&&t.obj.render&&t.obj.render.outlining||(s.error("Can't evaluate 'Outline' logic node: wrong object"),e.mute=!0))})),c=_?M(e.vars.id0,t.variables,r.variables):l.obj;switch(e.common_usage_names.outline_operation){case"PLAY":var E=c.render.outline_anim_settings_default;i.apply_outline_anim(c,E.outline_duration,E.outline_period,E.outline_relapses);break;case"STOP":i.clear_outline_anim(c);break;case"INTENSITY":i.set_outline_intensity(c,e.bools.in?K(M(e.vars.in,t.variables,r.variables),0):e.floats.in)}r.curr_node=e.slot_idx_order}},MOVE_CAMERA:function(e,t,r,n,a,_){function i(e,t,r,n){switch(o.get_move_style(e)){case o.MS_TARGET_CONTROLS:o.set_trans_pivot(e,t,r);break;case o.MS_EYE_CONTROLS:case o.MS_STATIC:P.set_tsr(e,n);break;case o.MS_HOVER_CONTROLS:dh(r,t,h),Rh(h,h),o.set_hover_pivot(e,r);var a,_=0;v[0]=h[0],v[1]=0,v[2]=h[2];var i=Ih(v,h);a=Math.acos(i/(mh(v)*mh(h))),_=h[2]?Math.atan(h[0]/h[2]):h[0]>0?0:Math.PI,h[2]>0&&h[0]>0||h[2]>0&&h[0]<0?O[1]=-(Math.PI+O[1]):h[2]<0&&h[0]<0?(O[0]+=Math.PI,_=-(Math.PI-_)):h[2]<0&&h[0]>0&&(O[0]+=Math.PI,_-=Math.PI),o.set_rotation_hover_angles(e,_+Math.PI,-a)}P.update_transform(e),T.sync_transform(e)}function c(e,t,r,n){rh(t,r,Ug,R),MA(R,R);var a=N;_A(R,a),xm(a,A),am(A,A),Gm(t,zm(e.render.world_tsr),A,n)}var E=e.bools.id0,u=e.bools.id1,d=e.bools.id2;switch(t.state){case 1:break;case 2:var f=Y(e,r,(function(e,r,n){(r.objects.ca=D(e,"id0",E,t.variables,n.variables))||E||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),r.objects.tr=D(e,"id1",u,t.variables,n.variables),r.objects.tr||u||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),r.objects.ta=D(e,"id2",d,t.variables,n.variables),r.objects.ta||d||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),r.state=-1,r.camera_state={trans_start:new Float32Array(3),trans_end:new Float32Array(3),interp_trans:new Float32Array(3),target_start:new Float32Array(3),target_end:new Float32Array(3),interp_target:new Float32Array(3),tsr_start:wm(),tsr_end:wm(),interp_tsr:wm()}})),S=E?M(e.vars.id0,t.variables,r.variables):f.objects.ca,I=u?M(e.vars.id1,t.variables,r.variables):f.objects.tr,b=d?M(e.vars.id2,t.variables,r.variables):f.objects.ta,y=jm(I.render.world_tsr,h),L=jm(b.render.world_tsr,m);switch(f.state){case-1:var x=e.bools.dur?K(M(e.vars.dur,t.variables,r.variables),0):e.floats.dur;if(0==x)return c(S,y,L,f.camera_state.tsr_end),i(S,y,L,f.camera_state.tsr_end),void(r.curr_node=e.slot_idx_order);ch(jm(S.render.world_tsr,g),f.camera_state.trans_start);var C=o.get_move_style(S);C==o.MS_HOVER_CONTROLS?ch(S.render.hover_pivot,f.camera_state.target_start):C==o.MS_STATIC||C==o.MS_EYE_CONTROLS?(Dm(S.render.world_tsr,f.camera_state.tsr_start),c(S,y,L,f.camera_state.tsr_end)):ch(S.render.pivot,f.camera_state.target_start),ch(y,f.camera_state.trans_end),ch(L,f.camera_state.target_end),f.state=0;var w=p.animate(0,1,1e3*x,(function(e){l.check_active()&&(C==o.MS_STATIC||C==o.MS_EYE_CONTROLS?Eg(f.camera_state.tsr_start,f.camera_state.tsr_end,nN(e),f.camera_state.interp_tsr):(f.camera_state.interp_target=yh(f.camera_state.target_start,f.camera_state.target_end,nN(e),f.camera_state.interp_target),f.camera_state.interp_trans=yh(f.camera_state.trans_start,f.camera_state.trans_end,nN(e),f.camera_state.interp_trans)),i(S,f.camera_state.interp_trans,f.camera_state.interp_target,f.camera_state.interp_tsr),1==e&&(f.state=1))}));break;case 0:break;case 1:p.clear_animation(w),f.state=-1,r.curr_node=e.slot_idx_order}}},SET_CAMERA_MOVE_STYLE:function(e,t,r,n,a,_){var l=e.bools;switch(t.state){case 1:break;case 2:var c=Y(e,r,(function(e,t,r){l.id0||(t.objects.id0=i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0))||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),l.pvo&&!l.id1&&(t.objects.id1=i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id1,0))})),E=l.id0?M(e.vars.id0,t.variables,r.variables):c.objects.id0,u=E.render;if(c.cam_state={target_cam_upside_down:u.target_cam_upside_down,use_panning:u.use_panning,horizontal_limits:u.horizontal_limits,vertical_limits:u.vertical_limits,distance_limits:u.distance_limits,hover_horiz_trans_limits:u.hover_horiz_trans_limits,hover_vert_trans_limits:u.hover_vert_trans_limits,pivot_limits:u.pivot_limits,enable_hover_hor_rotation:u.enable_hover_hor_rotation},S.is_camera(E)){var d=E.render,f=c.cam_state;switch(o.wipe_move_style(E),e.common_usage_names.camera_move_style){case 0:d.move_style=o.MS_STATIC;break;case 2:d.move_style=o.MS_EYE_CONTROLS;var p=jm(d.world_tsr,h);o.setup_eye_model(E,p,null,f.horizontal_limits,f.vertical_limits);break;case 3:d.move_style=o.MS_HOVER_CONTROLS,p=jm(d.world_tsr,h);var A=m;if(e.bools.pvo){var g=l.id1?M(e.vars.id1,t.variables,r.variables):c.objects.id1;A=jm(g.render.world_tsr,m)}else A[0]=e.bools.pvx?K(M(e.vars.pvx,t.variables,r.variables),0):e.floats.pvx,A[1]=e.bools.pvy?K(M(e.vars.pvy,t.variables,r.variables),0):e.floats.pvy,A[2]=e.bools.pvz?K(M(e.vars.pvz,t.variables,r.variables),0):e.floats.pvz;o.setup_hover_model(E,p,A,f.distance_limits,f.vertical_limits,f.hover_horiz_trans_limits,f.hover_vert_trans_limits,f.enable_hover_hor_rotation);break;case 1:d.move_style=o.MS_TARGET_CONTROLS,p=jm(d.world_tsr,h),A=m,e.bools.pvo?A=jm((g=l.id1?M(e.vars.id1,t.variables,r.variables):c.objects.id1).render.world_tsr,m):(A[0]=e.bools.pvx?K(M(e.vars.pvx,t.variables,r.variables),0):e.floats.pvx,A[1]=e.bools.pvy?K(M(e.vars.pvy,t.variables,r.variables),0):e.floats.pvy,A[2]=e.bools.pvz?K(M(e.vars.pvz,t.variables,r.variables),0):e.floats.pvz),o.setup_target_model(E,p,A,f.horizontal_limits,f.vertical_limits,f.distance_limits,f.pivot_limits,f.use_panning)}var O=v;O[0]=e.bools.vtr?K(M(e.vars.vtr,t.variables,r.variables),0):e.floats.vtr,O[1]=e.bools.vro?K(M(e.vars.vro,t.variables,r.variables),0):e.floats.vro,O[2]=e.bools.vzo?K(M(e.vars.vzo,t.variables,r.variables),0):e.floats.vzo,O[0]=xO(O[0],0,1/0),O[1]=xO(O[1],0,1/0),O[2]=xO(O[2],0,.99),d.velocity_trans=O[0],d.velocity_rot=O[1],d.velocity_zoom=O[2],P.update_transform(E),T.sync_transform(E),o.init_ortho_props(E)}else s.error("Logic script error: object is not a Camera. Node: ",e.name);r.curr_node=e.slot_idx_order}},SET_CAMERA_LIMITS:function(e,t,r,n,a,_){var l=e.bools;switch(t.state){case 1:break;case 2:var c=Y(e,r,(function(e,t,r){l.id0||(t.objects.id0=i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths.id0,0))||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)})),E=l.id0?M(e.vars.id0,t.variables,r.variables):c.objects.id0;if(S.is_camera(E)){switch(E.render.move_style){case o.MS_TARGET_CONTROLS:if(e.bools.dsl){var u=e.bools.dslmin?K(M(e.vars.dslmin,t.variables,r.variables),0):e.floats.dslmin,d=e.bools.dslmax?K(M(e.vars.dslmax,t.variables,r.variables),0):e.floats.dslmax;(I={}).min=Math.max(u,0),I.max=Math.max(d,0),o.set_distance_limits(E,I)}if(e.bools.vrl){var f=e.bools.vrldown?K(M(e.vars.vrldown,t.variables,r.variables),0):e.floats.vrldown,p=e.bools.vrlup?K(M(e.vars.vrlup,t.variables,r.variables),0):e.floats.vrlup;(I={}).down=f,I.up=p,I.camera_space="CAMERA"==e.common_usage_names.cam_lim_vert_rot_space_type,o.set_vertical_rot_limits(E,I)}if(e.bools.hrl){var A=e.bools.hrlleft?K(M(e.vars.hrlleft,t.variables,r.variables),0):e.floats.hrlleft,h=e.bools.hrlright?K(M(e.vars.hrlright,t.variables,r.variables),0):e.floats.hrlright;(I={}).left=A,I.right=h,I.camera_space="CAMERA"==e.common_usage_names.cam_lim_hor_rot_space_type,o.set_horizontal_rot_limits(E,I)}if(e.bools.pvl){var v=e.bools.pvlmin?K(M(e.vars.pvlmin,t.variables,r.variables),0):e.floats.pvlmin,m=e.bools.pvlmax?K(M(e.vars.pvlmax,t.variables,r.variables),0):e.floats.pvlmax;(I={}).min_z=v,I.max_z=m,o.set_pivot_limits(E,I)}break;case o.MS_HOVER_CONTROLS:if(e.bools.htl){var g=e.bools.htlmin?K(M(e.vars.htlmin,t.variables,r.variables),0):e.floats.htlmin,O=e.bools.htlmax?K(M(e.vars.htlmax,t.variables,r.variables),0):e.floats.htlmax;(I={}).min=g,I.max=O,o.set_hor_trans_limits(E,I)}if(e.bools.vtl){var N=e.bools.vtlmin?K(M(e.vars.vtlmin,t.variables,r.variables),0):e.floats.vtlmin,R=e.bools.vtlmax?K(M(e.vars.vtlmax,t.variables,r.variables),0):e.floats.vtlmax;(I={}).min=N,I.max=R,o.set_vert_trans_limits(E,I)}e.bools.vrl&&(f=e.bools.vrldown?K(M(e.vars.vrldown,t.variables,r.variables),0):e.floats.vrldown,p=e.bools.vrlup?K(M(e.vars.vrlup,t.variables,r.variables),0):e.floats.vrlup,(I={}).down=f,I.up=p,I.camera_space="CAMERA"==e.common_usage_names.cam_lim_vert_rot_space_type,o.hover_set_vertical_limits(E,I)),e.bools.dsl&&(u=e.bools.dslmin?K(M(e.vars.dslmin,t.variables,r.variables),0):e.floats.dslmin,d=e.bools.dslmax?K(M(e.vars.dslmax,t.variables,r.variables),0):e.floats.dslmax,(I={}).min=Math.max(u,0),I.max=Math.max(d,0),o.hover_set_distance_limits(E,I));break;case o.MS_EYE_CONTROLS:var I;e.bools.vrl&&(f=e.bools.vrldown?K(M(e.vars.vrldown,t.variables,r.variables),0):e.floats.vrldown,p=e.bools.vrlup?K(M(e.vars.vrlup,t.variables,r.variables),0):e.floats.vrlup,(I={}).down=f,I.up=p,I.camera_space="CAMERA"==e.common_usage_names.cam_lim_vert_rot_space_type,o.set_vertical_rot_limits(E,I)),e.bools.hrl&&(A=e.bools.hrlleft?K(M(e.vars.hrlleft,t.variables,r.variables),0):e.floats.hrlleft,h=e.bools.hrlright?K(M(e.vars.hrlright,t.variables,r.variables),0):e.floats.hrlright,(I={}).left=A,I.right=h,I.camera_space="CAMERA"==e.common_usage_names.cam_lim_hor_rot_space_type,o.set_horizontal_rot_limits(E,I))}P.update_transform(E),T.sync_transform(E)}else s.error("Logic script error: object is not a Camera. Node: ",e.name);r.curr_node=e.slot_idx_order}},MOVE_TO:function(e,t,r,n,a,o){function _(e,t){P.set_tsr(e,t),P.update_transform(e),T.sync_transform(e)}var i=e.bools,c=i.id0,E=i.id1;switch(t.state){case 1:break;case 2:var u=Y(e,r,(function(e,r,n){r.objects.id0=D(e,"id0",c,t.variables,n.variables),r.objects.id0||c||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),r.objects.id1=D(e,"id1",E,t.variables,n.variables),r.objects.id1||E||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),r.state=-1,r.obj_state={dest_tsr_start:wm(),dest_tsr_end:wm(),interp_tsr_dest:wm()}})),d=i.id0?M(e.vars.id0,t.variables,r.variables):u.objects.id0;if(d.is_dynamic){switch(Dm(d.render.world_tsr,u.obj_state.dest_tsr_start),Dm((i.id1?M(e.vars.id1,t.variables,r.variables):u.objects.id1).render.world_tsr,u.obj_state.dest_tsr_end),u.state){case-1:var f=e.bools.dur?K(M(e.vars.dur,t.variables,r.variables),0):e.floats.dur;if(0==f)return _(d,u.obj_state.dest_tsr_end),void(r.curr_node=e.slot_idx_order);u.state=0;var S=p.animate(0,1,1e3*f,(function(e){l.check_active()&&(u.obj_state.interp_dest=Eg(u.obj_state.dest_tsr_start,u.obj_state.dest_tsr_end,nN(e),u.obj_state.interp_tsr_dest),_(d,u.obj_state.interp_tsr_dest),1==e&&(u.state=1))}));break;case 0:break;case 1:p.clear_animation(S),u.state=-1,r.curr_node=e.slot_idx_order}break}s.error("Logic script error: object '"+d.name+"' must be dynamic. Node: ",e.name),r.curr_node=e.slot_idx_order}},TRANSFORM_OBJECT:function(e,t,r,n,a,o){function _(e,t,r){0==r?P.set_tsr(e,t):P.set_tsr_rel(e,t),P.update_transform(e),T.sync_transform(e)}var i=e.bools.id0;switch(t.state){case 1:break;case 2:var c=Y(e,r,(function(e,r,n){r.obj=D(e,"id0",i,t.variables,n.variables),r.obj||i||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0),r.state=-1,r.obj_state={space:0,tsr_start:wm(),tsr_end:wm(),interp_tsr:wm()}})),E=i?M(e.vars.id0,t.variables,r.variables):c.obj;switch(c.state){case-1:var u=v;u[0]=e.bools.trx?K(M(e.vars.trx,t.variables,r.variables),0):e.floats.trx,u[1]=e.bools.try?K(M(e.vars.try,t.variables,r.variables),0):e.floats.try,u[2]=e.bools.trz?K(M(e.vars.trz,t.variables,r.variables),0):e.floats.trz;var d=h;d[0]=e.bools.rox?K(M(e.vars.rox,t.variables,r.variables),0)*Math.PI/180:e.floats.rox,d[1]=e.bools.roy?K(M(e.vars.roy,t.variables,r.variables),0)*Math.PI/180:e.floats.roy,d[2]=e.bools.roz?K(M(e.vars.roz,t.variables,r.variables),0)*Math.PI/180:e.floats.roz;var f=e.bools.sc?M(e.vars.sc,t.variables,r.variables):e.floats.sc;switch(tO(d,A),Gm(u,f,A,c.obj_state.tsr_end),c.obj_state.space=e.common_usage_names.space_type,c.obj_state.space){case 0:P.get_tsr(E,c.obj_state.tsr_start);break;case 1:P.get_tsr_rel(E,c.obj_state.tsr_start);break;case 2:P.get_tsr_rel(E,c.obj_state.tsr_start),tg(c.obj_state.tsr_start,c.obj_state.tsr_end,c.obj_state.tsr_end)}var S=e.bools.dur?K(M(e.vars.dur,t.variables,r.variables),0):e.floats.dur;if(0==S)return _(E,c.obj_state.tsr_end,c.obj_state.space),void(r.curr_node=e.slot_idx_order);c.state=0;var m=p.animate(0,1,1e3*S,(function(e){l.check_active()&&(Eg(c.obj_state.tsr_start,c.obj_state.tsr_end,nN(e),c.obj_state.interp_tsr),_(E,c.obj_state.interp_tsr,c.obj_state.space),1==e&&(c.state=1))}));break;case 0:break;case 1:p.clear_animation(m),c.state=-1,r.curr_node=e.slot_idx_order}}},SPEAKER_PLAY:function(e,t,r,a,o,_){var i=e.bools.id0;switch(t.state){case 1:null==e.bools.not_wait&&(e.bools.not_wait=!0);break;case 2:var l=Y(e,r,(function(e,r,n){r.obj=D(e,"id0",i,t.variables,n.variables),r.obj||i||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}));switch(l.obj=i?M(e.vars.id0,t.variables,r.variables):l.obj,f.is_playing(l.obj)||0==l.state&&(l.state=1),l.state){case-1:for(var c in t.logic_threads){var E=t.logic_threads[c].thread_state.curr_node;if(-1!=E){var u=t.logic_threads[c].nodes[E];"SPEAKER_PLAY"==u.type&&u!=e&&0==l.state&&u.obj==e.obj&&(u.state=1)}}e.bools.not_wait||(r.in_progress=!0),f.play_def(l.obj),l.state=0;break;case 0:e.bools.not_wait&&(r.curr_node=e.slot_idx_order,l.state=-1);break;case 1:e.bools.not_wait||(r.in_progress=!1),r.curr_node=e.slot_idx_order,l.state=-1;break;default:n.panic("Unknown state of "+e.name),l.state=-1}}},SPEAKER_STOP:function(e,t,r,n,a,o){var _=e.bools.id0;switch(t.state){case 1:break;case 2:var i=Y(e,r,(function(e,r,n){r.obj=D(e,"id0",_,t.variables,n.variables),r.obj||_||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)})),l=_?M(e.vars.id0,t.variables,r.variables):i.obj;f.stop(l),r.curr_node=e.slot_idx_order}},STOP_ANIM:function(e,t,n,a,o,_){var i=e.bools.id0,l=e.bools.env;switch(t.state){case 1:break;case 2:var c=Y(e,n,(function(e,r,n){r.obj=l?k(e):D(e,"id0",i,t.variables,n.variables),r.obj||i||(s.error("Logic script error: object not found. Node: ",e.name),e.mute=!0)}));c.obj=i?M(e.vars.id0,t.variables,n.variables):c.obj,r.stop(c.obj,r.SLOT_ALL),e.bools.rst&&r.set_first_frame(c.obj,r.SLOT_ALL),n.curr_node=e.slot_idx_order}},STOP_TIMELINE:function(e,t,r,n,a,o){switch(t.state){case 2:e.bools.rst&&_.set_offset_from_range_start(n),_.stop_nla(),r.curr_node=e.slot_idx_order}},CONSOLE_PRINT:function(e,t,r,n,a,o){switch(t.state){case 2:var _=0,i="{";for(var l in e.vars){_>0&&(i+=", ");var c=e.vars[l][1],E=M(e.vars[l],t.variables,r.variables);i+='"'+c+'": ';try{i+=JSON.stringify(E)}catch(YM){i+=E?'{"name": "'+E.name+'", "type": "'+E.type+'"}':"Object"}++_}s.log(e.common_usage_names.msg,i+="}"),r.curr_node=e.slot_idx_order}},STRING:function(e,t,r,n,a,o){switch(t.state){case 2:var _=e.bools.id0?K(M(e.vars.id0,t.variables,r.variables),1):e.strings.id0,i=e.bools.id1?K(M(e.vars.id1,t.variables,r.variables),1):e.strings.id1,s=0;switch(e.common_usage_names.string_operation){case 0:s=_+i;break;case 1:s=_.indexOf(i);break;case 2:var l=e.bools.id2?K(M(e.vars.id2,t.variables,r.variables),1):e.strings.id2;s=_.replace(i,l);break;case 3:var c=e.vars;s=_.substring(0,_.indexOf(i)),x(c.dst1,t.variables,r.variables,_.substring(_.indexOf(i)+1,_.length)),""==M(c.dst,t.variables,r.variables)&&(s=M(c.dst1,t.variables,r.variables),x(c.dst1,t.variables,r.variables,""));break;case 4:switch(e.common_usage_names.condition){case 5:s=_==i?1:0;break;case 4:s=_!=i?1:0;break;case 3:s=_<i?1:0;break;case 2:s=_>i?1:0;break;case 1:s=_<=i?1:0;break;case 0:s=_>=i?1:0}}x(e.vars.dst,t.variables,r.variables,s),r.curr_node=e.slot_idx_order}},GET_TIMELINE:function(e,t,r,n,a,o){switch(t.state){case 2:var i=K(e.bools.nla?_.get_frame(n):p.get_frame(n),0);x(e.vars.vd,t.variables,r.variables,i),r.curr_node=e.slot_idx_order}},JSON:function(e){function t(t,r,n,a,o,_){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,r,n,a,o){switch(t.state){case 2:switch(e.common_usage_names.json_operation){case"PARSE":try{var _=K(M(e.vars.jsn,t.variables,r.variables),1);!function(e,t,r,n){for(var a=0;a<t.length;a++){for(var o=t[a].split("."),_=e,i=r[a],s=0;s<o.length&&null!=(_=_[o[s]]);s++);_=B(_),n[i]=_}}(JSON.parse(_),e.parse_json_paths,e.parse_json_vars,r.variables)}catch(YM){s.error("logic script error: non valid JSON string")}break;case"ENCODE":var i={};!function(e,t,r,n){n||(n={});for(var a=0;a<t.length;a++){var o=t[a].split("."),_=n,i=r[a];if(i in e){for(var s=0;s<o.length-1;s++)void 0===_[o[s]]&&(_[o[s]]=isNaN(o[s+1])?{}:[]),_=_[o[s]];_[o[o.length-1]]=B(e[i])}}}(r.variables,e.encode_json_paths,e.encode_json_vars,i);var l=K(JSON.stringify(i),1);x(e.vars.jsn,t.variables,r.variables,l)}r.curr_node=e.slot_idx_order}})),JS_CALLBACK:function(e,t,r,n,a,o){switch(t.state){case 2:for(var _,l=e.bools.cb?K(M(e.vars.cb,t.variables,r.variables),1):e.strings.cb,c=[],E=0,u="id"+E,d=e.common_usage_names.js_cb_params;u in d;)_=0==d[u]?i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths[u],0):M(e.vars[u],t.variables,r.variables),c.push(_),u="id"+ ++E;var T=[];for(u="out"+(E=0);u in e.vars;)_=M(e.vars[u],t.variables,r.variables),T.push(_),u="out"+ ++E;var f=1;if(l in y){if(f=!y[l](c,T))for(var p=0;p<T.length;p++)(u="out"+p)in e.vars&&x(e.vars[u],t.variables,r.variables,B(T[p]))}else s.error("logic script error: no custom callback with id "+l);f&&(r.curr_node=e.slot_idx_order)}},EMPTY:C,DATE_TIME:function(e,t,r,n,a,o){switch(t.state){case 2:var _,i,s,l,c,E,u=e.common_usage_names.time_type,d=new Date;"L"==u?(_=d.getFullYear(),i=d.getMonth(),s=d.getDate(),l=d.getHours(),c=d.getMinutes(),E=d.getSeconds()):(_=d.getUTCFullYear(),i=d.getUTCMonth(),s=d.getUTCDate(),l=d.getUTCHours(),c=d.getUTCMinutes(),E=d.getUTCSeconds()),e.bools.y&&x(e.vars.y,t.variables,r.variables,_),e.bools.M&&x(e.vars.M,t.variables,r.variables,i),e.bools.d&&x(e.vars.d,t.variables,r.variables,s),e.bools.h&&x(e.vars.h,t.variables,r.variables,l),e.bools.m&&x(e.vars.m,t.variables,r.variables,c),e.bools.s&&x(e.vars.s,t.variables,r.variables,E),r.curr_node=e.slot_idx_order}},ELAPSED:function(e,t,r,n,a,o){switch(t.state){case 2:x(e.vars.s,t.variables,r.variables,a),r.curr_node=e.slot_idx_order}},CALL_FUNC:function(e,t,r,n,a,o){switch(t.state){case 1:for(var _=e.logic_node_trees.id0,i=e.logic_functions.id0,s=0;s<t.logic_functions.length;s++){var l=t.logic_functions[s];if(l.id[0][0]==_[0]&&l.id[0][1]==_[1]&&l.id[1]==i){e.func_id=s;break}}break;case 2:var c={};for(var E in r.variables_references={},e.vars){var u=e.vars[E][1],d=e.strings[E];c[d]=e.vars[E][0]?t.variables[u]:r.variables[u],E.startsWith("out")&&(r.variables_references[u]=d)}r.callstack.push({caller_node:e,variables:c,logic_func:t.logic_functions[e.func_id]}),r.variables=c,r.update_script_cycle=!0,r.curr_node=t.logic_functions[e.func_id].func.nodes[0].slot_idx_order}},DEF_FUNC:C,SWITCH:function(e,t,r,n,a,o){switch(t.state){case 1:var _=Object.keys(e.vars);for(var i in _)_[i].startsWith("id")||_.splice(i,1);e.links_keys=_;break;case 2:var s=M(e.vars.v,t.variables,r.variables);for(var i in e.links_keys)if(s==M(e.vars[e.links_keys[i]],t.variables,r.variables))return void(r.curr_node=e.links_dict[e.links_keys[i]]);r.curr_node=e.slot_idx_order}}},b=[],y={},L={};function Y(e,t,n){var a=t.thread_index+1-e.instances.length;if(a>0)for(var o=0;o<a;o++)e.instances.push(0);return e.instances[t.thread_index]||(e.instances[t.thread_index]={objects:{},slot_idx_jump:-1,state:-1,sel_obj_idxs:[],timer:-1,camera_state:{},anim_slot:r.SLOT_ALL,obj_state:null},n&&n(e,e.instances[t.thread_index],t)),e.instances[t.thread_index]}function M(e,t,r){return e[0]?t[e[1]]:r[e[1]]}function x(e,t,r,n){e[0]?t[e[1]]=n:r[e[1]]=n}function C(e,t,r,n,a,o){switch(t.state){case 1:break;case 2:r.curr_node=e.slot_idx_order}}function w(e,t,r,n,a,o){switch(t.state){case 1:s.error("Unknown node type: "+e.type);break;case 2:r.curr_node=e.slot_idx_order}}function U(e,t,r,n){for(var a=b[e],o=0;o<b[e].logic_threads.length;o++)a.curr_thread=b[e].logic_threads[o],G(b[e].logic_threads[o],a,t,r,n)}function k(e){return i.get_world_by_name(e.dupli_name_list[0],0)}function D(e,t,r,n,a){return r?M(e.vars[t],n,a):i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e.objects_paths[t],0)}function F(e){var t=e.thread_state.callstack;if(t.length<=1)var r=e.nodes;else r=t[t.length-1].logic_func.func.nodes;return r}function G(e,t,r,n,a,o){e.thread_state.update_script_cycle=!1;var _=e.thread_state.callstack;if(_.length<=1)var i=e.nodes;else i=_[_.length-1].logic_func.func.nodes;if(i.length){if(!o)for(var s=0;s<i.length;s++)i[s].processed=!1;for(s=0;s<i.length;s++){if(!(e.thread_state.curr_node>=0)){if(e.thread_state.callstack.length>1){var l=e.thread_state.callstack.pop().caller_node,c=_[_.length-1];if(c.logic_func)var E=c.logic_func.func.nodes;else E=e.nodes;e.thread_state.curr_node=l.slot_idx_order,f=E[l.slot_idx_order];var u=e.thread_state.variables;for(var d in e.thread_state.variables=c.variables,e.thread_state.variables_references){var T=e.thread_state.variables_references[d];void 0===e.thread_state.variables[d]?t.variables[d]=u[T]:e.thread_state.variables[d]=u[T]}return void G(e,t,r,n,a,!0)}return}var f;if((f=i[e.thread_state.curr_node]).processed)return;if(f.mute){if("ENTRYPOINT"==f.type)return;e.thread_state.curr_node=f.slot_idx_order,f.processed=!0}else if(f.process_node(f,t,e.thread_state,r,n,a),f.processed=!0,e.thread_state.update_script_cycle)return}_.splice(0,_.length)}}function K(e,t){switch(t){case 0:return Number(e)?Number(e):0;case 1:return String(e);case 2:return e;default:return null}}function B(e){switch(typeof e){case"string":return K(e,1);case"number":return K(e,0);default:return K(e,1)}}function X(e){L[e]||(L[e]=0);var t=e+"_"+L[e];return t=t.replace(/ /g,"_").replace(/\//g,"_"),L[e]++,t}function H(e,t){switch(t){case 0:return e.floats;case 1:return e.strings;case 2:return e.objects_paths}}t.init_logic=function(e,t){var r={data_id:t,scene_name:e.name,state:0,nla_thread:null,scene:e,curr_thread:null,logic_threads:[],logic_functions:[],sorted_markers_values:[],variables:{},variables_references:{}};e._logic=r,function(e,t){var r,n=e.b4w_logic_nodes,a=t.logic_threads,o=t.logic_functions;t.state=1;for(var _=-1,i=0;i<n.length;i++){for(var s={nodes:[],thread_state:{scene:e,curr_node:0,in_progress:!1,update_script_cycle:!1,thread_index:i,callstack:[],variables:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}},l=n[i],c=0;c<l.length;c++){var E={name:(r=l[c]).name,type:r.type,label:r.label,slot_idx_order:r.slot_idx_order,slot_idx_jump:r.slot_idx_jump,frame_start:r.frame_range[0],frame_end:r.frame_range[1],frame_start_mask:!r.frame_range_mask||r.frame_range_mask[0],frame_end_mask:!r.frame_range_mask||r.frame_range_mask[1],param_name:r.param_name,op:r.operation,mute:r.mute,dupli_name_list:r.object,anim_name:r.anim_name,parse_json_vars:r.parse_json_vars,parse_json_paths:r.parse_json_paths,objects_paths:r.objects_paths,nodes_paths:r.nodes_paths,floats:r.floats,bools:r.bools,vars:r.variables,strings:r.strings,logic_functions:r.logic_functions,logic_node_trees:r.logic_node_trees,materials_names:r.materials_names,shader_nd_type:r.shader_nd_type,common_usage_names:r.common_usage_names,encode_json_vars:r.encode_json_vars,encode_json_paths:r.encode_json_paths,thread:s,process_node:I[r.type]?I[r.type]:w,processed:!1,links_dict:r.links,instances:[],func_id:-1,links_keys:null,select_object_idx:-1};s.nodes.push(E)}switch(s.nodes[0].type){case"ENTRYPOINT":_++,s.thread_state.thread_index=_,a.push(s);break;case"DEF_FUNC":var u=s.nodes[0];s.thread_state=null,o.push({id:[u.logic_node_trees.id0,u.logic_functions.id0],func:s})}}for(i=0;i<a.length;i++){s=a[i];for(var d=0;d<s.nodes.length;d++)(E=s.nodes[d]).mute||E.process_node(E,t,s.thread_state,0,0)}for(i=0;i<o.length;i++){var T=o[i].func;for(d=0;d<T.nodes.length;d++)(E=T.nodes[d]).mute||E.process_node(E,t,0,0,0)}var f=e.timeline_markers;for(var p in f)t.sorted_markers_values.push(f[p]);t.sorted_markers_values.sort((function(e,t){return e-t})),t.state=2,b.push(t)}(e,r)},t.update=function(e,t){var r=_.get_start_time();if(!(r<=0))for(var n=0;n<b.length;n++)U(n,e,t,r)},t.append_custom_cb=function(e,t){y[e]=t},t.remove_custom_cb=function(e){delete y[e]},t.run_ep=function(e,t){for(var r=0;r<b.length;r++)if(b[r].scene_name==e){for(var n=b[r],a=0;a<n.logic_threads.length;a++){var o=n.logic_threads[a].nodes[0];if(o.name==t){o.bools.js&&[0,-1].indexOf(n.logic_threads[a].thread_state.curr_node)>=0&&(o.mute=!1,n.logic_threads[a].thread_state.curr_node=0);break}}break}},t.cleanup=function(){b.length=0,y={},L={}}})),db=nA("__reformer",(function(e,t){var r=gN(e),n=dR(e),a=BI(e),o=mN(e),_=ub(e),i=wI(e),s=n.defaults,l={},c=oA(),E=DR(),u=dm();function d(e){switch(e.type){case"VALTORGB":e.color_ramp||(e.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},S("node Color Ramp",e,"color_ramp"));break;case"CURVE_RGB":e.curve_mapping||(e.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},S("node RGB Curves",e,"curve_mapping"));break;case"CURVE_VEC":e.curve_mapping||(e.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},S("node Vector Curves",e,"curve_mapping"));break;case"MAPPING":e.vector_type||(e.vector_type="POINT",S("node Mapping",e,"vector_type"));break;case"MATERIAL":case"MATERIAL_EXT":"alpha"in e||(e.alpha=1,S("node material",e,"alpha")),"darkness"in e||(e.darkness=1,S("node material",e,"darkness")),"diffuse_toon_size"in e||(e.diffuse_toon_size=.5,S("node material",e,"diffuse_toon_size")),"diffuse_toon_smooth"in e||(e.diffuse_toon_smooth=.1,S("node material",e,"diffuse_toon_smooth")),"diffuse_intensity"in e||(e.diffuse_intensity=1,S("node material",e,"diffuse_intensity")),"use_tangent_shading"in e||(e.use_tangent_shading=!1,S("node material",e,"use_tangent_shading")),"specular_shader"in e||(e.specular_shader="COOKTORR",S("node material",e,"specular_shader")),"specular_ior"in e||(e.specular_ior=4,S("node material",e,"specular_ior")),"specular_hardness"in e||(e.specular_hardness=50,S("node material",e,"specular_hardness")),"specular_slope"in e||(e.specular_slope=.1,S("node material",e,"specular_slope")),"specular_toon_size"in e||(e.specular_toon_size=.5,S("node material",e,"specular_toon_size")),"specular_toon_smooth"in e||(e.specular_toon_smooth=.1,S("node material",e,"specular_toon_smooth")),"specular_intensity"in e||(e.specular_intensity=.5,S("node material",e,"specular_intensity")),"diffuse_shader"in e||(e.diffuse_shader="LAMBERT",S("node material",e,"diffuse_shader")),"roughness"in e||(e.roughness=.5,S("node material",e,"roughness")),"diffuse_fresnel"in e||(e.diffuse_fresnel=.1,S("node material",e,"diffuse_fresnel")),"diffuse_fresnel_factor"in e||(e.diffuse_fresnel_factor=.5,S("node material",e,"diffuse_fresnel_factor"));break;case"MATH":case"MIX_RGB":"use_clamp"in e||(e.use_clamp=!1,S("node "+e.type,e,"use_clamp"));break;case"GROUP":switch(e.node_tree_name=e.node_tree_name.replace(/\.[0-9]{3,}$/g,""),e.node_tree_name){case"CLAMP":case"LEVELS_OF_QUALITY":case"LINEAR_TO_SRGB":case"NORMAL_VIEW":case"PARALLAX":case"REFLECT":case"REFRACTION":case"REPLACE":case"SMOOTHSTEP":case"SRGB_TO_LINEAR":case"TIME":case"TRANSLUCENCY":case"VECTOR_VIEW":e.node_tree_name="B4W_"+e.node_tree_name}break;case"VECT_TRANSFORM":"convert_from"in e||(e.convert_from="WORLD",S("node "+e.type,e,"convert_from")),"convert_to"in e||(e.convert_to="WORLD",S("node "+e.type,e,"convert_to")),"vector_type"in e||(e.vector_type="POINT",S("node "+e.type,e,"vector_type"));break;case"ATTRIBUTE":e.color_layer="";break;case"BSDF_TRANSPARENT":"b4w_use_alpha"in e||(e.b4w_use_alpha=!1,S("node "+e.type,e,"b4w_use_alpha"))}}function T(e){var t=e.nla_tracks;if(t)for(var r=0;r<t.length;r++)for(var n=t[r],a=0;a<n.strips.length;a++){var o=n.strips[a];"action"in o||(o.action=null,S("strip",o,"action")),"action_frame_start"in o||(o.action_frame_start=0,S("strip",o,"action_frame_start")),"action_frame_end"in o||(o.action_frame_end=o.frame_end-o.frame_start,S("strip",o,"action_frame_end")),"repeat"in o||(o.repeat=1,S("strip",o,"repeat")),"use_reverse"in o||(o.use_reverse=!1,S("strip",o,"use_reverse")),"scale"in o||(o.scale=1,S("strip",o,"scale"))}}function f(e){for(var t=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"],r=null,n=0;n<t.length;n++)e[t[n]]&&(r?(e[t[n]]=!1,o.warn('WARNING property "'+t[n]+'" of object "'+e.name+'" has been set to "false". Foreground property "'+r+'" already exists.')):r=t[n])}function p(e){var t=e.game,r=t.collision_bounds_type;t.use_collision_bounds&&"BOX"!=r&&"CYLINDER"!=r&&"CONE"!=r&&"SPHERE"!=r&&"CAPSULE"!=r&&"EMPTY"!=r&&(o.error("Wrong collision bounds type "+r+". Disable physics for object "+e.name),e.b4w_collision=!1,e.b4w_floating=!1,e.b4w_vehicle=!1,e.b4w_character=!1)}function P(e,t){var r=e[0],n=e[1],a=e[2];return t[0]=e[3],t[1]=r,t[2]=n,t[3]=a,t}function S(e,t,r){var n=r+">>"+e;n in l||(l[n]={storage:[],report_type:"undefined",type:e}),l[n].storage.push(t.name)}function A(e,t,r){var n=r+">>"+e;n in l||(l[n]={storage:[],report_type:"deprecated",type:e}),l[n].storage.push(t.name)}function h(e){o.warn(e)}function v(e){var t=e.scale;if(0==t[0]&&0==t[1]&&0==t[2])return!0;var r=Math.abs((t[0]-t[1])/t[0]),n=Math.abs((t[1]-t[2])/t[1]);return r<.005&&n<.005}function m(e){return e.scale[0]<0||e.scale[1]<0||e.scale[2]<0}function g(e,t){for(var r,n,a,o,_=0,i=0,s=0,l=new Float32Array(16),c=[],E=1;E<t.count;E++){if(t.use_constant_offset&&(_+=t.constant_offset_displace[0],i+=t.constant_offset_displace[1],s+=t.constant_offset_displace[2]),t.use_relative_offset){var u=e.b4w_boundings.bb;_+=(u.max_x-u.min_x)*t.relative_offset_displace[0],i+=(u.max_y-u.min_y)*t.relative_offset_displace[1],s+=(u.max_z-u.min_z)*t.relative_offset_displace[2]}r=_,n=i,a=s,(o=l)||(o=new Float32Array(16)),LA(o),o[12]=r,o[13]=n,o[14]=a;var d=R(e);y(d,l),c.push(d)}for(E=0;E<c.length;E++)I(e,c[E])}function O(e,t){for(var r=a.create_spline(t.object),n=new Float32Array(16),o=r.is_3d?4:3,_=new Float32Array(o),i=new Float32Array(o),s=new Float32Array(3),l=new Float32Array(4),c=new Float32Array(4),u=new Float32Array(3),d=new Float32Array(3),T=new Float32Array(3),f=0;f<e.submeshes.length;f++){var p=e.submeshes[f],P=p.position,S=p.tbn,A=N(t.deform_axis);u[0]=0,u[1]=0,u[2]=0,u[A]=1;for(var h=a.spline_length(r),v=0;v<P.length/3;v++){T[0]=P[3*v],T[1]=P[3*v+1],T[2]=P[3*v+2];var m=T[A],g=a.spline_len_to_t(r,m);a.spline_point(r,g,_),s[0]=_[0],s[1]=_[1],s[2]=_[2],a.spline_derivative(r,g,i),d[0]=i[0],d[1]=0,d[2]=i[2],Rh(d,d),Sm(u,d,l),m<0?(_[0]=d[0],_[1]=d[1],_[2]=d[2],Sh(_,m,_),uh(s,_,s)):m>h&&(_[0]=d[0],_[1]=d[1],_[2]=d[2],Sh(_,m-h,_),uh(s,_,s)),VA(l,s,n),r.is_3d&&(vm(u,_[3],c),wh(T,c,T)),T[A]=0,xh(T,n,T),P[3*v]=T[0],P[3*v+1]=T[1],P[3*v+2]=T[2];var O=GR(S,v,E);XR(O,l,O),KR(S,O,v)}}}function N(e){switch(e){case"POS_X":case"NEG_X":return 0;case"POS_Y":case"NEG_Y":return 1;case"POS_Z":case"NEG_Z":return 2;default:r.panic("Wrong deform axis value "+e)}}function R(e,t){t||(t=e.name+"_COPY");var r=e.materials,n=e.submeshes;e.materials=null,e.submeshes=null;var a=lO(e);e.materials=r,e.submeshes=n,a.name=t,a.materials=e.materials.slice(0),a.submeshes=[];for(var o=0;o<n.length;o++){var _=cO(n[o]);a.submeshes.push(_)}return a}function I(e,t){for(var r=0;r<e.submeshes.length;r++){var n=e.submeshes[r],a=t.submeshes[r],_=n.base_length,i=n.indices.length;if(_)for(var s in n)switch(s){case"base_length":n[s]+=a[s];break;case"boundings":break;case"indices":n[s]=(E=a[s],d=void 0,u=(c=n[s]).length,(d=new Uint32Array(u+E.length)).set(c),d.set(E,u),d);for(var l=i;l<n[s].length;l++)n[s][l]+=_;break;case"position":n[s]=b(n[s],a[s],n[s].length/_/3);break;case"tbn":n[s]=b(n[s],a[s],n[s].length/_/4);break;case"shade_tangs":n[s]=b(n[s],a[s],n[s].length/_/3);break;case"group":n[s]=b(n[s],a[s],n[s].length/_);break;case"texcoord":n[s]=b(n[s],a[s],n.uv_layers.length);break;case"color":n[s]=b(n[s],a[s],n.vertex_colors.length);break;case"uv_layers":case"vertex_colors":break;default:o.warn('array_mesh_join(): unknown submesh property "'+s+'"'),n[s]=Vg(n[s],a[s])}}var c,E,u,d;return e}function b(e,t,r){if(r>1){for(var n=e.length/r,a=t.length/r,o=new Float32Array(e.length+t.length),_=0,i=0;i<r;i++)o.set(e.subarray(n*i,n*(i+1)),_),_+=n,o.set(t.subarray(a*i,a*(i+1)),_),_+=a;return o}return Vg(e,t)}function y(e,t){for(var r=xm(_A(t,c),u),n=0;n<e.submeshes.length;n++){var a=e.submeshes[n];fO(a.position,t,a.position,0),XR(a.tbn,r,a.tbn)}}t.check_bpy_data=function(e){l={};var t=function(t,r){switch(t.type){case"ARRAY":if(!("fit_type"in t))return function(e,t,r){o.error("WARNING Incomplete modifier "+String(e)+' for "'+t.name+'", reexport "'+r+'" scene')}(t.type,r,e.b4w_filepath_blend),!1}return!0},r=e.worlds;if(0==r.length){o.warn('WARNING Datablock world is missing, reexport "'+e.b4w_filepath_blend+'" scene');var n={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,use_nodes:!1,node_tree:null,texture_slots:[]};r.push(n)}for(var a=0;a<r.length;a++){"use_sky_blend"in(n=r[a])||(S("world",n,"use_sky_blend"),n.use_sky_blend=!1),"use_sky_paper"in n||(S("world",n,"use_sky_paper"),n.use_sky_paper=!1),"use_sky_real"in n||(S("world",n,"use_sky_real"),n.use_sky_real=!1),"b4w_sky_settings"in n&&"rayleigh_brightness"in n.b4w_sky_settings||(S("world",n,"rayleigh_brightness"),n.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4}),"fog_settings"in n||(S("world",n,"fog_settings"),n.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in n&&(n.fog_settings.use_custom_color=!0,n.fog_settings.color=n.b4w_fog_color),"b4w_fog_density"in n&&n.b4w_fog_density>0&&(n.fog_settings.depth=1/n.b4w_fog_density)),"render_sky"in n.b4w_sky_settings||(S("world",n,"render_sky"),n.b4w_sky_settings.render_sky=!1);for(var _=n.texture_slots,i=0;i<_.length;i++)"blend_type"in(q=_[i])||(q.blend_type="MIX",S("world_texture_slot",q,"blend_type")),"use_map_blend"in q||(q.use_map_blend=!1,S("world_texture_slot",q,"use_map_blend")),"use_map_horizon"in q||(q.use_map_horizon=!0,S("world_texture_slot",q,"use_map_horizon")),"use_map_zenith_up"in q||(q.use_map_zenith_up=!1,S("world_texture_slot",q,"use_map_zenith_up")),"use_rgb_to_intensity"in q||(q.use_rgb_to_intensity=!1,S("world_texture_slot",q,"use_rgb_to_intensity")),"invert"in q||(q.invert=!1,S("world_texture_slot",q,"invert")),"color"in q||(q.color=[1,0,1],S("world_texture_slot",q,"color")),"blend_factor"in q||(q.blend_factor=0,S("world_texture_slot",q,"blend_factor")),"horizon_factor"in q||(q.horizon_factor=1,S("world_texture_slot",q,"horizon_factor")),"zenith_up_factor"in q||(q.zenith_up_factor=0,S("world_texture_slot",q,"zenith_up_factor")),"zenith_down_factor"in q||(q.zenith_down_factor=0,S("world_texture_slot",q,"zenith_down_factor")),"default_value"in q||(q.default_value=1,S("world_texture_slot",q,"default_value"));"b4w_use_default_animation"in n||(S("world",n,"b4w_use_default_animation"),n.b4w_use_default_animation=!1),"b4w_anim_behavior"in n||(S("world",n,"b4w_anim_behavior"),n.b4w_anim_behavior="CYCLIC")}var c=e.scenes;for(a=0;a<c.length;a++){var E=c[a],u=E.world;"timeline_markers"in E||(E.timeline_markers=null,S("scene",E,"timeline_markers")),"boolean"==typeof E.b4w_enable_physics&&(E.b4w_enable_physics="AUTO"),"b4w_reflection_quality"in E||(E.b4w_reflection_quality="MEDIUM",S("scene",E,"b4w_reflection_quality")),"b4w_use_nla"in E||(E.b4w_use_nla=!1,S("scene",E,"b4w_use_nla")),"fps"in E||(E.fps=24,S("scene",E,"fps")),"b4w_nla_cyclic"in E||(E.b4w_nla_cyclic=!1,S("scene",E,"b4w_nla_cyclic")),"b4w_logic_nodes"in E||(E.b4w_logic_nodes=[],S("scene",E,"b4w_logic_nodes")),"b4w_detect_collisions"in E&&(A("scene",E,"b4w_detect_collisions"),delete E.b4w_detect_collisions),"audio_doppler_speed"in E||(E.audio_doppler_speed=343.3),"audio_doppler_factor"in E||(E.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in E||(E.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},S("scene",E,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in E||(E.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in E||(E.b4w_enable_bloom=!1,S("scene",E,"b4w_enable_bloom")),"b4w_enable_motion_blur"in E||(E.b4w_enable_motion_blur=!1,S("scene",E,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in E||(E.b4w_enable_color_correction=!1,S("scene",E,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in E||(E.b4w_antialiasing_quality="MEDIUM",S("scene",E,"b4w_antialiasing_quality")),"b4w_tags"in E||(E.b4w_tags={title:"",description:""},S("scene",E,"b4w_tags")),"b4w_lod_smooth_type"in E||(E.b4w_lod_smooth_type="OFF",S("scene",E,"b4w_lod_smooth_type")),"b4w_lod_hyst_interval"in E||(E.b4w_lod_hyst_interval=0,S("scene",E,"b4w_lod_hyst_interval")),"b4w_enable_object_selection"in E||(E.b4w_enable_object_selection="AUTO",S("scene",E,"b4w_enable_object_selection")),"b4w_enable_outlining"in E||(E.b4w_enable_outlining="AUTO",S("scene",E,"b4w_enable_outlining")),"b4w_enable_glow_materials"in E||(E.b4w_enable_glow_materials="AUTO",S("scene",E,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in E||(E.b4w_enable_anchors_visibility="AUTO",S("scene",E,"b4w_enable_anchors_visibility")),"b4w_outline_color"in E||(E.b4w_outline_color=[1,1,1],S("scene",E,"b4w_outline_color")),"b4w_outline_factor"in E||(E.b4w_outline_factor="b4w_glow_factor"in E?E.b4w_glow_factor:1,S("scene",E,"b4w_outline_factor")),"b4w_shadow_settings"in E||(S("scene",E,"b4w_shadow_settings"),E.b4w_shadow_settings=u.b4w_shadow_settings||{csm_resolution:2048,blur_samples:"16x",self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,fade_last_cascade:!0,blend_between_cascades:!0});var g=E.b4w_shadow_settings;"csm_resolution"in g||(S("scene",E,"b4w_shadow_settings.csm_resolution"),g.csm_resolution=2048),"blur_samples"in g||(S("scene",E,"b4w_shadow_settings.blur_samples"),g.blur_samples="16x"),"soft_shadows"in g||(S("scene",E,"b4w_shadow_settings.soft_shadows"),g.soft_shadows=!0),"self_shadow_polygon_offset"in g||(S("scene",E,"b4w_shadow_settings.self_shadow_polygon_offset"),g.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in g||(S("scene",E,"b4w_shadow_settings.self_shadow_normal_offset"),g.self_shadow_normal_offset=.01),"b4w_enable_csm"in g||(S("scene",E,"b4w_shadow_settings.b4w_enable_csm"),g.b4w_enable_csm=!1),"csm_num"in g||(S("scene",E,"b4w_shadow_settings.csm_num"),g.csm_num=1),"csm_first_cascade_border"in g||(S("scene",E,"b4w_shadow_settings.csm_first_cascade_border"),g.csm_first_cascade_border=10),"first_cascade_blur_radius"in g||(S("scene",E,"b4w_shadow_settings.first_cascade_blur_radius"),g.first_cascade_blur_radius=3),"csm_last_cascade_border"in g||(S("scene",E,"b4w_shadow_settings.csm_last_cascade_border"),g.csm_last_cascade_border=100),"last_cascade_blur_radius"in g||(S("scene",E,"b4w_shadow_settings.last_cascade_blur_radius"),g.last_cascade_blur_radius=1.5),"fade_last_cascade"in g||(S("scene",E,"b4w_shadow_settings.fade_last_cascade"),g.fade_last_cascade=!0),"blend_between_cascades"in g||(S("scene",E,"b4w_shadow_settings.blend_between_cascades"),g.blend_between_cascades=!0),"b4w_ssao_settings"in E||(S("scene",E,"b4w_ssao_settings"),E.b4w_ssao_settings=u.b4w_ssao_settings||{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1});var O=E.b4w_ssao_settings;if("dist_factor"in O||(S("scene",E,"b4w_ssao_settings.dist_factor"),O.dist_factor=0),"samples"in O||(S("scene",E,"b4w_ssao_settings.samples"),O.samples=16),"hemisphere"in O||(S("scene",E,"b4w_ssao_settings.hemisphere"),O.hemisphere=!1),"blur_depth"in O||(S("scene",E,"b4w_ssao_settings.blur_depth"),O.blur_depth=!1),"blur_discard_value"in O||(S("scene",E,"b4w_ssao_settings.blur_discard_value"),O.blur_discard_value=1),"b4w_bloom_settings"in E||(S("scene",E,"b4w_bloom_settings"),E.b4w_bloom_settings=u.b4w_bloom_settings||{key:.2,blur:4,edge_lum:1}),"key"in E.b4w_bloom_settings||(S("scene",E,"b4w_bloom_settings.key"),E.b4w_bloom_settings.key=.2),"blur"in E.b4w_bloom_settings||(S("scene",E,"b4w_bloom_settings.blur"),E.b4w_bloom_settings.blur=4),"edge_lum"in E.b4w_bloom_settings||(S("scene",E,"b4w_bloom_settings.edge_lum"),E.b4w_bloom_settings.edge_lum=1),"adaptive"in E.b4w_bloom_settings||(S("scene",E,"b4w_bloom_settings.adaptive"),E.b4w_bloom_settings.adaptive=!0),"average_luminance"in E.b4w_bloom_settings||(S("scene",E,"b4w_bloom_settings.average_luminance"),E.b4w_bloom_settings.average_luminance=.5),"b4w_motion_blur_settings"in E||(S("scene",E,"b4w_motion_blur_settings"),E.b4w_motion_blur_settings=u.b4w_motion_blur_settings||{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in E.b4w_motion_blur_settings||(S("scene",E,"b4w_motion_blur_settings.motion_blur_factor"),E.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in E.b4w_motion_blur_settings||(S("scene",E,"b4w_motion_blur_settings.motion_blur_decay_threshold"),E.b4w_motion_blur_settings.motion_blur_decay_threshold=.01),"b4w_color_correction_settings"in E||(S("scene",E,"b4w_color_correction_settings"),E.b4w_color_correction_settings=u.b4w_color_correction_settings||{brightness:0,contrast:0,exposure:1,saturation:1}),"b4w_god_rays_settings"in E||(S("scene",E,"b4w_god_rays_settings"),E.b4w_god_rays_settings=u.b4w_god_rays_settings||{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in E.b4w_god_rays_settings||(S("scene",E,"b4w_god_rays_settings.steps_per_pass"),E.b4w_god_rays_settings.steps_per_pass=10),!("b4w_glow_settings"in E)){S("scene",E,"b4w_glow_settings"),E.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6};var N=E.b4w_glow_settings;"b4w_render_glow_over_blend"in u&&(N.render_glow_over_blend=u.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in u&&(N.small_glow_mask_coeff=u.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in u&&(N.large_glow_mask_coeff=u.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in u&&(N.small_glow_mask_width=u.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in u&&(N.large_glow_mask_width=u.b4w_large_glow_mask_width)}var R=E.b4w_render_shadows;"AUTO"!=R&&"OFF"!=R&&"ON"!=R&&(E.b4w_render_shadows=R?"ON":"OFF");var I=E.b4w_render_reflections;"OFF"!=I&&"ON"!=I&&(E.b4w_render_reflections=I?"ON":"OFF");var b=E.b4w_render_refractions;"AUTO"!=b&&"OFF"!=b&&"ON"!=b&&(E.b4w_render_refractions=b?"ON":"OFF"),"b4w_render_dynamic_grass"in E||(S("scene",E,"b4w_render_dynamic_grass"),E.b4w_render_dynamic_grass="AUTO"),E.b4w_nla_script&&A("scene",E,"b4w_nla_script"),"audio_distance_model"in E||(S("scene",E,"audio_distance_model"),E.audio_distance_model="INVERSE_CLAMPED"),"b4w_custom_prop"in E||(S("scene",E,"b4w_custom_prop"),E.b4w_custom_prop=null)}var y=e.meshes;for(a=0;a<y.length;a++){var L=y[a];if(!L.b4w_boundings){S("mesh",L,"b4w_boundings"),L.b4w_boundings={};var Y=L.b4w_boundings;Y.bb=L.b4w_bounding_box?L.b4w_bounding_box:{max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0},Y.bb_src=L.b4w_bounding_box_source?L.b4w_bounding_box_source:L.b4w_bounding_box,Y.bs_cen=L.b4w_bounding_sphere_center?L.b4w_bounding_sphere_center:[0,0,0],Y.bc_cen=L.b4w_bounding_cylinder_center?L.b4w_bounding_cylinder_center:[0,0,0],Y.be_cen=L.b4w_bounding_ellipsoid_center?L.b4w_bounding_ellipsoid_center:[0,0,0],Y.be_ax=L.b4w_bounding_ellipsoid_axes?L.b4w_bounding_ellipsoid_axes:[((C=Y.bb).max_x-C.min_x)/2,(C.max_y-C.min_y)/2,(C.max_z-C.min_z)/2],Y.rbb=L.b4w_rotated_bounding_box?L.b4w_rotated_bounding_box:{rbb_c:[((C=Y.bb).max_x+C.min_x)/2,(C.max_y+C.min_y)/2,(C.max_z+C.min_z)/2],rbb_s:[1,1,1]},Y.caxis_x=L.b4w_cov_axis_x?L.b4w_cov_axis_x:[1,0,0],Y.caxis_y=L.b4w_cov_axis_y?L.b4w_cov_axis_y:[0,1,0],Y.caxis_z=L.b4w_cov_axis_z?L.b4w_cov_axis_z:[0,0,1]}"is_boundings_overridden"in L||(S("mesh",L,"is_boundings_overridden"),L.is_boundings_overridden=!1),"b4w_shape_keys"in L||(L.b4w_shape_keys=[],S("mesh",L,"b4w_shape_keys"));for(var M=!0,x=0;x<L.submeshes.length;x++){var C,w=L.submeshes[x];"boundings"in w||(M=!1,w.boundings={be_ax:L.b4w_bounding_ellipsoid_axes,be_cen:L.b4w_bounding_ellipsoid_center,bb:{max_x:L.b4w_bounding_box.max_x,max_y:L.b4w_bounding_box.max_y,max_z:L.b4w_bounding_box.max_z,min_x:L.b4w_bounding_box.min_x,min_y:L.b4w_bounding_box.min_y,min_z:L.b4w_bounding_box.min_z}}),"uv_layers"in w||(S("submesh",L,"uv_layers"),w.uv_layers=L.uv_textures),"be_ax"in w.boundings||(w.boundings.be_ax=L.b4w_bounding_ellipsoid_axes),"be_cen"in w.boundings||(w.boundings.be_cen=L.b4w_bounding_ellipsoid_center),"bb"in w.boundings||(w.boundings.bb=L.b4w_bounding_box),"rbb"in w.boundings||(w.boundings.rbb={rbb_c:[((C=L.b4w_bounding_box).max_x+C.min_x)/2,(C.max_y+C.min_y)/2,(C.max_z+C.min_z)/2],rbb_s:[1,1,1]}),"caxis_x"in w.boundings||(w.boundings.caxis_x=[1,0,0]),"caxis_y"in w.boundings||(w.boundings.caxis_y=[0,1,0]),"caxis_z"in w.boundings||(w.boundings.caxis_z=[0,0,1])}for(M||S("mesh",L,"submesh_bd"),f(L),i=0;i<L.b4w_vertex_anim.length;i++){var U=L.b4w_vertex_anim[i];"allow_nla"in U||(S('mesh["b4w_vertex_anim"]',L,"allow_nla"),U.allow_nla=!0)}"active_uv_name"in L||(S("mesh",L,"active_uv_name"),L.active_uv_name="")}var k=e.cameras;for(a=0;a<k.length;a++){var D=k[a];D.type||(D.type="PERSP",S("camera",D,"type")),"b4w_eye_target_dist"in D&&(delete D.b4w_eye_target_dist,A("camera",D,"b4w_eye_target_dist")),"b4w_hover_zero_level"in D||(D.b4w_hover_zero_level=0,S("camera",D,"b4w_hover_zero_level")),"b4w_trans_velocity"in D||(D.b4w_trans_velocity=1,S("camera",D,"b4w_trans_velocity")),"b4w_rot_velocity"in D||(D.b4w_rot_velocity=1,S("camera",D,"b4w_rot_velocity")),"b4w_zoom_velocity"in D||(D.b4w_zoom_velocity=.1,S("camera",D,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in D||(D.b4w_use_target_distance_limits=D.b4w_use_distance_limits||!1,S("camera",D,"b4w_use_target_distance_limits")),"b4w_use_zooming"in D||(D.b4w_use_zooming=D.b4w_use_distance_limits||!1,S("camera",D,"b4w_use_zooming")),"b4w_distance_min"in D||(D.b4w_distance_min=1,S("camera",D,"b4w_distance_min")),"b4w_distance_max"in D||(D.b4w_distance_max=100,S("camera",D,"b4w_distance_max")),"b4w_horizontal_translation_min"in D||(D.b4w_horizontal_translation_min=-100,S("camera",D,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in D||(D.b4w_horizontal_translation_max=100,S("camera",D,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in D||(D.b4w_vertical_translation_min=-100,S("camera",D,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in D||(D.b4w_vertical_translation_max=100,S("camera",D,"b4w_vertical_translation_max")),"b4w_use_horizontal_clamping"in D||(D.b4w_use_horizontal_clamping=!1,S("camera",D,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in D||(D.b4w_rotation_left_limit=-Math.PI,S("camera",D,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in D||(D.b4w_rotation_right_limit=Math.PI,S("camera",D,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in D||(D.b4w_horizontal_clamping_type="LOCAL",S("camera",D,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in D||(D.b4w_use_vertical_clamping=!1,S("camera",D,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in D||(D.b4w_rotation_down_limit=-Math.PI/2,S("camera",D,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in D||(D.b4w_rotation_up_limit=Math.PI/2,S("camera",D,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in D||(D.b4w_vertical_clamping_type="LOCAL",S("camera",D,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in D||(D.b4w_hover_angle_min=Math.PI/6,S("camera",D,"b4w_hover_angle_min")),"b4w_hover_angle_max"in D||(D.b4w_hover_angle_max=Math.PI/6,S("camera",D,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in D||(D.b4w_enable_hover_hor_rotation=!0,S("camera",D,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in D||(D.b4w_use_panning=!0,S("camera",D,"b4w_use_panning")),"b4w_use_pivot_limits"in D||(D.b4w_use_pivot_limits=!1,D.b4w_pivot_z_min=0,D.b4w_pivot_z_max=10,S("camera",D,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in D||(D.b4w_dof_bokeh=!1,S("camera",D,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in D||(D.b4w_dof_bokeh_intensity=.3,S("camera",D,"b4w_dof_bokeh_intensity")),"b4w_dof_foreground_blur"in D||(D.b4w_dof_foreground_blur=!1,S("camera",D,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in D||(D.b4w_dof_front_start=0,S("camera",D,"b4w_dof_front_start")),"b4w_dof_front_end"in D||(D.b4w_dof_front_end=D.b4w_dof_front,S("camera",D,"b4w_dof_front_end")),"b4w_dof_rear_start"in D||(D.b4w_dof_rear_start=0,S("camera",D,"b4w_dof_rear_start")),"b4w_dof_rear_end"in D||(D.b4w_dof_rear_end=D.b4w_dof_rear,S("camera",D,"b4w_dof_rear_end")),"sensor_fit"in D||(D.sensor_fit="VERTICAL",S("camera",D,"sensor_fit"))}var F=e.lamps;for(a=0;a<F.length;a++){var G=F[a];"b4w_generate_shadows"in G||(G.b4w_generate_shadows=!1,S("lamp",G,"b4w_generate_shadows")),"b4w_dynamic_intensity"in G||(G.b4w_dynamic_intensity=!1,S("lamp",G,"b4w_dynamic_intensity")),"use_diffuse"in G||(G.use_diffuse=!0,S("lamp",G,"use_diffuse")),"use_specular"in G||(G.use_specular=!0,S("lamp",G,"use_specular")),"clip_start"in G||(G.clip_start=.1,S("lamp",G,"clip_start")),"clip_end"in G||(G.clip_end=30,S("lamp",G,"clip_end")),"POINT"!=G.type&&"SPOT"!=G.type||("use_sphere"in G||(G.use_sphere=!1,S("lamp",G,"use_sphere")),s.mali4_lamps_hack&&(G.type="SUN"))}var K=e.speakers;for(a=0;a<K.length;a++){var B=K[a];"b4w_behavior"in B||(B.b4w_behavior=B.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in B||(B.b4w_auto_play=!1,S("speaker",B,"b4w_auto_play")),"b4w_enable_doppler"in B||(B.b4w_enable_doppler=!1,S("speaker",B,"b4w_enable_doppler")),"b4w_delay"in B||(B.b4w_delay=0),"b4w_delay_random"in B||(B.b4w_delay_random=0),"b4w_volume_random"in B||(B.b4w_volume_random=0),"b4w_pitch_random"in B||(B.b4w_pitch_random=0),"b4w_fade_in"in B||(B.b4w_fade_in=0),"b4w_fade_out"in B||(B.b4w_fade_out=0),"b4w_loop"in B||(B.b4w_loop=!1),"b4w_loop_start"in B||(B.b4w_loop_start=0,S("speaker",B,"b4w_loop_start")),"b4w_loop_end"in B||(B.b4w_loop_end=0,S("speaker",B,"b4w_loop_end")),B.animation_data&&T(B.animation_data)}var X=e.textures;for(a=0;a<X.length;a++){var H=X[a];"b4w_anisotropic_filtering"in H||(H.b4w_anisotropic_filtering="OFF",S("texture",H,"b4w_anisotropic_filtering")),"b4w_water_foam"in H||(H.b4w_water_foam=!1,S("texture",H,"b4w_water_foam")),"b4w_foam_uv_freq"in H||(H.b4w_foam_uv_freq=[1,1],S("texture",H,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in H||(H.b4w_foam_uv_magnitude=[1,1],S("texture",H,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in H||(H.b4w_parallax_steps=5,S("material",H,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in H||(H.b4w_parallax_lod_dist=10,S("material",H,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in H||(H.b4w_shore_dist_map=!1,S("texture",H,"b4w_shore_dist_map")),"b4w_shore_boundings"in H||(H.b4w_shore_boundings=[1e3,-1e3,1e3,-1e3],S("texture",H,"b4w_shore_boundings")),"b4w_max_shore_dist"in H||(H.b4w_max_shore_dist=100,S("texture",H,"b4w_max_shore_dist")),"b4w_disable_compression"in H||(H.b4w_disable_compression=!1,S("texture",H,"b4w_disable_compression")),"b4w_source_type"in H||(H.b4w_source_type="",S("texture",H,"b4w_source_type")),"b4w_source_id"in H||(H.b4w_source_id="",S("texture",H,"b4w_source_id")),"b4w_source_size"in H||(H.b4w_source_size=1024,S("texture",H,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in H||(H.b4w_enable_canvas_mipmapping=!0,S("texture",H,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in H||(H.b4w_nla_video=!1,S("texture",H,"b4w_nla_video"))}var j=e.images;for(a=0;a<j.length;a++){var z=j[a];"colorspace_settings_name"in z||(z.colorspace_settings_name="sRGB",S("image",z,"colorspace_settings_name"))}var Q=e.materials;for(a=0;a<Q.length;a++){var V=Q[a];"ALPHA_ANTIALIASING"==V.game_settings.alpha_blend&&(s.mali_alpha_antialias_hack?V.game_settings.alpha_blend="CLIP":s.msaa_samples<2&&(o.warn('Material "'+V.name+'" has the "Alpha Anti-Aliasing" transparency type, but multisampling is disabled. Changed to "Alpha Clip".'),V.game_settings.alpha_blend="CLIP")),"use_tangent_shading"in V||(V.use_tangent_shading=!1,S("material",V,"use_tangent_shading")),"b4w_node_mat_type"in V&&A("material",V,"b4w_node_mat_type"),"b4w_skydome"in V&&A("material",V,"b4w_skydome"),"b4w_procedural_skydome"in V&&A("material",V,"b4w_procedural_skydome"),"b4w_lens_flares"in V||(V.b4w_lens_flares=!1,S("material",V,"b4w_lens_flares")),"LENS_FLARES"===V.name&&(V.b4w_lens_flares||o.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),V.b4w_lens_flares=!0),V.b4w_water&&("b4w_water_shore_smoothing"in V||(V.b4w_water_shore_smoothing=!1,S("material",V,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in V||(V.b4w_water_dynamic=!1,S("material",V,"b4w_water_dynamic")),"b4w_waves_height"in V||(V.b4w_waves_height=1,S("material",V,"b4w_waves_height")),"b4w_waves_length"in V||(V.b4w_waves_length=1,S("material",V,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in V||(V.b4w_water_dst_noise_scale0=.05,S("material",V,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in V||(V.b4w_water_dst_noise_scale1=.03,S("material",V,"b4w_water_dst_noise_scale1")),"b4w_water_dst_noise_freq0"in V||(V.b4w_water_dst_noise_freq0=1.3,S("material",V,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in V||(V.b4w_water_dst_noise_freq1=1,S("material",V,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in V||(V.b4w_water_dir_min_shore_fac=.4,S("material",V,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in V||(V.b4w_water_dir_freq=.5,S("material",V,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in V||(V.b4w_water_dir_noise_scale=.05,S("material",V,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in V||(V.b4w_water_dir_noise_freq=.07,S("material",V,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in V||(V.b4w_water_dir_min_noise_fac=.5,S("material",V,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in V||(V.b4w_water_dst_min_fac=.2,S("material",V,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in V||(V.b4w_water_waves_hor_fac=5,S("material",V,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in V||(V.b4w_water_absorb_factor=6,S("material",V,"b4w_water_absorb_factor")),"b4w_water_fog_color"in V||(V.b4w_water_fog_color=[.5,.7,.7],S("material",V,"b4w_water_fog_color")),"b4w_foam_factor"in V||(V.b4w_foam_factor=5,S("material",V,"b4w_foam_factor")),"b4w_generated_mesh"in V||(V.b4w_generated_mesh=!1,S("material",V,"b4w_generated_mesh")),"b4w_water_num_cascads"in V||(V.b4w_water_num_cascads=5,S("material",V,"b4w_water_num_cascads")),"b4w_water_subdivs"in V||(V.b4w_water_subdivs=64,S("material",V,"b4w_water_subdivs")),"b4w_water_detailed_dist"in V||(V.b4w_water_detailed_dist=1e3,S("material",V,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in V||(V.b4w_water_enable_caust=!1,S("material",V,"b4w_water_enable_caust")),"b4w_water_caust_scale"in V||(V.b4w_water_caust_scale=.25,S("material",V,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in V||(V.b4w_water_caust_brightness=.5,S("material",V,"b4w_water_caust_brightness"))),"b4w_dynamic_grass_size"in V||(V.b4w_dynamic_grass_size=""),"b4w_dynamic_grass_color"in V||(V.b4w_dynamic_grass_color=""),"diffuse_intensity"in V||(V.diffuse_intensity=1,S("material",V,"diffuse_intensity")),"b4w_use_ghost"in V||(V.b4w_use_ghost=!1),"b4w_collision_margin"in V||(V.b4w_collision_margin=.04,S("material",V,"b4w_collision_margin")),"b4w_collision_group"in V||(V.b4w_collision_group=128,S("material",V,"b4w_collision_group")),"b4w_collision_mask"in V||(V.b4w_collision_mask=127,S("material",V,"b4w_collision_mask")),"b4w_do_not_render"in V||(V.b4w_do_not_render=!1,S("material",V,"b4w_do_not_render")),"HALO"!=V.type||"b4w_halo_sky_stars"in V||(V.b4w_halo_sky_stars=!1,S("material",V,"b4w_halo_sky_stars")),"HALO"!=V.type||"b4w_halo_stars_blend_height"in V||(V.b4w_halo_stars_blend_height=10,S("material",V,"b4w_halo_stars_blend_height")),"HALO"!=V.type||"b4w_halo_stars_min_height"in V||(V.b4w_halo_stars_min_height=0,S("material",V,"b4w_halo_stars_min_height")),"specular_shader"in V||(V.specular_shader="COOKTORR",S("material",V,"specular_shader")),"diffuse_shader"in V||(V.diffuse_shader="LAMBERT",S("material",V,"diffuse_shader")),"roughness"in V||(V.roughness=.5,S("material",V,"roughness")),"diffuse_fresnel"in V||(V.diffuse_fresnel=.1,S("material",V,"diffuse_fresnel")),"diffuse_fresnel_factor"in V||(V.diffuse_fresnel_factor=.5,S("material",V,"diffuse_fresnel_factor")),"specular_slope"in V||(V.specular_slope=.2,S("material",V,"specular_slope")),"specular_toon_size"in V||(V.specular_toon_size=.5,S("material",V,"specular_toon_size")),"specular_toon_smooth"in V||(V.specular_toon_smooth=.1,S("material",V,"specular_toon_smooth")),"specular_alpha"in V||(V.specular_alpha=1,S("material",V,"specular_alpha")),"b4w_wettable"in V||(V.b4w_wettable=!1,S("material",V,"b4w_wettable")),"b4w_refractive"in V||(V.b4w_refractive=!1,S("material",V,"b4w_refractive")),"b4w_refr_bump"in V||(V.b4w_refr_bump=0,S("material",V,"b4w_refr_bump")),"b4w_shallow_water_col"in V||(V.b4w_shallow_water_col=[0,.8,.3],S("material",V,"b4w_shallow_water_col")),"b4w_shore_water_col"in V||(V.b4w_shore_water_col=[0,.9,.2],S("material",V,"b4w_shore_water_col")),"b4w_shallow_water_col_fac"in V||(V.b4w_shallow_water_col_fac=1,S("material",V,"b4w_shallow_water_col_fac")),"b4w_shore_water_col_fac"in V||(V.b4w_shore_water_col_fac=.5,S("material",V,"b4w_shore_water_col_fac")),"b4w_water_sss_strength"in V||(V.b4w_water_sss_strength=5.9,S("material",V,"b4w_water_sss_strength")),"b4w_water_sss_width"in V||(V.b4w_water_sss_width=.45,S("material",V,"b4w_water_sss_width")),"b4w_render_above_all"in V||(V.b4w_render_above_all=!1,S("material",V,"b4w_render_above_all")),"b4w_water_norm_uv_velocity"in V||(V.b4w_water_norm_uv_velocity=.05,S("material",V,"b4w_water_norm_uv_velocity")),"specular_ior"in V||(V.specular_ior=1,S("material",V,"specular_ior")),"darkness"in V||(V.darkness=0,S("material",V,"darkness")),"diffuse_toon_size"in V||(V.diffuse_toon_size=0,S("material",V,"diffuse_toon_size")),"diffuse_toon_smooth"in V||(V.diffuse_toon_smooth=0,S("material",V,"diffuse_toon_smooth")),"pass_index"in V||(V.pass_index=0,S("material",V,"pass_index"));for(_=V.texture_slots,i=0;i<_.length;i++){var q;"blend_type"in(q=_[i])||(q.blend_type="MIX",S("texture_slot",q,"blend_type"))}if(V.node_tree){var W=V.node_tree.nodes;for(i=0;i<W.length;i++)d(W[i]);V.node_tree.animation_data&&T(V.node_tree.animation_data)}}var J=e.node_groups;for(a=0;a<J.length;a++)for(W=J[a].node_tree.nodes,i=0;i<W.length;i++)d(W[i]);var Z=e.objects;for(a=0;a<Z.length;a++){var $=Z[a];switch($.type){case"MESH":"b4w_dynamic_geometry"in $||($.b4w_dynamic_geometry=!1),"b4w_reflexible"in $||($.b4w_reflexible=!1),"b4w_reflexible_only"in $||($.b4w_reflexible_only=!1),"b4w_reflective"in $||($.b4w_reflective=!1),"b4w_reflection_type"in $||($.b4w_reflection_type="PLANE",S("object",$,"b4w_reflection_type")),"b4w_wind_bending"in $||($.b4w_wind_bending=!1,S("object",$,"b4w_wind_bending")),"b4w_wind_bending_angle"in $||($.b4w_wind_bending_angle=10,$.b4w_wind_bending_freq=.25,S("object",$,"wind bending params")),"b4w_detail_bending_amp"in $||($.b4w_detail_bending_amp=.1,$.b4w_branch_bending_amp=.3,S("object",$,"detail bending params")),"b4w_detail_bending_freq"in $||($.b4w_detail_bending_freq=1,S("object",$,"b4w_detail_bending_freq")),"b4w_main_bend_stiffness_col"in $||($.b4w_main_bend_stiffness_col="",S("object",$,"b4w_main_bend_stiffness_col")),"b4w_detail_bend_colors"in $||($.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},S("object",$,"b4w_detail_bend_colors")),"b4w_caustics"in $||($.b4w_caustics=!1),"vertex_groups"in $&&$.vertex_groups.length&&$.data&&0==$.data.vertex_groups.length&&($.data.vertex_groups=$.vertex_groups,delete $.vertex_groups,S("object",$,"vertex_groups")),"b4w_vertex_anim"in $&&$.b4w_vertex_anim.length&&$.data&&0==$.data.b4w_vertex_anim.length&&($.data.b4w_vertex_anim=$.b4w_vertex_anim,delete $.b4w_vertex_anim,S("object",$,"b4w_vertex_anim")),"b4w_do_not_render"in $||($.b4w_do_not_render=!1),"b4w_hidden_on_load"in $||($.b4w_hidden_on_load=!1),"b4w_hide_chldr_on_load"in $||($.b4w_hide_chldr_on_load=!1),"use_ghost"in $.game||($.game.use_ghost=!1),"use_sleep"in $.game||($.game.use_sleep=!1),"velocity_min"in $.game||($.game.velocity_min=0),"velocity_max"in $.game||($.game.velocity_max=0),"collision_group"in $.game||($.game.collision_group=1),"collision_mask"in $.game||($.game.collision_mask=255),p($),"b4w_vehicle_settings"in $?$.b4w_vehicle_settings&&("steering_ratio"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.steering_ratio=10),"steering_max"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.steering_max=1),"inverse_control"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.inverse_control=!1),"force_max"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.force_max=1500),"brake_max"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.brake_max=100),"speed_ratio"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.max_speed_angle=Math.PI),"delta_tach_angle"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.wheel_friction=1e3),"roll_influence"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.floating_factor=3),"floating_factor"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in $.b4w_vehicle_settings||($.b4w_vehicle_settings.water_rot_damp=.9)):($.b4w_vehicle_settings=null,S("object",$,"b4w_vehicle_settings")),"b4w_floating_settings"in $?$.b4w_floating_settings&&("floating_factor"in $.b4w_floating_settings||($.b4w_floating_settings.floating_factor=3),"water_lin_damp"in $.b4w_floating_settings||($.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in $.b4w_floating_settings||($.b4w_floating_settings.water_rot_damp=.8)):($.b4w_floating_settings=null,S("object",$,"b4w_floating_settings")),"b4w_character_settings"in $?$.b4w_character_settings&&("walk_speed"in $.b4w_character_settings||($.b4w_character_settings.walk_speed=4),"run_speed"in $.b4w_character_settings||($.b4w_character_settings.run_speed=8),"step_height"in $.b4w_character_settings||($.b4w_character_settings.step_height=.25),"jump_strength"in $.b4w_character_settings||($.b4w_character_settings.jump_strength=5),"waterline"in $.b4w_character_settings||($.b4w_character_settings.waterline=0)):($.b4w_character_settings=null,S("object",$,"b4w_character_settings")),"b4w_selectable"in $||($.b4w_selectable=!1,S("object",$,"b4w_selectable")),"b4w_outlining"in $||($.b4w_outlining=!1,S("object",$,"b4w_outlining")),"b4w_outline_on_select"in $||($.b4w_outline_on_select=!1,S("object",$,"b4w_outline_on_select")),"b4w_billboard"in $||($.b4w_billboard=!1,S("object",$,"b4w_billboard")),"b4w_billboard_geometry"in $||($.b4w_billboard_geometry="SPHERICAL",S("object",$,"b4w_billboard_geometry")),"b4w_pres_glob_orientation"in $||($.b4w_pres_glob_orientation=!1,S("object",$,"b4w_pres_glob_orientation")),"b4w_outline_settings"in $||("b4w_glow_settings"in $?$.b4w_outline_settings=$.b4w_glow_settings:($.b4w_outline_settings={},$.b4w_outline_settings.outline_duration=1,$.b4w_outline_settings.outline_period=1,$.b4w_outline_settings.outline_relapses=0),S("object",$,"b4w_outline_settings")),"lod_levels"in $||($.lod_levels=[],S("object",$,"lod_levels")),"b4w_animation_mixing"in $||($.b4w_animation_mixing=!1,S("object",$,"b4w_animation_mixing"));break;case"EMPTY":"b4w_anchor"in $||($.b4w_anchor=null,S("object",$,"b4w_anchor")),$.b4w_anchor&&!("max_width"in $.b4w_anchor)&&($.b4w_anchor.max_width=250)}if("collision_margin"in $.game||($.game.collision_margin=.04,S("object",$,"collision_margin")),"b4w_anim_behavior"in $||($.b4w_anim_behavior=$.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",S("object",$,"b4w_anim_behavior")),!("rotation_quaternion"in $)){var ee=[0,0,0,1];tO($.rotation_euler,ee),P(ee,ee),$.rotation_quaternion=ee,S("object",$,"rotation_quaternion")}"webgl_do_not_batch"in $&&($.b4w_do_not_batch=$.webgl_do_not_batch,$.webgl_do_not_batch&&A("object",$,"webgl_do_not_batch")),"b4w_shadow_cast_only"in $||($.b4w_shadow_cast_only=!1,S("object",$,"b4w_shadow_cast_only")),"b4w_correct_bounding_offset"in $||($.b4w_correct_bounding_offset="AUTO",S("object",$,"b4w_correct_bounding_offset"));var te=$.particle_systems;for(i=0;i<te.length;i++){var re=te[i],ne=re.settings;"use_rotation_dupli"in ne||(ne.use_rotation_dupli=!1,S("particle_settings",ne,"use_rotation_dupli")),"use_whole_group"in ne||(ne.use_whole_group=!1,S("particle_settings",ne,"use_whole_group")),re.transforms||(re.transforms=new Float32Array,S("particle_system",re,"transforms")),"b4w_billboard_align"in ne||(ne.b4w_billboard_align="VIEW",S("particle_settings",ne,"b4w_billboard_align")),"b4w_dynamic_grass"in ne||(ne.b4w_dynamic_grass=!1,S("object",ne,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in ne||(ne.b4w_dynamic_grass_scale_threshold=.01,S("object",ne,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in ne||(ne.b4w_initial_rand_rotation=!1,S("particle_settings",ne,"b4w_initial_rand_rotation")),"b4w_rotation_type"in ne||(ne.b4w_rotation_type="Z",S("particle_settings",ne,"b4w_rotation_type")),"b4w_rand_rotation_strength"in ne||(ne.b4w_rand_rotation_strength=1,S("particle_settings",ne,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in ne||(ne.b4w_hair_billboard=!1,S("particle_settings",ne,"b4w_hair_billboard")),"b4w_hair_billboard_type"in ne||(ne.b4w_hair_billboard_type="BASIC",S("particle_settings",ne,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in ne||(ne.b4w_hair_billboard_jitter_amp=0,S("particle_settings",ne,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in ne||(ne.b4w_hair_billboard_jitter_freq=0,S("particle_settings",ne,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in ne||(ne.b4w_hair_billboard_geometry="SPHERICAL",S("particle_settings",ne,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in ne||(ne.b4w_wind_bend_inheritance="PARENT",S("particle_settings",ne,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in ne||(ne.b4w_shadow_inheritance="PARENT",S("particle_settings",ne,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in ne||(ne.b4w_reflection_inheritance="PARENT",S("particle_settings",ne,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in ne||(ne.b4w_vcol_from_name="",S("particle_settings",ne,"b4w_vcol_from_name")),"b4w_vcol_to_name"in ne||(ne.b4w_vcol_to_name="",S("particle_settings",ne,"b4w_vcol_to_name")),"b4w_coordinate_system"in ne||(ne.b4w_coordinate_system="LOCAL",S("particle_settings",ne,"b4w_coordinate_system")),"b4w_allow_nla"in ne||(ne.b4w_allow_nla=!0,S("particle_settings",ne,"b4w_allow_nla")),"b4w_enable_soft_particles"in ne||(ne.b4w_enable_soft_particles=!1,S("particle_settings",ne,"b4w_enable_soft_particles")),"b4w_particles_softness"in ne||(ne.b4w_particles_softness=1,S("particle_settings",ne,"b4w_particles_softness")),"billboard_tilt"in ne||(ne.billboard_tilt=0,S("particle_settings",ne,"billboard_tilt")),"billboard_tilt_random"in ne||(ne.billboard_tilt_random=0,S("particle_settings",ne,"billboard_tilt_random")),"use_rotations"in ne||(ne.use_rotations=!1,S("particle_settings",ne,"use_rotations"))}"constraints"in $||($.constraints=[],S("object",$,"constraints"));var ae=$.constraints;for(i=0;i<ae.length;i++){var oe=ae[i];"influence"in oe||(oe.influence=1),"axes"in oe||(oe.axes=[1,1,1])}var _e=$.modifiers;for(i=0;i<_e.length;i++)t(_e[i],$)||(_e.splice(i,1),i--);if("animation_data"in $||($.animation_data={action:null,nla_tracks:[]},S("object",$,"animation_data")),$.animation_data){if("action"in $.animation_data){if($.animation_data.action){var ie=$.animation_data.action.fcurves;for(var se in ie){var le=ie[se];for(var ce in le){var Ee=le[ce];"num_channels"in Ee||(Ee.num_channels=1,h('B4W Warning: no channels number in animation fcurve for "'+$.animation_data.action.name+'" action, reexport scene'))}}}}else $.animation_data.action=null,h("no action in animation data "+$.name);"nla_tracks"in $.animation_data||($.animation_data.nla_tracks=[],h("no NLA in animation data "+$.name)),T($.animation_data)}"b4w_collision_id"in $||($.b4w_collision_id="",S("object",$,"b4w_collision_id")),"b4w_viewport_alignment"in $||($.b4w_viewport_alignment=null,S("object",$,"b4w_viewport_alignment")),"pinverse_tsr"in $||($.pinverse_tsr=null,S("object",$,"pinverse_tsr")),"b4w_cluster_data"in $||($.b4w_cluster_data={cluster_id:-1,cluster_center:null},S("object",$,"b4w_cluster_data")),"pass_index"in $||($.pass_index=0,S("object",$,"pass_index")),"b4w_custom_prop"in $||(S("object",$,"b4w_custom_prop"),$.b4w_custom_prop=null),m($)&&h('negative scale for object "'+$.name+'", can lead to some errors'),v($)||h("non-uniform scale for object "+$.name)}for(var ue in l){var de=l[ue],Te=ue.match(/.*?(?=>>|$)/i)[0];o.warn('Property "'+String(Te)+'" is '+de.report_type+' for "'+de.type+'". To fix this, reexport '+e.b4w_filepath_blend)}},t.apply_mesh_modifiers=function(e){if(!function(e){for(var t=e.modifiers,r=0;r<t.length;r++){var n=t[r].type;if("ARRAY"==n||"CURVE"==n)return!0}return!1}(e))return null;for(var t=R(e.data,e.data.name+"_MOD"),r=e.modifiers,n=0;n<r.length;n++){var a=r[n];switch(a.type){case"ARRAY":g(t,a);break;case"CURVE":O(t,a)}iR(t)}return t},t.assign_logic_nodes_object_params=function(e,t,r){function n(t,r){var n=t[0];if(t.length>1)for(var a=1;a<t.length;a++)n+="*"+t[a];for(a=0;a<e.length;a++){var o=e[a];if(o.name==n)for(var _ in r)o[_]=r[_]}}function a(e,t){for(var r in e)n(e[r],t)}for(var o=r.b4w_logic_nodes,s=0;s<o.length;s++)for(var l=o[s],c=0;c<l.length;c++){var E=l[c],u={register1:"variable1",register2:"variable2",registerd:"variabled"};for(var d in u)d in E&&(E[u[d]]=E[d]);for(var T in E.variables)"boolean"!=typeof E.variables[T][0]&&(E.variables[T]=[!1,E.variables[T]]);for(var f in["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(E.type)>=0&&("variable1"in E&&(E.variables.id0=[!1,E.variable1]),"variable2"in E&&(E.variables.id1=[!1,E.variable2]),"variabled"in E&&(E.variables.vd=[!1,E.variabled])),E.links)f.startsWith("id")||delete E.links[f];var p=E.common_usage_names,P=E.variables;switch(E.type){case"SELECT":for(var S=0;S<e.length;S++){var A=e[S];A.name==E.object&&(A.b4w_selectable=!0)}E.bools||(E.bools={}),E.bools.not_wait||(E.bools.not_wait=!1),h('Logic nodes type "SELECT" is deprecated');break;case"SWITCH_SELECT":if(a(E.objects_paths,{b4w_selectable:!0}),E.links instanceof Array){h('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+r.name+'"');var v={},m=0;for(S in E.objects_paths)v[S]=E.links[m],m++;E.links=v}break;case"SELECT_PLAY":h('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+r.name+'"'),E.mute=!0;break;case"SELECT_PLAY_ANIM":h('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case"SHOW":case"HIDE":E.bools||(E.bools={}),void 0===E.bools.ch&&(E.bools.ch=!1),E.bools.id0||a(E.objects_paths,{b4w_do_not_batch:!0});break;case"SET_SHADER_NODE_PARAM":case"INHERIT_MAT":a(E.objects_paths,{b4w_do_not_batch:!0});break;case"PLAY":r.b4w_use_nla=!0;break;case"MOVE_TO":a(E.objects_paths,{b4w_do_not_batch:!0});break;case"TRANSFORM_OBJECT":switch(a(E.objects_paths,{b4w_do_not_batch:!0}),p.space_type){case"WORLD":p.space_type=_.NST_WORLD;break;case"PARENT":p.space_type=_.NST_PARENT;break;case"LOCAL":p.space_type=_.NST_LOCAL}break;case"OUTLINE":a(E.objects_paths,{b4w_outlining:!0});break;case"CONDJUMP":if(E.condition&&(p.condition=E.condition),"cnd"in E.floats)p.condition=E.floats.cnd;else switch(p.condition){case"GEQUAL":p.condition=_.NC_GEQUAL;break;case"LEQUAL":p.condition=_.NC_LEQUAL;break;case"GREATER":p.condition=_.NC_GREATER;break;case"LESS":p.condition=_.NC_LESS;break;case"NOTEQUAL":p.condition=_.NC_NOTEQUAL;break;case"EQUAL":p.condition=_.NC_EQUAL}switch(null!=E.number1&&(E.input1=E.number1),null!=E.number2&&(E.input2=E.number2),E.bools||(E.bools={}),E.bools.str&&(p.variable_type="STRING"),p.variable_type){case"NUMBER":p.variable_type=_.NT_NUMBER;break;case"STRING":p.variable_type=_.NT_STRING;break;case"OBJECT":p.variable_type=_.NT_OBJECT}void 0===p.variable_type&&(p.variable_type=_.NT_NUMBER,E.floats.inp1=E.input1,E.floats.inp2=E.input2),void 0===P.id0&&(P.id0=P.v1,P.id1=P.v2);break;case"SEND_REQ":E.bools||(E.bools={}),E.strings||(E.strings={}),void 0===E.bools.ct&&(E.bools.ct=!1),null!=E.url&&(E.bools.url=!1,E.strings.url=E.url);break;case"MATH":switch(null!=E.number1&&(E.input1=E.number1),null!=E.number2&&(E.input2=E.number2),null!=E.input1&&(E.floats.inp1=E.input1),null!=E.input2&&(E.floats.inp2=E.input2),E.operation){case"DIV":E.operation=_.NMO_DIV;break;case"SUB":E.operation=_.NMO_SUB;break;case"MUL":E.operation=_.NMO_MUL;break;case"ADD":E.operation=_.NMO_ADD;break;case"RAND":E.operation=_.NMO_RAND;break;case"SIN":E.operation=_.NMO_SIN;break;case"COS":E.operation=_.NMO_COS;break;case"TAN":E.operation=_.NMO_TAN;break;case"ARCSIN":E.operation=_.NMO_ARCSIN;break;case"ARCCOS":E.operation=_.NMO_ARCCOS;break;case"ARCTAN":E.operation=_.NMO_ARCTAN;break;case"LOG":E.operation=_.NMO_LOG;break;case"MIN":E.operation=_.NMO_MIN;break;case"MAX":E.operation=_.NMO_MAX;break;case"ROUND":E.operation=_.NMO_ROUND;break;case"MOD":E.operation=_.NMO_MOD;break;case"ABS":E.operation=_.NMO_ABS}void 0===P.id0&&(P.id0=P.v1,P.id1=P.v2);break;case"REGSTORE":if(E.floats||(E.floats={}),E.strings||(E.strings={}),null!=E.number1&&(E.input1=E.number1),null!=E.input1)switch(typeof E.input1){case"number":E.floats.inp1=E.input1,p.variable_type="NUMBER";break;default:E.strings.inp1=E.input1,p.variable_type="STRING"}switch(p.variable_type){case"NUMBER":p.variable_type=_.NT_NUMBER;break;case"STRING":p.variable_type=_.NT_STRING;break;case"OBJECT":p.variable_type=_.NT_OBJECT,a(E.objects_paths,{b4w_do_not_batch:!0})}break;case"PAGEPARAM":E.bools||(E.bools={}),void 0===E.bools.hsh&&(E.bools.hsh=!1),E.floats||(E.floats={}),void 0===E.floats.ptp&&(E.floats.ptp=0);break;case"STOP_ANIM":case"PLAY_ANIM":if(E.bools||(E.bools={}),void 0===E.bools.env&&(E.bools.env=!1),void 0===E.bools.id0&&(E.bools.id0=!1),E.bools.id0||n(E.objects_paths.id0,{b4w_do_not_batch:!0}),"PLAY_ANIM"==E.type){var g=p.param_anim_behavior;g||(g="FINISH_STOP"),p.param_anim_behavior=i.anim_behavior_bpy_b4w(g)}break;case"STRING":switch(p.string_operation){case"JOIN":p.string_operation=_.NSO_JOIN;break;case"FIND":p.string_operation=_.NSO_FIND;break;case"REPLACE":p.string_operation=_.NSO_REPLACE;break;case"SPLIT":p.string_operation=_.NSO_SPLIT;break;case"COMPARE":p.string_operation=_.NSO_COMPARE}if("cnd"in E.floats)p.condition=E.floats.cnd;else switch(p.condition){case"GEQUAL":p.condition=_.NC_GEQUAL;break;case"LEQUAL":p.condition=_.NC_LEQUAL;break;case"GREATER":p.condition=_.NC_GREATER;break;case"LESS":p.condition=_.NC_LESS;break;case"NOTEQUAL":p.condition=_.NC_NOTEQUAL;break;case"EQUAL":p.condition=_.NC_EQUAL}break;case"REDIRECT":null!=E.url&&(E.bools.url=!1,E.strings.url=E.url);break;case"SET_CAMERA_MOVE_STYLE":switch(p.camera_move_style){case"STATIC":p.camera_move_style=_.NCMS_STATIC;break;case"TARGET":p.camera_move_style=_.NCMS_TARGET;break;case"EYE":p.camera_move_style=_.NCMS_EYE;break;case"HOVER":p.camera_move_style=_.NCMS_HOVER}break;case"ENTRYPOINT":E.bools||(E.bools={}),void 0===E.bools.js&&(E.bools.js=!1),E.bools.js&&(E.mute=!0);break;case"JS_CALLBACK":var O=p.js_cb_params;for(var d in O)switch(O[d]){case"OBJECT":O[d]=_.NCPT_OBJECT;break;case"VARIABLE":O[d]=_.NCPT_VARIABLE}}}}})),Tb=nA("__data",(function(e,t){var r=gN(e),n=ZI(e),a=wI(e),o=QI(e),_=JI(e),i=dR(e),s=YI(e),l=$I(e),c=SR(e),E=TR(e),u=vR(e),d=fR(e),T=NI(e),f=eb(e),p=GI(e),P=ub(e),S=SI(e),A=WI(e),h=KI(e),v=PI(e),m=CI(e),g=mN(e),O=db(e),N=tI(e),R=LI(e),I=yI(e),b=qI(e),y=mR(e),L=XI(e),Y=AR(e),M=MI(e),x=i.animation,C=i.defaults,w=i.assets,U=i.physics,k=i.sfx,D=null,F=null,G="",K=null,B={},X=new Float32Array(3),H=new Float32Array(4),j=new Float32Array(4),z=DR(),Q=null,V=null,q=0,W=!1,J=null,Z=["LAMP"],$=["MESH","CAMERA","EMPTY"],ee=["BSDF_PRINCIPLED","BSDF_GLOSSY","BSDF_DIFFUSE","BSDF_TRANSPARENT"],te=null;function re(e,t){D[t.id]=null,F[t.id]=null}function ne(e,t,r,n){var a,o;if(e instanceof ArrayBuffer){var _=c.get_width_height(e,n);a=_.width,o=_.height}else a=e.width,o=e.height;g.log("%cLOAD IMAGE "+a+"x"+o,"color: #"+(a>2048||o>2048?"a00":a>1024||o>1024?"aa0":"0a0"),t),-1==t.indexOf(G)&&r&&g.warn("image",t,"is not from app root.")}function ae(e,t,n,a,_,i){var s=t.filepath;s||r.panic("Nothing requested");var l=function(e){i(t,n,e)};if(C.assets_gzip_available)var c=s+".gz",E=o.AT_JSON_ZIP;else c=s,E=o.AT_JSON;o.enqueue([{id:c,type:E,url:c,is_fetch:t.is_preloading}],(function a(i,c,E,u){if(!i)return E==o.AT_JSON_ZIP?(g.warn("Compressed file ",u,"not found or invalid. Trying to load non-compressed",s),void o.enqueue([{id:s,type:o.AT_JSON,url:s,is_fetch:t.is_preloading}],a,null,l)):void f.abort_thread(t);for(var d in g.log("%cLOAD METADATA","color: #616",u),function(e){var t=sN(e.b4w_format_version);switch(_N(t,C.min_format_version)){case-1:t[0]<C.min_format_version[0]?r.panic("JSON version is too old relative to B4W engine: "+iN(t)+", required: "+iN(C.min_format_version)+". Reexport scene with the latest B4W addon to fix it."):g.warn("JSON version is a bit old relative to B4W engine: "+iN(t)+", required: "+iN(C.min_format_version)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:t[0]>C.min_format_version[0]?r.panic("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):g.error("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}C.loaded_data_version=t}(i),i)e[d]=i[d];!function(e,t){e.is_primary&&(K=R.find_main_scene(t.scenes));var r=t.binaries[0].binfile;r?e.binary_name=r:(f.skip_stage_by_name(e,"load_binaries"),f.skip_stage_by_name(e,"prepare_bindata")),C.is_mobile_device||f.skip_stage_by_name(e,"mobile_media_start"),C.antialiasing&&C.smaa||f.skip_stage_by_name(e,"load_smaa_textures")}(t,e),function(e,t){if(e.b4w_export_errors)for(var r=0;r<e.b4w_export_errors.length;r++){var n=e.b4w_export_errors[r];(t.is_primary&&"PRIMARY"==n.type||"ALL"==n.type)&&g.export_error(n.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors")}}(e,t),function(e,t){if(e.b4w_export_warnings)for(var r=0;r<e.b4w_export_warnings.length;r++){var n=e.b4w_export_warnings[r];(t.is_primary&&"PRIMARY"==n.type||"ALL"==n.type)&&g.export_warn(n.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages")}}(e,t),t.is_preloading&&Ne(e),_(t,n)}),null,l)}function oe(e,t,n,a,_,i){var s=lt(t.filepath)+t.binary_name;s||r.panic("Binary data is missing");var l=function(e){i(t,n,e)};if(C.assets_gzip_available)var c=s+".gz",E=o.AT_ARRAYBUFFER_ZIP;else c=s,E=o.AT_ARRAYBUFFER;o.enqueue([{id:c,type:E,url:c,is_fetch:t.is_preloading}],(function a(i,c,E,u){if(!i)return E==o.AT_ARRAYBUFFER_ZIP?(g.warn("Compressed file ",u,"not found or invalid. Trying to load non-compressed",s),void o.enqueue([{id:s,type:o.AT_ARRAYBUFFER,url:s,is_fetch:t.is_preloading}],a,null,l)):void f.abort_thread(t);g.log("%cLOAD BINARY","color: #616",u),e.bin_data=i,function(e,t){var n=function(e){return[new Uint32Array(e,4,1)[0],new Uint32Array(e,8,1)[0]]}(e),a=sN(t.b4w_format_version);n[0]!=a[0]&&r.panic("BIN version does not match to JSON version: "+iN(n)+", required: "+iN(C.min_format_version)+". Couldn't load the scene. Reexport scene to fix it."),n[1]!=a[1]&&g.warn("BIN version does not match to JSON version: "+ +iN(n)+", required: "+iN(C.min_format_version)+". Some compatibility issues can occur. Reexport scene to fix it.")}(i,e),_(t,n)}),null,l)}function _e(e,t,r,n,a,o){b.check_shaders_loaded()&&a(t,r)}function ie(e,t,r,n,o,_){var i,s=e.bin_data,l=e.binaries[0],c=e.objects,E=e.meshes,u=e.actions,d=(i=new Uint16Array([255]),255==new DataView(i.buffer).getUint16(0,!0));!function(e,t,r,n,a){for(var o=["indices"],_=["position","texcoord","texcoord2","shade_tangs"],i=["normal","tangent"],s=["group"],l=["color"],c=0;c<r.length;c++)for(var E=r[c].submeshes,u=0;u<E.length;u++){for(var d in E[u]){var T=E[u][d][1];-1!=o.indexOf(d)?E[u][d]=ce(e,4*E[u][d][0]+t.int+12,T,n):-1!=_.indexOf(d)?E[u][d]=le(e,4*E[u][d][0]+t.float+12,T,n):-1!=i.indexOf(d)?E[u][d]=Ee(e,2*E[u][d][0]+t.short+12,T):-1!=s.indexOf(d)?E[u][d]=ue(e,2*E[u][d][0]+t.ushort+12,T):-1!=l.indexOf(d)&&(E[u][d]=de(e,1*E[u][d][0]+t.uchar+12,T))}if(se(r[c],E[u]),delete E[u].normal,delete E[u].tangent,"texcoord2"in E[u]){var f=new Float32Array(E[u].texcoord.length+E[u].texcoord2.length);f.set(E[u].texcoord),f.set(E[u].texcoord2,E[u].texcoord.length),E[u].texcoord=f,delete E[u].texcoord2}}}(s,l,E,d),function(e,t,r,n,a){for(var o=0;o<r.length;o++)for(var _=r[o].particle_systems,i=0;i<_.length;i++){var s=_[i];s.transforms=le(e,4*s.transforms[0]+t.float+12,s.transforms[1],n)}}(s,l,c,d),function(e,t,r,n,o){for(var _=0;_<r.length;_++){var i=r[_],s=i.fcurves,l=i.frame_range,c=l[0],E=l[1],u=a.get_approx_curve_length(c,E),d=null;u<0&&(u=0);var T=!1,f=!1;for(var p in s)T|=p.indexOf("rotation_euler")>-1,f|=p.indexOf("rotation_quaternion")>-1;var P=[];for(var p in s)if(T&&f&&p.indexOf("rotation_euler")>-1)delete s[p];else{var S=s[p];for(var A in S){var h=S[A],v=le(e,t.float+4*h.bin_data_pos[0]+12,h.bin_data_pos[1],n),m=new Float32Array(u);null===d&&(d=new Int8Array(u)),a.approximate_curve(h,v,m,d,c,E),h._pierced_points=m}p.indexOf("rotation_euler")>-1&&(a.fcurve_replace_euler_by_quat(s[p]),P.push(p))}for(var g=0;g<P.length;g++){var O=P[g];s[O.replace("euler","quaternion")]=s[O],delete s[O]}i._bflags=d}}(s,l,u,d),o(t,r)}function se(e,t){if(e.b4w_shape_keys.length){var r=t.base_length,n=t.normal.length/r/3,a=t.normal.length/3;t.tbn=YR(t.normal.subarray(0,3*r),t.tangent.subarray(0,4*r),DR(a));for(var o=1;o<n;o++)for(var _=o*r,i=0;i<r;i++){var s=t.normal.subarray(3*i,3*(i+1)),l=uh(t.normal.subarray(3*(_+i),3*(_+i+1)),s,X),c=FR(z);if(t.tangent.length){var E=t.tangent.subarray(4*i,4*(i+1)),u=Hv(t.tangent.subarray(4*(_+i),4*(_+i+1)),E,H),d=YR(s,E);QR(YR(l,u),d,c)}else xR(c,Sm(s,l,j),0);KR(t.tbn,c,_+i)}}else t.tbn=YR(t.normal,t.tangent)}function le(e,t,r,n){if(n)var a=new Float32Array(e,t,r);else{a=new Float32Array(r);for(var o=new DataView(e),_=0;_<r;_++)a[_]=o.getFloat32(t+4*_,!0)}return a}function ce(e,t,r,n){if(n)var a=new Uint32Array(e,t,r);else{a=new Uint32Array(r);for(var o=new DataView(e),_=0;_<r;_++)a[_]=o.getUint32(t+4*_,!0)}return a}function Ee(e,t,r){for(var n=new Float32Array(r),a=new DataView(e),o=0;o<r;o++)n[o]=a.getInt16(t+2*o,!0)/32767;return n}function ue(e,t,r){for(var n=new Float32Array(r),a=new DataView(e),o=0;o<r;o++)n[o]=a.getUint16(t+2*o,!0)/65535;return n}function de(e,t,r){for(var n=new Float32Array(r),a=new DataView(e),o=0;o<r;o++)n[o]=a.getUint8(t+1*o)/255;return n}function Te(e,t,n,o,_,i){!function(e){var t=e.cameras,n=e.groups,a=e.materials,o=e.meshes,_=e.node_groups,i=e.objects,s=e.particles,l=e.scenes,c=e.speakers,E=e.lamps,u=e.textures,d=e.worlds;_||(g.warn('"node_groups" datablock undefined. reexport main scene.'),_=e.node_groups=[]);for(var T=function(e){for(var t=["actions","armatures","cameras","curves","groups","images","lamps","materials","meshes","node_groups","objects","particles","scenes","sounds","speakers","textures","worlds"],r={},n=0;n<t.length;n++)for(var a=e[t[n]],o=0;o<a.length;o++){var _=a[o];r[_.uuid]=_}return r}(e),f=0;f<l.length;f++){for(var p=l[f],P=p.objects,S=0;S<P.length;S++)Ce(P,S,T);p.camera&&Ce(p,"camera",T),p.world&&Ce(p,"world",T)}for(f=0;f<n.length;f++){var A=n[f].objects;for(S=0;S<A.length;S++)Ce(A,S,T)}for(f=0;f<i.length;f++){var h=i[f];switch(h.dupli_group&&Ce(h,"dupli_group",T),h.parent&&Ce(h,"parent",T),h.dg_parent&&Ce(h,"dg_parent",T),(X=h.animation_data)&&Me(X,T),h.type){case"MESH":h.data||r.panic("mesh not found for object "+h.name),Ce(h,"data",T);var v=!1,m=h.modifiers;for(S=0;S<m.length;S++){var O=m[S];"ARMATURE"==O.type?(v&&g.warn('Object "'+h.name+'" has more than one armature modifiers. Only the first one will be used.'),v=!0,Ce(O,"object",T)):"CURVE"==O.type&&Ce(O,"object",T)}var N=h.particle_systems;if(N)for(S=0;S<N.length;S++)Ce(N[S],"settings",T);break;case"ARMATURE":Ce(h,"data",T);var R=h.pose.bones,I=h.data.bones;for(S=0;S<R.length;S++){var b,y=R[S];if(y.bone=I[y.bone],b=y.constraints)for(var L=0;L<b.length;L++)(M=b[L]).target&&Ce(M,"target",T);var Y=y.parent_recursive;for(L=0;L<Y.length;L++)Y[L]=R[Y[L]]}break;case"LAMP":case"CAMERA":case"SPEAKER":case"CURVE":Ce(h,"data",T)}if(b=h.constraints)for(S=0;S<b.length;S++){var M;(M=b[S]).target&&Ce(M,"target",T)}var x=h.lod_levels;if(x)for(S=0;S<x.length;S++){var C=x[S];C.object&&Ce(C,"object",T)}}for(f=0;f<o.length;f++){var w=o[f].materials;for(S=0;S<w.length;S++)Ce(w,S,T)}for(f=0;f<a.length;f++){var U=a[f],k=U.texture_slots;for(S=0;S<k.length;S++)Ce(k[S],"texture",T);(H=U.node_tree)&&xe(H,T)}for(f=0;f<_.length;f++)(H=_[f].node_tree)&&xe(H,T);for(f=0;f<u.length;f++){var D=u[f],F=D.type;"IMAGE"!=F&&"ENVIRONMENT_MAP"!=F||Ce(D,"image",T)}for(f=0;f<t.length;f++){var G=t[f];G.dof_object&&Ce(G,"dof_object",T)}for(f=0;f<c.length;f++){var K=c[f];K.sound&&Ce(K,"sound",T),(X=K.animation_data)&&Me(X,T)}for(f=0;f<s.length;f++){var B=s[f];for(k=B.texture_slots,S=0;S<k.length;S++)Ce(k[S],"texture",T);B.dupli_group&&Ce(B,"dupli_group",T),B.dupli_object&&Ce(B,"dupli_object",T)}for(f=0;f<E.length;f++)(X=E[f].animation_data)&&Me(X,T);for(f=0;f<d.length;f++){var X,H,j=d[f];if(k=j.texture_slots)for(S=0;S<k.length;S++)Ce(k[S],"texture",T);(X=j.animation_data)&&Me(X,T),(H=j.node_tree)&&xe(H,T)}}(e),O.check_bpy_data(e),Ne(e),function(e,t){for(var r=lt(t.filepath),n=e.textures,a=function(e,t){return t.is_primary?e.scenes[0].b4w_anisotropic_filtering:K.b4w_anisotropic_filtering}(e,t),o=0;o<n.length;o++){var _=n[o];t.is_primary||"SCENE"!=_.b4w_source_type||(_.b4w_source_id="");var i=L.create_texture_bpy(_,a,e.scenes,t.id,r);_._render=i}}(e,t),function(e){for(var t={},r=e.objects,n=0;n<r.length;n++){var a=r[n];if("MESH"===a.type&&!a.particle_systems.length)for(var o=a.data,_=o.name,i=o.submeshes,s=o.materials,l=0;l<i.length;l++)0!==i[l].base_length||t[_]||(s[l]&&g.warn('material "'+s[l].name+'" is not assigned to any face (object "'+a.name+'").'),t[_]=!0)}}(e),function(e){var t=[];e.materials=[];for(var r=e.meshes,n=0;n<r.length;n++){var a=r[n];if(0==a.materials.length){var o=kI();a.materials.push(o),-1==t.indexOf(o.uuid)&&(t.push(o.uuid),e.materials.push(o))}else for(var _=0;_<a.materials.length;_++){var i=a.materials[_],s=UI();DI(i,s),a.materials[_]=s,-1==t.indexOf(s.uuid)&&(t.push(s.uuid),e.materials.push(s))}}}(e),function(e,t){for(var r=0;r<e.length;r++){var n=e[r];n._data_id=t,a.append_action(n)}}(e.actions,t.id),function(e){for(var t={lod_parents:[],lod_levels_data:[]},r=e.scenes,n=0;n<r.length;n++)for(var a=r[n],o=r[n].objects,_=0;_<o.length;_++)Qe(a,o,o[_],null,t);for(n=0;n<t.lod_levels_data.length;n++){var i=t.lod_levels_data[n];for(_=0;_<i.old_lods.length;_++){var s=i.old_lods[_],l=i.new_lods[_],c=i.scene_arrays[_],E=i.objs_container_arrays[_];i.lod_levels[_].object=l;for(var u=0;u<E.length;u++)Zg(E[u],l);Ve(s,c)}}}(e),function(e,t){if(!t.is_primary&&e.scenes.length>1&&(e.scenes=[R.find_main_scene(e.scenes)],g.warn("loading data contains multiple scenes.","Only the first one will be loaded.")),t.is_primary)var r=K;else r=R.find_main_scene(e.scenes);if(Y.set_framerate(K.fps),e.scenes.length>1){var n=e.scenes.indexOf(K);e.scenes.splice(n,1),e.scenes.unshift(K)}for(var a=0;a<e.scenes.length;a++){var o=e.scenes[a];if(o._render=R.create_scene_render(),o._is_main=o==r,o._is_primary_thread=t.is_primary,U.enabled){if("OFF"==o.b4w_enable_physics||"AUTO"==o.b4w_enable_physics&&!pe(o))continue;(t.is_primary||!m.scene_has_physics(K)&&o==R.find_main_scene(e))&&m.init_scene_physics(o)}}}(e,t),function(e){for(var t=0;t<e.scenes.length;t++){var r=e.scenes[t];if(r.b4w_use_logic_editor){var n=Se(r,"ALL");O.assign_logic_nodes_object_params(n,r.world,r)}}}(e),function(e,t){for(var r=0;r<e.scenes.length;r++){for(var n=e.scenes[r],a=Se(n,"ALL"),o=0;o<a.length;o++)h.check_bpy_obj_scene_compatibility(i=a[o],n,e)&&(i._scenes||(i._scenes=[]),i._scenes.push(t.is_primary?n:K));Ae(a)}!function(e,t){for(var r=e.scenes,n=[],a=0;a<r.length;a++)he(r[a].objects,0,t.is_primary,n);for(F[t.id]=[],a=0;a<n.length;a++)for(var o=n[a],_=0;_<o.length;_++)for(var i=o[_],s=0;s<i.length;s++)F[t.id].push(i[s]);var l=e.particles;for(a=0;a<l.length;a++){var c=l[a].dupli_object;c&&(c._is_hair_dupli=!0,F[t.id].push(c));var E=l[a].dupli_group;if(E){var u=E.objects;for(_=0;_<u.length;_++)(c=u[_])._is_hair_dupli=!0,F[t.id].push(c)}}var d=F[t.id];for(a=d.length-1;a>=0;a--)d[a]._scenes||d.splice(a,1)}(e,t);var _=ve(t.id);for(r=0;r<_.length;r++){var i=_[r];if(!t.is_primary&&i.parent&&Z.indexOf(i.parent.type)>-1&&(i.parent=""),"MESH"==i.type){var s=O.apply_mesh_modifiers(i);s&&(e.meshes.push(s),i.data=s)}i._def_action_slots=h.get_bpy_def_action_slots(i,!1),i._is_dynamic=h.bpy_obj_is_dynamic(i)}for(r=0;r<_.length;r++){var l=(i=_[r])._is_dynamic;for(o=0;o<i.lod_levels.length;o++)(c=i.lod_levels[o].object)&&(l=l||c._is_dynamic);if(l)for(i._is_dynamic=!0,o=0;o<i.lod_levels.length;o++){var c;(c=i.lod_levels[o].object)&&(c._is_dynamic=!0)}}}(e,t),function(e,t){for(var r=0;r<e.scenes.length;r++){var n=e.scenes[r];(o=n.world)._scenes||(o._scenes=[]),o._scenes.push(t.is_primary?n:K)}var a=[];for(r=0;r<e.worlds.length;r++)(o=e.worlds[r])._scenes?(o._def_action_slots=h.get_bpy_def_action_slots(o,!0),o._is_dynamic=h.bpy_obj_is_dynamic(o)):a.push(o);for(r=0;r<a.length;r++){var o,_=e.worlds.indexOf(o=a[r]);e.worlds.splice(_,1)}}(e,t),function(e){for(var t=e.node_groups,r=e.materials,n=0;n<t.length;n++)(a=t[n].node_tree)&&(Pe(a,o=[],!0),a._bsdf_types=o);for(n=0;n<r.length;n++){var a,o;(a=r[n].node_tree)&&(Pe(a,o=[],!1),a._bsdf_types=o)}}(e),function(e,t){for(var r=0;r<e.scenes.length;r++){var n=t.is_primary?e.scenes[r]:K;Boolean(me(t.id,n,"SPEAKER").length)&&!n._sfx&&I.attach_scene_sfx(n)}}(e,t),_(t,n)}function fe(e,t,r,n,a,_){for(var i=lt(t.filepath),s=[],l=[],c=0;c<e.speakers.length;c++){var E=e.speakers[c],u=E.sound.uuid;if(-1==l.indexOf(u)){switch(l.push(u),E.b4w_behavior){case"POSITIONAL":case"BACKGROUND_SOUND":var d=o.AT_AUDIOBUFFER;break;case"BACKGROUND_MUSIC":d=o.AT_AUDIO_ELEMENT}Ke(s,u,d,vI(i+E.sound.filepath),t.is_preloading)}}s.length?o.enqueue(s,(function(){}),(function(){a(t,r)})):a(t,r)}function pe(e){for(var t=Se(e,"ALL"),r=0;r<t.length;r++){if(t[r].b4w_collision)return!0;var n=t[r].data;if(n.materials)for(var a=0;a<n.materials.length;a++)if(n.materials[a].physics_settings.use_coll_physics)return!0}return!1}function Pe(e,t,r){for(var n=e.nodes,a=0;a<n.length;a++){var o=n[a],_=o.type;if("GROUP"==_&&o.node_group){var i=o.node_group.node_tree;if(!i)continue;if(r)Pe(i,t,!0);else for(var s=i._bsdf_types,l=0;l<s.length;l++){var c=s[l];-1==t.indexOf(c)&&t.push(c)}}else-1!=ee.indexOf(_)&&-1==t.indexOf(_)&&t.push(_)}}function Se(e,t){t||(t="ALL");var r=[];return-1==e.objects.indexOf(e.camera)&&e.objects.push(e.camera),function e(t,r,n){for(var a=0;a<t.length;a++){var o=t[a];"ALL"!=r&&r!=o.type||n.push(o);var _=o.dupli_group;_&&e(_.objects,r,n)}}(e.objects,t,r),r}function Ae(e){for(var t=0;t<e.length;t++){var r=e[t];if(r._scenes&&"WORLD"!=r.type)for(var n=r.particle_systems,a=0;a<n.length;a++){var o=n[a].settings;if("HAIR"==o.type)if("OBJECT"==o.render_type)(s=o.dupli_object)._scenes||(s._scenes=r._scenes.slice());else if("GROUP"==o.render_type)for(var _=o.dupli_group,i=0;i<_.objects.length;i++){var s;(s=_.objects[i])._scenes||(s._scenes=r._scenes.slice())}}}}function he(e,t,r,n){n[t]=n[t]||[];for(var a=n[t],o=0;o<e.length;o++){var _=e[o],i=Et(_);a[i]=a[i]||[],(r||-1==Z.indexOf(_.type))&&-1==a[i].indexOf(_)&&a[i].push(_);var s=_.dupli_group;s&&he(s.objects,t+1,r,n)}}function ve(e){return F[e]}function me(e,t,r){for(var n=[],a=ve(e),o=0;o<a.length;o++){var _=a[o];if(_.type==r||"ALL"==r)for(var i=0;i<_._scenes.length;i++)t==_._scenes[i]&&n.push(_)}return n}function ge(e,t,n,o,_,i){for(var l=ve(t.id),c=0;c<l.length;c++)(f=h.create_object_from_bpy(l[c])).render.data_id=t.id;var E=e.worlds;for(c=0;c<E.length;c++)h.create_object_from_bpy(E[c],!0);var u=h.get_all_objects("ALL",t.id);for(c=0;c<l.length;c++)p.update_object(T=l[c],f=T._object);for(c=0;c<E.length;c++){var d=E[c];p.update_object(d,d._object)}for(t.is_primary&&function(e,t){for(var r=0;r<e.scenes.length;r++){for(var n=e.scenes[r],a=h.get_scene_objs(n,"LAMP",t),o=new Array(a.length),_=0;_<a.length;_++)o[_]=_;for(o.sort((function(e,t){var r=a[e].light,n=a[t].light;return!n.use_diffuse||!n.use_specular||r.use_diffuse&&r.use_specular?!r.use_diffuse&&(n.use_diffuse||!r.use_specular&&n.use_specular)?1:0:1})),_=0;_<o.length;_++)v.get_scene_data(a[o[_]],n).light_index=_}}(e,t.id),c=0;c<l.length;c++){var T,f;(f=(T=l[c])._object).is_hair_dupli||(s.prepare_object_relations(T,f),h.update_object_relations(T,f),M.update_transform(f)),"MESH"==f.type&&h.generate_mesh_render_boundings(T,f)}!function(e){for(var t=0;t<e.length;t++){var r=e[t],n=r._object,a=n.render;if(v.is_mesh(n)||v.is_empty(n)){var o=r.lod_levels.length;if(o){for(var _=[r],i=[0],s=1/0,l=0;l<o;l++){var c=r.lod_levels[l].distance;if(!(E=r.lod_levels[l].object)){s=c;break}_.push(E),i.push(c)}for(i.push(s),l=0;l<_.length;l++){var E,u=(E=_[l])._object.render;u.is_lod=!0,"DYNAMIC"==a.type&&l>0&&dh(a.bs_world.center,u.bs_world.center,u.main_lod_offset),u.lod_dist_min=i[l],u.lod_dist_max=i[l+1];var d=i[l+1]-i[l],T=l==_.length-1?1/0:i[l+2]-i[l+1];u.lod_lower_border_range=Math.min(0==l?0:i[l]-i[l-1],d),u.lod_upper_border_range=Math.min(d,T)}}}}}(l),function(e){for(var t=0;t<e.length;t++){var r=e[t];if("MESH"==r.type){var n=r.armobj;if(n){var a=n.render,o=r.render.bone_skinning_info,_=[];for(var i in o){var s=o[i];_.push(4*s.deform_bone_index,4*s.bone_index)}a.mesh_to_arm_bone_maps.push(_),a.skinned_renders.push(r.render)}}}}(u),function(e){for(var t=-1,r=-1,n=a.get_max_bones(),o=0;o<e.length;o++){var _=(s=e[o]).render;if(v.is_mesh(s)&&_.is_skinning){var i=_.max_bones;i>t&&(t=i),n>=i&&i>r&&(r=i)}}for(o=0;o<e.length;o++){var s;_=(s=e[o]).render,v.is_mesh(s)&&_.is_skinning&&(_.frames_blending=!0,t<n?_.max_bones=t:_.max_bones<=n?_.max_bones=r:(g.warn('too many bones for "'+s.name+'" / '+_.max_bones+" bones (max "+n+" with blending, "+2*n+" without blending). Blending between frames will be disabled."),_.max_bones=t,_.frames_blending=!1),_.frames_blending=_.frames_blending&&!x.frames_blending_hack)}}(u),function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.is_vehicle){var a=n.vehicle_settings;if("CHASSIS"==a.part){if(n.vehicle={},n.vehicle.force_max=a.force_max,n.vehicle.brake_max=a.brake_max,n.vehicle.suspension_compression=a.suspension_compression,n.vehicle.suspension_stiffness=a.suspension_stiffness,n.vehicle.suspension_damping=a.suspension_damping,n.vehicle.wheel_friction=a.wheel_friction,n.vehicle.roll_influence=a.roll_influence,n.vehicle.max_suspension_travel_cm=a.max_suspension_travel_cm,n.vehicle.engine_force=0,n.vehicle.brake_force=1,n.vehicle.steering=0,n.vehicle.speed=0,n.vehicle.props=[],n.vehicle.prop_offsets=[],n.vehicle.steering_wheel=null,p=v.get_dg_parent(n))var o=v.get_dg_objects(p,e);else o=e;for(var _=0;_<o.length;_++)if((S=o[_]).is_vehicle){var i=S.vehicle_settings;if(m.is_car_wheel(S)&&a.name==i.name){var s=m.wheel_index(S.vehicle_settings.part);n.vehicle.props[s]=S,n.vehicle.prop_offsets[s]=wm()}else if(m.is_vehicle_steering_wheel(S)&&a.name==i.name){n.vehicle.steering_wheel=S,n.vehicle.steering_max=i.steering_max,n.vehicle.steering_ratio=i.steering_ratio,n.vehicle.inverse_control=i.inverse_control;var l=Zm(n.render.world_tsr,wm()),c=tg(l,S.render.world_tsr,l);n.vehicle.steering_wheel_tsr=c;var E=new Float32Array([1,0,0]);_g(E,c,E),n.vehicle.steering_wheel_axis=E}else if(m.is_vehicle_speedometer(S)&&a.name==i.name){n.vehicle.speedometer=S,n.vehicle.speed_ratio=i.speed_ratio,n.vehicle.max_speed_angle=i.max_speed_angle,l=Zm(n.render.world_tsr,wm());var u=tg(l,S.render.world_tsr,l);n.vehicle.speedometer_tsr=u;var d=new Float32Array([1,0,0]);_g(d,u,d),n.vehicle.speedometer_axis=d}else if(m.is_vehicle_tachometer(S)&&a.name==i.name){n.vehicle.tachometer=S,n.vehicle.delta_tach_angle=i.delta_tach_angle,l=Zm(n.render.world_tsr,wm());var T=tg(l,S.render.world_tsr,l);n.vehicle.tachometer_tsr=T;var f=new Float32Array([1,0,0]);_g(f,T,f),n.vehicle.tachometer_axis=f}}4!=n.vehicle.props.length&&r.panic("Not enough wheels for chassis "+n.name)}else if("HULL"==a.part){var p;if(n.vehicle={},n.vehicle.props=[],n.vehicle.prop_offsets=[],n.vehicle.force_max=a.force_max,n.vehicle.brake_max=a.brake_max,n.vehicle.floating_factor=a.floating_factor,n.vehicle.water_lin_damp=a.water_lin_damp,n.vehicle.water_rot_damp=a.water_rot_damp,n.vehicle.engine_force=0,n.vehicle.brake_force=1,n.vehicle.steering=0,n.vehicle.speed=0,n.vehicle.steering_wheel=null,p=v.get_dg_parent(n))var P=v.get_dg_objects(p,e);else P=e;for(_=0;_<P.length;_++){var S;(S=P[_]).is_vehicle&&(i=S.vehicle_settings,m.is_boat_bob(S)&&a.name==i.name?(n.vehicle.props.push(S),n.vehicle.prop_offsets.push(wm())):m.is_vehicle_steering_wheel(S)&&a.name==i.name?(n.vehicle.steering_wheel=S,n.vehicle.steering_max=i.steering_max,n.vehicle.steering_ratio=i.steering_ratio,n.vehicle.inverse_control=i.inverse_control,l=Zm(n.render.world_tsr,wm()),c=tg(l,S.render.world_tsr,l),n.vehicle.steering_wheel_tsr=c,E=new Float32Array([1,0,0]),_g(E,c,E),n.vehicle.steering_wheel_axis=E):m.is_vehicle_speedometer(S)&&a.name==i.name?(n.vehicle.speedometer=S,n.vehicle.speed_ratio=i.speed_ratio,n.vehicle.max_speed_angle=i.max_speed_angle,l=Zm(n.render.world_tsr,wm()),u=tg(l,S.render.world_tsr,l),n.vehicle.speedometer_tsr=u,d=new Float32Array([1,0,0]),_g(d,u,d),n.vehicle.speedometer_axis=d):m.is_vehicle_tachometer(S)&&a.name==i.name&&(n.vehicle.tachometer=S,n.vehicle.delta_tach_angle=i.delta_tach_angle,l=Zm(n.render.world_tsr,wm()),T=tg(l,S.render.world_tsr,l),n.vehicle.tachometer_tsr=T,f=new Float32Array([1,0,0]),_g(f,T,f),n.vehicle.tachometer_axis=f))}}}}}(u),function(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.is_floating){var n=r.floating_settings;if("MAIN_BODY"==n.part){r.floater={},r.floater.floating_factor=n.floating_factor,r.floater.water_lin_damp=n.water_lin_damp,r.floater.water_rot_damp=n.water_rot_damp,r.floater.bobs=[];var a=v.get_dg_parent(r);if(a)var o=v.get_dg_objects(a,e);else o=e;for(var _=0;_<o.length;_++){var i=o[_];if(i.is_floating){var s=i.floating_settings;m.is_floater_bob(i)&&n.name==s.name&&(r.floater.bobs.push(i),i.bob_synchronize_pos=i.floating_settings.synchronize_position)}}}}}}(u),_(t,n)}function Oe(e,t,r,n,a,o){!function(e){for(var t=0;t<e.scenes.length;t++){var r=e.scenes[t];r._camera=r.camera._object}}(e);for(var i=0;i<e.scenes.length;i++){var s=t.is_primary?e.scenes[i]:K,l=h.get_scene_objs(s,"LAMP",t.is_primary?t.id:0),c=h.get_scene_objs(s,"ALL",t.id),E=me(t.id,s,"MESH"),u=me(t.id,s,"EMPTY");t.is_primary&&R.append_scene(s,c,l,E,u);for(var d=!1,T=0;T<u.length;T++)for(var f=(M=u[T]._object).scenes_data,p=0;p<f.length;p++){var P=f[p].scene,S=R.update_force_scene(P,M);s.name==P.name&&(d=d||S)}t.is_primary&&s._render.water_params&&!d&&g.warn('Scene "'+s.name+'" has water but has no wind. Using default settings.');var A=[];R.set_active(s),_.generate_main_batches(s,E,l,A);var m=h.get_scene_objs(s,"LINE",t.id);_.generate_line_batches(s,m);var O=R.get_graph(s);if(t.is_primary){var N=s._render.sky_params,I=s.world;if(N.render_sky||N.procedural_skydome){var b=I._object;_.append_sky_batch_to_world(s,N,b),_.create_forked_batches(b,O,s)}R.generate_auxiliary_batches(s,O);var L=s._render.world_light_set;L&&(L.use_environment_light||L.ngraph_proxy_id)&&_.append_cube_sky_batch_to_world(s,I._object)}if(!t.is_primary){c=h.get_scene_objs(K,"ALL",t.id),R.update_scene_graph(e.scenes[i],s,c,l,E,u),c=h.get_scene_objs(K,"ALL",h.DATA_ID_ALL);var Y=R.subs_array(s,[y.MAIN_PLANE_REFLECT,y.MAIN_PLANE_REFLECT_BLEND,y.MAIN_CUBE_REFLECT,y.MAIN_CUBE_REFLECT_BLEND]);for(T=0;T<c.length;T++)if((M=c[T]).render.data_id!=t.id)switch(M.type){case"MESH":case"LINE":case"WORLD":for(i=0;i<Y.length;i++)R.add_object_subs_reflect(Y[i],M,O,Y[i].type==y.MAIN_PLANE_REFLECT_BLEND||Y[i].type==y.MAIN_CUBE_REFLECT_BLEND,s,!0);break;case"LAMP":R.update_lamp_scene(M,s)}}for(T=0;T<E.length;T++)_.create_forked_batches(E[T]._object,O,s);for(T=0;T<A.length;T++)_.create_forked_batches(A[T],O,s),h.objects_storage_add(A[T]);for(c=h.get_scene_objs(s,"ALL",t.id),R.assign_scene_data_subs(s,c,l),T=0;T<c.length;T++){var M;(M=c[T]).render.use_shape_keys&&!M.is_boundings_overridden&&h.update_boundings(M),v.check_inv_zup_tsr_is_needed(M)&&(M.need_inv_zup_tsr=!0),h.update_lod_scene(M,s)}}R.append_scene_vtex(K,e.textures,t.id),t.is_primary&&K._render.video_textures.length&&(t.has_video_textures=!0),a(t,r)}function Ne(e){var t=e.materials;if(function(e){for(var t=0;t<e.length;t++){var r=e[t],n=Boolean("FILE"==r.source&&r.filepath.indexOf(".dds")>-1&&"dds"==C.compress_format);r._comp_method=n?"dds":""}}(e.images),(w.dds_available&&"dds"==C.compress_format||w.pvr_available&&"pvr"==C.compress_format)&&C.use_compression)for(var r=0;r<t.length;r++){for(var n=t[r],a=n.texture_slots,o=0;o<a.length;o++){var _=a[o],i=_.texture;"IMAGE"!=i.type&&"ENVIRONMENT_MAP"!=i.type||(d=i.image)&&!d._comp_method&&Ie(d,E=!i.b4w_disable_compression&&!_.use_map_normal&&"ENVIRONMENT_MAP"!=i.type&&!i.b4w_shore_dist_map&&"MOVIE"!=d.source)}var s=n.node_tree;if(s){var l=s.nodes;for(o=0;o<l.length;o++){var c=l[o],E=!1;if("TEXTURE"==c.type){var u=c.texture;u&&(d=u.image)&&!d._comp_method&&(E=!u.b4w_disable_compression&&"MOVIE"!=u.image.source&&"ENVIRONMENT_MAP"!=u.type&&!Re(c))}else if("TEX_IMAGE"==c.type){var d;(d=c.image)&&!d._comp_method&&(E="MOVIE"!=d.source)}else"TEX_ENVIRONMENT"==c.type&&(E=!1);d&&!d._comp_method&&Ie(d,E)}}}}function Re(e){for(var t=e.outputs,r=0;r<t.length;r++){var n=t[r];if(n.is_linked&&"Normal"==n.identifier)return!0}return!1}function Ie(e,t){e.filepath.indexOf(".dds")>-1?e._comp_method="dds":t?(e._comp_method=C.compress_format,e.filepath+="dds"==C.compress_format?".dds":".pvr"):e._comp_method=""}function be(e,t,r,n,a,o){for(var _=e.groups,i=e.objects,s={},l={},c={},E={},u=0;u<_.length;u++){var d=_[u];s[d.uuid]=d,c[d.uuid]=d}for(u=0;u<i.length;u++){var T=i[u];l[T.uuid]=T,E[T.uuid]=T}var f=e.scenes;for(u=0;u<f.length;u++)ye(f[u].objects,null,E,c,null);for(var p in c)p in s||_.push(c[p]);for(var p in E)p in l||i.push(E[p]);a(t,r)}function ye(e,t,r,n,a){for(var o=[],_=0;_<e.length;_++){var i=(m=r[(h=e[_]).uuid]).proxy;if(i){t&&-1==o.indexOf(i.uuid)&&o.push(i.uuid);for(var s=r[i.uuid],l=s.constraints,c=0;c<l.length;c++){var u=lO(l[c]);u.name=u.name+"_CLONE",m.constraints.push(u)}"b4w_proxy_inherit_anim"in m&&!m.b4w_proxy_inherit_anim||(m.animation_data&&(s.animation_data=lO(m.animation_data)),s.b4w_use_default_animation=m.b4w_use_default_animation,s.b4w_auto_skel_anim=m.b4w_auto_skel_anim,s.b4w_anim_behavior=m.b4w_anim_behavior,s.b4w_cyclic_animation=m.b4w_cyclic_animation)}}for(_=0;_<o.length;_++){var d=Jg(e,"uuid",o[_]);d>-1&&e.splice(d,1)}var T={};if(t)for(_=0;_<e.length;_++){var f=lO(m=r[(h=e[_]).uuid]),p="origin_name"in m?m.origin_name:m.name;f.name=v.gen_dupli_name(t.name,p),f.origin_name=p,f.dg_parent={uuid:t.uuid},Le(f),r[f.uuid]=f,T[h.uuid]=f.uuid,h.uuid=f.uuid,a&&a[m.uuid]&&(f.b4w_cluster_data=a[m.uuid])}for(_=0;_<e.length;_++)if((m=r[(h=e[_]).uuid]).dupli_group){var P=m.dupli_group,S=n[P.uuid],A=lO(S);A.name=E.unique_name(S.name+"_CLONE"),Ye(A),n[A.uuid]=A,P.uuid=A.uuid,ye(A.objects,m,r,n,m.b4w_cluster_data)}if(t)for(_=0;_<e.length;_++){var h,m;(m=r[(h=e[_]).uuid]).parent&&m.parent.uuid in T?m.parent.uuid=T[m.parent.uuid]:m.parent&&(g.warn("Object's \""+m.name+'" parent is not in dupli group. Disabling parenting.'),m.parent=null);for(l=m.constraints,c=0;c<l.length;c++)(b=l[c]).target&&b.target.uuid in T&&(b.target.uuid=T[b.target.uuid]);var O=m.pose;if(O){var N=O.bones;for(c=0;c<N.length;c++){var R=N[c].constraints;if(R)for(var I=0;I<R.length;I++){var b;(b=R[I]).target&&b.target.uuid in T&&(b.target.uuid=T[b.target.uuid])}}}var y=m.modifiers;for(c=0;c<y.length;c++){var L=y[c];L.object&&L.object.uuid in T&&(L.object.uuid=T[L.object.uuid])}var Y=m.lod_levels;if(Y&&Y.length)for(c=0;c<Y.length;c++){var M=Y[c];M.object&&M.object.uuid in T&&(M.object.uuid=T[M.object.uuid])}}for(var x in T)B[x]=T[x]}function Le(e){e.uuid=Eb("Object"+e.name)}function Ye(e){e.uuid=Eb("Group"+e.name)}function Me(e,t){if(e.action&&Ce(e,"action",t),e.nla_tracks)for(var r=0;r<e.nla_tracks.length;r++)for(var n=e.nla_tracks[r],a=0;a<n.strips.length;a++)n.strips[a].action&&Ce(n.strips[a],"action",t)}function xe(e,t){for(var r=e.nodes,n=0;n<r.length;n++){var a=r[n];"TEXTURE"==a.type&&a.texture&&Ce(a,"texture",t),"LAMP"==a.type&&a.lamp&&(a.lamp.uuid in B&&(a.lamp.uuid=B[a.lamp.uuid]),t[a.lamp.uuid]||(a.lamp=null)),"GROUP"==a.type&&a.node_group&&Ce(a,"node_group",t),"TEX_IMAGE"!=a.type&&"TEX_ENVIRONMENT"!=a.type||!a.image||Ce(a,"image",t)}var o=e.links;for(n=0;n<o.length;n++){var _=o[n];we(_,"from_node",r),we(_,"to_node",r),Ue(_,"from_socket",_.from_node.outputs),Ue(_,"to_socket",_.to_node.inputs)}var i=e.animation_data;i&&Me(i,t)}function Ce(e,t,r){if(e[t]){var n=r[e[t].uuid];n||g.error("Dangling link found:",t,e),e[t]=n}}function we(e,t,r){var n=Wg("name",e[t].name,r);e[t]=n}function Ue(e,t,r){var n=Wg("identifier",e[t].identifier,r);e[t]=n}function ke(e,t,r,n,a,_){for(var i=[],s=[],l={},c=e.images,E=L.get_img_textures(),u=lt(t.filepath),d=0;d<c.length;d++){var T=c[d],f=T.uuid;if(f){var p=vI(u+T.filepath),P=o.split_extension(p),S=P[1].toLowerCase(),A=T.source;if("FILE"===A){if(T._comp_method)var h=o.AT_ARRAYBUFFER;else h=o.AT_IMAGE_ELEMENT;if(!o.check_image_extension(S)){g.error('image "'+T.name+'" has unsupported format or broken path.');continue}w.min50_available&&C.use_min50&&(p=De(P))}else{if("MOVIE"!==A){g.error('Image "'+T.name+'" has unsupported format "'+A+'".');continue}if(C.seq_video_fallback)p=P[0]+".altconv.seq",h=o.AT_SEQ_VIDEO_ELEMENT;else{var v=I.detect_video_container(S);if(""==v){g.error("failed to load video file (unsupported format)",p);continue}p=v!=S?P[0]+".altconv."+v:P[0]+"."+P[1],h=o.AT_VIDEO_ELEMENT}}f in l||(l[f]=[]);for(var m=0;m<E.length;m++){var O=E[m];(!L.get_cache_loaded_status(O)&&O.img_comp_method==T._comp_method&&O.img_uuid==f||t.is_preloading)&&l[f].push(O)}T._comp_method&&C.assets_gzip_available&&(h=o.AT_ARRAYBUFFER_ZIP,p+=".gz"),l[f].length&&i.push({id:f,type:h,url:p,is_fetch:t.is_preloading})}}if(i.length){var N=0,b=function(n,a,c,E){if(n){if(t.is_preloading)p=c;else{for(var u=l[a],d=0;d<u.length;d++){var T=u[d];if(c==o.AT_SEQ_VIDEO_ELEMENT)T.seq_fps=n.fps,L.update_texture(T,n.images,t.id);else if(L.update_texture(T,n,t.id),"ENVIRONMENT_MAP"==T.source&&t.is_primary)for(var f=0;f<e.scenes.length;f++)R.update_world_texture(e.scenes[f]);L.set_cache_loaded_status(T,!0)}var p=u[0].img_comp_method}c==o.AT_VIDEO_ELEMENT||c==o.AT_SEQ_VIDEO_ELEMENT?function(e,t,r,n){if(n==o.AT_VIDEO_ELEMENT)var a=e.videoWidth,_=e.videoHeight;else a=e.images[0].width,_=e.images[0].height;g.log("%cLOAD VIDEO "+a+"x"+_,"color: #"+(a>2048||_>2048?"a00":a>1024||_>1024?"aa0":"0a0"),t),-1==t.indexOf(G)&&g.warn("video",t,"is not from app root.")}(n,E,0,c):ne(n,E,!0,p)}else{var P=function(e,t,r,n){var a,_=t.split("?v")[0],i=o.split_extension(_);if("gz"==i[1])var s=i[0],l=o.AT_ARRAYBUFFER;else if("dds"==i[1]||"pvr"==i[1])s=i[0],l=o.AT_IMAGE_ELEMENT,function(e){for(var t=0;t<e.length;t++)e[t].img_comp_method=""}(n[e]);else{if(-1==_.indexOf(".min50"))return null;s=(a=_.split(".min50"))[0]+a[1],l=o.AT_IMAGE_ELEMENT}return{id:e,type:l,url:s,is_fetch:r}}(a,E,t.is_preloading,l);P&&(g.warn("Trying to load fallback image",P.url),s.push(P))}var S=++N/(i.length+s.length);_(t,r,S)};o.enqueue(i,b,(function e(){s.length?(o.enqueue(s,b,e),s.length=0):(g.log("%cLOADED ALL IMAGES","color: #0a0"),a(t,r))}))}else a(t,r)}function De(e){if("dds"==e[1]){var t=o.split_extension(e[0]);return t[0]+".min50."+t[1]+".dds"}return e[0]+".min50."+e[1]}function Fe(e,t,r,n,a,o){for(var _=R.get_rendered_scenes(),i=0;i<_.length;i++){var s=_[i];if(s.b4w_use_nla){var l=s.b4w_nla_cyclic;s.b4w_use_logic_editor&&(l=!1),p.update_scene(s,l,t.id)}}a(t,r)}function Ge(e,t,r,n,a,_){for(var i=lt(t.filepath),s=[],l={},c=h.get_all_objects("ALL",t.id),E=0;E<c.length;E++){var u=c[E];if(Be(u)){var d=u.sfx.uuid;if("BACKGROUND_MUSIC"==I.get_spk_behavior(u)?(d=HO(),t.has_background_music=!0):"NONE"!=I.get_spk_behavior(u)&&C.init_wa_context_hack&&(t.init_wa_context=!0),!(d in l)){l[d]=[];var T=vI(i+u.sfx.filepath);switch(I.source_type(u)){case I.AST_ARRAY_BUFFER:var f=o.AT_AUDIOBUFFER;break;case I.AST_HTML_ELEMENT:f=o.AT_AUDIO_ELEMENT}Ke(s,d,f,T,t.is_preloading)}l[d].push(u)}}if(s.length){var p=0;o.enqueue(s,(function(e,n,a,o){if(e){g.log("%cLOAD SOUND","color: #0aa",o),-1==o.indexOf(G)&&g.warn("sound",o,"is not from app root.");for(var i=l[n],c=0;c<i.length;c++)I.update_spkobj(i[c],e)}var E=++p/s.length;_(t,r,E)}),(function(){g.log("%cLOADED ALL SOUNDS","color: #0aa"),a(t,r)}))}else a(t,r)}function Ke(e,t,r,n,a){var _=o.split_extension(n),i=_[1].toLowerCase(),s=I.detect_audio_container(i);""!=s?e.push({id:t,type:r,url:n=s!=i?_[0]+".altconv."+s:_[0]+"."+_[1],is_fetch:a}):g.error("failed to load audio file (unsupported format)",n)}function Be(e){return v.is_speaker(e)&&I.source_type(e)!=I.AST_NONE}function Xe(e,t,r){for(var n=h.get_scene_objs(e,"SPEAKER",t),a=0;a<n.length;a++){var o=n[a];v.is_speaker(o)&&(I.is_autoplay(o)||r)&&I.play_def(o)}}function He(e,t){for(var r=e._render.video_textures,n=0;n<r.length;n++){var a=r[n]._render;e.b4w_use_nla&&r[n].b4w_nla_video||!r[n].use_auto_refresh||t==a.vtex_data_id&&(L.reset_video(a),L.play_video(a))}}function je(e,t,r,n,a,o){p.prepare(),a(t,r)}function ze(e,t,r,n,a,o){p.start(),g.log("%cSTART NLA","color: #0a0"),a(t,r)}function Qe(e,t,r,n,a){for(var o=r.lod_levels.length,_=0;_<o;_++){var i=r.lod_levels[_],s=i.object;if(s){var l=a.lod_parents.indexOf(r);if(-1==l)a.lod_parents.push(r),a.lod_levels_data.push(c={old_lods:[],new_lods:[],lod_levels:[],scene_arrays:[],objs_container_arrays:[]});else var c=a.lod_levels_data[l];var E=c.old_lods.indexOf(s);if(-1!=l&&-1!=E)c.scene_arrays[E].push(e),c.objs_container_arrays[E].push(t);else{var u=cO(s);u.name=r.name+"_LOD_"+String(_+1),u.b4w_cluster_data=r.b4w_cluster_data,Le(u),u.lod_levels=[],n&&(u.dg_parent=n),c.old_lods.push(s),c.new_lods.push(u),c.lod_levels.push(i),c.scene_arrays.push([e]),c.objs_container_arrays.push([t])}}}var d=r.dupli_group;if(d)for(var T=d.objects,f=0;f<T.length;f++)Qe(e,T,T[f],r,a)}function Ve(e,t){for(var r=0;r<t.length;r++){for(var n=t[r].objects,a=0;a<n.length;a++){var o=n[a].dupli_group;o&&qe(e,o)}var _=n.indexOf(e);_>-1&&n.splice(_,1)}}function qe(e,t){var r=t.objects,n=r.indexOf(e);n>-1&&r.splice(n,1);for(var a=0;a<r.length;a++)(t=r[a].dupli_group)&&qe(e,t)}function We(e,t,r,n,a,o){for(var _=!0,i=0;i<e.scenes.length;i++)if(!m.check_worker_loaded(e.scenes[i])){_=!1;break}_&&(a(t,r),g.log("%cPHYSICS READY","color: #0a0"))}function Je(e,t,r,n,a,o){for(var _=0;_<e.scenes.length;_++){var i=e.scenes[_];if(t.is_primary)var s=m.scene_has_physics(i);else s=m.scene_has_physics(K)||m.scene_has_physics(i),i=K;if(U.enabled&&s)for(var l=0;l<$.length;l++)for(var c=h.get_scene_objs(i,$[l],t.id),E=0;E<c.length;E++){var u=c[E];u.render.data_id==t.id&&(m.append_object(u,i),t.load_hidden&&m.obj_has_physics(u)&&m.disable_simulation(u))}}a(t,r)}function Ze(e,t,r,n,a,_){for(var i={},s=[],l=e.scenes,c=0;c<e.scenes.length;c++){var E=l[c];if(E._render.water_params){var u=E._render.water_params.shoremap_image;if(u&&"FILE"===u.source){var d=u.uuid,T=vI(lt(t.filepath)+u.filepath);if(u._comp_method)var f=o.AT_ARRAYBUFFER;else f=o.AT_IMAGE_ELEMENT;s.push({id:d,type:f,url:T}),i[d]=u}}}s.length?o.enqueue(s,(function(e,r,n,a){if(e){ne(e,a,!0);var o=function(e){for(var t=[],r=L.get_img_textures(),n=0;n<r.length;n++){var a=r[n];a.uri===e&&t.push(a)}return t}(r);for(s=0;s<o.length;s++)L.update_texture(o[s],e,t.id);for(s=0;s<l.length;s++)(c=l[s])._render.water_params&&(E=c._render.water_params.shoremap_image)===u&&$e(e,u,c)}else for(var _=i[r],s=0;s<l.length;s++){var c,E;(E=(c=l[s])._render.water_params.shoremap_image)===_&&(c._render.water_params.shoremap_image=null,g.warn("image",E.filepath," was not found. Disabling water shore effects."))}}),(function(){a(t,r)})):a(t,r)}function $e(e,t,r){var n=document.createElement("canvas"),a=t.size[0],o=t.size[1];n.width=a,n.height=o;var _=n.getContext("2d");_.drawImage(e,0,0);var i=_.getImageData(0,0,a,o).data,s=new Float32Array(4);s[0]=1/16581375,s[1]=1/65025,s[2]=1/255,s[3]=1;for(var l=a*o,c=new Float32Array(l),E=0;E<l;E++)c[E]=s[1]*i[4*E+2]+s[2]*i[4*E+3];r._render.shore_distances=c}function et(e,t,r,n,a,_){for(var s=e.scenes[0],l=[],c=[y.SMAA_EDGE_DETECTION,y.SMAA_BLENDING_WEIGHT_CALCULATION,y.SMAA_NEIGHBORHOOD_BLENDING,y.SMAA_RESOLVE],E=0;E<c.length;E++){var u=R.get_subs(s,c[E]);u&&l.push(u)}if(l.length){var d=[],T=o.AT_IMAGE_ELEMENT;for(d.push({id:"SEARCH_TEXTURE",type:T,url:i.paths.smaa_search_texture_path,is_fetch:t.is_preloading}),d.push({id:"AREA_TEXTURE",type:T,url:i.paths.smaa_area_texture_path,is_fetch:t.is_preloading}),E=0;E<l.length;E++){var f=l[E];if(f.type==y.SMAA_BLENDING_WEIGHT_CALCULATION){for(var p=f.slinks_internal,P=0;P<p.length;P++){var S=p[P];if("u_search_tex"==S.to)var A=S.texture;else if("u_area_tex"==S.to)var h=S.texture}break}}d.length?o.enqueue(d,(function(e,r,n,a){if(e){if(ne(e,a,!1),"SEARCH_TEXTURE"==r)var o=A;else o=h;o.source="IMAGE",L.update_texture(o,e,t.id),L.set_filters(o,L.TF_LINEAR,L.TF_LINEAR)}}),(function(){a(t,r)})):a(t,r)}else a(t,r)}function tt(e,t,r,n,a,o){for(var _=0;_<e.scenes.length;_++){var i=e.scenes[_];t.is_primary||(i=K);for(var s=h.get_scene_objs(i,"LAMP",t.id),l=0;l<s.length;l++){var c=s[l];c.render.data_id==t.id&&n.added_objects.push({scene:i,obj:c})}var E=h.get_scene_objs(i,"ALL",t.id);for(l=0;l<E.length;l++){var u=E[l];"LAMP"!=u.type&&u.render.data_id==t.id&&(t.load_hidden&&v.is_mesh(u)&&R.change_visibility(u,!0),n.added_objects.push({scene:i,obj:u}))}}}t.is_primary_loaded=function(e){return f.is_primary_loaded(e)},t.update=function(){f.update_scheduler(D)};var rt=function(){var e=dm(),t=ih();return function(r,a,o,_,i,s){var l=_.added_objects,c=_.obj_counter;if(l.length){var E=l[c].obj,u=l[c].scene,d=v.get_scene_data(E,u);R.append_object(u,E),!E.anchor||u._render.anaglyph_use||u._render.sidebyside_use||n.append(E);var T=++_.obj_counter/l.length;E.render.hide_children&&R.change_visibility_rec(E,!0);var f=d.cube_refl_subs;if(-1!=E.render.cube_reflection_id&&f){var p=ch(E.render.bs_world.center,t);R.update_cube_reflect_subs(f,p)}var P=E.reflective_objs;if(P.length&&u._render.reflection_params)for(var S=jm(E.render.world_tsr,t),A=Vm(E.render.world_tsr,e),h=d.plane_refl_subs,m=0;m<h.length;m++)R.update_plane_reflect_subs(h[m],S,A),v.update_refl_objects(P,h[m].camera.reflection_plane)}else T=1;s(a,o,T)}}();function nt(e,t,r,n,a,o){if(t.is_primary){var _=R.get_main();R.update_world_texture(_);for(var i=R.get_rendered_scenes(),s=0;s<i.length;s++){var l=i[s];R.update_world_texture(l),R.prepare_rendering(l,_)}R.set_active(_)}else R.update_scene_permanent_uniforms(K);var c=h.get_all_objects("ALL",t.id);h.update_objects_dynamics(c),a(t,r)}function at(e,t,r,n,a,o){if(t.is_primary)for(var _=R.get_rendered_scenes(),i=0;i<_.length;i++)for(var s=_[i],l=h.get_scene_objs(s,"WORLD",0),c=0;c<l.length;c++)R.init_cube_sky_dim(s,l[c]),R.update_world_texture(s);a(t,r)}function ot(e,t,r,n,a,o){if(t.is_primary)for(var _=R.get_rendered_scenes(),i=0;i<_.length;i++){var s=_[i];s.b4w_use_logic_editor&&P.init_logic(s,t.id)}a(t,r)}function _t(e,t,r,n,a,o){if(t.is_primary)for(var _=0;_<e.scenes.length;_++)He(e.scenes[_],t.id),Xe(e.scenes[_],t.id,!1);else He(K,t.id),Xe(K,t.id,!1);a(t,r)}function it(e,t,r,n,a,o){!function(e,t){for(var r=0;r<e.scenes.length;r++)e.scenes[r].camera=null}(e),C.media_auto_activation&&(t.has_video_textures||t.has_background_music||t.init_wa_context)?Q||function(e,t,r,n){var a=te.parentElement;q=a.style.zIndex,a.style.zIndex="999",(Q=document.createElement("div")).style.position="relative",Q.style.height="88px",Q.style.width="88px";var o=Math.round(te.offsetHeight/2-44),_=Math.round(te.offsetWidth/2-44);Q.style.top=o.toString()+"px",Q.style.left=_.toString()+"px",Q.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')",Q.style.backgroundSize="88px",(V=document.createElement("div")).style.position="relative",V.style.height=te.offsetHeight.toString()+"px",V.style.width=te.offsetWidth.toString()+"px",V.style.background="rgba(0, 0, 0, 0.5)",V.style.zIndex="999",a.appendChild(V),V.appendChild(Q),T.add_click_listener(Q,J=function(){if(r.has_video_textures&&(L.play(),L.pause(),L.reset()),r.has_background_music){if(r.is_primary)for(var a=0;a<e.scenes.length;a++)Xe(e.scenes[a],r.id,!0);else Xe(K,r.id,!0);I.pause()}r.init_wa_context&&I.play_empty_sound(),st(),t(r,n)})}(e,a,t,r):a(t,r)}function st(){if(Q){var e=te.parentElement;e.style.zIndex=q,T.remove_click_listener(Q,J),V.removeChild(Q),e.removeChild(V),V=null,Q=null,q=0}}function lt(e){var t=e.split("/").slice(0,-1).join("/");return t&&(t+="/"),t}function ct(e){a.is_animated(e)&&a.remove(e),S.remove_obj_from_cache(e),h.clear_outline_anim(e),l.check_sensor_manifold(e)&&l.remove_sensor_manifold(e),m.obj_has_physics(e)&&m.remove_object(e),h.unload_plane_reflections(e),h.unload_cube_reflections(e),R.remove_object_bundles(e),v.is_speaker(e)&&I.speaker_remove(e),n.is_anchor(e)&&n.remove(e)}function Et(e){var t=function(e){var t=a.get_bpy_armobj(e);return t&&t.parent==e?null:e.parent||t}(e);return t?1+Et(t):0}t.setup_canvas=function(e){te=e},t.update_media_controls=function(e,t){if(Q){V.style.height=t.toString()+"px",V.style.width=e.toString()+"px";var r=Math.round(t/2-44),n=Math.round(e/2-44);Q.style.top=r.toString()+"px",Q.style.left=n.toString()+"px"}},t.load=function(e,t,r,n,a){var o={load_main:{priority:f.ASYNC_PRIORITY,background_loading:!1,inputs:[],is_resource:!1,relative_size:500,primary_only:!1,cb_before:ae},duplicate_objects:{priority:f.SYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:be},load_binaries:{priority:f.ASYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:oe},wait_for_shaders:{priority:f.SYNC_PRIORITY,background_loading:!1,inputs:[],is_resource:!1,relative_size:50,primary_only:!0,cb_loop:_e},prepare_bindata:{priority:f.SYNC_PRIORITY,background_loading:!1,inputs:["duplicate_objects","load_binaries"],is_resource:!1,relative_size:100,primary_only:!1,cb_before:ie},prepare_bpy_data:{priority:f.SYNC_PRIORITY,background_loading:!1,inputs:["duplicate_objects","prepare_bindata"],is_resource:!1,relative_size:100,primary_only:!1,cb_before:Te},process_objects:{priority:f.SYNC_PRIORITY,background_loading:!1,inputs:["prepare_bpy_data"],is_resource:!1,relative_size:150,primary_only:!1,cb_before:ge},process_scenes:{priority:f.SYNC_PRIORITY,background_loading:!1,inputs:["process_objects","wait_for_shaders"],is_resource:!1,relative_size:300,primary_only:!1,cb_before:Oe},load_smaa_textures:{priority:f.ASYNC_PRIORITY,background_loading:!1,inputs:["process_scenes"],is_resource:!1,relative_size:30,primary_only:!0,cb_before:et},load_shoremap:{priority:f.ASYNC_PRIORITY,background_loading:!1,inputs:["process_scenes"],is_resource:!1,relative_size:30,primary_only:!0,cb_before:Ze},load_images:{priority:f.ASYNC_PRIORITY,background_loading:!0,inputs:["process_scenes"],is_resource:!0,relative_size:500,primary_only:!1,cb_before:ke},update_scenes_nla:{priority:f.SYNC_PRIORITY,background_loading:!1,inputs:["process_scenes","load_images"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:Fe},wait_physics_workers:{priority:f.SYNC_PRIORITY,background_loading:!1,inputs:["load_shoremap"],is_resource:!1,relative_size:20,primary_only:!1,cb_loop:We},add_physics_objects:{priority:f.SYNC_PRIORITY,background_loading:!1,inputs:["wait_physics_workers"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:Je},add_objects:{priority:f.SYNC_PRIORITY,background_loading:!1,inputs:["add_physics_objects"],is_resource:!1,relative_size:600,primary_only:!1,cb_before:tt,cb_loop:rt,cb_after:nt,cb_param:{added_objects:[],obj_counter:0}},init_cube_sky_dynamic_props:{priority:f.SYNC_PRIORITY,background_loading:!1,inputs:["add_objects","load_images"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:at},init_logic_nodes:{priority:f.SYNC_PRIORITY,background_loading:!1,inputs:["update_scenes_nla","add_objects"],is_resource:!1,relative_size:50,primary_only:!1,cb_before:ot},load_speakers:{priority:f.ASYNC_PRIORITY,background_loading:!0,inputs:["add_objects"],is_resource:!0,relative_size:100,primary_only:!1,cb_before:Ge},mobile_media_start:{priority:f.SYNC_PRIORITY,background_loading:!1,inputs:["load_images","update_scenes_nla","load_speakers","init_logic_nodes"],is_resource:!0,relative_size:5,primary_only:!1,cb_before:it,cb_loop:it},synchronize_media:{priority:f.SYNC_PRIORITY,background_loading:!0,inputs:["mobile_media_start"],is_resource:!0,relative_size:50,primary_only:!1,cb_before:_t},prepare_nla:{priority:f.SYNC_PRIORITY,background_loading:!1,inputs:["mobile_media_start"],is_resource:!1,relative_size:5,primary_only:!0,cb_before:je},start_nla:{priority:f.SYNC_PRIORITY,background_loading:!0,inputs:["prepare_nla"],is_resource:!1,relative_size:5,primary_only:!0,cb_before:ze}},_=f.get_scheduler();return _||(_=f.create_scheduler(),D={},F={},B={}),D[_.threads.length]={},f.create_thread(o,e,t,r,re,n||k.audio_loading_hack,C.do_not_load_resources,a,!1)},t.unload=function(e){var t=f.get_scheduler();if(t&&t.threads.length&&(!e||f.thread_is_finished(t.threads[e]))){if(0==e)g.log("%cUNLOAD ALL","color: #00a"),n.cleanup(),a.cleanup(),I.cleanup(),_.cleanup(),R.cleanup(),f.cleanup(),l.cleanup(),m.cleanup(),h.cleanup(),E.cleanup(),N.cleanup(),A.cleanup(),b.cleanup(),d.cleanup(),o.cleanup(),L.cleanup(),P.cleanup(),S.cleanup(),T.cleanup(),u.cleanup(),F=null,B={},K=null,D=null,W=!1;else{g.log("%cUNLOAD DATA "+e,"color: #00a"),a.remove_actions(e);for(var r=h.get_all_objects("ALL",h.DATA_ID_ALL),i=0;i<r.length;i++)v.get_object_data_id(s=r[i])!=e&&h.obj_switch_cleanup_flags(s,!1,!1,!1);for(i=(r=h.get_all_objects("ALL",e)).length-1;i>=0;i--){var s;ct(s=r[i]),h.remove_object(s)}for(r=h.get_all_objects("ALL",h.DATA_ID_ALL),i=0;i<r.length;i++)h.obj_switch_cleanup_flags(r[i],!0,!0,!0)}p.cleanup(e),st()}else g.error("Unable to unload data!")},t.prepare_object_unloading=ct,t.set_debug_resources_root=function(e){G=e},t.activate_media=function(){W||C.media_auto_activation||(L.play(),L.pause(),L.reset(),Xe(K,h.DATA_ID_ALL,!0),I.pause(),C.init_wa_context_hack&&I.play_empty_sound(),W=!0)},t.reset=function(){te=null},t.prefetch=function(e,t,r){var n={load_main:{priority:f.ASYNC_PRIORITY,background_loading:!1,inputs:[],is_resource:!1,relative_size:500,primary_only:!1,cb_before:ae},load_binaries:{priority:f.ASYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:oe},load_images:{priority:f.ASYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:ke},preload_sounds:{priority:f.ASYNC_PRIORITY,background_loading:!1,inputs:["load_main"],is_resource:!1,relative_size:500,primary_only:!1,cb_before:fe}},a=f.get_scheduler();return a||(a=f.create_scheduler(),D={},F={},B={}),D[a.threads.length]={},f.create_thread(n,e,t,r,re,!1,C.do_not_load_resources,!1,!0)},t.unfetch=function(){o.clear_cache()}})),fb=nA("__container",(function(e,t){var r=gN(e),n=dR(e),a=Tb(e),o=OI(e),_=mN(e),i=LI(e),s=mR(e),l=MI(e),c=n.defaults,E=n.context_limits,u=null,d=null,T=null,f=null,p={clientX:0,clientY:0},P={width:0,height:0,scale:1,offset_top:0,offset_left:0};function S(){return d}function A(){return T}function h(){return f}function v(e,t){P.offset_left=e,P.offset_top=t}function m(){var e=d.getBoundingClientRect();v(e.left,e.top)}function g(e,t,r,n){if(c.ie11_edge_mouseoffset_hack){var a=r.getBoundingClientRect();n[0]=e-a.left,n[1]=t-a.top}else{p.clientX=e,p.clientY=t,p.view=window;var o=new MouseEvent("b4w_convert",p);r.dispatchEvent(o),n[0]=o.offsetX,n[1]=o.offsetY}return n}function O(e,t,r,n){e.style.width=r+"px",e.style.height=n+"px",t&&(t.style.width=r+"px",t.style.height=n+"px")}function N(e,t,r){var n=S(),s=A();r&&O(n,s,e,t),s&&(s.width=e,s.height=t,o.update_dim());var d=Math.floor(e*c.canvas_resolution_factor),T=Math.floor(t*c.canvas_resolution_factor);n.width=d,n.height=T;var f=Math.min(u.drawingBufferWidth,E.max_renderbuffer_size,E.max_viewport_dims[0]),p=Math.min(u.drawingBufferHeight,E.max_renderbuffer_size,E.max_viewport_dims[1]);if(d>f||T>p){_.warn("Canvas size exceeds platform limits, downscaling");var P=Math.min(f/d,f/T);d*=P,T*=P}if(e)var h=d/e;else h=1;n.width=Math.floor(d),n.height=Math.floor(T),i.setup_dim(n.width,n.height,h),i.check_active()&&l.update_transform(i.get_active()._camera),a.update_media_controls(n.width,n.height)}t.setup_context=function(e){u=e},t.get_canvas=S,t.get_canvas_hud=A,t.get_container=h,t.init=function(e,t){e&&e.parentNode?(d=e,T=t,f=e.parentNode):r.panic("canvas container is not available")},t.insert_to_container=function(e,t){switch(t=t||"LAST"){case"FIRST":f.insertBefore(e,f.firstElementChild);break;case"JUST_BEFORE_CANVAS":f.insertBefore(e,d);break;case"JUST_AFTER_CANVAS":d.nextElementSibling?f.insertBefore(e,d.nextElementSibling):f.appendChild(e,d);break;case"LAST":f.appendChild(e,d);break;default:_.error(t+" invalid stack order")}},t.get_viewport_width=function(){return P.width},t.get_viewport_height=function(){return P.height},t.set_canvas_offsets=v,t.update_canvas_offsets=m,t.setup_viewport_dim=function(e,t,r){P.width=e,P.height=t,P.scale=r,m()},t.force_offsets_updating=function(){},t.client_to_canvas_coords=function(e,t,r){return g(e,t,d,r)},t.get_coords_target_space=function(e,t,r){if(e.constructor==MouseEvent)r[0]=e.offsetX,r[1]=e.offsetY;else if(e.constructor==TouchEvent){if("touchend"==e.type)var n=e.changedTouches;else n=t?e.targetTouches:e.touches;g(n[0].clientX,n[0].clientY,e.target,r)}else r[0]=-1,r[1]=-1;return r},t.client_to_element_coords=g,t.canvas_to_viewport_coords=function(e,t,r,n){if(r||(r=new Float32Array(2)),r[0]=e*P.scale,r[1]=t*P.scale,n){var a=n.width/P.width;r[0]*=a,r[1]*=a}return r},t.viewport_to_canvas_coords=function(e,t,r,n){if(r||(r=new Float32Array(2)),r[0]=e/P.scale,r[1]=t/P.scale,n){var a=n.width/P.width;r[0]/=a,r[1]/=a}return r},t.is_child=function(e){return!(!e||!e.parentNode)&&(e.parentNode==f||t.is_child(e.parentNode))},t.is_hidpi=function(){return!!(c.allow_hidpi&&window.devicePixelRatio>=2)},t.resize=N,t.resize_to_container=function(e){var t=h(),r=S(),n=t.clientWidth,a=t.clientHeight;if(e||n!=r.clientWidth||a!=r.clientHeight){var o=r.width,_=r.height;if(O(S(),A(),n,a),i.check_active()){var l=i.get_active(),c=i.get_subs(l,s.STEREO);if(c&&c.enable_hmd_stereo)return void N(o,_,!1)}N(n,a,!1)}},t.reset=function(){u=null,d=null,T=null,f=null}})),pb=nA("__camera",(function(e,t){var r=gN(e),n=fb(e),a=PI(e),o=mN(e),_=LI(e),i=mR(e),s=MI(e);t.TYPE_NONE=10,t.TYPE_PERSP=20,t.TYPE_ORTHO=30,t.TYPE_PERSP_ASPECT=40,t.TYPE_ORTHO_ASPECT=50,t.TYPE_ORTHO_ASYMMETRIC=60,t.TYPE_STEREO_LEFT=70,t.TYPE_STEREO_RIGHT=80,t.TYPE_HMD_LEFT=90,t.TYPE_HMD_RIGHT=100,t.MS_STATIC=0,t.MS_TARGET_CONTROLS=2,t.MS_EYE_CONTROLS=3,t.MS_HOVER_CONTROLS=4;var l=NO(40),c=NO(.5),E=new Float32Array([1,1,1,1]),u=new Float32Array([-1,-1,1,1]),d=new Float32Array([0,0,-1,1]),T=new Float32Array(2),f=new Float32Array(2),p=new Float32Array(2),P=new Float32Array(3),S=new Float32Array(3),A=new Float32Array(3),h=new Float32Array(3),v=new Float32Array(3),m=new Float32Array(3),g=(dm(),new Float32Array(4)),O=(new Float32Array(4),new Float32Array(4)),N=new Float32Array(4),R=new Float32Array(16),I=new Float32Array(24);function b(e,t,r,n,a){s.set_translation(e,t),r&&V(e,t,r),W(e,n),J(e,a)}function y(e,t,r,n,a,o,_,i){var l=e.render;s.set_translation(e,t),l.pivot.set(r),V(e,t,r),W(e,n),J(e,a),te(e,o),re(e,_),l.use_panning=i}function L(e,t,r,n,a,o,_,i){var l=e.render;s.set_translation(e,t),l.hover_pivot.set(r),V(e,t,r),ee(e,n),Z(e,a),ne(e,o),ae(e,_),l.enable_hover_hor_rotation=i}new Float32Array(6),t.camera_object_to_camera=function(){var e=ih(),r=ih();return function(n,a){var _=a.render,i=n.data;switch(i.type){case"PERSP":(s=D(t.TYPE_PERSP)).fit=i.sensor_fit,B(s,i.angle,i.clip_start,i.clip_end);break;case"ORTHO":var s;(s=D(t.TYPE_ORTHO)).fit=i.sensor_fit,B(s,i.ortho_scale/2,i.clip_start,i.clip_end)}s.name=a.name;var l=a.scenes_data;l[0].cameras.push(s);for(var c=1;c<l.length;c++){var E=w(s,!1);l[c].cameras.push(E)}_.move_style=k(i.b4w_move_style),_.dof_distance=i.dof_distance;var u=i.dof_object;_.dof_object=u?u._object:null,_.dof_front_start=i.b4w_dof_front_start,_.dof_front_end=i.b4w_dof_front_end,_.dof_rear_start=i.b4w_dof_rear_start,_.dof_rear_end=i.b4w_dof_rear_end,_.dof_power=i.b4w_dof_power,_.dof_bokeh=i.b4w_dof_bokeh,_.dof_bokeh_intensity=i.b4w_dof_bokeh_intensity,_.dof_foreground_blur=i.b4w_dof_foreground_blur,_.velocity_trans=i.b4w_trans_velocity,_.velocity_rot=i.b4w_rot_velocity,_.velocity_zoom=i.b4w_zoom_velocity;var d=function(e,r){var n=r.render.move_style,a=e.data,o=null;return n!=t.MS_TARGET_CONTROLS&&n!=t.MS_EYE_CONTROLS||!a.b4w_use_horizontal_clamping||(o={left:a.b4w_rotation_left_limit,right:a.b4w_rotation_right_limit,camera_space:"LOCAL"==a.b4w_horizontal_clamping_type},n==t.MS_EYE_CONTROLS&&(o.left*=-1,o.right*=-1)),o}(n,a),T=function(e,r){var n=r.render.move_style,a=e.data,_=null;return n!=t.MS_TARGET_CONTROLS&&n!=t.MS_EYE_CONTROLS||!a.b4w_use_vertical_clamping?n==t.MS_HOVER_CONTROLS&&a.b4w_use_zooming&&(a.b4w_hover_angle_min<=a.b4w_hover_angle_max?((_={down:a.b4w_hover_angle_min,up:a.b4w_hover_angle_max}).down*=-1,_.up*=-1):o.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(_={down:a.b4w_rotation_down_limit,up:a.b4w_rotation_up_limit,camera_space:"LOCAL"==a.b4w_vertical_clamping_type},n==t.MS_TARGET_CONTROLS&&(_.down*=-1,_.up*=-1)),_}(n,a),f=function(e,r){var n=r.render.move_style,a=e.data,_=null;return n==t.MS_TARGET_CONTROLS&&a.b4w_use_target_distance_limits&&a.b4w_distance_min<=a.b4w_distance_max?_={min:a.b4w_distance_min,max:a.b4w_distance_max}:n===t.MS_HOVER_CONTROLS&&a.b4w_use_zooming&&(a.b4w_distance_min<=a.b4w_distance_max?_={min:a.b4w_distance_min,max:a.b4w_distance_max}:o.error("Wrong distance limits for the HOVER camera. Disabling distance limits.")),_}(n,a),p=function(e,r){var n=e.data,a=null;return r.render.move_style==t.MS_HOVER_CONTROLS&&n.b4w_use_horizontal_clamping&&n.b4w_horizontal_translation_min<=n.b4w_horizontal_translation_max&&(a={min:n.b4w_horizontal_translation_min,max:n.b4w_horizontal_translation_max}),a}(n,a),P=function(e,r){var n=e.data,a=null;return r.render.move_style==t.MS_HOVER_CONTROLS&&n.b4w_use_vertical_clamping&&n.b4w_vertical_translation_min<=n.b4w_vertical_translation_max&&(a={min:n.b4w_vertical_translation_min,max:n.b4w_vertical_translation_max}),a}(n,a),S=function(e,r){var n=e.data,a=null;return r.render.move_style==t.MS_TARGET_CONTROLS&&n.b4w_use_pivot_limits&&(a={min_z:n.b4w_pivot_z_min,max_z:n.b4w_pivot_z_max}),a}(n,a);switch(_.move_style){case t.MS_STATIC:break;case t.MS_EYE_CONTROLS:b(a,jm(a.render.world_tsr,e),null,d,T);break;case t.MS_TARGET_CONTROLS:y(a,jm(a.render.world_tsr,e),i.b4w_target,d,T,f,S,i.b4w_use_panning);break;case t.MS_HOVER_CONTROLS:L(a,jm(a.render.world_tsr,e),M(a,n.data.b4w_hover_zero_level,r),f,T,p,P,i.b4w_enable_hover_hor_rotation)}ie(a),x(a)}}(),t.setup_eye_model=b,t.setup_target_model=y,t.setup_hover_model=L;var Y=function(){var e=dm();return function(t,r){return G(Vm(t.render.world_tsr,e),t.render.vertical_axis,r)}}();t.get_camera_angles=Y;var M=function(){var e=new Float32Array(6),t=dm(),r=new Float32Array(2),n=ih(),a=ih(),_=Fv();return function(i,s,l){var E=i.render,u=jm(E.world_tsr,n),d=Vm(E.world_tsr,t),T=_;T.set(Ug),T[3]=0;var f=Y(i,r)[1],p=_O(d,Fg,a);return Wh(e,u),Jh(e,p),(!eN(T,-s,e,l)||Math.abs(f)<c)&&(o.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),l[0]=u[0],l[1]=u[1],l[2]=0),l}}(),x=function(){var e=ih();return function(r){for(var n=r.render,a=0;a<r.scenes_data.length;a++){var o=r.scenes_data[a].cameras[0];if(o.type==t.TYPE_ORTHO)switch(n.move_style){case t.MS_TARGET_CONTROLS:var _=jm(n.world_tsr,e);n.init_dist=hh(_,n.pivot),n.init_fov=o.fov;break;case t.MS_HOVER_CONTROLS:_=jm(n.world_tsr,e),n.init_dist=hh(_,n.hover_pivot),n.init_fov=o.fov}}}}();function C(e){var t={type:e,name:"",size_mult:1,width:0,height:0,framebuffer:null,framebuffer_prev:null,color_attachment:null,depth_attachment:null,aspect:0,fov:0,fit:"VERTICAL",near:0,far:0,left:0,right:0,top:0,bottom:0,hmd_fov:Fv(),world_tsr:km(),view_matrix:new Float32Array(16),view_refl_matrix:new Float32Array(16),view_transform_params:{trans:ih(),angle:0},proj_matrix:new Float32Array(16),view_proj_matrix:new Float32Array(16),view_proj_inv_matrix:new Float32Array(16),prev_view_proj_matrix:new Float32Array(16),sky_vp_inv_matrix:new Float32Array(16),direction:new Float32Array(3),view_tsr:km(),view_tsr_inv:km(),real_view_tsr:km(),real_view_tsr_inv:km(),shadow_cast_billboard_view_tsr:km(),dof_distance:0,dof_front_start:0,dof_front_end:0,dof_rear_start:0,dof_rear_end:0,dof_power:0,dof_bokeh_intensity:0,dof_object:null,dof_bokeh:!1,dof_foreground_blur:!1,dof_on:!1,lod_eye:new Float32Array(3),frustum_planes:U(),stereo_conv_dist:0,stereo_eye_dist:0,reflection_plane:null,csm_centers:null,csm_radii:null,csm_center_dists:new Float32Array(4),pcf_blur_radii:new Float32Array(4)};return t.hmd_fov[0]=t.hmd_fov[2]=0,t.hmd_fov[1]=t.hmd_fov[3]=0,t}function w(e,t){var r,n,a=C(e.type);return a.name=e.name,a.size_mult=e.size_mult,a.width=e.width,a.height=e.height,t||(a.framebuffer=e.framebuffer,a.framebuffer_prev=e.framebuffer_prev,a.color_attachment=e.color_attachment,a.depth_attachment=e.depth_attachment),a.aspect=e.aspect,a.fit=e.fit,a.fov=e.fov,a.near=e.near,a.far=e.far,a.left=e.left,a.right=e.right,a.top=e.top,a.bottom=e.bottom,Bv(e.hmd_fov,a.hmd_fov),Dm(e.world_tsr,a.world_tsr),yA(e.view_matrix,a.view_matrix),yA(e.view_refl_matrix,a.view_refl_matrix),a.view_transform_params=lO(e.view_transform_params),yA(e.proj_matrix,a.proj_matrix),yA(e.view_proj_matrix,a.view_proj_matrix),yA(e.view_proj_inv_matrix,a.view_proj_inv_matrix),yA(e.prev_view_proj_matrix,a.prev_view_proj_matrix),yA(e.sky_vp_inv_matrix,a.sky_vp_inv_matrix),a.direction.set(e.direction),Dm(e.view_tsr,a.view_tsr),Dm(e.view_tsr_inv,a.view_tsr_inv),Dm(e.real_view_tsr,a.real_view_tsr),Dm(e.real_view_tsr_inv,a.real_view_tsr_inv),Dm(e.shadow_cast_billboard_view_tsr,a.shadow_cast_billboard_view_tsr),a.dof_distance=e.dof_distance,a.dof_front_start=e.dof_front_start,a.dof_front_end=e.dof_front_end,a.dof_rear_start=e.dof_rear_start,a.dof_rear_end=e.dof_rear_end,a.dof_power=e.dof_power,a.dof_bokeh_intensity=e.dof_bokeh_intensity,a.dof_object=e.dof_object,a.dof_bokeh=e.dof_bokeh,a.dof_foreground_blur=e.dof_foreground_blur,a.dof_on=e.dof_on,ch(e.lod_eye,a.lod_eye),Bv((r=e.frustum_planes).left,(n=a.frustum_planes).left),Bv(r.right,n.right),Bv(r.top,n.top),Bv(r.bottom,n.bottom),Bv(r.near,n.near),Bv(r.far,n.far),a.stereo_conv_dist=e.stereo_conv_dist,a.stereo_eye_dist=e.stereo_eye_dist,e.reflection_plane&&(a.reflection_plane=Gv(e.reflection_plane)),function(e,t){if(e.csm_centers){var r=e.csm_centers.length;t.csm_centers=new Array(r);for(var n=0;n<r;n++)t.csm_centers[n]=sh(e.csm_centers[n]);t.csm_radii=new Float32Array(e.csm_radii)}}(e,a),Bv(e.csm_center_dists,a.csm_center_dists),Bv(e.pcf_blur_radii,a.pcf_blur_radii),a}function U(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function k(e){switch(e){case"STATIC":return t.MS_STATIC;case"TARGET":return t.MS_TARGET_CONTROLS;case"EYE":return t.MS_EYE_CONTROLS;case"HOVER":return t.MS_HOVER_CONTROLS;default:r.panic("Unknown move style")}}function D(e){var n=C(e);if(e==t.TYPE_NONE)return n;switch(e){case t.TYPE_PERSP:B(n,l,.1,1e3);break;case t.TYPE_ORTHO:B(n,2.5,.1,1e3);break;case t.TYPE_PERSP_ASPECT:case t.TYPE_ORTHO_ASPECT:case t.TYPE_ORTHO_ASYMMETRIC:break;case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:r.panic("Stereo camera may only be created from perspective one");break;default:r.panic("Unknown camera type")}return n}function F(e,n,o){if(e.type!=t.TYPE_STEREO_LEFT&&e.type!=t.TYPE_STEREO_RIGHT&&e.type!=t.TYPE_HMD_LEFT&&e.type!=t.TYPE_HMD_RIGHT&&r.panic("set_stereo_params(): wrong camera type"),e.type!=t.TYPE_STEREO_LEFT&&e.type!=t.TYPE_STEREO_RIGHT||(e.stereo_conv_dist=n),e.stereo_eye_dist=o,ve(e,!1),_.check_active()){var i=_.get_active(),s=i._render.shadow_params;if(s)for(var l=a.get_scene_data(_.get_camera(i),i).cameras,c=0;c<l.length;c++)Ie(l[c],s)}}function G(e,t,r){var n=P,a=S;Ih(t,Ug)>0?(bh(Cg,t,n),Rh(n,n)):ch(Ug,n),bh(t,n,a);var o=_O(e,Ug,A),_=_O(e,Dg,h);Rh(o,o),Rh(_,_);var i=-Math.asin(Ih(o,t)),s=Ih(_,t);if(Math.abs(i)>Math.PI/4)var l=Sh(_,-qg(i),v);else l=Sh(o,-qg(Math.asin(s)),m);var c=Math.atan(Math.abs(Ih(a,l)/Ih(n,l))),E=i;s>0&&(E=qg(E)*Math.PI-E);var u=c;return Ih(n,l)<0&&(u=Math.PI-u),Ih(a,l)<0&&(u=2*Math.PI-u),r[0]=u,r[1]=E,r}function K(e){switch(e.fit){case"AUTO":return e.aspect>1?Le(e)?e.fov/e.aspect:2*Math.atan(Math.tan(e.fov/2)/e.aspect):e.fov;case"HORIZONTAL":return Le(e)?e.fov/e.aspect:2*Math.atan(Math.tan(e.fov/2)/e.aspect);case"VERTICAL":return e.fov}}function B(e,n,a,o){switch(e.type){case t.TYPE_PERSP:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:case t.TYPE_ORTHO:e.fov=n,e.aspect=1;break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:break;default:r.panic("set_frustum(): Unsupported camera type: "+e.type)}e.near=a,e.far=o}t.init_ortho_props=x,t.clone_camera=w,t.create_frustum_planes=U,t.move_style_bpy_to_b4w=k,t.create_camera=D,t.check_attachment=function(e,t){switch(t){case"COLOR":case"CUBEMAP":return Boolean(e.color_attachment);case"DEPTH":return Boolean(e.depth_attachment);case"SCREEN":return!Boolean(e.color_attachment)&&!Boolean(e.depth_attachment);default:r.panic("Wrong attachment type: "+t)}},t.set_attachment=function(e,t,n){switch(t){case"COLOR":case"CUBEMAP":e.color_attachment=n;break;case"DEPTH":e.depth_attachment=n;break;case"SCREEN":e.color_attachment=null,e.depth_attachment=null;break;default:r.panic("Wrong attachment type: "+t)}},t.get_attachment=function(e,t){switch(t){case"COLOR":case"CUBEMAP":return e.color_attachment;case"DEPTH":return e.depth_attachment;case"SCREEN":return null;default:r.panic("Wrong attachment type: "+t)}},t.make_stereo=function(e,n){(e.type!=t.TYPE_PERSP||n!=t.TYPE_STEREO_LEFT&&n!=t.TYPE_STEREO_RIGHT&&n!=t.TYPE_HMD_LEFT&&n!=t.TYPE_HMD_RIGHT)&&r.panic("make_stereo(): wrong camera type"),e.type=n,F(e,6,.065)},t.set_stereo_params=F,t.get_camera_angles_from_quat=G,t.get_camera_angles_char=function(e,t){return Y(e,t),t[0]=qO(t[0]+Math.PI),t[1]*=-1,t},t.set_fov=function(e,r){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:e.fov=r}},t.get_fov=function(e){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:return e.fov;default:return 0}},t.get_vfov=K,t.set_frustum=B,t.set_frustum2=function(e,n,a,o,_){switch(e.type){case t.TYPE_PERSP:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:case t.TYPE_ORTHO:e.fov=a,e.aspect=1;break;case t.TYPE_PERSP_ASPECT:case t.TYPE_ORTHO_ASPECT:e.fov=a,e.aspect=n/a;break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:break;default:r.panic("set_frustum2(): Unsupported camera type: "+e.type)}e.near=o,e.far=_},t.set_frustum_asymmetric=function(e,n,a,o,_,i,s){switch(e.type){case t.TYPE_ORTHO_ASYMMETRIC:e.left=n,e.right=a,e.bottom=o,e.top=_,e.near=i,e.far=s;break;default:r.panic("set_frustum_asymmetric(): Unsupported camera type: "+e.type)}},t.get_move_style=function(e){return e.render.move_style};var X=function(){var e=ih(),r=dm(),n=IA();return function(a,o){var s=jm(o.render.world_tsr,e),l=Vm(o.render.world_tsr,r);if(MA(VA(l,s,n),a.view_matrix),_.check_active())var c=_.get_active(),E=_.get_subs(c,i.STEREO);a.type==t.TYPE_STEREO_LEFT||E&&E.enable_hmd_stereo&&a.type==t.TYPE_HMD_LEFT?a.view_matrix[12]+=a.stereo_eye_dist/2:(a.type==t.TYPE_STEREO_RIGHT||E&&E.enable_hmd_stereo&&a.type==t.TYPE_HMD_RIGHT)&&(a.view_matrix[12]-=a.stereo_eye_dist/2),a.reflection_plane&&(eg(a.view_matrix,a.real_view_tsr),Zm(a.real_view_tsr,a.real_view_tsr_inv),function(e){var t=e.reflection_plane[0],r=e.reflection_plane[1],n=e.reflection_plane[2],a=e.reflection_plane[3],o=e.view_refl_matrix;o[0]=1-2*t*t,o[1]=-2*t*r,o[2]=-2*t*n,o[3]=0,o[4]=-2*t*r,o[5]=1-2*r*r,o[6]=-2*r*n,o[7]=0,o[8]=-2*t*n,o[9]=-2*r*n,o[10]=1-2*n*n,o[11]=0,o[12]=-2*t*a,o[13]=-2*r*a,o[14]=-2*n*a,o[15]=1}(a),function(e){wA(e.view_matrix,e.view_refl_matrix,e.view_matrix)}(a),H(a,!0),xh(s,a.view_refl_matrix,s)),eg(a.view_matrix,a.view_tsr),Zm(a.view_tsr,a.view_tsr_inv),Gm(s,1,l,a.world_tsr),ge(a)}}();function H(e,t){ve(e,!0);var r=O,n=R;MA(e.view_matrix,n),YA(n,n),sm(e.reflection_plane,n,r);var a=N;a[0]=(qg(r[0])+e.proj_matrix[8])/e.proj_matrix[0],a[1]=(qg(r[1])+e.proj_matrix[9])/e.proj_matrix[5],a[2]=-1,a[3]=(1+e.proj_matrix[10])/e.proj_matrix[14],Wv(r,2/(r[0]*a[0]+r[1]*a[1]+r[2]*a[2]+r[3]*a[3]),r),e.proj_matrix[2]=r[0],e.proj_matrix[6]=r[1],e.proj_matrix[10]=r[2]+1,e.proj_matrix[14]=r[3],me(e),t||ge(e)}function j(e,t,r){var n=dh(r,t,P);if(mh(n)){Rh(n,n);var a=tN(Fg,n,g);s.set_rotation(e,a)}s.set_translation(e,t)}t.set_view=X,t.set_projection_reflect=H,t.set_view_trans_quat=function(e,r,n){var a=P;a[0]=0,a[1]=0,a[2]=-1,wh(a,n,a),a[0]+=r[0],a[1]+=r[1],a[2]+=r[2];var o=S;o[0]=0,o[1]=1,o[2]=0,wh(o,n,o),function(e,r,n,a){rh(r,n,a,e.view_matrix);var o=_.get_active(),s=_.get_subs(o,i.STEREO);e.type==t.TYPE_STEREO_LEFT||s&&s.enable_hmd_stereo&&e.type==t.TYPE_HMD_LEFT?e.view_matrix[12]+=e.stereo_eye_dist/2:(e.type==t.TYPE_STEREO_RIGHT||s&&s.enable_hmd_stereo&&e.type==t.TYPE_HMD_RIGHT)&&(e.view_matrix[12]-=e.stereo_eye_dist/2),eg(e.view_matrix,e.view_tsr),Oe(e),Ne(e),Km(r,e.world_tsr)}(e,r,a,o)},t.set_look_at=j;var z=function(){var e=ih(),t=ih(),r=ih(),n=dm(),a=dm();return function(o,_,i){var s=o.render,l=Vm(s.world_tsr,n),c=_O(l,Ug,e);if(Rh(c,c),Math.abs(Ih(_,c))>.999999)var E=hm(a);else{var u=bh(_,c,t);Rh(u,u),Ih(_O(l,Dg,r),_)>0&&Oh(u,u);var d=_O(l,Cg,r);Rh(d,d);var T=xO(Ih(d,u),-1,1);am(E=T<=-.999999?vm(c,Math.acos(T),a):Sm(d,u,a),E)}mm(E,l,l),i&&Ih(_,_O(l,wg,e))<0&&Nm(l,Math.PI,l),Hm(l,s.world_tsr)}}();t.correct_up=z;var Q=function(){var e=dm(),t=ih();return function(r){var n=Vm(r.render.world_tsr,e),a=r.render.vertical_axis;return Ih(_O(n,wg,t),a)<0}}();function V(e,t,r){var n=e.render,a=Q(e);if(j(e,t,r),a){var o=ch(n.vertical_axis,P);Oh(o,o),z(e,o,!0)}else z(e,n.vertical_axis,!0)}t.set_look_at_corrected=V;var q=function(){var e=ih(),t=ih(),r=ih(),n=dm();return function(a,o){for(var _=a.render,i=o.cameras,l=_O(Vm(_.world_tsr,n),Fg,e),c=jm(_.world_tsr,t),E=o.shadow_cameras,u=0;u<E.length;u++)ch(l,(d=E[u]).direction),jm(_.world_tsr,d.lod_eye);for(u=0;u<i.length;u++){var d;if(X(d=i[u],a),ch(l,d.direction),d.dof_object&&d.dof_on){var T=hh(c,s.get_translation(d.dof_object,r));d.dof_distance=T}}}}();function W(e,r){var n=e.render;r?(n.horizontal_limits=n.horizontal_limits||{},n.horizontal_limits.left=r.left,n.horizontal_limits.right=r.right,n.horizontal_limits.left_local=r.left,n.horizontal_limits.right_local=r.right,n.horizontal_limits.camera_space=Boolean(r.camera_space),function(e){var r=e.render,n=r.horizontal_limits;if(n&&(r.move_style==t.MS_EYE_CONTROLS||r.move_style==t.MS_TARGET_CONTROLS)){var a=Y(e,T);n.camera_space?(n.left+=a[0],n.right+=a[0]):(n.left_local-=a[0],n.right_local-=a[0]),n.left=qO(n.left),n.right=qO(n.right),n.left_local=qO(n.left_local),n.right_local=qO(n.right_local)}}(e)):n.horizontal_limits=null}function J(e,t){var r=e.render;t?(r.vertical_limits=r.vertical_limits||{},r.vertical_limits.down=t.down,r.vertical_limits.up=t.up,r.vertical_limits.down_local=t.down,r.vertical_limits.up_local=t.up,r.vertical_limits.camera_space=Boolean(t.camera_space),$(e)):r.vertical_limits=null}function Z(e,t){var r=e.render;if(!t){var n=Y(e,T);t={down:n[1],up:n[1]}}r.vertical_limits=r.vertical_limits||{},r.vertical_limits.down=t.down,r.vertical_limits.up=t.up,$(e),r.distance_limits&&r.vertical_limits&&Se(e)}function $(e){var r=e.render,n=r.vertical_limits;if(n)switch(r.move_style){case t.MS_EYE_CONTROLS:case t.MS_TARGET_CONTROLS:var a=Y(e,T);n.camera_space?(n.up+=a[1],n.down+=a[1]):(n.up_local-=a[1],n.down_local-=a[1]),n.up=VO(n.up,-Math.PI,Math.PI),n.down=VO(n.down,-Math.PI,Math.PI),n.up_local=VO(n.up_local,-Math.PI,Math.PI),n.down_local=VO(n.down_local,-Math.PI,Math.PI);break;case t.MS_HOVER_CONTROLS:n.up=VO(n.up,-Math.PI,Math.PI),n.down=VO(n.down,-Math.PI,Math.PI),n.up=xO(n.up,-Math.PI/2,0),n.down=xO(n.down,-Math.PI/2,0)}}function ee(e,t){var r=e.render;if(!t){var n=s.obj_point_distance(e,r.hover_pivot);t={min:n,max:n}}r.distance_limits=r.distance_limits||{},r.distance_limits.min=t.min,r.distance_limits.max=t.max,r.distance_limits&&r.vertical_limits&&Se(e)}function te(e,t){var r=e.render;t?(r.distance_limits=r.distance_limits||{},r.distance_limits.min=t.min,r.distance_limits.max=t.max):r.distance_limits=null}function re(e,t){var r=e.render;t?(r.pivot_limits=r.pivot_limits||{},r.pivot_limits.min_z=t.min_z,r.pivot_limits.max_z=t.max_z):r.pivot_limits=null}function ne(e,t){var r=e.render;t?(r.hover_horiz_trans_limits=r.hover_horiz_trans_limits||{},r.hover_horiz_trans_limits.min=t.min,r.hover_horiz_trans_limits.max=t.max):r.hover_horiz_trans_limits=null}function ae(e,t){var r=e.render;t?(r.hover_vert_trans_limits=r.hover_vert_trans_limits||{},r.hover_vert_trans_limits.min=t.min,r.hover_vert_trans_limits.max=t.max):r.hover_vert_trans_limits=null}t.update_camera_transform=q,t.update_camera=function(){var e=dm(),r=ih();return function(n){var a=n.render;switch(ie(n),oe(n),a.move_style){case t.MS_TARGET_CONTROLS:var o=jm(a.world_tsr,r),_=Vm(a.world_tsr,e);pN(o,_,a.pivot,Fg),Hm(_,a.world_tsr);for(var i=0;i<n.scenes_data.length;i++)for(var s=n.scenes_data[i].cameras,l=0;l<s.length;l++){var c=s[l];c.type!=t.TYPE_STEREO_LEFT&&c.type!=t.TYPE_STEREO_RIGHT||F(c,hh(o,a.pivot),c.stereo_eye_dist)}z(n,a.vertical_axis);break;case t.MS_EYE_CONTROLS:n.constraint||z(n,a.vertical_axis)}}}(),t.set_horizontal_rot_limits=W,t.set_vertical_rot_limits=J,t.hover_set_vertical_limits=Z,t.hover_set_distance_limits=ee,t.set_distance_limits=te,t.set_pivot_limits=re,t.set_hor_trans_limits=ne,t.set_vert_trans_limits=ae;var oe=function(){var e=ih();return function(r){var n=r.render;if(a.is_camera(r))for(var o=r.scenes_data,_=0;_<o.length;_++){var i=o[_].cameras;if(i[0].type===t.TYPE_ORTHO){switch(n.move_style){case t.MS_TARGET_CONTROLS:var s=hh(jm(n.world_tsr,e),n.pivot)/n.init_dist*n.init_fov;break;case t.MS_HOVER_CONTROLS:s=hh(jm(n.world_tsr,e),n.hover_pivot)/n.init_dist*n.init_fov;break;default:s=i[0].fov}for(var l=0;l<i.length;l++){var c=i[l];c.fov=s,ve(c,!0)}q(r,o[_])}}}}();t.update_ortho_scale=oe;var _e=function(){var e=dm(),t=ih(),r=ih(),n=ih();return function(a){var o=a.render,_=jm(o.world_tsr,t),i=dh(_,o.pivot,r),s=mh(i);if(s>o.distance_limits.max)Sh(i,o.distance_limits.max/s,i),uh(o.pivot,i,_);else if(s<o.distance_limits.min){var l=_O(Vm(o.world_tsr,e),Fg,n);Sh(l,100*o.distance_limits.min,l),uh(i,l,i),Sh(i,-o.distance_limits.min/mh(i),i),uh(o.pivot,i,_)}Km(_,o.world_tsr)}}();function ie(e){var r=e.render,n=r.move_style;if(n===t.MS_TARGET_CONTROLS||n===t.MS_EYE_CONTROLS){if(r.horizontal_limits){var a=r.horizontal_limits.left,o=r.horizontal_limits.right,_=Y(e,T);if(n==t.MS_TARGET_CONTROLS)var i=rN(_[0],a,o);else i=rN(_[0],o,a);i&&(n==t.MS_TARGET_CONTROLS?ce(e,i,0):de(e,i,0))}if(r.vertical_limits){var s=r.vertical_limits.down,l=r.vertical_limits.up;_=Y(e,T),(i=n==t.MS_TARGET_CONTROLS?rN(_[1],l,s):rN(_[1],s,l))&&(n==t.MS_TARGET_CONTROLS?ce(e,0,i):de(e,0,i))}n===t.MS_TARGET_CONTROLS&&r.distance_limits&&_e(e)}n===t.MS_TARGET_CONTROLS&&r.pivot_limits&&Ae(e),n===t.MS_HOVER_CONTROLS&&(he(e),function(e){var t=e.render,r=rN(Y(e,T)[1],t.vertical_limits.up,t.vertical_limits.down);r&&pe(e,0,r)}(e))}function se(e,t,r,n){var a=Y(e,p);return n[0]=t-a[0],n[1]=r-a[1],n}var le=function(){var e=dm(),t=dm(),r=dm(),n=ih(),a=ih();return function(o,_,i,s){var l=o.render;if(i||s){var c=hm(e);i&&vm(o.render.vertical_axis,i,c);var E=Vm(l.world_tsr,t);if(s){var u=vm(_O(E,Cg,n),s,r);am(u,u),mm(c,u,c)}var d=jm(l.world_tsr,a);!function(e,t,r,n){n||(n=new Float32Array(3));var a=fg;dh(t,e,a),wh(a,r,a),dh(t,a,n)}(d,_,c,d),Km(d,l.world_tsr),mm(c,E,E),am(E,E),Hm(E,l.world_tsr)}}}();function ce(e,t,r){le(e,e.render.pivot,t,r)}function Ee(e,t,r){var n=se(e,t,r,f);ce(e,n[0],n[1])}t.rotate_target_angles=ce,t.set_rotation_target_angles=Ee;var ue=function(){var e=dm(),t=dm(),r=dm(),n=ih();return function(a,o,_){var i=a.render;if(o||_){var s=hm(e);o&&mm(s,vm(i.vertical_axis,o,t),s);var l=Vm(i.world_tsr,t);if(_){var c=vm(_O(l,Cg,n),_,r);am(c,c),mm(s,c,s)}mm(s,l,l),am(l,l),Hm(l,i.world_tsr)}}}();function de(e,t,r){ue(e,t,r)}function Te(e,t,r){fe(e,t,r)}t.rotate_static_angles=ue,t.rotate_eye_angles=de,t.set_rotation_eye_angles=Te;var fe=function(){var e=new Float32Array(2),t=dm();return function(r,n,a){var o=r.render,_=G(Vm(o.world_tsr,t),o.vertical_axis,e);ue(r,n-_[0],a-_[1])}}();function pe(e,t,r){var n=e.render;n.enable_hover_hor_rotation||(t=0),le(e,n.hover_pivot,t,r),r&&Se(e)}function Pe(e,t,r){var n=se(e,t,r,f);pe(e,n[0],n[1])}t.set_rotation_static_angles=fe,t.rotate_hover_angles=pe,t.set_rotation_hover_angles=Pe,t.rotate_angles=function(e,r,n){var a=e.render.move_style;a===t.MS_TARGET_CONTROLS?ce(e,r,n):a===t.MS_EYE_CONTROLS?de(e,r,n):a===t.MS_HOVER_CONTROLS?pe(e,r,n):a===t.MS_STATIC&&ue(e,r,n)},t.set_rotation_angles=function(e,r,n){var a=e.render.move_style;a===t.MS_TARGET_CONTROLS?Ee(e,r,n):a===t.MS_EYE_CONTROLS?Te(e,r,n):a===t.MS_HOVER_CONTROLS?Pe(e,r,n):a===t.MS_STATIC&&fe(e,r,n)};var Se=function(){var e=dm(),t=new Float32Array(2),r=ih(),n=ih();return function(a){var o=a.render,_=function(e,t){var r=e.render,n=r.vertical_limits,a=r.distance_limits;if(n.down-n.up){var o=(n.down-t)/(n.down-n.up);o=Math.max(o,0)}else o=0;return o*(a.max-a.min)+a.min}(a,Y(a,t)[1]),i=jm(o.world_tsr,r),s=_O(Vm(o.world_tsr,e),Fg,n);Rh(s,s),Sh(s,_,s),dh(o.hover_pivot,s,i),Km(i,o.world_tsr)}}(),Ae=function(){var e=ih(),t=ih();return function(r){var n=r.render,a=n.pivot[2],o=xO(n.pivot[2],n.pivot_limits.min_z,n.pivot_limits.max_z);if(o!=a){var _=Eh(0,0,o-a,e);uh(n.pivot,_,n.pivot);var i=jm(n.world_tsr,t);uh(i,_,i),Km(i,n.world_tsr)}}}(),he=function(){var e=ih();return function(t){var r=t.render;if(r.hover_horiz_trans_limits){var n=xO(r.hover_pivot[0],r.hover_horiz_trans_limits.min,r.hover_horiz_trans_limits.max)-r.hover_pivot[0];r.hover_pivot[0]+=n,(a=jm(r.world_tsr,e))[0]+=n,Km(a,r.world_tsr)}if(r.hover_vert_trans_limits){var a,o=xO(r.hover_pivot[1],r.hover_vert_trans_limits.min,r.hover_vert_trans_limits.max)-r.hover_pivot[1];r.hover_pivot[1]+=o,(a=jm(r.world_tsr,e))[1]+=o,Km(a,r.world_tsr)}}}();function ve(e,n){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:$A(K(e),e.aspect,e.near,e.far,e.proj_matrix);break;case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:var a=K(e),o=a*e.aspect;th(-o,o,-a,a,e.near,e.far,e.proj_matrix);break;case t.TYPE_ORTHO_ASYMMETRIC:th(e.left,e.right,e.bottom,e.top,e.near,e.far,e.proj_matrix);break;case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:!function(e){var r=Math.tan(K(e)/2),n=e.near*r,a=e.aspect*e.stereo_conv_dist*r;if(e.type==t.TYPE_STEREO_LEFT)var o=a-e.stereo_eye_dist/2,_=a+e.stereo_eye_dist/2;else o=a+e.stereo_eye_dist/2,_=a-e.stereo_eye_dist/2;var i=-e.near/e.stereo_conv_dist*o,s=e.near/e.stereo_conv_dist*_;ZA(i,s,-n,n,e.near,e.far,e.proj_matrix),e.left=i,e.right=s}(e);break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:!function(e){if(_.check_active()){var t=_.get_active(),r=_.get_subs(t,i.STEREO);if(r&&r.enable_hmd_stereo){var n=Math.tan(e.hmd_fov[0]),a=Math.tan(e.hmd_fov[1]),o=Math.tan(e.hmd_fov[2]),s=Math.tan(e.hmd_fov[3]);e.top=e.near*n,e.right=e.near*a,e.bottom=-e.near*o,e.left=-e.near*s,ZA(e.left,e.right,e.bottom,e.top,e.near,e.far,e.proj_matrix)}else e.top=e.near*Math.tan(K(e)/2),e.bottom=-e.top,e.right=e.top*e.aspect,e.left=-e.right,$A(K(e),e.aspect,e.near,e.far,e.proj_matrix)}}(e);break;case t.TYPE_NONE:return;default:r.panic("Wrong camera type: "+e.type)}me(e),n||ge(e)}function me(e){UA(e.proj_matrix,e.view_transform_params.trans,e.proj_matrix),KA(e.proj_matrix,e.view_transform_params.angle,e.proj_matrix)}function ge(e){Oe(e),Ne(e),dO(e.view_proj_matrix,e.frustum_planes)}function Oe(e){yA(e.view_matrix,e.view_proj_matrix),wA(e.proj_matrix,e.view_proj_matrix,e.view_proj_matrix),MA(e.view_proj_matrix,e.view_proj_inv_matrix)}function Ne(e){yA(e.view_matrix,e.sky_vp_inv_matrix),e.sky_vp_inv_matrix[12]=0,e.sky_vp_inv_matrix[13]=0,e.sky_vp_inv_matrix[14]=0,e.sky_vp_inv_matrix[15]=1,wA(e.proj_matrix,e.sky_vp_inv_matrix,e.sky_vp_inv_matrix),MA(e.sky_vp_inv_matrix,e.sky_vp_inv_matrix)}function Re(e,n,a,o,_){var i,s,l,c,E,u,d,T;switch(o||(o=new Float32Array(24)),n||(n=e.near),a||(a=e.far),e.type){case t.TYPE_NONE:r.panic("Extraction from NONE camera is not possible");break;case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:c=-(i=n*Math.tan(K(e)/2)),l=-(s=i*e.aspect),T=-(E=i*(a/n)),d=-(u=E*e.aspect);break;case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:var f=K(e),p=f*e.aspect;i=E=f,s=u=p,c=T=-f,l=d=-p;break;case t.TYPE_ORTHO_ASYMMETRIC:i=E=e.top,s=u=e.right,c=T=e.bottom,l=d=e.left;break;case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:var P=n/e.near;c=-(i=n*Math.tan(K(e)/2)),T=-(E=i*(S=a/n)),u=(s=e.right*P)*S,d=(l=e.left*P)*S;break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:var S;E=(i=e.top*(P=n/e.near))*(S=a/n),T=(c=e.bottom*P)*S,u=(s=e.right*P)*S,d=(l=e.left*P)*S;break;default:r.panic("Wrong camera type: "+e.type)}if(o[0]=l,o[1]=c,o[2]=-n,o[3]=s,o[4]=c,o[5]=-n,o[6]=s,o[7]=i,o[8]=-n,o[9]=l,o[10]=i,o[11]=-n,o[12]=d,o[13]=T,o[14]=-a,o[15]=d,o[16]=E,o[17]=-a,o[18]=u,o[19]=E,o[20]=-a,o[21]=u,o[22]=T,o[23]=-a,_){var A=R;MA(e.view_matrix,A),fO(o,A,o,0)}return o}function Ie(e,t){t.enable_csm?function(e,t){var r=t.csm_num;e.csm_centers||function(e,t){var r=t.csm_num;e.csm_centers=new Array(r);for(var n=0;n<r;n++)e.csm_centers[n]=new Float32Array(3);e.csm_radii=new Float32Array(r)}(e,t);for(var n=0;n<r;n++){var a=sR(Re(e,0==n?e.near:be(t,e,n-1),be(t,e,n),I));e.csm_centers[n].set(a.center),e.csm_radii[n]=a.radius,e.csm_center_dists[n]=mh(a.center),e.pcf_blur_radii[n]=ye(t.first_cascade_blur_radius,t.last_cascade_blur_radius,r,n)}}(e,t):e.pcf_blur_radii[0]=t.first_cascade_blur_radius}function be(e,t,r){var n=e.csm_num,a=xO(e.csm_first_cascade_border,t.near,t.far),o=xO(e.csm_last_cascade_border,t.near,t.far);return xO(ye(a,o,n,r),t.near,t.far)}function ye(e,t,r,n){switch(n){case 0:var a=e;break;case r-1:a=t;break;default:a=0==e?0:e*Math.pow(t/e,n/(r-1))}return a}function Le(e){switch(e.type){case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:case t.TYPE_ORTHO_ASYMMETRIC:return!0;default:return!1}}function Ye(e,t){return t||(t=new Float32Array(3)),jm(e.render.world_tsr,t)}t.is_float_aspect=function(e){switch(e.type){case t.TYPE_PERSP:case t.TYPE_ORTHO:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:return!0;default:return!1}},t.get_angular_diameter=function(e){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:var r=K(e),n=function(e){switch(e.fit){case"AUTO":return e.aspect>1?e.fov:Le(e)?e.fov*e.aspect:2*Math.atan(Math.tan(e.fov/2)*e.aspect);case"HORIZONTAL":return e.fov;case"VERTICAL":return Le(e)?e.fov*e.aspect:2*Math.atan(Math.tan(e.fov/2)*e.aspect)}}(e);return Math.min(r,n);default:return o.error("get_angular_diameter(): Unsupported camera type: "+e.type),0}},t.set_aspect=function(e,r){switch(e.type){case t.TYPE_PERSP_ASPECT:case t.TYPE_ORTHO_ASPECT:o.error("set_aspect(): Unsupported camera type: "+e.type);break;default:e.aspect=r}},t.get_aspect=function(e){return e.aspect},t.set_projection=ve,t.set_color_pick_proj=function(e,r,n,a,o){var _=1/Math.max(o,a);switch(e.type){case t.TYPE_NONE:case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:var i=o/2,s=a/2;n=-(n-i)/i*Math.tan(K(e)/2),r=(r-s)/s*Math.tan(K(e)/2)*e.aspect,ZA(e.near*(r-_),c=e.near*(r+_),e.near*(n-_),l=e.near*(n+_),e.near,e.far,e.proj_matrix);break;case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:n=-n/o,th(((r/=a)-_)*((c=(l=K(e))*e.aspect)+c)-c,c=(r+_)*(c+c)-c,l+(n-_)*(l+l),l+=(n+_)*(l+l),e.near,e.far,e.proj_matrix);break;case t.TYPE_ORTHO_ASYMMETRIC:var l,c;th(e.left+((r/=a)-_)*(e.right-e.left),c=e.left+(r+_)*(e.right-e.left),e.top+((n=-n/o)-_)*(e.top-e.bottom),l=e.top+(n+_)*(e.top-e.bottom),e.near,e.far,e.proj_matrix)}me(e),ge(e)},t.calc_sky_vp_inverse=Ne,t.extract_frustum_corners=Re,t.assign_boundings=function(e){var t=e.render,r={max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0};r.min_x=-1,r.max_x=1,r.min_y=-1,r.max_y=1,r.min_z=-1,r.max_z=1,t.bb_local=r;var n=jN(1,Qg([0,0,0]));t.bs_local=n,t.bcap_local=nR(1,r),t.bcyl_local=aR(1,r),t.bcon_local=oR(1,r)},t.is_static_camera=function(e){return a.is_camera(e)&&e.render&&e.render.move_style==t.MS_STATIC},t.is_target_camera=function(e){return a.is_camera(e)&&e.render&&e.render.move_style==t.MS_TARGET_CONTROLS},t.is_eye_camera=function(e){return a.is_camera(e)&&e.render&&e.render.move_style==t.MS_EYE_CONTROLS},t.is_hover_camera=function(e){return a.is_camera(e)&&e.render&&e.render.move_style==t.MS_HOVER_CONTROLS},t.is_ortho_camera=function(e){return a.is_camera(e)&&e.render&&e.scenes_data[0].cameras[0].type==t.TYPE_ORTHO},t.update_camera_shadows=Ie,t.csm_far_plane=be,t.project_point=function(e,r,a){var _=e.scenes_data[0].cameras[0];switch(_.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:case t.TYPE_NONE:var i=O;i.set(r),i[3]=1,sm(i,_.view_proj_matrix,i);var s=-i[1]/i[3];return a[0]=(i[0]/i[3]+1)/2*_.width,a[1]=(s+1)/2*_.height,n.viewport_to_canvas_coords(a[0],a[1],a,_),a.length>2&&(a[2]=(i[2]/Math.abs(i[3])+1)/2),a;default:return o.error("Non-compatible camera"),a}},t.get_first_cam=function(e){return e.scenes_data[0].cameras[0]},t.get_edge=function(e,n){switch(e.type){case t.TYPE_PERSP:case t.TYPE_PERSP_ASPECT:case t.TYPE_STEREO_LEFT:case t.TYPE_STEREO_RIGHT:var a=Math.tan(K(e)/2);switch(n){case"LEFT":return-a*e.aspect;case"RIGHT":return a*e.aspect;case"TOP":return a;case"BOTTOM":return-a}break;case t.TYPE_ORTHO:case t.TYPE_ORTHO_ASPECT:switch(n){case"LEFT":return-K(e)*e.aspect;case"RIGHT":return K(e)*e.aspect;case"TOP":return K(e);case"BOTTOM":return-K(e)}break;case t.TYPE_ORTHO_ASYMMETRIC:switch(n){case"LEFT":return e.left;case"RIGHT":return e.right;case"TOP":return e.top;case"BOTTOM":return e.bottom}break;case t.TYPE_HMD_LEFT:case t.TYPE_HMD_RIGHT:var o=_.get_active(),s=_.get_subs(o,i.STEREO);if(s&&s.enable_hmd_stereo)switch(n){case"LEFT":return-Math.tan(Math.min(e.hmd_fov[1],e.hmd_fov[3]));case"RIGHT":return Math.tan(Math.min(e.hmd_fov[1],e.hmd_fov[3]));case"TOP":return Math.tan(Math.min(e.hmd_fov[0],e.hmd_fov[2]));case"BOTTOM":return-Math.tan(Math.min(e.hmd_fov[0],e.hmd_fov[2]))}else switch(a=Math.tan(K(e)/2),n){case"LEFT":return-a*e.aspect;case"RIGHT":return a*e.aspect;case"TOP":return a;case"BOTTOM":return-a}break;default:r.panic("Unknown camera type")}},t.is_ortho=Le,t.set_trans_pivot=function(e,t,r){var n=e.render;Km(t,n.world_tsr),ch(r,n.pivot)},t.set_hover_pivot=function(){var e=ih(),t=ih();return function(r,n){var a=r.render,o=dh(n,a.hover_pivot,e),_=uh(o,jm(a.world_tsr,t),o);s.set_translation(r,_),ch(n,a.hover_pivot)}}(),t.set_target_pivot=function(){var e=ih(),t=ih();return function(r,n){var a=r.render,o=dh(n,a.pivot,e),_=uh(o,jm(a.world_tsr,t),o);s.set_translation(r,_),ch(n,a.pivot)}}(),t.get_eye=Ye,t.set_move_style=function(){var e=ih(),r=ih(),n=dm();return function(a,o){switch(a.render.move_style=o,a.render.horizontal_limits=null,a.render.vertical_limits=null,a.render.distance_limits=null,a.render.hover_horiz_trans_limits=null,a.render.hover_vert_trans_limits=null,x(a),o){case t.MS_STATIC:case t.MS_EYE_CONTROLS:break;case t.MS_HOVER_CONTROLS:L(a,jm(a.render.world_tsr,e),M(a,0,r),null,null,null,null,a.render.enable_hover_hor_rotation);break;case t.MS_TARGET_CONTROLS:var _=Ye(a,e),i=_O(Vm(a.render.world_tsr,n),Fg,r);ch(Ah(_,i,10,i),a.render.pivot)}}}(),t.wipe_move_style=function(e){var t=e.render;t.move_style=0,Eh(0,0,0,t.pivot),Eh(0,0,0,t.hover_pivot),t.use_panning=!1,t.horizontal_limits=null,t.vertical_limits=null,t.distance_limits=null,t.hover_horiz_trans_limits=null,t.hover_vert_trans_limits=null,t.pivot_limits=null,t.enable_hover_hor_rotation=!0},t.set_eye_distance=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];70!=n.type&&80!=n.type&&90!=n.type&&100!=n.type||F(n,n.stereo_conv_dist,t)}},t.set_hmd_fov=function(e,t,r){for(var n=_.get_active(),o=a.get_scene_data(e,n).cameras,i=0;i<o.length;i++){var s=o[i];90!=s.type&&100!=s.type||(90==s.type&&Bv(t,s.hmd_fov),100==s.type&&Bv(r,s.hmd_fov),s.reflection_plane?H(s,!1):ve(s,!1))}},t.set_hmd_proj_mat=function(e,t,r){for(var n=_.get_active(),o=a.get_scene_data(e,n).cameras,i=0;i<o.length;i++){var s=o[i];90!=s.type&&100!=s.type||(90==s.type&&t&&yA(t,s.proj_matrix),100==s.type&&r&&yA(r,s.proj_matrix),me(s),ge(s))}},t.set_proj_mat=function(e,r){for(var n,o,i,s,l,c,T,f,p=_.get_active(),P=a.get_scene_data(e,p).cameras,S=0;S<P.length;S++)if((g=P[S]).type==t.TYPE_NONE&&g.near||g.type==t.TYPE_PERSP||g.type==t.TYPE_PERSP_ASPECT){n=g.near,o=g.far;var A=MA(r,R),h=sm(E,A,O);i=h[0]*n,s=h[1]*n;var v=sm(u,A,O);l=v[0]*n,c=v[1]*n;var m=sm(d,A,O);T=ZA(l,i,c,s,n,o=-m[2]*m[3],R),f=(i-l)/(s-c);break}for(S=0;S<P.length;S++){var g;(g=P[S]).type!=t.TYPE_NONE&&g.type!=t.TYPE_PERSP&&g.type!=t.TYPE_PERSP_ASPECT||(g.far=o,g.near=n,g.right=i,g.top=s,g.left=l,g.bottom=c,g.aspect=f,g.fov=Math.atan(s/n)-Math.atan(c/n),yA(T,g.proj_matrix),me(g),ge(g))}}})),Pb=nA("camera",(function(e,t){var r=pb(e),n=fb(e),a=PI(e),o=CI(e),_=mN(e),i=LI(e),s=MI(e),l=new Float32Array(2),c=new Float32Array(3),E=new Float32Array(3),u=(new Float32Array(4),dm()),d={},T={};function f(e,t){return a.is_camera(e)?(t=t||new Float32Array(3),_O(Vm(e.render.world_tsr,u),Fg,t),t):(_.error("get_view_vector(): Wrong camera object"),null)}t.MS_STATIC=r.MS_STATIC,t.MS_TARGET_CONTROLS=r.MS_TARGET_CONTROLS,t.MS_EYE_CONTROLS=r.MS_EYE_CONTROLS,t.MS_HOVER_CONTROLS=r.MS_HOVER_CONTROLS,t.static_setup=function(e,t){if(a.is_camera(e)){if(r.wipe_move_style(e),e.render.move_style=r.MS_STATIC,t){var n=t.pos||jm(e.render.world_tsr,c);t.look_at?r.set_look_at(e,n,t.look_at):s.set_translation(e,n)}s.update_transform(e),o.sync_transform(e),r.init_ortho_props(e)}else _.error("static_setup(): Wrong camera object")},t.static_set_look_at=function(e,t,n){r.is_static_camera(e)?(t=t||jm(e.render.world_tsr,c),n?r.set_look_at(e,t,n):s.set_translation(e,t),s.update_transform(e),o.sync_transform(e)):_.error("static_set_look_at(): Wrong camera object or camera move style")},t.static_set_rotation=function(e,t){r.is_static_camera(e)?(s.set_rotation(e,t),s.update_transform(e),o.sync_transform(e)):_.error("static_set_rotation(): Wrong camera object or camera move style")},t.static_get_rotation=function(e,t){return r.is_static_camera(e)?(t=t||new Float32Array(4),s.get_rotation(e,t)):(_.error("static_get_rotation(): Wrong camera object or camera move style"),null)},t.eye_setup=function(e,t){if(a.is_camera(e))if(!t||!t.horiz_rot_lim||"number"==typeof t.horiz_rot_lim.left&&"number"==typeof t.horiz_rot_lim.right)if(!t||!t.vert_rot_lim||"number"==typeof t.vert_rot_lim.down&&"number"==typeof t.vert_rot_lim.up){if(r.wipe_move_style(e),e.render.move_style=r.MS_EYE_CONTROLS,t){var n=t.pos||jm(e.render.world_tsr,c);r.setup_eye_model(e,n,t.look_at,t.horiz_rot_lim,t.vert_rot_lim)}s.update_transform(e),o.sync_transform(e),r.init_ortho_props(e)}else _.error("eye_setup(): Wrong vertical limits object.");else _.error("eye_setup(): Wrong horizontal limits object.");else _.error("eye_setup(): Wrong camera object")},t.eye_set_look_at=function(e,t,n){r.is_eye_camera(e)?(t=t||jm(e.render.world_tsr,c),n?r.set_look_at_corrected(e,t,n):s.set_translation(e,t),r.correct_up(e,e.render.vertical_axis,!0),s.update_transform(e),o.sync_transform(e)):_.error("eye_set_look_at(): Wrong camera object or camera move style")},t.eye_rotate=function(e,n,a,o){_.error_deprecated("eye_rotate","rotate_camera"),r.is_eye_camera(e)?t.rotate_camera(e,n,a,o=o||!1):_.error("eye_rotate(): Wrong camera object or camera move style")},t.eye_set_vertical_limits=function(e,t){r.is_eye_camera(e)?!t||"number"==typeof t.down&&"number"==typeof t.up?(r.set_vertical_rot_limits(e,t),s.update_transform(e),o.sync_transform(e)):_.error("eye_set_vertical_limits(): Incorrect limits object."):_.error("eye_set_vertical_limits(): Wrong camera object or camera move style")},t.eye_get_vertical_limits=function(e,t,n){if(!r.is_eye_camera(e))return _.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;var a=e.render;return a.vertical_limits?(t=t||{},n?(t.down=a.vertical_limits.down_local,t.up=a.vertical_limits.up_local):(t.down=a.vertical_limits.down,t.up=a.vertical_limits.up),t.camera_space=n||!1,t):null},t.eye_set_horizontal_limits=function(e,t){r.is_eye_camera(e)?!t||"number"==typeof t.left&&"number"==typeof t.right?(r.set_horizontal_rot_limits(e,t),s.update_transform(e),o.sync_transform(e)):_.error("eye_set_horizontal_limits(): Incorrect limits object."):_.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")},t.eye_get_horizontal_limits=function(e,t,n){if(!r.is_eye_camera(e))return _.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),null;var a=e.render;return a.horizontal_limits?(t=t||{},n?(t.left=a.horizontal_limits.left_local,t.right=a.horizontal_limits.right_local):(t.left=a.horizontal_limits.left,t.right=a.horizontal_limits.right),t.camera_space=n||!1,t):null},t.target_setup=function(e,t){if(a.is_camera(e))if(!t.horiz_rot_lim||"number"==typeof t.horiz_rot_lim.left&&"number"==typeof t.horiz_rot_lim.right)if(!t.vert_rot_lim||"number"==typeof t.vert_rot_lim.down&&"number"==typeof t.vert_rot_lim.up){if(t.dist_lim){if("number"!=typeof t.dist_lim.min||"number"!=typeof t.dist_lim.max||t.dist_lim.min>t.dist_lim.max)return void _.error("target_setup(): Wrong distance limits object");t.dist_lim.min=Math.max(t.dist_lim.min,0),t.dist_lim.max=Math.max(t.dist_lim.max,0)}if(t.pivot_lim&&("number"!=typeof t.pivot_lim.min_y||"number"!=typeof t.pivot_lim.max_y||t.pivot_lim.min_y>t.pivot_lim.max_y))_.error("target_setup(): Wrong pivot limits object");else{r.wipe_move_style(e),e.render.move_style=r.MS_TARGET_CONTROLS;var n=t.pos||jm(e.render.world_tsr,c),i=t.pivot;if(!i){var l=f(e,E);i=uh(n,l,l)}r.setup_target_model(e,n,i,t.horiz_rot_lim,t.vert_rot_lim,t.dist_lim,t.pivot_lim,t.use_panning||!1),s.update_transform(e),o.sync_transform(e),r.init_ortho_props(e)}}else _.error("target_setup(): Wrong vertical limits object");else _.error("target_setup(): Wrong horizontal limits object");else _.error("target_setup(): Wrong camera object")},t.target_rotate=function(e,n,a,o){_.error_deprecated("target_rotate","rotate_camera"),r.is_target_camera(e)?t.rotate_camera(e,n,a,o=o||!1):_.error("target_rotate(): Wrong camera object or camera move style")},t.target_set_trans_pivot=function(e,t,n){r.is_target_camera(e)?(t=t||jm(e.render.world_tsr,c),r.set_trans_pivot(e,t,n=n||e.render.pivot),s.update_transform(e),o.sync_transform(e)):_.error("target_set_trans_pivot(): Wrong camera object or camera move style")},t.target_set_pivot_translation=function(e,t){r.is_target_camera(e)?(r.set_target_pivot(e,t),s.update_transform(e),o.sync_transform(e)):_.error("target_set_pivot_translation(): Wrong camera object or camera move style")},t.target_set_distance=function(e,t){if(r.is_target_camera(e)){var n=s.obj_point_distance(e,e.render.pivot),a=Math.max(0,t);s.move_local(e,0,0,a-n),s.update_transform(e),o.sync_transform(e)}else _.error("target_set_distance(): Wrong camera object or camera move style")},t.target_get_distance=function(e){return r.is_target_camera(e)?s.obj_point_distance(e,e.render.pivot):(_.error("target_get_distance(): Wrong camera object or camera move style"),0)},t.target_zoom_object=function(e,t){if(r.is_target_camera(e)){var n=s.get_object_center(t,!1,c),l=s.get_object_size(t),u=i.get_active(),d=a.get_scene_data(e,u),T=r.get_angular_diameter(d.cameras[0])/2,f=l/Math.sin(T),p=s.obj_point_distance(e,n);r.set_trans_pivot(e,jm(e.render.world_tsr,E),n),s.update_transform(e),s.move_local(e,0,0,f-p),s.update_transform(e),o.sync_transform(e)}else _.error("target_zoom_object(): Wrong camera object or camera move style")},t.target_get_pivot=function(e,t){return r.is_target_camera(e)?(t=t||new Float32Array(3),ch(e.render.pivot,t),t):(_.error("target_get_pivot(): Wrong camera object or camera move style"),null)},t.target_set_distance_limits=function(e,t){if(r.is_target_camera(e)){if(t){if("number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max)return void _.error("target_set_distance_limits(): Wrong limits object");t.min=Math.max(t.min,0),t.max=Math.max(t.max,0)}r.set_distance_limits(e,t),s.update_transform(e),o.sync_transform(e)}else _.error("target_set_distance_limits(): Wrong camera object or camera move style")},t.target_get_distance_limits=function(e,t){if(!r.is_target_camera(e))return _.error("target_get_distance_limits(): Wrong camera object or camera move style"),null;var n=e.render;return n.distance_limits?((t=t||{}).min=n.distance_limits.min,t.max=n.distance_limits.max,t):null},t.target_set_vertical_limits=function(e,t){r.is_target_camera(e)?!t||"number"==typeof t.down&&"number"==typeof t.up?(r.set_vertical_rot_limits(e,t),s.update_transform(e),o.sync_transform(e)):_.error("target_set_vertical_limits(): Wrong limits object"):_.error("target_set_vertical_limits(): Wrong camera object or camera move style")},t.target_get_vertical_limits=function(e,t,n){if(!r.is_target_camera(e))return _.error("target_get_vertical_limits(): Wrong camera object or camera move style"),null;var a=e.render;return a.vertical_limits?(t=t||{},n?(t.down=a.vertical_limits.down_local,t.up=a.vertical_limits.up_local):(t.down=a.vertical_limits.down,t.up=a.vertical_limits.up),t.camera_space=n||!1,t):null},t.target_set_horizontal_limits=function(e,t){r.is_target_camera(e)?!t||"number"==typeof t.left&&"number"==typeof t.right?(r.set_horizontal_rot_limits(e,t),s.update_transform(e),o.sync_transform(e)):_.error("target_set_horizontal_limits(): Wrong limits object"):_.error("target_set_horizontal_limits(): Wrong camera object or camera move style")},t.target_get_horizontal_limits=function(e,t,n){if(!r.is_target_camera(e))return _.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),null;var a=e.render;return a.horizontal_limits?(t=t||{},n?(t.left=a.horizontal_limits.left_local,t.right=a.horizontal_limits.right_local):(t.left=a.horizontal_limits.left,t.right=a.horizontal_limits.right),t.camera_space=n||!1,t):null},t.target_set_pivot_limits=function(e,t){r.is_target_camera(e)?t&&("number"!=typeof t.min_z||"number"!=typeof t.max_z||t.min_z>t.max_z)?_.error("target_set_pivot_limits(): Wrong limits object"):(r.set_pivot_limits(e,t),s.update_transform(e),o.sync_transform(e)):_.error("target_set_pivot_limits(): Wrong camera object or camera move style")},t.target_get_pivot_limits=function(e,t){if(!r.is_target_camera(e))return _.error("target_get_pivot_limits(): Wrong camera object or camera move style"),null;var n=e.render;return n.pivot_limits?((t=t||{}).min_z=n.pivot_limits.min_z,t.max_z=n.pivot_limits.max_z,t):null},t.target_pan_pivot=function(e,t,n){if(r.is_target_camera(e)){var a=e.render;if(a.use_panning){var i=c;i[0]=t,i[1]=-n,i[2]=0,_g(i,a.world_tsr,i),uh(a.pivot,i,a.pivot);var l=jm(a.world_tsr,E);uh(l,i,l),Km(l,a.world_tsr),s.update_transform(e),o.sync_transform(e)}}else _.error("target_pan_pivot(): wrong object")},t.target_switch_panning=function(e,t){if(!r.is_target_camera(e))return _.error("target_switch_panning(): Wrong camera object or camera move style"),null;e.render.use_panning=t},t.hover_setup_rel=function(e,n){if(t.hover_setup(e,{pos:n.pos,pivot:n.pivot}),void 0===n.dist_interval)var a=0;else a=Math.max(n.dist_interval,0);if(void 0===n.angle_interval)var _=0;else _=Math.max(n.angle_interval,0);if(void 0===n.t)var i=.5;else i=xO(n.t,0,1);var l=t.hover_get_distance_limits(e,d);l.min=Math.max(l.min-i*a,0),l.max=l.max+(1-i)*a;var c=t.hover_get_vertical_limits(e,T);c.down=xO(c.down+i*_,-Math.PI/2,0),c.up=xO(c.up-(1-i)*_,-Math.PI/2,0),r.hover_set_distance_limits(e,l),r.hover_set_vertical_limits(e,c),s.update_transform(e),o.sync_transform(e),r.init_ortho_props(e)},t.hover_setup=function(e,t){if(a.is_camera(e)){if(t.dist_lim){if("number"!=typeof t.dist_lim.min||"number"!=typeof t.dist_lim.max||t.dist_lim.min>t.dist_lim.max)return void _.error("hover_setup(): Wrong distance limits object");t.dist_lim.min=Math.max(t.dist_lim.min,0),t.dist_lim.max=Math.max(t.dist_lim.max,0)}if(t.hover_angle_lim&&("number"!=typeof t.hover_angle_lim.down||"number"!=typeof t.hover_angle_lim.up||t.hover_angle_lim.down<t.hover_angle_lim.up))_.error("hover_setup(): Wrong hover angle limits object");else if(t.horiz_trans_lim&&("number"!=typeof t.horiz_trans_lim.min||"number"!=typeof t.horiz_trans_lim.max||t.horiz_trans_lim.min>t.horiz_trans_lim.max))_.error("hover_setup(): Wrong horizontal translation limits object");else if(t.vert_trans_lim&&("number"!=typeof t.vert_trans_lim.min||"number"!=typeof t.vert_trans_lim.max||t.vert_trans_lim.min>t.vert_trans_lim.max))_.error("hover_setup(): Wrong vertical translation limits object");else{r.wipe_move_style(e),e.render.move_style=r.MS_HOVER_CONTROLS;var n=t.pos||jm(e.render.world_tsr,c);r.setup_hover_model(e,n,t.pivot,t.dist_lim,t.hover_angle_lim,t.horiz_trans_lim,t.vert_trans_lim,t.enable_horiz_rot||!1),s.update_transform(e),o.sync_transform(e),r.init_ortho_props(e)}}else _.error("hover_setup(): Wrong camera object")},t.hover_rotate=function(e,n,a,o){_.error_deprecated("hover_rotate","rotate_camera"),r.is_hover_camera(e)?t.rotate_camera(e,n,a,o=o||!1):_.error("hover_rotate(): Wrong camera object or camera move style")},t.hover_set_pivot_translation=function(e,t){r.is_hover_camera(e)?(r.set_hover_pivot(e,t),s.update_transform(e),o.sync_transform(e)):_.error("hover_set_pivot_translation(): Wrong camera object or camera move style")},t.hover_get_pivot=function(e,t){return r.is_hover_camera(e)?(t=t||new Float32Array(3),ch(e.render.hover_pivot,t),t):(_.error("hover_get_pivot(): Wrong camera object or camera move style"),null)},t.hover_get_distance=function(e){return r.is_hover_camera(e)?s.obj_point_distance(e,e.render.hover_pivot):(_.error("hover_get_distance(): Wrong camera object or camera move style"),0)},t.hover_set_vertical_limits=function(e,t){r.is_hover_camera(e)?"number"!=typeof t.down||"number"!=typeof t.up||t.down<t.up?_.error("hover_set_vertical_limits(): Wrong limits object"):(r.hover_set_vertical_limits(e,t),s.update_transform(e),o.sync_transform(e)):_.error("hover_set_vertical_limits(): Wrong camera object or camera move style")},t.hover_get_vertical_limits=function(e,t){if(!r.is_hover_camera(e))return _.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var n=e.render;return(t=t||{}).down=n.vertical_limits.down,t.up=n.vertical_limits.up,t},t.hover_set_distance_limits=function(e,t){r.is_hover_camera(e)?"number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max?_.error("hover_set_distance_limits(): Wrong limits object"):(t.min=Math.max(t.min,0),t.max=Math.max(t.max,0),r.hover_set_distance_limits(e,t),s.update_transform(e),o.sync_transform(e)):_.error("hover_set_distance_limits(): Wrong camera object or camera move style")},t.hover_get_distance_limits=function(e,t){if(!r.is_hover_camera(e))return _.error("hover_get_distance_limits(): Wrong camera object or camera move style"),null;var n=e.render;return(t=t||{}).min=n.distance_limits.min,t.max=n.distance_limits.max,t},t.hover_set_vert_trans_limits=function(e,t){r.is_hover_camera(e)?t&&("number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max)?_.error("hover_set_vert_trans_limits(): Wrong limits object"):(r.set_vert_trans_limits(e,t),s.update_transform(e),o.sync_transform(e)):_.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")},t.hover_get_vert_trans_limits=function(e,t){if(!r.is_hover_camera(e))return _.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),null;var n=e.render;return n.hover_vert_trans_limits?((t=t||{}).min=n.hover_vert_trans_limits.min,t.max=n.hover_vert_trans_limits.max,t):null},t.hover_set_horiz_trans_limits=function(e,t){r.is_hover_camera(e)?t&&("number"!=typeof t.min||"number"!=typeof t.max||t.min>t.max)?_.error("hover_set_horiz_trans_limits(): Wrong limits object"):(r.set_hor_trans_limits(e,t),s.update_transform(e),o.sync_transform(e)):_.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")},t.hover_get_horiz_trans_limits=function(e,t){if(!r.is_hover_camera(e))return _.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),null;var n=e.render;return n.hover_horiz_trans_limits?((t=t||{}).min=n.hover_horiz_trans_limits.min,t.max=n.hover_horiz_trans_limits.max,t):null},t.hover_switch_horiz_rotation=function(e,t){if(!r.is_hover_camera(e))return _.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;e.render.enable_hover_hor_rotation=t},t.is_static_camera=r.is_static_camera,t.is_target_camera=r.is_target_camera,t.is_eye_camera=r.is_eye_camera,t.is_hover_camera=r.is_hover_camera,t.get_move_style=function(e){return a.is_camera(e)?r.get_move_style(e):(_.error("get_move_style(): Wrong camera object"),null)},t.set_translation=function(e,t){if(a.is_camera(e)){var n=e.render;r.is_target_camera(e)?uh(dh(t,jm(n.world_tsr,c),c),n.pivot,n.pivot):r.is_hover_camera(e)&&uh(dh(t,jm(n.world_tsr,c),c),n.hover_pivot,n.hover_pivot),s.set_translation(e,t),s.update_transform(e),o.sync_transform(e)}else _.error("set_translation(): Wrong camera object")},t.get_translation=function(e,t){return a.is_camera(e)?(t=t||new Float32Array(3),s.get_translation(e,t)):(_.error("get_translation(): Wrong camera object"),null)},t.rotate_camera=function(e,t,n,i){a.is_camera(e)?((i=i||!1)?r.set_rotation_angles(e,t,n):r.rotate_angles(e,t,n),s.update_transform(e),o.sync_transform(e)):_.error("rotate_camera(): Wrong camera object")},t.set_velocities=function(e,t){if(a.is_camera(e)){var r=e.render;"number"==typeof t.trans&&(r.velocity_trans=xO(t.trans,0,1/0)),"number"==typeof t.rot&&(r.velocity_rot=xO(t.rot,0,1/0)),"number"==typeof t.zoom&&(r.velocity_zoom=xO(t.zoom,0,.99))}else _.error("set_velocities(): Wrong camera object")},t.get_velocities=function(e,t){if(!a.is_camera(e))return _.error("get_velocities(): Wrong camera object"),null;var r=e.render;return(t=t||{}).trans=r.velocity_trans,t.rot=r.velocity_rot,t.zoom=r.velocity_zoom,t},t.is_look_up=function(e){return a.is_camera(e)?_O(Vm(e.render.world_tsr,u),Fg,c)[1]>=0:(_.error("is_look_up(): Wrong camera object"),!1)},t.get_camera_angles=function(e,t){return a.is_camera(e)?(t=t||new Float32Array(2),r.get_camera_angles(e,t),t):(_.error("get_camera_angles(): Wrong camera object"),null)},t.get_camera_angles_char=function(e,t){return a.is_camera(e)?(t=t||new Float32Array(2),r.get_camera_angles_char(e,t),t):(_.error("get_camera_angles_char(): Wrong camera object"),null)},t.get_camera_angles_dir=function(e,t){t=t||new Float32Array(2);var n=Rh(e,c),a=tN(Fg,n,u);return FO(a,!0),r.get_camera_angles_from_quat(a,Ug,t),t},t.set_stereo_distance=function(e,t){if(a.is_camera(e))for(var n=i.get_active(),o=a.get_scene_data(e,n).cameras,s=0;s<o.length;s++){var l=o[s];l.type!=r.TYPE_STEREO_LEFT&&l.type!=r.TYPE_STEREO_RIGHT&&l.type!=r.TYPE_HMD_LEFT&&l.type!=r.TYPE_HMD_RIGHT||r.set_stereo_params(l,t,l.stereo_eye_dist)}else _.error("set_stereo_distance(): Wrong camera object")},t.get_stereo_distance=function(e){if(!a.is_camera(e))return _.error("get_stereo_distance(): Wrong camera object"),0;for(var t=i.get_active(),n=a.get_scene_data(e,t).cameras,o=0;o<n.length;o++){var s=n[o];if(s.type==r.TYPE_STEREO_LEFT||s.type==r.TYPE_STEREO_RIGHT)return s.stereo_conv_dist}return 0},t.set_eye_distance=function(e,t){if(a.is_camera(e)){var n=i.get_active(),o=a.get_scene_data(e,n);r.set_eye_distance(o.cameras,t)}else _.error("set_eye_distance(): Wrong camera object")},t.get_eye_distance=function(e){if(!a.is_camera(e))return _.error("get_eye_distance(): Wrong camera object"),0;for(var t=i.get_active(),n=a.get_scene_data(e,t).cameras,o=0;o<n.length;o++){var s=n[o];if(s.type==r.TYPE_STEREO_LEFT||s.type==r.TYPE_STEREO_RIGHT||s.type==r.TYPE_HMD_LEFT||s.type==r.TYPE_HMD_RIGHT)return s.stereo_eye_dist}return 0},t.set_vertical_axis=function(e,t){a.is_camera(e)?(ch(t,e.render.vertical_axis),s.update_transform(e),o.sync_transform(e)):_.error("set_vertical_axis(): Wrong camera object")},t.get_vertical_axis=function(e,t){if(a.is_camera(e))return t||(t=ih()),ch(e.render.vertical_axis,t),t;_.error("get_vertical_axis(): Wrong camera object")},t.translate_view=function(e,t,n,o){if(a.is_camera(e))for(var s=i.get_active(),l=a.get_scene_data(e,s).cameras,c=0;c<l.length;c++){var E=l[c];Eh(-t,-n,0,E.view_transform_params.trans),E.reflection_plane?r.set_projection_reflect(E,!1):r.set_projection(E,!1)}else _.error("translate_view(): Wrong camera object")},t.get_view_vector=f,t.get_fov=function(e){if(!a.is_camera(e))return _.error("get_fov(): Wrong camera object"),0;var t=i.get_active(),n=a.get_scene_data(e,t);return r.get_fov(n.cameras[0])},t.set_fov=function(e,t){if(a.is_camera(e))for(var n=i.get_active(),o=a.get_scene_data(e,n).cameras,s=0;s<o.length;s++){var l=o[s];r.set_fov(l,t),l.reflection_plane?r.set_projection_reflect(l,!1):r.set_projection(l,!1)}else _.error("set_fov(): Wrong camera object")},t.set_hmd_fov=function(e,t,r){_.error_once("set_hmd_fov() deprecated")},t.correct_up=function(e,t,n){a.is_camera(e)?(r.correct_up(e,t=t||e.render.vertical_axis,n||!1),s.update_transform(e),o.sync_transform(e)):_.error("correct_up(): Wrong camera object")},t.set_ortho_scale=function(e,t){if(a.is_camera(e)&&r.is_ortho_camera(e)){var n=e.render;if(r.is_target_camera(e)){var o=hh(jm(n.world_tsr,c),n.pivot);n.init_fov=t/2*n.init_dist/o}else if(r.is_hover_camera(e))o=hh(jm(n.world_tsr,c),n.hover_pivot),n.init_fov=t/2*n.init_dist/o;else{var s=i.get_active();a.get_scene_data(e,s).cameras[0].fov=t/2}r.update_ortho_scale(e)}else _.error("set_ortho_scale(): Wrong camera object")},t.get_ortho_scale=function(e){if(!a.is_camera(e)||!r.is_ortho_camera(e))return _.error("get_ortho_scale(): Wrong camera object"),0;var t=i.get_active();return 2*a.get_scene_data(e,t).cameras[0].fov},t.is_ortho_camera=function(e){return a.is_camera(e)?r.is_ortho_camera(e):(_.error("is_ortho_camera(): Wrong camera object"),!1)},t.calc_ray=function(e,t,o,d){if(!a.is_camera(e))return _.error("calc_ray(): Wrong camera object"),null;var T=i.get_active(),f=a.get_scene_data(e,T).cameras[0];switch(d&&3==d.length?_.error_once('dest parameter in the function "calc_ray" should be type of parametric line.'):d=d||new Float32Array(6),f.type){case r.TYPE_PERSP:case r.TYPE_PERSP_ASPECT:case r.TYPE_STEREO_LEFT:case r.TYPE_STEREO_RIGHT:var p=Math.tan(r.get_vfov(f)/2),P=p*f.aspect,S=c,A=n.canvas_to_viewport_coords(t,o,l,f);return S[0]=(2*A[0]/f.width-1)*P,S[1]=(1-2*A[1]/f.height)*p,S[2]=-1,_g(S,e.render.world_tsr,S),Rh(S,S),3==d.length?ch(S,d):(Wh(d,s.get_translation(e,E)),Jh(d,S)),d;case r.TYPE_ORTHO:S=c,A=n.canvas_to_viewport_coords(t,o,l,f),S[0]=(2*A[0]/f.width-1)*f.top*f.aspect,S[1]=(1-2*A[1]/f.height)*f.top,S[2]=0,rg(S,e.render.world_tsr,S),ch(S,d);var h=Vm(e.render.world_tsr,u);return wh(Fg,h,S),Jh(d,S),d;default:return _.error("calc_ray(): Non-compatible camera"),d}},t.project_point=function(e,t,n){return a.is_camera(e)?(n=n||new Float32Array(2),r.project_point(e,t,n)):(_.error("project_point(): Wrong camera object"),null)},t.has_distance_limits=function(e){return(r.is_target_camera(e)||r.is_hover_camera(e))&&null!==e.render.distance_limits},t.has_vertical_rot_limits=function(e){return(r.is_eye_camera(e)||r.is_target_camera(e)||r.is_hover_camera(e))&&null!==e.render.vertical_limits},t.has_horizontal_rot_limits=function(e){return(r.is_target_camera(e)||r.is_eye_camera(e))&&null!==e.render.horizontal_limits},t.has_vertical_trans_limits=function(e){return r.is_hover_camera(e)&&null!==e.render.hover_vert_trans_limits},t.has_horizontal_trans_limits=function(e){return r.is_hover_camera(e)&&null!==e.render.hover_horiz_trans_limits},t.get_frustum_planes=function(e,t){if(!a.is_camera(e))return _.error("get_frustum_planes(): Wrong camera object"),null;var r=i.get_active(),n=a.get_scene_data(e,r).cameras[0].frustum_planes;return Bv(n.left,t.left),Bv(n.right,t.right),Bv(n.top,t.top),Bv(n.bottom,t.bottom),Bv(n.near,t.near),Bv(n.far,t.far),t},t.set_projection=function(e,t){a.is_camera(e)?r.set_proj_mat(e,t):_.error("set_projection(): Wrong camera object")}})),Sb=nA("__context",(function(e,t){var r=null;t.setup=function(e){r=e},t.get_gl=function(){return r},t.reset=function(){r=null}})),Ab=nA("config",(function(e,t){var r=dR(e),n=jI(e),a=Sb(e),o=Tb(e),_=mN(e);t.P_LOW=r.P_LOW,t.P_HIGH=r.P_HIGH,t.P_ULTRA=r.P_ULTRA,t.P_CUSTOM=r.P_CUSTOM,t.P_AUTO=r.P_AUTO,t.set=r.set,t.get=r.get,t.reset=r.reset,t.reset_limits=r.reset_limits,t.get_std_assets_path=r.get_assets_path,t.get_assets_path=r.get_assets_path,t.apply_quality=function(e){o.is_primary_loaded()?_.error("Cannot change quality profile after a scene is loaded."):(r.set("quality",e),a.get_gl()&&(r.apply_quality(),n.set_hardware_defaults(a.get_gl(),!1)))}})),hb=nA("constraints",(function(e,t){var r=pb(e),n=YI(e),a=PI(e),o=CI(e),_=mN(e),i=MI(e);t.append_stiff=function(e,t,r,s,l){a.is_dynamic(e)?n.check_self_applying(e,t)?n.check_compatibility(e,t)?(r=r||new Float32Array(3),l=l||1,s=s||[0,0,0,1],t instanceof Array&&2==t.length?n.append_stiff_bone(e,t[0],t[1],r,s,l):n.append_stiff_obj(e,t,r,s,l),i.update_transform(e),o.sync_transform(e)):_.error("Constraint recursion is forbidden."):_.error("Can not apply constraint. Object and target must be different."):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_semi_stiff=function(e,t,r,s,l,c,E,u){a.is_dynamic(e)?n.check_self_applying(e,t)?n.check_compatibility(e,t)?(l=jg(l)?l:Math.PI/2,c=jg(c)?c:-Math.PI/2,E=jg(E)?E:Math.PI/2,u=jg(u)?u:-Math.PI/2,r=r||new Float32Array(3),s=s?new Float32Array(s):null,n.append_semi_stiff_obj(e,t,r,s,l,c,E,u),i.update_transform(e),o.sync_transform(e)):_.error("Constraint recursion is forbidden."):_.error("Can not apply constraint. Object and target must be different."):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_semi_stiff_cam=function(e,n,a,o,i,s,l,c){_.error_deprecated("append_semi_stiff_cam","append_semi_stiff"),r.is_eye_camera(e)?t.append_semi_stiff(e,n,a,o,i,s,l,c):_.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")},t.append_semi_soft_cam=function(e,n,a,o){_.error_deprecated("append_semi_soft_cam","append_semi_soft"),r.is_eye_camera(e)?t.append_semi_soft(e,n,a,o):_.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")},t.append_semi_soft=function(e,t,r,s){a.is_dynamic(e)?n.check_self_applying(e,t)?n.check_compatibility(e,t)?((!jg(s)||s<0)&&(s=.25),r=r||new Float32Array(3),n.append_semi_soft_obj(e,t,r,s),i.update_transform(e),o.sync_transform(e)):_.error("Constraint recursion is forbidden."):_.error("Can not apply constraint. Object and target must be different."):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_stiff_trans=function(e,t,r){a.is_dynamic(e)?n.check_self_applying(e,t)?n.check_compatibility(e,t)?(r=r||new Float32Array(3),n.append_stiff_trans_obj(e,t,r),i.update_transform(e),o.sync_transform(e)):_.error("Constraint recursion is forbidden."):_.error("Can not apply constraint. Object and target must be different."):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_copy_loc=function(e,t,r,s,l){if(a.is_dynamic(e))if(n.check_self_applying(e,t))if(n.check_compatibility(e,t)){s=s||!1,r=r||"XYZ",l=l||1;var c=i.get_translation(e,new Float32Array(3)),E=new Float32Array(3);E[0]=-1!=r.indexOf("-X")?-1:-1!=r.indexOf("X")?1:0,E[1]=-1!=r.indexOf("-Y")?-1:-1!=r.indexOf("Y")?1:0,E[2]=-1!=r.indexOf("-Z")?-1:-1!=r.indexOf("Z")?1:0,n.append_copy_loc_obj(e,t,c,E,s,l),i.update_transform(e),o.sync_transform(e)}else _.error("Constraint recursion is forbidden.");else _.error("Can not apply constraint. Object and target must be different.");else _.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_copy_trans=function(e,t,r){a.is_dynamic(e)?n.check_self_applying(e,t)?n.check_compatibility(e,t)?(n.append_copy_trans_obj(e,t,r=r||1),i.update_transform(e),o.sync_transform(e)):_.error("Constraint recursion is forbidden."):_.error("Can not apply constraint. Object and target must be different."):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_copy_rot=function(e,t,r,s,l){if(a.is_dynamic(e))if(n.check_self_applying(e,t))if(n.check_compatibility(e,t)){s=s||!1,r=r||"XYZ",l=l||1;var c=new Float32Array(3);c[0]=-1!=r.indexOf("-X")?-1:-1!=r.indexOf("X")?1:0,c[1]=-1!=r.indexOf("-Y")?-1:-1!=r.indexOf("Y")?1:0,c[2]=-1!=r.indexOf("-Z")?-1:-1!=r.indexOf("Z")?1:0,n.append_copy_rot_obj(e,t,c,s,l),i.update_transform(e),o.sync_transform(e)}else _.error("Constraint recursion is forbidden.");else _.error("Can not apply constraint. Object and target must be different.");else _.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_stiff_trans_rot=function(e,t,r,s){a.is_dynamic(e)?n.check_self_applying(e,t)?n.check_compatibility(e,t)?(r=r||new Float32Array(3),s=s?new Float32Array(s):[0,0,0,1],n.append_stiff_trans_rot_obj(e,t,r,s,1),i.update_transform(e),o.sync_transform(e)):_.error("Constraint recursion is forbidden."):_.error("Can not apply constraint. Object and target must be different."):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_track=function(e,t,r,s,l,c){if(a.is_dynamic(e))if(n.check_self_applying(e,t))if(n.check_compatibility(e,t)){var E=wg;"-Y"==r?E=Dg:"Y"==r?E=wg:"-X"==r?E=kg:"X"==r?E=Cg:"-Z"==r?E=Fg:"Z"==r&&(E=Ug);var u=Ug;"X"==s?u=Cg:"Y"==s&&(u=wg),1!=Math.abs(Ih(E,u))?(n.append_track_obj(e,t,E,u,l=l||!1,c=c||1),i.update_transform(e),o.sync_transform(e)):_.error("Can not use parallel vectors for track and up axes.")}else _.error("Constraint recursion is forbidden.");else _.error("Can not apply constraint. Object and target must be different.");else _.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_follow=function(e,t,r,s){a.is_dynamic(e)?n.check_self_applying(e,t)?n.check_compatibility(e,t)?(n.append_follow_obj(e,t,r,s),i.update_transform(e),o.sync_transform(e)):_.error("Constraint recursion is forbidden."):_.error("Can not apply constraint. Object and target must be different."):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.append_stiff_viewport=function(e,t,r){a.is_dynamic(e)?n.check_self_applying(e,t)?n.check_compatibility(e,t)?(n.append_stiff_viewport(e,t,r=r||{}),i.update_transform(e),o.sync_transform(e)):_.error("Constraint recursion is forbidden."):_.error("Can not apply constraint. Object and target must be different."):_.error('Wrong object: "'+e.name+'" is not dynamic.')},t.remove=function(e,t){t=t||!1,e.constraint&&n.remove(e,t),t&&i.update_transform(e)}})),vb=nA("container",(function(e,t){var r=fb(e),n=mN(e);t.get_canvas=r.get_canvas,t.get_canvas_hud=r.get_canvas_hud,t.get_container=r.get_container,t.insert_to_container=function(e,t){2==arguments.length?e&&t&&r.insert_to_container(e,t):n.error("insert_to_container(): two arguments required")},t.set_canvas_offsets=function(e,t){return n.error_once("container.set_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method."),r.set_canvas_offsets(e,t)},t.update_canvas_offsets=function(){n.error_once("container.update_canvas_offsets() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method."),r.update_canvas_offsets()},t.client_to_canvas_coords=function(e,t,n){return n||(n=new Float32Array(2)),r.client_to_canvas_coords(e,t,n)},t.client_to_element_coords=function(e,t,n,a){return a||(a=new Float32Array(2)),r.client_to_element_coords(e,t,n,a)},t.get_coords_target_space=function(e,t,n){return n||(n=new Float32Array(2)),r.get_coords_target_space(e,t,n)},t.force_offsets_updating=function(){n.error_once("container.force_offsets_updating() deprecated. Not needed anymore. Use the container.client_to_canvas_coords method."),r.force_offsets_updating()},t.resize=function(e,t,n){r.resize(e,t,n)},t.resize_to_container=function(e){r.resize_to_container(e=e||!1)}})),mb=nA("controls",(function(e,t){var r=$I(e),n=CI(e),a=mN(e);t.CT_POSITIVE=r.CT_POSITIVE,t.CT_CONTINUOUS=r.CT_CONTINUOUS,t.CT_TRIGGER=r.CT_TRIGGER,t.CT_SHOT=r.CT_SHOT,t.CT_LEVEL=r.CT_LEVEL,t.CT_CHANGE=r.CT_CHANGE,t.KEY_BACKSPACE=8,t.KEY_TAB=9,t.KEY_ENTER=13,t.KEY_SHIFT=16,t.KEY_CTRL=17,t.KEY_ALT=18,t.KEY_PAUSE=19,t.KEY_CAPSLOCK=20,t.KEY_ESC=27,t.KEY_SPACE=32,t.KEY_LEFT=37,t.KEY_UP=38,t.KEY_RIGHT=39,t.KEY_DOWN=40,t.KEY_1=49,t.KEY_2=50,t.KEY_3=51,t.KEY_4=52,t.KEY_5=53,t.KEY_6=54,t.KEY_7=55,t.KEY_8=56,t.KEY_9=57,t.KEY_A=65,t.KEY_B=66,t.KEY_C=67,t.KEY_D=68,t.KEY_E=69,t.KEY_F=70,t.KEY_G=71,t.KEY_H=72,t.KEY_I=73,t.KEY_J=74,t.KEY_K=75,t.KEY_L=76,t.KEY_M=77,t.KEY_N=78,t.KEY_O=79,t.KEY_P=80,t.KEY_Q=81,t.KEY_R=82,t.KEY_S=83,t.KEY_T=84,t.KEY_U=85,t.KEY_V=86,t.KEY_W=87,t.KEY_X=88,t.KEY_Y=89,t.KEY_Z=90,t.KEY_NUM0=96,t.KEY_NUM1=97,t.KEY_NUM2=98,t.KEY_NUM3=99,t.KEY_NUM4=100,t.KEY_NUM5=101,t.KEY_NUM6=102,t.KEY_NUM7=103,t.KEY_NUM8=104,t.KEY_NUM9=105,t.KEY_MULT=106,t.KEY_ADD=107,t.KEY_SUB=109,t.KEY_DEC_POINT=110,t.KEY_DIV=111,t.KEY_SEMI_COLON=186,t.KEY_EQUAL_SIGN=187,t.KEY_COMMA=188,t.KEY_DASH=189,t.KEY_PERIOD=190,t.KEY_FORWARD_SLASH=191,t.KEY_GRAVE_ACCENT=192,t.KEY_LEFT_SQ_BRACKET=219,t.KEY_BACK_SLASH=220,t.KEY_RIGHT_SQ_BRACKET=221,t.KEY_SINGLE_QUOTE=222,t.PL_SINGLE_TOUCH_MOVE=r.PL_SINGLE_TOUCH_MOVE,t.PL_MULTITOUCH_MOVE_ZOOM=r.PL_MULTITOUCH_MOVE_ZOOM,t.PL_MULTITOUCH_MOVE_PAN=r.PL_MULTITOUCH_MOVE_PAN,t.PL_MULTITOUCH_MOVE_ROTATE=r.PL_MULTITOUCH_MOVE_ROTATE,t.default_AND_logic_fun=r.default_AND_logic_fun,t.default_OR_logic_fun=r.default_OR_logic_fun,t.create_gamepad_btn_sensor=r.create_gamepad_btn_sensor,t.create_gamepad_axis_sensor=r.create_gamepad_axis_sensor,t.create_gamepad_position_sensor=r.create_gamepad_position_sensor,t.create_gamepad_orientation_sensor=r.create_gamepad_orientation_sensor,t.create_custom_sensor=r.create_custom_sensor,t.create_keyboard_sensor=r.create_keyboard_sensor,t.create_collision_sensor=function(e,t,n){return r.create_collision_sensor(e,t=t||"ANY",n=n||!1)},t.create_collision_impulse_sensor=r.create_collision_impulse_sensor,t.create_ray_sensor=function(e,t,o,_,i,s,l){if(!e||n.obj_has_physics(e))return r.create_ray_sensor(e,t,o,_=_||"ANY",i=i||!1,s=s||!1,l=l||!1);a.error_once("No physics for object "+e.name)},t.create_mouse_click_sensor=r.create_mouse_click_sensor,t.create_mouse_wheel_sensor=r.create_mouse_wheel_sensor,t.create_mouse_move_sensor=r.create_mouse_move_sensor,t.create_plock_mouse_sensor=r.create_plock_mouse_sensor,t.create_plock_sensor=r.create_plock_sensor,t.create_touch_move_sensor=r.create_touch_move_sensor,t.create_touch_zoom_sensor=r.create_touch_zoom_sensor,t.create_touch_rotate_sensor=r.create_touch_rotate_sensor,t.create_touch_click_sensor=r.create_touch_click_sensor,t.create_motion_sensor=r.create_motion_sensor,t.create_vertical_velocity_sensor=r.create_vertical_velocity_sensor,t.create_gyro_angles_sensor=r.create_gyro_angles_sensor,t.create_gyro_quat_sensor=r.create_gyro_quat_sensor,t.create_gyro_delta_sensor=r.create_gyro_delta_sensor,t.create_hmd_quat_sensor=r.create_hmd_quat_sensor,t.create_hmd_position_sensor=r.create_hmd_position_sensor,t.create_timer_sensor=function(e,t){return r.create_timer_sensor(e,t||!1)},t.reset_timer_sensor=r.reset_timer_sensor,t.create_elapsed_sensor=r.create_elapsed_sensor,t.create_timeline_sensor=r.create_timeline_sensor,t.create_selection_sensor=function(e,t){return r.create_selection_sensor(e,t||!1)},t.create_callback_sensor=function(e,t){return r.create_callback_sensor(e,t||0)},t.set_custom_sensor=function(e,t){r.sensor_set_value(e,t)},t.get_custom_sensor=function(e){return e.value},t.get_sensor_value=r.get_sensor_value,t.get_sensor_payload=r.get_sensor_payload,t.create_sensor_manifold=function(e,t,n,a,o,_,i){r.create_sensor_manifold(e,t,n,a,o=o||r.default_AND_logic_fun,_,i=void 0===i?null:i)},t.create_kb_sensor_manifold=function(e,t,n,a,o,_){var i=r.create_keyboard_sensor(a);r.create_sensor_manifold(e,t,n,[i],r.default_AND_logic_fun,o,_=void 0===_?null:_)},t.check_sensor_manifolds=function(e){return r.check_sensor_manifold(e,null)},t.check_sensor_manifold=r.check_sensor_manifold,t.remove_sensor_manifold=r.remove_sensor_manifold,t.reset=r.reset,t.set_plock_smooth_factor=r.set_plock_smooth_factor})),gb=nA("data",(function(e,t){var r=Tb(e),n=eb(e);t.load=r.load,t.unload=function(e){r.unload(e|=0)},t.set_debug_resources_root=r.set_debug_resources_root,t.is_primary_loaded=r.is_primary_loaded,t.is_idle=n.is_finished,t.load_and_add_new=r.load,t.cleanup=t.unload,t.activate_media=r.activate_media,t.prefetch=r.prefetch,t.unfetch=r.unfetch})),Ob=nA("__debug_batch",(function(e,t){var r=JI(e),n=mN(e),a=KI(e),o=LI(e);function _(e,t,r){var a=[];for(var o in e)jO(e[o])>1&&a.push([o,e[o]]);if(a.sort((function(e,t){var r=jO(e[1]),n=jO(t[1]);return n!=r?n-r:e<t?-1:t<e?1:0})),a.length){n.groupCollapsed(t+" "+r),n.log_raw("Property different variants (>1) | Property name");for(var _=0;_<a.length;_++)n.groupCollapsed(jO(a[_][1]),a[_][0]),i(a[_][1]);n.groupEnd()}}function i(e){n.log_raw("Batches count for this property value | Property value");var t=[];for(var r in e)t.push([r,e[r]]);t.sort((function(e,t){return t[1]!=e[1]?t[1]-e[1]:e[0]<t[0]?-1:t[0]<e[0]?1:0}));for(var a=0;a<t.length;a++)n.log_raw(t[a][1],t[a][0]);n.groupEnd()}t.print_batches_stat=function(){for(var e={},t=["bounds_local","bufs_data","id","attribute_setters","num_vertices","num_triangles","material_names","shader","bpy_tex_names"],i=0,s=0,l=a.get_scene_objs(o.get_main(),"MESH",a.DATA_ID_ALL),c=0;c<l.length;c++)for(var E=0;E<l[c].scenes_data.length;E++)for(var u=0;u<l[c].scenes_data[E].batches.length;u++){var d=r.clone_batch(l[c].scenes_data[E].batches[u]),T=d.shaders_info.vert+"/"+d.shaders_info.frag;d["shaders_info.directives"]=d.shaders_info.directives,d["shaders_info.node_elements"]=d.shaders_info.node_elements,delete d.shaders_info;for(var f=0;f<t.length;f++)delete d[t[f]];if(l[c].is_dynamic)s++;else for(var p in i++,d.type in e||(e[d.type]={}),T in e[d.type]||(e[d.type][T]={}),d){p in e[d.type][T]||(e[d.type][T][p]={});var P=JSON.stringify(d[p]);P in e[d.type][T][p]||(e[d.type][T][p][P]=0),e[d.type][T][p][P]++}}for(var S in n.group("Batches statistics:"),n.log_raw("STATIC/DYNAMIC count:",i+"/"+s),n.group("STATIC batches diversity:"),e)for(var T in e[S])_(e[S][T],S,T);n.groupEnd(),n.groupEnd()}})),Nb=nA("debug",(function(e,t){var r=gN(e),n=JI(e),a=dR(e),o=jI(e),_=$I(e),i=fb(e),s=Sb(e),l=Tb(e),c=hR(e),E=Ob(e),u=HI(e),d=vR(e),T=AI(e),f=gR(e),p=fR(e),P=VR(e),S=eb(e),A=KI(e),h=PI(e),v=CI(e),m=mN(e),g=tI(e),O=LI(e),N=bI(e),R=yI(e),I=qI(e),b=mR(e),y=AR(e),L=XI(e),Y=MI(e),M=wm(),x=new Float32Array(2),C=ih(),w=ih(),U=ih(),k=null,D=a.defaults,F=[],G="",K="",B=!1,X=!1,H=!0,j=new Uint8Array(4);function z(e,t,r,n){m.group(b.subs_label(e),n);for(var a=0;a<r.length;a++){var o=r[a],_=o.render;if(_.type==n)for(var i=!1,s=0;s<t.length;s++){for(var l=t[s].bundles,c=0;c<l.length;c++){var E=l[c];if(E.do_render&&E.obj_render==_){m.log_raw("STATIC"==n?o.origin_name:o.name,o),i=!0;break}}if(i)break}}m.groupEnd()}function Q(e,t){var r=p.get_debug_shaders();if(r){var n=r.getTranslatedShaderSource(e),a=r.getTranslatedShaderSource(t);if(o.detect_mobile()){n=n.replace("#version","#version 300 //"),a=a.replace("#version","#version 300 //");var _=q("/analyze_shader/vert_gles",n),i=q("/analyze_shader/frag_gles",a)}else n=n.replace("#version","#version 400 //"),a=a.replace("#version","#version 400 //"),_=q("/analyze_shader/vert",n),i=q("/analyze_shader/frag",a);var l=V(_),c=V(i);return{vsrc:s.get_gl().getShaderSource(e),vsrc_trans:n,vout:_,vstats:l,fsrc:s.get_gl().getShaderSource(t),fsrc_trans:a,fout:i,fstats:c}}m.warn("WEBGL_debug_shaders extension not found")}function V(e){var t={};if(!e)return t;for(var r=e.split("\n"),n=0;n<r.length;n++){var a=r[n];-1!=a.search(new RegExp(/^[A-Z.]+ ?/))&&((s=a.split(" ")[0])in t||(t[s]=0),t[s]++)}var o=0,_=0,i=0;for(var s in t)switch(s){case"KIL":case"TEX":case"TXB":case"TXP":case"KIL.F":case"TEX.F":case"TXB.F":case"TXD.F":case"TXL.F":case"TXQ.F":case"TXP.F":_+=t[s],o+=t[s];break;case"ATTRIB":i+=t[s];break;case"ADDRESS":case"PARAM":case"TEMP":case"ALIAS":case"OUTPUT":case"END":break;default:o+=t[s]}return t.ALL_OPS=o,t.TEX_OPS=_,t.ATTRIBS=i,t}function q(e,t){var r=new XMLHttpRequest;if(r.open("POST",e,!1),r.send(t),200==r.status)return r.responseText;throw m.error(r.responseText),"Error POST XHR: "+r.status}function W(e){e.sort((function(e,t){return t.fstats.ALL_OPS-e.fstats.ALL_OPS}));for(var t=0;t<e.length;t++){var r=e[t],n=r.fstats,a=r.vstats,o=J(r.cshader);o=o.length?"\t\t("+o.join(", ")+")":"\t\t(NA)",m.groupCollapsed("VERT ->","OPS",a.ALL_OPS,"ATT",a.ATTRIBS,"TEX",a.TEX_OPS,"\t\tFRAG ->","OPS",n.ALL_OPS,"TEX",n.TEX_OPS,o),m.groupCollapsed("directives");for(var _=r.shaders_info.directives.slice().sort(),i=0;i<_.length;i++){var s=_[i];m.log_raw(s[0],s[1])}m.groupEnd(),m.groupCollapsed("node elements");var l=r.shaders_info.node_elements;for(i=0;i<l.length;i++)m.log_raw(l[i]);m.groupEnd(),m.groupCollapsed("vert source"),m.log_raw(r.vsrc),m.groupEnd(),m.groupCollapsed("vert translated source"),m.log_raw(r.vsrc_trans),m.groupEnd();var c=["ALL_OPS","TEX_OPS","ATTRIBS"];for(var E in m.groupCollapsed("vert ops stats"),a)-1==c.indexOf(E)&&m.log_raw(E,a[E]);for(var E in m.groupEnd(),m.groupCollapsed("vert assembly"),m.log_raw(r.vout),m.groupEnd(),m.groupCollapsed("frag source"),m.log_raw(r.fsrc),m.groupEnd(),m.groupCollapsed("frag translated source"),m.log_raw(r.fsrc_trans),m.groupEnd(),m.groupCollapsed("frag ops stats"),n)-1==c.indexOf(E)&&m.log_raw(E,n[E]);m.groupEnd(),m.groupCollapsed("frag assembly"),m.log_raw(r.fout),m.groupEnd(),m.groupEnd()}}function J(e){for(var t=[],r=O.get_all_scenes(),n=0;n<r.length;n++)for(var a=r[n],o=A.get_scene_objs(a,"MESH",A.DATA_ID_ALL),_=0;_<o.length;_++){var i=h.get_scene_data(o[_],a);if(i&&i.batches.length)for(var s=i.batches,l=0;l<s.length;l++){var c=s[l];if(c.shader==e)for(var E=0;E<c.material_names.length;E++){var u=c.material_names[E];-1==t.indexOf(u)&&t.push(u)}}}return t}function Z(e,t){return function t(){return F.push(t),e.apply(e,arguments)}}function $(e,t,r,n,a){if(typeof t!=typeof e)throw"debug.eqv: wrong expected data type";if(e.length!=t.length)throw"debug.eqv: wrong expected vector length";r=r||1e-6;for(var o=0;o<e.length;o++){if("number"!=typeof t[o]||isNaN(t[o]))throw"debug.eqv: wrong expected data type";if("number"!=typeof e[o]||isNaN(e[o]))throw"debug.eqv: wrong result data type";if(t[o]>e[o]+r||t[o]<e[o]-r)throw"debug.eqv: wrong result"}ee(n,a,"eqv")}function ee(e,t,r){if(e=e||"",t=t||"",X){if(""==e)throw"debug."+r+': no error is expected, but got "'+K+'"';if(K!=e)throw"debug."+r+': error "'+e+'" is expected, but got "'+K+'"'}else if(""!=e)throw"debug."+r+': error "'+e+'" is expected, but got nothing';if(B){if(""==t)throw"debug."+r+': no warning is expected, but got "'+G+'"';if(G!=t)throw"debug."+r+': warning "'+t+'" is expected, but got "'+G+'"'}else if(""!=t)throw"debug."+r+': warning "'+t+'" is expected, but got nothing';B=!1,X=!1}function te(){k&&(A.obj_switch_cleanup_flags(k,!1,!1,!1),l.prepare_object_unloading(k),A.obj_switch_cleanup_flags(k,!0,!0,!0),A.remove_object(k),k=null)}t.DV_NONE=d.DV_NONE,t.DV_OPAQUE_WIREFRAME=d.DV_OPAQUE_WIREFRAME,t.DV_TRANSPARENT_WIREFRAME=d.DV_TRANSPARENT_WIREFRAME,t.DV_FRONT_BACK_VIEW=d.DV_FRONT_BACK_VIEW,t.DV_BOUNDINGS=d.DV_BOUNDINGS,t.DV_CLUSTERS_VIEW=d.DV_CLUSTERS_VIEW,t.DV_BATCHES_VIEW=d.DV_BATCHES_VIEW,t.DV_RENDER_TIME=d.DV_RENDER_TIME,t.physics_stats=function(){v.debug_workers()},t.physics_id=function(e){m.log("O",v.find_obj_by_body_id(e));var t=v.get_active_scene();if(t)for(var r=t._physics.bundles,n=0;n<r.length;n++){var a=r[n];a.physics.body_id==e&&m.log("B",a)}else m.error("No active physics scene.")},t.visible_objects=function(){for(var e=O.get_active(),t=A.get_scene_objs(e,"MESH",A.DATA_ID_ALL),r=O.subs_array(e,[b.MAIN_OPAQUE,b.MAIN_BLEND,b.MAIN_GLOW]),n=0;n<r.length;n++){var a=r[n],o=a.draw_data;o.length&&(z(a,o,t,"DYNAMIC"),z(a,o,t,"STATIC"))}},t.object_info=function(e){for(var t=O.get_active(),r=A.get_scene_objs(t,"MESH",A.DATA_ID_ALL),n=0;n<r.length;n++){var a=r[n];if(a.name==e){m.log("Object",a);for(var o=O.get_all_subscenes(t),_=0;_<o.length;_++){for(var i=o[_],s=[],l=i.draw_data,c=0;c<l.length;c++)for(var E=l[c].bundles,u=0;u<E.length;u++)E[u].obj_render==a.render&&s.push(E[u]);m.log("Subscene "+i.type,s)}}}},t.objects_stat=function(){var e=O.get_active();m.log("Armatures: "+A.get_scene_objs(e,"ARMATURE",A.DATA_ID_ALL).length),m.log("Cameras: "+A.get_scene_objs(e,"CAMERA",A.DATA_ID_ALL).length),m.log("Curves: "+A.get_scene_objs(e,"CURVE",A.DATA_ID_ALL).length),m.log("Empties: "+A.get_scene_objs(e,"EMPTY",A.DATA_ID_ALL).length),m.log("Lamps: "+A.get_scene_objs(e,"LAMP",A.DATA_ID_ALL).length),m.log("Meshes: "+A.get_scene_objs(e,"MESH",A.DATA_ID_ALL).length),m.log("Speakers: "+A.get_scene_objs(e,"SPEAKER",A.DATA_ID_ALL).length)},t.num_vertices=function(){for(var e=0,t=O.get_active(),r=O.subs_array(t,[b.MAIN_OPAQUE,b.MAIN_BLEND,b.MAIN_GLOW]),n=0;n<r.length;n++)for(var a=r[n].draw_data,o=0;o<a.length;o++)for(var _=a[o].bundles,i=0;i<_.length;i++){var s=_[i].batch;s&&(e+=s.num_vertices)}return e},t.num_triangles=function(){for(var e=0,t=O.get_active(),r=O.subs_array(t,[b.MAIN_OPAQUE,b.MAIN_BLEND,b.MAIN_GLOW]),n=0;n<r.length;n++)for(var a=r[n].draw_data,o=0;o<a.length;o++)for(var _=a[o].bundles,i=0;i<_.length;i++){var s=_[i].batch;s&&(e+=s.num_triangles)}return e},t.num_draw_calls=function(){for(var e=O.get_active(),t=O.subs_array(e,[b.MAIN_OPAQUE,b.MAIN_BLEND,b.MAIN_GLOW,b.MAIN_PLANE_REFLECT,b.MAIN_PLANE_REFLECT_BLEND]),r=0,n=0;n<t.length;n++)for(var a=t[n].draw_data,o=0;o<a.length;o++)r+=a[o].bundles.length;var _=O.subs_array(e,[b.MAIN_CUBE_REFLECT,b.MAIN_CUBE_REFLECT_BLEND]);for(n=0;n<_.length;n++)for(a=_[n].draw_data,o=0;o<a.length;o++)r+=6*a[o].bundles.length;return r},t.num_shaders=function(){return jO(I.get_compiled_shaders())},t.geometry_stats=function(){for(var e=O.get_active(),t=O.get_all_subscenes(e),r={},n=0;n<t.length;n++){var a=t[n];if(a.type!=b.SINK&&a.type!=b.DEBUG_VIEW)for(var o=a.draw_data,_=0;_<o.length;_++)for(var i=o[_].bundles,s=0;s<i.length;s++){var l=i[s].batch,c=i[s].obj_render;l&&(a.type!=b.COLOR_PICKING&&a.type!=b.OUTLINE_MASK||c.origin_selectable||c.origin_outlining)&&(r[l.id]=l)}}var E=0,u=0;for(var d in r){var T=r[d].bufs_data;T.debug_ibo_bytes&&(u+=T.debug_ibo_bytes/1048576),E+=T.debug_vbo_bytes/1048576}return{vbo_memory:E,ibo_memory:u}},t.num_textures=function(){for(var e=[],t=0,r=O.get_active(),n=O.subs_array(r,[b.MAIN_OPAQUE,b.MAIN_BLEND,b.MAIN_GLOW]),a=0;a<n.length;a++)for(var o=n[a].draw_data,_=0;_<o.length;_++)for(var i=o[_].bundles,s=0;s<i.length;s++){var l=i[s].batch;if(l)for(var c=l.textures,E=0;E<c.length;E++){var u=c[E];if("IMAGE"===u.source||"ENVIRONMENT_MAP"===u.source){var d=u.w_texture;if(-1===e.indexOf(d)){e.push(d);var T=u.width*u.height*4/1048576/u.compress_ratio;t+=T*=1.3333}}}}return{number:e.length,memory:t}},t.num_render_targets=function(){for(var e=[],t=0,r=O.get_active(),n=O.get_all_subscenes(r),a=0;a<n.length;a++){var o=n[a];if(o.type!=b.SINK){var _=o.camera,i=[_.color_attachment,_.depth_attachment];i.push.apply(i,o.textures_internal);for(var s=0;s<i.length;s++){var l=i[s];L.is_texture(l)&&-1==e.indexOf(l)&&(e.push(l),t+=_.width*_.height*L.get_texture_texel_size(l))}}}return{number:e.length,memory:t/1024/1024}},t.make_camera_frustum_shot=function(){var e=O.get_active(),t=O.get_subs(e,b.MAIN_OPAQUE);t&&O.make_frustum_shot(t.camera,t,[1,1,0])},t.make_light_frustum_shot=function(){var e=O.get_active(),t=O.get_subs(e,b.MAIN_OPAQUE),r=O.subs_array(e,[b.SHADOW_CAST]);if(t)for(var n=0;n<r.length;n++){var a,o=r[n];switch(n){case 0:a=[1,0,0];break;case 1:a=[0,1,0];break;case 2:a=[0,0,1];break;default:a=[1,0,1]}O.make_frustum_shot(o.camera,t,a)}},t.scenegraph_to_dot=function(){for(var e=O.get_all_scenes(),t=0;t<e.length;t++){var r=O.get_graph(e[t]);m.log("\n"+N.debug_convert_to_dot(r))}},t.loading_graph_to_dot=function(e){m.log("\n"+S.graph_to_dot(e|=0))},t.controls_info=_.debug,t.object_distance=function(e,t){return hh(jm(e.render.world_tsr,C),jm(t.render.world_tsr,w))},t.msg=function(){T.msg.apply(T,arguments)},t.fbmsg=function(){T.fbmsg.apply(T,arguments)},t.print_telemetry=function(){T.print_telemetry.apply(T,arguments)},t.plot_telemetry=function(){T.plot_telemetry.apply(T,arguments)},t.fbres=function(e,t){t||(t=16);!function r(){T.fbmsg("FBRES",e()),setTimeout(r,t)}()},t.assert_constants=function(){var e=new Float32Array(3),t=new Float32Array([0,0,0,1]),r=new Float32Array([1,0,0]),n=new Float32Array([0,1,0]),a=new Float32Array([0,0,1]),o=new Float32Array([-1,0,0]),_=new Float32Array([0,-1,0]),i=new Float32Array([0,0,-1]);if(!SO(e,Yg))throw"Wrong VEC3_IDENT";if(!SO(t,Mg))throw"Wrong QUAT4_IDENT";if(!SO(r,Cg))throw"Wrong AXIS_X";if(!SO(n,wg))throw"Wrong AXIS_Y";if(!SO(a,Ug))throw"Wrong AXIS_Z";if(!SO(o,kg))throw"Wrong AXIS_MX";if(!SO(_,Dg))throw"Wrong AXIS_MY";if(!SO(i,Fg))throw"Wrong AXIS_MZ"},t.mute_music=function(){for(var e=R.get_speaker_objects(),t=0;t<e.length;t++){var r=e[t];"BACKGROUND_MUSIC"==R.get_spk_behavior(r)&&R.mute(r,!0)}},t.check_finite=function(e){return u.finite(e)},t.set_debug_params=function(e){var t=O.get_active(),r=O.subs_array(t,[b.DEBUG_VIEW]);if(r.length)for(var n=0;n<r.length;n++){var a=r[n];if("number"==typeof e.debug_view_mode)switch(e.debug_view_mode){case d.DV_NONE:case d.DV_OPAQUE_WIREFRAME:case d.DV_TRANSPARENT_WIREFRAME:case d.DV_FRONT_BACK_VIEW:case d.DV_BOUNDINGS:case d.DV_CLUSTERS_VIEW:case d.DV_BATCHES_VIEW:case d.DV_RENDER_TIME:O.set_debug_view_mode(a,e.debug_view_mode);break;default:m.error("set_debug_params(): Wrong debug view mode")}"number"==typeof e.debug_colors_seed&&O.set_debug_colors_seed(a,e.debug_colors_seed),"number"==typeof e.render_time_threshold&&O.set_render_time_threshold(a,e.render_time_threshold),"object"==typeof e.wireframe_edge_color&&O.set_wireframe_edge_color(a,Qg(e.wireframe_edge_color))}else m.error("Debugging is not available on the scene.")},t.get_error_quantity=function(){return m.get_error_count()},t.get_warning_quantity=function(){return m.get_warning_count()},t.clear_errors_warnings=function(){return m.clear_errors_warnings()},t.analyze_shaders=function(e){var t=I.get_compiled_shaders(),r=0;for(var n in t)e&&-1===n.indexOf(e)||r++;var a="of "+r+" analyzing...",o={};for(var n in t)if(!e||-1!==n.indexOf(e)){var _=t[n],i=Q(_.vshader,_.fshader);if(i){var s=_.shaders_info,l=s.vert+" + "+s.frag;i.cshader=_,i.shaders_info=s,(o[l]=o[l]||[]).push(i),m.log_raw(a)}}for(var l in o)m.group("%c"+l,"color: #800"),W(o[l]),m.groupEnd()},t.fake_load=function(e,t,n,a,o){(e=e||null)||r.panic("Stage load callback is undefined"),t=t||5e3,n=n||0,(a=a||100)>100&&r.panic("Max percentage must be less than 100"),n<0&&r.panic("Min percentage must be greater than 0"),n>a&&r.panic("Max percentage must be greater than min percentage");var _=y.animate(n,a,t,(function(t){var r=t.toFixed();if(e(r),100==r)return y.clear_animation(_),void(o&&o())}))},t.test_performance=function(e){if(I.check_shaders_loaded())if(p.get_disjoint_timer_query()){var r=D.gl_debug;D.gl_debug=!0;var n=N.create_performance_graph();O.generate_auxiliary_batches(null,n);for(var a=N.find_subs(n,b.PERFORMANCE),o=a.camera,_=0;_<5;_++)g.draw(a);D.gl_debug=r,window.setTimeout((function(){f.process_timer_queries(a);var t=a.debug_render_time,r=o.width*o.height*4*10/(t/1e3)/Math.pow(10,9);e(t,r)}),100)}else e(0,0);else window.setTimeout((function(){t.test_performance(e)}),100)},t.calc_vbo_garbage_byte_size=c.calc_vbo_garbage_byte_size,t.show_vbo_garbage_info=c.show_vbo_garbage_info,t.print_batches_stat=function(){E.print_batches_stat()},t.start_debug=function(e){for(var t in F=[],H=!0,"string"==typeof e&&(e=tA.require(e)),e)"function"==typeof e[t]&&(e[t]=Z(e[t]))},t.check_debug_result=function(){return H},t.test=function(e,t){var r=m.error,n=m.error_once,a=m.warn;m.error=m.error_once=function(){var e=m.compose_args_prefix(arguments,"B4W ERROR");K=e.join(" "),X=!0},m.warn=function(){var e=m.compose_args_prefix(arguments,"B4W WARN");G=e.join(" "),B=!0},B=!1,X=!1;try{t();var o=!0}catch(YM){H=!1,console.error('Test "'+e+'" failed with exception: "'+YM+'"'),o=!1,B=!1,X=!1}return m.error=r,m.error_once=n,m.warn=a,o},t.pix=function(e){var t=i.get_viewport_width(),n=i.get_viewport_height(),a=t/2,o=n/2;i.resize(t,n,!1);var _=O.get_active(),s=N.find_on_screen(_._render.graph);s||r.panic("Couldn't find onscreen subscene");var l=s.camera,c=i.canvas_to_viewport_coords(a,o,x,s.camera);c[1]=l.height-c[1],$(e,g.read_pixels(l.framebuffer,c[0],c[1],1,1,j),1)},t.eqs=function(e,t,r,n){if(JSON.stringify(e)!=JSON.stringify(t))throw"debug.eqs: wrong result";ee(r,n,"eqs")},t.eqv=$,t.eqf=function(e,t,r,n,a){if("number"!=typeof t||isNaN(t))throw"debug.eqf: wrong expected data type";if("number"!=typeof e||isNaN(e))throw"debug.eqf: wrong result data type";if(t>e+(r=r||1e-6)||t<e-r)throw"debug.eqf: wrong result";ee(n,a,"eqf")},t.eq=function(e,t,r,n){if(e!==t)throw"debug.eq: wrong result";ee(r,n,"eq")},t.ok=function(e,t,r){if(!Boolean(e))throw"debug.ok: wrong result";ee(t,r,"ok")},t.stat=function(e){var t=[];for(var r in"string"==typeof e&&(e=tA.require(e)),e)-1==F.indexOf(e[r])&&"function"==typeof e[r]&&t.push(r);if(t.length){m.groupCollapsed(t.length+" function(s) not tested.");for(var n=0;n<t.length;n++)m.log_raw(t[n]);m.groupEnd()}else m.group("All functions were tested.")},t.show_normals=function(e,t,r,a){te();var o=n.find_batch_material(e,t,"MAIN");if(!P.has_dyn_geom(e)||!o)return m.error("Normals are not avaliable for the dynamic object:",e.name),!1;var _=o.bufs_data;if(!(_&&_.pointers&&_.pointers.a_position&&_.pointers.a_tbn))return m.error("Normals are not avaliable for the object:",e.name),!1;var i=P.extract_array_float(_,"a_position"),s=P.extract_array_float(_,"a_normal"),l=Y.get_tsr(e,M),c=Nh(zm(l,U),U),E=Th(c,c,U);k=A.create_line("normal_line");for(var u=new Float32Array(2*i.length),d=0;d<i.length;d+=3){var T=C;T[0]=i[d+0],T[1]=i[d+1],T[2]=i[d+2];var f=rg(T,l,w);u[2*d+0]=f[0],u[2*d+1]=f[1],u[2*d+2]=f[2];var p=s.subarray(d,d+3),S=Th(p,E,w),h=uh(T,p=Sh(S=Rh(S,S),r,w),w),v=rg(h,l,w);u[2*d+3]=v[0],u[2*d+4]=v[1],u[2*d+5]=v[2]}var O=n.get_first_batch(k);P.draw_line(O,u,!0),g.assign_attribute_setters(O),O.diffuse_color.set([1,1,1,1]),O.line_width=a},t.hide_normals=te})),Rb=nA("input",(function(e,t){var r=NI(e),n=pb(e),a=dR(e),o=fb(e),_=PI(e),i=mN(e),s=LI(e),l=Fv(),c=Fv(),E=!1,u=a.debug_subs,d=a.defaults;t.GMPD_BUTTON_12=r.GMPD_BUTTON_12,t.GMPD_BUTTON_13=r.GMPD_BUTTON_13,t.GMPD_BUTTON_15=r.GMPD_BUTTON_15,t.GMPD_BUTTON_14=r.GMPD_BUTTON_14,t.GMPD_BUTTON_3=r.GMPD_BUTTON_3,t.GMPD_BUTTON_0=r.GMPD_BUTTON_0,t.GMPD_BUTTON_1=r.GMPD_BUTTON_1,t.GMPD_BUTTON_2=r.GMPD_BUTTON_2,t.GMPD_BUTTON_5=r.GMPD_BUTTON_5,t.GMPD_BUTTON_7=r.GMPD_BUTTON_7,t.GMPD_BUTTON_4=r.GMPD_BUTTON_4,t.GMPD_BUTTON_6=r.GMPD_BUTTON_6,t.GMPD_BUTTON_8=r.GMPD_BUTTON_8,t.GMPD_BUTTON_9=r.GMPD_BUTTON_9,t.GMPD_BUTTON_10=r.GMPD_BUTTON_10,t.GMPD_BUTTON_11=r.GMPD_BUTTON_11,t.GMPD_BUTTON_16=r.GMPD_BUTTON_16,t.GMPD_BUTTON_17=r.GMPD_BUTTON_17,t.GMPD_BUTTON_18=r.GMPD_BUTTON_18,t.GMPD_BUTTON_19=r.GMPD_BUTTON_19,t.GMPD_BUTTON_20=r.GMPD_BUTTON_20,t.GMPD_BUTTON_21=r.GMPD_BUTTON_21,t.GMPD_BUTTON_22=r.GMPD_BUTTON_22,t.GMPD_BUTTON_23=r.GMPD_BUTTON_23,t.GMPD_BUTTON_24=r.GMPD_BUTTON_24,t.GMPD_BUTTON_25=r.GMPD_BUTTON_25,t.GMPD_TRACKPAD_BUTTON=r.GMPD_TRACKPAD_BUTTON,t.GMPD_TRIGGER_BUTTON=r.GMPD_TRIGGER_BUTTON,t.GMPD_GRIPS_BUTTON=r.GMPD_GRIPS_BUTTON,t.GMPD_MENU_BUTTON=r.GMPD_MENU_BUTTON,t.GMPD_AXIS_0=r.GMPD_AXIS_0,t.GMPD_AXIS_1=r.GMPD_AXIS_1,t.GMPD_AXIS_2=r.GMPD_AXIS_2,t.GMPD_AXIS_3=r.GMPD_AXIS_3,t.GMPD_AXIS_4=r.GMPD_AXIS_4,t.GMPD_AXIS_5=r.GMPD_AXIS_5,t.GMPD_AXIS_6=r.GMPD_AXIS_6,t.GMPD_AXIS_7=r.GMPD_AXIS_7,t.GMPD_AXIS_8=r.GMPD_AXIS_8,t.GMPD_AXIS_9=r.GMPD_AXIS_9,t.GMPD_AXIS_10=r.GMPD_AXIS_10,t.GMPD_AXIS_11=r.GMPD_AXIS_11,t.HMD_ORIENTATION_QUAT=r.HMD_ORIENTATION_QUAT,t.HMD_POSITION=r.HMD_POSITION,t.HMD_WEBVR_TYPE=r.HMD_WEBVR_TYPE,t.HMD_WEBVR_DESKTOP=r.HMD_WEBVR_DESKTOP,t.HMD_WEBVR_MOBILE=r.HMD_WEBVR_MOBILE,t.HMD_NON_WEBVR=r.HMD_NON_WEBVR,t.HMD_WEBVR1=r.HMD_WEBVR1,t.HMD_WEBVR1_1=r.HMD_WEBVR1_1;var T=r.HMD_EYE_DISTANCE;t.HMD_EYE_DISTANCE=T,t.HMD_DISTORTION=r.HMD_DISTORTION,t.HMD_BASELINE_DIST=r.HMD_BASELINE_DIST,t.HMD_SCREEN_LENS_DIST=r.HMD_SCREEN_LENS_DIST,t.HMD_SCREEN_WIDTH=r.HMD_SCREEN_WIDTH,t.HMD_SCREEN_HEIGHT=r.HMD_SCREEN_HEIGHT,t.HMD_BEVEL_SIZE=r.HMD_BEVEL_SIZE,t.MOUSE_LOCATION=r.MOUSE_LOCATION,t.MOUSE_DOWN_WHICH=r.MOUSE_DOWN_WHICH,t.MOUSE_UP_WHICH=r.MOUSE_UP_WHICH,t.MOUSE_WHEEL=r.MOUSE_WHEEL,t.KEYBOARD_UP=r.KEYBOARD_UP,t.KEYBOARD_DOWN=r.KEYBOARD_DOWN,t.TOUCH_START=r.TOUCH_START,t.TOUCH_MOVE=r.TOUCH_MOVE,t.TOUCH_END=r.TOUCH_END,t.GYRO_ORIENTATION_QUAT=r.GYRO_ORIENTATION_QUAT,t.GYRO_ORIENTATION_ANGLES=r.GYRO_ORIENTATION_ANGLES;var f={};f[r.DEVICE_HMD]=[r.HMD_ORIENTATION_QUAT,r.HMD_POSITION],f[r.DEVICE_MOUSE]=[r.MOUSE_LOCATION];var p={};p[r.DEVICE_HMD]=[r.HMD_WEBVR_TYPE];var P={};P[r.DEVICE_MOUSE]=[r.MOUSE_LOCATION,r.MOUSE_DOWN_WHICH,r.MOUSE_UP_WHICH,r.MOUSE_WHEEL],P[r.DEVICE_KEYBOARD]=[r.KEYBOARD_UP,r.KEYBOARD_DOWN],P[r.DEVICE_TOUCH]=[r.TOUCH_START,r.TOUCH_MOVE,r.TOUCH_END],P[r.DEVICE_GYRO]=[r.GYRO_ORIENTATION_QUAT,r.GYRO_ORIENTATION_ANGLES];var S={};function A(e){i.error_deprecated("enable_split_screen","screen.request_split_screen");var t=r.get_device_by_type_element(r.DEVICE_HMD);if(!t)return!1;if(E)return!0;var a=r.get_vector_param(t,r.HMD_FOV_LEFT,l),d=r.get_vector_param(t,r.HMD_FOV_RIGHT,c);n.set_hmd_fov(e,a,d);var f=r.get_value_param(t,T);if(f){var p=s.get_active(),P=_.get_scene_data(e,p);n.set_eye_distance(P.cameras,f)}var S={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};if(r.get_value_param(t,r.HMD_WEBVR_TYPE)&(r.HMD_NON_WEBVR|r.HMD_WEBVR_MOBILE|r.HMD_WEBVR_DESKTOP)&&(S.distortion_coefs=[t.distortion_coefs[0],t.distortion_coefs[1]],S.chromatic_aberration_coefs=[t.chromatic_aberration_coefs[0],t.chromatic_aberration_coefs[1],t.chromatic_aberration_coefs[2],t.chromatic_aberration_coefs[3]],t.webvr_hmd_device||(t.base_line_dist&&t.height_dist&&t.bevel_size?S.base_line_factor=(t.base_line_dist-t.bevel_size)/t.height_dist:t.bevel_size||(S.base_line_factor=t.base_line_dist/t.height_dist)),t.inter_lens_dist&&t.width_dist&&!t.webvr_hmd_device&&(S.inter_lens_factor=t.inter_lens_dist/t.width_dist),!u.enabled)){var A=1+t.distortion_coefs[0]+t.distortion_coefs[1];s.multiply_size_mult(A,A)}return s.set_hmd_params(S),o.resize_to_container(!0),r.reset_device(t),E=!0,!0}S[r.DEVICE_HMD]=[r.HMD_DISTORTION,r.HMD_EYE_DISTANCE,r.HMD_BASELINE_DIST,r.HMD_SCREEN_LENS_DIST,r.HMD_SCREEN_WIDTH,r.HMD_SCREEN_HEIGHT,r.HMD_BEVEL_SIZE],t.DEVICE_GYRO=r.DEVICE_GYRO,t.DEVICE_HMD=r.DEVICE_HMD,t.DEVICE_MOUSE=r.DEVICE_MOUSE,t.DEVICE_KEYBOARD=r.DEVICE_KEYBOARD,t.DEVICE_TOUCH=r.DEVICE_TOUCH,t.can_use_device=r.can_use_device,t.get_device_by_type_element=r.get_device_by_type_element,t.switch_prevent_default=function(e,t){e&&r.switch_prevent_default(e,t)},t.register_device=function(){i.error_once("input.register_device() deprecated")},t.reset_device=function(e){e&&e.type==r.DEVICE_HMD?r.reset_device(e):i.error("reset_device is undefined for device.")},t.get_vector_param=function(e,t,n){return e&&e.type in f&&f[e.type].indexOf(t)>=0?r.get_vector_param(e,t,n):(i.error("device hasn't param: ",t),null)},t.get_value_param=function(e,t){return e&&e.type in p&&p[e.type].indexOf(t)>=0?r.get_value_param(e,t):(i.error("device hasn't param: ",t),null)},t.attach_param_cb=function(e,t,n){if(n=n||null,e&&e.type in P&&P[e.type].indexOf(t)>=0)return r.attach_param_cb(e,t,n);i.error("device hasn't param: ",t)},t.detach_param_cb=function(e,t,n){if(n=n||null,e&&e.type in P&&P[e.type].indexOf(t)>=0)return r.detach_param_cb(e,t,n);i.error("device hasn't param: ",t)},t.set_config=function(e,t,n){if(e&&e.type in S&&S[e.type].indexOf(t)>=0)return r.set_config(e,t,n);i.error("device hasn't config: ",t)},t.request_fullscreen_hmd=function(){if(i.error_deprecated("request_fullscreen_hmd","screen.request_fullscreen_hmd"),s.check_active()){var e=s.get_camera(s.get_active());if(e){A(e);var t=r.get_device_by_type_element(r.DEVICE_HMD);if(t){var n=t.webvr_display;if(n&&!n.isPresenting)if(n.capabilities.canPresent){var a=o.get_canvas();n.requestPresent([{source:a}]).then((function(){if(!d.is_mobile_device){var e=n.getEyeParameters("left"),t=n.getEyeParameters("right");o.resize(2*Math.max(e.renderWidth,t.renderWidth),Math.max(e.renderHeight,t.renderHeight),!1)}}),(function(){i.error("HMD fullscreen request failed.")}))}else i.error("HMD fullscreen request failed.")}}}},t.enable_split_screen=A,t.disable_split_screen=function(){i.error_deprecated("disable_split_screen","screen.exit_split_screen");var e=r.get_device_by_type_element(r.DEVICE_HMD);if(!E||!e||!e.registered)return!1;s.set_hmd_params({enable_hmd_stereo:!1});var t=1/(1+e.distortion_coefs[0]+e.distortion_coefs[1]);return s.multiply_size_mult(t,t),o.resize_to_container(!0),!0},t.set_gamepad_key=function(e,t,n){switch(e){case 0:var a=r.DEVICE_GAMEPAD0;break;case 1:a=r.DEVICE_GAMEPAD1;break;case 2:a=r.DEVICE_GAMEPAD2;break;case 3:a=r.DEVICE_GAMEPAD3;break;default:a=r.DEVICE_GAMEPAD0}var o=r.get_device_by_type_element(a);r.set_config(o,t,n)},t.get_pressed_gmpd_btn=r.get_pressed_gmpd_btn,t.get_moved_gmpd_axis=r.get_moved_gmpd_axis,t.get_gamepad_position=r.get_gamepad_position,t.get_gamepad_orientation=r.get_gamepad_orientation,t.check_enable_gamepad_indices=function(){for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],t=[],r=0;r<e.length;r++)e[r]&&t.push(r);return t},t.get_vr_controller_id=function(e){for(var t=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],r=0,n=0;r<4;r++){var a=t[r];if(a&&(""==a.id||"OpenVR Gamepad"==a.id||"Oculus Touch (Left)"==a.id||"Oculus Touch (Right)"==a.id)){if(n==e)return n;n++}}return e},t.add_click_listener=function(e,t){e&&t&&r.add_click_listener(e,t)},t.remove_click_listener=function(e,t){e&&t&&r.remove_click_listener(e,t)}})),Ib=nA("__main",(function(e,t){var r=fb(e),n={callback:null,format:"image/png",quality:1,blob_url:"",last_auto_revoke:!1,curr_auto_revoke:!1};t.canvas_data_url=function(e,t,r,a){n.curr_auto_revoke=void 0!==a||a,n.last_auto_revoke=n.curr_auto_revoke,n.callback=e,n.format=t||n.format,n.quality=r||n.quality},t.frame=function(e,t){var a=n.callback;a&&(n.last_auto_revoke&&n.blob_url&&URL.revokeObjectURL(n.blob_url),function(e,t,n){var a=r.get_canvas();if(a.toBlob)a.toBlob(e,t,n);else{for(var o=atob(a.toDataURL(t,n).split(",")[1]),_=new Uint8Array(o.length),i=0;i<o.length;i++)_[i]=o.charCodeAt(i);e(new Blob([_],{type:t||"image/png"}))}}((function(e){navigator.msSaveOrOpenBlob?a(e):(n.blob_url=URL.createObjectURL(e),a(n.blob_url))}),n.format,n.quality),n.callback=null,n.format="image/png",n.quality=1)}})),bb=nA("main",(function(e,t){var r=ZI(e),n=wI(e),a=QI(e),o=dR(e),_=jI(e),i=fb(e),s=Sb(e),l=$I(e),c=Tb(e),E=HI(e),u=AI(e),d=fR(e),T=VR(e),f=NI(e),p=OI(e),P=GI(e),S=Ib(e),A=ub(e),h=KI(e),v=CI(e),m=mN(e),g=tI(e),O=LI(e),N=yI(e),R=qI(e),I=XI(e),b=AR(e),y=MI(e),L=SI(e),Y=o.context,M=o.defaults,x=0,C=0,w=0,U=[],k=function(){},D=function(){},F=function(){},G=["webgl","experimental-webgl"],K=["webgl2","experimental-webgl2"],B=null,X=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/M.max_fps)};function H(e,t){for(var r=null,n=t?K:G,a=0;a<n.length;a++){var o=n[a];try{r=e.getContext(o,Y)}catch(YM){}if(r)break}return r&&_.detect_tegra_invalid_enum_issue(r),r}function j(){z()||(C=performance.now()/1e3,N.pause(),v.pause(),I.pause(),r.pause())}function z(){return w<C}function Q(){var e="HMD"===M.stereo&&f.get_webvr_display();e?e.requestAnimationFrame(Q):X(Q);var t=performance.now()/1e3;x||(x=t);var o=t-x;if(!(o<1/M.max_fps)){for(var _=b.get_timeline(),i=0;i<U.length;i++)U[i](_,o);z()||(w>x&&(o-=w-Math.max(C,x)),b.set_delta(o),b.set_timeline(_+=o),u.update(),a.update(),c.update(),function(e,t){c.is_primary_loaded()&&(p.reset(),y.update(t),A.update(e,t),P.update(e,t),N.update(e,t),t&&n.update(t),c.is_primary_loaded()&&(v.update(e,t),c.is_primary_loaded()&&(f.update(e),l.update(e,t),c.is_primary_loaded()&&(r.update(!1),h.update(e,t),L.update(),F(t,e),c.is_primary_loaded()&&(O.update(e,t),r.update_visibility(),S.frame())))))}(_,o),D(o)),x=t,e&&e.isPresenting&&e.submitFrame()}}t.init=function(e,t){m.set_verbose(M.console_verbose);var r=WR()+" DEBUG ("+$R()+")";if(m.log("%cINIT ENGINE","color: #00a",r),m.log("%cUSER AGENT:","color: #00a",navigator.userAgent),!window.WebGLRenderingContext)return null;!function(){window.performance||(m.log("Apply performance workaround"),window.performance={});var e=Date.now();window.performance.now||(m.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-e}),b.set_timeline(0)}(),t?p.init(t):(o.defaults.show_hud_debug_info=!1,o.sfx.mix_mode=!1),_.apply_context_alpha_hack(),_.check_user_agent("Chrome")||_.check_user_agent("Firefox")||(M.webgl2=!1);var n=H(e,M.webgl2);return!n&&M.webgl2&&(M.webgl2=!1,n=H(e,!1)),n?(m.log("%cINIT WEBGL "+(M.webgl2?"2":"1"),"color: #00a"),B=n,function(e,t,r){e.addEventListener("webglcontextlost",(function(e){e.preventDefault(),m.error("WebGL context lost"),j()}),!1),d.setup_context(r);var n,a,o,_,l=d.get_renderer_info();l&&m.log("%cRENDERER INFO:","color: #00a",r.getParameter(l.UNMASKED_VENDOR_WEBGL)+", "+r.getParameter(l.UNMASKED_RENDERER_WEBGL)),g.setup_context(r),T.setup_context(r),I.setup_context(r),R.setup_context(r),i.setup_context(r),s.setup(r),E.setup_context(r),c.setup_canvas(e),i.init(e,t),O.setup_dim(e.width,e.height,1),N.init(),f.init(),n=60,a=0,o=M.fps_measurement_interval,_=M.fps_callback_interval,D=function(e){if(!(e<1/M.max_fps)){n=CO(1/e,n,e,o);var t=v.get_fps();0==(a=(a+1)%_)&&k(Math.round(n),t)}},Q()}(e,t,n),o.apply_quality(),_.set_hardware_defaults(n,!0),o.set_paths(),R.load_shaders(),M.ie11_edge_touchscreen_hack&&(e.style["touch-action"]="none"),m.log("%cSET PRECISION:","color: #00a",M.precision),n):null},t.set_fps_callback=function(e){k=e},t.clear_fps_callback=function(){k=function(){}},t.set_render_callback=function(e){!function(e){F=e}(e)},t.clear_render_callback=function(){F=function(){}},t.pause=j,t.resume=function(){z()&&(w=performance.now()/1e3,N.resume(),v.resume(),I.play(!0),r.resume())},t.is_paused=z,t.reset=function(){c.unload(0),s.reset(),c.reset(),d.reset(),g.reset(),T.reset(),I.reset_mod(),R.reset(),E.reset(),i.reset(),c.reset(),i.reset(),b.reset(),N.reset(),x=0,C=0,w=0,k=function(){},D=function(){},F=function(){},U.length=0,B=null},t.canvas_data_url=function(e,t,r,n){S.canvas_data_url(e,t,r,n)},t.detect_mobile=function(){return _.detect_mobile()},t.append_loop_cb=function(e){for(var t=0;t<U.length;t++)if(U[t]==e)return;U.push(e)},t.remove_loop_cb=function(e){for(var t=0;t<U.length;t++)if(U[t]==e){U.splice(t,1);break}},t.get_renderer_info=function(){var e=d.get_renderer_info();return e?{vendor:B.getParameter(e.UNMASKED_VENDOR_WEBGL),renderer:B.getParameter(e.UNMASKED_RENDERER_WEBGL)}:null}})),yb=nA("physics",(function(e,t){var r=CI(e),n=mN(e),a=xI(e);function o(e,t,r,n,a){return function(e,t,r,n){var a=dh(r,t,fg),o=dh(n,r,pg),_=dh(t,n,Pg),i=dh(e,t,Sg),s=dh(e,r,Ag),l=dh(e,n,hg),c=bh(a,o,vg);if(Ih(bh(c,a,mg),i)>=0&&Ih(bh(c,o,mg),s)>=0&&Ih(bh(c,_,mg),l)>=0){var E=mh(c),u=Ih(c,i);return Math.abs(u/E)}var d=Sh(a,xO(Ih(a,i)/mh(a),0,1),mg),T=mh(dh(i,d,mg)),f=Sh(o,xO(Ih(o,s)/mh(o),0,1),mg),p=mh(dh(s,f,mg)),P=Sh(_,xO(Ih(_,l)/mh(_),0,1),mg),S=mh(dh(l,P,mg));return Math.min(Math.min(T,p),S)}(e,n[r[0]],n[r[1]],n[r[2]])}function _(e,t,r,n,o){var _=Math.abs(e[2]-t[2]);return _<o&&a.is_vector_in_poly(e,r,n)?_:Number.MAX_VALUE}t.CM_WALK=0,t.CM_RUN=1,t.CM_CLIMB=2,t.CM_FLY=3,t.enable_simulation=function(e){r.obj_has_physics(e)?r.enable_simulation(e):n.error_once("No physics for object "+e.name)},t.disable_simulation=function(e){r.obj_has_physics(e)?r.disable_simulation(e):n.error_once("No physics for object "+e.name)},t.has_physics=function(e){return r.obj_has_physics(e)},t.has_simulated_physics=function(e){return r.has_simulated_physics(e)},t.has_dynamic_physics=function(e){return r.has_dynamic_physics(e)},t.set_gravity=function(e,t){n.error_deprecated("set_gravity","set_object_gravity"),r.obj_has_physics(e)?r.set_gravity(e,0,0,-t):n.error_once("No physics for object "+e.name)},t.set_object_gravity=function(e,t){r.obj_has_physics(e)?r.set_gravity(e,t[0],t[1],t[2]):n.error_once("No physics for object "+e.name)},t.set_transform=function(e,t,a){r.obj_has_physics(e)?r.set_transform(e,t,a):n.error_once("No physics for object "+e.name)},t.sync_transform=function(e){r.obj_has_physics(e)?r.sync_transform(e):n.error_once("No physics for object "+e.name)},t.apply_velocity=function(e,t,a,o){r.obj_has_physics(e)?r.apply_velocity(e,t,a,o):n.error_once("No physics for object "+e.name)},t.apply_velocity_world=function(e,t,a,o){r.obj_has_physics(e)?r.apply_velocity_world(e,t,a,o):n.error_once("No physics for object "+e.name)},t.apply_force=function(e,t,a,o){r.obj_has_physics(e)?r.apply_force(e,t,a,o,!1):n.error_once("No physics for object "+e.name)},t.apply_force_world=function(e,t,a,o){r.obj_has_physics(e)?r.apply_force(e,t,a,o,!0):n.error_once("No physics for object "+e.name)},t.apply_torque=function(e,t,a,o){r.obj_has_physics(e)?r.apply_torque(e,t,a,o):n.error_once("No physics for object "+e.name)},t.set_angular_velocity=function(e,t,a,o){r.obj_has_physics(e)?r.set_angular_velocity(e,t,a,o):n.error_once("No physics for object "+e.name)},t.vehicle_throttle=function(e,t){r.obj_has_physics(e)?(r.is_vehicle_chassis(e)||r.is_vehicle_hull(e)||n.error("Wrong object"),r.vehicle_throttle(e,xO(t,-1,1))):n.error_once("No physics for object "+e.name)},t.vehicle_throttle_inc=function(e,t,a){if(r.obj_has_physics(e)){r.is_vehicle_chassis(e)||r.is_vehicle_hull(e)||n.error("Wrong object"),t=xO(t,0,1);var o=e.vehicle.engine_force;-1==a||1==a?(o+=a*t,o=Math.max(-1,Math.min(o,1))):0==a&&o>=0?(o-=t,o=Math.max(0,o)):0==a&&o<0?(o+=t,o=Math.min(0,o)):n.error("Wrong steering direction"),r.vehicle_throttle(e,xO(o,-1,1))}else n.error_once("No physics for object "+e.name)},t.vehicle_steer=function(e,t){r.obj_has_physics(e)?(r.is_vehicle_chassis(e)||r.is_vehicle_hull(e)||n.error("Wrong object"),r.vehicle_steer(e,xO(t,-1,1))):n.error_once("No physics for object "+e.name)},t.vehicle_steer_inc=function(e,t,a){if(r.obj_has_physics(e)){r.is_vehicle_chassis(e)||r.is_vehicle_hull(e)||n.error("Wrong object"),t=xO(t,0,1);var o=e.vehicle.steering;-1==a||1==a?(o+=a*t,o=Math.max(-1,Math.min(o,1))):0==a&&o>=0?(o-=t,o=Math.max(0,o)):0==a&&o<0?(o+=t,o=Math.min(0,o)):n.error("Wrong steering direction"),r.vehicle_steer(e,xO(o,-1,1))}else n.error_once("No physics for object "+e.name)},t.vehicle_brake=function(e,t){r.obj_has_physics(e)?(r.is_vehicle_chassis(e)||r.is_vehicle_hull(e)||n.error("Wrong object"),r.vehicle_brake(e,xO(t,0,1))):n.error_once("No physics for object "+e.name)},t.vehicle_brake_inc=function(e,t){if(r.obj_has_physics(e)){r.is_vehicle_chassis(e)||r.is_vehicle_hull(e)||n.error("Wrong object"),t=xO(t,-1,1);var a=e.vehicle.brake_force;r.vehicle_brake(e,xO(a+=a*t,0,1))}else n.error_once("No physics for object "+e.name)},t.is_vehicle_chassis=function(e){return r.is_vehicle_chassis(e)},t.is_vehicle_hull=function(e){return r.is_vehicle_hull(e)},t.get_vehicle_name=function(e){return r.obj_has_physics(e)?r.is_vehicle_chassis(e)||r.is_vehicle_hull(e)?e.vehicle_settings.name:(n.error("Wrong object"),null):(n.error_once("No physics for object "+e.name),null)},t.get_vehicle_throttle=function(e){return r.obj_has_physics(e)?r.is_vehicle_chassis(e)||r.is_vehicle_hull(e)?e.vehicle.engine_force:(n.error("Wrong object"),null):(n.error_once("No physics for object "+e.name),null)},t.get_vehicle_steering=function(e){return r.obj_has_physics(e)?r.is_vehicle_chassis(e)||r.is_vehicle_hull(e)?e.vehicle.steering:(n.error("Wrong object"),0):(n.error_once("No physics for object "+e.name),0)},t.get_vehicle_brake=function(e){return r.obj_has_physics(e)?r.is_vehicle_chassis(e)||r.is_vehicle_hull(e)?e.vehicle.brake_force:(n.error("Wrong object"),0):(n.error_once("No physics for object "+e.name),0)},t.get_vehicle_speed=function(e){return r.obj_has_physics(e)?r.is_vehicle_chassis(e)||r.is_vehicle_hull(e)?r.get_vehicle_speed(e):(n.error("Wrong object"),0):(n.error_once("No physics for object "+e.name),0)},t.is_character=function(e){return r.has_character_physics(e)},t.set_character_move_dir=function(e,t,a){r.obj_has_physics(e)?r.set_character_move_dir(e,t,a):n.error_once("No physics for object "+e.name)},t.set_character_move_type=function(e,t){r.obj_has_physics(e)?r.set_character_move_type(e,t):n.error_once("No physics for object "+e.name)},t.set_character_walk_velocity=function(e,t){r.obj_has_physics(e)?r.set_character_walk_velocity(e,t):n.error_once("No physics for object "+e.name)},t.set_character_run_velocity=function(e,t){r.obj_has_physics(e)?r.set_character_run_velocity(e,t):n.error_once("No physics for object "+e.name)},t.set_character_fly_velocity=function(e,t){r.obj_has_physics(e)?r.set_character_fly_velocity(e,t):n.error_once("No physics for object "+e.name)},t.character_jump=function(e){r.obj_has_physics(e)?r.character_jump(e):n.error_once("No physics for object "+e.name)},t.character_rotation_inc=function(e,t,a){r.obj_has_physics(e)?r.character_rotation_inc(e,t,a):n.error_once("No physics for object "+e.name)},t.set_character_rotation=function(e,t,a){r.obj_has_physics(e)?r.set_character_rotation(e,t,a):n.error_once("No physics for object "+e.name)},t.set_character_rotation_v=function(e,t){r.obj_has_physics(e)?r.set_character_rotation_v(e,t):n.error_once("No physics for object "+e.name)},t.set_character_rotation_h=function(e,t){r.obj_has_physics(e)?r.set_character_rotation_h(e,t):n.error_once("No physics for object "+e.name)},t.set_character_vert_move_dir_angle=function(e,t){r.obj_has_physics(e)?r.set_character_vert_move_dir_angle(e,t):n.error_once("No physics for object "+e.name)},t.append_collision_test=function(e,t,a,o){r.obj_has_physics(e)?r.append_collision_test(e,t=t||"ANY",a,o=o||!1):n.error_once("No physics for object "+e.name)},t.remove_collision_test=function(e,t,a){r.obj_has_physics(e)?r.remove_collision_test(e,t=t||"ANY",a):n.error_once("No physics for object "+e.name)},t.apply_collision_impulse_test=function(e,t){r.obj_has_physics(e)?r.apply_collision_impulse_test(e,t):n.error_once("No physics for object "+e.name)},t.clear_collision_impulse_test=function(e){r.obj_has_physics(e)?r.clear_collision_impulse_test(e):n.error_once("No physics for object "+e.name)},t.append_ray_test=function(e,t,a,o,_,i){return null==(e=e||null)||r.obj_has_physics(e)?r.append_ray_test(e,t,a,o=o||"ANY",_,i=i||!1,!1,!1,!1):(n.error_once("No physics for object "+e.name),0)},t.append_ray_test_ext=function(e,t,a,o,_,i,s,l,c){return null==(e=e||null)||r.obj_has_physics(e)?r.append_ray_test(e,t,a,o=o||"ANY",_,i=i||!1,s=s||!1,l=l||!1,c=c||!1):(n.error_once("No physics for object "+e.name),0)},t.remove_ray_test=function(e){r.is_ray_test(e)?r.remove_ray_test(e):n.error("Wrong ray test ID")},t.change_ray_test_from_to=function(e,t,a){r.is_ray_test(e)?r.change_ray_test_from_to(e,t,a):n.error("Wrong ray test ID")},t.apply_constraint=function(e,t,a,o,_,i,s,l,c,E){r.obj_has_physics(t)&&r.obj_has_physics(_)?r.apply_constraint(e,t,a,o,_,i,s,l,c,E):n.error("Wrong objects")},t.clear_constraint=function(e){r.obj_has_physics(e)&&r.has_constraint(e)?r.clear_constraint(e):n.error("Wrong object")},t.pull_to_constraint_pivot=function(e,t,a,o,_,i){r.obj_has_physics(e)&&r.obj_has_physics(o)?r.pull_to_constraint_pivot(e,t,a,o,_,i):n.error("Wrong objects")},t.navmesh_get_island=function(e,t,_){if(_||(_=o),r.obj_has_physics(e)){var i=e.physics.navmesh;return i?a.navmesh_get_island(i,t,_):(n.error(e.name+" is not a navigation mesh object"),null)}n.error_once("No physics for object "+e.name)},t.navmesh_find_path=function(e,t,i,s){if(r.obj_has_physics(e)){var l=e.physics.navmesh;if(!l)return n.error(e.name+" is not a navigation mesh object"),null;s=s||{};var c={};return c.do_not_pull_string=Boolean(s.do_not_pull_string),c.distance_to_closest=s.distance_to_closest||o,c.distance_to_farthest=s.distance_to_farthest||_,c.island=s.island||0,c.allowed_distance=s.allowed_distance||Number.MAX_VALUE,c.return_normals=s.return_normals||!1,a.navmesh_find_path(l,t,i,c)}n.error_once("No physics for object "+e.name)},t.sync_bounding=function(e,t){t||(t=e.scenes_data[0].scene),r.scene_has_physics(t)&&r.sync_bounding(e,t)},t.sync_mesh=function(e,t){t||(t=e.scenes_data[0].scene),r.scene_has_physics(t)&&r.sync_mesh(e,t)}})),Lb=nA("screen",(function(e,t){var r=pb(e),n=fb(e),a=dR(e),o=OI(e),_=NI(e),i=Ib(e),s=PI(e),l=mN(e),c=LI(e),E=Fv(),u=Fv(),d=!1,T=function(){},f=function(){},p=a.debug_subs;function P(e,t,r){function a(){document.fullscreenElement===e||document.webkitFullscreenElement===e||document.mozFullScreenElement===e||document.webkitIsFullScreen||document.msFullscreenElement===e?t():(document.removeEventListener("fullscreenchange",a,!1),document.removeEventListener("webkitfullscreenchange",a,!1),document.removeEventListener("mozfullscreenchange",a,!1),document.removeEventListener("MSFullscreenChange",a,!1),r())}e=e||n.get_container(),t=t||function(){},r=r||function(){},document.addEventListener("fullscreenchange",a,!1),document.addEventListener("webkitfullscreenchange",a,!1),document.addEventListener("mozfullscreenchange",a,!1),document.addEventListener("MSFullscreenChange",a,!1),e.requestFullScreen=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullscreen,e.requestFullScreen?e.requestFullScreen():l.error("B4W App: request fullscreen method is not supported")}function S(){var e=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;"function"!=typeof e&&l.error("B4W App: exit fullscreen method is not supported"),e.apply(document)}function A(e){var t=_.get_device_by_type_element(_.DEVICE_HMD);if(!t)return!1;if(d)return!0;var a=_.get_value_param(t,_.HMD_WEBVR_TYPE);if(a&_.HMD_WEBVR1_1){var o=t.webvr_display,i=o.getEyeParameters("left"),l=o.getEyeParameters("right");n.resize(2*Math.max(i.renderWidth,l.renderWidth),Math.max(i.renderHeight,l.renderHeight),!1)}else{var T=n.get_canvas(),f=Math.max(2*T.height,T.width);n.resize(f,f/2,!1)}var P=_.get_vector_param(t,_.HMD_FOV_LEFT,E),S=_.get_vector_param(t,_.HMD_FOV_RIGHT,u);r.set_hmd_fov(e,P,S,!Boolean(a&_.HMD_WEBVR1_1));var A={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};a&(_.HMD_NON_WEBVR|_.HMD_WEBVR_MOBILE|_.HMD_WEBVR_DESKTOP)&&(A.distortion_coefs=[t.distortion_coefs[0],t.distortion_coefs[1]],A.chromatic_aberration_coefs=[t.chromatic_aberration_coefs[0],t.chromatic_aberration_coefs[1],t.chromatic_aberration_coefs[2],t.chromatic_aberration_coefs[3]],t.webvr_hmd_device||(t.base_line_dist&&t.height_dist&&t.bevel_size?A.base_line_factor=(t.base_line_dist-t.bevel_size)/t.height_dist:t.bevel_size||(A.base_line_factor=t.base_line_dist/t.height_dist)),t.inter_lens_dist&&t.width_dist&&!t.webvr_hmd_device&&(A.inter_lens_factor=t.inter_lens_dist/t.width_dist)),p.enabled||c.multiply_size_mult(.5,1),c.set_hmd_params(A);var h=_.get_value_param(t,_.HMD_EYE_DISTANCE);if(h){var v=c.get_active(),m=s.get_scene_data(e,v);r.set_eye_distance(m.cameras,h)}return c.render_both_eyes(),d=!0,!0}t.draw_mixer_strip=o.draw_mixer_strip,t.plot_array=o.plot_array,t.request_fullscreen=P,t.exit_fullscreen=S,t.check_fullscreen=_.check_fullscreen,t.request_fullscreen_hmd=function(e,t,r){if("HMD"!=!a.get("stereo")||"NONE"==a.get("stereo")&&a.get("is_mobile_device")){var o=_.get_device_by_type_element(_.DEVICE_HMD);if(o&&_.get_value_param(o,_.HMD_WEBVR_TYPE)&_.HMD_WEBVR1){var i=o.webvr_display;if(i&&!i.isPresenting)if(t=t||function(){},r=r||function(){},f=function(){i.isPresenting?t():(window.removeEventListener("vrdisplaypresentchange",f),r())},window.addEventListener("vrdisplaypresentchange",f,!1),i.capabilities.canPresent){var s=n.get_canvas();i.requestPresent([{source:s}]).then((function(){}),(function(){l.error("HMD fullscreen request failed.")}))}else l.error("HMD fullscreen request failed.")}else P(e,t,r)}},t.exit_fullscreen_hmd=function(){if("HMD"!=!a.get("stereo")||"NONE"==a.get("stereo")&&a.get("is_mobile_device")){var e=_.get_device_by_type_element(_.DEVICE_HMD);if(e&&_.get_value_param(e,_.HMD_WEBVR_TYPE)&_.HMD_WEBVR1){var t=e.webvr_display;t&&t.isPresenting&&(t.exitPresent(),n.resize_to_container(!0))}else S()}},t.check_fullscreen_hmd=function(){var e=_.get_device_by_type_element(_.DEVICE_HMD),t=_.get_value_param(e,_.HMD_WEBVR_TYPE)&_.HMD_WEBVR1;return!(!e||!(t&&e.webvr_display||!t&&_.check_fullscreen()))},t.request_split_screen=function(e,t){var r=_.get_device_by_type_element(_.DEVICE_HMD);if(!r)return!1;if(d)return!0;if(T=t,c.check_active()){var n=c.get_camera(c.get_active());n&&(r.registered?(A(n),e&&e()):(_.request_register_device(r),r.registered_cb=function(){A(n),e&&e()}))}},t.exit_split_screen=function(){var e=_.get_device_by_type_element(_.DEVICE_HMD);return!!(d&&e&&e.registered)&&(c.set_hmd_params({enable_hmd_stereo:!1}),d=!1,T&&T(),c.render_one_eye(),p.enabled||c.multiply_size_mult(2,1),n.resize_to_container(!0),!0)},t.shot=function(e,t){i.canvas_data_url((function(t){var r="screenshot."+e.split("/")[1];if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(t,r);else{var n=window.document.createElement("a");document.body.appendChild(n),n.style.display="none",n.href=t,n.download="screenshot."+e.split("/")[1],n.click(),document.body.removeChild(n)}}),e=e||"image/png",t=t||1,!0)}})),Yb=nA("scenes",(function(e,t){var r=JI(e),n=pb(e),a=fb(e),o=Tb(e),_=pR(e),i=KI(e),s=PI(e),l=mN(e),c=CI(e),E=LI(e),u=mR(e);function d(){var e=a.get_canvas();return i.pick_object(e.clientWidth/2,e.clientHeight/2)}function T(e,t,n){var a=E.get_active(),o=e.draw_data[0].bundles[0],_=o.batch,i=t.draw_data[0].bundles[0],s=i.batch;if("quality"in n){var c=n.quality;8===c||16===c||24===c||32===c?(e.ssao_samples=c,r.set_batch_directive(_,"SSAO_QUALITY","SSAO_QUALITY_"+c),r.update_shader(_),u.append_draw_data(e,o)):l.error('set_ssao_params(): Wrong "quality" value.')}if("use_hemisphere"in n&&(e.ssao_hemisphere=n.use_hemisphere,r.set_batch_directive(_,"SSAO_HEMISPHERE",0|n.use_hemisphere),r.update_shader(_),u.append_draw_data(e,o)),"use_blur_depth"in n&&(t.ssao_blur_depth=n.use_blur_depth,r.set_batch_directive(s,"SSAO_BLUR_DEPTH",0|n.use_blur_depth),r.update_shader(s),u.append_draw_data(t,i),E.connect_render_targets_batch(a._render.graph,t,s,!1)),"ssao_white"in n&&(e.ssao_white=n.ssao_white,r.set_batch_directive(_,"SSAO_WHITE",0|n.ssao_white),r.update_shader(_),u.append_draw_data(e,o)),"blur_discard_value"in n&&(t.ssao_blur_discard_value=n.blur_discard_value),"radius_increase"in n&&(e.ssao_radius_increase=n.radius_increase),"influence"in n&&(e.ssao_influence=n.influence),"dist_factor"in n&&(e.ssao_dist_factor=n.dist_factor),"boolean"==typeof n.ssao_only){var d=E.get_subs(a,u.MAIN_OPAQUE);d.ssao_only=n.ssao_only;for(var T=d.draw_data,f=[],p=0;p<T.length;p++)for(var P=T[p].bundles,S=0;S<P.length;S++){var A=P[S].batch;r.set_batch_directive(A,"SSAO_ONLY",0|n.ssao_only),r.update_shader(A),f.push(P[S])}for(p=0;p<f.length;p++)u.append_draw_data(d,f[p])}e.need_perm_uniforms_update=!0,t.need_perm_uniforms_update=!0}function f(e){return s.is_dynamic_mesh(e)||s.is_empty(e)||s.is_line(e)||s.is_lamp(e)}t.DATA_ID_ALL=i.DATA_ID_ALL,t.set_active=function(e){var t=E.get_all_scenes();E.set_active(Wg("name",e,t))},t.get_active=function(){return E.check_active()?E.get_active().name:""},t.get_scenes=function(){for(var e=E.get_all_scenes(),t=[],r=0;r<e.length;r++)t.push(e[r].name);return t},t.get_active_camera=function(){return E.check_active()?E.get_camera(E.get_active()):(l.error("No active scene"),!1)},t.get_object_by_name=function(e,t){var r=i.get_object(i.GET_OBJECT_BY_NAME,e,0|t,!0);if(r)return r;l.error("get object "+e+": not found")},t.get_object_by_dupli_name=function(e,t,r){var n=i.get_object(i.GET_OBJECT_BY_DUPLI_NAME,e,t,0|r);if(n)return n;l.error("get object "+t+": not found")},t.get_object_by_dupli_name_list=function(e,t){var r=i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e,0|t);if(r)return r;l.error("get object "+e+": not found")},t.get_world_by_name=function(e,t){var r=i.get_world_by_name(e,0|t);if(r)return r;l.error("get object "+e+": not found")},t.get_object_data_id=function(e){return s.get_object_data_id(e)},t.pick_object=function(e,t){var r=E.get_main();if(!r)return l.error("No active scene"),null;var n=E.get_subs(r,u.STEREO);return n&&n.enable_hmd_stereo?(l.error_once("pick_object() is not available in the stereo rendering mode. Use scenes.pick_center instead."),d()):i.pick_object(e,t)},t.pick_center=d,t.outlining_is_enabled=function(e){return e&&e.render&&e.render.outlining},t.set_outline_intensity=function(e,t){e&&e.render&&e.render.outlining?i.set_outline_intensity(e,t):l.error("set_outline_intensity(): wrong object")},t.get_outline_intensity=function(e){return e&&e.render&&e.render.outlining?e.render.outline_intensity:(l.error("get_outline_intensity(): wrong object"),0)},t.apply_outline_anim=function(e,t,r,n){e&&e.render&&e.render.outlining?i.apply_outline_anim(e,t,r,n):l.error("apply_outline_anim(): wrong object")},t.apply_outline_anim_def=function(e){if(e&&e.render&&e.render.outlining){var t=e.render.outline_anim_settings_default;i.apply_outline_anim(e,t.outline_duration,t.outline_period,t.outline_relapses)}else l.error("apply_outline_anim_def(): wrong object")},t.clear_outline_anim=function(e){e&&e.render&&e.render.outlining?i.clear_outline_anim(e):l.error("clear_outline_anim(): wrong object")},t.set_outline_color=E.set_outline_color,t.get_outline_color=function(e){var t=E.get_active(),r=E.get_subs(t,u.OUTLINE);if(r)return(e=e||new Float32Array(3)).set(r.outline_color),e},t.set_hmd_params=function(e){E.check_active()?e&&(!e.distortion_coefs||e.distortion_coefs instanceof Array||(e.distortion_coefs=null),!e.chromatic_aberration_coefs||e.chromatic_aberration_coefs instanceof Array||(e.chromatic_aberration_coefs=null),"number"!=typeof e.base_line_factor&&(e.base_line_factor=null),"number"!=typeof e.inter_lens_factor&&(e.inter_lens_factor=null),"boolean"!=typeof e.enable_hmd_stereo&&(e.enable_hmd_stereo=null),E.set_hmd_params(e)):l.error("No active scene")},t.get_shadow_params=function(){if(!E.check_active())return l.error("No active scene"),!1;var e=E.get_active(),t=E.get_subs(e,u.SHADOW_CAST);if(!t)return null;var r=e._render.shadow_params,n=E.get_subs(e,u.MAIN_OPAQUE),a=E.get_subs(e,u.SHADOW_RECEIVE),o={};return o.csm_resolution=r.csm_resolution,o.self_shadow_polygon_offset=t.self_shadow_polygon_offset,a&&(o.self_shadow_normal_offset=a.self_shadow_normal_offset),o.enable_csm=r.enable_csm,o.csm_num=r.csm_num,o.csm_first_cascade_border=r.csm_first_cascade_border,o.first_cascade_blur_radius=r.first_cascade_blur_radius,o.csm_last_cascade_border=r.csm_last_cascade_border,o.last_cascade_blur_radius=r.last_cascade_blur_radius,o.fade_last_cascade=r.fade_last_cascade,o.blend_between_cascades=r.blend_between_cascades,r.enable_csm?(o.csm_borders=E.get_csm_borders(e,n.camera),o.blur_radii=new Float32Array(r.csm_num),o.blur_radii.set(n.camera.pcf_blur_radii.subarray(0,r.csm_num))):(o.csm_borders=null,o.blur_radii=null),o},t.set_shadow_params=function(e){if(E.check_active()){var t=E.get_active();"number"==typeof e.self_shadow_polygon_offset&&_.traverse(t._render.graph,(function(t,r){r.type==u.SHADOW_CAST&&(r.self_shadow_polygon_offset=e.self_shadow_polygon_offset)}));for(var a=E.subs_array(t,[u.SHADOW_RECEIVE]),o=0;o<a.length;o++){var i=a[o];"number"==typeof e.self_shadow_normal_offset&&(i.self_shadow_normal_offset=e.self_shadow_normal_offset),"number"==typeof e.pcf_blur_radius&&(i.pcf_blur_radius=e.pcf_blur_radius)}var c=E.subs_array(t,[u.MAIN_BLEND]);for(o=0;o<c.length;o++){var d=c[o];"number"==typeof e.self_shadow_normal_offset&&(d.self_shadow_normal_offset=e.self_shadow_normal_offset),"number"==typeof e.pcf_blur_radius&&(d.pcf_blur_radius=e.pcf_blur_radius),d.need_perm_uniforms_update=!0}var T=t._render.shadow_params;if("number"==typeof e.csm_first_cascade_border&&(T.csm_first_cascade_border=e.csm_first_cascade_border),"number"==typeof e.first_cascade_blur_radius&&(T.first_cascade_blur_radius=e.first_cascade_blur_radius),"number"==typeof e.csm_last_cascade_border&&(T.csm_last_cascade_border=e.csm_last_cascade_border),"number"==typeof e.last_cascade_blur_radius&&(T.last_cascade_blur_radius=e.last_cascade_blur_radius),i){var f=i.draw_data;for(o=0;o<f.length;o++)for(var p=f[o].bundles,P=0;P<p.length;P++){var S=p[P];if(S.obj_render.shadow_receive){var A=S.batch;r.assign_shadow_receive_dirs(A,T),r.update_shader(A),u.append_draw_data(i,S)}}i.need_perm_uniforms_update=!0}var h=s.get_scene_data(t._camera,t).cameras;for(o=0;o<h.length;o++)n.update_camera_shadows(h[o],T);E.schedule_shadow_update(t)}else l.error("No active scene")},t.get_environment_colors=function(){if(!E.check_active())return l.error("No active scene"),[];var e=E.get_active();return E.get_environment_colors(e)},t.set_environment_colors=function(e,t,r){if(E.check_active()){var n=E.get_active(),a=E.get_subs(n,u.MAIN_OPAQUE),o=e||0==e?parseFloat(e):a.environment_energy;E.set_environment_colors(n,o,t||0==t?t:a.horizon_color,r||0==r?r:a.zenith_color)}else l.error("No active scene")},t.get_fog_color_density=function(e){if(!E.check_active())return l.error("No active scene"),!1;var t=E.get_active();return E.get_fog_color_density(t,e)},t.set_fog_color_density=function(e){if(E.check_active()){var t=E.get_active();E.set_fog_color_density(t,e)}else l.error("No active scene")},t.get_fog_params=function(){if(!E.check_active())return l.error("No active scene"),!1;var e=E.get_active(),t={};return t.fog_intensity=E.get_fog_intensity(e),t.fog_depth=E.get_fog_depth(e),t.fog_start=E.get_fog_start(e),t.fog_height=E.get_fog_height(e),t},t.set_fog_params=function(e){if(E.check_active()){var t=E.get_active();"number"==typeof e.fog_intensity&&E.set_fog_intensity(t,e.fog_intensity),"number"==typeof e.fog_depth&&E.set_fog_depth(t,e.fog_depth),"number"==typeof e.fog_start&&E.set_fog_start(t,e.fog_start),"number"==typeof e.fog_height&&E.set_fog_height(t,e.fog_height)}else l.error("No active scene")},t.get_ssao_params=function(){if(!E.check_active())return l.error("No active scene"),!1;var e=E.get_active();return E.get_ssao_params(e)},t.set_ssao_params=function(e){if(E.check_active()){var t=E.get_active(),r=E.subs_array(t,[u.SSAO]),n=E.subs_array(t,[u.SSAO_BLUR]);if(!r.length)return l.error("SSAO is not enabled on the scene"),0;for(var a=0;a<r.length;a++)T(r[a],n[a],e)}else l.error("No active scene")},t.get_color_correction_params=function(){if(!E.check_active())return l.error("No active scene"),null;var e=E.get_active(),t=E.get_subs(e,u.COMPOSITING);if(!t)return null;var r={};return r.brightness=t.brightness,r.contrast=t.contrast,r.exposure=t.exposure,r.saturation=t.saturation,r},t.set_color_correction_params=function(e){if(E.check_active()){var t=E.get_active(),r=E.get_subs(t,u.COMPOSITING);r&&("brightness"in e&&(r.brightness=e.brightness),"contrast"in e&&(r.contrast=e.contrast),"exposure"in e&&(r.exposure=e.exposure),"saturation"in e&&(r.saturation=e.saturation),r.need_perm_uniforms_update=!0)}else l.error("No active scene")},t.get_sky_params=function(){if(!E.check_active())return l.error("No active scene"),!1;var e=E.get_active();return E.get_sky_params(e)},t.set_sky_params=function(e){if(E.check_active()){var t=E.get_active(),r=E.get_subs(t,u.SKY);r&&("color"in e&&r.sky_color.set(e.color),"rayleigh_brightness"in e&&(r.rayleigh_brightness=e.rayleigh_brightness),"mie_brightness"in e&&(r.mie_brightness=e.mie_brightness),"spot_brightness"in e&&(r.spot_brightness=e.spot_brightness),"scatter_strength"in e&&(r.scatter_strength=e.scatter_strength),"rayleigh_strength"in e&&(r.rayleigh_strength=e.rayleigh_strength),"mie_strength"in e&&(r.mie_strength=e.mie_strength),"rayleigh_collection_power"in e&&(r.rayleigh_collection_power=e.rayleigh_collection_power),"mie_collection_power"in e&&(r.mie_collection_power=e.mie_collection_power),"mie_distribution"in e&&(r.mie_distribution=e.mie_distribution),r.need_perm_uniforms_update=!0,r.need_fog_update=!0,E.update_sky(t,r))}else l.error("No active scene")},t.get_dof_params=function(){if(!E.check_active())return l.error("No active scene"),!1;var e=E.get_active();return E.get_subs(e,u.DOF)?E.get_dof_params(e):null},t.set_dof_params=function(e){if(E.check_active()){var t=E.get_active();E.set_dof_params(t,e)}else l.error("No active scene")},t.get_god_rays_params=function(){if(!E.check_active())return l.error("No active scene"),!1;var e=E.get_active();return E.get_subs(e,u.GOD_RAYS)?E.get_god_rays_params(e):null},t.set_god_rays_params=function(e){if(E.check_active()){var t=E.get_active();E.set_god_rays_params(t,e)}else l.error("No active scene")},t.get_bloom_params=function(){if(!E.check_active())return l.error("No active scene"),!1;var e=E.get_active();return E.get_subs(e,u.BLOOM)?E.get_bloom_params(e):null},t.set_bloom_params=function(e){if(E.check_active()){var t=E.get_active();E.set_bloom_params(t,e)}else l.error("No active scene")},t.get_glow_material_params=function(){if(!E.check_active())return l.error("No active scene"),!1;var e=E.get_active();return E.get_subs(e,u.GLOW_COMBINE)?E.get_glow_material_params(e):null},t.set_glow_material_params=function(e){if(E.check_active()){var t=E.get_active();E.set_glow_material_params(t,e)}else l.error("No active scene")},t.get_wind_params=function(){if(!E.check_active())return l.error("No active scene"),!1;var e=E.get_active();return E.get_wind_params(e)},t.set_wind_params=function(e){if(E.check_active()){var t=E.get_active();i.set_wind_params(t,e)}else l.error("No active scene")},t.get_water_surface_level=function(e,t){if(!E.check_active())return l.error("No active scene"),0;var r=E.get_active();return r._render.water_params?E.get_water_surface_level(r,e,t):(l.error("No water parameters on the active scene"),0)},t.set_water_params=function(e){if(E.check_active()){var t=E.get_active();E.set_water_params(t,e)}else l.error("No active scene")},t.get_water_mat_params=function(e){if(E.check_active()){var t=E.get_active();E.get_water_mat_params(t,e)}else l.error("No active scene")},t.update_scene_materials_params=function(){if(E.check_active()){var e=E.get_active();E.update_scene_permanent_uniforms(e)}else l.error("No active scene")},t.hide_object=function(e,t){t=t||!1,f(e)?t?E.change_visibility(e,!0):E.change_visibility_rec(e,!0):l.error("show/hide is only supported for dynamic objects.")},t.show_object=function(e,t){t=t||!1,f(e)?t?E.change_visibility(e,!1):E.change_visibility_rec(e,!1):l.error("show/hide is only supported for dynamic objects.")},t.is_hidden=function(e){return f(e)?E.is_hidden(e):(l.error("show/hide is only supported for dynamic meshes/empties and lamps"),!1)},t.is_visible=function(e){return e.render.is_visible},t.check_object_by_name=function(e,t){return!!i.get_object(i.GET_OBJECT_BY_NAME,e,0|t,!0)},t.check_object_by_dupli_name=function(e,t,r){return!!i.get_object(i.GET_OBJECT_BY_DUPLI_NAME,e,t,0|r)},t.check_object_by_dupli_name_list=function(e,t){return!!i.get_object(i.GET_OBJECT_BY_DUPLI_NAME_LIST,e,0|t)},t.get_all_objects=function(e,t){var r=E.get_active();return e||(e="ALL"),t||0===t||(t=i.DATA_ID_ALL),i.get_scene_objs_derived(r,e,t)},t.get_object_name=function(e){return e?e.origin_name:(l.error("Wrong object name"),"")},t.get_object_name_hierarchy=function(e){if(!e)return l.error("Wrong object name"),null;for(var t=[],r=e;r;)t.push(r.origin_name),r=s.get_dg_parent(r);return t.reverse()},t.get_object_type=function(e){return e&&e.type?e.type:(l.error("Wrong object"),"UNDEFINED")},t.get_object_children=function(e){return e.cons_descends.slice(0)},t.get_first_character=function(){return i.get_first_character(E.get_active())},t.get_shore_dist=function(e,t){if(t||0===t||(t=1),!E.check_active())return l.error("No active scene"),0;var r=E.get_active();return E.get_shore_dist(r,e,t)},t.get_cam_water_depth=function(){return E.get_cam_water_depth()},t.get_type_mesh_object=function(e){return s.is_mesh(e)?e.render.type:""},t.get_meta_tags=function(){if(!E.check_active())return l.error("No active scene"),!1;var e=E.get_active();return E.get_meta_tags(e)},t.get_custom_prop=function(){if(!E.check_active())return l.error("No active scene"),!1;var e=E.get_active();return E.get_custom_prop(e)},t.append_object=function(e,t){if(t)var r=Wg("name",t,E.get_all_scenes());else r=E.get_active();E.append_object(r,e,!0),c.append_object(e,r)},t.remove_object=function(e){s.is_dynamic_mesh(e)||s.is_empty(e)||s.is_line(e)?(i.obj_switch_cleanup_flags(e,e.render.is_copied_deep,!1,!1),o.prepare_object_unloading(e),i.obj_switch_cleanup_flags(e,!0,!0,!0),i.remove_object(e)):l.error("Can't remove object \""+e.name+'". It must be dynamic and type of MESH or EMPTY.')},t.marker_frame=function(e){var t=E.get_active();return t.timeline_markers&&e in t.timeline_markers?E.marker_frame(t,e):(l.error('"'+e+'" marker not found.'),0)},t.get_mb_params=function(){var e=E.get_active(),t=E.get_subs(e,u.MOTION_BLUR);return t?{mb_factor:t.mb_factor,mb_decay_threshold:t.mb_decay_threshold}:null},t.set_mb_params=function(e){var t=E.get_active(),r=E.subs_array(t,[u.MOTION_BLUR]);if(r.length)for(var n=0;n<r.length;n++){var a=r[n];"number"==typeof e.mb_decay_threshold&&(a.mb_decay_threshold=e.mb_decay_threshold),"number"==typeof e.mb_factor&&(a.mb_factor=e.mb_factor)}else l.error("The motion blur subscene doesn't exist.")},t.can_select_objects=function(){var e=E.get_active();return Boolean(E.get_subs(e,u.COLOR_PICKING))}})),Mb=nA("transform",(function(e,t){var r=PI(e),n=CI(e),a=mN(e),o=MI(e),_=wm(),i=ih(),s=ih(),l=new Float32Array(4),c=dm();t.set_translation=function(e,t,_,s){r.is_dynamic(e)?(i[0]=t,i[1]=_,i[2]=s,o.set_translation(e,i),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_translation_rel=function(e,t,_,s){r.is_dynamic(e)?(i[0]=t,i[1]=_,i[2]=s,o.set_translation_rel(e,i),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_translation_v=function(e,t){r.is_dynamic(e)?(o.set_translation(e,t),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_translation_rel_v=function(e,t){r.is_dynamic(e)?(o.set_translation_rel(e,t),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_translation_obj_rel=function(e,t,_,l,E){if(r.is_dynamic(e)){i[0]=t,i[1]=_,i[2]=l;var u=jm(E.render.world_tsr,s),d=Vm(E.render.world_tsr,c);!function(e,t,r,n,a){a||(a=new Float32Array(3)),xh(e,VA(r,n,bg),a)}(i,0,d,u,i),o.set_translation(e,i),o.update_transform(e),n.sync_transform(e)}else a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_translation=function(e,t){return t||(t=new Float32Array(3)),o.get_translation(e,t),t},t.get_translation_rel=function(e,t){return t||(t=new Float32Array(3)),o.get_translation_rel(e,t),t},t.set_rotation=function(e,t,_,i,s){r.is_dynamic(e)?(l[0]=t,l[1]=_,l[2]=i,l[3]=s,o.set_rotation(e,l),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_rel=function(e,t,_,i,s){r.is_dynamic(e)?(l[0]=t,l[1]=_,l[2]=i,l[3]=s,o.set_rotation_rel(e,l),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_v=function(e,t){r.is_dynamic(e)?(o.set_rotation(e,t),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_rel_v=function(e,t){r.is_dynamic(e)?(o.set_rotation_rel(e,t),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_rotation_rel_v=function(e,t){if(r.is_dynamic(e))return o.get_rotation_rel(e,t),t;a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_rotation=function(e,t){return t||(t=new Float32Array(4)),o.get_rotation(e,t),t},t.get_rotation_rel=function(e,t){return t||(t=new Float32Array(4)),o.get_rotation_rel(e,t),t},t.set_rotation_euler=function(e,t,_,s){r.is_dynamic(e)?(i[0]=t,i[1]=_,i[2]=s,o.set_rotation_euler(e,i),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_rotation_euler=function(e,t){return t||(t=new Float32Array(3)),o.get_rotation_euler(e,t),t},t.get_rotation_euler_rel=function(e,t){return t||(t=new Float32Array(3)),o.get_rotation_euler_rel(e,t),t},t.set_rotation_euler_rel=function(e,t,_,s){r.is_dynamic(e)?(i[0]=t,i[1]=_,i[2]=s,o.set_rotation_euler_rel(e,i),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_euler_v=function(e,t){r.is_dynamic(e)?(o.set_rotation_euler(e,t),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_rotation_euler_rel_v=function(e,t){r.is_dynamic(e)?(o.set_rotation_euler_rel(e,t),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_scale=function(e,t){r.is_dynamic(e)?(o.set_scale(e,t),o.update_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_scale_rel=function(e,t){r.is_dynamic(e)?(o.set_scale_rel(e,t),o.update_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_scale=function(e,t){return o.get_scale(e,t)},t.get_scale_rel=function(e,t){return o.get_scale_rel(e,t)},t.empty_reset_transform=function(e){if("EMPTY"==e.type){for(var t=0;t<e.cons_descends.length;t++)if(!r.is_dynamic(e.cons_descends[t]))return void a.error('Wrong object: "'+e.cons_descends[t].name+'" is not dynamic.');o.set_translation(e,[0,0,0]),o.set_rotation(e,[0,0,0,1]),o.set_scale(e,1),o.update_transform(e),n.sync_transform(e)}else a.error("Wrong object: "+e.name)},t.get_object_size=function(e){return r.is_mesh(e)?o.get_object_size(e):(a.error("Wrong object: "+e.name),0)},t.get_object_center=function(e,t,n){return r.is_mesh(e)?(n||(n=new Float32Array(3)),o.get_object_center(e,t,n)):(a.error("Wrong object: "+e.name),null)},t.move_local=function(e,t,_,i){r.is_dynamic(e)?(o.move_local(e,t,_,i),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.rotate_x_local=function(e,t){if(r.is_dynamic(e)){var _=vm(Cg,t,l);o.rotate_local(e,_),o.update_transform(e),n.sync_transform(e)}else a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.rotate_y_local=function(e,t){if(r.is_dynamic(e)){var _=vm(Dg,t,l);o.rotate_local(e,_),o.update_transform(e),n.sync_transform(e)}else a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.rotate_z_local=function(e,t){if(r.is_dynamic(e)){var _=vm(Ug,t,l);o.rotate_local(e,_),o.update_transform(e),n.sync_transform(e)}else a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_object_bounding_box=function(e){return UN(e.render.bb_world)},t.set_tsr=function(e,t){r.is_dynamic(e)?(o.set_tsr(e,t),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_tsr_rel=function(e,t){r.is_dynamic(e)?(o.set_tsr_rel(e,t),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_tsr=function(e,t){return t||(t=wm()),o.get_tsr(e,t),t},t.get_tsr_rel=function(e,t){return t||(t=wm()),o.get_tsr_rel(e,t),t},t.distance=function(e,t){return o.distance(e,t)},t.set_matrix=function(e,t){r.is_dynamic(e)?(eg(t,_),o.set_tsr(e,_),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.set_matrix_rel=function(e,t){r.is_dynamic(e)?(eg(t,_),o.set_tsr_rel(e,_),o.update_transform(e),n.sync_transform(e)):a.error('Wrong object: "'+e.name+'" is not dynamic.')},t.get_matrix=function(e,t){return t||(t=new Float32Array(16)),o.get_tsr(e,_),$m(_,t),t},t.get_matrix_rel=function(e,t){return t||(t=new Float32Array(16)),o.get_tsr_rel(e,_),$m(_,t),t}})),xb=nA("util",(function(e,t){var r=gN(e),n=jI(e),a=TR(e),o=mN(e);t.AXIS_X=new Float32Array([1,0,0]),t.AXIS_Y=new Float32Array([0,1,0]),t.AXIS_Z=new Float32Array([0,0,1]),t.AXIS_MX=new Float32Array([-1,0,0]),t.AXIS_MY=new Float32Array([0,-1,0]),t.AXIS_MZ=new Float32Array([0,0,-1]),t.XYX=0,t.YZY=1,t.ZXZ=2,t.XZX=3,t.YXY=4,t.ZYZ=5,t.XYZ=6,t.YZX=7,t.ZXY=8,t.XZY=9,t.YXZ=10,t.ZYX=11,t.f32=function(e){return Qg(e=e||0)},t.assert=r.assert,t.keyfind=zg,t.keysearch=Wg,t.matrix_to_quat=function(e){return EO(e)},t.euler_to_quat=function(e,t){return t||(t=new Float32Array(4)),tO(e,t)},t.ordered_angles_to_quat=function(e,t,r){return r||(r=dm()),rO(e,t,r)},t.quat_to_ordered_angles=function(e,t,r){return r||(r=ih()),nO(e,t,r)},t.quat_to_euler=function(e,t){return t||(t=new Float32Array(3)),oO(e,t)},t.sign=qg,t.clamp=xO,t.quat_to_dir=_O,t.ground_project_cam_quat=function(e,t){return MO(e,Fg,Ug,wg,t)},t.cam_quat_to_mesh_quat=function(e,t){return function(e,t){var r;return t||(t=new Float32Array(4)),mm(r=vm([0,0,1],Math.PI,dm()),vm([1,0,0],Math.PI/2,dm()),r),mm(e,r,t),t}(e,t)},t.quat_project=function(e,t,r,n,a){return 0!=Ih(r,n)?(o.error("Wrong in-plane direction"),null):MO(e,t,r,n,a)},t.hash_code=function(){return a.hash_code.apply(a,arguments)},t.smooth=CO,t.smooth_v=wO,t.is_vector=DO,t.correct_cam_quat_up=FO,t.quat_to_angle_axis=vO,t.random_from_array=zO,t.horizontal_direction=QO,t.angle_wrap_0_2pi=qO,t.angle_wrap_periodic=VO,t.smooth_step=nN,t.lerp=aN,t.deg_to_rad=NO,t.rad_to_deg=RO,t.dir_to_quat=iO,t.is_ie11=n.is_ie11,t.gen_tbn_quats=function(e,t){return o.error_once("util.gen_tbn_quats() deprecated. Do not use it anymore."),YR(e,t)},t.trunc=OO})),Cb=nA("app",(function(e,t){var r=Pb(e),n=Ab(e),a=hb(e),o=vb(e),_=mb(e),i=gb(e),s=Nb(e),l=Rb(e),c=bb(e),E=yb(e),u=mN(e),d=Lb(e),T=Yb(e),f=Mb(e),p=xb(e),P=1,S=null,A=!1,h=!1,v=!1,m=null,g=!1,O=!1,N=new Float32Array(2),R=new Float32Array(2),I=new Float32Array(3),b=new Float32Array(3),y=new Float32Array(4),L={},Y={};function M(e,t){var r=String(e);t&&(r+="/"+String(t)),S.innerHTML=r}function x(e){var t=document.getElementById(e),r=t.cloneNode(!0);return t.parentNode.replaceChild(r,t),r}function C(e,t,n){var a=Math.max(r.hover_get_distance(e),1),o=f.get_rotation(e,y),_=p.quat_to_dir(o,t,I);_[2]=0,Rh(_,_),Sh(_,a*n,_);var i=f.get_translation(e,b);uh(i,_,i),r.set_translation(e,i)}function w(e,t){var n=r.hover_get_vertical_limits(e,Y);if(n.up!=n.down){var a=r.get_camera_angles(e,R)[1],o=(n.down-a)/(n.down-n.up),_=r.hover_get_distance_limits(e,Y);o=Math.max(o,2/_.max),r.rotate_camera(e,0,o*t)}}function U(e,t,r,n){f.move_local(e,t*=5,r*=5,n*=5)}function k(e){return e/(1-e)}function D(e,t,n){var a=r.target_get_distance(e),o=Math.abs(t),_=Math.pow(o*n,1-Math.pow(o*n,.15));t=t<0?a>.001?-a*_:0:a*k(_),f.move_local(e,0,0,t)}function F(e,t,r,n,a){for(var o=n*r,_=t;_>0;--_)a+=o,o=(n+=o)*r;return a}function G(e,t,n,a,o,_){if(_){var i=hh(r.target_get_pivot(e,I),r.get_translation(e))+a;a=t>0?F(0,t,-n,i,a):F(0,-t,k(n),i,a)}else a-=t*o*n;return a}function K(){var e=T.get_active_camera();_.check_sensor_manifold(e,"TOGGLE_CHAR_MOVE_TYPE")&&T.get_first_character()&&a.remove(e);for(var t=["FORWARD","BACKWARD","ROT_UP","ROT_DOWN","ROT_LEFT","ROT_RIGHT","UP","DOWN","LEFT","RIGHT","MOUSE_WHEEL","TOUCH_ZOOM","ZOOM_INTERPOL","MOUSE_X","MOUSE_Y","TOUCH_X","TOUCH_Y","ROT_TRANS_INTERPOL","CHANGE_MOVE_STYLE","TOGGLE_CHAR_MOVE_TYPE"],r=0;r<t.length;r++)_.remove_sensor_manifold(e,t[r])}function B(e,t,r,n){var a=document.createElement("div"),o=document.createElement("div"),_=document.createElement("div");if(n)for(var i=0;i<n.length;i++){var s=document.getElementById(n[i]);s&&s.parentNode.removeChild(s)}a.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;",o.style.cssText="color:#fff;font-size:24px;",_.style.cssText="color:#fff;font-size:20px;",o.innerHTML=e,_.innerHTML=t+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+r+'">'+r.replace("https://www.","")+"</a>",a.appendChild(o),a.appendChild(_),document.body.appendChild(a)}function X(e,t,r,n,a){var o=performance.now();c.append_loop_cb((function _(){var i=performance.now()-o;a(t+i*(r-t)/n),(i>=n||!e.parentNode)&&c.remove_loop_cb(_)}))}function H(){return.08*P}function j(){return.12*P}t.init=function(e){e=e||{};var t=!1,r=null,a=function(){},l=null,E=null,d=0,T=null,f=!0,p=!1,P=!0,A=!0,h=!1,v=!1,m=!1,g=!1,O=n.get("quality");for(var N in e)switch(N){case"canvas_container_id":r=e.canvas_container_id;break;case"callback":a=e.callback;break;case"autoresize":t=e.autoresize;break;case"show_hud_debug_info":m=e.show_hud_debug_info;break;case"sfx_mix_mode":h=e.sfx_mix_mode;break;case"show_fps":v=e.show_fps;break;case"track_container_position":g=e.track_container_position,u.error_once("track_container_position deprecated. Not needed anymore. Use the container.get_coords_target_space method.");break;case"fps_wrapper_id":T=e.fps_wrapper_id;break;case"fps_elem_id":E=e.fps_elem_id;break;case"error_purge_elements":l=e.error_purge_elements;break;case"report_init_failure":A=e.report_init_failure;break;case"pause_invisible":P=e.pause_invisible;break;case"key_pause_enabled":f=e.key_pause_enabled;break;case"force_container_ratio":d=e.force_container_ratio;break;case"min_capabilities":p=e.min_capabilities;break;case"quality":O=e.quality;break;default:n.set(N,e[N])}O!=n.P_AUTO&&n.set("quality",O),f&&document.addEventListener("keydown",(function(e){e.keyCode==_.KEY_P&&(c.is_paused()?c.resume():c.pause())}),!1),n.set("show_hud_debug_info",m),n.set("sfx_mix_mode",h);var R=m||h||null,I=function(){var e=function(e,t,r,n){var a=document.createElement("canvas"),_=document.getElementById(e);if(_||(u.error('Warning: canvas container "'+e+'" not found, appending to body'),_=document.body),a.style.position="absolute",a.style.left=0,a.style.top=0,a.style.width=_.offsetWidth+"px",a.style.height=_.offsetHeight+"px",a.width=_.offsetWidth*window.devicePixelRatio,a.height=_.offsetHeight*window.devicePixelRatio,t)(i=document.createElement("canvas")).style.position="absolute",a.style.left=0,a.style.top=0,i.style.pointerEvents="none";else var i=null;return _.appendChild(a),c.init(a,i)?(i&&o.insert_to_container(i,"LAST"),!0):(r&&B("Browser could not initialize WebGL","For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html#problems-upon-startup",n),!1)}(r,R,A,l),_=o.get_canvas();if(e){var i,f=o.get_container();o.resize_to_container(),v&&(function(e,t){e?(t&&(document.getElementById(t).style.display="block"),S=document.getElementById(e)):((S=document.createElement("div")).innerHTML=0,S.style.cssText="position:absolute;font-family: Arial, sans-serif;top: 20px;right: 20px;text-shadow: 0px 0px 6px #000;font-size: 40px;line-height: 50px;font-weight: bold;color: #fff;",o.insert_to_container(S,"JUST_AFTER_CANVAS"))}(E,T),c.set_fps_callback(M)),P&&(i=c.is_paused(),document.addEventListener("visibilitychange",(function(){document.hidden?(i=c.is_paused(),c.pause()):i||c.resume()}),!1),function(){var e=0,t=o.get_container(),r=c.is_paused(),n=!0;c.append_loop_cb((function(){if(e%10==0){var a=t.getBoundingClientRect();a.top>window.innerHeight||a.bottom<0?(n&&(r=c.is_paused()),c.pause(),n=!1):r||n||(c.resume(),n=!0)}e++}))}()),d&&c.append_loop_cb((function(){f.style.height=f.clientWidth/d+"px"})),t&&c.append_loop_cb((function(){o.resize_to_container()})),g&&c.append_loop_cb((function(){o.force_offsets_updating()})),p&&n.reset_limits(),O==n.P_AUTO?s.test_performance((function(e,t){0==e?(u.log("QUALITY TEST RESULT: UNSUPPORTED, using HIGH"),n.apply_quality(n.P_HIGH)):t<1.5?(u.log("QUALITY TEST RESULT: LOW ("+t.toFixed(1)+" GB/s)"),n.apply_quality(n.P_LOW)):(u.log("QUALITY TEST RESULT: HIGH ("+t.toFixed(1)+" GB/s)"),n.apply_quality(n.P_HIGH)),a(_,!0)})):a(_,!0)}else a(_,!1)};"complete"==document.readyState?window.setTimeout(I,0):window.addEventListener("load",I,!1),window.addEventListener("unload",(function(){i.cleanup()}),!1)},t.set_onclick=function(e,t){var r=x(e);r.addEventListener("mouseup",(function(e){t(r.value)}),!1)},t.set_onchange=function(e,t){var r=x(e);r.addEventListener("change",(function(e){var n=r.checked;t(null!=n?n:r.value)}),!1)},t.set_onkeypress=function(e,t){var r=x(e);r.addEventListener("keypress",(function(e){t(e.keyCode,r.value)}),!1)},t.enable_camera_controls=function e(t,n,o,i,s,c){A=t,h=n,v=o,m=i,g=s,O=c;var u,d,S,y=T.get_active_camera();d=r.get_move_style(u=y),S=_.create_callback_sensor((function(){var e=r.get_move_style(u),t=e!=d;return d=e,t})),_.create_sensor_manifold(u,"CHANGE_MOVE_STYLE",_.CT_POSITIVE,[S],null,(function(t,r,n){K(),e(A,h,v,m,g,O)}));var Y=!1,M=null,x=!1;switch(r.get_move_style(y)){case r.MS_TARGET_CONTROLS:Y=!t;break;case r.MS_EYE_CONTROLS:M=T.get_first_character();break;case r.MS_STATIC:return;case r.MS_HOVER_CONTROLS:x=!0}var k=r.get_velocities(y,L),F=_.create_elapsed_sensor();if(E.has_simulated_physics(y)){var B=_.create_collision_sensor(y,null,!0);_.create_sensor_manifold(y,"CAMERA_COLLISION",_.CT_POSITIVE,[B],null,(function(e,t,r){var n=_.get_sensor_payload(e,t,0).coll_dist;if(n<0){var a=_.get_sensor_payload(e,t,0).coll_norm,o=I;Sh(a,-.25*n,o);var i=f.get_translation(e,b);uh(i,o,i),f.set_translation_v(e,i)}}))}if(M){var X=f.get_translation(y),z=f.get_rotation(y),Q=p.cam_quat_to_mesh_quat(z);X[2]-=.5,E.set_transform(M,X,Q),a.append_stiff_trans(y,M,[0,0,.5]);var V=new Float32Array(2),q=!0;E.set_character_move_type(M,E.CM_FLY),_.create_kb_sensor_manifold(y,"TOGGLE_CHAR_MOVE_TYPE",_.CT_SHOT,_.KEY_C,(function(){E.set_character_move_type(M,(q=!q)?E.CM_FLY:E.CM_WALK)}))}var W,J,Z,$,ee,te,re,ne,ae,oe,_e,ie,se=function(e,t,n){if(1==n){var a=_.get_sensor_value(e,t,0);switch(r.get_velocities(e,k),t){case"FORWARD":if(M)V[0]=1;else if(x){var o=r.get_camera_angles(e,R)[1];C(e,Math.abs(o)>=Math.PI/4?p.AXIS_Y:p.AXIS_MZ,.5*k.trans*a)}else Y?D(e,-k.zoom,a):U(e,0,0,-k.trans*a);break;case"BACKWARD":M?V[0]=-1:x?(o=r.get_camera_angles(e,R)[1],C(e,Math.abs(o)>=Math.PI/4?p.AXIS_MY:p.AXIS_Z,.5*k.trans*a)):Y?D(e,k.zoom,a):U(e,0,0,k.trans*a);break;case"UP":x?w(e,30*-k.zoom*a):M||U(e,0,k.trans*a,0);break;case"DOWN":x?w(e,30*k.zoom*a):M||U(e,0,-k.trans*a,0);break;case"LEFT":M?V[1]=1:x?C(e,p.AXIS_MX,.5*k.trans*a):U(e,-k.trans*a,0,0);break;case"RIGHT":M?V[1]=-1:x?C(e,p.AXIS_X,.5*k.trans*a):U(e,k.trans*a,0,0);break;case"ROT_LEFT":r.rotate_camera(e,Y?.75*-k.rot*a:.75*k.rot*a,0);break;case"ROT_RIGHT":r.rotate_camera(e,Y?.75*k.rot*a:.75*-k.rot*a,0);break;case"ROT_UP":r.rotate_camera(e,0,Y?.75*-k.rot*a:.75*k.rot*a);break;case"ROT_DOWN":r.rotate_camera(e,0,Y?.75*k.rot*a:.75*-k.rot*a)}}else switch(t){case"FORWARD":case"BACKWARD":M&&(V[0]=0);break;case"LEFT":case"RIGHT":M&&(V[1]=0)}if(M){E.set_character_move_dir(M,V[0],V[1]);var i=r.get_camera_angles_char(e,N);E.set_character_rotation_h(M,i[0]),E.set_character_vert_move_dir_angle(M,i[1])}};if(c)re=ne=ae=oe=_e=ie=_.create_custom_sensor(0);else{var le=l.check_enable_gamepad_indices();if(le.length)var ce=le[le.length-1];else ce=0;re=_.create_gamepad_btn_sensor(l.GMPD_BUTTON_6,ce),ne=_.create_gamepad_btn_sensor(l.GMPD_BUTTON_7,ce),ae=_.create_gamepad_axis_sensor(l.GMPD_AXIS_0,le),oe=_.create_gamepad_axis_sensor(l.GMPD_AXIS_1,le),_e=_.create_gamepad_axis_sensor(l.GMPD_AXIS_2,le),ie=_.create_gamepad_axis_sensor(l.GMPD_AXIS_3,le)}n?W=J=Z=$=ee=te=_.create_custom_sensor(0):(W=_.create_keyboard_sensor(_.KEY_W),J=_.create_keyboard_sensor(_.KEY_S),Z=_.create_keyboard_sensor(_.KEY_A),$=_.create_keyboard_sensor(_.KEY_D),ee=_.create_keyboard_sensor(_.KEY_R),te=_.create_keyboard_sensor(_.KEY_F));var Ee=_.create_keyboard_sensor(_.KEY_UP),ue=_.create_keyboard_sensor(_.KEY_DOWN),de=_.create_keyboard_sensor(_.KEY_LEFT),Te=_.create_keyboard_sensor(_.KEY_RIGHT),fe=function(e){return e[0]&&(e[1]||e[2]||e[3])},pe=function(e){return e[0]&&(e[1]||e[2]>.1)},Pe=function(e){return e[0]&&(e[1]||e[2]<-.1)},Se=function(e){return e[0]&&(e[1]||e[2]||e[3]>.1)},Ae=function(e){return e[0]&&(e[1]||e[2]||e[3]<-.1)};if(x||(_.create_sensor_manifold(y,"FORWARD",_.CT_CONTINUOUS,[F,W,oe],Pe,se),_.create_sensor_manifold(y,"BACKWARD",_.CT_CONTINUOUS,[F,J,oe],pe,se)),Y?(_.create_sensor_manifold(y,"ROT_UP",_.CT_CONTINUOUS,[F,Ee,ee,ie],Ae,se),_.create_sensor_manifold(y,"ROT_DOWN",_.CT_CONTINUOUS,[F,ue,te,ie],Se,se),_.create_sensor_manifold(y,"ROT_LEFT",_.CT_CONTINUOUS,[F,de,Z,_e],Ae,se),_.create_sensor_manifold(y,"ROT_RIGHT",_.CT_CONTINUOUS,[F,Te,$,_e],Se,se)):x?(_.create_sensor_manifold(y,"LEFT",_.CT_CONTINUOUS,[F,de,Z,ae],Ae,se),_.create_sensor_manifold(y,"RIGHT",_.CT_CONTINUOUS,[F,Te,$,ae],Se,se),_.create_sensor_manifold(y,"FORWARD",_.CT_CONTINUOUS,[F,Ee,W,oe],Ae,se),_.create_sensor_manifold(y,"BACKWARD",_.CT_CONTINUOUS,[F,ue,J,oe],Se,se),_.create_sensor_manifold(y,"UP",_.CT_CONTINUOUS,[F,te,ie],pe,se),_.create_sensor_manifold(y,"DOWN",_.CT_CONTINUOUS,[F,ee,ie],Pe,se)):(_.create_sensor_manifold(y,"UP",_.CT_CONTINUOUS,[F,ee,re],fe,se),_.create_sensor_manifold(y,"DOWN",_.CT_CONTINUOUS,[F,te,ne],fe,se),_.create_sensor_manifold(y,"LEFT",_.CT_CONTINUOUS,[F,Z,ae],Pe,se),_.create_sensor_manifold(y,"RIGHT",_.CT_CONTINUOUS,[F,$,ae],pe,se),_.create_sensor_manifold(y,"ROT_UP",_.CT_CONTINUOUS,[F,Ee,ie],Pe,se),_.create_sensor_manifold(y,"ROT_DOWN",_.CT_CONTINUOUS,[F,ue,ie],pe,se),_.create_sensor_manifold(y,"ROT_LEFT",_.CT_CONTINUOUS,[F,de,_e],Pe,se),_.create_sensor_manifold(y,"ROT_RIGHT",_.CT_CONTINUOUS,[F,Te,_e],pe,se)),!o){var he=0,ve=_.create_mouse_wheel_sensor(i),me=0,ge=_.create_touch_zoom_sensor(i);_.create_sensor_manifold(y,"MOUSE_WHEEL",_.CT_LEVEL,[ve],null,(function(e,t,n){if(1==n){var a=_.get_sensor_value(e,t,0);r.get_velocities(e,k),Y||x?he=G(e,a,k.zoom,he,2,Y):(k.trans*=1+a*k.zoom,r.set_velocities(e,k))}})),_.create_sensor_manifold(y,"TOUCH_ZOOM",_.CT_LEVEL,[ge],null,(function(e,t,n,a){if(1==n){var o=_.get_sensor_value(e,t,0);r.get_velocities(e,k),_.get_sensor_payload(e,t,0)===_.PL_MULTITOUCH_MOVE_ZOOM&&(me=G(e,o,.03*k.zoom,me,2,Y))}})),_.create_sensor_manifold(y,"ZOOM_INTERPOL",_.CT_POSITIVE,[F],null,(function(e,t,n){if(Y||x)if(Math.abs(he)>1e-5||Math.abs(me)>1e-5){var a=_.get_sensor_value(e,t,0),o=p.smooth(he,0,a,.1*P);he-=o;var i=p.smooth(me,0,a,.15*P);if(me-=i,x)w(e,-(o+i));else{var s=r.target_get_distance(e)+o+i;s=Math.max(s,.001),r.target_set_distance(e,s)}}else he=0,me=0}))}var Oe=0,Ne=0,Re=0,Ie=0,be=function(e,t,n,a){if(1==n){var o=_.get_sensor_value(e,t,1);if(r.get_velocities(e,k),x)i=.003*k.trans,s=75e-5*k.rot;else var i=.003*k.rot,s=75e-5*k.trans;1===_.get_sensor_payload(e,t,0).which?(Oe+="X"==a?-o*i:0,Ne+="Y"==a?-o*i:0):2!==_.get_sensor_payload(e,t,0).which&&3!==_.get_sensor_payload(e,t,0).which||(Re+="X"==a?-o*s:0,Ie+="Y"==a?-o*s:0)}},ye=0,Le=0;if(!c){var Ye=function(e,t,n){r.get_velocities(e,k),ye+=.002*k.trans},Me=function(e,t,n){r.get_velocities(e,k),ye-=.002*k.trans};Y?(_.create_sensor_manifold(y,"GMPD_PAN_Y_POS",_.CT_CONTINUOUS,[re],null,(function(e,t,n){r.get_velocities(e,k),Le+=.05*k.zoom})),_.create_sensor_manifold(y,"GMPD_PAN_Y_NEG",_.CT_CONTINUOUS,[ne],null,(function(e,t,n){r.get_velocities(e,k),Le-=.05*k.zoom})),_.create_sensor_manifold(y,"GMPD_PAN_X_POS",_.CT_CONTINUOUS,[ae],(function(e){return e[0]<-.1}),Me),_.create_sensor_manifold(y,"GMPD_PAN_X_NEG",_.CT_CONTINUOUS,[ae],(function(e){return e[0]>.1}),Ye)):x&&(_.create_sensor_manifold(y,"GMPD_PAN_X_POS",_.CT_CONTINUOUS,[_e],(function(e){return e[0]<-.1}),Me),_.create_sensor_manifold(y,"GMPD_PAN_X_NEG",_.CT_CONTINUOUS,[_e],(function(e){return e[0]>.1}),Ye))}if(s){var xe=_.create_mouse_move_sensor("X",window),Ce=_.create_mouse_move_sensor("Y",window),we=_.create_mouse_click_sensor(i),Ue=_.create_mouse_click_sensor(window),ke=!1,De=function(e){return e[2]?ke=!0:e[0]||(ke=!1),ke&&e[0]};_.create_sensor_manifold(y,"MOUSE_X",_.CT_POSITIVE,[Ue,xe,we],De,be,"X"),_.create_sensor_manifold(y,"MOUSE_Y",_.CT_POSITIVE,[Ue,Ce,we],De,be,"Y");var Fe=l.get_device_by_type_element(l.DEVICE_MOUSE,window);l.switch_prevent_default(Fe,!1)}else{xe=_.create_mouse_move_sensor("X",i),Ce=_.create_mouse_move_sensor("Y",i);var Ge=_.create_mouse_click_sensor(i);_.create_sensor_manifold(y,"MOUSE_X",_.CT_POSITIVE,[Ge,xe],null,be,"X"),_.create_sensor_manifold(y,"MOUSE_Y",_.CT_POSITIVE,[Ge,Ce],null,be,"Y")}var Ke=0,Be=0,Xe=0,He=0,je=_.create_touch_move_sensor("X",i),ze=_.create_touch_move_sensor("Y",i),Qe=function(e,t,n,a){if(1==n){if(r.get_velocities(e,k),x)var o=.003*k.trans;else o=.003*k.rot;var i=_.get_sensor_value(e,t,0);if(_.get_sensor_payload(e,t,0).gesture===_.PL_SINGLE_TOUCH_MOVE)Ke+="X"==a?-i*o:0,Be+="Y"==a?-i*o:0;else if(_.get_sensor_payload(e,t,0).gesture===_.PL_MULTITOUCH_MOVE_PAN){if(x)s=.003*k.rot;else var s=75e-5*k.trans;Xe+="X"==a?-i*s:0,He+="Y"==a?-i*s:0}}};_.create_sensor_manifold(y,"TOUCH_X",_.CT_POSITIVE,[je],null,Qe,"X"),_.create_sensor_manifold(y,"TOUCH_Y",_.CT_POSITIVE,[ze],null,Qe,"Y"),_.create_sensor_manifold(y,"ROT_TRANS_INTERPOL",_.CT_POSITIVE,[F],null,(function(e,t,n){if(Math.abs(Oe)>1e-5||Math.abs(Ne)>1e-5||Math.abs(Ke)>1e-5||Math.abs(Be)>1e-5||Math.abs(Re)>1e-5||Math.abs(Ie)>1e-5||Math.abs(Xe)>1e-5||Math.abs(He)>1e-5||Math.abs(ye)>1e-5||Math.abs(Le)>1e-5){var a=_.get_sensor_value(e,t,0),o=p.smooth(Oe,0,a,H()),i=p.smooth(Ne,0,a,H());Oe-=o,Ne-=i;var s=p.smooth(Ke,0,a,j()),l=p.smooth(Be,0,a,j());Ke-=s,Be-=l;var c=p.smooth(Re,0,a,H()),u=p.smooth(Ie,0,a,H());Re-=c,Ie-=u;var d=p.smooth(Xe,0,a,j()),T=p.smooth(He,0,a,j());Xe-=d,He-=T;var f=p.smooth(ye,0,a,H()),P=p.smooth(Le,0,a,H());if(ye-=f,Le-=P,Y){r.rotate_camera(e,o+s,i+l);var S=r.target_get_distance(e);r.target_pan_pivot(e,S*(c+d+f),S*(u+T+P))}else if(x){if(o+s&&C(e,p.AXIS_X,.2*(o+s)),i+l){var A=r.get_camera_angles(e,R)[1];C(e,Math.abs(A)>Math.PI/4?p.AXIS_MY:p.AXIS_Z,.2*(i+l))}r.rotate_camera(e,c+d+f,0)}else if(r.rotate_camera(e,.5*(o+s),.5*(i+l)),M){var h=r.get_camera_angles_char(e,N);E.set_character_rotation_h(M,h[0]),E.set_character_vert_move_dir_angle(M,h[1])}}})),_.create_kb_sensor_manifold(y,"DEC_STEREO_DIST",_.CT_SHOT,_.KEY_LEFT_SQ_BRACKET,(function(e,t,n){var a=r.get_stereo_distance(e);r.set_stereo_distance(e,.9*a)})),_.create_kb_sensor_manifold(y,"INC_STEREO_DIST",_.CT_SHOT,_.KEY_RIGHT_SQ_BRACKET,(function(e,t,n){var a=r.get_stereo_distance(e);r.set_stereo_distance(e,1.1*a)}))},t.disable_camera_controls=K,t.enable_object_controls=function(e,t){var r=E.is_vehicle_chassis(e)||E.is_vehicle_hull(e),n=function(e,t,n){if(1==n){var a=_.get_sensor_value(e,t,0);switch(t){case"FORWARD":r?E.vehicle_throttle(e,1):f.move_local(e,0,-1*a,0);break;case"BACKWARD":r?E.vehicle_throttle(e,-1):f.move_local(e,0,1*a,0);break;case"LEFT":r?E.vehicle_steer(e,-1):f.move_local(e,1*a,0,0);break;case"RIGHT":r?E.vehicle_steer(e,1):f.move_local(e,-1*a,0,0)}}else switch(t){case"FORWARD":case"BACKWARD":r&&E.vehicle_throttle(e,0);break;case"LEFT":case"RIGHT":r&&E.vehicle_steer(e,0)}},a=_.create_elapsed_sensor(),o=_.create_keyboard_sensor(_.KEY_W),i=_.create_keyboard_sensor(_.KEY_S),s=_.create_keyboard_sensor(_.KEY_A),l=_.create_keyboard_sensor(_.KEY_D),c=_.create_keyboard_sensor(_.KEY_UP),u=_.create_keyboard_sensor(_.KEY_DOWN),d=_.create_keyboard_sensor(_.KEY_LEFT),T=_.create_keyboard_sensor(_.KEY_RIGHT),p=function(e){return e[0]&&(e[1]||e[2])};_.create_sensor_manifold(e,"FORWARD",_.CT_CONTINUOUS,[a,o,c],p,n),_.create_sensor_manifold(e,"BACKWARD",_.CT_CONTINUOUS,[a,i,u],p,n),_.create_sensor_manifold(e,"LEFT",_.CT_CONTINUOUS,[a,s,d],p,n),_.create_sensor_manifold(e,"RIGHT",_.CT_CONTINUOUS,[a,l,T],p,n)},t.disable_object_controls=function(e){for(var t=["FORWARD","BACKWARD","LEFT","RIGHT"],r=0;r<t.length;r++)_.remove_sensor_manifold(e,t[r])},t.enable_debug_controls=function(){_.create_kb_sensor_manifold(null,"CAMERA_SHOT",_.CT_SHOT,_.KEY_K,(function(){s.make_camera_frustum_shot()})),_.create_kb_sensor_manifold(null,"LIGHT_SHOT",_.CT_SHOT,_.KEY_L,(function(){s.make_light_frustum_shot()})),_.create_kb_sensor_manifold(null,"TELEMETRY",_.CT_SHOT,_.KEY_T,(function(){s.plot_telemetry()}))},t.request_fullscreen=function(e,t,r){u.error_deprecated("request_fullscreen","screen.request_fullscreen"),d.request_fullscreen(e,t,r)},t.exit_fullscreen=function(){u.error_deprecated("exit_fullscreen","screen.exit_fullscreen"),d.exit_fullscreen()},t.check_fullscreen=function(){return u.error_deprecated("check_fullscreen","screen.check_fullscreen"),d.check_fullscreen()},t.report_app_error=B,t.get_url_params=function(e){e=!!e;var t=decodeURIComponent(location.href.toString());if(-1==t.indexOf("?"))return null;for(var r=t.split("?")[1].split("&"),n={},a=0;a<r.length;a++){var o=r[a].split("="),_=o[0];if(o.length>1){var i=o[1];e?_ in n?n[_].push(i):n[_]=[i]:n[_]=i}else e?_ in n||(n[_]=[]):n[_]=""}return n},t.css_animate=function(e,t,r,n,a,o,_,i){if(e&&t&&isFinite(r)&&isFinite(n)&&isFinite(a)){o=o||"",_=_||"",i=i||function(){};var s=e.style,l=t.charAt(0).toUpperCase()+t.slice(1);if(null!=s[t]);else if(null!=s["webkit"+l])t="webkit"+l;else if(null!=s["ms"+l])t="ms"+l;else{if(null==s["moz"+l])return;t="moz"+l}X(e,r,n,a,(function(a){e&&(s[t]=o+a+_,(r>n&&a<=n||r<n&&a>=n)&&(s[t]=o+n+_,i()))}))}},t.attr_animate=function(e,t,r,n,a,o){e&&t&&isFinite(r)&&isFinite(n)&&isFinite(a)&&(o=o||function(){},X(e,r,n,a,(function(a){e&&(a>=0&&e.setAttribute(t,a),(r>n&&a<=n||r<n&&a>=n)&&(e.setAttribute(t,n),o()))})))},t.queue_animate=function(e){if(e.length){var r=e.shift(),n=r.elem,a=r.prop,o=r.from,_=r.to,i=r.duration,s=function(){r.cb&&r.cb(),t.queue_animate(e)};"css"==r.type?t.css_animate(n,a,o,_,i,r.opt_prefix,r.opt_suffix,s):"attr"==r.type&&t.attr_animate(n,a,o,_,i,s)}},t.set_camera_smooth_factor=function(e){P=e},t.get_camera_smooth_factor=function(){return P}})),wb=nA("time",(function(e,t){var r=AR(e);t.set_timeout=r.set_timeout,t.clear_timeout=r.clear_timeout,t.get_timeline=r.get_timeline,t.animate=r.animate,t.clear_animation=r.clear_animation,t.get_framerate=function(){return r.get_framerate()}})),Ub=nA("tsr",(function(e,t){var r=mN(e);t.create=wm,t.from_values=Um,t.copy=Dm,t.identity=Fm,t.set_sep=Gm,t.set_trans=Km,t.set_scale=Bm,t.set_transcale=function(e,t){return r.error_once("set_transcale is deprecated, use the tsr.set_trans and tsr.set_scale functions instead."),Xm(e,t)},t.set_quat=Hm,t.get_trans_view=function(e){return r.error_once("get_trans_view is deprecated, use the tsr.get_trans functions."),function(e){return jm(e,dm())}(e)},t.get_trans=jm,t.get_scale=zm,t.get_quat_view=function(e){return r.error_once("get_quat_view is deprecated, use the tsr.get_quat functions."),function(e){return Vm(e,dm())}(e)},t.get_quat=Vm,t.invert=Zm,t.to_mat4=function(e,t){return t||(t=IA()),$m(e,t),t},t.from_mat4=eg,t.multiply=tg,t.transform_vec3=rg,t.transform_vec3_inv=ng,t.transform_vectors=ag,t.transform_dir_vectors=og,t.transform_dir_vec3=_g,t.transform_tangents=ig,t.translate=cg,t.interpolate=function(e,t,r,n){return n||(n=wm()),Eg(e,t,r,n),n}})),kb=nA("camera_anim",(function(e,t){var r=Pb(e),n=mb(e),a=mN(e),o=Yb(e),_=wb(e),i=Mb(e),s=Ub(e),l=xb(e),c=new Float32Array(2),E=new Float32Array(2),u=new Float32Array(3),d=new Float32Array(3),T=new Float32Array(3),f=s.create(),p=s.create(),P=s.create(),S=dm(),A={},h=!1,v=!1,m=!1,g=!1;function O(e,t,n,a,o){var _=l.angle_wrap_0_2pi(t-n),i=Math.min(_,2*Math.PI-_),s=l.angle_wrap_0_2pi(a-t),c=Math.min(s,2*Math.PI-s);return(Math.abs(i)<1e-6||2*Math.PI-Math.abs(i)<1e-6)&&(i=0),(Math.abs(c)<1e-6||2*Math.PI-Math.abs(c)<1e-6)&&(c=0),r.is_eye_camera(e)?(o[0]=c,o[1]=i):(o[0]=i,o[1]=c),o}t.track_to_target=function(e,t,o,s,f,p,P,S){if(r.is_eye_camera(e)){if(l.is_vector(t))var A=t;else i.get_object_center(t,!1,A=u);o=o||1,s=s||2,f=f||1,p=p||1;var h=i.get_translation(e,d),v=dh(A,h,T),m=r.get_camera_angles(e,c),g=r.get_camera_angles_dir(v,E),O=g[0]-m[0],N=g[1]-m[1],R=Math.acos(Math.cos(O)*Math.cos(N)),I=Math.abs(R/o),b=mh(v)*(1-1/s),y=function(e){return 6*e*(1-e)},L=_.get_timeline(),Y=0,M=function(){n.remove_sensor_manifold(e,"TRACK_TO_TARGET"),P&&P()},x=n.create_timeline_sensor(),C=n.create_elapsed_sensor();n.create_sensor_manifold(e,"TRACK_TO_TARGET",n.CT_CONTINUOUS,[x,C],null,(function(t,a,o){if(r.is_eye_camera(t)){if(1==o){var _=n.get_sensor_value(t,a,0)-L,s=n.get_sensor_value(t,a,1);if(_<I){var l=y(_/I);r.rotate_camera(e,l*O*s/I,l*N*s/I)}else _<I+f?(0==Y&&(r.rotate_camera(e,g[0],g[1],!0),Y++),l=y(_-I/f),i.move_local(t,0,0,-l*b*s/f)):_<I+f+p?Y<=1&&(r.rotate_camera(e,g[0],g[1],!0),r.eye_set_look_at(e,h),i.move_local(t,0,0,-b),S&&S(),Y++):_<I+f+p+f?(Y<=2&&(r.rotate_camera(e,g[0],g[1],!0),r.eye_set_look_at(e,h),i.move_local(t,0,0,-b),Y++),l=y(_-I-f-p/f),i.move_local(t,0,0,l*b*s/f)):(r.rotate_camera(e,g[0],g[1],!0),r.eye_set_look_at(e,h),M())}}else M()}))}else a.error("track_to_target(): Wrong camera object or camera move style")},t.auto_rotate=function(e,t,_){t=t||function(){};var i=o.get_active_camera();if(r.is_static_camera(i))a.error("auto_rotate(): Wrong camera move style");else{var s={},u=0,d=0;if(n.check_sensor_manifold(i,"AUTO_ROTATE"))g();else{var T=n.create_mouse_move_sensor("X"),f=n.create_mouse_move_sensor("Y"),p=n.create_mouse_click_sensor(),P=n.create_touch_move_sensor(),S=n.create_touch_zoom_sensor(),h=n.create_elapsed_sensor();if(_)var v=n.create_mouse_wheel_sensor();else v=n.create_custom_sensor(0);n.create_sensor_manifold(i,"DISABLE_AUTO_ROTATE",n.CT_LEVEL,[T,f,p,P,S,v],(function(e){return e[0]&&e[2]||e[1]&&e[2]||e[3]||e[4]||e[5]}),g),n.create_sensor_manifold(i,"AUTO_ROTATE",n.CT_CONTINUOUS,[h],(function(e){return e[0]}),(function(t,a,o){if(1==o){var _=r.get_move_style(t);if(_==r.MS_STATIC)g();else if(_!=r.MS_TARGET_CONTROLS&&_!=r.MS_EYE_CONTROLS||!r.has_horizontal_rot_limits(t))s=null,function(t,a){var o=n.get_sensor_value(t,a,0);r.rotate_camera(t,o*e,0)}(t,a);else{var i=_==r.MS_EYE_CONTROLS?r.eye_get_horizontal_limits(t,A):r.target_get_horizontal_limits(t,A);null!==s&&i.left==s.left&&i.right==s.right||m(i),function(t,a){var o=n.get_sensor_value(t,a,0),_=O(t,r.get_camera_angles(t,c)[0],s.left,s.right,E);_[1]>u&&_[0]>u?d=l.sign(d)*e:_[1]<u?d-=Math.pow(e,2)/.4*o:_[0]<u&&(d+=Math.pow(e,2)/.4*o),r.rotate_camera(t,o*d,0)}(t,a)}}}))}}function m(t){(s=s||{}).left=t.left,s.right=t.right,u=Math.min(.2,l.angle_wrap_0_2pi(s.right-s.left)/2),d=function(e,t,n){var a=O(e,r.get_camera_angles(e,c)[0],t.left,t.right,E);return n*Math.min(1,a[0]/.2,a[1]/.2)}(i,s,e)}function g(){n.remove_sensor_manifold(i,"AUTO_ROTATE"),n.remove_sensor_manifold(i,"DISABLE_AUTO_ROTATE"),t()}},t.is_auto_rotate=function(){var e=o.get_active_camera();return n.check_sensor_manifold(e,"AUTO_ROTATE")},t.check_auto_rotate=function(){var e=o.get_active_camera();return r.get_move_style(e)!=r.MS_STATIC},t.move_camera_to_point=function(e,t,n,o,c){if(r.get_move_style(e)==r.MS_STATIC){if(!h)if(e)if(t){if(n=n||1,o=o||.01,l.is_vector(e))var E=e;else E=i.get_tsr(e,f);if(l.is_vector(t))var T=t;else T=i.get_tsr(t,p);var A=hh(s.get_trans(E,u),s.get_trans(T,d))/n,v=l.quat_to_dir(s.get_quat(E,S),l.AXIS_MZ,u),g=l.quat_to_dir(s.get_quat(T,S),l.AXIS_MZ,d),O=Math.min(Math.abs(Ih(v,g)),1),N=Math.acos(O),R=1e3*Math.max(A,N/o);h=!0;var I=_.animate(0,1,R,(function(t){var r=s.interpolate(E,T,l.smooth_step(t),P);if(m)return _.clear_animation(I),m=!1,void(h=!1);i.set_tsr(e,r),1==t&&(h=!1,c&&c())}))}else a.error("move_camera_to_point(): you must specify the point object");else a.error("move_camera_to_point(): you must specify the camera object")}else a.error("move_camera_to_point(): wrong camera type")},t.rotate_camera=function(e,t,n,o,i){if(r.get_move_style(e)!=r.MS_STATIC){if(!v)if(e)if(t||n){v=!0;var s=0,l=_.animate(0,t,o=o||1e3,(function(n){if(g||Math.abs(n)>=Math.abs(t))return g=!1,_.clear_animation(l),void u();r.rotate_camera(e,s-n,0),s=n})),c=0,E=_.animate(0,n,o,(function(t){if(g||Math.abs(t)>=Math.abs(n))return g=!1,_.clear_animation(E),void u();r.rotate_camera(e,0,c-t),c=t}))}else a.error("rotate_camera(): you must specify the rotation angle");else a.error("rotate_camera(): you must specify the camera object")}else a.error("rotate_camera(): not supported for STATIC cameras");function u(){v&&(v=!1,i&&i())}},t.stop_cam_moving=function(){m=!0},t.stop_cam_rotating=function(){g=!0},t.is_moving=function(){return h},t.is_rotating=function(){return v}})),Db=nA("hmd",(function(e,t){var r=Pb(e),n=mb(e),a=Rb(e),o=Yb(e),_=Lb(e),i=Mb(e),s=xb(e),l=dm(),c=0,E=!1,u=!1,d=!1,T=ih(),f=ih(),p=ih(),P=dm(),S=dm(),A=dm(),h=dm(),v=dm(),m=ih(),g={pivot:ih()};function O(){n.remove_sensor_manifold(null,"VR_CONTROLLERS")}t.HMD_NONE_MOUSE_ALL_AXES=0,t.HMD_ALL_AXES_MOUSE_NONE=1,t.HMD_ROLL_PITCH_MOUSE_YAW=2,t.HMD_ALL_AXES_MOUSE_YAW=3,t.enable_hmd=function(e){var t=a.get_device_by_type_element(a.DEVICE_HMD);t&&function(e,t){if(t){var a=o.get_active_camera();a&&_.request_split_screen((function(){r.is_eye_camera(a)||(E=r.is_target_camera(a),u=r.is_hover_camera(a),d=r.is_static_camera(a),r.eye_setup(a));var e=n.create_elapsed_sensor(),o=n.create_hmd_position_sensor();l=i.get_rotation(a,l),n.create_sensor_manifold(null,"HMD_ROTATE_CAMERA",n.CT_CONTINUOUS,[e,t,o],null,g)}))}function g(t,a,_){if(_>0){var E=o.get_active_camera();if(!E)return;if(r.is_eye_camera(E)){var u=n.get_sensor_payload(t,a,1),d=uh(n.get_sensor_payload(t,a,2),m,T);if(i.set_translation_v(E,d),u)if(1==e){u=mm(v,u,h);var g=wh(s.AXIS_MY,u,T);r.set_vertical_axis(E,g),i.set_rotation_v(E,u)}else if(2==e||3==e){var O=Ym(i.get_rotation(E,S),S),N=mm(l,O,S),R=r.get_vertical_axis(E,T);if(Math.abs(R[2])<Math.PI/4)var I=bh(R,s.AXIS_MY,f);else Math.abs(R[1])<Math.PI/4&&(I=bh(R,s.AXIS_Z,f));Rh(I,I);var b=wh(I,N,p),y=Ah(b,R,-Ih(R,b),p);Rh(y,y);var L=bh(R,I,T),Y=Math.acos(s.clamp(Ih(I,y),0,1)),M=s.sign(Ih(y,L)),x=vm(s.AXIS_Z,-(c+=Y*M),S);if(3==e)var C=mm(x,u,P);else{var w=mm(Ym(s.quat_project(u,s.AXIS_MZ,s.AXIS_Z,s.AXIS_Y,A),A),u,A);C=mm(x,w,P)}g=wh(s.AXIS_MY,C,T),r.set_vertical_axis(E,g),i.set_rotation_v(E,C),Bv(C,l)}}}}}(e,a.get_value_param(t,a.HMD_WEBVR_TYPE)&(a.HMD_WEBVR_MOBILE|a.HMD_WEBVR_DESKTOP|a.HMD_WEBVR1)?n.create_hmd_quat_sensor():n.create_gyro_quat_sensor())},t.check_browser_support=function(){return Boolean(a.can_use_device(a.DEVICE_HMD))},t.enable_controllers=function(e,t){if(O(),e||t){var r=a.get_vr_controller_id(0),o=n.create_gamepad_position_sensor(r),_=n.create_gamepad_orientation_sensor(r),s=a.get_vr_controller_id(1),l=n.create_gamepad_position_sensor(s),c=n.create_gamepad_orientation_sensor(s);n.create_sensor_manifold(null,"VR_CONTROLLERS",n.CT_CONTINUOUS,[o,l,_,c],null,(function(r,a,o){if(e){var _=n.get_sensor_payload(r,a,0),s=n.get_sensor_payload(r,a,2);uh(m,_,_),i.set_translation_v(e,_),i.set_rotation_v(e,s)}if(t){var l=n.get_sensor_payload(r,a,1),c=n.get_sensor_payload(r,a,3);uh(m,l,l),i.set_translation_v(t,l),i.set_rotation_v(t,c)}}))}},t.disable_controllers=O,t.disable_hmd=function(){if(n.check_sensor_manifold(null,"HMD_ROTATE_CAMERA")){n.remove_sensor_manifold(null,"HMD_ROTATE_CAMERA"),_.exit_split_screen();var e=o.get_active_camera();E?r.target_setup(e,g):u?r.hover_setup(e,g):d&&r.static_setup(e,g),r.set_vertical_axis(e,s.AXIS_Z);var t=i.get_rotation(e,P);i.set_rotation_v(e,t)}},t.set_rotate_quat=function(e){Bv(e,v)},t.get_rotate_quat=function(e){return Bv(v,e),e},t.set_position=function(e){Bv(e,m)},t.get_position=function(e){return Bv(m,e),e}})),Fb=nA("fps",(function(e,t){var r=Pb(e),n=mb(e),a=yb(e),o=Yb(e),_=xb(e),i=bb(e),s=vb(e),l=Rb(e),c=Lb(e),E=Mb(e),u=hb(e),d=Db(e),T=mN(e),f="url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyBpZD0ic3ZnMzQwMCIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQuMTExbW0iIHdpZHRoPSIxNC4xMTFtbSIgdmVyc2lvbj0iMS4xIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHZpZXdCb3g9IjAgMCA0OS45OTk5OTggNDkuOTk5OTk5Ij4gPG1ldGFkYXRhIGlkPSJtZXRhZGF0YTM0MDUiPjxyZGY6UkRGPjxjYzpXb3JrIHJkZjphYm91dD0iIj48ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD48ZGM6dHlwZSByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIi8+PGRjOnRpdGxlLz48L2NjOldvcms+PC9yZGY6UkRGPiA8L21ldGFkYXRhPiA8ZyBpZD0ibGF5ZXIxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0xMDAyLjQpIj48cmVjdCBpZD0icmVjdDI0MTI2IiBvcGFjaXR5PSIwLjU0MyIgZmlsbC1vcGFjaXR5PSIuODM2MTEiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeT0iMTAwMi40IiB4PSIwIiBmaWxsPSIjZmZmIi8+PHBhdGggaWQ9InBhdGgyNDEyOCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0ibTM5LjE0MiAxMDMzLjUtMTQuMTQyLTE0LjE0Mi0xNC4xNDIgMTQuMTQyIiBzdHJva2U9IiM2ZTZlNmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+IDwvZz48L3N2Zz4=);",p=(.1-Math.PI)/2,P=(Math.PI-.1)/2,S=new Float32Array(2),A=1,h=4e-4,v=0,m=null,g=null,O={enable_cb:null,disable_cb:null},N=function(){},R=0,I=4,b=!1,y=new Float32Array(2),L=new Float32Array(3),Y=new Float32Array(3);function M(e,t,n){var _=o.get_active_camera();r.rotate_camera(_,t,n);var i=r.get_camera_angles_char(_,y);a.set_character_rotation_h(e,i[0]),a.set_character_vert_move_dir_angle(e,i[1])}function x(e,t,r,a){if(Math.abs(S[0])>.01||Math.abs(S[1])>.01){var o=n.get_sensor_value(e,t,0),i=_.smooth(S[0],0,o,C()),s=_.smooth(S[1],0,o,C());S[0]-=i,S[1]-=s,a(e,-i*h,-s*h)}}function C(){return.2*A}function w(e){return"function"==typeof(e.requestPointerLock||e.webkitRequestPointerLock||e.mozRequestPointerLock)}function U(e,t){if(w(e)&&!i.detect_mobile()){var s=n.create_plock_mouse_sensor(e),c=g||n.create_plock_sensor(e);g=c,n.create_sensor_manifold(t,"FPS_PLOCK",n.CT_CONTINUOUS,[s,c],(function(e){return e[0]&&e[1]}),(function(e,t,r){if(r>0){var a=n.get_sensor_payload(e,t,0);N(e,-a.coords[0]*h,-a.coords[1]*h)}})),n.create_sensor_manifold(null,"FPS_ACTIVATE_PLOCK",n.CT_TRIGGER,[c],(function(e){return e[0]}),(function(t,r,n){n>0?O.enable_cb&&O.enable_cb(e):O.disable_cb&&O.disable_cb(e)}))}else{if(i.detect_mobile())var E=n.create_touch_move_sensor("XY",e),u=n.create_touch_click_sensor(e),d=4;else{E=n.create_mouse_move_sensor("XY",e),u=n.create_mouse_click_sensor(e),d=2;var T=o.get_active_camera(),f=n.create_elapsed_sensor(),A=n.create_gamepad_axis_sensor(l.GMPD_AXIS_2),v=n.create_gamepad_axis_sensor(l.GMPD_AXIS_3);n.create_sensor_manifold(t,"FPS_CAM_ROT",n.CT_CONTINUOUS,[f,A,v],(function(e){return Math.abs(e[1])>.05||Math.abs(e[2])>.05}),(function(e,t,o){if(o>0){var i=n.get_sensor_value(e,t,0);!function(e,t,o,i){var s=n.get_sensor_value(e,o,1),l=n.get_sensor_value(e,o,2),c=2.5*i,E=-(Math.abs(l)<.05?0:l)*c,u=-(Math.abs(s)<.05?0:s)*c;E=_.clamp(E,p,P),r.rotate_camera(t,u,E);var d=r.get_camera_angles(t,y);a.set_character_rotation_h(e,d[0]+Math.PI)}(e,T,t,i)}}))}var m=0,R=0;n.create_sensor_manifold(null,"FPS_DRAG_PRESS",n.CT_SHOT,[u],(function(e){return e[0]}),(function(e,t,r){if(1==r){var a=n.get_sensor_payload(e,t,0).coords;m=a[0],R=a[1]}})),n.create_sensor_manifold(null,"FPS_DRAG_MOVE",n.CT_CONTINUOUS,[E,u],(function(e){return e[0]&&e[1]}),(function(e,t,r){if(1==r){var a=n.get_sensor_payload(e,t,0).coords;S[0]+=(a[0]-m)*d,S[1]+=(a[1]-R)*d,m=a[0],R=a[1]}}));var I=n.create_elapsed_sensor();n.create_sensor_manifold(t,"FPS_SMOOTH_DRAG",n.CT_CONTINUOUS,[I],null,x,N)}}var k=null,D=null;function F(){var e=d.check_browser_support()&&!i.detect_mobile(),t=l.get_device_by_type_element(l.DEVICE_HMD);return t&&(e=e&&l.get_value_param(t,l.HMD_WEBVR_TYPE)&l.HMD_WEBVR1),e}function G(){return m||(m={nodes:[],current_node:null,lock:!1,last_state:null}),m}function K(e,t,r,n,a,o){e.nodes.push({id:t,allowed_ids:r,call_switch:n,call_before_switch:a,call_after_switch:o})}function B(e){for(var t=[],r=0;r<e.nodes;r++){var n=e.nodes[r].id;if(t.indexOf(n)>=0)return!1;t.push(n)}for(r=0;r<e.nodes;r++)for(var a=e.nodes[r],o=0;o<a.allowed_ids.length;o++)if(t.indexOf(a.allowed_ids[o])<0)return!1;return!0}function X(e,t){for(var r=null,n=0;n<e.nodes.length;n++)if(e.nodes[n].id==t){r=e.nodes[n];break}return r}function H(e,t){var r=X(e,t);return e.current_node=r,r}function j(e){return e.current_node}function z(e,t){if(e.last_state=t,e.lock)return!1;var r=j(e),n=r.id;if(r.allowed_ids.indexOf(t)>=0){var a=!0;if(r.call_before_switch&&(a=r.call_before_switch(n,t)),a)return H(e,t),r.call_switch&&r.call_switch(n,t),r.call_after_switch&&r.call_after_switch(n,t),!0}return!1}function Q(e,t,r){if(t.length){for(var a=[],o=0;o<t.length;o++)if("number"==typeof t[o])a.push(t[o]<300?n.create_keyboard_sensor(t[o]):t[o]<326?n.create_gamepad_btn_sensor(t[o],R):n.create_gamepad_axis_sensor(t[o]));else if("string"==typeof t[o]){var _=document.getElementById(t[o]);_?a.push(n.create_touch_click_sensor(_)):T.error("Couldn't find element with "+t[o]+" ID.")}var i=function(e){return!1},s=n.CT_SHOT,l=function(e,t,r,n){};switch(e){case 1:s=n.CT_TRIGGER,i=function(e){for(var t=0;t<e.length;t++)if(e[t])return!0;return!1},l=function(e,t,n,a){r(n>0?1:0)};break;case 2:s=n.CT_TRIGGER,i=function(e){for(var t=0;t<e.length;t++)if(e[t])return!0;return!1},l=function(e,t,n,a){r(n<0?1:0)};break;case 3:s=n.CT_CONTINUOUS,i=function(e){for(var t=0;t<e.length;t++)if(Math.abs(e[t])>.05)return!0;return!1},l=function(e,t,a,o){if(a>0)for(var _=0;_<o;_++){var i=n.get_sensor_value(e,t,_);if(Math.abs(i)>.05)return void r(i)}else r(0)}}var c="FPS_USER_CONTROL_ACTION_"+v.toString();n.create_sensor_manifold(null,c,s,a,i,l,a.length),v++}}t.append_switch_vr_cbs=function(e,t){k=e,D=D},t.CS_STAY=0,t.CS_WALK=1,t.CS_RUN=2,t.CS_FLY=3,t.CS_CLIMB=4,t.AT_PRESSED=1,t.AT_RELEASED=2,t.AT_CONTINUOUS=3,t.bind_action=Q,t.enable_fps_controls=function(e){var t=(e=e||{lock_camera:!0}).character||o.get_first_character();if(t){var _=e.element||s.get_canvas(),T=e.motion_cb||null;R=e.gamepad_id||0;var p=e.forward_sens||[n.KEY_W,l.GMPD_BUTTON_12],P=e.backward_sens||[n.KEY_S,l.GMPD_BUTTON_13],S=e.right_sens||[n.KEY_D,l.GMPD_BUTTON_15],A=e.left_sens||[n.KEY_A,l.GMPD_BUTTON_14],h=e.jump_sens||[n.KEY_SPACE,l.GMPD_BUTTON_1],v=e.run_sens||[n.KEY_SHIFT,l.GMPD_BUTTON_7],g=e.fly_sens||[];i.detect_mobile()&&(p.push("B4W_DEFAULT_BTN_1"),P.push("B4W_DEFAULT_BTN_2"));var O={forward_sens_arr:p,backward_sens_arr:P,right_sens_arr:S,left_sens_arr:A,jump_sens_arr:h,run_sens_arr:v,fly_sens_arr:g,move_dir_cd:e.move_dir_cd||null};N=e.rotation_cb||M,function(e,t){var n=o.get_active_camera();if(t){var _=E.get_translation(n,L);dh(_,E.get_translation(e,Y),_),u.append_stiff_trans(n,e,_)}var i=r.get_camera_angles_char(n,y);a.set_character_rotation_h(e,i[0]),a.set_character_vert_move_dir_angle(e,i[1])}(t,void 0===e.lock_camera||e.lock_camera),function(e,t){F()&&function(e,t){l.add_click_listener(e,(function(){c.request_fullscreen_hmd(e,(function(){!function(e,t){n.check_sensor_manifolds(t,"FPS_PLOCK")&&n.remove_sensor_manifold(t,"FPS_PLOCK"),n.check_sensor_manifolds(null,"FPS_ACTIVATE_PLOCK")&&n.remove_sensor_manifold(null,"FPS_ACTIVATE_PLOCK"),n.check_sensor_manifolds(t,"FPS_CAM_ROT")&&n.remove_sensor_manifold(t,"FPS_CAM_ROT"),n.check_sensor_manifolds(null,"FPS_DRAG_PRESS")&&n.remove_sensor_manifold(null,"FPS_DRAG_PRESS"),n.check_sensor_manifolds(null,"FPS_DRAG_MOVE")&&n.remove_sensor_manifold(null,"FPS_DRAG_MOVE"),n.check_sensor_manifolds(t,"FPS_SMOOTH_DRAG")&&n.remove_sensor_manifold(t,"FPS_SMOOTH_DRAG")}(0,t),d.enable_hmd(d.HMD_ALL_AXES_MOUSE_NONE),function(e){var t=n.create_elapsed_sensor(),_=o.get_active_camera();n.create_sensor_manifold(e,"FPS_CHARECTER_VR_ROT",n.CT_CONTINUOUS,[t],null,(function(e,t,n){var o=r.get_camera_angles_char(_,y)[0];a.set_character_rotation_h(e,o)}))}(t),k&&k()}),(function(){!function(e){n.remove_sensor_manifold(e,"FPS_CHARECTER_VR_ROT")}(t),d.disable_hmd(),U(e,t),D&&D()}))}))}(e,t),U(e,t)}(_,t),function(e,t,r,n){i.detect_mobile()&&function(e,t){var r=document.createElement("div");r.style.cssText="position: absolute;left: 10px;bottom: 70px;width: 53px;height: 53px;background-image: "+f,r.setAttribute("id","B4W_DEFAULT_BTN_1");var n=document.createElement("div");n.style.cssText="position: absolute;left: 10px;bottom: 10px;width: 53px;height: 53px;background-image: "+f+"transform: rotate(180deg);transform-origin: center;",n.setAttribute("id","B4W_DEFAULT_BTN_2"),t.appendChild(r),t.appendChild(n)}(0,e.parentElement?e.parentElement:e);var o=function(e){var t=G(),r=function(t,r){switch(r){case 0:case 1:a.set_character_move_type(e,a.CM_WALK);break;case 2:a.set_character_move_type(e,a.CM_RUN);break;case 3:a.set_character_move_type(e,a.CM_FLY);break;case 4:a.set_character_move_type(e,a.CM_CLIMB)}};return K(t,0,[1,3,2,4],r,null,null),K(t,1,[2,3,4,0],r,null,null),K(t,2,[1,3,4,0],r,null,null),K(t,3,[1],r,null,null),K(t,4,[1,2,0],r,null,null),B(t),H(t,0),m}(t),_={left:0,right:0,forw:0,back:0},s=-1,c=n.move_dir_cd,E=function(){return!b||(_.left=0,_.right=0,_.forw=0,_.back=0,!1)},u=function(e,t){var r=j(o).id;e||t||4==r?0==r&&z(o,s>0?2:1):z(o,0)},d=function(e){if(E()){var n=_.forw+_.back;_.back=-(e=(e=e>0?1:e)<0?-1:e);var o=_.forw+_.back,i=_.left+_.right;a.set_character_move_dir(t,o,i),r&&r(o,i),u(o,i),c&&n!=o&&c(o,i,0)}},T=function(e){if(E()){4==j(o).id&&(e=0);var n=_.left+_.right;_.right=-(e=(e=e>0?1:e)<0?-1:e);var i=_.forw+_.back,s=_.left+_.right;a.set_character_move_dir(t,i,s),r&&r(i,s),u(i,s),c&&n!=s&&c(i,s,0)}},p=n.backward_sens_arr,P=n.right_sens_arr,S=n.left_sens_arr,A=n.jump_sens_arr,h=n.run_sens_arr,v=n.fly_sens_arr;Q(1,n.forward_sens_arr,(function(e){if(E()){var n=_.forw+_.back;_.forw=e;var o=_.forw+_.back,i=_.left+_.right;a.set_character_move_dir(t,o,i),r&&r(o,i),u(o,i),c&&n!=o&&c(o,i,0)}})),Q(1,p,d),Q(1,P,T),Q(1,S,(function(e){if(E()){4==j(o).id&&(e=0);var n=_.left+_.right;_.left=e;var i=_.forw+_.back,s=_.left+_.right;a.set_character_move_dir(t,i,s),r&&r(i,s),u(i,s),c&&n!=s&&c(i,s,0)}})),Q(1,A,(function(e){E()&&e>0&&(a.character_jump(t),c&&c(_.forw+_.back,_.left+_.right,1))})),Q(3,[l.GMPD_AXIS_0],T),Q(3,[l.GMPD_AXIS_1],d),Q(1,h,(function(e){s=e,Math.abs(_.forw+_.back)+Math.abs(_.left+_.right)?(z(o,e>0?2:1),c&&c(_.forw+_.back,_.left+_.right,0)):z(o,0)})),Q(1,v,(function(e){if(e>0){var t=j(m).id;z(o,1==t||0==t?3:1)}}))}(_,t,T,O)}},t.disable_fps_controls=function(e,t){e=e||o.get_first_character(),t=t||s.get_container(),e&&(function(){for(var e=0;e<v;e++)n.remove_sensor_manifold(null,"FPS_USER_CONTROL_ACTION_"+e.toString())}(),function(e,t){w(t)&&!i.detect_mobile()&&(O.disable_cb&&O.disable_cb(t),n.remove_sensor_manifold(e,"FPS_PLOCK"),n.remove_sensor_manifold(null,"FPS_ACTIVATE_PLOCK"))}(e,t),function(e,t){w(t)&&!i.detect_mobile()||(n.remove_sensor_manifold(e,"FPS_CAM_ROT"),n.remove_sensor_manifold(e,"FPS_DRAG_PRESS"),n.remove_sensor_manifold(e,"FPS_DRAG_MOVE"),n.remove_sensor_manifold(e,"FPS_SMOOTH_DRAG"))}(e,t),function(e){F()&&n.remove_sensor_manifold(e,"FPS_CHARECTER_VR_ROT")}(e),function(e,t){if(i.detect_mobile()){var r=document.getElementById("B4W_DEFAULT_BTN_1"),n=document.getElementById("B4W_DEFAULT_BTN_2");r&&t.removeChild(r),n&&t.removeChild(n)}}(0,t))},t.set_state_change_cb=function(e,t){!function(e,t,r){X(e,t).call_after_switch=r}(m,e,t)},t.set_cam_smooth_factor=function(e){n.set_plock_smooth_factor(e),function(e){A=e}(e)},t.get_cam_smooth_factor=function(){return A},t.set_cam_sensitivity=function(e){h=e/2e5},t.get_cam_sensitivity=function(){return 2e5*h},t.set_plock_enable_cb=function(e){O.enable_cb=e},t.set_plock_disable_cb=function(e){O.disable_cb=e},t.get_character_state=function(){return j(m).id},t.add_new_state=function(){return I++},t.add_state=function(e,t,r){var n=G();K(n,e,t,r,null,null),B(n)||T.error("Incorrect state machine.")},t.switch_state=function(e){z(G(),e)},t.lock_character=function(){G().lock=!0},t.unlock_character=function(){G().lock=!1},t.is_character_locked=function(){return G().lock},t.set_rotation_cb=function(e){N=e||M},t.freeze_movements=function(){b=!0},t.unfreeze_movements=function(){b=!1}})),Gb=nA("storage",(function(e,t){var r=mN(e),n="b4w",a=null;function o(e){return a[e||n]?JSON.parse(a[e||n]):{}}t.init=function(e){e?"b4w"!==e?n=e:r.error("b4w prefix denied"):r.warn("Prefix should be a string. Last declared storage prefix will be used.")},t.set=function(e,t,r){var _=o(r);_[e]=String(t),function(e,t){a[t||n]=JSON.stringify(e)}(_,r)},t.cleanup=function(e){delete a[e||n]},t.get=function(e,t){var r=o(t);return r[e]?r[e]:""},t.debug=function(e){r.log(o(e||n))},function(){try{a=window.localStorage;try{a.tmp=null,delete a.tmp}catch(YM){r.warn("localStorage quota is limited. Disabling localStorage"),a=null}}catch(YM){r.warn("Applying chrome localStorage bug workaround"),a=null}a||(r.warn("localStorage is not available, initializing temporary storage"),a={})}()})),Kb=nA("gp_conf",(function(e,t){var r=vb(e),n=mb(e),a=Rb(e),o=Gb(e),_="url('data:image/svg+xml;base64,",i=new RegExp("#5276cf","g"),s="Click on the buttons & arrows to setup your controller",l={};l[a.GMPD_BUTTON_12]=a.GMPD_BUTTON_12,l[a.GMPD_BUTTON_13]=a.GMPD_BUTTON_13,l[a.GMPD_BUTTON_15]=a.GMPD_BUTTON_15,l[a.GMPD_BUTTON_14]=a.GMPD_BUTTON_14,l[a.GMPD_BUTTON_3]=a.GMPD_BUTTON_3,l[a.GMPD_BUTTON_0]=a.GMPD_BUTTON_0,l[a.GMPD_BUTTON_1]=a.GMPD_BUTTON_1,l[a.GMPD_BUTTON_2]=a.GMPD_BUTTON_2,l[a.GMPD_BUTTON_5]=a.GMPD_BUTTON_5,l[a.GMPD_BUTTON_7]=a.GMPD_BUTTON_7,l[a.GMPD_BUTTON_4]=a.GMPD_BUTTON_4,l[a.GMPD_BUTTON_6]=a.GMPD_BUTTON_6,l[a.GMPD_BUTTON_8]=a.GMPD_BUTTON_8,l[a.GMPD_BUTTON_9]=a.GMPD_BUTTON_9,l[a.GMPD_BUTTON_10]=a.GMPD_BUTTON_10,l[a.GMPD_BUTTON_11]=a.GMPD_BUTTON_11,l[a.GMPD_BUTTON_16]=a.GMPD_BUTTON_16;var c='<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',E='<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',u='<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',d='<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',T='<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',f='<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',p='<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',P='<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',S='<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>',A='<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',h='<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>',v='<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>',m='<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',g='<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',O='<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',N='<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',R='<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>',I='<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>',b='<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>',y=[],L=-1,Y=null,M=0,x=null,C=null,w=null,U=null,k=null,D=null,F=[],G=[],K=[],B=[],X=!0,H={};function j(e,t,r,a){var o=20*n.get_sensor_value(t,r,a),_=20*n.get_sensor_value(t,r,a+1);e.style.transform="translate3d("+o+"px, "+_+"px, 0px) rotate(0rad)"}function z(e,t,r){if(!(r+1>2*B.length)){var o=n.get_sensor_value(e,t,r),i=n.get_sensor_value(e,t,r+1);if(H[r]>-2){var l=o-H[r],c=i-H[r+1],E=B[Math.floor(r/2)],u=E.getAttribute("data-svgid");if(0==M)E.style.backgroundImage=l||c?_+btoa(y[u].replace("#e6e6e6","#00ff00"))+"')":_+btoa(y[u])+"')";else if(2==M){var d=a.get_moved_gmpd_axis(L);if(d>=0){d%2!=0&&d--,M=0,E.style.backgroundImage=_+btoa(y[u])+"')";var T=parseFloat(Y.getAttribute("data-key"));a.set_gamepad_key(L,T,d),a.set_gamepad_key(L,T+1,d+1),Y=null,document.getElementById("action_label").textContent=s}}}H[r]=o,H[r+1]=i}}function Q(e,t,r){if(!(r>=B.length)){var o=n.get_sensor_value(e,t,r);if(H[r]>-2){var i=o-H[r],l=B[r],c=l.getAttribute("data-svgid");if(0==M)l.style.backgroundImage=i?_+btoa(y[c].replace("#e6e6e6","#00ff00"))+"')":_+btoa(y[c])+"')";else if(2==M){var E=a.get_moved_gmpd_axis(L);if(E>=0){M=0,l.style.backgroundImage=_+btoa(y[c])+"')";var u=parseFloat(Y.getAttribute("data-key"));a.set_gamepad_key(L,u,E),Y=null,document.getElementById("action_label").textContent=s}}}H[r]=o}}function V(e,t,r){if(0==M){if(t&&"B"==e.getAttribute("data-colorstate")){var n=y[r];e.style.backgroundImage=_+btoa(n.replace(i,"#00ff00"))+"')",e.setAttribute("data-colorstate","G")}t||"B"==e.getAttribute("data-colorstate")||(n=y[r],e.style.backgroundImage=_+btoa(n)+"')",e.setAttribute("data-colorstate","B"))}else{var l=a.get_pressed_gmpd_btn(L);if(l>=0&&Y&&1==M){var c=Y.getAttribute("data-key");a.set_gamepad_key(L,c,l),function(e,t){var r=o.get(L+"_gmpd_stngs","b4w")||"{}",n=JSON.parse(r);n[e]=t,o.set(L+"_gmpd_stngs",JSON.stringify(n),"b4w")}(c,l),Y=null,document.getElementById("action_label").textContent=s,M=0}}}function q(){F.length=0;for(var e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],t=0;t<e.length;t++)e[t]&&F.push(e[t]);return F}function W(e){var t=o.get(e+"_gmpd_stngs","b4w");t?function(e,t){for(var r in e)a.set_gamepad_key(t,r,e[r])}(JSON.parse(t),e):function(e){var t=JSON.stringify(l);o.set(e+"_gmpd_stngs",t,"b4w")}(e)}function J(e){X=!0;var t=document.createElement("div"),r=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),s=document.createElement("div"),l=document.createElement("div"),m=document.createElement("div"),g=document.createElement("div"),O=document.createElement("div"),N=document.createElement("div"),R=document.createElement("div"),I=document.createElement("div"),b=document.createElement("div"),L=document.createElement("div"),Y=document.createElement("div"),M=document.createElement("div"),x=document.createElement("div"),w=document.createElement("div"),U=document.createElement("div"),k=document.createElement("div"),D=document.createElement("div"),F=document.createElement("div");C=t,t.style.cssText="position: absolute;height: auto;background-image: "+_+btoa('<svg id="svg26627" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="128.51mm" viewBox="0 0 636.63517 455.33329" width="179.67mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/"><defs id="defs26629"><linearGradient id="linearGradient4691"><stop id="stop4693" offset="0"/><stop id="stop4695" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4358"><stop id="stop4360" stop-color="#2e2e2e" offset="0"/><stop id="stop4362" stop-color="#2e2e2e" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4364" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="matrix(-1 0 0 1 1531.4 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4368" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="translate(-896.37 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4430" x1="959.32" gradientUnits="userSpaceOnUse" y1="653.07" gradientTransform="matrix(-1 0 0 1 1531.4 70.097)" x2="1467.6" y2="653.07"><stop id="stop4426" stop-color="#4f4f4f" offset="0"/><stop id="stop4428" stop-color="#4f4f4f" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4701" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="translate(-52.276 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4713" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="matrix(-1 0 0 1 689.01 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4725" x1="367.39" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="125.6" gradientTransform="matrix(-1.3272 0 0 .68317 806.95 579.14)" x2="367.39" y2="116.11"/></defs><metadata id="metadata26632"><rdf:RDF><cc:Work rdf:about="">    <dc:format>image/svg+xml</dc:format>    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>    <dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -597.03)"><g id="g20" fill-rule="evenodd"><path id="path4209" fill="#434343" d="m576.71 1052.4c42.015-1.9097 64.296-46.468 59.204-122.86-5.0928-76.387-27.374-175.69-44.562-224.7-17.188-49.015-25.501-62.531-26.737-65.565-3.7697-9.2504-11.278-19.949-62.379-27.691-28.97-4.3891-16.697-7.9577-27.084-9.4696-17.96-2.6141-43.609-1.229-52.203 1.6354-8.594 2.8645-12.709 29.16-24.486 35.207-11.777 6.0473-19.416 10.185-80.149 10.185s-68.372-4.1376-80.149-10.185c-11.777-6.0473-18.113-32.099-25.736-36.993-11.183-7.1796-26.985-5.6722-54.891-0.57481-5.64 1.0302-1.1304 7.6212-18.165 12.509-32.913 9.4438-52.094 3.7056-65.087 20.831-1.9807 2.6106-11.822 21.096-29.01 70.111-17.179 48.95-39.46 148.25-44.553 224.64-5.0929 76.39 17.188 120.99 59.204 122.89 73.339-1.7 55.219-116.53 258.4-116.53s185.05 114.82 258.4 116.49z"/><path id="path4366" fill="url(#linearGradient4368)" d="m249.77 838.51c-107.76 0-171.55 96.288-176.84 121.23-5.2294 24.634-17.658 55.705 3.8195 53.789 9.6996-0.8655 18.053-15.713 37.559-38.193 18.78-21.643 41.379-54.425 96.763-54.425s73.209-44.877 75.119-53.152c1.9098-8.2752 2.4146-27.976-36.418-29.25z"/><path id="path4217" fill="url(#linearGradient4364)" d="m385.23 838.51c107.76 0 171.55 96.288 176.84 121.23 5.2293 24.634 17.658 55.705-3.8195 53.789-9.6996-0.8655-18.053-15.713-37.559-38.193-18.78-21.643-41.379-54.425-96.763-54.425s-73.209-44.877-75.119-53.152c-1.9098-8.2752-2.4146-27.976 36.418-29.25z"/><path id="path4370" fill="url(#linearGradient4430)" d="m572.06 654.81c-60.48-19.09-76.79-18.6-89.84-17.96-13.05 0.63657-22.638 16.617-45.237 49.4s-67.48 125.27-116.23 125.27c-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-32.008-48.942-45.059-49.579-13.05-0.63648-35.251 1.8354-95.728 20.932l1.1161-2.3404c60.494-19.1 81.754-20.83 94.804-20.19 13.05 0.63657 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63648 28.783-1.6248 89.26 17.472"/><path id="path4315" fill="#343434" d="m570.99 652.48c-60.477-19.097-76.074-18.269-89.124-17.633-13.05 0.63658-22.281 14.832-44.88 47.614-22.599 32.783-67.48 125.27-116.23 125.27-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-31.83-46.978-44.88-47.614-13.05-0.63648-34.715 1.2996-95.192 20.396l1.1161-2.3404c60.474-19.1 81.024-22.26 94.074-21.62 13.05 0.63658 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63647 27.71-0.17274 88.186 18.924"/></g><g id="g15645" transform="matrix(.75439 0 0 1 1558.5 -6638.3)" fill-rule="evenodd"><rect id="rect15584" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6558.3" x="100.71" fill="#4164bb"/><rect id="rect15331" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6554.6" x="100.71" fill="#5276cf"/></g><text id="text15623-9" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="22px" line-height="430.99999428%" y="-53.755863" x="1792.7805" font-family="&apos;Noto Sans CJK TC&apos;" fill="#ffffff"><tspan id="tspan15625-5" y="-53.755863" x="1792.7805"/></text><text id="text15657" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="13px" line-height="430.99999428%" y="-3.7607465" x="1670.2437" font-family="&apos;Noto Sans CJK TC&apos;" fill="#828282"><tspan id="tspan15659" y="-3.7607465" x="1670.2437"/></text><g id="g34" fill-rule="evenodd"><path id="path4675" fill="#303030" d="m551.75 628.4c9.3003 4.1796 8.2375 11.558 2.1302 9.9581-6.1073-1.6003-33.792-9.1405-46.239-11.577-12.446-2.4363-34.904-3.0623-36.951-4.0165-2.0474-0.95416 0.93313-7.7247 5.491-7.3449 23.258 0.91012 59.905 6.0339 75.569 12.98z"/><path id="path4677" fill="#303030" d="m474.88 602.61c3.6488 0.63684 4.1169 1.3708 2.4115 5.2499-0.80967 1.8416-1.261 3.904-3.4715 3.7336-4.456-0.34344-16.578-1.2846-25.692-1.3764-9.1139-0.0918-23.83 1.217-25.307 0.79399-1.4771-0.42301-1.8834-4.9141 1.7769-6.7458 4.6221-1.3593 38.698-3.2021 50.281-1.6553z"/><path id="path4699" opacity=".384" fill="url(#linearGradient4701)" d="m475.53 611.7c-11.693-0.63604-8.4597-0.73151-44.068 54.448-6.5182 8.6489-22.874 37.231-36.865 35.326-6.7491-1.4177 15.436-67.299 22.724-75.767 11.112-12.911 19.255-16.122 58.209-14.007z"/><path id="path4703" fill="#303030" d="m84.068 628.4c-9.3003 4.1796-8.2375 11.558-2.1302 9.9581 6.1073-1.6003 33.792-9.1405 46.239-11.577 12.446-2.4363 34.904-3.0623 36.951-4.0165 2.0474-0.95416-0.93313-7.7247-5.491-7.3449-23.258 0.91012-59.905 6.0339-75.569 12.98z"/><path id="path4705" fill="#303030" d="m161.86 602.61c-3.6488 0.63684-4.1169 1.3708-2.4115 5.2499 0.80967 1.8416 1.261 3.904 3.4715 3.7336 4.456-0.34344 16.578-1.2846 25.692-1.3764 9.1139-0.0918 23.83 1.217 25.307 0.79399 1.4771-0.42301 1.8834-4.9141-1.7769-6.7458-4.6221-1.3593-38.698-3.2021-50.281-1.6553z"/><path id="path4711" opacity=".384" fill="url(#linearGradient4713)" d="m161.2 611.7c11.693-0.63604 8.4597-0.73151 44.068 54.448 6.5182 8.6489 22.874 37.231 36.865 35.326 6.7491-1.4177-15.436-67.299-22.724-75.767-11.112-12.911-19.255-16.122-58.209-14.007z"/><path id="path4717" opacity=".115" fill="url(#linearGradient4725)" d="m413.37 645.84c-9.0496 10.007-29.401 19.937-36.775 19.937h-52.205c-31.171 0-37.359 0.34506-47.75 0.51758-10.39 0.17253-18.682 0.65628-23.653-3.278-5.0513-3.9977-24-15.425-24-15.425 53.346 4.1464 144.49 4.3368 184.38-1.7523z"/></g></g><g id="layer1-0" fill-rule="evenodd" transform="translate(159.08 -720.76)"><g id="g4527-3" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g><g id="layer1-7" fill-rule="evenodd" transform="translate(352.57 -719.72)"><g id="g4527-3-4" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8-9" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3-5" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506-2" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g></svg>')+"');width: 637px;height: 455px;background-size: 100% 100%;left: 50%;margin-bottom: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);bottom: 0px;",r.style.cssText="background-image: "+_+btoa('<svg id="svg3904" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="35.924mm" width="35.926mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 127.29808 127.28933"><metadata id="metadata3909"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -925.07)"><ellipse id="circle4330" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="63.649" ry="63.645" cy="988.72" cx="63.649" fill="#303030"/><ellipse id="circle4223" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="59.705" ry="59.701" cy="988.72" cx="63.649" fill="#4c4c4c"/></g></svg>')+"');position: absolute;top: 47px;left: 65px;width: 135px;height: 135px;",n.style.cssText="background-image: "+_+btoa(c)+"');width: 36px;height: 38px;left: 49px;top: 8px;position: absolute;",o.style.cssText="background-image: "+_+btoa(E)+"');width: 38px;height: 36px;top: 47px;left: 84px;position: absolute;",s.style.cssText="background-image: "+_+btoa(u)+"');width: 36px;height: 38px;bottom: 11px;left: 51px;position: absolute;",l.style.cssText="background-image: "+_+btoa(d)+"');width: 38px;height: 36px;top: 47px;left: 13px;position: absolute;",m.style.cssText="position: absolute;top: 55px;left: 434px;width: 150px;height: 150px;",g.style.cssText="background-image: "+_+btoa(T)+"');width: 50px;height: 50px;left: 53px;top: 0px;position: absolute;",O.style.cssText="background-image: "+_+btoa(T)+"');width: 50px;height: 50px;left: 107px;top: 51px;position: absolute;",N.style.cssText="background-image: "+_+btoa(T)+"');width: 50px;height: 50px;left: 53px;bottom: 0px;position: absolute;",R.style.cssText="background-image: "+_+btoa(T)+"');width: 50px;height: 50px;top: 51px;position: absolute;",I.style.cssText="background-image: "+_+btoa(f)+"');position: absolute;top: 222px;left: 183px;width: 85px;height: 85px;",b.style.cssText="background-image: "+_+btoa(f)+"');position: absolute;top: 223px;left: 376px;width: 85px;height: 85px;",L.style.cssText="background-image: "+_+btoa(p)+"');position: absolute;top: 76px;left: 227px;width: 34px;height: 34px;",Y.style.cssText="background-image: "+_+btoa(p)+"');position: absolute;top: 76px;left: 376px;width: 34px;height: 34px;",M.style.cssText="background-image: "+_+btoa(S)+"');position: absolute;top: 4px;left: 78px;width: 79px;height: 33px;",x.style.cssText="background-image: "+_+btoa(A)+"');position: absolute;top: 4px;left: 477px;width: 79px;height: 33px;",w.style.cssText="background-image: "+_+btoa(P)+"');position: absolute;top: -7px;left: 425px;width: 50px;height: 17px;",U.style.cssText="background-image: "+_+btoa(P)+"');position: absolute;top: -7px;left: 164px;width: 50px;height: 17px;",k.style.cssText="background-image: "+_+btoa(h)+"');position: absolute;top: 68px;left: 274px;width: 92px;height: 92px;",D.style.cssText="background-image: "+_+btoa(v)+"');position: absolute;top: 186px;left: 148px;width: 157px;height: 157px;",F.style.cssText="background-image: "+_+btoa(v)+"');position: absolute;top: 187px;left: 339px;width: 157px;height: 157px;",t.appendChild(D),t.appendChild(F),r.appendChild(n),r.appendChild(o),r.appendChild(s),r.appendChild(l),t.appendChild(r),m.appendChild(g),m.appendChild(O),m.appendChild(N),m.appendChild(R),t.appendChild(m),t.appendChild(I),t.appendChild(b),t.appendChild(L),t.appendChild(Y),t.appendChild(M),t.appendChild(x),t.appendChild(w),e.appendChild(t),t.appendChild(U),t.appendChild(k),G.length=0,y.length=0,K.length=0,B.length=0,G.push(N,O,R,g,M,x,U,w,L,Y,I,b,n,s,l,o,k),y.push(T,T,T,T,S,A,P,P,p,p,f,f,c,u,d,E,h),K.push(I,I,b,b),B.push(D,F);for(var H=0;H<G.length;H++)G[H].setAttribute("id","pad_btn_"+H),G[H].setAttribute("data-colorstate","B"),G[H].setAttribute("data-key",H),G[H].setAttribute("data-svgid",H);D.setAttribute("id","pad_left_axis"),D.setAttribute("data-colorstate","GR"),D.setAttribute("data-key",a.GMPD_AXIS_0),D.setAttribute("data-svgid",y.length),F.setAttribute("id","pad_right_axis"),F.setAttribute("data-colorstate","GR"),F.setAttribute("data-key",a.GMPD_AXIS_2),F.setAttribute("data-svgid",y.length+1),y.push(v,v),te(G,i),te(B,"#e6e6e6")}function Z(e){return[n.create_gamepad_axis_sensor(a.GMPD_AXIS_0,e),n.create_gamepad_axis_sensor(a.GMPD_AXIS_1,e),n.create_gamepad_axis_sensor(a.GMPD_AXIS_2,e),n.create_gamepad_axis_sensor(a.GMPD_AXIS_3,e),n.create_gamepad_axis_sensor(a.GMPD_AXIS_4,e),n.create_gamepad_axis_sensor(a.GMPD_AXIS_5,e),n.create_gamepad_axis_sensor(a.GMPD_AXIS_6,e),n.create_gamepad_axis_sensor(a.GMPD_AXIS_7,e),n.create_gamepad_axis_sensor(a.GMPD_AXIS_8,e),n.create_gamepad_axis_sensor(a.GMPD_AXIS_9,e),n.create_gamepad_axis_sensor(a.GMPD_AXIS_10,e),n.create_gamepad_axis_sensor(a.GMPD_AXIS_11,e)]}function $(e,t){var r=document.createElement("input");r.style.cssText="display: inline-block;position = relative;",r.setAttribute("type","radio"),r.setAttribute("name","choice");var n=document.createElement("label");return n.textContent=t,n.style.cssText="position = relative;display: inline-block;color: white;",e.appendChild(r),e.appendChild(n),r}function ee(e){switch(x.removeChild(C),C=null,e){case"PAD":k.checked=!0,J(x);break;case"WHEEL":U.checked=!0,function(e){X=!1;var t=document.createElement("div"),r=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),s=document.createElement("div"),l=document.createElement("div"),c=document.createElement("div"),E=document.createElement("div"),u=document.createElement("div"),d=document.createElement("div"),T=document.createElement("div"),f=document.createElement("div"),p=document.createElement("div"),P=document.createElement("div"),S=document.createElement("div"),A=document.createElement("div"),h=document.createElement("div"),v=document.createElement("div"),L=document.createElement("div"),Y=document.createElement("div"),M=document.createElement("div"),x=document.createElement("div"),w=document.createElement("div"),U=document.createElement("div"),k=document.createElement("div"),D=document.createElement("div"),F=document.createElement("div"),H=document.createElement("div"),j=document.createElement("div"),z=document.createElement("div");C=t;var Q="position: absolute;height: auto;background-image: "+_+btoa(m)+"');width: 19px;height: 19px;background-size: 100% 100%;";t.style.cssText="position: absolute;background-image: "+_+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="112.08413mm" height="128.46834mm" viewBox="0 0 397.14849 455.20277" id="svg3440" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel.svg"><defs id="defs3442" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="0.98994949" inkscape:cx="421.01508" inkscape:cy="52.510802" inkscape:document-units="px" inkscape:current-layer="g87" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3445"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title /></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-2.3645008e-8,-597.15942)"><path inkscape:connector-curvature="0" style="fill:#4d4d4d;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4140" d="m 307.84153,715.52552 c -4.35995,43.11849 -2.78952,86.66385 -15.90234,128.54337 -10.85452,25.86023 -13.33477,47.2976 6.91492,61.09536 7.23778,50.7442 78.38013,47.39232 82.20535,0 23.06079,-14.19054 13.49405,-42.79138 6.91492,-61.09536 -17.40045,-40.83001 -4.82581,-86.43019 -15.90235,-128.54337 -8.3177,-20.33228 -56.75348,-20.7661 -64.22927,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#cccccc;stroke:#1a1a1a;stroke-width:2.09465766;stroke-miterlimit:4;stroke-dasharray:none" id="path4266" d="m 313.11812,724.1957 -3.84514,68.80568 c 4.64168,13.40814 62.19981,10.8172 61.83082,0 l -3.84515,-68.80568 c -4.46942,-24.00369 -52.58756,-18.95946 -54.13979,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#353535;stroke:#2c2c2c;stroke-width:2.11880326;stroke-miterlimit:4;stroke-dasharray:none" id="path4156" d="m 304.91419,870.673 c -12.36924,67.40381 80.42804,69.69607 70.55134,0 -6.57605,-36.5947 -65.0964,-34.8253 -70.55134,0 z m 60.53812,3.9862 c 8.65841,48.24354 -57.58987,49.86644 -50.52489,0 4.7009,-26.27069 46.6394,-24.84292 50.52489,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#e6e6e6;stroke:#969696;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4011" d="m 106.04576,696.97906 c -11.197076,4.25792 -17.123706,8.24834 -17.123706,8.24834 l -66.18493,16.33946 1.40291,30.64619 46.54715,-7.67623 c 17.00932,-1.6438 32.551896,8.94676 38.302026,23.34506 l 2.78663,65.4778 27.6363,0 2.78663,-65.4778 c 8.0428,-15.3291 20.46247,-27.10803 38.30202,-23.34506 l 46.54716,7.67623 1.40291,-30.64619 -66.18493,-16.33946 c 0,0 -5.92627,-3.99074 -17.12371,-8.24834 -13.45408,-4.31874 -26.62772,-4.20804 -39.08982,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#252525;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path2996" d="m 38.311064,931.09899 c -8.01574,5.05649 -22.76006,21.74743 -26.34852,58.0567 -4.1290804,35.18581 -4.8394604,60.59901 28.55878,61.68771 l 162.934726,0 c 39.19437,1.1693 30.46155,-41.5992 28.55878,-61.68771 -3.58839,-36.30927 -18.33277,-52.99983 -26.34851,-58.0567 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#373737;stroke:#6e6e6e;stroke-width:2.83429575;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none" id="path3019" d="m 26.230254,979.1291 c -11.50334,14.44882 -11.98241,47.3999 -0.33519,57.1202 l 191.802226,0 c 12.10111,-12.3068 9.93082,-46.99573 -0.33518,-57.1202 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#808080;stroke:#1a1a1a;stroke-width:2.14882827;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4133" d="m 360.82498,854.6914 a 20.634815,21.265151 0 1 1 -41.269,0 20.634815,21.265151 0 1 1 41.269,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#333333;stroke:#000000;stroke-width:2.11880326;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4280" d="m 351.64051,761.132 a 11.444622,11.75148 0 1 1 -22.88896,0 11.444622,11.75148 0 1 1 22.88896,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#313131;stroke:#565656;stroke-width:2.93434715;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path3993" d="m 125.52855,598.62659 c -68.528026,0 -124.0613764,57.81925 -124.0613764,129.13695 0,71.31265 55.5370404,129.13696 124.0613764,129.13696 68.52804,0 124.07984,-57.81926 124.07984,-129.13696 0,-71.31264 -55.55611,-129.13695 -124.07984,-129.13695 z m -1.00095,23.63932 c 10.01261,0.0734 20.238,1.32074 28.95237,3.51006 11.62203,3.80301 21.53624,8.52304 31.01135,16.15381 26.21752,19.0207 43.36275,50.36277 43.36275,85.83029 0,58.01564 -45.80548,105.05244 -102.30928,105.05244 -56.500726,0 -102.309276,-47.03364 -102.309276,-105.05244 0,-32.14848 14.06783,-60.91918 36.22336,-80.19121 11.45168,-11.11714 23.14136,-17.13322 37.3943,-21.79731 7.855846,-2.48302 17.655666,-3.5835 27.668276,-3.51006 z" stroke-miterlimit="4" /><g style="stroke-miterlimit:4;stroke-dasharray:none" id="g4127" stroke-miterlimit="4" transform="matrix(0.61498728,0,0,0.63147657,-18.171616,453.28593)"><g id="g4111"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="rect3040" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path3024" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4115" transform="translate(97.984785,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4117" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4119" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4121" transform="translate(195.96959,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4123" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4125" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g></g><g style="fill:#666666;stroke:#969696;stroke-width:3.99777174;stroke-miterlimit:4;stroke-dasharray:none" id="g4051" transform="translate(-42.878584,98.083591)" stroke-miterlimit="4"><g id="g4437" transform="matrix(0.74686368,0,0,0.74686368,-73.374214,285.30447)"><path inkscape:connector-curvature="0" id="rect4348" style="color:#000000;text-indent:0;text-transform:none;block-progression:tb;fill:#ffffff" d="m 567.31,584.22 0,42.25 0,3.4062 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.4062,0 0,-43.969 0,-1.6875 -1.7188,0 -28.75,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 z" /><g style="fill:#a02c2c;stroke:#ffffff;stroke-width:3.4000001;stroke-linecap:square" id="g87" /></g></g></g></svg>')+"');width: 397px;height: 455px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);background-size: 100% 100%;left: 50%;margin-left: 25px;margin-bottom: 40px;bottom: 0px;",r.style.cssText=Q+"top: 132px;left: 331px;",n.style.cssText=Q+"top: 122px;left: 315px;",o.style.cssText=Q+"top: 122px;left: 347px;",s.style.cssText=Q+"top: 113px;left: 331px;",l.style.cssText="position: absolute;height: auto;background-image: "+_+btoa(g)+"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 166px;",c.style.cssText="position: absolute;height: auto;background-image: "+_+btoa(O)+"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 36px;",E.style.cssText=Q+"top: 107px;left: 141px;",u.style.cssText=Q+"top: 107px;left: 90px;",d.style.cssText=Q+"top: 185px;left: 321px;",T.style.cssText=Q+"top: 185px;left: 340px;",f.style.cssText=Q+"top: 179px;left: 358px;",p.style.cssText=Q+"top: 178px;left: 303px;",P.style.cssText=Q+"top: 210px;left: 299px;",S.style.cssText=Q+"top: 279px;left: 299px;",A.style.cssText=Q+"top: 210px;left: 321px;",h.style.cssText=Q+"top: 279px;left: 321px;",v.style.cssText=Q+"top: 210px;left: 344px;",L.style.cssText=Q+"top: 278px;left: 344px;",Y.style.cssText=Q+"top: 124px;left: 147px;",M.style.cssText=Q+"top: 138px;left: 133px;",x.style.cssText=Q+"top: 124px;left: 82px;",w.style.cssText=Q+"top: 138px;left: 96px;",U.style.cssText=Q+"top: 278px;left: 367px;";var V="position: absolute;background-image: "+_+btoa(N)+"');width: 19px;height: 46px;background-size: 100% 100%;";k.style.cssText=V+"top: 291px;left: 50px;",D.style.cssText=V+"top: 291px;left: 111px;",F.style.cssText=V+"top: 291px;left: 171px;",H.style.cssText="position: absolute;background-image: "+_+btoa(R)+"');width: 297px;height: 179px;background-size: 100% 100%;top: 43px;left: -25px;",j.style.cssText="position: absolute;background-image: "+_+btoa(I)+"');width: 33px;height: 10px;background-size: 100% 100%;top: 159px;left: 324px;",z.style.cssText="position: absolute;background-image: "+_+btoa(b)+"');width: 10px;height: 33px;background-size: 100% 100%;top: 148px;left: 335px;",e.appendChild(t),t.appendChild(k),t.appendChild(D),t.appendChild(F),t.appendChild(H),t.appendChild(j),t.appendChild(z),t.appendChild(r),t.appendChild(n),t.appendChild(o),t.appendChild(s),t.appendChild(l),t.appendChild(c),t.appendChild(E),t.appendChild(u),t.appendChild(d),t.appendChild(T),t.appendChild(f),t.appendChild(p),t.appendChild(P),t.appendChild(S),t.appendChild(A),t.appendChild(h),t.appendChild(v),t.appendChild(L),t.appendChild(Y),t.appendChild(M),t.appendChild(x),t.appendChild(w),t.appendChild(U),G.length=0,y.length=0,K.length=0,B.length=0,G.push(r,n,o,s,l,c,E,u,d,T,f,p,P,S,A,h,v,L,Y,M,x,w,U),y.push(m,m,m,m,g,O,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m),B.push(H,k,F,D,j,z);for(var q=0;q<G.length;q++)G[q].setAttribute("id","wheel_btn_"+q),G[q].setAttribute("data-colorstate","B"),G[q].setAttribute("data-key",q),G[q].setAttribute("data-svgid",q);for(q=0;q<B.length;q++)G[q].setAttribute("id","wheel_axis_"+q),G[q].setAttribute("data-colorstate","GR");H.setAttribute("data-key",a.GMPD_AXIS_0),H.setAttribute("data-svgid",y.length),k.setAttribute("data-key",a.GMPD_AXIS_1),k.setAttribute("data-svgid",y.length+1),F.setAttribute("data-key",a.GMPD_AXIS_2),F.setAttribute("data-svgid",y.length+2),D.setAttribute("data-key",a.GMPD_AXIS_3),D.setAttribute("data-svgid",y.length+3),j.setAttribute("data-key",a.GMPD_AXIS_4),j.setAttribute("data-svgid",y.length+4),z.setAttribute("data-key",a.GMPD_AXIS_5),z.setAttribute("data-svgid",y.length+5),y.push(R,N,N,N,I,b),te(G,i),te(B,"#e6e6e6")}(x)}}function te(e,t){for(var r=function(e){var r=e.target;if(!(L<0||"G"==r.getAttribute("data-colorstate")))if(0!=M){if("R"==r.getAttribute("data-colorstate")&&(Y=null,document.getElementById("action_label").textContent=s,M=0),"B"==r.getAttribute("data-colorstate")||"GR"==r.getAttribute("data-colorstate")){var n=parseFloat(Y.getAttribute("data-svgid"));Y.style.backgroundImage=_+btoa(y[n])+"')",Y.setAttribute("data-colorstate",r.getAttribute("data-colorstate")),Y=r,n=parseFloat(r.getAttribute("data-svgid")),r.style.backgroundImage=_+btoa(y[n].replace(t,"#ff0000"))+"')",r.setAttribute("data-colorstate","R")}}else{n=parseFloat(r.getAttribute("data-svgid"));var a="B"==r.getAttribute("data-colorstate")?1:2;M=a,r.style.backgroundImage=_+btoa(y[n].replace(t,"#ff0000"))+"')",r.setAttribute("data-colorstate","R"),document.getElementById("action_label").textContent=1==a?"Now press the button on the device":"Now move the axis on the device",Y=r}},n=0;n<e.length;n++)a.add_click_listener(e[n],r)}function re(){var e=window.innerWidth,t=window.innerHeight;x.style.zoom=t<=750&&t>400||e<=750&&e>400?"0.5":e<=400||t<=400?"0.3":"1"}H[a.GMPD_AXIS_0]=-2,H[a.GMPD_AXIS_1]=-2,H[a.GMPD_AXIS_2]=-2,H[a.GMPD_AXIS_3]=-2,H[a.GMPD_AXIS_4]=-2,H[a.GMPD_AXIS_5]=-2,H[a.GMPD_AXIS_6]=-2,H[a.GMPD_AXIS_7]=-2,H[a.GMPD_AXIS_8]=-2,H[a.GMPD_AXIS_9]=-2,H[a.GMPD_AXIS_10]=-2,H[a.GMPD_AXIS_11]=-2,t.show=function(){var e=document.createElement("div");x=e,e.style.cssText="position: absolute;width: 720px;height: 750px;top: 50%;left: 50%;-moz-transform: translateY(-50%) translateX(-50%);-ms-transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);transform: translateY(-50%) translateX(-50%);background-color: black;border: 4px solid white;border-radius: 35px;box-shadow: 0px 0px 20px 0px rgba(50, 50, 50, 1);",r.insert_to_container(e,"LAST"),J(e);var t=document.createElement("div");t.style.cssText="position: absolute;width: 637px;top: 0px;font-family: sans-serif;text-align: center;margin-top: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);left: 50%;";var o,_=document.createElement("div");_.innerHTML="Select a device",_.style.cssText="color: #fff;display: inline-block;",t.appendChild(_);for(var i=0;i<4;i++){var l=[n.create_gamepad_btn_sensor(a.GMPD_BUTTON_0,o=i),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_1,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_2,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_3,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_4,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_5,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_6,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_7,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_8,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_9,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_10,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_11,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_12,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_13,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_14,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_15,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_16,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_17,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_18,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_19,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_20,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_21,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_22,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_23,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_24,o),n.create_gamepad_btn_sensor(a.GMPD_BUTTON_25,o)],c=function(){return!0},E=function(e,t,r){if(t==L)for(var a=0;a<G.length;a++)V(G[a],n.get_sensor_value(e,t,a),a)};n.create_sensor_manifold(null,i,n.CT_CONTINUOUS,l,c,E)}q().length>0&&(L=0);var u,d,T=[],f=document.createElement("div");f.style.cssText="margin-top: 20px;";for(var p=0;p<4;p++){var P=(u=p,d=void 0,(d=document.createElement("label")).style.cssText="position: relative;display: inline-block;width: 50px;color: white;margin: 0 10px;font-size: 36px;line-height: 50px;background-color: black;border: 3px solid white;border-radius: 5px;height: 50px;",d.textContent=u,d);p==L&&(P.style.backgroundColor="green",w=P),W(p),f.appendChild(P),P.setAttribute("data-device_type","PAD"),T.push(P),a.add_click_listener(P,(function(e){for(var t=q(),r=e.target,n=0;n<t.length;n++)T[n]==r&&(w=r,W(L=n),ee(r.getAttribute("data-device_type")))}))}t.appendChild(f),(D=document.createElement("label")).style.cssText="position: relative;display: block;color: white;",t.appendChild(D);var S=document.createElement("div");S.style.cssText="margin-top: 20px;";var A=$(S,"Pad"),h=$(S,"Wheel");A.setAttribute("checked","true"),A.onchange=function(){ee("PAD"),w&&w.setAttribute("data-device_type","PAD")},h.onchange=function(){ee("WHEEL"),w&&w.setAttribute("data-device_type","WHEEL")},A.setAttribute("id","test"),k=A,U=h;var v=document.createElement("label");v.style.cssText+="color: #fff;display: block;",S.appendChild(v),v.textContent=s,v.setAttribute("id","action_label"),t.appendChild(S),e.appendChild(t);var m=n.create_elapsed_sensor();for(n.create_sensor_manifold(null,"UPDATE_GAMEPAD_DATA",n.CT_CONTINUOUS,[m],c,(function(e,t,r){var n=q(),a=n.length;-1==L&&n.length&&(w=T[L=n[0].index]);for(var o=0;o<T.length;o++)o<a?(T[o].textContent=n[o].index,T[o]==w?(T[o].style.backgroundColor="green",D.textContent="Selected device: "+n[o].index+". Data: "+n[o].id):T[o].style.backgroundColor="blue"):T[o].style.backgroundColor="black";a||(L=-1,D.textContent="")})),i=0;i<4;i++)l=Z(i),n.create_sensor_manifold(null,"AXES"+i,n.CT_CONTINUOUS,l,(function(){return!0}),E=function(e,t,r){if(t=="AXES"+L){for(var n=0;n<K.length;n+=2)j(K[n],e,t,n);if(X)for(n=0;n<12;n+=2)z(e,t,n);else for(n=0;n<12;n++)Q(e,t,n)}});re(),window.addEventListener("resize",re)},t.hide=function(){M=0,L=-1,w=null,Y=null,U=null,k=null,K.length=0,G.length=0,B.length=0,r.get_container().removeChild(x),x=null,n.remove_sensor_manifold(null,"UPDATE_GAMEPAD_DATA");for(var e=0;e<4;e++)n.remove_sensor_manifold(null,e),n.remove_sensor_manifold(null,"AXES"+e);window.removeEventListener("resize",re)},t.update=function(){for(var e=0;e<4;e++)W(e)}})),Bb=nA("gyroscope",(function(e,t){var r=Pb(e),n=mb(e),a=Yb(e),o=Mb(e),_=xb(e),i=new Float32Array(3),s=new Float32Array(3),l=ih(),c=_.deg_to_rad(110),E=_.deg_to_rad(70),u=_.deg_to_rad(70),d=-_.deg_to_rad(70);t.enable_camera_rotation=function(){var e,t,T,f;e=a.get_active_camera(),t=n.create_gyro_angles_sensor(),T=n.create_gyro_quat_sensor(),f=!0,n.create_sensor_manifold(e,"CAMERA_ROTATE_GYRO",n.CT_CONTINUOUS,[t,T],null,(function(e,t,a){if(a>0)if(r.is_eye_camera(e)){var T=n.get_sensor_payload(e,t,1),p=wh(_.AXIS_MY,T,l);r.set_vertical_axis(e,p),o.set_rotation_v(e,T)}else{s=n.get_sensor_payload(e,t,0),f&&(i[0]=s[0],i[1]=s[1],i[2]=s[2],f=!1);var P=0,S=0;0==window.orientation&&(P=s[1]-i[1],S=s[0]-i[0],s[1]>E&&s[1]<c&&(S=0)),180==window.orientation&&(P=s[1]-i[1],s[1]<0&&(P=-P),S=i[0]-s[0],(P>Math.PI/2||P<-Math.PI/2)&&(P=0),s[1]>-c&&s[1]<-E&&(S=0)),-90==window.orientation&&(((P=s[0]-i[0])>Math.PI/2||P<-Math.PI/2)&&(P=0),S=i[1]-s[1],(s[0]>u||s[0]<d)&&(S=0)),90==window.orientation&&(((P=i[0]-s[0])>Math.PI/2||P<-Math.PI/2)&&(P=0),S=s[1]-i[1],(s[0]>u||s[0]<d)&&(S=0)),r.rotate_camera(e,S,P),i[0]=s[0],i[1]=s[1],i[2]=s[2]}}))},t.disable_camera_rotation=function(){var e=a.get_active_camera();n.remove_sensor_manifold(e,"CAMERA_ROTATE_GYRO")}})),Xb=nA("hmd_conf",(function(e,t){var r=vb(e),n=mb(e),a=Rb(e),o=mN(e),_=Gb(e),i=xb(e),s=!1,l=null,c=null,E=null,u=!0,d={profile:"custom",first_distortion:0,second_distortion:0,bevel_size:0,screen_width:0,screen_height:0,screen_lense:0,ipd:0,baseline:0},T=/iPad|iPhone|iPod/.test(navigator.platform),f={oculus_dk2:{name:"Oculus Rift DK2",type:2,first_distortion:.22,second_distortion:.28},cardboard_1:{name:"Cardboard (2014)",type:1,ipd:60,baseline:35,screen_lense:42,first_distortion:.441,second_distortion:.156},cardboard_2:{name:"Cardboard (2015)",type:1,ipd:64,baseline:35,screen_lense:39,first_distortion:.34,second_distortion:.55},custom:{name:"Custom",type:0,ipd:64,baseline:35,screen_lense:39,first_distortion:0,second_distortion:0}},p=[{label:"Tray to lens-center distance.",is_mobile:!0,inputs:[{id:"baseline",max:"50",step:"0.5"}]},{label:"Interpupillary distance.",is_mobile:!0,inputs:[{id:"ipd",max:"100",step:"1"}]},{label:"Screen to lense distance.",is_mobile:!0,inputs:[{id:"screen_lense",max:"100",step:"1"}]},{label:"Screen height.",is_mobile:!0,inputs:[{id:"screen_height",max:"150",step:"1"}]},{label:"Screen width.",is_mobile:!0,inputs:[{id:"screen_width",max:"200",step:"1"}]},{label:"Bevel width.",is_mobile:!0,inputs:[{id:"bevel_size",max:"20",step:"1"}]},{label:"Distortion coefficients.",inputs:[{id:"first_distortion",max:"1.0",step:"0.01"},{id:"second_distortion",max:"1.0",step:"0.01"}]}];function P(){if(!a.can_use_device(a.DEVICE_HMD))return!1;var e=a.get_device_by_type_element(a.DEVICE_HMD),t=a.get_value_param(e,a.HMD_WEBVR_TYPE);return t&(a.HMD_NON_WEBVR|a.HMD_WEBVR_MOBILE|a.HMD_WEBVR_DESKTOP)&&!(t&a.HMD_WEBVR1)}function S(e){var t=e.target.value,r=f[t];for(var n in d)if(n in r){var a=document.getElementById(n+"_slider");a&&(a.disabled="custom"!==t,a.value=r[n]);var o=document.getElementById(n+"_number");o&&(o.disabled="custom"!==t,o.value=r[n]),d[n]=r[n]}}function A(){n.remove_sensor_manifold(null,"UPDATE_HMD_RENDERING"),v(),g(),s&&(s=!1,r.get_container().removeChild(l),document.head.removeChild(c),l=null,E=null,c=null)}function h(){v(!0),g(),function(){for(var e in d){var t=document.getElementById(e+"_slider");t&&(t.value=d[e]);var r=document.getElementById(e+"_number");r&&(r.value=d[e])}}()}function v(e){var t=navigator.userAgent||navigator.vendor||window.opera,r=Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio,n=Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio,a=0,i=0,s=0,l=function(e,t,r,n){if(1!=e.format||!e.devices||!e.devices.length)return o.error("DPDB isn't correct."),-1;for(var a=0;a<e.devices.length;a++){var _=e.devices[a];if(_.rules&&("ios"==_.type&&T||"android"==_.type)){for(var i=!1,s=0;s<_.rules.length;s++)if(c=r,E=n,(l=_.rules[s]).ua&&t.indexOf(l.ua)>=0||!l.ua&&l.res&&l.res[0]&&l.res[1]&&Math.min(c,E)==Math.min(l.res[0],l.res[1])&&Math.max(c,E)==Math.max(l.res[0],l.res[1])){i=!0;break}if(i)return a}}var l,c,E;return-1}(b,t,r,n);if(-1!=l){var c=b.devices[l],E=c.dpi[1]||c.dpi;a=Math.round(25.4*r/(c.dpi[0]||c.dpi)),i=Math.round(25.4*n/E),s=Math.round(c.bw)}var f=_.get("hmd_conf","b4w"),p=JSON.parse(f||"{}");e?(d.first_distortion=.34,d.second_distortion=.55,d.bevel_size=s||4,d.screen_width=a||110,d.screen_height=i||65,d.screen_lense=50,d.ipd=64,d.baseline=32):(d.first_distortion="first_distortion"in p?parseFloat(p.first_distortion):.34,d.second_distortion="second_distortion"in p?parseFloat(p.second_distortion):.55,d.bevel_size="bevel_size"in p?parseFloat(p.bevel_size):s||4,d.screen_width="screen_width"in p?parseFloat(p.screen_width):a||110,d.screen_height="screen_height"in p?parseFloat(p.screen_height):i||65,d.screen_lense="screen_lense"in p?parseFloat(p.screen_lense):50,d.ipd="ipd"in p?parseFloat(p.ipd):64,d.baseline="baseline"in p?parseFloat(p.baseline):32),u=!0}function m(){_.set("hmd_conf",JSON.stringify(d),"b4w"),A()}function g(){if(u){var e=a.get_device_by_type_element(a.DEVICE_HMD);e&&(a.set_config(e,a.HMD_DISTORTION,[d.first_distortion,d.second_distortion]),a.get_value_param(e,a.HMD_WEBVR_TYPE)&(a.HMD_NON_WEBVR|a.HMD_WEBVR_MOBILE)&&(a.set_config(e,a.HMD_BEVEL_SIZE,.001*d.bevel_size),a.set_config(e,a.HMD_SCREEN_WIDTH,.001*d.screen_width),a.set_config(e,a.HMD_SCREEN_HEIGHT,.001*d.screen_height),a.set_config(e,a.HMD_SCREEN_LENS_DIST,.001*d.screen_lense),a.set_config(e,a.HMD_EYE_DISTANCE,.001*d.ipd),a.set_config(e,a.HMD_BASELINE_DIST,.001*d.baseline))),u=!1}}function O(e){var t=e.target.id.split("_"),r=t.splice(0,t.length-1).join("_");r in d&&d[r]!=e.target.value&&(u=!0,d[r]=e.target.value,document.getElementById(r+"_slider").value=e.target.value,document.getElementById(r+"_number").value=e.target.value)}function N(e,t){var r=document.createElement("div"),n=document.createElement("label");n.className="text_label";var a="8px";t%2&&(a="0"),n.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 100%;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",n.textContent=e.label,r.appendChild(n),r.style.cssText="margin-top: 16px;float: left;width: 240px;margin-right: "+a+";border-top: 2px solid rgba(98, 98, 98, .4);box-sizing: border-box;-webkit-box-sizing: border-box;padding-top: 8px;";for(var o=0;o<e.inputs.length;o++){var _=R(e.inputs[o]);r.appendChild(_)}return r}function R(e){var t=document.createElement("div");t.className="row";var r=document.createElement("input");r.className="input_slider",r.style.cssText="-webkit-appearance: none;width: 192px;display: block;float: left;height: 8px;margin-bottom: 16px;margin-top: 16px;box-sizing: border-box;margin-right: 8px;margin-left: 0;",r.setAttribute("id",e.id+"_slider"),r.setAttribute("type","range"),r.setAttribute("min","0.00"),r.setAttribute("step",e.step),r.setAttribute("value",d[e.id]),r.setAttribute("max",e.max),t.appendChild(r);var n=document.createElement("input");return n.className="input_text",n.setAttribute("id",e.id+"_number"),n.setAttribute("type","number"),n.setAttribute("min","0.00"),n.setAttribute("step",e.step),n.setAttribute("value",d[e.id]),n.setAttribute("max",e.max),t.appendChild(n),n.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 40px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;box-sizing: border-box;line-height: 28px;margin-top: 4px;margin-right: 0;margin-left: 0;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",i.is_ie11()?(r.onchange=O,n.onchange=O):(r.oninput=O,n.oninput=O),t}function I(e,t,r){var n=document.createElement("button");return n.onclick=e,n.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 160px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: center;padding-left: 8px;line-height: 28px;margin-right:"+r+";box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",n.innerHTML=t,n}t.check=P,t.show=function(e){if(P()){var t=r.get_container();if((c=document.createElement("style")).innerHTML="."+e+" input[type=range]::-webkit-slider-runnable-track {width: 100%; height: 8px;cursor: pointer;background-color: #fff;border: 2px solid rgba(98, 98, 98, .2);box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);}."+e+" input[type=range]::-webkit-slider-thumb {box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);height: 30px;width: 16px;border-radius: 2px;background-color: #323232;cursor: pointer;margin-top: -13px;-webkit-appearance: none;}",document.head.appendChild(c),!s){s=!0,v();var o=a.get_device_by_type_element(a.DEVICE_MOUSE,t);a.switch_prevent_default(o,!1);var u=a.get_device_by_type_element(a.DEVICE_TOUCH,t);a.switch_prevent_default(u,!1),(l=document.createElement("div")).className=e,t.appendChild(l),E=document.createElement("div"),l.appendChild(E),E.style.cssText="background-color: #484848;border: 2px solid rgba(150, 150, 150, 0.7);box-shadow: 0px 0px 10px 0px rgba(150, 150, 150, 0.7);position: relative;width: 524px;padding: 16px;overflow: hidden;";var d=function(){var e=_.get("hmd_conf","b4w"),t=JSON.parse(e||"{}").profile||"custom",r=document.createElement("div"),n=document.createElement("label");n.innerHTML="Profile: ",n.className="text_label",n.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;width: 120px;height: 30px;display: block;float: left;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);",r.appendChild(n);var o=document.createElement("select");r.appendChild(o),o.style.cssText="background-color: #323232;border: 2px solid rgba(98, 98, 98, .2);border-radius: 2px;height: 30px;display: block;font-size: 16px;font-weight: normal;color: #fff;cursor: pointer;text-decoration: none;text-align: left;padding-left: 8px;line-height: 28px;margin-bottom: 4px;box-shadow: 0px 0px 4px 0px rgba(98, 98, 98, .8);";var s=a.get_device_by_type_element(a.DEVICE_HMD);if(s)for(var l in f)if(0==f[l].type||a.get_value_param(s,a.HMD_WEBVR_TYPE)&(a.HMD_NON_WEBVR|a.HMD_WEBVR_MOBILE)&&1==f[l].type){var c=document.createElement("option");c.value=l,c.text=f[l].name,o.appendChild(c)}return o.value=t,i.is_ie11()?o.onchange=S:o.oninput=S,r}();E.appendChild(d);for(var T=a.get_device_by_type_element(a.DEVICE_HMD),O=0;O<p.length;O++)if(a.get_value_param(T,a.HMD_WEBVR_TYPE)&(a.HMD_NON_WEBVR|a.HMD_WEBVR_MOBILE)||!p[O].is_mobile){var R=N(p[O],O);E.appendChild(R)}var b,y,L,Y,M=(b=document.createElement("div"),y=I(m,"SAVE","4px"),L=I(A,"CANCEL","4px"),Y=I(h,"RESET","0px"),b.className="row",b.style.cssText="padding-top: 32px;clear: both;box-sizing: border-box;-webkit-box-sizing: border-box;",b.appendChild(y),b.appendChild(L),b.appendChild(Y),b);E.appendChild(M);var x=n.create_timeline_sensor();n.create_sensor_manifold(null,"UPDATE_HMD_RENDERING",n.CT_CONTINUOUS,[x],null,g)}}},t.hide=A,t.reset=h,t.update=function(){v(),g()};var b={_comment:"AUTOMATICALLY GENERATED BY generate_dpdb.py. DO NOT EDIT.",format:1,last_updated:"2016-01-26T23:11:18Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3}]}})),Hb=nA("sfx",(function(e,t){var r=PI(e),n=LI(e),a=yI(e),o=mN(e);t.play=function(e,t,r){a.play(e,t=t||0,r=r||0)},t.play_def=function(e){a.play_def(e)},t.is_playing=function(e){return a.is_playing(e)},t.stop=function(e){a.stop(e)},t.pause=function(e){a.speaker_pause(e)},t.resume=function(e){a.speaker_resume(e)},t.loop_stop=function(e,t,r){a.loop_stop(e,t=t||0,r=r||!1)},t.playrate=function(e,t){a.playrate(e,t)},t.get_playrate=function(e){return a.get_playrate(e)},t.cyclic=function(e,t){a.cyclic(e,t)},t.is_cyclic=function(e){return a.is_cyclic(e)},t.listener_reset_speed=function(e,t){a.listener_stride()},t.listener_stride=function(){a.listener_stride()},t.speaker_reset_speed=function(e,t,r){a.speaker_stride(e)},t.speaker_stride=function(e){a.speaker_stride(e)},t.get_volume=function(e){return e&&"object"==typeof e?a.get_volume(e):a.get_master_volume()},t.set_volume=function(e,t){e&&"object"==typeof e?a.set_volume(e,t):a.set_master_volume(t)},t.mute=function(e,t){e&&"object"==typeof e?a.mute(e,t):a.mute_master(t)},t.is_muted=function(e){return e&&"object"==typeof e?a.is_muted(e):a.is_master_muted()},t.get_speaker_objects=function(){return a.get_speaker_objects().slice(0)},t.check_active_speakers=a.check_active_speakers,t.set_compressor_params=function(e){a.set_compressor_params(n.get_active(),e)},t.get_compressor_params=function(){return a.get_compressor_params(n.get_active())},t.duck=function(e,t,r){e&&"object"==typeof e?a.duck(e,t,r):a.duck_master(t,r)},t.unduck=function(e){e&&"object"==typeof e?a.unduck(e):a.unduck_master()},t.apply_playlist=a.apply_playlist,t.clear_playlist=a.clear_playlist,t.detect_audio_container=a.detect_audio_container,t.detect_video_container=a.detect_video_container,t.set_positional_params=a.set_positional_params,t.get_positional_params=a.get_positional_params,t.set_filter_params=a.set_filter_params,t.get_filter_params=a.get_filter_params,t.get_filter_freq_response=a.get_filter_freq_response,t.get_duration=function(e){return e&&r.is_speaker(e)?a.get_duration(e):(o.error('Object "'+(e?e.name:void 0)+'" is not a valid speaker'),0)}})),jb=nA("mixer",(function(e,t){var r=mb(e),n=mN(e),a=Yb(e),o=Lb(e),_=Hb(e),i=xb(e),s=["SWITCH_STRIP","SWITCH_STRIP_HOLD","SWITCH_PARAM","INC_DEC","INC_DEC_HOLD","MUTE_SOLO"],l=[],c=0,E=null,u=null,d=null;function T(e){return{id:e,params:[],active_param:0,mute:-1,solo:-1,speaker:null}}function f(e){var t=T(a.get_object_name(e));return t.mute=_.is_muted(e)?1:0,t.solo=0,t.speaker=e,t}function p(e){if(e.speaker){e.params.length=0;var t=_.get_positional_params(e.speaker);t&&(e.params.push(["DIST_REF",t.dist_ref,0,1e3,1e4,!1]),e.params.push(["ATTENUATION",t.attenuation,0,50,1e3,!1]),e.params.push(["DIST_MAX",t.dist_max,0,1e4,1e4,!1]));var r=_.get_filter_params(e.speaker);r&&(e.params.push(["EQ_FREQ",r.freq,20,2e4,100,!0]),e.params.push(["EQ_Q",r.Q,0,10,100,!1]),e.params.push(["EQ_GAIN",r.gain,-70,30,100,!1])),e.params.push(["VOLUME",_.get_volume(e.speaker),0,1,50,!1]),i.clamp(e.active_param,0,e.params.length-1)}}function P(e){for(var t=0;t<l.length;t++){var r=l[t];if(r!=e&&1==r.solo)return!0}return!1}function S(e){for(var t=0;t<l.length;t++){var r=l[t];r!=e&&0==r.mute&&0==r.solo&&_.mute(r.speaker,!1)}}function A(){if(0==l.length)return[0,-1];var e=8*Math.floor(c/8),t=e+7;return[e=i.clamp(e,0,l.length-1),t=i.clamp(t,0,l.length-1)]}t.enable_mixer_controls=function(){!function(){l.length=0,c=0,E=function(e){for(var t=new Float32Array(100),r=0,n=0;n<100;n++)t[n]=20*Math.pow(1e3,r),r+=1/99;return t}(),u=new Float32Array(E.length),d=new Float32Array(E.length);var e=_.get_speaker_objects();if(e.length){var t,r;l.push((t=T("MASTER"),(r=_.get_compressor_params())&&(t.params.push(["THRESHOLD",r.threshold,-100,0,100,!1]),t.params.push(["KNEE",r.knee,0,40,40,!1]),t.params.push(["RATIO",r.ratio,1,20,20,!1]),t.params.push(["ATTACK",r.attack,0,1,1e3,!1]),t.params.push(["RELEASE",r.release,0,1,1e3,!1])),t.params.push(["VOLUME",_.get_volume(null),0,1,50,!1]),t.mute=_.is_muted(null)?1:0,t.solo=-1,t));for(var n=0;n<e.length;n++)l.push(f(e[n]));l.sort((function(e,t){return"MASTER"==e.id?-1:"MASTER"==t.id?1:"COMPRESSOR"==e.id?-1:"COMPRESSOR"==t.id?1:e.id.toUpperCase()<t.id.toUpperCase()?-1:e.id.toUpperCase()>t.id.toUpperCase()?1:0}))}}();var e=r.create_keyboard_sensor(r.KEY_NUM4),t=r.create_keyboard_sensor(r.KEY_NUM6),a=r.create_keyboard_sensor(r.KEY_NUM8),s=r.create_keyboard_sensor(r.KEY_NUM2),h=r.create_keyboard_sensor(r.KEY_ADD),v=r.create_keyboard_sensor(r.KEY_SUB),m=r.create_keyboard_sensor(r.KEY_NUM7),g=r.create_keyboard_sensor(r.KEY_NUM9),O=r.create_timer_sensor(.15,!0),N=r.create_timer_sensor(.05,!0),R=[e,t,O],I=function(e,t,n){1==n?(function(e){if(l.length){1==e&&c<l.length-1?c++:-1==e&&c>0&&c--;for(var t=A(),r=t[0];r<=t[1];r++)p(l[r])}}(Boolean(r.get_sensor_value(e,t,0))?-1:1),r.reset_timer_sensor(e,t,2,"SWITCH_STRIP"==t?.15+.3:.15)):r.reset_timer_sensor(e,t,2,10)};r.create_sensor_manifold(null,"SWITCH_STRIP",r.CT_TRIGGER,R,(function(e){return e[0]||e[1]}),I),r.create_sensor_manifold(null,"SWITCH_STRIP_HOLD",r.CT_SHOT,R,(function(e){return(e[0]||e[1])&&e[2]}),I),r.create_sensor_manifold(null,"SWITCH_PARAM",r.CT_SHOT,[a,s],(function(e){return e[0]||e[1]}),(function(e,t,n){var a,o;a=Boolean(r.get_sensor_value(e,t,0))?-1:1,(o=l[c])&&(1==a&&o.active_param<o.params.length-1?o.active_param++:-1==a&&o.active_param>0&&o.active_param--)}));var b=[v,h,N],y=function(e,t,a){1==a?(function(e){var t=l[c];if(t){var r=t.params[t.active_param];switch(r[5]?r[1]*=Math.pow(r[3]/r[2],e/r[4]):r[1]+=e*((r[3]-r[2])/r[4]),r[1]=i.clamp(r[1],r[2],r[3]),r[0]){case"VOLUME":_.set_volume("MASTER"!=t.id?t.speaker:null,r[1]);break;case"DIST_REF":(a=_.get_positional_params(t.speaker)).dist_ref=r[1],_.set_positional_params(t.speaker,a);break;case"ATTENUATION":(a=_.get_positional_params(t.speaker)).attenuation=r[1],_.set_positional_params(t.speaker,a);break;case"DIST_MAX":var a;(a=_.get_positional_params(t.speaker)).dist_max=r[1],_.set_positional_params(t.speaker,a);break;case"EQ_FREQ":(o=_.get_filter_params(t.speaker)).freq=r[1],_.set_filter_params(t.speaker,o);break;case"EQ_Q":(o=_.get_filter_params(t.speaker)).Q=r[1],_.set_filter_params(t.speaker,o);break;case"EQ_GAIN":var o;(o=_.get_filter_params(t.speaker)).gain=r[1],_.set_filter_params(t.speaker,o);break;case"THRESHOLD":(s=_.get_compressor_params()).threshold=r[1],_.set_compressor_params(s);break;case"KNEE":(s=_.get_compressor_params()).knee=r[1],_.set_compressor_params(s);break;case"RATIO":(s=_.get_compressor_params()).ratio=r[1],_.set_compressor_params(s);break;case"ATTACK":(s=_.get_compressor_params()).attack=r[1],_.set_compressor_params(s);break;case"RELEASE":var s;(s=_.get_compressor_params()).release=r[1],_.set_compressor_params(s);break;default:n.error("Unknown strip param")}}}(Boolean(r.get_sensor_value(e,t,0))?-1:1),r.reset_timer_sensor(e,t,2,"INC_DEC"==t?.35:.05)):r.reset_timer_sensor(e,t,2,10)};r.create_sensor_manifold(null,"INC_DEC",r.CT_TRIGGER,b,(function(e){return e[0]||e[1]}),y),r.create_sensor_manifold(null,"INC_DEC_HOLD",r.CT_SHOT,b,(function(e){return(e[0]||e[1])&&e[2]}),y),r.create_sensor_manifold(null,"MUTE_SOLO",r.CT_SHOT,[m,g],(function(e){return e[0]||e[1]}),(function(e,t,n){var a;Boolean(r.get_sensor_value(e,t,0))?(a=l[c])&&a.mute>=0&&function(e){"MASTER"!=e.id?0==e.mute?(e.mute=1,_.mute(e.speaker,!0),1==e.solo&&(e.solo=0,P(e)||S(e))):(e.mute=0,P(e)||_.mute(e.speaker,!1)):0==e.mute?(e.mute=1,_.mute(null,!0)):(e.mute=0,_.mute(null,!1))}(a):function(){var e=l[c];e&&e.solo>=0&&function(e){0==e.solo?(e.solo=1,_.mute(e.speaker,!1),1==e.mute&&(e.mute=0),function(e){for(var t=0;t<l.length;t++){var r=l[t];r!=e&&0==r.mute&&0==r.solo&&_.mute(r.speaker,!0)}}(e)):(e.solo=0,P(e)?_.mute(e.speaker,!0):S(e))}(e)}()}));var L=r.create_elapsed_sensor();r.create_sensor_manifold(null,"MIXER_DRAW",r.CT_CONTINUOUS,[L],null,(function(){!function(){if(l[c])for(var e=A(),t=e[0];t<=e[1];t++){var r=l[t];if(o.draw_mixer_strip(r.id,t==c,t%8,r.params,r.active_param,r.mute,r.solo),r.speaker&&_.get_filter_params(r.speaker)){_.get_filter_freq_response(r.speaker,E,u,d);for(var n=0;n<u.length;n++)u[n]=20*Math.log(u[n])/Math.LN10;o.plot_array("EQ",t%8,u,20,2e4,-10,10)}}}()}));var Y=r.create_timer_sensor(1,!0);r.create_sensor_manifold(null,"MIXER_UPDATE",r.CT_TRIGGER,[Y],null,(function(){for(var e=A(),t=e[0];t<=e[1];t++)p(l[t])}))},t.disable_mixer_controls=function(){for(var e=0;s.length;e++)r.remove_sensor_manifold(null,s[e])}})),zb=nA("mouse",(function(e,t){var r=Pb(e),n=vb(e),a=mb(e),o=yb(e),_=mN(e),i=Yb(e),s=xb(e),l=bb(e),c=1,E=0,u=0,d=new Float32Array(2),T=new Float32Array(2),f=null,p=null,P=0,S=!1,A=!1;function h(){1==P&&(P=0);var e=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"==typeof e&&e.apply(document),a.remove_sensor_manifold(i.get_active_camera(),"SMOOTH_PL")}function v(e){2==P&&(P=0),e.removeEventListener("mousedown",g,!1),e.removeEventListener("mouseup",O,!1),e.removeEventListener("mousemove",m,!1),a.remove_sensor_manifold(i.get_active_camera(),"SMOOTH_DRAG")}function m(e){if(f()){if(A)var t=n.get_coords_target_space(e,T);else(t=T)[0]=e.clientX,t[1]=e.clientY;d[0]+=2*(t[0]-E),d[1]+=2*(t[1]-u),E=t[0],u=t[1]}e.preventDefault()}function g(e){if(A)var t=n.get_coords_target_space(e,T);else(t=T)[0]=e.clientX,t[1]=e.clientY;E=t[0],u=t[1],e.currentTarget.addEventListener("mousemove",m,!1),e.preventDefault()}function O(e){e.currentTarget.removeEventListener("mousemove",m,!1),e.preventDefault()}function N(e,t,r,n){if(Math.abs(d[0])>.01||Math.abs(d[1])>.01){var o=a.get_sensor_value(e,t,0),_=s.smooth(d[0],0,o,b()),i=s.smooth(d[1],0,o,b());d[0]-=_,d[1]-=i,n(4e-4*-_,4e-4*-i)}}function R(e,t){var n=i.get_first_character(),a=i.get_active_camera();if(r.rotate_camera(a,e,t),n){var _=r.get_camera_angles_char(a,T);o.set_character_rotation_h(n,_[0]),o.set_character_vert_move_dir_angle(n,_[1])}}function I(e){if(S)var t=n.get_coords_target_space(e,!1,T),r=i.pick_object(t[0],t[1]);else r=i.pick_object(e.clientX,e.clientY);r?(i.outlining_is_enabled(r)&&i.set_outline_intensity(r,1),i.outlining_is_enabled(p)&&r!=p&&i.set_outline_intensity(p,0)):i.outlining_is_enabled(p)&&i.set_outline_intensity(p,0),p=r}function b(){return.1*c}t.request_pointerlock=function(e,t,r,n,o,s){if(1!=P){P=1,t=t||function(){},r=r||function(){},s=s||R,o=o||function(){return!0},n=n||function(e){if(o()){if("number"==typeof e.movementX)var t=e.movementX,r=e.movementY;else"number"==typeof e.webkitMovementX?(t=e.webkitMovementX,r=e.webkitMovementY):"number"==typeof e.mozMovementX?(t=e.mozMovementX,r=e.mozMovementY):(t=0,r=0);d[0]+=t,d[1]+=r}},document.addEventListener("pointerlockchange",c,!1),document.addEventListener("webkitpointerlockchange",c,!1),document.addEventListener("mozpointerlockchange",c,!1);var l=e.requestPointerLock||e.webkitRequestPointerLock||e.mozRequestPointerLock;"function"==typeof l?l.apply(e):_.error("Pointer lock is not available")}function c(){if(document.pointerLockElement===e||document.webkitPointerLockElement===e||document.mozPointerLockElement===e){v(e),e.addEventListener("mousemove",n,!1);var o=i.get_active_camera();if(!a.check_sensor_manifold(o,"SMOOTH_PL")){var _=a.create_elapsed_sensor();a.create_sensor_manifold(o,"SMOOTH_PL",a.CT_CONTINUOUS,[_],null,N,s)}t()}else e.removeEventListener("mousemove",n,!1),P=0,document.removeEventListener("pointerlockchange",c,!1),document.removeEventListener("webkitpointerlockchange",c,!1),document.removeEventListener("mozpointerlockchange",c,!1),r()}},t.exit_pointerlock=h,t.check_pointerlock=function(e){return"function"==typeof(e.requestPointerLock||e.webkitRequestPointerLock||e.mozRequestPointerLock)},t.request_mouse_drag=function(e,t,r,n){if(2!=P){P=2,h(),f=t||function(){return!0},r=r||R,A=Boolean(n),e.addEventListener("mousedown",g,!1),e.addEventListener("mouseup",O,!1);var o=i.get_active_camera();if(!a.check_sensor_manifold(o,"SMOOTH_DRAG")){var _=a.create_elapsed_sensor();a.create_sensor_manifold(o,"SMOOTH_DRAG",a.CT_CONTINUOUS,[_],null,N,r)}}},t.exit_mouse_drag=v,t.enable_mouse_hover_outline=function(e){S=Boolean(e),l.detect_mobile()||n.get_canvas().addEventListener("mousemove",I)},t.disable_mouse_hover_outline=function(){l.detect_mobile()||(n.get_canvas().removeEventListener("mousemove",I),p&&i.set_outline_intensity(p,0))},t.get_coords_x=function(e,t,r){if(r)return n.get_coords_target_space(e,t,T)[0];if("clientX"in e)return e.clientX;if("touchend"==e.type)var a=e.changedTouches;else a=t?e.targetTouches:e.touches;return a&&a[0]&&"clientX"in a[0]?a[0].clientX:-1},t.get_coords_y=function(e,t,r){if(r)return n.get_coords_target_space(e,t,T)[1];if("clientY"in e)return e.clientY;if("touchend"==e.type)var a=e.changedTouches;else a=t?e.targetTouches:e.touches;return a&&a[0]&&"clientY"in a[0]?a[0].clientY:-1},t.set_plock_smooth_factor=function(e){c=e},t.get_plock_smooth_factor=function(){return c}})),Qb=nA("animation",(function(e,t){var r=wI(e),n=PI(e),a=mN(e);t.SLOT_0=r.SLOT_0,t.SLOT_1=r.SLOT_1,t.SLOT_2=r.SLOT_2,t.SLOT_3=r.SLOT_3,t.SLOT_4=r.SLOT_4,t.SLOT_5=r.SLOT_5,t.SLOT_6=r.SLOT_6,t.SLOT_7=r.SLOT_7,t.SLOT_ALL=r.SLOT_ALL,t.OBJ_ANIM_TYPE_NONE=r.OBJ_ANIM_TYPE_NONE,t.OBJ_ANIM_TYPE_ARMATURE=r.OBJ_ANIM_TYPE_ARMATURE,t.OBJ_ANIM_TYPE_OBJECT=r.OBJ_ANIM_TYPE_OBJECT,t.OBJ_ANIM_TYPE_VERTEX=r.OBJ_ANIM_TYPE_VERTEX,t.OBJ_ANIM_TYPE_SOUND=r.OBJ_ANIM_TYPE_SOUND,t.OBJ_ANIM_TYPE_PARTICLES=r.OBJ_ANIM_TYPE_PARTICLES,t.OBJ_ANIM_TYPE_MATERIAL=r.OBJ_ANIM_TYPE_MATERIAL,t.OBJ_ANIM_TYPE_STATIC=r.OBJ_ANIM_TYPE_STATIC,t.AB_CYCLIC=r.AB_CYCLIC,t.AB_FINISH_RESET=r.AB_FINISH_RESET,t.AB_FINISH_STOP=r.AB_FINISH_STOP,t.is_animated=function(e){return r.is_animated(e)},t.get_anim_names=function(e){return r.obj_is_animatable(e)?r.get_anim_names(e):[]},t.get_current_anim_name=function(e,t){return r.is_animated(e)?r.get_anim_by_slot_num(e,t=t||r.SLOT_0):null},t.apply=function(e,t,n){if(n>r.SLOT_7)a.error("Can't apply animation to slot "+n+' for object "'+e.name+'". Object can have maximum of 8 animation slots');else{if(n=n||r.SLOT_0,r.is_animated(e)){var o=r.get_slot_num_by_anim(e,t);if(-1!=o&&o!=n)return void a.error('Animation "'+t+'" is already applied to object "'+e.name+'" (slot "'+o+'").')}r.validate_action_by_name(e,t)?r.apply(e,null,t,n):a.error('No fcurves in action "'+t+'"')}},t.apply_ext=function(e,t,n){if(n>r.SLOT_7)a.error("Can't apply animation to slot "+n+' for object "'+e.name+'". Object can have maximum of 8 animation slots');else{n=n||r.SLOT_0;var o=t[0];if(r.validate_action_by_name(e,o)){var _=t.slice(1);r.apply(e,_,o,n)}else a.error('No fcurves in action "'+o+'"')}},t.remove=function(e){r.remove(e)},t.remove_slot_animation=function(e,t){r.is_animated(e)&&r.remove_slot_animation(e,t=t||r.SLOT_0)},t.apply_def=function(e){r.apply_def(e)},t.play=function(e,t,n){r.is_animated(e)?(r.play(e,t,n=n||r.SLOT_0),r.update_object_animation(e,0,n,!0)):a.error('Object "'+e.name+'" has no applied animation')},t.stop=function(e,t){r.is_animated(e)&&r.stop(e,t=t||r.SLOT_0)},t.is_play=function(e,t){return!!r.is_animated(e)&&r.is_play(e,t=t||r.SLOT_0)},t.set_frame=function(e,t,n){r.is_animated(e)&&r.set_frame(e,t,n=n||r.SLOT_0)},t.set_first_frame=function(e,t){r.is_animated(e)&&r.set_first_frame(e,t)},t.set_last_frame=function(e,t){if(r.is_animated(e)){var n=r.get_anim_start_frame(e,t=t||r.SLOT_0),a=r.get_anim_length(e,t);r.set_frame(e,n+a-r.LAST_FRAME_EPSILON,t)}},t.get_frame=function(e,t){return r.is_animated(e)?r.get_current_frame_float(e,t=t||r.SLOT_0):0},t.set_speed=function(e,t,n){r.is_animated(e)&&r.set_speed(e,t=t||1,n=n||r.SLOT_0)},t.get_speed=function(e,t){return r.is_animated(e)&&e.anim_slots[t=t||r.SLOT_0]?r.get_speed(e,t):0},t.get_anim_start_frame=function(e,t){return r.is_animated(e)&&e.anim_slots[t=t||r.SLOT_0]?r.get_anim_start_frame(e,t):-1},t.get_anim_length=function(e,t){return r.is_animated(e)&&e.anim_slots[t=t||r.SLOT_0]?r.get_anim_length(e,t):-1},t.set_behavior=function(e,t,n){r.is_animated(e)&&r.set_behavior(e,t,n=n||r.SLOT_0)},t.get_behavior=function(e,t){return r.is_animated(e)?r.get_behavior(e,t=t||r.SLOT_0):null},t.apply_smoothing=function(e,t,n,a){a=a||r.SLOT_0,r.is_animated(e)&&r.apply_smoothing(e,t,n,a)},t.frame_to_sec=function(e){return r.frame_to_sec(e)},t.get_slot_num_by_anim=function(e,t){return r.is_animated(e)&&t?r.get_slot_num_by_anim(e,t):-1},t.get_anim_type=function(e,t){return r.is_animated(e)?r.get_anim_type(e,t):null},t.apply_to_first_empty_slot=function(e,t){return r.apply_to_first_empty_slot(e,t)},t.get_skel_mix_factor=function(e){return e.render.anim_mix_factor},t.set_skel_mix_factor=function(e,t,o,_){n.is_armature(e)?(t=Math.min(Math.max(t,0),1),e.render.anim_mix_factor!=t&&r.set_skel_mix_factor(e,t,o=o||0,_=_||null)):a.error("Can't blend animation. Object \""+e.name+'" is not armature')},t.set_skeletal_slots=function(e,t,r,n){r=null==(t=null==t?-1:t)?-1:r,n=n||0;var a=e.render.blend_skel_slots;t>=0&&(a[0]=t),r>=0&&(a[1]=r),e.render.anim_mix_factor=n},t.get_first_skeletal_slot=function(e){return e.render.blend_skel_slots[0]},t.get_second_skeletal_slot=function(e){return e.render.blend_skel_slots[1]},t.mix_from_cur_pos=function(e,t,n,a){r.mix_from_cur_pos(e,t,n=n||0,a=a||null)}})),Vb=nA("npc_ai",(function(e,t){var r=Qb(e),n=mb(e),a=Yb(e),o=wb(e),_=Mb(e),i=yb(e),s=mN(e),l=xb(e),c=[],E=new Float32Array(3),u=new Float32Array(3),d=new Float32Array(3),T=new Float32Array(3),f=new Float32Array(4),p=new Float32Array(4),P=new Float32Array(4),S=t.NT_WALKING=10,A=t.NT_FLYING=20,h=t.NT_SWIMMING=30;function v(e,t){var n=t.destination,a=t.base_pos,o=u;_.get_translation(t.collider,o);var i=0,s=o[2];switch(n[2]=s,t.type){case S:if(t.random&&t.reached&&(n[0]=(12*Math.random()-6)*t.speed+a[0],n[1]=-(12*Math.random()-6)*t.speed+a[1],function(e,t,r){var n=p,a=d,o=e.speed,i=e.rot_speed;_.get_rotation(e.collider,n),wh(l.AXIS_MY,n,a),a[2]=0,Rh(a,a);var s=.5*o/Math.sin(i/2),c=hh(t,r);c<2*s&&Ah(t,a,2*s-c,t)}(t,n,o),t.reached=!1),t.ground_level){var c=t.speed*e;(i=t.ground_level-s)>c?i=c:i<-c&&(i=-c)}t.vert_correction=i;break;case A:case h:if(t.vert_cor_water?i=t.vert_cor_water:t.vert_correction&&(i=t.vert_correction,t.type==h&&(i*=e)),t.random&&t.reached){if(t.type==h){t.speed=Math.random()+.1;var v=t.max_depth-t.min_depth}else v=t.max_height-t.min_height;n[0]=10*Math.random()-5+a[0],n[1]=10*Math.random()-5+a[1],n[2]=s-(Math.random()*v-.5*v),t.reached=!1}}i&&(n[2]=s+i),function(e,t){var n=E,a=u,o=d,i=P,s=t.rig,c=t.collider,v=t.destination,m=t.speed,g=t.actions,O=r.get_current_anim_name(s);if(!r.is_play(s)||!g.idle||-1==g.idle.indexOf(O)){_.get_translation(c,n);var N=v[0]-n[0],R=v[1]-n[1],I=Math.sqrt(N*N+R*R);I>2*m*e?(t.state=20,l.horizontal_direction(v,n,o),function(e,t,n,a){var o=e.rig;if(r.is_animated(o)){var _=e.speed,i=n,s=r.get_frame(o),l=r.get_anim_length(o),c=l/24*_*(1-s/l);i/c<.9&&Ah(t,a,c-i,t)}}(t,v,I,o),function(e,t,r,n,a){var o=p,i=T;_.get_rotation(e.collider,o),wh(l.AXIS_MY,o,t),i[0]=t[0],i[1]=t[1],i[2]=0,Rh(i,i);var s=Ih(i,a),c=Math.acos(s),E=r/(Math.abs(c)/Math.PI)*e.rot_speed*e.rotation_mult;Sm(i,a,n),Sm(l.AXIS_MY,i,o),Math.abs(s)>=1?Bv(o,n):(mm(n,o,n),Im(o,n,Math.min(E,1),n))}(t,a,e,i,o),function(e,t,r,n){if(e.type!=A){r=Math.max(r,1/60);var a=f,o=p,_=Math.asin(-t[2]);vm(l.AXIS_X,-_,o);var i=Math.atan(e.vert_correction/(e.speed*r));vm(l.AXIS_X,-i,a),Im(o,a,r,a),mm(n,a,n)}}(t,a,e,i),_.set_rotation_v(c,i),function(e,t,r,n,a){var o=d,i=T;l.quat_to_dir(t,l.AXIS_MY,o),Sh(o,r.speed*e,i),uh(i,n,i),i[2]=r.type!=S?(a[2]-n[2])*e*.1+n[2]:a[2],_.set_translation_v(r.collider,i)}(e,i,t,n,v)):t.type==S?g.move&&O&&-1!=g.move.indexOf(O)&&r.is_play(s)?t.state=20:(t.state=10,t.reached=!0):t.type!=h&&t.type!=A||(t.reached=!0),function(e){var t=e.rig;if(!r.is_play(t))return!0;var n=r.get_current_anim_name(t);if(!n)return!0;var a=e.actions;switch(e.state){case 10:if(!a.idle)return!1;if(-1==a.idle.indexOf(n))return!0;break;case 20:if(!a.move)return!1;if(-1!=a.move.indexOf(n))return!1;if(a.move_start&&-1!=a.move_start.indexOf(n))return!1;if(a.move_blends&&-1!=a.move_blends.indexOf(n))return!1;break;default:return!1}return!0}(t)&&function(e){var t=e.rig;if(!r.is_play(t)){var n=null;switch(e.state){case 10:n=function(e){var t=e.actions;return t.idle?l.random_from_array(t.idle):null}(e);break;case 20:n=function(e){var t=r.get_current_anim_name(e.rig),n=e.actions;return function(e,t){var r=e.actions;return!!r.move_blends&&-1==r.move_blends.indexOf(t)&&!(!r.move||-1==r.move.indexOf(t))&&Math.random()>.33}(e,t)?function(e,t){var r=e.actions,n=r.move.indexOf(t);return r.move_blends[n]}(e,t):function(e,t){var r=e.actions;return!(!r.move||-1==r.move.indexOf(t)&&(r.move_blends||r.move_start)&&(r.move_start||t)&&(!r.move_blends||-1==r.move_blends.indexOf(t))&&(!r.move_start||-1==r.move_start.indexOf(t)))}(e,t)?function(e,t){var r=e.actions;if(!r.move_blends)return l.random_from_array(r.move);var n=r.move_blends.indexOf(t);if(-1!=n){var a=n+1;return r.move[a=a<r.move.length?a:0]}return-1!=r.move.indexOf(t)?t:l.random_from_array(r.move)}(e,t):function(e,t){var r=e.actions;return!!r.move_start&&-1==r.move_start.indexOf(t)&&!(!r.move||-1!=r.move.indexOf(t))}(e,t)?l.random_from_array(n.move_start):null}(e)}n&&(r.apply(t,n),r.set_behavior(t,r.AB_FINISH_RESET),r.set_frame(t,0),r.play(t))}}(t)}}(e,t)}function m(e,t){if(a.is_visible(e.obj))if(e.random)v(t,e);else{for(var r=o.get_timeline(),n=0;n<e.path.length;n++)if(!e.ended[n]){if(e.fired[n]||(e.fired[n]=!0,e.destination[0]=e.path[n][0],e.destination[1]=e.path[n][1],e.destination[2]=e.path[n][2],e.start[n]=r+e.delay[n]),r<e.start[n])break;v(t,e),e.ended[n]=e.reached;break}(function(e){for(var t=0;t<e.path.length;t++)if(0==e.ended[t])return!1;return!0})(e)&&function(e){for(var t=0;t<e.path.length;t++)e.fired[t]=!1,e.ended[t]=!1}(e)}}function g(e,t,r,a){if(a)if(1==r)switch(a.type){case A:var o=100*function(e,t){for(var r=0;r<3;r++){var a=n.get_sensor_payload(e,t,r).hit_fract;if(a)return a}}(e,t);a.vert_correction=o<a.min_height?10:o>a.max_height?-10:0;break;case S:var _=n.get_sensor_payload(e,t,0);a.ground_level=_.hit_pos[2];break;case h:_=n.get_sensor_payload(e,t,0),"CLOSE_GROUND"==t?(a.vert_correction=100*_.hit_fract-1,a.vert_correction=a.vert_correction<.1?.05:0):"CLOSE_WATER"==t&&(a.vert_cor_water=100*_.hit_fract,a.vert_cor_water=a.vert_cor_water<a.min_depth?-.02:a.vert_cor_water>a.max_depth?.02:0)}else a.vert_correction=0}function O(e){var t=ih(),r=e.collider;switch(e.type){case A:var a=n.create_ray_sensor(r,t,[0,0,-100],"TERRAIN",!0,!0),o=n.create_ray_sensor(r,t,[0,0,-100],"STONE",!0,!0),_=n.create_ray_sensor(r,t,[0,0,-100],"WATER",!0,!0);n.create_sensor_manifold(r,"CLOSE_GROUND",n.CT_CONTINUOUS,i=[a,o,_],(function(e){return e[0]||e[1]||e[2]}),g,e);break;case S:a=n.create_ray_sensor(r,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),n.create_sensor_manifold(r,"CLOSE_GROUND",n.CT_CONTINUOUS,i=[a],null,g,e);break;case h:a=n.create_ray_sensor(r,[0,0,1],[0,0,-99],"TERRAIN",!0,!0),_=n.create_ray_sensor(r,t,[0,0,100],"WATER",!0,!0);var i=[a];n.create_sensor_manifold(r,"CLOSE_WATER",n.CT_CONTINUOUS,[_],null,g,e),n.create_sensor_manifold(r,"CLOSE_GROUND",n.CT_CONTINUOUS,i,null,g,e)}}function N(e){var t=e.collider;if(e.type==S){var r=n.create_collision_sensor(t,"CONSTRUCTION",!1);n.create_sensor_manifold(t,"CONSTRUCTION_COLL",n.CT_CONTINUOUS,[r],null,(function(t,r,n){1==n?(ch(e.base_pos,e.destination),e.rotation_mult=4):e.rotation_mult=1}))}}t.new_event_track=function(e){var t={obj:null,rig:null,collider:null,empty:null,type:S,state:10,actions:{},base_pos:new Float32Array(3),destination:new Float32Array(3),path:[],start:[],ended:[],fired:[],delay:[],random:!0,reached:!0,ground_level:0,vert_correction:0,vert_cor_water:0,rotation_mult:1,speed:1,rot_speed:.1,max_height:0,min_height:0,max_depth:0,min_depth:0};if("object"==typeof e.obj)if("object"==typeof e.rig)if("object"==typeof e.collider&&i.has_physics(e.collider)){if(t.obj=e.obj,t.collider=e.collider,t.rig=e.rig,_.get_translation(e.collider,t.base_pos),"object"==typeof e.actions&&(t.actions=e.actions),"boolean"==typeof e.random&&(t.random=e.random),"number"==typeof e.type&&(t.type=e.type),"number"==typeof e.speed&&(t.speed=e.speed),"number"==typeof e.rot_speed&&(t.rot_speed=e.rot_speed),"number"==typeof e.max_height&&(t.max_height=e.max_height),"number"==typeof e.min_height&&(t.min_height=e.min_height),!t.random){for(var n=0;n<e.path.length;n++)t.start[n]=-1,t.ended[n]=!1,t.fired[n]=!1;t.path=e.path,t.delay=e.delay}var a=e.actions,o=r.get_current_anim_name(t.rig);for(var l in a)for(var E=a[l],u=0;u<E.length;u++)r.apply(t.rig,E[u]);o&&r.apply(t.rig,o),c.push(t)}else s.error("Can't create event track. Wrong collider object.");else s.error("Can't create event track. Wrong rig object.");else s.error("Can't create event track. Wrong object.")},t.enable_animation=function(){if(c.length){!function(){for(var e=0;e<c.length;e++){var t=c[e];O(t),N(t),r.get_current_anim_name(t.rig)&&r.play(t.rig)}}();var e=n.create_elapsed_sensor();n.create_sensor_manifold(c[0].collider,"ELAPSED",n.CT_CONTINUOUS,[e],(function(e){return e[0]}),(function(e,t,r){if(1==r)for(var a=n.get_sensor_value(e,t,0),o=0;o<c.length;o++)m(c[o],a)}))}},t.disable_animation=function(){if(!(c.length<=0))for(var e=0;e<c.length;e++){var t=c[e];n.check_sensor_manifolds(t.collider)&&n.remove_sensor_manifold(t.collider),r.is_play(t.rig)&&r.stop(t.rig)}}})),qb=nA("preloader",(function(e,t){var r=vb(e),n={},a=null;t.create_preloader=function(e){var t="#484848",a="#5276cf",o="rgba(150, 150, 150, 0.7)",_="#fff";for(var i in e)switch(i){case"container_color":t=e.container_color;break;case"bar_color":a=e.bar_color;break;case"frame_color":o=e.frame_color;break;case"font_color":_=e.font_color}var s=document.createElement("div"),l=s.cloneNode(!1),c=s.cloneNode(!1),E=s.cloneNode(!1),u=r.get_container();c.appendChild(l),c.appendChild(E),s.appendChild(c),u.appendChild(s),s.style.cssText="background-color: "+t+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;",c.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;box-shadow: 0px 0px 10px 0px "+o+";border: 2px solid "+o+";",l.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+a+";height: 100%;",E.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;font-weight: bold;text-shadow: 0px 0px 6px "+o+";color: "+_+";",n.bar=l,n.caption=E,n.container=s,n.type="DEFAULT"},t.create_simple_preloader=function(e){var t=null,r=null,o="#bf9221",_="#000";for(var i in e)switch(i){case"canvas_container_id":t=e.canvas_container_id;break;case"background_container_id":r=e.background_container_id;break;case"bg_color":_=e.bg_color;break;case"bar_color":o=e.bar_color;break;case"preloader_fadeout":n.fadeout=e.preloader_fadeout}var s=document.createElement("div"),l=document.createElement("div");s.id="simple_preloader_container";var c=document.createElement("div"),E=document.createElement("div"),u=document.getElementById(r);a=document.getElementById(t),s.style.cssText="z-index: 4;background-color: "+_+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;",l.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;",c.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+o+";border-radius: 0px;",E.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+l.appendChild(c),l.appendChild(E),s.appendChild(l),document.body.appendChild(s),n.type="SIMPLE",n.container=s,n.bar=c,n.caption=E,n.background=u},t.create_rotation_preloader=function(e){var t=null,r=null,o="rgba(0,0,0,0)",_="",i="",s="rgba(0,0,0,0)";for(var l in e)switch(l){case"canvas_container_id":t=e.canvas_container_id;break;case"background_container_id":r=e.background_container_id;break;case"frame_bg_color":o=e.frame_bg_color;break;case"bg_color":s=e.bg_color;break;case"frame_class":_=e.frame_class;break;case"anim_elem_class":i=e.anim_elem_class}var c=document.createElement("div"),E=document.createElement("div"),u=document.createElement("div"),d=document.createElement("div"),T=document.getElementById(r);a=document.getElementById(t),c.style.cssText="z-index: 4;background-color: "+s+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;",E.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+o+";",u.style.cssText="position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;",d.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;",u.className=i,E.appendChild(u),E.className=_,E.appendChild(d),c.appendChild(E),a.appendChild(c),n.type="ROTATION",n.container=c,n.anim_elem=u,n.caption=d,n.background=T},t.create_advanced_preloader=function(e){var t=e.preloader_width,r=e.canvas_container_id,o=t/(t-e.img_width),_=document.getElementById(e.preloader_bar_id),i=document.getElementById(e.fill_band_id),s=document.getElementById(e.preloader_caption_id),l=document.getElementById(e.preloader_container_id),c=document.getElementById(e.background_container_id);a=document.getElementById(r),n.type="ADVANCED",n.bar=_,n.fill=i,n.ratio=o,n.caption=s,n.container=l,n.background=c},t.update_preloader=function(e){n.caption.innerHTML=e+"%","SIMPLE"==n.type?n.bar.style.width=e+"%":"ADVANCED"==n.type?(n.bar.style.width=e/n.ratio+"%",n.fill.style.width=100-e+"%"):"ROTATION"==n.type?n.anim_elem.style.transform="rotate("+e+"deg)":"DEFAULT"==n.type&&(n.bar.style.width=e+"%"),100==e&&(n.container.parentNode.removeChild(n.container),n.background&&n.background.parentNode.removeChild(n.background))}})),Wb=nA("screenshooter",(function(e,t){var r=Lb(e),n=mN(e);t.shot=function(e,t){n.error_deprecated("shot","screen.shot"),r.shot(e,t)}})),Jb=nA("anchors",(function(e,t){var r=ZI(e);t.attach_move_cb=r.attach_move_cb,t.detach_move_cb=r.detach_move_cb,t.is_anchor=r.is_anchor,t.get_element_id=r.get_element_id,t.update=function(){r.update(!0)}})),Zb=nA("armature",(function(e,t){var r=PI(e),n=MI(e),a=mN(e);t.get_bone_tsr=function(e,t,n){return r.is_armature(e)?EI(e,t)?(n||(n=wm()),iI(e,t,!1,!1,n),n):(a.error('There is no bone: "',t,'" in "',e.name,'".'),null):null},t.get_bone_tsr_rel=function(e,t,n){return r.is_armature(e)?EI(e,t)?(n||(n=wm()),iI(e,t,!1,!0,n),n):(a.error('There is no bone: "',t,'" in "',e.name,'".'),null):null},t.set_bone_tsr=function(e,t,o){r.is_armature(e)&&(EI(e,t)?(sI(e,t,o,!1),n.update_transform(e)):a.error('There is no bone: "',t,'" in "',e.name,'".'))},t.set_bone_tsr_rel=function(e,t,o){r.is_armature(e)&&(EI(e,t)?(sI(e,t,o,!0),n.update_transform(e)):a.error('There is no bone: "',t,'" in "',e.name,'".'))}})),$b=nA("assets",(function(e,t){var r=QI(e);t.AT_ARRAYBUFFER=r.AT_ARRAYBUFFER,t.AT_ARRAYBUFFER_ZIP=r.AT_ARRAYBUFFER_ZIP,t.AT_JSON=r.AT_JSON,t.AT_JSON_ZIP=r.AT_JSON_ZIP,t.AT_TEXT=r.AT_TEXT,t.AT_AUDIOBUFFER=r.AT_AUDIOBUFFER,t.AT_IMAGE_ELEMENT=r.AT_IMAGE_ELEMENT,t.AT_AUDIO_ELEMENT=r.AT_AUDIO_ELEMENT,t.AT_VIDEO_ELEMENT=r.AT_VIDEO_ELEMENT,t.AT_SEQ_VIDEO_ELEMENT=r.AT_SEQ_VIDEO_ELEMENT,t.enqueue=function(e,t,n,a){e.length&&r.enqueue(e,t,n,a)}})),ey=nA("geometry",(function(e,t){var r=JI(e),n=VR(e),a=mN(e),o=tI(e);t.extract_vertex_array=function(e,t,o){if(!n.has_dyn_geom(e))return a.error("Wrong object:",e.name),null;var _=r.find_batch_material(e,t,"MAIN");if(_){var i=_.bufs_data;return i&&i.pointers&&("a_normal"==o&&i.pointers.a_tbn||i.pointers[o])?n.extract_array_float(i,o):(a.error("Attribute not found:"+o),null)}return a.error("Wrong material:",t),null},t.extract_index_array=function(e,t){if(!n.has_dyn_geom(e))return a.error("Wrong object:",e.name),null;var o=r.find_batch_material(e,t,"MAIN");if(o){var _=o.bufs_data;return _&&_.pointers?_.ibo_array:(a.error("Buffer data not found"),null)}return a.error("Wrong material:",t),null},t.update_vertex_array=function(e,t,o,_){if(n.has_dyn_geom(e))for(var i=["MAIN","SHADOW","COLOR_ID"],s=0;s<i.length;s++){var l=r.find_batch_material(e,t,i[s]);if(l){var c=l.bufs_data;c&&c.pointers&&("a_normal"==o&&c.pointers.a_tbn||c.pointers[o])&&n.update_bufs_data_array(c,o,0,_)}}else a.error("Wrong object:",e.name)},t.override_geometry=function(e,t,_,i,s){if(n.has_dyn_geom(e))if(_ instanceof Uint16Array||_ instanceof Uint32Array)if(i instanceof Float32Array)for(var l=["MAIN","SHADOW","COLOR_ID"],c=0;c<l.length;c++){var E=r.find_batch_material(e,t,l[c]);if(E){var u=E.bufs_data;if(u){n.update_bufs_data_index_array(u,E.draw_mode,_);var d={};for(var T in u.pointers){var f=i.length/3*(A=u.pointers[T]).num_comp;d[S=n.get_vbo_type_by_attr_name(T)]||(d[S]=0),d[S]+=f}var p=n.init_vbo_source_data(d);u.vbo_source_data=p;var P={};for(var T in u.pointers){var S,A=u.pointers[T];switch(P[S=n.get_vbo_type_by_attr_name(T)]||(P[S]=0),T){case"a_position":n.vbo_source_data_set_attr(u.vbo_source_data,"a_position",i,P[S]),A.offset=P[S],A.length=i.length,P[S]+=A.length;break;case"a_tbn":var h;s&&(h=n.calc_shared_indices(_,i,i));var v=n.calc_normals(_,i,h);A.length=i.length/3*A.num_comp;for(var m=new Float32Array(A.length),g=0;g<m.length;g+=4)m[g]=1,m[g+3]=1;var O=YR(v,m);n.vbo_source_data_set_attr(u.vbo_source_data,"a_tbn",O,P[S]),A.offset=P[S],P[S]+=A.length;break;default:A.offset=P[S],A.length=i.length/3*A.num_comp;var N=new(n.get_constructor_by_type(S))(A.length);n.vbo_source_data_set_attr(u.vbo_source_data,T,N,P[S]),P[S]+=A.length}}n.update_gl_buffers(u),o.assign_attribute_setters(E);var R=r.find_batch_material_forked(e,E);R&&R.bufs_data&&(R.bufs_data=u)}}}else a.error("Wrong positions_array type");else a.error("Wrong ibo_array type");else a.error("Wrong object:",e.name)},t.set_shape_key_value=function(e,t,r){if(n.check_shape_keys(e))if(n.has_shape_key(e,t)){var o=parseFloat(r);n.apply_shape_key(e,t,o)}else a.error("Wrong key name:",t);else a.error("Wrong object:",e.name)},t.check_shape_keys=function(e){return n.check_shape_keys(e)},t.get_shape_keys_names=function(e){return n.check_shape_keys(e)?n.get_shape_keys_names(e):(a.error("Wrong object:",e.name),[])},t.get_shape_key_value=function(e,t){return n.check_shape_keys(e)?n.has_shape_key(e,t)?n.get_shape_key_value(e,t):(a.error("Wrong key name:",t),0):(a.error("Wrong object:",e.name),0)},t.draw_line=function(e,t,_){if(_=_||!1,t instanceof Float32Array){var i=r.get_first_batch(e);i&&(n.draw_line(i,t,_),o.assign_attribute_setters(i))}else a.error("Wrong positions type")}})),ty=nA("hud",(function(e,t){var r=OI(e),n=mN(e);t.draw_mixer_strip=function(e,t,a,o,_,i,s){n.error_deprecated("draw_mixer_strip","screen.draw_mixer_strip"),r.draw_mixer_strip(e,t,a,o,_,i,s)},t.plot_array=function(e,t,a,o,_,i,s){n.error_deprecated("plot_array","screen.plot_array"),r.plot_array(e,t,a,o,_,i,s)}})),ry=nA("lights",(function(e,t){var r=KI(e),n=PI(e),a=mN(e),o=LI(e),_=MI(e),i=new Float32Array(3),s={},l=60,c=ih(),E=dm();function u(e){for(var t=o.get_active(),n=r.get_scene_objs(t,"LAMP",r.DATA_ID_ALL),s=0;s<n.length;s++){var l=n[s];if("SUN"==l.light.type){var u=l;break}}if(u){if("number"==typeof e.hor_position&&"number"==typeof e.vert_position){var d=NO(180-e.hor_position),T=NO(90-e.vert_position),f=u.render;_.set_rotation_euler(u,[T,0,d]);var p=new Float32Array(3);_O(Vm(f.world_tsr,E),Ug,p);var P=mh(jm(f.world_tsr,c));ch(p,i),Sh(i,P,i),_.set_translation(u,i),_.update_transform(u);var S=u.light;if(S.dynamic_intensity){var A=t.world.light_settings.environment_energy,h=t.world.horizon_color,v=t.world.zenith_color,m=Math.cos(Math.abs(T)),g=Math.max(Math.min(3*m,1),0)*S.default_energy,O=Math.max(m,.1)*A;TI(S,g),o.set_environment_colors(t,O,h,v)}o.update_lamp_scene(u,t)}}else a.error("There is no sun on the scene")}function d(e){return n.is_lamp(e)?e.light.type:(a.error("get_light_type(): Wrong object"),"")}t.get_lamps=function(e){var t=o.get_active(),n=r.get_scene_objs(t,"LAMP",r.DATA_ID_ALL);if(!e)return n;for(var a=[],_=0;_<n.length;_++){var i=n[_];i.light.type===e&&a.push(i)}return a},t.get_sun_params=function(){for(var e=o.get_active(),t=r.get_scene_objs(e,"LAMP",r.DATA_ID_ALL),n=null,a=0;a<t.length;a++){var _=t[a];if("SUN"==_.light.type){n=_;break}}if(n){var i=n.light.direction,s=RO(Math.atan2(-i[1],i[0]))+90;s>180&&(s-=360);var l=RO(Math.atan2(i[2],Math.sqrt(i[0]*i[0]+i[1]*i[1]))),c={};return c.hor_position=s,c.vert_position=l,c}return null},t.set_sun_params=u,t.set_day_time=function(e){for(var t=o.get_active(),n=r.get_scene_objs(t,"LAMP",r.DATA_ID_ALL),_=0;_<n.length;_++){var i=n[_];if("SUN"==i.light.type){var s=i;break}}s?function(e){var t=e<12?15*e:15*(e-24),r=-Math.cos(e/12*Math.PI)*l,n={};n.hor_position=t,n.vert_position=r,u(n)}(e):a.error("There is no sun on the scene")},t.set_date=function(e){s.y=e.getFullYear(),s.m=e.getMonth(),s.d=e.getDate(),s.y?1582==s.y&&9==s.m&&s.d>4&&s.d<15&&a.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):a.error("There is no year 0 in the Julian system!")},t.set_max_sun_angle=function(e){l=Math.min(Math.max(e,0),90)},t.get_light_params=function(e){if(!n.is_lamp(e))return a.error("get_light_params(): Wrong object"),null;var t=e.light,r=d(e);if(r)switch(r){case"SPOT":(o={light_type:r,light_color:new Float32Array(3),light_energy:t.energy,light_spot_blend:t.spot_blend,light_spot_size:t.spot_size,light_distance:t.distance}).light_color.set(t.color);break;case"POINT":(o={light_type:r,light_color:new Float32Array(3),light_energy:t.energy,light_distance:t.distance}).light_color.set(t.color);break;default:var o;(o={light_type:r,light_color:new Float32Array(3),light_energy:t.energy}).light_color.set(t.color)}return o||null},t.get_light_type=d,t.set_light_params=function(e,t){if(n.is_lamp(e)){var r=e.light,_=o.get_active(),i=!1;"number"==typeof t.light_energy&&TI(r,t.light_energy),"object"==typeof t.light_color&&dI(r,t.light_color),"number"==typeof t.light_spot_blend&&(function(e,t){e.spot_blend=t}(r,t.light_spot_blend),i=!0),"number"==typeof t.light_spot_size&&(function(e,t){e.spot_size=t}(r,t.light_spot_size),i=!0),"number"==typeof t.light_distance&&(function(e,t){e.distance=t}(r,t.light_distance),i=!0),o.update_lamp_scene(e,_),i&&o.update_all_mesh_shaders(_)}else a.error("set_light_params(): Wrong object")},t.get_light_energy=function(e){return n.is_lamp(e)?e.light.energy:(a.error("get_light_energy(): Wrong object"),0)},t.set_light_energy=function(e,t){if(n.is_lamp(e)){var r=o.get_active();TI(e.light,t),o.update_lamp_scene(e,r)}else a.error("set_light_energy(): Wrong object")},t.get_light_color=function(e,t){return n.is_lamp(e)?((t=t||new Float32Array(3)).set(e.light.color),t):(a.error("get_light_color(): Wrong object"),null)},t.set_light_color=function(e,t){if(n.is_lamp(e)){var r=o.get_active();dI(e.light,t),o.update_lamp_scene(e,r)}else a.error("set_light_color(): Wrong object")}})),ny=nA("logic_nodes",(function(e,t){var r=ub(e);t.append_custom_callback=function(e,t){r.append_custom_cb(e,t)},t.remove_custom_callback=function(e){r.remove_custom_cb(e)},t.run_entrypoint=function(e,t){r.run_ep(e,t)}})),ay=nA("material",(function(e,t){var r=JI(e),n=dR(e),a=VR(e),o=KI(e),_=PI(e),i=mN(e),s=qI(e),l=LI(e),c=n.defaults;t.inherit_material=function(e,t,r,n){if(a.has_dyn_geom(r)&&a.has_dyn_geom(e)){var _=e.mat_inheritance_data.original_mat_names.indexOf(t);if(-1!=_){var s=r.mat_inheritance_data.original_mat_names.indexOf(n);-1!=s?(0==r._bpy_obj.data.submeshes[s].shade_tangs.length&&e.materials[_].use_tangent_shading&&i.warn('The target material "'+n+'" was exported without tangent shading data. However, the "'+t+'" material requires it. It\'s needed to enable the "Tangent Shading" option on the target material for correct rendering.'),o.inherit_material(e,t,r,n)):i.error('inherit_material(): material "'+n+'" not found on the object "'+r.origin_name+'".')}else i.error('inherit_material(): material "'+t+'" not found on the object "'+e.origin_name+'".')}else i.error('inherit_material(): both objects "'+e.origin_name+'" and "'+r.origin_name+'" must have the "Dynamic Geometry & Materials" flag enabled.')},t.get_materials_names=function(e){var t=[];if(!_.is_dynamic_mesh(e))return i.error('get_materials_names(): Object "'+e.name+'" is not a dynamic MESH.'),t;for(var r=e.scenes_data,n=0;n<r.length;n++)for(var a=r[n].batches,o=0;o<a.length;o++){var s=a[o];if("MAIN"==s.type)for(var l=0;l<s.material_names.length;l++)-1==t.indexOf(s.material_names[l])&&t.push(s.material_names[l])}return t},t.set_diffuse_color=function(e,t,n){if(_.is_dynamic_mesh(e)){var a=r.find_batch_material(e,t,"MAIN");if(a)if(a.has_nodes)i.error("set_diffuse_color(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{a.diffuse_color.set(n);var o=r.find_batch_material_forked(e,t,"MAIN");o&&o.diffuse_color.set(n)}else i.error('set_diffuse_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else i.error('set_diffuse_color(): Object "'+e.name+'" is not a dynamic MESH.')},t.get_diffuse_color=function(e,t){var n=new Float32Array(4);if(!_.is_dynamic_mesh(e))return i.error('get_diffuse_color(): Object "'+e.name+'" is not a dynamic MESH.'),n;var a=r.find_batch_material(e,t,"MAIN");return a?a.has_nodes?(i.error("get_diffuse_color(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),n):(n.set(a.diffuse_color),n):(i.error('get_diffuse_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),n)},t.set_diffuse_intensity=function(e,t,n){if(_.is_dynamic_mesh(e)){var a=r.find_batch_material(e,t,"MAIN");if(a)if(a.has_nodes)i.error("set_diffuse_intensity(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{a.diffuse_intensity=n;var o=r.find_batch_material_forked(e,t,"MAIN");o&&(o.diffuse_intensity=n)}else i.error('set_diffuse_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else i.error('set_diffuse_intensity(): Object "'+e.name+'" is not a dynamic MESH.')},t.get_diffuse_intensity=function(e,t){if(!_.is_dynamic_mesh(e))return i.error('get_diffuse_intensity(): Object "'+e.name+'" is not a dynamic MESH.'),0;var n=r.find_batch_material(e,t,"MAIN");return n?n.has_nodes?(i.error("get_diffuse_intensity(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):n.diffuse_intensity:(i.error('get_diffuse_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_specular_color=function(e,t,n){if(_.is_dynamic_mesh(e)){var a=r.find_batch_material(e,t,"MAIN");if(a)if(a.has_nodes)i.error("set_specular_color(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{a.specular_color.set(n);var o=r.find_batch_material_forked(e,t,"MAIN");o&&o.specular_color.set(n)}else i.error('set_specular_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else i.error('set_specular_color(): Object "'+e.name+'" is not a dynamic MESH.')},t.get_specular_color=function(e,t){var n=new Float32Array(3);if(!_.is_dynamic_mesh(e))return i.error('get_specular_color(): Object "'+e.name+'" is not a dynamic MESH.'),n;var a=r.find_batch_material(e,t,"MAIN");return a?a.has_nodes?(i.error("get_specular_color(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),n):(n.set(a.specular_color),n):(i.error('get_specular_color(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),n)},t.set_specular_color_factor=function(e,t,n){if(_.is_dynamic_mesh(e)){var a=r.find_batch_material(e,t,"MAIN");if(a)if(a.has_nodes)i.error("set_specular_color_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{a.specular_color_factor=n;var o=r.find_batch_material_forked(e,t,"MAIN");o&&(o.specular_color_factor=n)}else i.error('set_specular_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else i.error('set_specular_color_factor(): Object "'+e.name+'" is not a dynamic MESH.')},t.get_specular_color_factor=function(e,t){if(!_.is_dynamic_mesh(e))return i.error('get_specular_color_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var n=r.find_batch_material(e,t,"MAIN");return n?n.has_nodes?(i.error("get_specular_color_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):n.specular_color_factor:(i.error('get_specular_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_specular_intensity=function(e,t,n){if(_.is_dynamic_mesh(e)){var a=r.find_batch_material(e,t,"MAIN");if(a)if(a.has_nodes)i.error("set_specular_intensity(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{a.specular_params[0]=n;var o=r.find_batch_material_forked(e,t,"MAIN");o&&(o.specular_params[0]=n)}else i.error('set_specular_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else i.error('set_specular_intensity(): Object "'+e.name+'" is not a dynamic MESH.')},t.get_specular_intensity=function(e,t){if(!_.is_dynamic_mesh(e))return i.error('get_specular_intensity(): Object "'+e.name+'" is not a dynamic MESH.'),0;var n=r.find_batch_material(e,t,"MAIN");return n?n.has_nodes?(i.error("get_specular_intensity(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):n.specular_params[0]:(i.error('get_specular_intensity(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.check_specular_intensity=function(e,t){i.error_once("check_specular_intensity() is deprecated, not needed anymore");var n=r.find_batch_material(e,t,"MAIN");return Boolean(n&&n.specular_params[0])},t.set_specular_hardness=function(e,t,n){if(_.is_dynamic_mesh(e)){var a=r.find_batch_material(e,t,"MAIN");if(a)if(a.has_nodes)i.error("set_specular_hardness(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{a.specular_params[1]=n;var o=r.find_batch_material_forked(e,t,"MAIN");o&&(o.specular_params[1]=n)}else i.error('set_specular_hardness(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else i.error('set_specular_hardness(): Object "'+e.name+'" is not a dynamic MESH.')},t.get_specular_hardness=function(e,t){if(!_.is_dynamic_mesh(e))return i.error('get_specular_hardness(): Object "'+e.name+'" is not a dynamic MESH.'),0;var n=r.find_batch_material(e,t,"MAIN");return n?n.has_nodes?(i.error("get_specular_hardness(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):n.specular_params[1]:(i.error('get_specular_hardness(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.check_specular_hardness=function(e,t){i.error_once("check_specular_hardness() is deprecated, not needed anymore");var n=r.find_batch_material(e,t,"MAIN");return Boolean(n&&n.specular_params[1])},t.set_emit_factor=function(e,t,n){if(_.is_dynamic_mesh(e)){var a=r.find_batch_material(e,t,"MAIN");if(a)if(a.has_nodes)i.error("set_emit_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{a.emit=n;var o=r.find_batch_material_forked(e,t,"MAIN");o&&(o.emit=n)}else i.error('set_emit_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else i.error('set_emit_factor(): Object "'+e.name+'" is not a dynamic MESH.')},t.get_emit_factor=function(e,t){if(!_.is_dynamic_mesh(e))return i.error('get_emit_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var n=r.find_batch_material(e,t,"MAIN");return n?n.has_nodes?(i.error("get_emit_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):n.emit:(i.error('get_emit_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_ambient_factor=function(e,t,n){if(_.is_dynamic_mesh(e)){var a=r.find_batch_material(e,t,"MAIN");if(a)if(a.has_nodes)i.error("set_ambient_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{a.ambient=n;var o=r.find_batch_material_forked(e,t,"MAIN");o&&(o.ambient=n)}else i.error('set_ambient_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else i.error('set_ambient_factor(): Object "'+e.name+'" is not a dynamic MESH.')},t.get_ambient_factor=function(e,t){if(!_.is_dynamic_mesh(e))return i.error('get_ambient_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var n=r.find_batch_material(e,t,"MAIN");return n?n.has_nodes?(i.error("get_ambient_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):n.ambient:(i.error('get_ambient_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_diffuse_color_factor=function(e,t,n){if(_.is_dynamic_mesh(e)){var a=r.find_batch_material(e,t,"MAIN");if(a)if(a.has_nodes)i.error("set_diffuse_color_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{a.diffuse_color_factor=n;var o=r.find_batch_material_forked(e,t,"MAIN");o&&(o.diffuse_color_factor=n)}else i.error('set_diffuse_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else i.error('set_diffuse_color_factor(): Object "'+e.name+'" is not a dynamic MESH.')},t.get_diffuse_color_factor=function(e,t){if(!_.is_dynamic_mesh(e))return i.error('get_diffuse_color_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var n=r.find_batch_material(e,t,"MAIN");return n?n.has_nodes?(i.error("get_diffuse_color_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):n.diffuse_color_factor:(i.error('get_diffuse_color_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.set_alpha_factor=function(e,t,n){if(_.is_dynamic_mesh(e)){var a=r.find_batch_material(e,t,"MAIN");if(a)if(a.has_nodes)i.error("set_alpha_factor(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{a.alpha_factor=n;var o=r.find_batch_material_forked(e,t,"MAIN");o&&(o.alpha_factor=n)}else i.error('set_alpha_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else i.error('set_alpha_factor(): Object "'+e.name+'" is not a dynamic MESH.')},t.get_alpha_factor=function(e,t){if(!_.is_dynamic_mesh(e))return i.error('get_alpha_factor(): Object "'+e.name+'" is not a dynamic MESH.'),0;var n=r.find_batch_material(e,t,"MAIN");return n?n.has_nodes?(i.error("get_alpha_factor(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),0):n.alpha_factor:(i.error('get_alpha_factor(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),0)},t.get_material_extended_params=function(e,t){if(!_.is_dynamic_mesh(e))return i.error('get_material_extended_params(): Object "'+e.name+'" is not a dynamic MESH.'),null;var n=r.find_batch_material(e,t,"MAIN");if(!n)return i.error('get_material_extended_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),null;if(n.has_nodes)return i.error("get_material_extended_params(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),null;var a={};return a.reflect_factor=n.reflect_factor,a.fresnel=n.fresnel_params[0],a.fresnel_factor=5*(1-n.fresnel_params[1]),a.parallax_scale=n.parallax_scale,a.parallax_steps=parseFloat(r.get_batch_directive(n,"PARALLAX_STEPS")[1]),a},t.set_material_extended_params=function(e,t,n){if(_.is_dynamic_mesh(e)){var a=r.find_batch_material(e,t,"MAIN");if(a)if(a.has_nodes)i.error("set_material_extended_params(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{var o=[a],c=r.find_batch_material_forked(e,t,"MAIN");c&&o.push(c);for(var E=0;E<o.length;E++)a=o[E],"number"==typeof n.reflect_factor&&(a.reflect_factor=n.reflect_factor),"number"==typeof n.fresnel&&(a.fresnel_params[0]=n.fresnel),"number"==typeof n.fresnel_factor&&(a.fresnel_params[1]=1-n.fresnel_factor/5),"number"==typeof n.parallax_scale&&(a.parallax_scale=n.parallax_scale),"number"==typeof n.parallax_steps&&(r.set_batch_directive(a,"PARALLAX_STEPS",s.glsl_value(n.parallax_steps)),r.update_shader(a),l.recalculate_draw_data(a))}else i.error('set_material_extended_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".')}else i.error('set_material_extended_params(): Object "'+e.name+'" is not a dynamic MESH.')},t.get_water_material_params=function(e,t){if(!_.is_dynamic_mesh(e))return i.error('get_water_material_params(): Object "'+e.name+'" is not a dynamic MESH.'),null;var n=r.find_batch_material(e,t,"MAIN");if(!n||!n.water)return i.error('get_water_material_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+"\" or it's not a water material."),null;if(n.has_nodes)return i.error("get_water_material_params(): Not allowed for node materials! Use get_nodemat_value/get_nodemat_rgb methods instead."),null;var a={};return a.shore_smoothing=c.shore_smoothing&&n.water_shore_smoothing&&Boolean(parseFloat(r.get_batch_directive(n,"SHORE_SMOOTHING")[1])),a.absorb_factor=parseFloat(r.get_batch_directive(n,"ABSORB")[1]),a.foam_factor=n.foam_factor,a.shallow_water_col=new Float32Array(3),a.shore_water_col=new Float32Array(3),a.shallow_water_col_fac=0,a.shore_water_col_fac=0,c.shore_distance&&(a.shallow_water_col.set(n.shallow_water_col),a.shore_water_col.set(n.shore_water_col),a.shallow_water_col_fac=n.shallow_water_col_fac,a.shore_water_col_fac=n.shore_water_col_fac),a.norm_uv_velocity=n.water_norm_uv_velocity,a.water_dynamic=c.water_dynamic&&n.water_dynamic&&Boolean(parseFloat(r.get_batch_directive(n,"DYNAMIC")[1])),a.sss_strength=parseFloat(r.get_batch_directive(n,"SSS_STRENGTH")[1]),a.sss_width=parseFloat(r.get_batch_directive(n,"SSS_WIDTH")[1]),a.waves_height=parseFloat(r.get_batch_directive(n,"WAVES_HEIGHT")[1]),a.waves_length=parseFloat(r.get_batch_directive(n,"WAVES_LENGTH")[1]),a.dst_noise_scale0=parseFloat(r.get_batch_directive(n,"DST_NOISE_SCALE_0")[1]),a.dst_noise_scale1=parseFloat(r.get_batch_directive(n,"DST_NOISE_SCALE_1")[1]),a.dst_noise_freq0=parseFloat(r.get_batch_directive(n,"DST_NOISE_FREQ_0")[1]),a.dst_noise_freq1=parseFloat(r.get_batch_directive(n,"DST_NOISE_FREQ_1")[1]),a.dir_min_shore_fac=parseFloat(r.get_batch_directive(n,"DIR_MIN_SHR_FAC")[1]),a.dir_freq=parseFloat(r.get_batch_directive(n,"DIR_FREQ")[1]),a.dir_noise_scale=parseFloat(r.get_batch_directive(n,"DIR_NOISE_SCALE")[1]),a.dir_noise_freq=parseFloat(r.get_batch_directive(n,"DIR_NOISE_FREQ")[1]),a.dir_min_noise_fac=parseFloat(r.get_batch_directive(n,"DIR_MIN_NOISE_FAC")[1]),a.dst_min_fac=parseFloat(r.get_batch_directive(n,"DST_MIN_FAC")[1]),a.waves_hor_fac=parseFloat(r.get_batch_directive(n,"WAVES_HOR_FAC")[1]),a},t.set_water_material_params=function(e,t,n){if(_.is_dynamic_mesh(e)){var a=r.find_batch_material(e,t,"MAIN");if(a&&a.water)if(a.has_nodes)i.error("set_water_material_params(): Not allowed for node materials! Use set_nodemat_value/set_nodemat_rgb methods instead.");else{var o=[a],E=r.find_batch_material_forked(e,t,"MAIN");E&&o.push(E);for(var u=0;u<o.length;u++){if(a=o[u],"boolean"==typeof n.shore_smoothing&&r.set_batch_directive(a,"SHORE_SMOOTHING",c.shore_smoothing&&a.water_shore_smoothing&&n.shore_smoothing?1:0),"number"==typeof n.absorb_factor){var d=s.glsl_value(parseFloat(n.absorb_factor));r.set_batch_directive(a,"ABSORB",d)}if("number"==typeof n.foam_factor&&c.foam&&(a.foam_factor=n.foam_factor),c.shore_distance&&("object"==typeof n.shallow_water_col&&a.shallow_water_col.set(n.shallow_water_col),"number"==typeof n.shallow_water_col_fac&&(a.shallow_water_col_fac=n.shallow_water_col_fac),"object"==typeof n.shore_water_col&&a.shore_water_col.set(n.shore_water_col),"number"==typeof n.shore_water_col_fac&&(a.shore_water_col_fac=n.shore_water_col_fac)),"number"==typeof n.norm_uv_velocity&&(a.water_norm_uv_velocity=n.norm_uv_velocity),c.water_dynamic&&a.water_dynamic){if("boolean"==typeof n.water_dynamic&&r.set_batch_directive(a,"DYNAMIC",n.water_dynamic?1:0),"number"==typeof n.sss_strength){var T=s.glsl_value(parseFloat(n.sss_strength));r.set_batch_directive(a,"SSS_STRENGTH",T)}if("number"==typeof n.sss_width&&(T=s.glsl_value(parseFloat(n.sss_width)),r.set_batch_directive(a,"SSS_WIDTH",T)),"number"==typeof n.waves_height){var f=s.glsl_value(parseFloat(n.waves_height));r.set_batch_directive(a,"WAVES_HEIGHT",f)}if("number"==typeof n.waves_length&&(T=s.glsl_value(parseFloat(n.waves_length)),r.set_batch_directive(a,"WAVES_LENGTH",T)),"number"==typeof n.dst_noise_scale0){var p=s.glsl_value(parseFloat(n.dst_noise_scale0));r.set_batch_directive(a,"DST_NOISE_SCALE_0",p)}if("number"==typeof n.dst_noise_scale1){var P=s.glsl_value(parseFloat(n.dst_noise_scale1));r.set_batch_directive(a,"DST_NOISE_SCALE_1",P)}if("number"==typeof n.dst_noise_freq0){var S=s.glsl_value(parseFloat(n.dst_noise_freq0));r.set_batch_directive(a,"DST_NOISE_FREQ_0",S)}if("number"==typeof n.dst_noise_freq1){var A=s.glsl_value(parseFloat(n.dst_noise_freq1));r.set_batch_directive(a,"DST_NOISE_FREQ_1",A)}if("number"==typeof n.dir_min_shore_fac){var h=s.glsl_value(parseFloat(n.dir_min_shore_fac));r.set_batch_directive(a,"DIR_MIN_SHR_FAC",h)}if("number"==typeof n.dir_freq){var v=s.glsl_value(parseFloat(n.dir_freq));r.set_batch_directive(a,"DIR_FREQ",v)}if("number"==typeof n.dir_noise_scale){var m=s.glsl_value(parseFloat(n.dir_noise_scale));r.set_batch_directive(a,"DIR_NOISE_SCALE",m)}if("number"==typeof n.dir_noise_freq){var g=s.glsl_value(parseFloat(n.dir_noise_freq));r.set_batch_directive(a,"DIR_NOISE_FREQ",g)}if("number"==typeof n.dir_min_noise_fac){var O=s.glsl_value(parseFloat(n.dir_min_noise_fac));r.set_batch_directive(a,"DIR_MIN_NOISE_FAC",O)}if("number"==typeof n.dst_min_fac){var N=s.glsl_value(parseFloat(n.dst_min_fac));r.set_batch_directive(a,"DST_MIN_FAC",N)}if("number"==typeof n.waves_hor_fac){var R=s.glsl_value(parseFloat(n.waves_hor_fac));r.set_batch_directive(a,"WAVES_HOR_FAC",R)}}r.update_shader(a),l.recalculate_draw_data(a)}}else i.error('set_water_material_params(): Material "'+t+'" wasn\'t found on the object "'+e.name+"\" or it's not a water material.")}else i.error('set_water_material_params(): Object "'+e.name+'" is not a dynamic MESH.')},t.set_line_params=function(e,t){if(_.is_line(e)){var n=r.get_first_batch(e);n?(jg(t.color)&&n.diffuse_color.set(t.color),jg(t.width)&&(n.line_width=t.width)):i.error("set_line_params(): Couldn't set line parameters!")}else i.error('set_line_params(): Object "'+e.name+'" is not a LINE object.')},t.get_line_params=function(e){if(!_.is_line(e))return i.error('get_line_params(): Object "'+e.name+'" is not a LINE object.'),null;var t=r.get_first_batch(e);return t?{color:new Float32Array(t.diffuse_color),width:t.line_width}:(i.error("get_line_params(): Couldn't get line parameters!"),null)},t.set_nodemat_value=function(e,t,n){var a=_.is_dynamic_mesh(e),s=_.is_world(e),c=s?o.get_world_name(e):e.name;if(a||s){if(a){var E=1;if(!r.find_batch_material_any(e,d=t[0],"MAIN")&&!r.find_batch_material_any(e,d,"PARTICLES"))return void i.error('set_nodemat_value(): Material "'+d+'" wasn\'t found on the object "'+c+'".')}else if(s){var u=l.get_active(),d="";if(E=0,!r.get_batch_by_type(e,"SKY",u))return void i.error("set_nodemat_value(): Sky node material wasn't found on the world object \""+c+'".')}var T=r.name_list_to_node_name(t,E);o.set_nodemat_value(e,d,T,n)||i.error('set_nodemat_value(): Value node "'+t[t.length-1]+'" was not found in the object "'+c+'".')}else i.error('set_nodemat_value(): Object "'+c+'" is not a dynamic MESH or WORLD.')},t.get_nodemat_value=function(e,t){var n=_.is_dynamic_mesh(e),a=_.is_world(e),s=a?o.get_world_name(e):e.name;if(!n&&!a)return i.error('get_nodemat_value(): Object "'+s+'" is not a dynamic MESH or WORLD.'),0;if(n){var c=1;if(!r.find_batch_material_any(e,u=t[0],"MAIN")&&!r.find_batch_material_any(e,u,"PARTICLES"))return i.error('get_nodemat_value(): Material "'+u+'" wasn\'t found on the object "'+s+'".'),0}else if(a){var E=l.get_active(),u="";if(c=0,!r.get_batch_by_type(e,"SKY",E))return i.error("get_nodemat_value(): Sky node material wasn't found on the world object \""+s+'".'),0}var d=r.name_list_to_node_name(t,c),T=o.get_nodemat_value(e,u,d);return null===T&&i.error('get_nodemat_value(): Value node "'+t[t.length-1]+'" was not found in the object "'+s+'".'),T},t.set_nodemat_rgb=function(e,t,n,a,s){var c=_.is_dynamic_mesh(e),E=_.is_world(e),u=E?o.get_world_name(e):e.name;if(c||E){if(c){var d=1;if(!r.find_batch_material_any(e,f=t[0],"MAIN")&&!r.find_batch_material_any(e,f,"PARTICLES"))return void i.error('set_nodemat_rgb(): Material "'+f+'" wasn\'t found on the object "'+u+'".')}else if(E){var T=l.get_active(),f="";if(d=0,!r.get_batch_by_type(e,"SKY",T))return void i.error("set_nodemat_rgb(): Sky node material wasn't found on the world object \""+u+'".')}var p=r.name_list_to_node_name(t,d);o.set_nodemat_rgb(e,f,p,n,a,s)||i.error('set_nodemat_rgb(): RGB node "'+t[t.length-1]+'" was not found in the object "'+u+'".')}else i.error('set_nodemat_rgb(): Object "'+u+'" is not a dynamic MESH or WORLD.')},t.get_nodemat_rgb=function(e,t,n){var a=_.is_dynamic_mesh(e),s=_.is_world(e),c=s?o.get_world_name(e):e.name;if(!a&&!s)return i.error('get_nodemat_rgb(): Object "'+c+'" is not a dynamic MESH or WORLD.'),null;if(a){var E=1;if(!r.find_batch_material_any(e,d=t[0],"MAIN")&&!r.find_batch_material_any(e,d,"PARTICLES"))return i.error('get_nodemat_rgb(): Material "'+d+'" wasn\'t found on the object "'+c+'".'),null}else if(s){var u=l.get_active(),d="";if(E=0,!r.get_batch_by_type(e,"SKY",u))return i.error("get_nodemat_rgb(): Sky node material wasn't found on the world object \""+c+'".'),null}n||(n=new Float32Array(3));var T=r.name_list_to_node_name(t,E);return(n=o.get_nodemat_rgb(e,d,T,n))||i.error('get_nodemat_rgb(): RGB node "'+t[t.length-1]+'" was not found in the object "'+c+'".'),n},t.is_node_material=function(e,t){if(!_.is_dynamic_mesh(e))return i.error('is_node_material(): Object "'+e.name+'" is not a dynamic MESH.'),!1;var n=r.find_batch_material(e,t,"MAIN");return n?n.has_nodes:(i.error('is_node_material(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),!1)},t.is_water_material=function(e,t){if(!_.is_dynamic_mesh(e))return i.error('is_water_material(): Object "'+e.name+'" is not a dynamic MESH.'),!1;var n=r.find_batch_material(e,t,"MAIN");return n?n.water&&!n.has_nodes:(i.error('is_water_material(): Material "'+t+'" wasn\'t found on the object "'+e.name+'".'),!1)}})),oy=nA("math",(function(e,t){var r=new Float32Array(3);t.create_pline_from_points=function(e,t){var n=new Float32Array(6);return Wh(n,e),dh(t,e,r),Jh(n,r),n},t.create_pline_from_point_vec=function(e,t){var r=new Float32Array(6);return Wh(r,e),Jh(r,t),r},t.create_pline=function(){return new Float32Array(6)},t.get_pline_directional_vec=Vh,t.get_pline_initial_point=qh,t.set_pline_initial_point=Wh,t.set_pline_directional_vec=Jh,t.line_plane_intersect=eN,t.calc_pline_point=Zh,t.point_plane_dist=tv,t.linear_tween=_v,t.ease_in_quad=iv,t.ease_out_quad=sv,t.ease_in_out_quad=lv,t.ease_in_cubic=cv,t.ease_out_cubic=Ev,t.ease_in_out_cubic=uv,t.ease_in_quart=dv,t.ease_out_quart=Tv,t.ease_in_out_quart=fv,t.ease_in_quint=pv,t.ease_out_quint=Pv,t.ease_in_out_quint=Sv,t.ease_in_sine=Av,t.ease_out_sine=hv,t.ease_in_out_sine=vv,t.ease_in_expo=mv,t.ease_out_expo=gv,t.ease_in_out_expo=Ov,t.ease_in_circ=Nv,t.ease_out_circ=Rv,t.ease_in_out_circ=Iv,t.ease_in_elastic=bv,t.ease_out_elastic=yv,t.ease_in_out_elastic=Lv,t.ease_in_back=Yv,t.ease_out_back=Mv,t.ease_in_out_back=xv,t.ease_in_bounce=Cv,t.ease_out_bounce=wv,t.ease_in_out_bounce=Uv})),_y=nA("nla",(function(e,t){var r=GI(e),n=AR(e),a=mN(e);t.set_frame=function(e){e=xO(e,r.get_frame_start(),r.get_frame_end()),r.check_logic_nodes()?a.error("The active scene is using the Logic Editor."):r.set_frame(e,n.get_timeline())},t.get_frame=function(){return r.get_frame(n.get_timeline())},t.stop=function(){r.check_logic_nodes()&&a.warn("The active scene is using the Logic Editor. It may conflicts with your JS-code."),r.stop_nla()},t.play=function(e){r.check_logic_nodes()&&a.warn("The active scene is using the Logic Editor. It may conflicts with your JS-code."),r.play_nla(e)},t.is_play=function(){return r.is_play()},t.get_frame_start=function(){return r.get_frame_start()},t.get_frame_end=function(){return r.get_frame_end()},t.check_nla=function(){return r.check_nla()},t.check_logic_nodes=function(){return r.check_logic_nodes()},t.set_range=function(e,t){r.check_logic_nodes()?a.error("The active scene is using the Logic Editor."):(t=parseFloat(t)||r.get_frame_end(),e=parseFloat(e)||r.get_frame_end(),t=xO(t,r.get_frame_start(),r.get_frame_end()),e=xO(e,r.get_frame_start(),t),r.set_range(e,t))},t.reset_range=function(){r.check_logic_nodes()?a.error("The active scene is using the Logic Editor."):r.reset_range()},t.set_cyclic=function(e){r.check_logic_nodes()?a.error("The active scene is using the Logic Editor."):r.set_cyclic(e)},t.clear_callback=function(){r.check_logic_nodes()?a.error("The active scene is using the Logic Editor."):r.clear_callback()}})),iy=nA("objects",(function(e,t){var r=VR(e),n=KI(e),a=JI(e),o=PI(e),_=mN(e),i=LI(e);t.get_meta_tags=function(e){if(e)return n.get_meta_tags(e)},t.get_custom_prop=function(e){if(e)return n.get_custom_prop(e)},t.copy=function(e,t,a){if(!o.is_mesh(e)&&!o.is_empty(e))return _.error('object "'+e.name+'" is not of type "MESH".'),!1;if(!o.is_dynamic(e))return _.error('object "'+e.name+'" is not dynamic.'),!1;if(!r.has_dyn_geom(e)&&!r.check_shape_keys(e)&&a)return _.error('object "'+e.name+'" has not dynamic geometry for deep copying.'),!1;var s=n.get_scene_objs(i.get_active(),"MESH",n.DATA_ID_ALL);return-1==s.indexOf(e)&&-1==(s=n.get_scene_objs(i.get_active(),"EMPTY",n.DATA_ID_ALL)).indexOf(e)?(_.error('object "'+e.name+'" does not belong to the active scene.'),!1):n.copy(e,t=t||"",a)},t.update_boundings=function(e){o.is_mesh(e)?r.has_dyn_geom(e)||r.check_shape_keys(e)?n.update_boundings(e):_.error('object "'+e.name+'" has not dynamic geometry.'):_.error('The type of the object "'+e.name+'" is not "MESH".')},t.get_parent=o.get_parent,t.get_dg_parent=o.get_dg_parent,t.is_mesh=o.is_mesh,t.is_armature=o.is_armature,t.is_speaker=o.is_speaker,t.is_camera=o.is_camera,t.is_lamp=o.is_lamp,t.is_empty=o.is_empty,t.is_line=o.is_line,t.is_world=o.is_world,t.get_selectable_objects=function(){return n.get_selectable_objects()},t.get_outlining_objects=function(){return n.get_outlining_objects()},t.is_dynamic=o.is_dynamic,t.set_wind_bending_params=function(e,t){if(o.is_dynamic_mesh(e)){var r=e.render;if(r.wind_bending){if("number"==typeof t.angle){var i=a.wb_angle_to_amp(NO(t.angle),r.bb_original,zm(r.world_tsr));r.wind_bending_amp=i}"number"==typeof t.main_frequency&&(r.wind_bending_freq=t.main_frequency),"number"==typeof t.detail_frequency&&(r.detail_bending_freq=t.detail_frequency),"number"==typeof t.detail_amplitude&&(r.detail_bending_amp=t.detail_amplitude),"number"==typeof t.branch_amplitude&&(r.branch_bending_amp=t.branch_amplitude),n.set_hair_particles_wind_bend_params(e)}else _.error('The "'+e.name+"\" object doesn't have wind bending parameters.")}else _.error('The type of the object "'+e.name+'" is not "MESH" or it is not dynamic.')},t.get_wind_bending_params=function(e){var t=e.render;if(!t.wind_bending)return null;var r={},n=RO(a.wb_amp_to_angle(t.wind_bending_amp,t.bb_original,zm(t.world_tsr)));return r.angle=n,r.main_frequency=t.wind_bending_freq,r.detail_frequency=t.detail_bending_freq,r.detail_amplitude=t.detail_bending_amp,r.branch_amplitude=t.branch_bending_amp,r},t.create_line=function(e){return n.create_line(e)},t.create_empty=function(e){return n.create_empty(e)},t.hide_all_by_data_id=function(e){for(var t=n.get_all_objects("ALL",e),r=0;r<t.length;r++)i.change_visibility(t[r],!0)},t.show_all_by_data_id=function(e){for(var t=n.get_all_objects("ALL",e),r=0;r<t.length;r++)i.change_visibility(t[r],!1)}})),sy=nA("particles",(function(e,t){var r=SI(e),n=mN(e);t.set_size=function(e,t,a){r.obj_has_psys(e,t)?r.set_size(e,t,a):n.error('set_size(): Object "'+e.name+'" has not a particle system named "'+t+'"')},t.set_normal_factor=function(e,t,a){r.obj_has_psys(e,t)?r.set_normal_factor(e,t,a):n.error('set_normal_factor(): Object "'+e.name+'" has not a particle system named "'+t+'"')},t.set_factor=function(e,t,a){r.obj_has_psys(e,t)?(a=Math.min(a,1),a=Math.max(a,0),r.set_factor(e,t,a)):n.error('set_factor(): Object "'+e.name+'" has not a particle system named "'+t+'"')}})),ly=nA("rgb",(function(e,t){var r=new Float32Array(3);t.create=function(){return new Float32Array(3)},t.from_values=function(e,t,r){var n=new Float32Array(3);return n[0]=e,n[1]=t,n[2]=r,n},t.set=function(e,t,r,n){return n[0]=e,n[1]=t,n[2]=r,n},t.css_to_rgb=function(e,t,r,n){return(n=n||new Float32Array(3))[0]=e/255,n[1]=t/255,n[2]=r/255,function(e,t){t[0]=Math.pow(e[0],2.2),t[1]=Math.pow(e[1],2.2),t[2]=Math.pow(e[2],2.2)}(n,n),n},t.rgb_to_css=function(e){var t=lN(e,r);return[Math.round(255*t[0]),Math.round(255*t[1]),Math.round(255*t[2])]},t.rgb_to_css_hex=function(e){var t=function(e){var t=Math.round(255*e).toString(16);return 1==t.length?"0"+t:t},n=lN(e,r);return"#"+t(n[0])+t(n[1])+t(n[2])}})),cy=nA("textures",(function(e,t){var r=mN(e),n=LI(e),a=XI(e),o=PI(e),_=QI(e);t.play_video=function(e,t){t||(t=0);var o=a.get_video_texture(e,t);o?n.get_active().b4w_use_nla&&a.video_allow_nla(o)?r.error("NLA texture can't be controlled directly through API."):a.play_video(o):r.error('Texture with name "'+e+'" not found!')},t.pause_video=function(e,t){t||(t=0);var o=a.get_video_texture(e,t);o?n.get_active().b4w_use_nla&&a.video_allow_nla(o)?r.error("NLA texture can't be controlled directly through API."):a.pause_video(o):r.error('Texture with name "'+e+'" not found!')},t.reset_video=function(e,t){t||(t=0);var o=a.get_video_texture(e,t);o?n.get_active().b4w_use_nla&&a.video_allow_nla(o)?r.error("NLA texture can't be controlled directly through API."):a.reset_video(o):r.error('Texture with name "'+e+'" not found!')},t.get_canvas_ctx=function(e,t){if(o.is_mesh(e)){var n=a.get_canvas_context_by_object(e,t);if(n)return n;r.error("Couldn't find canvas texture with this name: "+t)}else r.error("Object must be type of mesh.");return null},t.update_canvas_ctx=function(e,t){if(!o.is_mesh(e))return r.error("Object must be type of mesh."),!1;var n=a.get_texture_by_name(e,t);return n&&"CANVAS"==n.source?(a.update_texture_canvas(n),!0):(r.error("Couldn't find canvas texture \""+t+'" in object "'+e.name+'".'),!1)},t.change_image=function(e,t,n,o){r.error_deprecated("change_image","replace_image"),o=o||function(){};var i=a.get_texture_by_name(e,t);if(!i)return r.error("Couldn't find texture \""+t+'" in object "'+e.name+'".'),void o(!1);if(i.is_movie)return r.error("Changing video textures is forbidden."),void o(!1);var s=vI(n);i.img_full_filepath!=s?_.enqueue([{id:n,type:_.AT_IMAGE_ELEMENT,url:n,request_method:"GET"}],(function(r,_,s,l){r?(a.change_image(e,i,t,r,n),o(!0)):o(!1)}),null,null):o(!0)},t.replace_image=function(e,t,n,o){o=o||function(){};var _=a.get_texture_by_name(e,t);if(!_)return r.error("Couldn't find texture \""+t+'" in object "'+e.name+'".'),void o(!1);if(_.is_movie)return r.error("Changing video textures is forbidden."),void o(!1);if(!("src"in n))return r.error("Incorrect image."),void o(!1);var i=n.src;if(n.complete)a.change_image(e,_,t,n,i),o(!0);else{var s=n.onload,l=n.onerror;n.onload=function(){s&&s.call(n),a.change_image(e,_,t,n,i),o(!0)},n.onerror=function(){l&&l.call(n),o(!1)}}},t.get_texture_names=function(e){return o.is_mesh(e)?a.get_texture_names(e):(r.error("Object must be type of mesh."),[])}})),Ey=nA("version",(function(e,t){t.version=qR,t.version_str=WR,t.type=JR,t.date=ZR,t.date_str=$R,t.get_build_version=eI}));tA.app=Cb,tA.camera_anim=kb,tA.fps=Fb,tA.gp_conf=Kb,tA.gyroscope=Bb,tA.hmd=Db,tA.hmd_conf=Xb,tA.mixer=jb,tA.mouse=zb,tA.npc_ai=Vb,tA.preloader=qb,tA.screenshooter=Wb,tA.storage=Gb,tA.anchors=Jb,tA.animation=Qb,tA.armature=Zb,tA.assets=$b,tA.camera=Pb,tA.config=Ab,tA.constraints=hb,tA.container=vb,tA.controls=mb,tA.data=gb,tA.debug=Nb,tA.geometry=ey,tA.hud=ty,tA.input=Rb,tA.lights=ry,tA.logic_nodes=ny,tA.main=bb,tA.material=ay,tA.math=oy,tA.nla=_y,tA.objects=iy,tA.particles=sy,tA.physics=yb,tA.rgb=ly,tA.scenes=Yb,tA.screen=Lb,tA.sfx=Hb,tA.textures=cy,tA.time=wb,tA.transform=Mb,tA.tsr=Ub,tA.util=xb,tA.version=Ey,tA.print=mN,tA.vec3=o,tA.vec4=_,tA.mat3=n,tA.mat4=a,tA.quat=i,tA.register("vec3",(function(e,t){for(var r in o)e[r]=o[r]})),tA.register("vec4",(function(e,t){for(var r in _)e[r]=_[r]})),tA.register("mat3",(function(e,t){for(var r in n)e[r]=n[r]})),tA.register("mat4",(function(e,t){for(var r in a)e[r]=a[r]})),tA.register("quat",(function(e,t){for(var r in i)e[r]=i[r]}));var uy,dy,Ty=tA,fy=((uy=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||uy)},uy.\u0275cmp=ht({type:uy,selectors:[["app-banner"]],decls:8,vars:0,consts:[["charset","utf-8"],["name","viewport","content","initial-scale=1.0, user-scalable=no, width=device-width"],["id","main_canvas_container"]],template:function(e,t){1&e&&(v_(0,"html"),v_(1,"head"),v_(2,"title"),B_(3,"VR"),m_(),g_(4,"meta",0),g_(5,"meta",1),m_(),v_(6,"body"),g_(7,"div",2),m_(),m_())},styles:['[_ngcontent-%COMP%]:active{-webkit-tap-highlight-color:rgba(0,0,0,0);-moz-tap-highlight-color:transparent;-tap-highlight-color:transparent}body[_ngcontent-%COMP%]{background-color:#000;margin:0;overflow:hidden}#main_canvas_container[_ngcontent-%COMP%]{position:relative;left:0;top:0;width:100%;height:400px}#controls_container[_ngcontent-%COMP%]{position:relative;bottom:0;right:0;width:30%}#controls_container[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-bottom:0}.hmd_conf_dialog[_ngcontent-%COMP%]{position:relative;top:50%;left:50%;z-index:10;transform:translate(-50%,-50%);-webkit-transform:translate(-50%,-50%)}a[_ngcontent-%COMP%]{font-family:Arial,sans-serif;background-color:transparent;-webkit-text-decoration-skip:objects}a[_ngcontent-%COMP%]:active, a[_ngcontent-%COMP%]:hover{outline-width:0}#controls_container[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{background-color:#fff;border:2px solid rgba(98,98,98,.2);border-radius:2px;width:170px;height:30px;display:block;float:left;font-size:16px;font-weight:400;color:red;cursor:pointer;text-decoration:none;text-align:center;padding-left:0;line-height:28px;margin-bottom:4px;box-shadow:0 0 4px 0 rgba(98,98,98,.8);transition:opacity .1s ease-in-out}.btn.active[_ngcontent-%COMP%]{background-color:#5276cf}.btn[_ngcontent-%COMP%]:hover{opacity:.8}.row[_ngcontent-%COMP%]:after{clear:both;display:table;content:" "}']}),uy),py=Ty.app,Py=Ty.config,Sy=Ty.constraints,Ay=Ty.container,hy=Ty.controls,vy=Ty.data,my=Ty.geometry,gy=Ty.hmd,Oy=Ty.input,Ny=Ty.math,Ry=Ty.material,Iy=Ty.objects,by=Ty.physics,yy=Ty.preloader,Ly=Ty.scenes,Yy=Ty.scenes,My=Ty.screen,xy=Ty.transform,Cy=Ty.tsr,wy=Ty.util,Uy=Ty.version,ky=Ty.vec3,Dy=!1,Fy=Ty.quat.create(),Gy=ky.create(),Ky=ky.create(),By=Cy.create(),Xy=Cy.create(),Hy=Cy.create(),jy=Ny.create_pline(),zy="./banner.component.css",Qy=new Float32Array([0,0,0]),Vy=new Float32Array([0,0,-50]),qy="DEBUG"==Uy.type();function Wy(){Dy?(gy.disable_hmd(),My.exit_fullscreen_hmd(),Dy=!1):(gy.enable_hmd(gy.HMD_ALL_AXES_MOUSE_YAW),My.request_fullscreen_hmd(document.body,Jy,Zy),Dy=!0)}function Jy(){console.log("ShopInChain in VR-mode."),dy.innerText="Back to Home",function(){var e=Yy.get_object_by_name("gamepad_1"),t=Yy.get_object_by_name("gamepad_2");gy.enable_controllers(e,t),tL(e,"line_1",[1,0,0]),tL(t,"line_2",[0,0,1]);var r=Oy.get_vr_controller_id(0);rL(e,"pointer_1",r);var n=Oy.get_vr_controller_id(1);rL(t,"pointer_2",n),aL(e,r),aL(t,n)}();var e=Ay.get_canvas();zy=e.style,e.style=""}function Zy(){Ay.get_canvas().style=zy,console.log("ShopInChain in One Eye Mode."),dy.innerText=Oy.can_use_device(Oy.DEVICE_HMD)?"VR Shop":"VR Shop is not avaliable"}function $y(e){yy.update_preloader(e)}function eL(e,t){t?py.enable_camera_controls(!1,!1,!1,null,!1,!0):console.log("ShopInChain load failure")}function tL(e,t,r){var n=Iy.create_line(t),a=new Float32Array([0,0,0,0,0,-50]);my.draw_line(n,a),Ry.set_line_params(n,{color:r,width:3}),Sy.append_stiff(n,e,[0,0,0])}function rL(e,t,r){var n=Yy.get_object_by_name(t);if(e&&n){var a=hy.create_elapsed_sensor();hy.create_sensor_manifold(n,"POINTER_CONTROLLER"+r,hy.CT_CONTINUOUS,[a],hy.default_OR_logic_fun,(function(t,r,n){var a=jy,o=xy.get_translation(e,Gy);Ny.set_pline_initial_point(a,o);var _=xy.get_rotation(e,Fy),i=ky.transformQuat(wy.AXIS_MZ,_,Gy);Ny.set_pline_directional_vec(a,i);var s=Ny.line_plane_intersect(wy.AXIS_MZ,0,a,Gy);s&&(s[0]=wy.clamp(s[0],-8,8),s[1]=wy.clamp(s[1],-8,8),s[2]=.1,xy.set_translation_v(t,s))}));var o=hy.create_gamepad_btn_sensor(Oy.GMPD_MENU_BUTTON,r,!0);hy.create_sensor_manifold(n,"MOVE_"+r,hy.CT_TRIGGER,[o],null,(function(e,t,r){if(r>0){var n=xy.get_translation(e,Gy);gy.set_position(n)}}))}}function nL(e,t,r){var n=xy.get_tsr(e,Xy),a=xy.get_tsr(t,Hy),o=Cy.invert(a,Hy);return Cy.multiply(o,n,r)}function aL(e,t){if(e){var r=hy.create_elapsed_sensor(),n=hy.create_gamepad_btn_sensor(Oy.GMPD_TRIGGER_BUTTON,t),a=hy.create_gamepad_btn_sensor(Oy.GMPD_TRACKPAD_BUTTON,t),o=hy.create_ray_sensor(e,Qy,Vy,"PICKUP",!1,!0,!1),_={obj:null,position:ky.create()};hy.create_sensor_manifold(e,"PICKUP_"+t,hy.CT_LEVEL,[o,n,a,r],(function(e){return e[1]>0||e[2]>0}),(function(e,t,r,n){if(hy.get_sensor_value(e,t,1)||hy.get_sensor_value(e,t,2)){if(hy.get_sensor_value(e,t,0)>0){var a=hy.get_sensor_payload(e,t,0);n.obj=a.obj_hit,by.disable_simulation(n.obj);var o=nL(n.obj,e,By);Sy.append_stiff(n.obj,e,Cy.get_trans(o,Gy),Cy.get_quat(o,Fy)),Ly.set_outline_intensity(n.obj,1)}}else if(n.obj){by.enable_simulation(n.obj),Sy.remove(n.obj);var _=hy.get_sensor_value(e,t,3),i=xy.get_translation(n.obj,Gy),s=ky.subtract(i,n.position,Gy),l=ky.scale(s,1/_,s);by.apply_velocity_world(n.obj,l[0],l[1],l[2]),Ly.set_outline_intensity(n.obj,0),n.obj=null}}),_);var i=hy.create_gamepad_axis_sensor(Oy.GMPD_AXIS_1,t);hy.create_sensor_manifold(e,"BRING_CLOSER_PICKED_OBJECT"+t,hy.CT_CONTINUOUS,[r,i],null,(function(e,t,r,n){if(n.obj){var a=hy.get_sensor_value(e,t,0),o=hy.get_sensor_value(e,t,1);if(Math.abs(o)>.3){var _=nL(n.obj,e,By),i=Cy.get_trans(_,Gy),s=function(e,t,r){var n,a=Math.abs(t)*r;return t<0?e>.3?-e*a:0:e*((n=a)/(1-n))}(ky.length(i),o,a),l=ky.scale(wy.AXIS_MZ,s,Ky),c=ky.add(i,l,Gy);Sy.append_stiff(n.obj,e,c,Cy.get_quat(_,Fy))}}}),_),hy.create_sensor_manifold(_,"UPDATE_PICKED_OBJECT_POSITION"+t,hy.CT_CONTINUOUS,[r],null,(function(e,t,r){if(e.obj){var n=xy.get_translation(e.obj,Gy);ky.copy(n,e.position)}}))}}Py.get_assets_path(""),py.init({canvas_container_id:"main_canvas_container",callback:function(e,t){if(t){yy.create_preloader(),e.oncontextmenu=function(e){return e.preventDefault(),e.stopPropagation(),!1};var r=document.createElement("div");r.id="controls_container",n=Oy.can_use_device(Oy.DEVICE_HMD)?"Open VR":"VR is not avaliable",(a=document.createElement("a")).className="btn",a.innerText=n,Oy.add_click_listener(dy=a,Wy),r.appendChild(dy),Ay.get_container().appendChild(r),vy.load("assets/cadeosio.json",eL,$y)}else console.log("ShopInChain init failure");var n,a},console_verbose:qy,autoresize:!0,stereo:"HMD"});var oL,_L,iL,sL,lL=((oL=function(){function e(t){var r=this;_classCallCheck(this,e),this.accountService=t,this.accountService.user.subscribe((function(e){return r.user=e}))}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||oL)(P_(tP))},oL.\u0275cmp=ht({type:oL,selectors:[["app-root"]],decls:4,vars:0,template:function(e,t){1&e&&(g_(0,"app-header"),g_(1,"app-banner"),g_(2,"router-outlet"),g_(3,"app-footer"))},directives:[qS,fy,Mp,zP],encapsulation:2}),oL),cL=r("CxY0"),EL=new Qe("JWT_OPTIONS"),uL=((_L=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;_classCallCheck(this,e),this.tokenGetter=t&&t.tokenGetter||function(){}}return _createClass(e,[{key:"urlBase64Decode",value:function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(t)}},{key:"b64decode",value:function(e){var t="";if((e=String(e).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,a=0,o=0;n=e.charAt(o++);~n&&(r=a%4?64*r+n:n,a++%4)?t+=String.fromCharCode(255&r>>(-2*a&6)):0)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return t}},{key:"b64DecodeUnicode",value:function(e){return decodeURIComponent(Array.prototype.map.call(this.b64decode(e),(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}},{key:"decodeToken",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tokenGetter();if(!e||""===e)return null;var t=e.split(".");if(3!==t.length)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");var r=this.urlBase64Decode(t[1]);if(!r)throw new Error("Cannot decode the token.");return JSON.parse(r)}},{key:"getTokenExpirationDate",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tokenGetter();if(!(e=this.decodeToken(t))||!e.hasOwnProperty("exp"))return null;var r=new Date(0);return r.setUTCSeconds(e.exp),r}},{key:"isTokenExpired",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.tokenGetter(),t=arguments.length>1?arguments[1]:void 0;if(!e||""===e)return!0;var r=this.getTokenExpirationDate(e);return t=t||0,null!==r&&!(r.valueOf()>(new Date).valueOf()+1e3*t)}}]),e}()).\u0275fac=function(e){return new(e||_L)(rt(EL))},_L.\u0275prov=Pe({token:_L,factory:_L.\u0275fac}),_L),dL=function(){var e=function(){function e(t,r){_classCallCheck(this,e),this.jwtHelper=r,this.standardPorts=["80","443"],this.tokenGetter=t.tokenGetter,this.headerName=t.headerName||"Authorization",this.authScheme=t.authScheme||""===t.authScheme?t.authScheme:"Bearer ",this.whitelistedDomains=t.whitelistedDomains||[],this.blacklistedRoutes=t.blacklistedRoutes||[],this.throwNoTokenError=t.throwNoTokenError||!1,this.skipWhenExpired=t.skipWhenExpired}return _createClass(e,[{key:"isWhitelistedDomain",value:function(e){var t=Object(cL.parse)(e.url,!1,!0),r=null!==t.hostname?"".concat(t.hostname).concat(t.port&&!this.standardPorts.includes(t.port)?":"+t.port:""):t.hostname;return null===r||this.whitelistedDomains.findIndex((function(e){return"string"==typeof e?e===r:e instanceof RegExp&&e.test(r)}))>-1}},{key:"isBlacklistedRoute",value:function(e){var t=Object(cL.parse)(e.url,!1,!0);return this.blacklistedRoutes.findIndex((function(r){if("string"==typeof r){var n=Object(cL.parse)(r,!1,!0);return n.hostname===t.hostname&&n.path===t.path}return r instanceof RegExp&&r.test(e.url)}))>-1}},{key:"handleInterception",value:function(e,t,r){var n=!1;if(!e&&this.throwNoTokenError)throw new Error("Could not get token from tokenGetter function.");return this.skipWhenExpired&&(n=!e||this.jwtHelper.isTokenExpired(e)),e&&n&&this.skipWhenExpired?t=t.clone():e&&(t=t.clone({setHeaders:_defineProperty({},this.headerName,"".concat(this.authScheme).concat(e))})),r.handle(t)}},{key:"intercept",value:function(e,t){var r=this;if(!this.isWhitelistedDomain(e)||this.isBlacklistedRoute(e))return t.handle(e);var n=this.tokenGetter(e);return n instanceof Promise?q(n).pipe(W((function(n){return r.handleInterception(n,e,t)}))):this.handleInterception(n,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(rt(EL),rt(uL))},e.\u0275prov=Pe({token:e,factory:e.\u0275fac}),e}(),TL=((sL=iL=function(){function e(t){if(_classCallCheck(this,e),t)throw new Error("JwtModule is already loaded. It should only be imported in your application's main module.")}return _createClass(e,null,[{key:"forRoot",value:function(e){return{ngModule:iL,providers:[{provide:nd,useClass:dL,multi:!0},e.jwtOptionsProvider||{provide:EL,useValue:e.config},uL]}}}]),e}()).\u0275mod=Ot({type:sL}),sL.\u0275inj=Ae({factory:function(e){return new(e||sL)(rt(sL,12))}}),sL);function fL(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function pL(e){switch(e.length){case 0:return new uP;case 1:return e[0];default:return new dP(e)}}function PL(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},_=[],i=[],s=-1,l=null;if(n.forEach((function(e){var r=e.offset,n=r==s,c=n&&l||{};Object.keys(e).forEach((function(r){var n=r,i=e[r];if("offset"!==r)switch(n=t.normalizePropertyName(n,_),i){case"!":i=a[r];break;case"*":i=o[r];break;default:i=t.normalizeStyleValue(r,n,i,_)}c[n]=i})),n||i.push(c),l=c,s=r})),_.length){var c="\n - ";throw new Error("Unable to animate due to the following errors:".concat(c).concat(_.join(c)))}return i}function SL(e,t,r,n){switch(t){case"start":e.onStart((function(){return n(r&&AL(r,"start",e))}));break;case"done":e.onDone((function(){return n(r&&AL(r,"done",e))}));break;case"destroy":e.onDestroy((function(){return n(r&&AL(r,"destroy",e))}))}}function AL(e,t,r){var n=r.totalTime,a=hL(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null==n?e.totalTime:n,!!r.disabled),o=e._data;return null!=o&&(a._data=o),a}function hL(e,t,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,_=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:r,toState:n,phaseName:a,totalTime:o,disabled:!!_}}function vL(e,t,r){var n;return e instanceof Map?(n=e.get(t))||e.set(t,n=r):(n=e[t])||(n=e[t]=r),n}function mL(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var gL=function(e,t){return!1},OL=function(e,t){return!1},NL=function(e,t,r){return[]},RL=fL();(RL||"undefined"!=typeof Element)&&(gL=function(e,t){return e.contains(t)},OL=function(){if(RL||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,r){return t.apply(e,[r])}:OL}(),NL=function(e,t,r){var n=[];if(r)n.push.apply(n,_toConsumableArray(e.querySelectorAll(t)));else{var a=e.querySelector(t);a&&n.push(a)}return n});var IL=null,bL=!1;function yL(e){IL||(IL=("undefined"!=typeof document?document.body:null)||{},bL=!!IL.style&&"WebkitAppearance"in IL.style);var t=!0;return IL.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in IL.style)&&bL)&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in IL.style),t}var LL=OL,YL=gL,ML=NL;function xL(e){var t={};return Object.keys(e).forEach((function(r){var n=r.replace(/([a-z])([A-Z])/g,"$1-$2");t[n]=e[r]})),t}var CL,wL=((CL=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"validateStyleProperty",value:function(e){return yL(e)}},{key:"matchesElement",value:function(e,t){return LL(e,t)}},{key:"containsElement",value:function(e,t){return YL(e,t)}},{key:"query",value:function(e,t,r){return ML(e,t,r)}},{key:"computeStyle",value:function(e,t,r){return r||""}},{key:"animate",value:function(e,t,r,n,a){return arguments.length>5&&void 0!==arguments[5]&&arguments[5],arguments.length>6&&arguments[6],new uP(r,n)}}]),e}()).\u0275fac=function(e){return new(e||CL)},CL.\u0275prov=Pe({token:CL,factory:CL.\u0275fac}),CL),UL=function(){var e=function e(){_classCallCheck(this,e)};return e.NOOP=new wL,e}();function kL(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:DL(parseFloat(t[1]),t[2])}function DL(e,t){switch(t){case"s":return 1e3*e;default:return e}}function FL(e,t,r){return e.hasOwnProperty("duration")?e:function(e,t,r){var n,a=0,o="";if("string"==typeof e){var _=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===_)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};n=DL(parseFloat(_[1]),_[2]);var i=_[3];null!=i&&(a=DL(parseFloat(i),_[4]));var s=_[5];s&&(o=s)}else n=e;if(!r){var l=!1,c=t.length;n<0&&(t.push("Duration values below 0 are not allowed for this animation step."),l=!0),a<0&&(t.push("Delay values below 0 are not allowed for this animation step."),l=!0),l&&t.splice(c,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:n,delay:a,easing:o}}(e,t,r)}function GL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach((function(r){t[r]=e[r]})),t}function KL(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var n in e)r[n]=e[n];else GL(e,r);return r}function BL(e,t,r){return r?t+":"+r+";":""}function XL(e){for(var t="",r=0;r<e.style.length;r++){var n=e.style.item(r);t+=BL(0,n,e.style.getPropertyValue(n))}for(var a in e.style)e.style.hasOwnProperty(a)&&!a.startsWith("_")&&(t+=BL(0,a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),e.style[a]));e.setAttribute("style",t)}function HL(e,t,r){e.style&&(Object.keys(t).forEach((function(n){var a=ZL(n);r&&!r.hasOwnProperty(n)&&(r[n]=e.style[a]),e.style[a]=t[n]})),fL()&&XL(e))}function jL(e,t){e.style&&(Object.keys(t).forEach((function(t){var r=ZL(t);e.style[r]=""})),fL()&&XL(e))}function zL(e){return Array.isArray(e)?1==e.length?e[0]:iP(e):e}var QL=new RegExp("{{\\s*(.+?)\\s*}}","g");function VL(e){var t=[];if("string"==typeof e){for(var r;r=QL.exec(e);)t.push(r[1]);QL.lastIndex=0}return t}function qL(e,t,r){var n=e.toString(),a=n.replace(QL,(function(e,n){var a=t[n];return t.hasOwnProperty(n)||(r.push("Please provide a value for the animation param ".concat(n)),a=""),a.toString()}));return a==n?e:a}function WL(e){for(var t=[],r=e.next();!r.done;)t.push(r.value),r=e.next();return t}var JL=/-+([a-z0-9])/g;function ZL(e){return e.replace(JL,(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t[1].toUpperCase()}))}function $L(e,t){return 0===e||0===t}function eY(e,t,r){var n=Object.keys(r);if(n.length&&t.length){var a=t[0],o=[];if(n.forEach((function(e){a.hasOwnProperty(e)||o.push(e),a[e]=r[e]})),o.length)for(var _=function(){var r=t[i];o.forEach((function(t){r[t]=rY(e,t)}))},i=1;i<t.length;i++)_()}return t}function tY(e,t,r){switch(t.type){case 7:return e.visitTrigger(t,r);case 0:return e.visitState(t,r);case 1:return e.visitTransition(t,r);case 2:return e.visitSequence(t,r);case 3:return e.visitGroup(t,r);case 4:return e.visitAnimate(t,r);case 5:return e.visitKeyframes(t,r);case 6:return e.visitStyle(t,r);case 8:return e.visitReference(t,r);case 9:return e.visitAnimateChild(t,r);case 10:return e.visitAnimateRef(t,r);case 11:return e.visitQuery(t,r);case 12:return e.visitStagger(t,r);default:throw new Error("Unable to resolve animation metadata node #".concat(t.type))}}function rY(e,t){return window.getComputedStyle(e)[t]}var nY=new Set(["true","1"]),aY=new Set(["false","0"]);function oY(e,t){var r=nY.has(e)||aY.has(e),n=nY.has(t)||aY.has(t);return function(a,o){var _="*"==e||e==a,i="*"==t||t==o;return!_&&r&&"boolean"==typeof a&&(_=a?nY.has(e):aY.has(e)),!i&&n&&"boolean"==typeof o&&(i=o?nY.has(t):aY.has(t)),_&&i}}var _Y=new RegExp("s*:selfs*,?","g");function iY(e,t,r){return new sY(e).build(t,r)}var sY=function(){function e(t){_classCallCheck(this,e),this._driver=t}return _createClass(e,[{key:"build",value:function(e,t){var r=new lY(t);return this._resetContextStyleTimingState(r),tY(this,zL(e),r)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var r=this,n=t.queryCount=0,a=t.depCount=0,o=[],_=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach((function(e){if(r._resetContextStyleTimingState(t),0==e.type){var i=e,s=i.name;s.toString().split(/\s*,\s*/).forEach((function(e){i.name=e,o.push(r.visitState(i,t))})),i.name=s}else if(1==e.type){var l=r.visitTransition(e,t);n+=l.queryCount,a+=l.depCount,_.push(l)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")})),{type:7,name:e.name,states:o,transitions:_,queryCount:n,depCount:a,options:null}}},{key:"visitState",value:function(e,t){var r=this.visitStyle(e.styles,t),n=e.options&&e.options.params||null;if(r.containsDynamicStyles){var a=new Set,o=n||{};if(r.styles.forEach((function(e){if(cY(e)){var t=e;Object.keys(t).forEach((function(e){VL(t[e]).forEach((function(e){o.hasOwnProperty(e)||a.add(e)}))}))}})),a.size){var _=WL(a.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(_.join(", ")))}}return{type:0,name:e.name,style:r,options:n?{params:n}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var r,n,a,o=tY(this,zL(e.animation),t);return{type:1,matchers:(r=e.expr,n=t.errors,a=[],"string"==typeof r?r.split(/\s*,\s*/).forEach((function(e){return function(e,t,r){if(":"==e[0]){var n=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,r);if("function"==typeof n)return void t.push(n);e=n}var a=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==a||a.length<4)return r.push('The provided transition expression "'.concat(e,'" is not supported')),t;var o=a[1],_=a[2],i=a[3];t.push(oY(o,i)),"<"!=_[0]||"*"==o&&"*"==i||t.push(oY(i,o))}(e,a,n)})):a.push(r),a),animation:o,queryCount:t.queryCount,depCount:t.depCount,options:EY(e.options)}}},{key:"visitSequence",value:function(e,t){var r=this;return{type:2,steps:e.steps.map((function(e){return tY(r,e,t)})),options:EY(e.options)}}},{key:"visitGroup",value:function(e,t){var r=this,n=t.currentTime,a=0,o=e.steps.map((function(e){t.currentTime=n;var o=tY(r,e,t);return a=Math.max(a,t.currentTime),o}));return t.currentTime=a,{type:3,steps:o,options:EY(e.options)}}},{key:"visitAnimate",value:function(e,t){var r,n=function(e,t){var r=null;if(e.hasOwnProperty("duration"))r=e;else if("number"==typeof e)return uY(FL(e,t).duration,0,"");var n=e;if(n.split(/\s+/).some((function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)}))){var a=uY(0,0,"");return a.dynamic=!0,a.strValue=n,a}return uY((r=r||FL(n,t)).duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=n;var a=e.styles?e.styles:sP({});if(5==a.type)r=this.visitKeyframes(a,t);else{var o=e.styles,_=!1;if(!o){_=!0;var i={};n.easing&&(i.easing=n.easing),o=sP(i)}t.currentTime+=n.duration+n.delay;var s=this.visitStyle(o,t);s.isEmptyStep=_,r=s}return t.currentAnimateTimings=null,{type:4,timings:n,style:r,options:null}}},{key:"visitStyle",value:function(e,t){var r=this._makeStyleAst(e,t);return this._validateStyleAst(r,t),r}},{key:"_makeStyleAst",value:function(e,t){var r=[];Array.isArray(e.styles)?e.styles.forEach((function(e){"string"==typeof e?"*"==e?r.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):r.push(e)})):r.push(e.styles);var n=!1,a=null;return r.forEach((function(e){if(cY(e)){var t=e,r=t.easing;if(r&&(a=r,delete t.easing),!n)for(var o in t)if(t[o].toString().indexOf("{{")>=0){n=!0;break}}})),{type:6,styles:r,easing:a,offset:e.offset,containsDynamicStyles:n,options:null}}},{key:"_validateStyleAst",value:function(e,t){var r=this,n=t.currentAnimateTimings,a=t.currentTime,o=t.currentTime;n&&o>0&&(o-=n.duration+n.delay),e.styles.forEach((function(e){"string"!=typeof e&&Object.keys(e).forEach((function(n){if(r._driver.validateStyleProperty(n)){var _,i,s,l,c,E=t.collectedStyles[t.currentQuerySelector],u=E[n],d=!0;u&&(o!=a&&o>=u.startTime&&a<=u.endTime&&(t.errors.push('The CSS property "'.concat(n,'" that exists between the times of "').concat(u.startTime,'ms" and "').concat(u.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(o,'ms" and "').concat(a,'ms"')),d=!1),o=u.startTime),d&&(E[n]={startTime:o,endTime:a}),t.options&&(_=e[n],i=t.options,s=t.errors,l=i.params||{},(c=VL(_)).length&&c.forEach((function(e){l.hasOwnProperty(e)||s.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))})))}else t.errors.push('The provided animation property "'.concat(n,'" is not a supported CSS property for animations'))}))}))}},{key:"visitKeyframes",value:function(e,t){var r=this,n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),n;var a=0,o=[],_=!1,i=!1,s=0,l=e.steps.map((function(e){var n=r._makeStyleAst(e,t),l=null!=n.offset?n.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach((function(e){if(cY(e)&&e.hasOwnProperty("offset")){var r=e;t=parseFloat(r.offset),delete r.offset}}));else if(cY(e)&&e.hasOwnProperty("offset")){var r=e;t=parseFloat(r.offset),delete r.offset}return t}(n.styles),c=0;return null!=l&&(a++,c=n.offset=l),i=i||c<0||c>1,_=_||c<s,s=c,o.push(c),n}));i&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),_&&t.errors.push("Please ensure that all keyframe offsets are in order");var c=e.steps.length,E=0;a>0&&a<c?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==a&&(E=1/(c-1));var u=c-1,d=t.currentTime,T=t.currentAnimateTimings,f=T.duration;return l.forEach((function(e,a){var _=E>0?a==u?1:E*a:o[a],i=_*f;t.currentTime=d+T.delay+i,T.duration=i,r._validateStyleAst(e,t),e.offset=_,n.styles.push(e)})),n}},{key:"visitReference",value:function(e,t){return{type:8,animation:tY(this,zL(e.animation),t),options:EY(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:EY(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:EY(e.options)}}},{key:"visitQuery",value:function(e,t){var r=t.currentQuerySelector,n=e.options||{};t.queryCount++,t.currentQuery=e;var a=_slicedToArray(function(e){var t=!!e.split(/\s*,\s*/).find((function(e){return":self"==e}));return t&&(e=e.replace(_Y,"")),[e=e.replace(/@\*/g,".ng-trigger").replace(/@\w+/g,(function(e){return".ng-trigger-"+e.substr(1)})).replace(/:animating/g,".ng-animating"),t]}(e.selector),2),o=a[0],_=a[1];t.currentQuerySelector=r.length?r+" "+o:o,vL(t.collectedStyles,t.currentQuerySelector,{});var i=tY(this,zL(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=r,{type:11,selector:o,limit:n.limit||0,optional:!!n.optional,includeSelf:_,animation:i,originalSelector:e.selector,options:EY(e.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var r="full"===e.timings?{duration:0,delay:0,easing:"full"}:FL(e.timings,t.errors,!0);return{type:12,animation:tY(this,zL(e.animation),t),timings:r,options:null}}}]),e}(),lY=function e(t){_classCallCheck(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null};function cY(e){return!Array.isArray(e)&&"object"==typeof e}function EY(e){var t;return e?(e=GL(e)).params&&(e.params=(t=e.params)?GL(t):null):e={},e}function uY(e,t,r){return{duration:e,delay:t,easing:r}}function dY(e,t,r,n,a,o){var _=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,i=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:r,postStyleProps:n,duration:a,delay:o,totalTime:a+o,easing:_,subTimeline:i}}var TY=function(){function e(){_classCallCheck(this,e),this._map=new Map}return _createClass(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var r,n=this._map.get(e);n||this._map.set(e,n=[]),(r=n).push.apply(r,_toConsumableArray(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),fY=new RegExp(":enter","g"),pY=new RegExp(":leave","g");function PY(e,t,r,n,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},_=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},i=arguments.length>7?arguments[7]:void 0,s=arguments.length>8?arguments[8]:void 0,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new SY).buildKeyframes(e,t,r,n,a,o,_,i,s,l)}var SY=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"buildKeyframes",value:function(e,t,r,n,a,o,_,i,s){var l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];s=s||new TY;var c=new hY(e,t,s,n,a,l,[]);c.options=i,c.currentTimeline.setStyles([o],null,c.errors,i),tY(this,r,c);var E=c.timelines.filter((function(e){return e.containsAnimation()}));if(E.length&&Object.keys(_).length){var u=E[E.length-1];u.allowOnlyTimelineStyles()||u.setStyles([_],null,c.errors,i)}return E.length?E.map((function(e){return e.buildKeyframes()})):[dY(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var r=t.subInstructions.consume(t.element);if(r){var n=t.createSubContext(e.options),a=t.currentTimeline.currentTime,o=this._visitSubInstructions(r,n,n.options);a!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var r=t.createSubContext(e.options);r.transformIntoNewTimeline(),this.visitReference(e.animation,r),t.transformIntoNewTimeline(r.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,r){var n=t.currentTimeline.currentTime,a=null!=r.duration?kL(r.duration):null,o=null!=r.delay?kL(r.delay):null;return 0!==a&&e.forEach((function(e){var r=t.appendInstructionToTimeline(e,a,o);n=Math.max(n,r.duration+r.delay)})),n}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),tY(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var r=this,n=t.subContextCount,a=t,o=e.options;if(o&&(o.params||o.delay)&&((a=t.createSubContext(o)).transformIntoNewTimeline(),null!=o.delay)){6==a.previousNode.type&&(a.currentTimeline.snapshotCurrentStyles(),a.previousNode=AY);var _=kL(o.delay);a.delayNextStep(_)}e.steps.length&&(e.steps.forEach((function(e){return tY(r,e,a)})),a.currentTimeline.applyStylesToKeyframe(),a.subContextCount>n&&a.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var r=this,n=[],a=t.currentTimeline.currentTime,o=e.options&&e.options.delay?kL(e.options.delay):0;e.steps.forEach((function(_){var i=t.createSubContext(e.options);o&&i.delayNextStep(o),tY(r,_,i),a=Math.max(a,i.currentTimeline.currentTime),n.push(i.currentTimeline)})),n.forEach((function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)})),t.transformIntoNewTimeline(a),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var r=e.strValue;return FL(t.params?qL(r,t.params,t.errors):r,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var r=t.currentAnimateTimings=this._visitTiming(e.timings,t),n=t.currentTimeline;r.delay&&(t.incrementTime(r.delay),n.snapshotCurrentStyles());var a=e.style;5==a.type?this.visitKeyframes(a,t):(t.incrementTime(r.duration),this.visitStyle(a,t),n.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var r=t.currentTimeline,n=t.currentAnimateTimings;!n&&r.getCurrentStyleProperties().length&&r.forwardFrame();var a=n&&n.easing||e.easing;e.isEmptyStep?r.applyEmptyStep(a):r.setStyles(e.styles,a,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var r=t.currentAnimateTimings,n=t.currentTimeline.duration,a=r.duration,o=t.createSubContext().currentTimeline;o.easing=r.easing,e.styles.forEach((function(e){o.forwardTime((e.offset||0)*a),o.setStyles(e.styles,e.easing,t.errors,t.options),o.applyStylesToKeyframe()})),t.currentTimeline.mergeTimelineCollectedStyles(o),t.transformIntoNewTimeline(n+a),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var r=this,n=t.currentTimeline.currentTime,a=e.options||{},o=a.delay?kL(a.delay):0;o&&(6===t.previousNode.type||0==n&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=AY);var _=n,i=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!a.optional,t.errors);t.currentQueryTotal=i.length;var s=null;i.forEach((function(n,a){t.currentQueryIndex=a;var i=t.createSubContext(e.options,n);o&&i.delayNextStep(o),n===t.element&&(s=i.currentTimeline),tY(r,e.animation,i),i.currentTimeline.applyStylesToKeyframe(),_=Math.max(_,i.currentTimeline.currentTime)})),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(_),s&&(t.currentTimeline.mergeTimelineCollectedStyles(s),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var r=t.parentContext,n=t.currentTimeline,a=e.timings,o=Math.abs(a.duration),_=o*(t.currentQueryTotal-1),i=o*t.currentQueryIndex;switch(a.duration<0?"reverse":a.easing){case"reverse":i=_-i;break;case"full":i=r.currentStaggerTime}var s=t.currentTimeline;i&&s.delayNextStep(i);var l=s.currentTime;tY(this,e.animation,t),t.previousNode=e,r.currentStaggerTime=n.currentTime-l+(n.startTime-r.currentTimeline.startTime)}}]),e}(),AY={},hY=function(){function e(t,r,n,a,o,_,i,s){_classCallCheck(this,e),this._driver=t,this.element=r,this.subInstructions=n,this._enterClassName=a,this._leaveClassName=o,this.errors=_,this.timelines=i,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=AY,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=s||new vY(this._driver,r,0),i.push(this.currentTimeline)}return _createClass(e,[{key:"updateOptions",value:function(e,t){var r=this;if(e){var n=e,a=this.options;null!=n.duration&&(a.duration=kL(n.duration)),null!=n.delay&&(a.delay=kL(n.delay));var o=n.params;if(o){var _=a.params;_||(_=this.options.params={}),Object.keys(o).forEach((function(e){t&&_.hasOwnProperty(e)||(_[e]=qL(o[e],_,r.errors))}))}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var r=e.params={};Object.keys(t).forEach((function(e){r[e]=t[e]}))}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,a=r||this.element,o=new e(this._driver,a,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(a,n||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(t),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=AY,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,r){var n={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=r?r:0)+e.delay,easing:""},a=new mY(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,n,e.stretchStartingKeyframe);return this.timelines.push(a),n}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,r,n,a,o){var _=[];if(n&&_.push(this.element),e.length>0){e=(e=e.replace(fY,"."+this._enterClassName)).replace(pY,"."+this._leaveClassName);var i=this._driver.query(this.element,e,1!=r);0!==r&&(i=r<0?i.slice(i.length+r,i.length):i.slice(0,r)),_.push.apply(_,_toConsumableArray(i))}return a||0!=_.length||o.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),_}},{key:"params",get:function(){return this.options.params}}]),e}(),vY=function(){function e(t,r,n,a){_classCallCheck(this,e),this._driver=t,this.element=r,this.startTime=n,this._elementTimelineStylesLookup=a,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(r),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(r,this._localTimelineStyles)),this._loadKeyframe()}return _createClass(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,r){return this.applyStylesToKeyframe(),new e(this._driver,t,r||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach((function(e){t._backFill[e]=t._globalTimelineStyles[e]||"*",t._currentKeyframe[e]="*"})),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,r,n){var a=this;t&&(this._previousKeyframe.easing=t);var o=n&&n.params||{},_=function(e,t){var r,n={};return e.forEach((function(e){"*"===e?(r=r||Object.keys(t)).forEach((function(e){n[e]="*"})):KL(e,!1,n)})),n}(e,this._globalTimelineStyles);Object.keys(_).forEach((function(e){var t=qL(_[e],o,r);a._pendingStyles[e]=t,a._localTimelineStyles.hasOwnProperty(e)||(a._backFill[e]=a._globalTimelineStyles.hasOwnProperty(e)?a._globalTimelineStyles[e]:"*"),a._updateStyle(e,t)}))}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,r=Object.keys(t);0!=r.length&&(this._pendingStyles={},r.forEach((function(r){e._currentKeyframe[r]=t[r]})),Object.keys(this._localTimelineStyles).forEach((function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])})))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach((function(t){var r=e._localTimelineStyles[t];e._pendingStyles[t]=r,e._updateStyle(t,r)}))}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach((function(r){var n=t._styleSummary[r],a=e._styleSummary[r];(!n||a.time>n.time)&&t._updateStyle(r,a.value)}))}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,r=new Set,n=1===this._keyframes.size&&0===this.duration,a=[];this._keyframes.forEach((function(o,_){var i=KL(o,!0);Object.keys(i).forEach((function(e){var n=i[e];"!"==n?t.add(e):"*"==n&&r.add(e)})),n||(i.offset=_/e.duration),a.push(i)}));var o=t.size?WL(t.values()):[],_=r.size?WL(r.values()):[];if(n){var i=a[0],s=GL(i);i.offset=0,s.offset=1,a=[i,s]}return dY(this.element,a,o,_,this.duration,this.startTime,this.easing,!1)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}}]),e}(),mY=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o,_,i){var s,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return _classCallCheck(this,r),(s=t.call(this,e,n,i.delay)).element=n,s.keyframes=a,s.preStyleProps=o,s.postStyleProps=_,s._stretchStartingKeyframe=l,s.timings={duration:i.duration,delay:i.delay,easing:i.easing},s}return _createClass(r,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,r=t.delay,n=t.duration,a=t.easing;if(this._stretchStartingKeyframe&&r){var o=[],_=n+r,i=r/_,s=KL(e[0],!1);s.offset=0,o.push(s);var l=KL(e[0],!1);l.offset=gY(i),o.push(l);for(var c=e.length-1,E=1;E<=c;E++){var u=KL(e[E],!1);u.offset=gY((r+u.offset*n)/_),o.push(u)}n=_,r=0,a="",e=o}return dY(this.element,e,this.preStyleProps,this.postStyleProps,n,r,a,!0)}}]),r}(vY);function gY(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=Math.pow(10,t-1);return Math.round(e*r)/r}var OY=function e(){_classCallCheck(this,e)},NY=function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"normalizePropertyName",value:function(e,t){return ZL(e)}},{key:"normalizeStyleValue",value:function(e,t,r,n){var a="",o=r.toString().trim();if(RY[t]&&0!==r&&"0"!==r)if("number"==typeof r)a="px";else{var _=r.match(/^[+-]?[\d\.]+([a-z]*)$/);_&&0==_[1].length&&n.push("Please provide a CSS unit value for ".concat(e,":").concat(r))}return o+a}}]),r}(OY),RY=function(e){var t={};return e.forEach((function(e){return t[e]=!0})),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","));function IY(e,t,r,n,a,o,_,i,s,l,c,E,u){return{type:0,element:e,triggerName:t,isRemovalTransition:a,fromState:r,fromStyles:o,toState:n,toStyles:_,timelines:i,queriedElements:s,preStyleProps:l,postStyleProps:c,totalTime:E,errors:u}}var bY={},yY=function(){function e(t,r,n){_classCallCheck(this,e),this._triggerName=t,this.ast=r,this._stateStyles=n}return _createClass(e,[{key:"match",value:function(e,t,r,n){return function(e,t,r,n,a){return e.some((function(e){return e(t,r,n,a)}))}(this.ast.matchers,e,t,r,n)}},{key:"buildStyles",value:function(e,t,r){var n=this._stateStyles["*"],a=this._stateStyles[e],o=n?n.buildStyles(t,r):{};return a?a.buildStyles(t,r):o}},{key:"build",value:function(e,t,r,n,a,o,_,i,s,l){var c=[],E=this.ast.options&&this.ast.options.params||bY,u=this.buildStyles(r,_&&_.params||bY,c),d=i&&i.params||bY,T=this.buildStyles(n,d,c),f=new Set,p=new Map,P=new Map,S="void"===n,A={params:Object.assign(Object.assign({},E),d)},h=l?[]:PY(e,t,this.ast.animation,a,o,u,T,A,s,c),v=0;if(h.forEach((function(e){v=Math.max(e.duration+e.delay,v)})),c.length)return IY(t,this._triggerName,r,n,S,u,T,[],[],p,P,v,c);h.forEach((function(e){var r=e.element,n=vL(p,r,{});e.preStyleProps.forEach((function(e){return n[e]=!0}));var a=vL(P,r,{});e.postStyleProps.forEach((function(e){return a[e]=!0})),r!==t&&f.add(r)}));var m=WL(f.values());return IY(t,this._triggerName,r,n,S,u,T,h,m,p,P,v)}}]),e}(),LY=function(){function e(t,r){_classCallCheck(this,e),this.styles=t,this.defaultParams=r}return _createClass(e,[{key:"buildStyles",value:function(e,t){var r={},n=GL(this.defaultParams);return Object.keys(e).forEach((function(t){var r=e[t];null!=r&&(n[t]=r)})),this.styles.styles.forEach((function(e){if("string"!=typeof e){var a=e;Object.keys(a).forEach((function(e){var o=a[e];o.length>1&&(o=qL(o,n,t)),r[e]=o}))}})),r}}]),e}(),YY=function(){function e(t,r){var n=this;_classCallCheck(this,e),this.name=t,this.ast=r,this.transitionFactories=[],this.states={},r.states.forEach((function(e){n.states[e.name]=new LY(e.style,e.options&&e.options.params||{})})),MY(this.states,"true","1"),MY(this.states,"false","0"),r.transitions.forEach((function(e){n.transitionFactories.push(new yY(t,e,n.states))})),this.fallbackTransition=new yY(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},this.states)}return _createClass(e,[{key:"matchTransition",value:function(e,t,r,n){return this.transitionFactories.find((function(a){return a.match(e,t,r,n)}))||null}},{key:"matchStyles",value:function(e,t,r){return this.fallbackTransition.buildStyles(e,t,r)}},{key:"containsQueries",get:function(){return this.ast.queryCount>0}}]),e}();function MY(e,t,r){e.hasOwnProperty(t)?e.hasOwnProperty(r)||(e[r]=e[t]):e.hasOwnProperty(r)&&(e[t]=e[r])}var xY=new TY,CY=function(){function e(t,r,n){_classCallCheck(this,e),this.bodyNode=t,this._driver=r,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}return _createClass(e,[{key:"register",value:function(e,t){var r=[],n=iY(this._driver,t,r);if(r.length)throw new Error("Unable to build the animation due to the following errors: ".concat(r.join("\n")));this._animations[e]=n}},{key:"_buildPlayer",value:function(e,t,r){var n=e.element,a=PL(0,this._normalizer,0,e.keyframes,t,r);return this._driver.animate(n,a,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var r,n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=[],_=this._animations[e],i=new Map;if(_?(r=PY(this._driver,t,_,"ng-enter","ng-leave",{},{},a,xY,o)).forEach((function(e){var t=vL(i,e.element,{});e.postStyleProps.forEach((function(e){return t[e]=null}))})):(o.push("The requested animation doesn't exist or has already been destroyed"),r=[]),o.length)throw new Error("Unable to create the animation due to the following errors: ".concat(o.join("\n")));i.forEach((function(e,t){Object.keys(e).forEach((function(r){e[r]=n._driver.computeStyle(t,r,"*")}))}));var s=pL(r.map((function(e){var t=i.get(e.element);return n._buildPlayer(e,{},t)})));return this._playersById[e]=s,s.onDestroy((function(){return n.destroy(e)})),this.players.push(s),s}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var r=this.players.indexOf(t);r>=0&&this.players.splice(r,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by ".concat(e));return t}},{key:"listen",value:function(e,t,r,n){var a=hL(t,"","","");return SL(this._getPlayer(e),r,a,n),function(){}}},{key:"command",value:function(e,t,r,n){if("register"!=r)if("create"!=r){var a=this._getPlayer(e);switch(r){case"play":a.play();break;case"pause":a.pause();break;case"reset":a.reset();break;case"restart":a.restart();break;case"finish":a.finish();break;case"init":a.init();break;case"setPosition":a.setPosition(parseFloat(n[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,n[0]||{});else this.register(e,n[0])}}]),e}(),wY=[],UY={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},kY={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},DY=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";_classCallCheck(this,e),this.namespaceId=r;var n,a=t&&t.hasOwnProperty("value");if(this.value=null!=(n=a?t.value:t)?n:null,a){var o=GL(t);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}return _createClass(e,[{key:"absorbOptions",value:function(e){var t=e.params;if(t){var r=this.options.params;Object.keys(t).forEach((function(e){null==r[e]&&(r[e]=t[e])}))}}},{key:"params",get:function(){return this.options.params}}]),e}(),FY=new DY("void"),GY=function(){function e(t,r,n){_classCallCheck(this,e),this.id=t,this.hostElement=r,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,QY(r,this._hostClassName)}return _createClass(e,[{key:"listen",value:function(e,t,r,n){var a,o=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(r,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==r||0==r.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(a=r)&&"done"!=a)throw new Error('The provided animation trigger event "'.concat(r,'" for the animation trigger "').concat(t,'" is not supported!'));var _=vL(this._elementListeners,e,[]),i={name:t,phase:r,callback:n};_.push(i);var s=vL(this._engine.statesByElement,e,{});return s.hasOwnProperty(t)||(QY(e,"ng-trigger"),QY(e,"ng-trigger-"+t),s[t]=FY),function(){o._engine.afterFlush((function(){var e=_.indexOf(i);e>=0&&_.splice(e,1),o._triggers[t]||delete s[t]}))}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,r){var n=this,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this._getTrigger(t),_=new BY(this.id,t,e),i=this._engine.statesByElement.get(e);i||(QY(e,"ng-trigger"),QY(e,"ng-trigger-"+t),this._engine.statesByElement.set(e,i={}));var s=i[t],l=new DY(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&s&&l.absorbOptions(s.options),i[t]=l,s||(s=FY),"void"===l.value||s.value!==l.value){var c=vL(this._engine.playersByElement,e,[]);c.forEach((function(e){e.namespaceId==n.id&&e.triggerName==t&&e.queued&&e.destroy()}));var E=o.matchTransition(s.value,l.value,e,l.params),u=!1;if(!E){if(!a)return;E=o.fallbackTransition,u=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:E,fromState:s,toState:l,player:_,isFallbackTransition:u}),u||(QY(e,"ng-animate-queued"),_.onStart((function(){VY(e,"ng-animate-queued")}))),_.onDone((function(){var t=n.players.indexOf(_);t>=0&&n.players.splice(t,1);var r=n._engine.playersByElement.get(e);if(r){var a=r.indexOf(_);a>=0&&r.splice(a,1)}})),this.players.push(_),c.push(_),_}if(!function(e,t){var r=Object.keys(e),n=Object.keys(t);if(r.length!=n.length)return!1;for(var a=0;a<r.length;a++){var o=r[a];if(!t.hasOwnProperty(o)||e[o]!==t[o])return!1}return!0}(s.params,l.params)){var d=[],T=o.matchStyles(s.value,s.params,d),f=o.matchStyles(l.value,l.params,d);d.length?this._engine.reportError(d):this._engine.afterFlush((function(){jL(e,T),HL(e,f)}))}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach((function(t,r){delete t[e]})),this._elementListeners.forEach((function(r,n){t._elementListeners.set(n,r.filter((function(t){return t.name!=e})))}))}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach((function(e){return e.destroy()})),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var r=this,n=this._engine.driver.query(e,".ng-trigger",!0);n.forEach((function(e){if(!e.__ng_removed){var n=r._engine.fetchNamespacesByElement(e);n.size?n.forEach((function(r){return r.triggerLeaveAnimation(e,t,!1,!0)})):r.clearElementCache(e)}})),this._engine.afterFlushAnimationsDone((function(){return n.forEach((function(e){return r.clearElementCache(e)}))}))}},{key:"triggerLeaveAnimation",value:function(e,t,r,n){var a=this,o=this._engine.statesByElement.get(e);if(o){var _=[];if(Object.keys(o).forEach((function(t){if(a._triggers[t]){var r=a.trigger(e,t,"void",n);r&&_.push(r)}})),_.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),r&&pL(_).onDone((function(){return a._engine.processLeaveNode(e)})),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,r=this._elementListeners.get(e);if(r){var n=new Set;r.forEach((function(r){var a=r.name;if(!n.has(a)){n.add(a);var o=t._triggers[a].fallbackTransition,_=t._engine.statesByElement.get(e)[a]||FY,i=new DY("void"),s=new BY(t.id,a,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:a,transition:o,fromState:_,toState:i,player:s,isFallbackTransition:!0})}}))}}},{key:"removeNode",value:function(e,t){var r=this,n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var a=!1;if(n.totalAnimations){var o=n.players.length?n.playersByQueriedElement.get(e):[];if(o&&o.length)a=!0;else for(var _=e;_=_.parentNode;)if(n.statesByElement.get(_)){a=!0;break}}if(this.prepareLeaveAnimationListeners(e),a)n.markElementAsRemoved(this.id,e,!1,t);else{var i=e.__ng_removed;i&&i!==UY||(n.afterFlush((function(){return r.clearElementCache(e)})),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){QY(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,r=[];return this._queue.forEach((function(n){var a=n.player;if(!a.destroyed){var o=n.element,_=t._elementListeners.get(o);_&&_.forEach((function(t){if(t.name==n.triggerName){var r=hL(o,n.triggerName,n.fromState.value,n.toState.value);r._data=e,SL(n.player,t.phase,r,t.callback)}})),a.markedForDestroy?t._engine.afterFlush((function(){a.destroy()})):r.push(n)}})),this._queue=[],r.sort((function(e,r){var n=e.transition.ast.depCount,a=r.transition.ast.depCount;return 0==n||0==a?n-a:t._engine.driver.containsElement(e.element,r.element)?1:-1}))}},{key:"destroy",value:function(e){this.players.forEach((function(e){return e.destroy()})),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find((function(t){return t.element===e}))||t}}]),e}(),KY=function(){function e(t,r,n){_classCallCheck(this,e),this.bodyNode=t,this.driver=r,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return _createClass(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"createNamespace",value:function(e,t){var r=new GY(e,t,this);return t.parentNode?this._balanceNamespaceList(r,t):(this.newHostElements.set(t,r),this.collectEnterElement(t)),this._namespaceLookup[e]=r}},{key:"_balanceNamespaceList",value:function(e,t){var r=this._namespaceList.length-1;if(r>=0){for(var n=!1,a=r;a>=0;a--)if(this.driver.containsElement(this._namespaceList[a].hostElement,t)){this._namespaceList.splice(a+1,0,e),n=!0;break}n||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var r=this._namespaceLookup[e];return r||(r=this.createNamespace(e,t)),r}},{key:"registerTrigger",value:function(e,t,r){var n=this._namespaceLookup[e];n&&n.register(t,r)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var r=this;if(e){var n=this._fetchNamespace(e);this.afterFlush((function(){r.namespacesByHostElement.delete(n.hostElement),delete r._namespaceLookup[e];var t=r._namespaceList.indexOf(n);t>=0&&r._namespaceList.splice(t,1)})),this.afterFlushAnimationsDone((function(){return n.destroy(t)}))}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,r=this.statesByElement.get(e);if(r)for(var n=Object.keys(r),a=0;a<n.length;a++){var o=r[n[a]].namespaceId;if(o){var _=this._fetchNamespace(o);_&&t.add(_)}}return t}},{key:"trigger",value:function(e,t,r,n){if(XY(t)){var a=this._fetchNamespace(e);if(a)return a.trigger(t,r,n),!0}return!1}},{key:"insertNode",value:function(e,t,r,n){if(XY(t)){var a=t.__ng_removed;if(a&&a.setForRemoval){a.setForRemoval=!1,a.setForMove=!0;var o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){var _=this._fetchNamespace(e);_&&_.insertNode(t,r)}n&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),QY(e,"ng-animate-disabled")):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),VY(e,"ng-animate-disabled"))}},{key:"removeNode",value:function(e,t,r,n){if(XY(t)){var a=e?this._fetchNamespace(e):null;if(a?a.removeNode(t,n):this.markElementAsRemoved(e,t,!1,n),r){var o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,n)}}else this._onRemovalComplete(t,n)}},{key:"markElementAsRemoved",value:function(e,t,r,n){this.collectedLeaveElements.push(t),t.__ng_removed={namespaceId:e,setForRemoval:n,hasAnimation:r,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,r,n,a){return XY(t)?this._fetchNamespace(e).listen(t,r,n,a):function(){}}},{key:"_buildInstruction",value:function(e,t,r,n,a){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,r,n,e.fromState.options,e.toState.options,t,a)}},{key:"destroyInnerAnimations",value:function(e){var t=this,r=this.driver.query(e,".ng-trigger",!0);r.forEach((function(e){return t.destroyActiveAnimationsForElement(e)})),0!=this.playersByQueriedElement.size&&(r=this.driver.query(e,".ng-animating",!0)).forEach((function(e){return t.finishActiveQueriedAnimationOnElement(e)}))}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach((function(e){e.queued?e.markedForDestroy=!0:e.destroy()}))}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach((function(e){return e.finish()}))}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise((function(t){if(e.players.length)return pL(e.players).onDone((function(){return t()}));t()}))}},{key:"processLeaveNode",value:function(e){var t=this,r=e.__ng_removed;if(r&&r.setForRemoval){if(e.__ng_removed=UY,r.namespaceId){this.destroyInnerAnimations(e);var n=this._fetchNamespace(r.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,r.setForRemoval)}this.driver.matchesElement(e,".ng-animate-disabled")&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach((function(e){t.markElementAsDisabled(e,!1)}))}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,r=[];if(this.newHostElements.size&&(this.newHostElements.forEach((function(t,r){return e._balanceNamespaceList(t,r)})),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var n=0;n<this.collectedEnterElements.length;n++)QY(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var a=[];try{r=this._flushAnimations(a,t)}finally{for(var o=0;o<a.length;o++)a[o]()}}else for(var _=0;_<this.collectedLeaveElements.length;_++)this.processLeaveNode(this.collectedLeaveElements[_]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach((function(e){return e()})),this._flushFns=[],this._whenQuietFns.length){var i=this._whenQuietFns;this._whenQuietFns=[],r.length?pL(r).onDone((function(){i.forEach((function(e){return e()}))})):i.forEach((function(e){return e()}))}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(e.join("\n")))}},{key:"_flushAnimations",value:function(e,t){var r=this,n=new TY,a=[],o=new Map,_=[],i=new Map,s=new Map,l=new Map,c=new Set;this.disabledNodes.forEach((function(e){c.add(e);for(var t=r.driver.query(e,".ng-animate-queued",!0),n=0;n<t.length;n++)c.add(t[n])}));var E=this.bodyNode,u=Array.from(this.statesByElement.keys()),d=zY(u,this.collectedEnterElements),T=new Map,f=0;d.forEach((function(e,t){var r="ng-enter"+f++;T.set(t,r),e.forEach((function(e){return QY(e,r)}))}));for(var p=[],P=new Set,S=new Set,A=0;A<this.collectedLeaveElements.length;A++){var h=this.collectedLeaveElements[A],v=h.__ng_removed;v&&v.setForRemoval&&(p.push(h),P.add(h),v.hasAnimation?this.driver.query(h,".ng-star-inserted",!0).forEach((function(e){return P.add(e)})):S.add(h))}var m=new Map,g=zY(u,Array.from(P));g.forEach((function(e,t){var r="ng-leave"+f++;m.set(t,r),e.forEach((function(e){return QY(e,r)}))})),e.push((function(){d.forEach((function(e,t){var r=T.get(t);e.forEach((function(e){return VY(e,r)}))})),g.forEach((function(e,t){var r=m.get(t);e.forEach((function(e){return VY(e,r)}))})),p.forEach((function(e){r.processLeaveNode(e)}))}));for(var O=[],N=[],R=this._namespaceList.length-1;R>=0;R--)this._namespaceList[R].drainQueuedTransitions(t).forEach((function(e){var t=e.player,o=e.element;if(O.push(t),r.collectedEnterElements.length){var c=o.__ng_removed;if(c&&c.setForMove)return void t.destroy()}var u=!E||!r.driver.containsElement(E,o),d=m.get(o),f=T.get(o),p=r._buildInstruction(e,n,f,d,u);if(!p.errors||!p.errors.length)return u||e.isFallbackTransition?(t.onStart((function(){return jL(o,p.fromStyles)})),t.onDestroy((function(){return HL(o,p.toStyles)})),void a.push(t)):(p.timelines.forEach((function(e){return e.stretchStartingKeyframe=!0})),n.append(o,p.timelines),_.push({instruction:p,player:t,element:o}),p.queriedElements.forEach((function(e){return vL(i,e,[]).push(t)})),p.preStyleProps.forEach((function(e,t){var r=Object.keys(e);if(r.length){var n=s.get(t);n||s.set(t,n=new Set),r.forEach((function(e){return n.add(e)}))}})),void p.postStyleProps.forEach((function(e,t){var r=Object.keys(e),n=l.get(t);n||l.set(t,n=new Set),r.forEach((function(e){return n.add(e)}))})));N.push(p)}));if(N.length){var I=[];N.forEach((function(e){I.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach((function(e){return I.push("- ".concat(e,"\n"))}))})),O.forEach((function(e){return e.destroy()})),this.reportError(I)}var b=new Map,y=new Map;_.forEach((function(e){var t=e.element;n.has(t)&&(y.set(t,t),r._beforeAnimationBuild(e.player.namespaceId,e.instruction,b))})),a.forEach((function(e){var t=e.element;r._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach((function(e){vL(b,t,[]).push(e),e.destroy()}))}));var L=p.filter((function(e){return WY(e,s,l)})),Y=new Map;jY(Y,this.driver,S,l,"*").forEach((function(e){WY(e,s,l)&&L.push(e)}));var M=new Map;d.forEach((function(e,t){jY(M,r.driver,new Set(e),s,"!")})),L.forEach((function(e){var t=Y.get(e),r=M.get(e);Y.set(e,Object.assign(Object.assign({},t),r))}));var x=[],C=[],w={};_.forEach((function(e){var t=e.element,_=e.player,i=e.instruction;if(n.has(t)){if(c.has(t))return _.onDestroy((function(){return HL(t,i.toStyles)})),_.disabled=!0,_.overrideTotalTime(i.totalTime),void a.push(_);var s=w;if(y.size>1){for(var l=t,E=[];l=l.parentNode;){var u=y.get(l);if(u){s=u;break}E.push(l)}E.forEach((function(e){return y.set(e,s)}))}var d=r._buildAnimation(_.namespaceId,i,b,o,M,Y);if(_.setRealPlayer(d),s===w)x.push(_);else{var T=r.playersByElement.get(s);T&&T.length&&(_.parentPlayer=pL(T)),a.push(_)}}else jL(t,i.fromStyles),_.onDestroy((function(){return HL(t,i.toStyles)})),C.push(_),c.has(t)&&a.push(_)})),C.forEach((function(e){var t=o.get(e.element);if(t&&t.length){var r=pL(t);e.setRealPlayer(r)}})),a.forEach((function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()}));for(var U=0;U<p.length;U++){var k=p[U],D=k.__ng_removed;if(VY(k,"ng-leave"),!D||!D.hasAnimation){var F=[];if(i.size){var G=i.get(k);G&&G.length&&F.push.apply(F,_toConsumableArray(G));for(var K=this.driver.query(k,".ng-animating",!0),B=0;B<K.length;B++){var X=i.get(K[B]);X&&X.length&&F.push.apply(F,_toConsumableArray(X))}}var H=F.filter((function(e){return!e.destroyed}));H.length?qY(this,k,H):this.processLeaveNode(k)}}return p.length=0,x.forEach((function(e){r.players.push(e),e.onDone((function(){e.destroy();var t=r.players.indexOf(e);r.players.splice(t,1)})),e.play()})),x}},{key:"elementContainsData",value:function(e,t){var r=!1,n=t.__ng_removed;return n&&n.setForRemoval&&(r=!0),this.playersByElement.has(t)&&(r=!0),this.playersByQueriedElement.has(t)&&(r=!0),this.statesByElement.has(t)&&(r=!0),this._fetchNamespace(e).elementContainsData(t)||r}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,r,n,a){var o=[];if(t){var _=this.playersByQueriedElement.get(e);_&&(o=_)}else{var i=this.playersByElement.get(e);if(i){var s=!a||"void"==a;i.forEach((function(e){e.queued||(s||e.triggerName==n)&&o.push(e)}))}}return(r||n)&&(o=o.filter((function(e){return!(r&&r!=e.namespaceId||n&&n!=e.triggerName)}))),o}},{key:"_beforeAnimationBuild",value:function(e,t,r){var n,a=this,o=t.element,_=t.isRemovalTransition?void 0:e,i=t.isRemovalTransition?void 0:t.triggerName,s=_createForOfIteratorHelper(t.timelines);try{var l=function(){var e=n.value.element,s=e!==o,l=vL(r,e,[]);a._getPreviousPlayers(e,s,_,i,t.toState).forEach((function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),l.push(e)}))};for(s.s();!(n=s.n()).done;)l()}catch(c){s.e(c)}finally{s.f()}jL(o,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,r,n,a,o){var _=this,i=t.triggerName,s=t.element,l=[],c=new Set,E=new Set,u=t.timelines.map((function(t){var u=t.element;c.add(u);var d=u.__ng_removed;if(d&&d.removedBeforeQueried)return new uP(t.duration,t.delay);var T,f,p=u!==s,P=(T=(r.get(u)||wY).map((function(e){return e.getRealPlayer()})),f=[],function e(t,r){for(var n=0;n<t.length;n++){var a=t[n];a instanceof dP?e(a.players,r):r.push(a)}}(T,f),f).filter((function(e){return!!e.element&&e.element===u})),S=a.get(u),A=o.get(u),h=PL(0,_._normalizer,0,t.keyframes,S,A),v=_._buildPlayer(t,h,P);if(t.subTimeline&&n&&E.add(u),p){var m=new BY(e,i,u);m.setRealPlayer(v),l.push(m)}return v}));l.forEach((function(e){vL(_.playersByQueriedElement,e.element,[]).push(e),e.onDone((function(){return function(e,t,r){var n;if(e instanceof Map){if(n=e.get(t)){if(n.length){var a=n.indexOf(r);n.splice(a,1)}0==n.length&&e.delete(t)}}else if(n=e[t]){if(n.length){var o=n.indexOf(r);n.splice(o,1)}0==n.length&&delete e[t]}return n}(_.playersByQueriedElement,e.element,e)}))})),c.forEach((function(e){return QY(e,"ng-animating")}));var d=pL(u);return d.onDestroy((function(){c.forEach((function(e){return VY(e,"ng-animating")})),HL(s,t.toStyles)})),E.forEach((function(e){vL(n,e,[]).push(d)})),d}},{key:"_buildPlayer",value:function(e,t,r){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,r):new uP(e.duration,e.delay)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach((function(t){t.players.forEach((function(t){t.queued&&e.push(t)}))})),e}}]),e}(),BY=function(){function e(t,r,n){_classCallCheck(this,e),this.namespaceId=t,this.triggerName=r,this.element=n,this._player=new uP,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return _createClass(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach((function(r){t._queuedCallbacks[r].forEach((function(t){return SL(e,r,void 0,t)}))})),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,r=this._player;r.triggerCallback&&e.onStart((function(){return r.triggerCallback("start")})),e.onDone((function(){return t.finish()})),e.onDestroy((function(){return t.destroy()}))}},{key:"_queueEvent",value:function(e,t){vL(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function XY(e){return e&&1===e.nodeType}function HY(e,t){var r=e.style.display;return e.style.display=null!=t?t:"none",r}function jY(e,t,r,n,a){var o=[];r.forEach((function(e){return o.push(HY(e))}));var _=[];n.forEach((function(r,n){var o={};r.forEach((function(e){var r=o[e]=t.computeStyle(n,e,a);r&&0!=r.length||(n.__ng_removed=kY,_.push(n))})),e.set(n,o)}));var i=0;return r.forEach((function(e){return HY(e,o[i++])})),_}function zY(e,t){var r=new Map;if(e.forEach((function(e){return r.set(e,[])})),0==t.length)return r;var n=new Set(t),a=new Map;return t.forEach((function(e){var t=function e(t){if(!t)return 1;var o=a.get(t);if(o)return o;var _=t.parentNode;return o=r.has(_)?_:n.has(_)?1:e(_),a.set(t,o),o}(e);1!==t&&r.get(t).push(e)})),r}function QY(e,t){if(e.classList)e.classList.add(t);else{var r=e.$$classes;r||(r=e.$$classes={}),r[t]=!0}}function VY(e,t){if(e.classList)e.classList.remove(t);else{var r=e.$$classes;r&&delete r[t]}}function qY(e,t,r){pL(r).onDone((function(){return e.processLeaveNode(t)}))}function WY(e,t,r){var n=r.get(e);if(!n)return!1;var a=t.get(e);return a?n.forEach((function(e){return a.add(e)})):t.set(e,n),r.delete(e),!0}var JY=function(){function e(t,r,n){var a=this;_classCallCheck(this,e),this.bodyNode=t,this._driver=r,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new KY(t,r,n),this._timelineEngine=new CY(t,r,n),this._transitionEngine.onRemovalComplete=function(e,t){return a.onRemovalComplete(e,t)}}return _createClass(e,[{key:"registerTrigger",value:function(e,t,r,n,a){var o=e+"-"+n,_=this._triggerCache[o];if(!_){var i=[],s=iY(this._driver,a,i);if(i.length)throw new Error('The animation trigger "'.concat(n,'" has failed to build due to the following errors:\n - ').concat(i.join("\n - ")));_=function(e,t){return new YY(e,t)}(n,s),this._triggerCache[o]=_}this._transitionEngine.registerTrigger(t,n,_)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,r,n){this._transitionEngine.insertNode(e,t,r,n)}},{key:"onRemove",value:function(e,t,r,n){this._transitionEngine.removeNode(e,t,n||!1,r)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(e,t,r,n){if("@"==r.charAt(0)){var a=_slicedToArray(mL(r),2),o=a[0],_=a[1];this._timelineEngine.command(o,t,_,n)}else this._transitionEngine.trigger(e,t,r,n)}},{key:"listen",value:function(e,t,r,n,a){if("@"==r.charAt(0)){var o=_slicedToArray(mL(r),2),_=o[0],i=o[1];return this._timelineEngine.listen(_,t,i,a)}return this._transitionEngine.listen(e,t,r,n,a)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}}]),e}();function ZY(e,t){var r=null,n=null;return Array.isArray(t)&&t.length?(r=eM(t[0]),t.length>1&&(n=eM(t[t.length-1]))):t&&(r=eM(t)),r||n?new $Y(e,r,n):null}var $Y=function(){var e=function(){function e(t,r,n){_classCallCheck(this,e),this._element=t,this._startStyles=r,this._endStyles=n,this._state=0;var a=e.initialStylesByElement.get(t);a||e.initialStylesByElement.set(t,a={}),this._initialStyles=a}return _createClass(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&HL(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(HL(this._element,this._initialStyles),this._endStyles&&(HL(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(jL(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(jL(this._element,this._endStyles),this._endStyles=null),HL(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function eM(e){for(var t=null,r=Object.keys(e),n=0;n<r.length;n++){var a=r[n];tM(a)&&((t=t||{})[a]=e[a])}return t}function tM(e){return"display"===e||"position"===e}var rM=function(){function e(t,r,n,a,o,_,i){var s=this;_classCallCheck(this,e),this._element=t,this._name=r,this._duration=n,this._delay=a,this._easing=o,this._fillMode=_,this._onDoneFn=i,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return s._handleCallback(e)}}return _createClass(e,[{key:"apply",value:function(){var e,t,r;e=this._element,t="".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name),(r=sM(e,"").trim()).length&&(function(e,t){for(var r=0;r<e.length;r++)e.charAt(r)}(r),t="".concat(r,", ").concat(t)),iM(e,"",t),_M(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){nM(this._element,this._name,"paused")}},{key:"resume",value:function(){nM(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=aM(this._element,this._name);this._position=e*this._duration,iM(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),r=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&r>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),_M(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){var r=sM(e,"").split(","),n=oM(r,t);n>=0&&(r.splice(n,1),iM(e,"",r.join(",")))}(this._element,this._name))}}]),e}();function nM(e,t,r){iM(e,"PlayState",r,aM(e,t))}function aM(e,t){var r=sM(e,"");return r.indexOf(",")>0?oM(r.split(","),t):oM([r],t)}function oM(e,t){for(var r=0;r<e.length;r++)if(e[r].indexOf(t)>=0)return r;return-1}function _M(e,t,r){r?e.removeEventListener("animationend",t):e.addEventListener("animationend",t)}function iM(e,t,r,n){var a="animation"+t;if(null!=n){var o=e.style[a];if(o.length){var _=o.split(",");_[n]=r,r=_.join(",")}}e.style[a]=r}function sM(e,t){return e.style["animation"+t]}var lM=function(){function e(t,r,n,a,o,_,i,s){_classCallCheck(this,e),this.element=t,this.keyframes=r,this.animationName=n,this._duration=a,this._delay=o,this._finalStyles=i,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=_||"linear",this.totalTime=a+o,this._buildStyler()}return _createClass(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach((function(e){return e()})),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach((function(e){return e()})),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach((function(e){return e()})),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new rM(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",(function(){return e.finish()}))}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach((function(e){return e()})),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var r=this._state>=3;Object.keys(this._finalStyles).forEach((function(n){"offset"!=n&&(t[n]=r?e._finalStyles[n]:rY(e.element,n))}))}this.currentSnapshot=t}}]),e}(),cM=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this)).element=e,a._startingStyles={},a.__initialized=!1,a._styles=xL(n),a}return _createClass(r,[{key:"init",value:function(){var e=this;!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach((function(t){e._startingStyles[t]=e.element.style[t]})),_get(_getPrototypeOf(r.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;this._startingStyles&&(this.init(),Object.keys(this._styles).forEach((function(t){return e.element.style.setProperty(t,e._styles[t])})),_get(_getPrototypeOf(r.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;this._startingStyles&&(Object.keys(this._startingStyles).forEach((function(t){var r=e._startingStyles[t];r?e.element.style.setProperty(t,r):e.element.style.removeProperty(t)})),this._startingStyles=null,_get(_getPrototypeOf(r.prototype),"destroy",this).call(this))}}]),r}(uP),EM=function(){function e(){_classCallCheck(this,e),this._count=0,this._head=document.querySelector("head"),this._warningIssued=!1}return _createClass(e,[{key:"validateStyleProperty",value:function(e){return yL(e)}},{key:"matchesElement",value:function(e,t){return LL(e,t)}},{key:"containsElement",value:function(e,t){return YL(e,t)}},{key:"query",value:function(e,t,r){return ML(e,t,r)}},{key:"computeStyle",value:function(e,t,r){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,r){r=r.map((function(e){return xL(e)}));var n="@keyframes ".concat(t," {\n"),a="";r.forEach((function(e){a=" ";var t=parseFloat(e.offset);n+="".concat(a).concat(100*t,"% {\n"),a+=" ",Object.keys(e).forEach((function(t){var r=e[t];switch(t){case"offset":return;case"easing":return void(r&&(n+="".concat(a,"animation-timing-function: ").concat(r,";\n")));default:return void(n+="".concat(a).concat(t,": ").concat(r,";\n"))}})),n+="".concat(a,"}\n")})),n+="}\n";var o=document.createElement("style");return o.innerHTML=n,o}},{key:"animate",value:function(e,t,r,n,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],_=arguments.length>6?arguments[6]:void 0;_&&this._notifyFaultyScrubber();var i=o.filter((function(e){return e instanceof lM})),s={};$L(r,n)&&i.forEach((function(e){var t=e.currentSnapshot;Object.keys(t).forEach((function(e){return s[e]=t[e]}))}));var l=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach((function(e){Object.keys(e).forEach((function(r){"offset"!=r&&"easing"!=r&&(t[r]=e[r])}))})),t}(t=eY(e,t,s));if(0==r)return new cM(e,l);var c="gen_css_kf_".concat(this._count++),E=this.buildKeyframeElement(e,c,t);document.querySelector("head").appendChild(E);var u=ZY(e,t),d=new lM(e,t,c,r,n,a,l,u);return d.onDestroy((function(){var e;(e=E).parentNode.removeChild(e)})),d}},{key:"_notifyFaultyScrubber",value:function(){this._warningIssued||(console.warn("@angular/animations: please load the web-animations.js polyfill to allow programmatic access...\n","  visit http://bit.ly/IWukam to learn more about using the web-animation-js polyfill."),this._warningIssued=!0)}}]),e}(),uM=function(){function e(t,r,n,a){_classCallCheck(this,e),this.element=t,this.keyframes=r,this.options=n,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}return _createClass(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach((function(e){return e()})),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",(function(){return e._onFinish()}))}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,r){return e.animate(t,r)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach((function(e){return e()})),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach((function(e){return e()})),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach((function(r){"offset"!=r&&(t[r]=e._finished?e._finalKeyframe[r]:rY(e.element,r))})),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach((function(e){return e()})),t.length=0}},{key:"totalTime",get:function(){return this._delay+this._duration}}]),e}(),dM=function(){function e(){_classCallCheck(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(TM().toString()),this._cssKeyframesDriver=new EM}return _createClass(e,[{key:"validateStyleProperty",value:function(e){return yL(e)}},{key:"matchesElement",value:function(e,t){return LL(e,t)}},{key:"containsElement",value:function(e,t){return YL(e,t)}},{key:"query",value:function(e,t,r){return ML(e,t,r)}},{key:"computeStyle",value:function(e,t,r){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,r,n,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],_=arguments.length>6?arguments[6]:void 0;if(!_&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,r,n,a,o);var i={duration:r,delay:n,fill:0==n?"both":"forwards"};a&&(i.easing=a);var s={},l=o.filter((function(e){return e instanceof uM}));$L(r,n)&&l.forEach((function(e){var t=e.currentSnapshot;Object.keys(t).forEach((function(e){return s[e]=t[e]}))}));var c=ZY(e,t=eY(e,t=t.map((function(e){return KL(e,!1)})),s));return new uM(e,t,i,c)}}]),e}();function TM(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}var fM,pM=((fM=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this))._nextAnimationId=0,a._renderer=e.createRenderer(n.body,{id:"0",encapsulation:pt.None,styles:[],data:{animation:[]}}),a}return _createClass(r,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var r=Array.isArray(e)?iP(e):e;return AM(this._renderer,null,t,"register",[r]),new PM(t,this._renderer)}}]),r}(oP)).\u0275fac=function(e){return new(e||fM)(rt(fi),rt(Tl))},fM.\u0275prov=Pe({token:fM,factory:fM.\u0275fac}),fM),PM=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n){var a;return _classCallCheck(this,r),(a=t.call(this))._id=e,a._renderer=n,a}return _createClass(r,[{key:"create",value:function(e,t){return new SM(this._id,e,t||{},this._renderer)}}]),r}(function(){return function e(){_classCallCheck(this,e)}}()),SM=function(){function e(t,r,n,a){_classCallCheck(this,e),this.id=t,this.element=r,this._renderer=a,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}return _createClass(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return AM(this._renderer,this.element,this.id,e,r)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset")}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){return 0}}]),e}();function AM(e,t,r,n,a){return e.setProperty(t,"@@".concat(r,":").concat(n),a)}var hM,vM,mM,gM,OM=((hM=function(){function e(t,r,n){_classCallCheck(this,e),this.delegate=t,this.engine=r,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return _createClass(e,[{key:"createRenderer",value:function(e,t){var r=this,n=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var a=this._rendererCache.get(n);return a||(a=new NM("",n,this.engine),this._rendererCache.set(n,a)),a}var o=t.id,_=t.id+"-"+this._currentId;return this._currentId++,this.engine.register(_,e),t.data.animation.forEach((function t(n){Array.isArray(n)?n.forEach(t):r.engine.registerTrigger(o,_,e,n.name,n)})),new RM(this,_,n,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then((function(){e._microtaskId++}))}},{key:"scheduleListenerCallback",value:function(e,t,r){var n=this;e>=0&&e<this._microtaskId?this._zone.run((function(){return t(r)})):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then((function(){n._zone.run((function(){n._animationCallbacksBuffer.forEach((function(e){var t=_slicedToArray(e,2);(0,t[0])(t[1])})),n._animationCallbacksBuffer=[]}))})),this._animationCallbacksBuffer.push([t,r]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular((function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)})),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),e}()).\u0275fac=function(e){return new(e||hM)(rt(fi),rt(JY),rt(ws))},hM.\u0275prov=Pe({token:hM,factory:hM.\u0275fac}),hM),NM=function(){function e(t,r,n){_classCallCheck(this,e),this.namespaceId=t,this.delegate=r,this.engine=n,this.destroyNode=this.delegate.destroyNode?function(e){return r.destroyNode(e)}:null}return _createClass(e,[{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,r){this.delegate.insertBefore(e,t,r),this.engine.onInsert(this.namespaceId,t,e,!0)}},{key:"removeChild",value:function(e,t,r){this.engine.onRemove(this.namespaceId,t,this.delegate,r)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,r,n){this.delegate.setAttribute(e,t,r,n)}},{key:"removeAttribute",value:function(e,t,r){this.delegate.removeAttribute(e,t,r)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,r,n){this.delegate.setStyle(e,t,r,n)}},{key:"removeStyle",value:function(e,t,r){this.delegate.removeStyle(e,t,r)}},{key:"setProperty",value:function(e,t,r){"@"==t.charAt(0)&&"@.disabled"==t?this.disableAnimations(e,!!r):this.delegate.setProperty(e,t,r)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,r){return this.delegate.listen(e,t,r)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}},{key:"data",get:function(){return this.delegate.data}}]),e}(),RM=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a,o){var _;return _classCallCheck(this,r),(_=t.call(this,n,a,o)).factory=e,_.namespaceId=n,_}return _createClass(r,[{key:"setProperty",value:function(e,t,r){"@"==t.charAt(0)?"."==t.charAt(1)&&"@.disabled"==t?this.disableAnimations(e,r=void 0===r||!!r):this.engine.process(this.namespaceId,e,t.substr(1),r):this.delegate.setProperty(e,t,r)}},{key:"listen",value:function(e,t,r){var n,a,o=this;if("@"==t.charAt(0)){var _,i=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e),s=t.substr(1),l="";return"@"!=s.charAt(0)&&(a=(n=s).indexOf("."),s=(_=_slicedToArray([n.substring(0,a),n.substr(a+1)],2))[0],l=_[1]),this.engine.listen(this.namespaceId,i,s,l,(function(e){o.factory.scheduleListenerCallback(e._data||-1,r,e)}))}return this.delegate.listen(e,t,r)}}]),r}(NM),IM=((vM=function(e){_inherits(r,e);var t=_createSuper(r);function r(e,n,a){return _classCallCheck(this,r),t.call(this,e.body,n,a)}return r}(JY)).\u0275fac=function(e){return new(e||vM)(rt(Tl),rt(UL),rt(OY))},vM.\u0275prov=Pe({token:vM,factory:vM.\u0275fac}),vM),bM=[{provide:UL,useFactory:function(){return"function"==typeof TM()?new dM:new EM}},{provide:new Qe("AnimationModuleType"),useValue:"BrowserAnimations"},{provide:oP,useClass:pM},{provide:OY,useFactory:function(){return new NY}},{provide:JY,useClass:IM},{provide:fi,useFactory:function(e,t,r){return new OM(e,t,r)},deps:[Rc,JY,ws]}],yM=((gM=function e(){_classCallCheck(this,e)}).\u0275mod=Ot({type:gM}),gM.\u0275inj=Ae({factory:function(e){return new(e||gM)},providers:bM,imports:[Gc]}),gM),LM=((mM=function e(){_classCallCheck(this,e)}).\u0275mod=Ot({type:mM,bootstrap:[lL]}),mM.\u0275inj=Ae({factory:function(e){return new(e||mM)},providers:[{provide:nd,useClass:QS,multi:!0},{provide:nd,useClass:zS,multi:!0}],imports:[[Gc,yM,kP,Ou,pd,jS,TL.forRoot({config:{tokenGetter:function(){return localStorage.getItem("access_token")},whitelistedDomains:["cadeos.io"],blacklistedRoutes:[""]}})]]}),mM);(function(){if(mn)throw new Error("Cannot enable prod mode after platform setup.");vn=!1})(),Dc().bootstrapModule(LM).catch((function(e){return console.error(e)}))},zn8P:function(e,t){function r(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id="zn8P"}},[[0,0]]]);